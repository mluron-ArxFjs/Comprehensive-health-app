{"version":3,"file":"ej2-image-editor.min.js","sources":["../../src/image-editor/action/crop.js","../../src/image-editor/action/draw.js","../../src/image-editor/action/export.js","../../src/image-editor/action/filter.js","../../src/image-editor/action/freehand-draw.js","../../src/image-editor/action/selection.js","../../src/image-editor/action/shape.js","../../src/image-editor/action/transform.js","../../src/image-editor/action/undo-redo.js","../../src/image-editor/base/image-editor.js","../../src/image-editor/base/enum.js","../../src/image-editor/renderer/toolbar.js"],"sourcesContent":["import { extend, isBlazor, isNullOrUndefined } from '@syncfusion/ej2-base';\nvar Crop = /** @class */ (function () {\n    function Crop(parent) {\n        this.croppedDegree = 0; // Specifies the degree when crop is performed\n        this.cropDestPoints = { startX: 0, startY: 0, width: 0, height: 0 }; // To redraw old image when navigate to crop tab\n        this.tempFlipPanPoint = { x: 0, y: 0 };\n        this.isPreventScaling = false;\n        this.isInitCrop = false;\n        this.parent = parent;\n        this.addEventListener();\n    }\n    Crop.prototype.destroy = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.removeEventListener();\n    };\n    Crop.prototype.addEventListener = function () {\n        this.parent.on('crop', this.cropping, this);\n        this.parent.on('destroyed', this.destroy, this);\n    };\n    Crop.prototype.removeEventListener = function () {\n        this.parent.off('crop', this.cropping);\n        this.parent.off('destroyed', this.destroy);\n    };\n    Crop.prototype.cropping = function (args) {\n        this.updateCropPvtVar();\n        switch (args.prop) {\n            case 'cropImg':\n                this.cropImg(args.value['isRotateCrop']);\n                break;\n            case 'cropCircle':\n                this.cropCircle(args.value['context'], args.value['isSave'], args.value['isFlip']);\n                break;\n            case 'setCurrSelPoints':\n                this.setCurrSelPoints(args.value['isSetDimension']);\n                break;\n            case 'updateRotatePan':\n                this.updateRotatePan();\n                break;\n            case 'crop':\n                this.crop(args.value['obj']);\n                break;\n            case 'calcRatio':\n                this.calcRatio(args.value['obj'], args.value['dimension']);\n                break;\n            case 'isObjInImage':\n                this.isObjInImage(args.value['obj'], args.value['object']);\n                break;\n            case 'getCurrFlipState':\n                this.getCurrFlipState(args.value['panObj']);\n                break;\n            case 'setPreviousCropCurrentObj':\n                this.prevCropCurrObj = args.value['obj'];\n                break;\n            case 'setCropDestPoints':\n                this.cropDestPoints = args.value['point'];\n                break;\n            case 'getTempFlipPanPoint':\n                args.value['obj']['point'] = this.tempFlipPanPoint;\n                break;\n            case 'setTempFlipPanPoint':\n                if (isNullOrUndefined(args.value['isAdd'])) {\n                    this.tempFlipPanPoint = args.value['point'];\n                }\n                else {\n                    this.tempFlipPanPoint.x += args.value['point'].x;\n                    this.tempFlipPanPoint.y += args.value['point'].y;\n                }\n                break;\n            case 'getPreventScaling':\n                args.value['obj']['bool'] = this.isPreventScaling;\n                break;\n            case 'reset':\n                this.reset();\n                break;\n        }\n    };\n    Crop.prototype.getModuleName = function () {\n        return 'crop';\n    };\n    Crop.prototype.updateCropPvtVar = function () {\n        var parent = this.parent;\n        if (parent.lowerCanvas) {\n            this.lowerContext = parent.lowerCanvas.getContext('2d');\n        }\n        if (parent.upperCanvas) {\n            this.upperContext = parent.upperCanvas.getContext('2d');\n        }\n    };\n    Crop.prototype.reset = function () {\n        this.prevCropCurrObj = null;\n        this.croppedDegree = 0;\n        this.cropDestPoints = { startX: 0, startY: 0, width: 0, height: 0 };\n        this.tempFlipPanPoint = { x: 0, y: 0 };\n        this.isPreventScaling = false;\n        this.isInitCrop = false;\n    };\n    Crop.prototype.cropImg = function (isRotateCrop) {\n        var parent = this.parent;\n        var isNullCrop = isNullOrUndefined(isRotateCrop);\n        var actPoint = parent.activeObj.activePoint;\n        parent.notify('draw', { prop: 'setImageEdited', onPropertyChange: false });\n        if (isNullCrop) {\n            this.croppedDegree = parent.transform.degree;\n        }\n        if (isNullCrop && parent.transform.degree !== 0) {\n            this.updateCropObj();\n            var point = { startX: parent.img.destLeft, startY: parent.img.destTop, width: parent.img.destWidth,\n                height: parent.img.destHeight };\n            parent.notify('transform', { prop: 'setCurrDestinationPoint', onPropertyChange: false, value: { point: point } });\n            this.rotateCrop();\n        }\n        else if (isNullCrop && parent.transform.currFlipState !== '') {\n            this.updateCropObj();\n            var point = { startX: parent.img.destLeft, startY: parent.img.destTop, width: parent.img.destWidth,\n                height: parent.img.destHeight };\n            parent.notify('transform', { prop: 'setCurrDestinationPoint', onPropertyChange: false, value: { point: point } });\n            this.flipCrop();\n        }\n        else {\n            parent.notify('draw', { prop: 'setTempZoomFactor', onPropertyChange: false, value: { tempZoomFactor: parent.transform.zoomFactor } });\n            var ratio = this.calcRatio();\n            if (isNullCrop || !isRotateCrop) { // isRotateCrop is NULL or False\n                this.updateCropObj();\n                parent.notify('draw', { prop: 'resetPanPoints', onPropertyChange: false });\n                parent.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n                var point = { startX: parent.img.destLeft, startY: parent.img.destTop, width: parent.img.destWidth,\n                    height: parent.img.destHeight };\n                parent.notify('transform', { prop: 'setCurrDestinationPoint', onPropertyChange: false, value: { point: point } });\n                parent.currSelectionPoint = extend({}, parent.activeObj, {}, true);\n                this.cropDestPoints = { startX: parent.img.destLeft, startY: parent.img.destTop, width: parent.img.destWidth,\n                    height: parent.img.destHeight };\n            }\n            var obj = { width: 0, height: 0 };\n            parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false,\n                value: { width: actPoint.width * ratio.width,\n                    height: actPoint.height * ratio.height, obj: obj } });\n            var maxDimension = obj;\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n            parent.img.srcLeft = (actPoint.startX * ratio.width) - (parent.img.destLeft * ratio.width);\n            parent.img.srcTop = (actPoint.startY * ratio.height) - (parent.img.destTop * ratio.height);\n            parent.img.srcWidth = (actPoint.width * ratio.width);\n            parent.img.srcHeight = (actPoint.height * ratio.height);\n            parent.img.destLeft = (parent.lowerCanvas.clientWidth - maxDimension.width) / 2;\n            parent.img.destTop = (parent.lowerCanvas.clientHeight - maxDimension.height) / 2;\n            parent.img.destWidth = maxDimension.width;\n            parent.img.destHeight = maxDimension.height;\n            var temp = this.lowerContext.filter;\n            parent.notify('filter', { prop: 'updateBrightFilter', onPropertyChange: false });\n            this.lowerContext.drawImage(parent.baseImg, parent.img.srcLeft, parent.img.srcTop, parent.img.srcWidth, parent.img.srcHeight, parent.img.destLeft, parent.img.destTop, parent.img.destWidth, parent.img.destHeight);\n            this.lowerContext.filter = 'none';\n            var activeObj = extend({}, parent.activeObj, {}, true);\n            this.cropObjColl();\n            parent.notify('shape', { prop: 'zoomObjColl', onPropertyChange: false, value: { isPreventApply: null } });\n            for (var i = 0, len = parent.objColl.length; i < len; i++) {\n                if (this.isObjInImage(parent.objColl[i])) {\n                    parent.notify('shape', { prop: 'apply', onPropertyChange: false,\n                        value: { shape: parent.objColl[i].shape, obj: parent.objColl[i], canvas: null } });\n                    parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                }\n            }\n            parent.activeObj = activeObj;\n            this.cropFreehandDrawColl();\n            parent.notify('freehand-draw', { prop: 'zoomFHDColl', onPropertyChange: false, value: { isPreventApply: null } });\n            parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n            parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.upperContext } });\n            if (parent.currSelectionPoint.shape === 'crop-circle') {\n                this.cropCircle(this.lowerContext);\n            }\n            else {\n                parent.isCircleCrop = false;\n            }\n            this.lowerContext.filter = temp;\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            parent.currObjType.isCustomCrop = false;\n            parent.pan(false);\n            parent.transform.defaultZoomFactor = 0;\n        }\n    };\n    Crop.prototype.updateCropObj = function () {\n        this.parent.afterCropActions = [];\n        var object = { currObj: {} };\n        this.parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var obj = object['currObj'];\n        this.parent.cropObj = extend({}, obj, {}, true);\n    };\n    Crop.prototype.rotateCrop = function () {\n        var parent = this.parent;\n        var shape = parent.activeObj.shape || '';\n        parent.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n        parent.currSelectionPoint = extend({}, parent.activeObj, {}, true);\n        parent.objColl.push(parent.activeObj);\n        parent.activeObj = extend({}, parent.objColl[parent.objColl.length - 1], {}, true);\n        var activeObj = extend({}, parent.objColl[parent.objColl.length - 1], {}, true);\n        var tempCurrSelObj = extend({}, parent.currSelectionPoint, {}, true);\n        var preventSelObj = { bool: null };\n        parent.notify('transform', { prop: 'getPreventSelect', onPropertyChange: false, value: { obj: preventSelObj } });\n        parent.notify('transform', { prop: 'setPreventSelect', onPropertyChange: false, value: { bool: true } });\n        var coll = extend([], parent.rotateFlipColl, [], true);\n        this.panToSelRangle(true);\n        this.resetZoom();\n        var afterCropActions = extend([], parent.afterCropActions, [], true);\n        this.revertTransform('initial', coll);\n        activeObj = extend({}, parent.objColl[parent.objColl.length - 1], {}, true);\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: activeObj } });\n        parent.objColl.pop();\n        parent.transform.degree = 0;\n        this.cropImg(true);\n        this.revertTransform('reverse', coll);\n        parent.afterCropActions = afterCropActions;\n        parent.currSelectionPoint = tempCurrSelObj;\n        parent.notify('transform', { prop: 'setPreventSelect', onPropertyChange: false, value: { bool: preventSelObj['bool'] } });\n        parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n        parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.upperContext } });\n        if (shape === 'crop-circle') {\n            this.cropCircle(this.lowerContext);\n        }\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        parent.notify('draw', { prop: 'resetPanPoints', onPropertyChange: false });\n    };\n    Crop.prototype.revertTransform = function (type, coll) {\n        var parent = this.parent;\n        var obj = { isRotate: false };\n        if (type === 'initial') {\n            for (var i = coll.length - 1; i >= 0; i--) {\n                switch (coll[i]) {\n                    case 90:\n                        parent.notify('transform', { prop: 'rotate', value: { degree: -90, obj: obj } });\n                        break;\n                    case -90:\n                        parent.notify('transform', { prop: 'rotate', value: { degree: 90, obj: obj } });\n                        break;\n                    default:\n                        parent.notify('transform', { prop: 'flipImage', value: { direction: parent.toPascalCase(coll[i]) } });\n                        break;\n                }\n            }\n        }\n        else {\n            for (var i = 0, len = parent.objColl.length; i < len; i++) {\n                parent.objColl[i].shapeFlip = '';\n            }\n            for (var i = 0; i < parent.freehandCounter; i++) {\n                parent.pointColl[i].shapeFlip = '';\n            }\n            for (var i = 0, len = coll.length; i < len; i++) {\n                switch (coll[i]) {\n                    case 90:\n                        parent.notify('transform', { prop: 'rotate', value: { degree: 90, obj: obj } });\n                        break;\n                    case -90:\n                        parent.notify('transform', { prop: 'rotate', value: { degree: -90, obj: obj } });\n                        break;\n                    default:\n                        parent.notify('transform', { prop: 'flipImage', value: { direction: parent.toPascalCase(coll[i]) } });\n                        break;\n                }\n            }\n        }\n    };\n    Crop.prototype.resetZoom = function () {\n        var parent = this.parent;\n        if (parent.transform.zoomFactor > 0) {\n            var zoomFactor = parent.transform.zoomFactor;\n            var isUndoRedo = parent.isUndoRedo;\n            for (var i = 0; i < (zoomFactor * 10); i++) {\n                parent.isUndoRedo = true;\n                parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                    value: { zoomFactor: -0.1, zoomPoint: null } });\n            }\n            parent.isUndoRedo = isUndoRedo;\n            parent.notify('draw', { prop: 'resetPanPoints', onPropertyChange: false });\n        }\n    };\n    Crop.prototype.flipCrop = function () {\n        var parent = this.parent;\n        parent.notify('transform', { prop: 'setReverseFlip', onPropertyChange: false, value: { isReverseFlip: true } });\n        parent.panPoint.totalPannedPoint.x += this.tempFlipPanPoint.x;\n        parent.panPoint.totalPannedPoint.y += this.tempFlipPanPoint.y;\n        var tempCurrFlipState = parent.transform.currFlipState;\n        var obj = { flipColl: null };\n        parent.notify('transform', { prop: 'getFlipColl', onPropertyChange: false, value: { obj: obj } });\n        var tempFlipColl = obj['flipColl'];\n        parent.notify('transform', { prop: 'setFlipColl', onPropertyChange: false, value: { flipColl: [] } });\n        parent.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n        parent.objColl.push(parent.activeObj);\n        this.resetZoom();\n        parent.currSelectionPoint = extend({}, parent.objColl[parent.objColl.length - 1], {}, true);\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        var temp = this.lowerContext.filter;\n        parent.notify('filter', { prop: 'updateBrightFilter', onPropertyChange: false });\n        this.lowerContext.drawImage(parent.baseImg, parent.img.srcLeft, parent.img.srcTop, parent.img.srcWidth, parent.img.srcHeight, parent.img.destLeft, parent.img.destTop, parent.img.destWidth, parent.img.destHeight);\n        for (var i = 0, len = parent.objColl.length; i < len; i++) {\n            parent.objColl[i].shapeFlip = '';\n        }\n        for (var i = 0; i < parent.freehandCounter; i++) {\n            parent.pointColl[i].shapeFlip = '';\n        }\n        parent.notify('shape', { prop: 'redrawObj', onPropertyChange: false, value: { degree: this.getCurrFlipState() } });\n        parent.notify('freehand-draw', { prop: 'flipFHDColl', onPropertyChange: false,\n            value: { value: this.getCurrFlipState() } });\n        parent.activeObj = extend({}, parent.objColl[parent.objColl.length - 1], {}, true);\n        parent.objColl.pop();\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate' } });\n        this.cropImg(true);\n        parent.notify('transform', { prop: 'setReverseRotate', onPropertyChange: false, value: { bool: true } });\n        this.lowerContext.setTransform(1, 0, 0, 1, 0, 0);\n        parent.notify('draw', { prop: 'setDestPoints', onPropertyChange: false });\n        parent.notify('draw', { prop: 'currTransState', onPropertyChange: false,\n            value: { type: 'initial', isPreventDestination: null, context: null, isPreventCircleCrop: null } });\n        parent.notify('filter', { prop: 'updateBrightFilter', onPropertyChange: false });\n        this.lowerContext.drawImage(parent.baseImg, parent.img.srcLeft, parent.img.srcTop, parent.img.srcWidth, parent.img.srcHeight, parent.img.destLeft, parent.img.destTop, parent.img.destWidth, parent.img.destHeight);\n        this.lowerContext.filter = temp;\n        parent.notify('draw', { prop: 'setRotateZoom', onPropertyChange: false, value: { isRotateZoom: false } });\n        parent.notify('draw', { prop: 'currTransState', onPropertyChange: false,\n            value: { type: 'reverse', isPreventDestination: null, context: null, isPreventCircleCrop: null } });\n        parent.transform.currFlipState = tempCurrFlipState;\n        parent.notify('transform', { prop: 'setFlipColl', onPropertyChange: false, value: { flipColl: tempFlipColl } });\n        this.lowerContext.filter = 'none';\n        for (var i = 0, len = parent.objColl.length; i < len; i++) {\n            parent.objColl[i].shapeFlip = '';\n        }\n        for (var i = 0; i < parent.freehandCounter; i++) {\n            parent.pointColl[i].shapeFlip = '';\n        }\n        parent.notify('shape', { prop: 'redrawObj', onPropertyChange: false, value: { degree: this.getCurrFlipState() } });\n        parent.notify('freehand-draw', { prop: 'flipFHDColl', onPropertyChange: false,\n            value: { value: this.getCurrFlipState() } });\n        parent.notify('shape', { prop: 'zoomObjColl', onPropertyChange: false, value: { isPreventApply: null } });\n        parent.notify('freehand-draw', { prop: 'zoomFHDColl', onPropertyChange: false, value: { isPreventApply: null } });\n        this.lowerContext.filter = temp;\n        if ((parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle') || parent.isCircleCrop) {\n            this.cropCircle(this.lowerContext);\n        }\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n        parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.upperContext } });\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        parent.notify('transform', { prop: 'setReverseFlip', onPropertyChange: false, value: { isReverseFlip: false } });\n        parent.notify('draw', { prop: 'resetPanPoints', onPropertyChange: false });\n        this.tempFlipPanPoint = { x: 0, y: 0 };\n    };\n    Crop.prototype.cropObjColl = function () {\n        var parent = this.parent;\n        var point;\n        var activePoint;\n        var shape;\n        if (parent.objColl.length > 0) {\n            for (var i = 0, len = parent.objColl.length; i < len; i++) {\n                point = parent.objColl[i].activePoint;\n                activePoint = parent.activeObj.activePoint;\n                shape = parent.objColl[i].shape;\n                parent.objColl[i].imageRatio = { startX: ((point.startX - activePoint.startX) / activePoint.width),\n                    startY: ((point.startY - activePoint.startY) / activePoint.height),\n                    endX: ((point.endX - activePoint.startX) / activePoint.width),\n                    endY: ((point.endY - activePoint.startY) / activePoint.height),\n                    width: activePoint.width / point.width,\n                    height: activePoint.height / point.height };\n                var degree = void 0;\n                var size = void 0;\n                switch (shape) {\n                    case 'text':\n                        if (parent.objColl[i].shapeDegree === 0) {\n                            degree = this.parent.transform.degree;\n                        }\n                        else {\n                            degree = this.parent.transform.degree - parent.objColl[i].shapeDegree;\n                        }\n                        size = (degree === 0 || Math.abs(degree) === 180) ? point.width : point.height;\n                        parent.objColl[i].textSettings.fontRatio = size / parent.objColl[i].textSettings.fontSize;\n                        break;\n                    case 'line':\n                    case 'arrow':\n                        this.cropPointCollection(i);\n                        if (shape === 'arrow') {\n                            parent.notify('shape', { prop: 'updateArrowRatio', onPropertyChange: false, value: { obj: parent.objColl[i] } });\n                        }\n                        break;\n                    case 'path':\n                        this.cropPointCollection(i);\n                        break;\n                }\n            }\n        }\n    };\n    Crop.prototype.cropPointCollection = function (i) {\n        var parent = this.parent;\n        var shape = parent.objColl[i].shape;\n        var x;\n        var y;\n        var width;\n        var height;\n        var point = parent.activeObj.activePoint;\n        if (shape === 'path') {\n            x = point.startX;\n            y = point.startY;\n            width = point.width;\n            height = point.height;\n        }\n        else {\n            x = parent.img.destLeft;\n            y = parent.img.destTop;\n            width = parent.img.destWidth;\n            height = parent.img.destHeight;\n        }\n        var selPoint = parent.objColl[i];\n        for (var n = 0, len = selPoint.pointColl.length; n < len; n++) {\n            selPoint.pointColl[n].ratioX =\n                (selPoint.pointColl[n].x - x) / width;\n            selPoint.pointColl[n].ratioY =\n                (selPoint.pointColl[n].y - y) / height;\n        }\n    };\n    Crop.prototype.cropFreehandDrawColl = function () {\n        var parent = this.parent;\n        // Update crop values to point collection\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            parent.points = extend([], parent.pointColl[n].points, []);\n            parent.notify('freehand-draw', { prop: 'setPointCounter', onPropertyChange: false, value: { value: 0 } });\n            var len = parent.points.length;\n            for (var l = 0; l < len; l++) {\n                parent.points[l].ratioX = (parent.points[l].x -\n                    parent.activeObj.activePoint.startX) / parent.activeObj.activePoint.width;\n                parent.points[l].ratioY = (parent.points[l].y -\n                    parent.activeObj.activePoint.startY) / parent.activeObj.activePoint.height;\n            }\n        }\n        parent.notify('freehand-draw', { prop: 'updateCropPtsForSel', onPropertyChange: false });\n    };\n    Crop.prototype.setCurrSelPoints = function (isSetDimension) {\n        var parent = this.parent;\n        var destPoint = this.cropDestPoints;\n        var filter = this.lowerContext.filter;\n        parent.img.srcLeft = 0;\n        parent.img.srcTop = 0;\n        parent.img.srcWidth = parent.baseImg.width;\n        parent.img.srcHeight = parent.baseImg.height;\n        parent.img.destLeft = destPoint.startX;\n        parent.img.destTop = destPoint.startY;\n        parent.img.destWidth = destPoint.width;\n        parent.img.destHeight = destPoint.height;\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        if (isSetDimension) {\n            parent.notify('draw', { prop: 'setDestPoints', onPropertyChange: false });\n        }\n        parent.notify('draw', { prop: 'currTransState', onPropertyChange: false,\n            value: { type: 'initial', isPreventDestination: null, context: null, isPreventCircleCrop: null } });\n        if (this.croppedDegree === 0 && parent.transform.degree === 0 && parent.currSelectionPoint\n            && parent.currSelectionPoint.shape !== 'crop-circle' && parent.currSelectionPoint.shape !== 'crop-square') {\n            parent.img.destLeft = destPoint.startX;\n            parent.img.destTop = destPoint.startY;\n            parent.img.destWidth = destPoint.width;\n            parent.img.destHeight = destPoint.height;\n        }\n        if (parent.transform.degree === 0) {\n            parent.img.destLeft += parent.panPoint.totalPannedInternalPoint.x;\n            parent.img.destTop += parent.panPoint.totalPannedInternalPoint.y;\n        }\n        parent.notify('filter', { prop: 'updateBrightFilter', onPropertyChange: false });\n        this.lowerContext.drawImage(parent.baseImg, parent.img.srcLeft, parent.img.srcTop, parent.img.srcWidth, parent.img.srcHeight, parent.img.destLeft, parent.img.destTop, parent.img.destWidth, parent.img.destHeight);\n        this.lowerContext.filter = filter;\n        parent.notify('draw', { prop: 'currTransState', onPropertyChange: false,\n            value: { type: 'reverse', isPreventDestination: null, context: null, isPreventCircleCrop: true } });\n        var cropObjColl = extend([], parent.objColl, null, true);\n        var cropPointColl = extend([], parent.pointColl, null, true);\n        parent.objColl = [];\n        parent.pointColl = [];\n        parent.freehandCounter = 0;\n        this.panToSelRangle();\n        parent.objColl = cropObjColl;\n        parent.pointColl = cropPointColl;\n        parent.freehandCounter = parent.pointColl.length;\n        if (parent.cropObj.activeObj.shape) {\n            var destPoints = { startX: parent.img.destLeft, startY: parent.img.destTop, width: parent.img.destWidth,\n                height: parent.img.destHeight };\n            if (parent.currSelectionPoint && parent.currSelectionPoint.activePoint) {\n                parent.img.destLeft = parent.currSelectionPoint.activePoint.startX;\n                parent.img.destTop = parent.currSelectionPoint.activePoint.startY;\n                parent.img.destWidth = parent.currSelectionPoint.activePoint.width;\n                parent.img.destHeight = parent.currSelectionPoint.activePoint.height;\n            }\n            parent.notify('shape', { prop: 'zoomObjColl', onPropertyChange: false, value: { isPreventApply: null } });\n            parent.notify('freehand-draw', { prop: 'zoomFHDColl', onPropertyChange: false, value: { isPreventApply: null } });\n            parent.img.destLeft = destPoints.startX;\n            parent.img.destTop = destPoints.startY;\n            parent.img.destWidth = destPoints.width;\n            parent.img.destHeight = destPoints.height;\n            parent.notify('freehand-draw', { prop: 'updateFHDColl', onPropertyChange: false });\n            cropObjColl = extend([], parent.objColl, null, true);\n            cropPointColl = extend([], parent.pointColl, null, true);\n            parent.objColl = [];\n            parent.pointColl = [];\n            parent.freehandCounter = 0;\n            var object = { selPointColl: null };\n            parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                value: { obj: object } });\n            var cropSelPointColl = object['selPointColl'];\n            parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n                value: { obj: { selPointColl: [] } } });\n            parent.cropObj.filter = this.lowerContext.filter;\n            var actObj = extend({}, parent.currSelectionPoint, null, true);\n            parent.notify('draw', { prop: 'setCurrentObj', onPropertyChange: false, value: { obj: null } });\n            parent.activeObj = extend({}, actObj, null, true);\n            var activeObj = extend({}, parent.activeObj, null, true);\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            this.panToSelRangle();\n            parent.objColl = cropObjColl;\n            parent.pointColl = cropPointColl;\n            parent.freehandCounter = parent.pointColl.length;\n            parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n                value: { obj: { selPointColl: cropSelPointColl } } });\n            parent.notify('shape', { prop: 'iterateObjColl', onPropertyChange: false });\n            parent.notify('freehand-draw', { prop: 'freehandRedraw', onPropertyChange: false,\n                value: { context: this.lowerContext, points: null } });\n            parent.notify('freehand-draw', { prop: 'updateFHDColl', onPropertyChange: false });\n            parent.notify('shape', { prop: 'zoomObjColl', onPropertyChange: false, value: { isPreventApply: null } });\n            parent.notify('freehand-draw', { prop: 'zoomFHDColl', onPropertyChange: false, value: { isPreventApply: null } });\n            parent.currSelectionPoint = null;\n            if (parent.transform.degree === 0) {\n                parent.notify('transform', { prop: 'drawPannImage', onPropertyChange: false,\n                    value: { point: { x: 0, y: 0 } } });\n            }\n            parent.activeObj = activeObj;\n            parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate' } });\n            parent.notify('transform', { prop: 'setTempPanMove', onPropertyChange: false,\n                value: { point: null } });\n            if (!this.isInitCrop && parent.transform.degree === 0 && parent.cropObj.currFlipState !== '' &&\n                parent.cropObj.cropZoom !== 0) {\n                this.isInitCrop = true;\n                parent.notify('draw', { prop: 'performCancel', value: { isContextualToolbar: null } });\n                parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'croptransform',\n                        isApplyBtn: false, isCropping: null, isZooming: null, cType: null } });\n            }\n            else {\n                this.isInitCrop = false;\n            }\n        }\n        else {\n            var temp = this.lowerContext.filter;\n            this.lowerContext.filter = 'none';\n            parent.notify('shape', { prop: 'iterateObjColl', onPropertyChange: false });\n            parent.notify('freehand-draw', { prop: 'freehandRedraw', onPropertyChange: false,\n                value: { context: this.lowerContext, points: null } });\n            this.lowerContext.filter = temp;\n            parent.currSelectionPoint = null;\n        }\n    };\n    Crop.prototype.panToSelRangle = function (isReverse) {\n        var parent = this.parent;\n        var obj = extend({}, parent.currSelectionPoint, null, true);\n        parent.currSelectionPoint = null;\n        var panX = parent.transform.degree !== 0 ?\n            isReverse ? -parent.cropObj.totalPannedClientPoint.x : parent.cropObj.totalPannedClientPoint.x : 0;\n        var panY = parent.transform.degree !== 0 ?\n            isReverse ? -parent.cropObj.totalPannedClientPoint.y : parent.cropObj.totalPannedClientPoint.y : 0;\n        if (parent.transform.degree !== 0) {\n            parent.panPoint.currentPannedPoint = { x: panX, y: panY };\n            parent.notify('transform', { prop: 'drawPannedImage', value: { xDiff: panX, yDiff: panY } });\n            parent.panPoint.currentPannedPoint = { x: 0, y: 0 };\n        }\n        parent.currSelectionPoint = obj;\n    };\n    Crop.prototype.cropCircle = function (context, isSave, isFlip) {\n        var parent = this.parent;\n        if (isFlip && parent.transform.currFlipState !== '') {\n            parent.notify('draw', { prop: 'setTransform', onPropertyChange: false,\n                value: { context: context, value: parent.transform.currFlipState, isReverse: null } });\n        }\n        context.globalCompositeOperation = 'destination-in';\n        context.beginPath();\n        var centerX = isNullOrUndefined(isSave) ? parent.img.destLeft + (parent.img.destWidth / 2) : context.canvas.width / 2;\n        var centerY = isNullOrUndefined(isSave) ? parent.img.destTop + (parent.img.destHeight / 2) : context.canvas.height / 2;\n        var radius = isSave ? context.canvas.width / 2 : parent.img.destWidth / 2;\n        context.arc(centerX, centerY, radius, 0, Math.PI * 2);\n        context.closePath();\n        context.fill();\n        context.restore();\n        context.globalCompositeOperation = 'source-over';\n        parent.currObjType.isActiveObj = parent.isCircleCrop = true;\n        if (isFlip && parent.transform.currFlipState !== '') {\n            parent.notify('draw', { prop: 'setTransform', onPropertyChange: false,\n                value: { context: context, value: parent.transform.currFlipState, isReverse: null } });\n        }\n    };\n    Crop.prototype.getCurrCropState = function (type, isAllowInvert) {\n        var parent = this.parent;\n        var flipState = '';\n        var state = [];\n        var obj = { flipColl: null };\n        parent.notify('transform', { prop: 'getFlipColl', onPropertyChange: false, value: { obj: obj } });\n        if (type === 'initial') {\n            if (Math.abs(parent.transform.degree) === 180) {\n                flipState = obj['flipColl'].length > 1 ? this.getCurrFlipState() : parent.transform.currFlipState;\n            }\n            else {\n                for (var i = 0, len = parent.rotateFlipColl.length; i < len; i++) {\n                    if (typeof (parent.rotateFlipColl[i]) === 'number') {\n                        state.push('number');\n                    }\n                    else if (typeof (parent.rotateFlipColl[i]) === 'string') {\n                        state.push('string');\n                    }\n                }\n                if (state.length > 1 && state[state.length - 1] === 'string' && state[state.length - 2] === 'number') {\n                    if (parent.transform.currFlipState === 'horizontal') {\n                        flipState = 'vertical';\n                    }\n                    else if (parent.transform.currFlipState === 'vertical') {\n                        flipState = 'horizontal';\n                    }\n                }\n                else if (state.length > 1 && state[state.length - 1] === 'number' && state[state.length - 2] === 'string') {\n                    flipState = obj['flipColl'].length > 1 ? this.getCurrFlipState() : parent.transform.currFlipState;\n                }\n            }\n        }\n        else {\n            flipState = this.getCurrFlipState();\n            if (isAllowInvert || !this.isInitialRotate()) {\n                if (parent.transform.degree === -90 || parent.transform.degree === -270) {\n                    if (flipState === 'horizontal') {\n                        flipState = 'vertical';\n                    }\n                    else if (flipState === 'vertical') {\n                        flipState = 'horizontal';\n                    }\n                }\n            }\n        }\n        if (flipState === '') {\n            flipState = obj['flipColl'].length > 1 ? this.getCurrFlipState() : parent.transform.currFlipState;\n        }\n        return flipState;\n    };\n    Crop.prototype.isInitialRotate = function () {\n        var isRotate = false;\n        if (this.parent.rotateFlipColl.length > 0 && typeof (this.parent.rotateFlipColl[0]) === 'number') {\n            isRotate = true;\n        }\n        return isRotate;\n    };\n    Crop.prototype.updateRotatePan = function () {\n        var parent = this.parent;\n        if (isNullOrUndefined(parent.panPoint.currentPannedPoint)) {\n            return;\n        }\n        var panRegion = '';\n        if (parent.rotateFlipColl.length > 0 && typeof (parent.rotateFlipColl[0]) === 'number'\n            && parent.transform.degree < 0) {\n            panRegion = this.getCurrCropState('reverse', true);\n        }\n        else {\n            panRegion = this.getCurrFlipState();\n        }\n        if (parent.transform.degree % 90 === 0 && parent.transform.degree % 180 !== 0) {\n            if (parent.transform.degree === 90 || (parent.transform.degree === -90 &&\n                (panRegion === 'horizontal' || panRegion === 'vertical'))\n                || (parent.transform.degree === -270 && (panRegion === '' || panRegion === 'verticalHorizontal'\n                    || panRegion === 'horizontalVertical'))) {\n                if (panRegion === 'horizontal' || panRegion === '') {\n                    parent.img.destLeft += parent.panPoint.currentPannedPoint.y;\n                }\n                else {\n                    parent.img.destLeft -= parent.panPoint.currentPannedPoint.y;\n                }\n                if (panRegion === '' || panRegion === 'vertical') {\n                    parent.img.destTop -= parent.panPoint.currentPannedPoint.x;\n                }\n                else {\n                    parent.img.destTop += parent.panPoint.currentPannedPoint.x;\n                }\n            }\n            else if (parent.transform.degree === 270 || (parent.transform.degree === -270 &&\n                (panRegion === 'horizontal' || panRegion === 'vertical'))\n                || (parent.transform.degree === -90 && (panRegion === '' || panRegion === 'verticalHorizontal'\n                    || panRegion === 'horizontalVertical'))) {\n                if (panRegion === '' || panRegion === 'horizontal') {\n                    parent.img.destLeft -= parent.panPoint.currentPannedPoint.y;\n                }\n                else {\n                    parent.img.destLeft += parent.panPoint.currentPannedPoint.y;\n                }\n                if (panRegion === '' || panRegion === 'vertical') {\n                    parent.img.destTop += parent.panPoint.currentPannedPoint.x;\n                }\n                else {\n                    parent.img.destTop -= parent.panPoint.currentPannedPoint.x;\n                }\n            }\n        }\n        else {\n            if (parent.transform.degree === 180 || parent.transform.degree === -180) {\n                if (panRegion === '' || panRegion === 'vertical') {\n                    parent.img.destLeft -= parent.panPoint.currentPannedPoint.x;\n                }\n                else {\n                    parent.img.destLeft += parent.panPoint.currentPannedPoint.x;\n                }\n                if (panRegion === '' || panRegion === 'horizontal') {\n                    parent.img.destTop -= parent.panPoint.currentPannedPoint.y;\n                }\n                else {\n                    parent.img.destTop += parent.panPoint.currentPannedPoint.y;\n                }\n            }\n        }\n    };\n    Crop.prototype.crop = function (obj) {\n        var _this = this;\n        var parent = this.parent;\n        if (!parent.disabled && parent.isImageLoaded) {\n            var object_1 = { isCropToolbar: parent.isCropToolbar };\n            if (parent.currObjType.isUndoAction && !object_1['isCropToolbar']) {\n                parent.notify('undo-redo', { prop: 'refreshUrc', value: { bool: null } });\n            }\n            var transitionArgs = { cancel: false, startPoint: { x: parent.activeObj.activePoint.startX,\n                    y: parent.activeObj.activePoint.startY }, endPoint: { x: parent.activeObj.activePoint.endX,\n                    y: parent.activeObj.activePoint.endY }, preventScaling: false };\n            if (!object_1['isCropToolbar'] && isBlazor() && parent.events && parent.events.cropping.hasDelegate === true) {\n                /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                parent.dotNetRef.invokeMethodAsync('CropEventAsync', 'OnCrop', transitionArgs).then(function (args) {\n                    _this.cropEvent(args, obj, object_1);\n                });\n            }\n            else {\n                if (!object_1['isCropToolbar']) {\n                    parent.trigger('cropping', transitionArgs);\n                }\n                this.cropEvent(transitionArgs, obj, object_1);\n            }\n        }\n    };\n    Crop.prototype.cropEvent = function (transitionArgs, obj, object) {\n        var parent = this.parent;\n        var splitWords;\n        if (!transitionArgs.cancel) {\n            splitWords = parent.activeObj.shape ? parent.activeObj.shape.split('-') : [];\n            if (!parent.disabled && parent.activeObj.horTopLine && (parent.currObjType.isCustomCrop || (splitWords.length > 0 &&\n                splitWords[0] === 'crop'))) {\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                obj.isCrop = true;\n                var prevCropObj = extend({}, parent.cropObj, {}, true);\n                var prevObj = extend({}, this.prevCropCurrObj, {}, true);\n                if (transitionArgs.preventScaling) {\n                    this.isPreventScaling = true;\n                }\n                else {\n                    this.isPreventScaling = false;\n                }\n                this.cropImg();\n                parent.transform.zoomFactor = 0;\n                parent.setProperties({ zoomSettings: { zoomFactor: 1 } }, true);\n                parent.notify('transform', { prop: 'setPreviousZoomValue', onPropertyChange: false,\n                    value: { previousZoomValue: parent.zoomSettings.zoomFactor } });\n                var currSelPtObj = { prevCurrSelectionPoint: this.parent.prevCurrSelectionPoint };\n                prevObj.currSelectionPoint = extend({}, currSelPtObj['prevCurrSelectionPoint'], {}, true);\n                parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                    value: { operation: 'crop', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                        previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                        previousCropObj: prevCropObj, previousText: null,\n                        currentText: null, previousFilter: null, isCircleCrop: parent.isCircleCrop } });\n                if (!object['isCropToolbar']) {\n                    parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n                }\n                parent.notify('transform', { prop: 'setCropDimension', onPropertyChange: false,\n                    value: { width: parent.cropObj.destPoints.width, height: parent.cropObj.destPoints.height } });\n                if (!isBlazor() && !object['isCropToolbar']) {\n                    parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'main',\n                            isApplyBtn: false, isCropping: false, isZooming: null, cType: null } });\n                }\n                else if (!object['isCropToolbar']) {\n                    this.parent.updateToolbar(this.parent.element, 'imageLoaded');\n                }\n            }\n        }\n    };\n    Crop.prototype.calcRatio = function (obj, dimension) {\n        var parent = this.parent;\n        var widthRatio;\n        var heightRatio;\n        if (parent.transform.degree === 0 || parent.transform.degree % 180 === 0) {\n            widthRatio = (dimension ? dimension.width : parent.baseImg.width) / parent.img.destWidth;\n            heightRatio = (dimension ? dimension.height : parent.baseImg.height) / parent.img.destHeight;\n        }\n        else {\n            widthRatio = (dimension ? dimension.height : parent.baseImg.height) / parent.img.destWidth;\n            heightRatio = (dimension ? dimension.width : parent.baseImg.width) / parent.img.destHeight;\n        }\n        if (obj) {\n            obj['width'] = widthRatio;\n            obj['height'] = heightRatio;\n        }\n        return { width: widthRatio, height: heightRatio };\n    };\n    Crop.prototype.isObjInImage = function (obj, dummyObj) {\n        var parent = this.parent;\n        var isInside = false;\n        var startX = obj.activePoint.startX;\n        var endX = obj.activePoint.endX;\n        var startY = obj.activePoint.startY;\n        var endY = obj.activePoint.endY;\n        if ((startX >= parent.img.destLeft && endX <= (parent.img.destLeft + parent.img.destWidth)) ||\n            (startX <= parent.img.destLeft && endX >= parent.img.destLeft) ||\n            (startX <= (parent.img.destLeft + parent.img.destWidth) && endX >= (parent.img.destLeft + parent.img.destWidth)) ||\n            (startY >= parent.img.destTop && endY <= (parent.img.destTop + parent.img.destHeight)) ||\n            (startY <= parent.img.destTop && endY >= parent.img.destTop) ||\n            (startY <= (parent.img.destTop + parent.img.destHeight) && endY >= (parent.img.destTop + parent.img.destHeight))) {\n            isInside = true;\n        }\n        if (dummyObj) {\n            dummyObj['isInside'] = isInside;\n        }\n        return isInside;\n    };\n    Crop.prototype.getCurrFlipState = function (panObj) {\n        var parent = this.parent;\n        var obj = { panRegion: '' };\n        var object = { collection: parent.rotateFlipColl };\n        parent.notify('shape', { prop: 'alignRotateFlipColl', onPropertyChange: false,\n            value: { collection: parent.rotateFlipColl, isRotateFlipCollection: true, obj: object } });\n        parent.rotateFlipColl = object['collection'];\n        for (var i = 0, len = parent.rotateFlipColl.length; i < len; i++) {\n            parent.notify('transform', { prop: 'setCurrPanRegion', onPropertyChange: false,\n                value: { region: obj['panRegion'], type: parent.rotateFlipColl[i], obj: obj } });\n        }\n        if (panObj) {\n            panObj['panRegion'] = obj['panRegion'];\n        }\n        return obj['panRegion'];\n    };\n    return Crop;\n}());\nexport { Crop };\n","import { extend, isNullOrUndefined, Browser, isBlazor, getComponent } from '@syncfusion/ej2-base';\nimport { Dialog, hideSpinner, showSpinner } from '@syncfusion/ej2-popups';\nvar Draw = /** @class */ (function () {\n    function Draw(parent) {\n        this.isInitialLoading = false; // Specifies whether image is loaded for the first time or not (for applying initial filter)\n        this.fileName = '';\n        this.isErrorImage = false;\n        this.isShapeTextInserted = false;\n        this.isRotateZoom = false; // To restore zoomed image on selection crop selection\n        this.tempStrokeSettings = { strokeColor: '#fff', fillColor: '', strokeWidth: null }; // restore stroke settings on cancel\n        this.tempTextSettings = { text: 'Enter Text', fontFamily: 'Arial', fontSize: null, fontRatio: null, bold: false, italic: false, underline: false }; // restore text settings on cancel\n        this.tempAdjValue = ''; // for temp internal slider value\n        this.tempFilter = ''; // restore filter style on cancel\n        this.tempUndoRedoStep = 0;\n        this.tempFreehandCounter = 0;\n        this.tempCurrFhdIndex = 0;\n        this.tempZoomFactor = null; // Restore zoom factor on cancel\n        this.isCancelAction = false;\n        this.rotatedFlipCropSel = false;\n        this.zoomCrop = { width: 0, height: 0 };\n        this.isImageEdited = false;\n        this.isFileChanged = false;\n        this.isNewPath = false;\n        this.arrowDimension = { bar: { width: 10, height: 32, ratioX: null, ratioY: null },\n            arrow: { width: 24, height: 24, ratioX: null, ratioY: null }, arrowSolid: { width: 32, height: 32, ratioX: null, ratioY: null },\n            circle: { width: 10, height: 10, ratioX: null, ratioY: null }, square: { width: 20, height: 20, ratioX: null, ratioY: null } };\n        this.parent = parent;\n        this.addEventListener();\n    }\n    Draw.prototype.destroy = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.removeEventListener();\n    };\n    Draw.prototype.addEventListener = function () {\n        this.parent.on('draw', this.draw, this);\n        this.parent.on('destroyed', this.destroy, this);\n    };\n    Draw.prototype.removeEventListener = function () {\n        this.parent.off('draw', this.draw);\n        this.parent.off('destroyed', this.destroy);\n    };\n    Draw.prototype.draw = function (args) {\n        this.updatePrivateVariables();\n        switch (args.prop) {\n            case 'drawObject':\n                this.drawObject(args.value['canvas'], args.value['obj'], args.value['isCropRatio'], args.value['points'], args.value['isPreventDrag'], args.value['saveContext'], args.value['isPreventSelection']);\n                break;\n            case 'updateActiveObject':\n                this.updateActiveObject(args.value['actPoint'], args.value['obj'], args.value['isMouseMove'], args.value['x'], args.value['y']);\n                break;\n            case 'clearOuterCanvas':\n                this.clearOuterCanvas(args.value['context']);\n                break;\n            case 'setDestPoints':\n                this.setDestPoints();\n                break;\n            case 'updateCurrTransState':\n                this.updateCurrTransState(args.value['type'], args.value['isPreventDestination'], args.value['isRotatePan']);\n                break;\n            case 'currTransState':\n                this.currTransState(args.value['type'], args.value['isPreventDestination'], args.value['context'], args.value['isPreventCircleCrop']);\n                break;\n            case 'setTransform':\n                this.setTransform(args.value['context'], args.value['value'], args.value['isReverse']);\n                break;\n            case 'render-image':\n                this.renderImage(args.value['isMouseWheel']);\n                break;\n            case 'draw-image-to-canvas':\n                this.drawImgToCanvas(args.value['dimension']);\n                break;\n            case 'update-canvas':\n                this.updateCanvas();\n                break;\n            case 'performCancel':\n                this.performCancel(args.value['isContextualToolbar']);\n                break;\n            case 'updateFlipPan':\n                this.updateFlipPan(args.value['tempSelectionObj']);\n                break;\n            case 'select':\n                this.select(args.value['type'], args.value['startX'], args.value['startY'], args.value['width'], args.value['height']);\n                break;\n            case 'callUpdateCurrTransState':\n                this.callUpdateCurrTransState();\n                break;\n            case 'resetPanPoints':\n                this.resetPanPoints();\n                break;\n            case 'setClientTransDim':\n                this.setClientTransDim(args.value['isPreventDimension']);\n                break;\n            case 'redrawImgWithObj':\n                this.redrawImgWithObj();\n                break;\n            case 'setCurrentObj':\n                this.setCurrentObj(args.value['obj']);\n                break;\n            case 'performPointZoom':\n                this.performPointZoom(args.value['x'], args.value['y'], args.value['type']);\n                break;\n            case 'open':\n                this.open(args.value['data']);\n                break;\n            case 'isInitialLoading':\n                this.isInitialLoading = args.value['isInitialLoading'];\n                break;\n            case 'isInitialLoaded':\n                this.getInitialLoaded(args.value['object']);\n                break;\n            case 'fileSelect':\n                this.fileSelect(args.value['inputElement'], args.value['args']);\n                break;\n            case 'getFileName':\n                args.value['obj']['fileName'] = this.fileName;\n                args.value['obj']['fileType'] = this.fileType;\n                break;\n            case 'getErrorImage':\n                args.value['obj']['isErrorImage'] = this.isErrorImage;\n                break;\n            case 'getInitialZoomValue':\n                args.value['obj']['initialZoomValue'] = this.initZoomValue;\n                break;\n            case 'setShapeTextInsert':\n                this.isShapeTextInserted = args.value['bool'];\n                break;\n            case 'resetCurrentSelectionPoint':\n                this.currSelPoint = null;\n                break;\n            case 'setRotateZoom':\n                this.isRotateZoom = args.value['isRotateZoom'];\n                break;\n            case 'setTempStrokeSettings':\n                this.tempStrokeSettings = args.value['tempStrokeSettings'];\n                break;\n            case 'setTempTextSettings':\n                this.tempTextSettings = args.value['tempTextSettings'];\n                break;\n            case 'setTempAdjustmentValue':\n                this.tempAdjValue = args.value['tempAdjustmentValue'];\n                break;\n            case 'getTempAdjustmentValue':\n                args.value['obj']['value'] = this.tempAdjValue;\n                break;\n            case 'setTempFilter':\n                this.tempFilter = args.value['tempFilter'];\n                break;\n            case 'setTempUndoRedoStep':\n                this.tempUndoRedoStep = args.value['tempUndoRedoStep'];\n                break;\n            case 'setTempFreehandCounter':\n                this.tempFreehandCounter = args.value['tempFreehandCounter'];\n                break;\n            case 'setTempCurrentFreehandDrawIndex':\n                this.tempCurrFhdIndex = args.value['tempCurrentFreehandDrawIndex'];\n                break;\n            case 'setTempZoomFactor':\n                this.tempZoomFactor = args.value['tempZoomFactor'];\n                break;\n            case 'setCancelAction':\n                this.isCancelAction = args.value['bool'];\n                break;\n            case 'getRotatedFlipCropSelection':\n                args.value['bool']['isSelected'] = this.rotatedFlipCropSel;\n                break;\n            case 'getPrevActObj':\n                args.value['obj']['prevActObj'] = this.prevActObj;\n                break;\n            case 'setPrevActObj':\n                this.prevActObj = args.value['prevActObj'];\n                break;\n            case 'setZoomCropWidth':\n                this.zoomCrop.width = args.value['width'];\n                this.zoomCrop.height = args.value['height'];\n                break;\n            case 'setImageEdited':\n                this.isImageEdited = true;\n                break;\n            case 'reset':\n                this.reset();\n                break;\n            case 'dlgBtnClick':\n                this.dlgBtnClick();\n                break;\n            case 'dlgCloseBtnClick':\n                this.dlgCloseBtnClick();\n                break;\n            case 'setNewPath':\n                this.isNewPath = args.value['bool'];\n                break;\n            case 'getNewPath':\n                args.value['obj']['isNewPath'] = this.isNewPath;\n                break;\n            case 'getArrowDimension':\n                args.value['obj']['arrowDimension'] = this.arrowDimension;\n                break;\n            case 'setArrowDimension':\n                this.arrowDimension = args.value['arrowDimension'];\n                break;\n            case 'moveToSelectionRange':\n                this.moveToSelectionRange(args.value['type'], args.value['activeObj']);\n                break;\n        }\n    };\n    Draw.prototype.getModuleName = function () {\n        return 'draw';\n    };\n    Draw.prototype.updatePrivateVariables = function () {\n        var parent = this.parent;\n        if (parent.lowerCanvas) {\n            this.lowerContext = parent.lowerCanvas.getContext('2d');\n        }\n        if (parent.upperCanvas) {\n            this.upperContext = parent.upperCanvas.getContext('2d');\n        }\n        if (isNullOrUndefined(this.tempZoomFactor)) {\n            this.tempZoomFactor = parent.transform.zoomFactor;\n        }\n    };\n    Draw.prototype.reset = function () {\n        this.isInitialLoading = this.isErrorImage = this.isNewPath = false;\n        this.isShapeTextInserted = false;\n        this.initZoomValue = null;\n        this.tempFilter = '';\n        this.currSelPoint = null;\n        this.isRotateZoom = false;\n        this.tempAdjValue = '';\n        this.tempStrokeSettings = { strokeColor: '#fff', fillColor: '', strokeWidth: null };\n        this.tempTextSettings =\n            { text: 'Enter Text', fontFamily: 'Arial', fontSize: null, fontRatio: null, bold: false, italic: false, underline: false };\n        this.tempUndoRedoStep = this.tempFreehandCounter = this.tempCurrFhdIndex = 0;\n        this.tempZoomFactor = null;\n        this.isCancelAction = false;\n        this.rotatedFlipCropSel = false;\n        this.prevActObj = null;\n        this.arrowDimension = { bar: { width: 10, height: 32, ratioX: null, ratioY: null },\n            arrow: { width: 24, height: 24, ratioX: null, ratioY: null }, arrowSolid: { width: 32, height: 32, ratioX: null, ratioY: null },\n            circle: { width: 10, height: 10, ratioX: null, ratioY: null }, square: { width: 20, height: 20, ratioX: null, ratioY: null } };\n    };\n    Draw.prototype.drawObject = function (canvas, obj, isCropRatio, points, isPreventDrag, saveContext, isPreventSelection) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        var canvasDraw;\n        if (canvas.toLowerCase() === 'original') {\n            canvasDraw = this.lowerContext;\n        }\n        else if (canvas.toLowerCase() === 'duplicate') {\n            canvasDraw = this.upperContext;\n        }\n        else if (saveContext) {\n            canvasDraw = saveContext;\n        }\n        if (!isPreventDrag && parent.activeObj.shape) {\n            this.setDragLimit();\n        }\n        if (parent.currObjType.shape) {\n            var splitWords = parent.currObjType.shape.split('-');\n            if (splitWords[0].toLowerCase() === 'crop' && isCropRatio) {\n                this.drawCropRatio();\n            }\n        }\n        if (points) {\n            actPoint.startX = points.startX;\n            actPoint.startY = points.startY;\n            actPoint.endX = points.endX;\n            actPoint.endY = points.endY;\n            actPoint.width = points.width;\n            actPoint.height = points.height;\n        }\n        if (isNullOrUndefined(parent.activeObj.strokeSettings)) {\n            var obj_1 = { strokeSettings: {} };\n            parent.notify('shape', { prop: 'getStrokeSettings', onPropertyChange: false,\n                value: { obj: obj_1 } });\n            parent.activeObj.strokeSettings = obj_1['strokeSettings'];\n        }\n        if (isNullOrUndefined(parent.activeObj.strokeSettings.strokeWidth)) {\n            parent.activeObj.strokeSettings.strokeWidth = 2;\n        }\n        if (obj) {\n            parent.activeObj = extend({}, obj, {}, true);\n        }\n        this.updateActiveObject();\n        if (isNullOrUndefined(parent.activeObj.activePoint.startX) &&\n            isNullOrUndefined(parent.activeObj.activePoint.startY)) {\n            return;\n        }\n        if (parent.currObjType.isText) {\n            var obj_2 = { keyHistory: '' };\n            parent.notify('shape', { prop: 'getKeyHistory', onPropertyChange: false, value: { obj: obj_2 } });\n            parent.activeObj.keyHistory = obj_2['keyHistory'];\n        }\n        if (canvas.toLowerCase() !== 'original') {\n            var splitWords = void 0;\n            var isCrop = false;\n            if (parent.activeObj.shape) {\n                splitWords = parent.activeObj.shape.split('-');\n                if (splitWords[0] === 'crop') {\n                    isCrop = true;\n                }\n            }\n            if (isCrop) {\n                this.upperContext.fillStyle = 'rgb(0, 0, 0, 0.25)';\n                this.upperContext.fillRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n                this.upperContext.clearRect(actPoint.startX, actPoint.startY, actPoint.width, actPoint.height);\n            }\n            if (isNullOrUndefined(isPreventSelection) && (canvasDraw === this.lowerContext || canvasDraw === this.upperContext)) {\n                this.rotateContext('initial', canvasDraw);\n                this.drawOuterSelection(canvasDraw);\n                this.rotateContext('reverse', canvasDraw);\n            }\n        }\n        parent.currObjType.isActiveObj = true;\n        var object = { keyHistory: '' };\n        parent.notify('shape', { prop: 'getKeyHistory', onPropertyChange: false, value: { obj: object } });\n        if (obj) {\n            this.drawShapeObj(canvas, obj.shape, saveContext, isPreventSelection);\n        }\n        else if (object['keyHistory'] !== '' && parent.currObjType.isText) {\n            this.drawShapeObj(canvas, 'text', saveContext, isPreventSelection);\n        }\n        else if (parent.activeObj.shape) {\n            this.drawShapeObj(canvas, parent.activeObj.shape, saveContext, isPreventSelection);\n        }\n        else {\n            this.drawShapeObj(canvas, undefined, saveContext, isPreventSelection);\n        }\n    };\n    Draw.prototype.rotateContext = function (type, ctx) {\n        var parent = this.parent;\n        var activePoint = extend({}, parent.activeObj.activePoint, {}, true);\n        if (parent.activeObj.shape === 'line' || parent.activeObj.shape === 'arrow') {\n            return;\n        }\n        var rotationAngle = (type === 'initial') ? parent.activeObj.rotatedAngle : -parent.activeObj.rotatedAngle;\n        ctx.translate(activePoint.startX + (activePoint.width / 2), activePoint.startY + (activePoint.height / 2));\n        ctx.rotate(rotationAngle);\n        ctx.translate(-(activePoint.startX + (activePoint.width / 2)), -(activePoint.startY + (activePoint.height / 2)));\n    };\n    Draw.prototype.setDragLimit = function () {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        if (actPoint && parent.activeObj.rotatedAngle === 0) {\n            if (actPoint.startX < parent.img.destLeft) {\n                actPoint.startX = parent.img.destLeft;\n                actPoint.endX = actPoint.startX + actPoint.width;\n            }\n            else if (actPoint.endX > parent.img.destLeft + parent.img.destWidth) {\n                actPoint.endX = parent.img.destLeft + parent.img.destWidth;\n                actPoint.startX = actPoint.endX - actPoint.width;\n            }\n            if (actPoint.startY < parent.img.destTop) {\n                actPoint.startY = parent.img.destTop;\n            }\n            else if (actPoint.endY > parent.img.destTop + parent.img.destHeight) {\n                actPoint.endY = parent.img.destTop + parent.img.destHeight;\n                actPoint.startY = actPoint.endY - actPoint.height;\n            }\n            parent.activeObj = this.updateWidthHeight(parent.activeObj);\n        }\n    };\n    Draw.prototype.drawCropRatio = function () {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var x;\n        var y;\n        var width;\n        var height;\n        if (parent.transform.zoomFactor > 0 && this.currSelPoint) {\n            var activeObj = extend({}, parent.activeObj, {}, true);\n            this.drawCustomSelection('crop-custom', null, null, null, null);\n            if (parent.transform.degree % 90 === 0 && parent.transform.degree % 180 !== 0) {\n                width = parent.activeObj.activePoint.width < parent.activeObj.activePoint.height ?\n                    parent.activeObj.activePoint.width : parent.activeObj.activePoint.height;\n                height = width;\n            }\n            else {\n                if (parent.img.destLeft + parent.img.destLeft + parent.img.destWidth <= parent.lowerCanvas.clientWidth) {\n                    width = actPoint.width;\n                }\n                else {\n                    width = parent.lowerCanvas.clientWidth - parent.img.destLeft;\n                }\n                if (parent.img.destTop + parent.img.destTop + parent.img.destHeight <= parent.lowerCanvas.clientHeight) {\n                    height = actPoint.height;\n                }\n                else {\n                    height = parent.lowerCanvas.clientHeight - parent.img.destTop;\n                }\n            }\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            parent.activeObj = activeObj;\n            parent.currObjType.shape = activeObj.shape;\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            parent.currObjType.isCustomCrop = false;\n        }\n        else {\n            width = parent.img.destWidth;\n            height = parent.img.destHeight;\n            if (parent.img.destLeft < 0) {\n                width += parent.img.destLeft;\n            }\n            if (parent.img.destTop < 0) {\n                height += parent.img.destTop;\n            }\n            if (parent.currObjType.shape.toLowerCase() !== 'crop-square' && parent.currObjType.shape.toLowerCase() !== 'crop-circle') {\n                if (parent.img.destLeft + parent.img.destWidth > parent.lowerCanvas.width) {\n                    width -= (parent.img.destLeft + parent.img.destWidth - parent.lowerCanvas.width);\n                }\n                if (parent.img.destTop + parent.img.destHeight > parent.lowerCanvas.height) {\n                    height -= (parent.img.destTop + parent.img.destHeight - parent.lowerCanvas.height);\n                }\n            }\n        }\n        switch (parent.currObjType.shape.toLowerCase()) {\n            case 'crop-square':\n            case 'crop-circle':\n                parent.notify('selection', { prop: 'setDragDirection', onPropertyChange: false, value: { width: width, height: height } });\n                actPoint = parent.activeObj.activePoint;\n                if (parent.lowerCanvas.width < (actPoint.endX - actPoint.startX)) {\n                    actPoint.startX = 7.5;\n                    actPoint.endX = parent.lowerCanvas.width - 7.5;\n                }\n                if (parent.lowerCanvas.height < (actPoint.endY - actPoint.startY)) {\n                    actPoint.startY = 7.5;\n                    actPoint.endY = parent.lowerCanvas.height - 7.5;\n                }\n                if (width === parent.img.destWidth && height === parent.img.destHeight) {\n                    actPoint.startX += parent.img.destLeft;\n                    actPoint.startY +=\n                        parent.img.destTop;\n                    actPoint.endX += parent.img.destLeft;\n                    actPoint.endY +=\n                        parent.img.destTop;\n                }\n                if (parent.lowerCanvas.width > parent.lowerCanvas.height) {\n                    actPoint.height = actPoint.endY - actPoint.startY;\n                    actPoint.width = actPoint.height;\n                    actPoint.endX = actPoint.startX +\n                        actPoint.width;\n                }\n                else {\n                    actPoint.width = actPoint.endX - actPoint.startX;\n                    actPoint.height = actPoint.width;\n                    actPoint.endY = actPoint.startY +\n                        actPoint.height;\n                }\n                break;\n            case 'crop-3:2':\n                x = 3;\n                y = 2;\n                break;\n            case 'crop-4:3':\n                x = 4;\n                y = 3;\n                break;\n            case 'crop-5:4':\n                x = 5;\n                y = 4;\n                break;\n            case 'crop-7:5':\n                x = 7;\n                y = 5;\n                break;\n            case 'crop-16:9':\n                x = 16;\n                y = 9;\n                break;\n        }\n        if (x !== undefined && y !== undefined) {\n            parent.notify('selection', { prop: 'calcShapeRatio', onPropertyChange: false,\n                value: { x: x, y: y, imgWidth: width, imgHeight: height } });\n            if (width === parent.img.destWidth && height === parent.img.destHeight) {\n                this.updatePoints();\n            }\n            actPoint = parent.activeObj.activePoint;\n        }\n        if (actPoint.startX < parent.img.destLeft) {\n            var diff = (parent.img.destLeft - actPoint.startX) + 7.5;\n            actPoint.startX += diff;\n            actPoint.endX += diff;\n        }\n        if (actPoint.startY < parent.img.destTop) {\n            var diff = (parent.img.destTop - actPoint.startY) + 7.5;\n            actPoint.startY += diff;\n            actPoint.endY += diff;\n        }\n        parent.activeObj = this.updateWidthHeight(parent.activeObj);\n        this.adjToCenter();\n    };\n    Draw.prototype.adjToCenter = function () {\n        var parent = this.parent;\n        var diffX = ((parent.lowerCanvas.width) / 2) - (parent.activeObj.activePoint.endX -\n            parent.activeObj.activePoint.width / 2);\n        var diffY = ((parent.lowerCanvas.height) / 2) - (parent.activeObj.activePoint.endY -\n            parent.activeObj.activePoint.height / 2);\n        parent.activeObj.activePoint.startX += diffX;\n        parent.activeObj.activePoint.endX += diffX;\n        parent.activeObj.activePoint.startY += diffY;\n        parent.activeObj.activePoint.endY += diffY;\n        if (parent.activeObj.activePoint.startX < (parent.img.destLeft >= 7.5 ? parent.img.destLeft : 7.5)) {\n            var diff = ((parent.img.destLeft >= 7.5 ? parent.img.destLeft : 0) - parent.activeObj.activePoint.startX) + 7.5;\n            parent.activeObj.activePoint.startX += diff;\n            parent.activeObj.activePoint.endX += diff;\n        }\n        else if (parent.activeObj.activePoint.endX > parent.img.destLeft + parent.img.destWidth) {\n            var diff = (parent.activeObj.activePoint.endX - (parent.img.destLeft + parent.img.destWidth)) + 7.5;\n            parent.activeObj.activePoint.startX -= diff;\n            parent.activeObj.activePoint.endX -= diff;\n        }\n        if (parent.activeObj.activePoint.startY < (parent.img.destTop > 7.5 ? parent.img.destTop : 7.5)) {\n            var diff = ((parent.img.destTop > 7.5 ? parent.img.destTop : 0) - parent.activeObj.activePoint.startY) + 7.5;\n            parent.activeObj.activePoint.startY += diff;\n            parent.activeObj.activePoint.endY += diff;\n        }\n        else if (parent.activeObj.activePoint.endY > parent.img.destTop + parent.img.destHeight) {\n            var diff = (parent.activeObj.activePoint.endY - (parent.img.destTop + parent.img.destHeight)) + 7.5;\n            parent.activeObj.activePoint.startY -= diff;\n            parent.activeObj.activePoint.endY -= diff;\n        }\n    };\n    Draw.prototype.updateActiveObject = function (actPoint, obj, isMouseMove, x, y) {\n        actPoint = actPoint ? actPoint : extend({}, this.parent.activeObj.activePoint, {}, true);\n        obj = obj ? obj : extend({}, this.parent.activeObj, {}, true);\n        actPoint.width = actPoint.endX - actPoint.startX;\n        actPoint.height = actPoint.endY - actPoint.startY;\n        x = x ? x : 0;\n        y = y ? y : 0;\n        var horCircleWidth = actPoint.width / 2;\n        var verCircleHeight = actPoint.height / 2;\n        var radius = 7.5;\n        obj.horTopLine = { startX: actPoint.startX + x, startY: actPoint.startY - y,\n            endX: actPoint.endX + x, endY: actPoint.endY + y };\n        obj.horBottomLine = { startX: actPoint.startX - x, startY: actPoint.endY - y,\n            endX: actPoint.endX - x, endY: actPoint.endY + y };\n        obj.verLeftLine = { startX: actPoint.startX + x, startY: actPoint.startY - y,\n            endX: actPoint.startX - y, endY: actPoint.endY - y };\n        obj.verRightLine = { startX: actPoint.endX + x, startY: actPoint.startY + y,\n            endX: actPoint.endX - x, endY: actPoint.endY + y };\n        obj.topLeftCircle = { startX: actPoint.startX, startY: actPoint.startY,\n            radius: obj.horTopLine.endX ? (radius) : 0 };\n        obj.topCenterCircle = { startX: actPoint.startX + horCircleWidth, startY: actPoint.startY,\n            radius: obj.horTopLine.endX ? (radius) : 0 };\n        obj.topRightCircle = { startX: actPoint.endX, startY: actPoint.startY,\n            radius: obj.horTopLine.endX ? (radius) : 0 };\n        obj.centerLeftCircle = { startX: actPoint.startX, startY: actPoint.startY + verCircleHeight,\n            radius: obj.horTopLine.endX ? (radius) : 0 };\n        obj.centerRightCircle = { startX: actPoint.endX, startY: actPoint.startY + verCircleHeight,\n            radius: obj.horTopLine.endX ? (radius) : 0 };\n        obj.bottomLeftCircle = { startX: actPoint.startX, startY: actPoint.endY,\n            radius: obj.horTopLine.endX ? (radius) : 0 };\n        obj.bottomCenterCircle = { startX: actPoint.startX + horCircleWidth, startY: actPoint.endY,\n            radius: obj.horTopLine.endX ? (radius) : 0 };\n        obj.bottomRightCircle = { startX: actPoint.endX, startY: actPoint.endY,\n            radius: obj.horTopLine.endX ? (radius) : 0 };\n        if (obj.rotatedAngle === 0) {\n            obj.rotationCirclePoint = { x: obj.bottomCenterCircle.startX,\n                y: obj.bottomCenterCircle.startY + 25 };\n            obj.rotationCirclePoint.ratioX = (obj.rotationCirclePoint.x - this.parent.img.destLeft) / this.parent.img.destWidth;\n            obj.rotationCirclePoint.ratioY = (obj.rotationCirclePoint.y - this.parent.img.destTop) / this.parent.img.destHeight;\n        }\n        obj.activePoint = actPoint;\n        if (isNullOrUndefined(isMouseMove)) {\n            this.parent.activeObj = extend({}, obj, {}, true);\n        }\n    };\n    Draw.prototype.drawOuterSelection = function (canvasDraw, isCropCircle) {\n        var splitWords;\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        canvasDraw.lineWidth = (0.5);\n        if (parent.activeObj.shape !== undefined) {\n            splitWords = parent.activeObj.shape.split('-');\n        }\n        var tempObj = extend({}, parent.activeObj, {}, true);\n        if (parent.activeObj.shape !== undefined) {\n            splitWords = parent.activeObj.shape.split('-');\n        }\n        if (((splitWords !== undefined && splitWords[0] === 'crop') || parent.activeObj.shape === undefined) && !isCropCircle) {\n            this.upperContext.fillStyle = 'rgb(0, 0, 0, 0.25)';\n            this.upperContext.fillRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n            this.upperContext.clearRect(actPoint.startX, actPoint.startY, actPoint.width, actPoint.height);\n        }\n        canvasDraw.strokeStyle = parent.themeColl[parent.theme]['primaryColor'];\n        canvasDraw.fillStyle = parent.themeColl[parent.theme]['secondaryColor'];\n        var degree;\n        if (tempObj.shapeDegree === 0) {\n            degree = parent.transform.degree;\n        }\n        else {\n            degree = parent.transform.degree - tempObj.shapeDegree;\n        }\n        if (degree < 0) {\n            degree = 360 + degree;\n        }\n        if (parent.activeObj.shape === 'arrow' || parent.activeObj.shape === 'line') {\n            canvasDraw.beginPath();\n            canvasDraw.moveTo(actPoint.startX, actPoint.startY);\n            canvasDraw.lineTo(actPoint.endX, actPoint.endY);\n            canvasDraw.stroke();\n        }\n        else if (parent.activeObj.shape === 'path') {\n            canvasDraw.beginPath();\n            var activeObj = extend({}, parent.activeObj, {}, true);\n            canvasDraw.moveTo(activeObj.pointColl[0].x, activeObj.pointColl[0].y);\n            if (activeObj.pointColl.length > 1) {\n                for (var i = 1, len = activeObj.pointColl.length; i < len; i++) {\n                    actPoint.endX = activeObj.pointColl[i].x;\n                    actPoint.endY = activeObj.pointColl[i].y;\n                    canvasDraw.lineTo(actPoint.endX, actPoint.endY);\n                }\n            }\n            var obj = { shape: null };\n            parent.notify('selection', { prop: 'getCurrentDrawingShape', value: { obj: obj } });\n            if (obj['shape'] === 'path') {\n                parent.activeObj = activeObj;\n            }\n            canvasDraw.lineTo(actPoint.endX, actPoint.endY);\n            canvasDraw.stroke();\n        }\n        else {\n            canvasDraw.beginPath();\n            canvasDraw.rect(tempObj.activePoint.startX, tempObj.activePoint.startY, tempObj.activePoint.width, tempObj.activePoint.height);\n            canvasDraw.stroke();\n            canvasDraw.closePath();\n            if (parent.selectionSettings.showCircle) {\n                var strokeColor = canvasDraw.strokeStyle;\n                var fillColor = canvasDraw.fillStyle;\n                canvasDraw.strokeStyle = parent.selectionSettings.strokeColor;\n                canvasDraw.fillStyle = parent.selectionSettings.fillColor;\n                canvasDraw.lineWidth *= 2;\n                canvasDraw.beginPath();\n                canvasDraw.moveTo(tempObj.topLeftCircle.startX, tempObj.topLeftCircle.startY);\n                canvasDraw.arc(tempObj.topLeftCircle.startX, tempObj.topLeftCircle.startY, tempObj.topLeftCircle.radius, 0, 2 * Math.PI);\n                canvasDraw.moveTo(tempObj.topRightCircle.startX, tempObj.topRightCircle.startY);\n                canvasDraw.arc(tempObj.topRightCircle.startX, tempObj.topRightCircle.startY, tempObj.topRightCircle.radius, 0, 2 * Math.PI);\n                canvasDraw.moveTo(tempObj.bottomLeftCircle.startX, tempObj.bottomLeftCircle.startY);\n                canvasDraw.arc(tempObj.bottomLeftCircle.startX, tempObj.bottomLeftCircle.startY, tempObj.bottomLeftCircle.radius, 0, 2 * Math.PI);\n                canvasDraw.moveTo(tempObj.bottomRightCircle.startX, tempObj.bottomRightCircle.startY);\n                canvasDraw.arc(tempObj.bottomRightCircle.startX, tempObj.bottomRightCircle.startY, tempObj.bottomRightCircle.radius, 0, 2 * Math.PI);\n                canvasDraw.stroke();\n                canvasDraw.fill();\n                canvasDraw.closePath();\n                canvasDraw.lineWidth /= 2;\n                canvasDraw.strokeStyle = strokeColor;\n                canvasDraw.fillStyle = fillColor;\n            }\n        }\n        if (parent.selectionSettings.showCircle && (splitWords === undefined || splitWords[0] !== 'crop')) {\n            var strokeColor = canvasDraw.strokeStyle;\n            var fillColor = canvasDraw.fillStyle;\n            canvasDraw.strokeStyle = parent.selectionSettings.strokeColor;\n            canvasDraw.fillStyle = parent.selectionSettings.fillColor;\n            if (parent.activeObj.shape === 'text') {\n                // Text rotation codes\n                // canvasDraw.lineWidth *= 2;\n                // canvasDraw.beginPath();\n                // this.drawRotationArcLine(canvasDraw);\n                // canvasDraw.lineTo(parent.activeObj.rotationCirclePoint.x, parent.activeObj.rotationCirclePoint.y);\n                // canvasDraw.stroke(); canvasDraw.fill(); canvasDraw.closePath();\n                // canvasDraw.beginPath();\n                // canvasDraw.moveTo(parent.activeObj.rotationCirclePoint.x, parent.activeObj.rotationCirclePoint.y);\n                // canvasDraw.arc(parent.activeObj.rotationCirclePoint.x, parent.activeObj.rotationCirclePoint.y,\n                //                parent.activeObj.bottomCenterCircle.radius, 0, 2 * Math.PI);\n                // canvasDraw.stroke();\n                // canvasDraw.fill();\n                // canvasDraw.closePath();\n                // canvasDraw.lineWidth /= 2;\n            }\n            else {\n                this.drawCenterCircles(canvasDraw);\n            }\n            canvasDraw.strokeStyle = strokeColor;\n            canvasDraw.fillStyle = fillColor;\n        }\n        tempObj.rotationCircleLine = parent.activeObj.rotationCircleLine;\n        parent.activeObj = extend({}, tempObj, {}, true);\n    };\n    Draw.prototype.drawArrowHead = function (canvasDraw, isStartHead) {\n        var headType = isStartHead ? this.parent.activeObj.start : this.parent.activeObj.end;\n        switch (headType) {\n            case 'arrowSolid':\n                // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n                isStartHead ? this.arrowSolid(canvasDraw, true) : this.arrowSolid(canvasDraw, false);\n                break;\n            case 'arrow':\n                // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n                isStartHead ? this.arrow(canvasDraw, true) : this.arrow(canvasDraw, false);\n                break;\n            case 'circleSolid':\n                // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n                isStartHead ? this.arrowCircleSolid(canvasDraw, true) : this.arrowCircleSolid(canvasDraw, false);\n                break;\n            case 'circle':\n                // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n                isStartHead ? this.arrowCircle(canvasDraw, true) : this.arrowCircle(canvasDraw, false);\n                break;\n            case 'bar':\n                // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n                isStartHead ? this.arrowBar(canvasDraw, true) : this.arrowBar(canvasDraw, false);\n                break;\n            case 'square':\n            case 'squareSolid':\n                // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n                isStartHead ? this.arrowSquareStart(canvasDraw) : this.arrowSquareEnd(canvasDraw);\n                break;\n        }\n    };\n    Draw.prototype.drawShapeObj = function (canvas, shape, saveContext, isPreventSelection) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var currentShape = shape !== undefined ? shape : parent.currObjType.shape;\n        parent.currObjType.shape = currentShape;\n        var canvasDraw;\n        if (canvas.toLowerCase() === 'original') {\n            canvasDraw = this.lowerContext;\n        }\n        else if (canvas.toLowerCase() === 'duplicate') {\n            canvasDraw = this.upperContext;\n        }\n        else if (saveContext) {\n            canvasDraw = saveContext;\n        }\n        if (parent.currObjType.shape.toLowerCase() === 'rectangle' || parent.currObjType.shape.toLowerCase() === 'ellipse'\n            || parent.currObjType.shape.toLowerCase() === 'line' || parent.activeObj.shape === 'arrow' ||\n            parent.activeObj.shape === 'path') {\n            parent.activeObj.shape = parent.currObjType.shape;\n        }\n        canvasDraw.strokeStyle = parent.activeObj.strokeSettings.strokeColor;\n        if (shape === 'text' || shape === 'freehanddraw') {\n            canvasDraw.fillStyle = parent.activeObj.strokeSettings.strokeColor;\n        }\n        else {\n            canvasDraw.fillStyle = parent.activeObj.strokeSettings.fillColor;\n        }\n        var horLineWidth = actPoint.width / 3;\n        var verLineHeight = actPoint.height / 3;\n        var selectionWidth = actPoint.endX - actPoint.startX;\n        var selectionHeight = actPoint.endY - actPoint.startY;\n        this.rotateContext('initial', canvasDraw);\n        var degree;\n        var tempFillStyle = canvasDraw.fillStyle;\n        var activeObj;\n        switch (parent.currObjType.shape.toLowerCase()) {\n            case 'rectangle':\n                this.drawSquareLines(canvasDraw);\n                if (isNullOrUndefined(isPreventSelection) && canvasDraw === this.upperContext) {\n                    this.drawOuterSelection(canvasDraw);\n                }\n                break;\n            case 'ellipse':\n                selectionWidth = Math.abs(selectionWidth);\n                selectionHeight = Math.abs(selectionHeight);\n                canvasDraw.beginPath();\n                canvasDraw.ellipse(actPoint.startX + (selectionWidth / 2), actPoint.startY + (selectionHeight / 2), selectionWidth / 2, selectionHeight / 2, 0, 0, 2 * Math.PI, false);\n                if (parent.activeObj.strokeSettings.fillColor !== '') {\n                    canvasDraw.fillStyle = parent.activeObj.strokeSettings.fillColor;\n                    canvasDraw.fill();\n                }\n                canvasDraw.ellipse(actPoint.startX + (selectionWidth / 2), actPoint.startY + (selectionHeight / 2), Math.abs((selectionWidth / 2) - (parent.activeObj.strokeSettings.strokeWidth)), Math.abs((selectionHeight / 2) - (parent.activeObj.strokeSettings.strokeWidth)), 0, 0, 2 * Math.PI, false);\n                canvasDraw.fillStyle = parent.activeObj.strokeSettings.strokeColor;\n                canvasDraw.fill('evenodd');\n                canvasDraw.closePath();\n                if (isNullOrUndefined(isPreventSelection) && canvasDraw === this.upperContext) {\n                    this.drawOuterSelection(canvasDraw);\n                }\n                break;\n            case 'crop-circle':\n                if (canvasDraw === this.lowerContext) {\n                    canvasDraw = this.upperContext;\n                }\n                this.shapeCircle(canvasDraw, selectionWidth, selectionHeight);\n                break;\n            case 'line':\n                this.shapeLine(canvasDraw, actPoint.startX, actPoint.startY, actPoint.endX, actPoint.endY);\n                if (isNullOrUndefined(isPreventSelection) && canvasDraw === this.upperContext) {\n                    this.drawOuterSelection(canvasDraw);\n                }\n                break;\n            case 'arrow':\n                if (parent.activeObj.shapeDegree === 0) {\n                    degree = parent.transform.degree;\n                }\n                else {\n                    degree = parent.transform.degree - parent.activeObj.shapeDegree;\n                }\n                if (degree < 0) {\n                    degree = 360 + degree;\n                }\n                canvasDraw.fillStyle = canvasDraw.strokeStyle;\n                if (isNullOrUndefined(parent.activeObj.triangleDirection)) {\n                    parent.activeObj.triangleDirection = 'right';\n                }\n                if (isNullOrUndefined(parent.activeObj.start)) {\n                    parent.activeObj.start = 'none';\n                }\n                if (isNullOrUndefined(parent.activeObj.end)) {\n                    parent.activeObj.end = 'arrowSolid';\n                }\n                this.drawArrowHead(canvasDraw, true);\n                this.drawArrowHead(canvasDraw, false);\n                if (parent.activeObj.end === 'none') {\n                    this.shapeLine(canvasDraw, actPoint.startX, actPoint.startY, actPoint.endX, actPoint.endY);\n                }\n                canvasDraw.fillStyle = tempFillStyle;\n                if (isNullOrUndefined(isPreventSelection) && canvasDraw === this.upperContext) {\n                    this.drawOuterSelection(canvasDraw);\n                }\n                break;\n            case 'path':\n                activeObj = extend({}, parent.activeObj, {}, true);\n                if (activeObj.pointColl.length > 1) {\n                    var obj = { shape: null };\n                    parent.notify('selection', { prop: 'getCurrentDrawingShape', value: { obj: obj } });\n                    if (obj['shape'] === 'path') {\n                        var nextPoint = { x: 0, y: 0 };\n                        for (var i = 0, len = activeObj.pointColl.length; i < len; i++) {\n                            if (isNullOrUndefined(activeObj.pointColl[i + 1])) {\n                                nextPoint.x = activeObj.activePoint.endX;\n                                nextPoint.y = activeObj.activePoint.endY;\n                            }\n                            else {\n                                nextPoint.x = activeObj.pointColl[i + 1].x;\n                                nextPoint.y = activeObj.pointColl[i + 1].y;\n                            }\n                            actPoint.startX = activeObj.pointColl[i].x;\n                            actPoint.startY = activeObj.pointColl[i].y;\n                            actPoint.endX = nextPoint.x;\n                            actPoint.endY = nextPoint.y;\n                            parent.activeObj = this.updateWidthHeight(parent.activeObj);\n                            this.shapeLine(canvasDraw, actPoint.startX, actPoint.startY, actPoint.endX, actPoint.endY);\n                        }\n                    }\n                    else {\n                        for (var i = 1, len = activeObj.pointColl.length; i < len; i++) {\n                            actPoint.startX = activeObj.pointColl[i - 1].x;\n                            actPoint.startY = activeObj.pointColl[i - 1].y;\n                            actPoint.endX = activeObj.pointColl[i].x;\n                            actPoint.endY = activeObj.pointColl[i].y;\n                            parent.activeObj = this.updateWidthHeight(parent.activeObj);\n                            this.shapeLine(canvasDraw, actPoint.startX, actPoint.startY, actPoint.endX, actPoint.endY);\n                        }\n                    }\n                    parent.activeObj = activeObj;\n                }\n                else {\n                    this.shapeLine(canvasDraw, actPoint.startX, actPoint.startY, actPoint.endX, actPoint.endY);\n                }\n                if (canvasDraw === this.upperContext) {\n                    this.drawOuterSelection(canvasDraw);\n                }\n                break;\n            case 'text':\n                this.shapeText(canvasDraw);\n                break;\n            case 'crop-square':\n            case 'crop-3:4':\n            case 'crop-4:3':\n            case 'crop-6:9':\n            case 'crop-9:6':\n            case 'crop-9:16':\n            case 'crop-16:9':\n                if (canvasDraw === this.lowerContext) {\n                    canvasDraw = this.upperContext;\n                }\n                this.drawSelection(horLineWidth, verLineHeight);\n                parent.currObjType.shape = '';\n                break;\n            default:\n                this.drawSelection(horLineWidth, verLineHeight);\n                break;\n        }\n        this.rotateContext('reverse', canvasDraw);\n    };\n    Draw.prototype.updatePoints = function () {\n        var parent = this.parent;\n        parent.activeObj.activePoint.startX += parent.img.destLeft;\n        parent.activeObj.activePoint.startY += parent.img.destTop;\n        parent.activeObj.activePoint.endX += parent.img.destLeft;\n        parent.activeObj.activePoint.endY += parent.img.destTop;\n        parent.activeObj = this.updateWidthHeight(parent.activeObj);\n    };\n    Draw.prototype.updateWidthHeight = function (obj) {\n        obj.activePoint.width = obj.activePoint.endX - obj.activePoint.startX;\n        obj.activePoint.height = obj.activePoint.endY - obj.activePoint.startY;\n        return obj;\n    };\n    Draw.prototype.drawCenterCircles = function (canvasDraw) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        canvasDraw.lineWidth *= 2;\n        canvasDraw.beginPath();\n        if (parent.activeObj.shape === 'arrow' || parent.activeObj.shape === 'line') {\n            canvasDraw.moveTo(actPoint.startX, actPoint.startY);\n            canvasDraw.arc(actPoint.startX, actPoint.startY, parent.activeObj.topCenterCircle.radius, 0, 2 * Math.PI);\n            canvasDraw.moveTo(actPoint.endX, actPoint.endY);\n            canvasDraw.arc(actPoint.endX, actPoint.endY, parent.activeObj.bottomCenterCircle.radius, 0, 2 * Math.PI);\n        }\n        else if (parent.activeObj.shape === 'path') {\n            var activeObj = extend({}, parent.activeObj, {}, true);\n            if (activeObj.pointColl.length > 1) {\n                for (var i = 1, len = activeObj.pointColl.length; i < len; i++) {\n                    actPoint.startX = activeObj.pointColl[i - 1].x;\n                    actPoint.startY = activeObj.pointColl[i - 1].y;\n                    actPoint.endX = activeObj.pointColl[i].x;\n                    actPoint.endY = activeObj.pointColl[i].y;\n                    canvasDraw.moveTo(actPoint.startX, actPoint.startY);\n                    canvasDraw.arc(actPoint.startX, actPoint.startY, parent.activeObj.topCenterCircle.radius, 0, 2 * Math.PI);\n                    canvasDraw.moveTo(actPoint.endX, actPoint.endY);\n                    canvasDraw.arc(actPoint.endX, actPoint.endY, parent.activeObj.bottomCenterCircle.radius, 0, 2 * Math.PI);\n                }\n            }\n            var obj = { shape: null };\n            parent.notify('selection', { prop: 'getCurrentDrawingShape', value: { obj: obj } });\n            if (obj['shape'] === 'path') {\n                parent.activeObj = activeObj;\n            }\n            canvasDraw.moveTo(actPoint.startX, actPoint.startY);\n            canvasDraw.arc(actPoint.startX, actPoint.startY, parent.activeObj.topCenterCircle.radius, 0, 2 * Math.PI);\n            canvasDraw.moveTo(actPoint.endX, actPoint.endY);\n            canvasDraw.arc(actPoint.endX, actPoint.endY, parent.activeObj.bottomCenterCircle.radius, 0, 2 * Math.PI);\n        }\n        else {\n            this.drawRotationArcLine(canvasDraw);\n            canvasDraw.lineTo(parent.activeObj.rotationCirclePoint.x, parent.activeObj.rotationCirclePoint.y);\n        }\n        canvasDraw.stroke();\n        canvasDraw.fill();\n        canvasDraw.closePath();\n        if (parent.activeObj.shape !== 'arrow' && parent.activeObj.shape !== 'line' &&\n            parent.activeObj.shape !== 'path') {\n            canvasDraw.beginPath();\n            canvasDraw.moveTo(parent.activeObj.rotationCirclePoint.x, parent.activeObj.rotationCirclePoint.y);\n            canvasDraw.arc(parent.activeObj.rotationCirclePoint.x, parent.activeObj.rotationCirclePoint.y, parent.activeObj.bottomCenterCircle.radius, 0, 2 * Math.PI);\n            canvasDraw.stroke();\n            canvasDraw.fill();\n            canvasDraw.closePath();\n        }\n        canvasDraw.lineWidth /= 2;\n    };\n    Draw.prototype.drawRotationArcLine = function (canvasDraw) {\n        var parent = this.parent;\n        if (isNullOrUndefined(parent.activeObj.rotationCircleLine)) {\n            parent.activeObj.rotationCircleLine = 22.5;\n        }\n        var degree;\n        var isHorizontalflip = false;\n        var isVerticalflip = false;\n        if (parent.activeObj.shapeDegree === 0) {\n            degree = parent.transform.degree;\n        }\n        else {\n            degree = parent.transform.degree - parent.activeObj.shapeDegree;\n        }\n        if (degree < 0) {\n            degree = 360 + degree;\n        }\n        if (parent.activeObj.flipObjColl) {\n            for (var i = 0, len = parent.activeObj.flipObjColl.length; i < len; i++) {\n                if (parent.activeObj.flipObjColl[i].toLowerCase() === 'horizontal') {\n                    isHorizontalflip = true;\n                }\n                else if (parent.activeObj.flipObjColl[i].toLowerCase() === 'vertical') {\n                    isVerticalflip = true;\n                }\n            }\n        }\n        switch (degree) {\n            case 0:\n            case 360:\n                if (isVerticalflip) {\n                    parent.activeObj.rotationCirclePoint = { x: parent.activeObj.topCenterCircle.startX,\n                        y: parent.activeObj.topCenterCircle.startY - parent.activeObj.rotationCircleLine };\n                    canvasDraw.moveTo(parent.activeObj.rotationCirclePoint.x, parent.activeObj.rotationCirclePoint.y + parent.activeObj.rotationCircleLine);\n                }\n                else {\n                    parent.activeObj.rotationCirclePoint = { x: parent.activeObj.bottomCenterCircle.startX,\n                        y: parent.activeObj.bottomCenterCircle.startY + parent.activeObj.rotationCircleLine };\n                    canvasDraw.moveTo(parent.activeObj.rotationCirclePoint.x, parent.activeObj.rotationCirclePoint.y - parent.activeObj.rotationCircleLine);\n                }\n                break;\n            case 90:\n            case -270:\n                if (isHorizontalflip) {\n                    parent.activeObj.rotationCirclePoint = { x: parent.activeObj.centerRightCircle.startX +\n                            parent.activeObj.rotationCircleLine, y: parent.activeObj.centerLeftCircle.startY };\n                    canvasDraw.moveTo(parent.activeObj.rotationCirclePoint.x - parent.activeObj.rotationCircleLine, parent.activeObj.rotationCirclePoint.y);\n                }\n                else {\n                    parent.activeObj.rotationCirclePoint = { x: parent.activeObj.centerLeftCircle.startX -\n                            parent.activeObj.rotationCircleLine, y: parent.activeObj.centerLeftCircle.startY };\n                    canvasDraw.moveTo(parent.activeObj.rotationCirclePoint.x + parent.activeObj.rotationCircleLine, parent.activeObj.rotationCirclePoint.y);\n                }\n                break;\n            case 180:\n            case -180:\n                if (isVerticalflip) {\n                    parent.activeObj.rotationCirclePoint = { x: parent.activeObj.bottomCenterCircle.startX,\n                        y: parent.activeObj.bottomCenterCircle.startY + parent.activeObj.rotationCircleLine };\n                    canvasDraw.moveTo(parent.activeObj.rotationCirclePoint.x, parent.activeObj.rotationCirclePoint.y - parent.activeObj.rotationCircleLine);\n                }\n                else {\n                    parent.activeObj.rotationCirclePoint = { x: parent.activeObj.topCenterCircle.startX,\n                        y: parent.activeObj.topCenterCircle.startY - parent.activeObj.rotationCircleLine };\n                    canvasDraw.moveTo(parent.activeObj.rotationCirclePoint.x, parent.activeObj.rotationCirclePoint.y + parent.activeObj.rotationCircleLine);\n                }\n                break;\n            case 270:\n            case -90:\n                if (isHorizontalflip) {\n                    parent.activeObj.rotationCirclePoint = { x: parent.activeObj.centerLeftCircle.startX -\n                            parent.activeObj.rotationCircleLine, y: parent.activeObj.centerLeftCircle.startY };\n                    canvasDraw.moveTo(parent.activeObj.rotationCirclePoint.x + parent.activeObj.rotationCircleLine, parent.activeObj.rotationCirclePoint.y);\n                }\n                else {\n                    parent.activeObj.rotationCirclePoint = { x: parent.activeObj.centerRightCircle.startX +\n                            parent.activeObj.rotationCircleLine, y: parent.activeObj.centerLeftCircle.startY };\n                    canvasDraw.moveTo(parent.activeObj.rotationCirclePoint.x - parent.activeObj.rotationCircleLine, parent.activeObj.rotationCirclePoint.y);\n                }\n                break;\n        }\n    };\n    Draw.prototype.drawSquareLines = function (canvasDraw) {\n        var splitWords;\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        if (parent.activeObj.shape !== undefined) {\n            splitWords = parent.activeObj.shape.split('-');\n        }\n        if (splitWords[0] === 'crop') {\n            canvasDraw.strokeStyle = '#fff';\n        }\n        else {\n            canvasDraw.strokeStyle = parent.activeObj.strokeSettings.strokeColor;\n        }\n        canvasDraw.beginPath();\n        canvasDraw.rect(actPoint.startX, actPoint.startY, actPoint.width, actPoint.height);\n        if (parent.activeObj.strokeSettings.fillColor !== '') {\n            canvasDraw.fillStyle = parent.activeObj.strokeSettings.fillColor;\n            canvasDraw.fill();\n        }\n        canvasDraw.rect(actPoint.startX + parent.activeObj.strokeSettings.strokeWidth, actPoint.startY + parent.activeObj.strokeSettings.strokeWidth, actPoint.width - (2 * parent.activeObj.strokeSettings.strokeWidth), actPoint.height - (2 * parent.activeObj.strokeSettings.strokeWidth));\n        canvasDraw.fillStyle = parent.activeObj.strokeSettings.strokeColor;\n        canvasDraw.fill('evenodd');\n        canvasDraw.closePath();\n    };\n    Draw.prototype.drawSelection = function (horLineWidth, verLineHeight) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        this.upperContext.strokeStyle = parent.themeColl[parent.theme]['primaryColor'];\n        this.upperContext.beginPath();\n        parent.activeObj.horTopInnerLine = { startX: actPoint.startX, startY: actPoint.startY +\n                verLineHeight, endX: actPoint.endX, endY: actPoint.endY + verLineHeight };\n        parent.activeObj.horBottomInnerLine = { startX: actPoint.startX, startY: actPoint.startY + (2 * verLineHeight), endX: actPoint.endX, endY: actPoint.endY + (2 * verLineHeight) };\n        parent.activeObj.verLeftInnerLine = { startX: actPoint.startX + horLineWidth,\n            startY: actPoint.startY, endX: actPoint.startX + horLineWidth,\n            endY: actPoint.endY };\n        parent.activeObj.verRightInnerLine = { startX: actPoint.startX + (2 * horLineWidth),\n            startY: actPoint.startY, endX: actPoint.startX + (2 * horLineWidth),\n            endY: actPoint.endY };\n        this.upperContext.moveTo(parent.activeObj.horTopInnerLine.startX, parent.activeObj.horTopInnerLine.startY);\n        this.upperContext.lineTo(parent.activeObj.horTopInnerLine.endX, parent.activeObj.horTopInnerLine.startY);\n        this.upperContext.moveTo(parent.activeObj.horBottomInnerLine.startX, parent.activeObj.horBottomInnerLine.startY);\n        this.upperContext.lineTo(parent.activeObj.horBottomInnerLine.endX, parent.activeObj.horBottomInnerLine.startY);\n        this.upperContext.moveTo(parent.activeObj.verLeftInnerLine.startX, parent.activeObj.verLeftInnerLine.startY);\n        this.upperContext.lineTo(parent.activeObj.verLeftInnerLine.endX, parent.activeObj.verLeftInnerLine.endY);\n        this.upperContext.moveTo(parent.activeObj.verRightInnerLine.startX, parent.activeObj.verRightInnerLine.startY);\n        this.upperContext.lineTo(parent.activeObj.verRightInnerLine.endX, parent.activeObj.verRightInnerLine.endY);\n        this.upperContext.stroke();\n        this.upperContext.closePath();\n    };\n    Draw.prototype.shapeCircle = function (canvasDraw, selectionWidth, selectionHeight) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        canvasDraw.strokeStyle = parent.themeColl[parent.theme]['primaryColor'];\n        canvasDraw.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        canvasDraw.fillStyle = 'rgb(0, 0, 0, 0.25)';\n        canvasDraw.fillRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        var tempWidth = canvasDraw.lineWidth;\n        canvasDraw.lineWidth = (2);\n        canvasDraw.beginPath();\n        canvasDraw.ellipse(parent.activeObj.horTopLine.startX + (selectionWidth / 2), parent.activeObj.horTopLine.startY\n            + (selectionHeight / 2), selectionWidth / 2, selectionHeight / 2, 0, 0, 2 * Math.PI, false);\n        canvasDraw.stroke();\n        canvasDraw.closePath();\n        canvasDraw.save();\n        canvasDraw.beginPath();\n        canvasDraw.arc(((actPoint.endX - actPoint.startX) / 2) + actPoint.startX, ((actPoint.endY - actPoint.startY) / 2) + actPoint.startY, (actPoint.width / 2), 0, Math.PI * 2);\n        canvasDraw.closePath();\n        canvasDraw.clip();\n        canvasDraw.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        canvasDraw.restore();\n        canvasDraw.lineWidth = tempWidth;\n        this.drawOuterSelection(canvasDraw, true);\n        parent.currObjType.shape = '';\n    };\n    Draw.prototype.shapeLine = function (canvasDraw, x1, y1, x2, y2) {\n        var tempLineWidth = canvasDraw.lineWidth;\n        canvasDraw.lineWidth = (this.parent.activeObj.strokeSettings.strokeWidth);\n        canvasDraw.beginPath();\n        canvasDraw.moveTo(x1, y1);\n        canvasDraw.lineTo(x2, y2);\n        canvasDraw.stroke();\n        canvasDraw.lineWidth = tempLineWidth;\n    };\n    Draw.prototype.manipulateSaveCtx = function (canvasDraw, x, y) {\n        if (canvasDraw !== this.lowerContext && canvasDraw !== this.upperContext) {\n            var obj = { width: 0, height: 0 };\n            this.parent.notify('crop', { prop: 'calcRatio', onPropertyChange: false,\n                value: { obj: obj, dimension: { width: canvasDraw.canvas.width, height: canvasDraw.canvas.height } } });\n            var ratio = obj;\n            if (x) {\n                x *= (ratio.width);\n            }\n            if (y) {\n                y *= (ratio.height);\n            }\n        }\n        return { x: x, y: y };\n    };\n    Draw.prototype.arrow = function (canvasDraw, start) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        canvasDraw.lineWidth = (parent.activeObj.strokeSettings.strokeWidth);\n        var x = this.arrowDimension['arrow']['width'];\n        var y = this.arrowDimension['arrow']['height'];\n        var point = this.manipulateSaveCtx(canvasDraw, x, y);\n        x = point.x + parent.activeObj.strokeSettings.strokeWidth;\n        y = point.y + parent.activeObj.strokeSettings.strokeWidth;\n        this.dx = actPoint.endX - actPoint.startX;\n        this.dy = actPoint.endY - actPoint.startY;\n        canvasDraw.fillStyle = parent.activeObj.strokeSettings.strokeColor;\n        var angle = Math.atan2(this.dy, this.dx);\n        if ((start && (parent.activeObj.triangleDirection === 'left' || parent.activeObj.triangleDirection === 'right')\n            && (parent.activeObj.start === 'arrow' && parent.activeObj.end === 'none')\n            || (parent.activeObj.start === 'arrow' && parent.activeObj.end !== 'circle'\n                && parent.activeObj.end !== 'square')) ||\n            (!start && (parent.activeObj.end === 'arrow' && parent.activeObj.start === 'none'\n                || parent.activeObj.start !== 'circle' && parent.activeObj.start !== 'square'))) {\n            this.shapeLine(canvasDraw, actPoint.startX, actPoint.startY, actPoint.endX, actPoint.endY);\n        }\n        if ((start && parent.activeObj.triangleDirection === 'left') ||\n            (!start && parent.activeObj.triangleDirection === 'right')) {\n            canvasDraw.translate(actPoint.endX, actPoint.endY);\n            canvasDraw.rotate(angle);\n            this.shapeLine(canvasDraw, 0, 0, -x, y / 2);\n            this.shapeLine(canvasDraw, 0, 0, -x, -y / 2);\n            canvasDraw.rotate(-angle);\n            canvasDraw.translate(-actPoint.endX, -actPoint.endY);\n        }\n        else if ((start && parent.activeObj.triangleDirection === 'right') ||\n            (!start && parent.activeObj.triangleDirection === 'left')) {\n            canvasDraw.translate(actPoint.startX, actPoint.startY);\n            canvasDraw.rotate(angle);\n            this.shapeLine(canvasDraw, 0, 0, x, y / 2);\n            this.shapeLine(canvasDraw, 0, 0, x, -y / 2);\n            canvasDraw.rotate(-angle);\n            canvasDraw.translate(-actPoint.startX, -actPoint.startY);\n        }\n    };\n    Draw.prototype.arrowSolid = function (canvasDraw, start) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var x = this.arrowDimension['arrowSolid']['width'];\n        var y = this.arrowDimension['arrowSolid']['height'];\n        var point = this.manipulateSaveCtx(canvasDraw, x, y);\n        x = point.x + parent.activeObj.strokeSettings.strokeWidth;\n        y = point.y + parent.activeObj.strokeSettings.strokeWidth;\n        this.dx = actPoint.endX - actPoint.startX;\n        this.dy = actPoint.endY - actPoint.startY;\n        var angle = Math.atan2(this.dy, this.dx);\n        if ((start && (parent.activeObj.start === 'arrowSolid' && parent.activeObj.end === 'none')\n            || (parent.activeObj.start === 'arrowSolid' && parent.activeObj.end !== 'circle' && parent.activeObj.end !== 'square')) ||\n            (!start && (parent.activeObj.end === 'arrowSolid' && parent.activeObj.start === 'none'\n                || parent.activeObj.start !== 'circle' && parent.activeObj.start !== 'square'))) {\n            this.shapeLine(canvasDraw, actPoint.startX, actPoint.startY, actPoint.endX, actPoint.endY);\n        }\n        if ((start && parent.activeObj.triangleDirection === 'left') ||\n            (!start && parent.activeObj.triangleDirection === 'right')) {\n            canvasDraw.translate(actPoint.endX, actPoint.endY);\n            canvasDraw.rotate(angle);\n            canvasDraw.beginPath();\n            canvasDraw.moveTo(parent.activeObj.strokeSettings.strokeWidth, 0);\n            canvasDraw.lineTo(-x + y / 2, y / 2);\n            canvasDraw.lineTo(-x + y / 2, -y / 2);\n            canvasDraw.closePath();\n            canvasDraw.fill();\n            canvasDraw.rotate(-angle);\n            canvasDraw.translate(-actPoint.endX, -actPoint.endY);\n            parent.activeObj.rotatedAngle = angle;\n        }\n        else if ((start && parent.activeObj.triangleDirection === 'right') ||\n            (!start && parent.activeObj.triangleDirection === 'left')) {\n            canvasDraw.translate(actPoint.startX, actPoint.startY);\n            canvasDraw.rotate(angle);\n            canvasDraw.beginPath();\n            canvasDraw.moveTo(0 - parent.activeObj.strokeSettings.strokeWidth, 0);\n            canvasDraw.lineTo(x - y / 2, y / 2);\n            canvasDraw.lineTo(x - y / 2, -y / 2);\n            canvasDraw.closePath();\n            canvasDraw.fill();\n            canvasDraw.rotate(-angle);\n            canvasDraw.translate(-actPoint.startX, -actPoint.startY);\n            parent.activeObj.rotatedAngle = angle;\n        }\n    };\n    Draw.prototype.arrowSquareStart = function (canvasDraw) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        if ((parent.activeObj.start === 'square' && parent.activeObj.end === 'none')\n            || (parent.activeObj.start === 'square' && parent.activeObj.end !== 'circle'\n                && parent.activeObj.start !== 'square') || (parent.activeObj.start === 'squareSolid' && parent.activeObj.end === 'circleSolid')) {\n            this.shapeLine(canvasDraw, actPoint.startX, actPoint.startY, actPoint.endX, actPoint.endY);\n        }\n        canvasDraw.lineWidth = (parent.activeObj.strokeSettings.strokeWidth);\n        canvasDraw.beginPath();\n        canvasDraw.fillStyle = parent.activeObj.strokeSettings.strokeColor;\n        var x = this.arrowDimension['square']['width'];\n        var y = this.arrowDimension['square']['height'];\n        var point = this.manipulateSaveCtx(canvasDraw, x, y);\n        x = point.x + parent.activeObj.strokeSettings.strokeWidth;\n        y = point.y + parent.activeObj.strokeSettings.strokeWidth;\n        this.dx = actPoint.endX - actPoint.startX;\n        this.dy = actPoint.endY - actPoint.startY;\n        var angle = Math.atan2(this.dy, this.dx);\n        if (parent.activeObj.triangleDirection === 'left') {\n            canvasDraw.translate(actPoint.endX, actPoint.endY);\n            canvasDraw.rotate(angle);\n            if (parent.activeObj.start === 'squareSolid') {\n                canvasDraw.fillRect(-x + y / 2, -y / 2, x, y);\n            }\n            canvasDraw.strokeRect(-x + y / 2, -y / 2, x, y);\n            canvasDraw.rotate(-angle);\n            canvasDraw.translate(-actPoint.endX, -actPoint.endY);\n            this.squareStartIntersectX1 = actPoint.endX - (y / 2) * Math.cos(angle);\n            this.squareStartIntersectY1 = actPoint.endY - (y / 2) * Math.sin(angle);\n            if (parent.activeObj.start === 'square' && parent.activeObj.end !== 'square'\n                && parent.activeObj.end !== 'circle' && parent.activeObj.end !== 'square') {\n                this.shapeLine(canvasDraw, actPoint.startX, actPoint.startY, this.squareStartIntersectX1, this.squareStartIntersectY1);\n            }\n            if (parent.activeObj.start === 'square' && parent.activeObj.end === 'circle') {\n                this.shapeLine(canvasDraw, this.endCircleIntersectX1, this.endCircleIntersectY1, this.squareStartIntersectX1, this.squareStartIntersectY1);\n            }\n            if (parent.activeObj.start === 'squareSolid' && parent.activeObj.end === 'squareSolid') {\n                this.shapeLine(canvasDraw, actPoint.startX, actPoint.startY, actPoint.endX, actPoint.endY);\n            }\n        }\n        else if (parent.activeObj.triangleDirection === 'right') {\n            canvasDraw.lineWidth = (parent.activeObj.strokeSettings.strokeWidth);\n            canvasDraw.fillStyle = parent.activeObj.strokeSettings.strokeColor;\n            if (parent.activeObj.start === 'squareSolid' && parent.activeObj.end === 'squareSolid') {\n                this.shapeLine(canvasDraw, actPoint.startX, actPoint.startY, actPoint.endX, actPoint.endY);\n            }\n            canvasDraw.translate(actPoint.startX, actPoint.startY);\n            canvasDraw.rotate(angle);\n            if (parent.activeObj.start === 'squareSolid') {\n                canvasDraw.fillRect(y / 2 - x, -y / 2, x, y);\n            }\n            canvasDraw.strokeRect(y / 2 - x, -y / 2, x, y);\n            canvasDraw.rotate(-angle);\n            canvasDraw.translate(-actPoint.startX, -actPoint.startY);\n            parent.activeObj.rotatedAngle = angle;\n            this.squareStartIntersectX1 = actPoint.startX + (y / 2) * Math.cos(angle);\n            this.squareStartIntersectY1 = actPoint.startY + (y / 2) * Math.sin(angle);\n            if (parent.activeObj.start === 'square' && parent.activeObj.end !== 'square'\n                && parent.activeObj.end !== 'circle' && parent.activeObj.end !== 'square') {\n                this.shapeLine(canvasDraw, actPoint.endX, actPoint.endY, this.squareStartIntersectX1, this.squareStartIntersectY1);\n            }\n            if (parent.activeObj.start === 'square' && parent.activeObj.end === 'circle') {\n                this.shapeLine(canvasDraw, this.endCircleIntersectX1, this.endCircleIntersectY1, this.squareStartIntersectX1, this.squareStartIntersectY1);\n            }\n        }\n    };\n    Draw.prototype.arrowSquareEnd = function (canvasDraw) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var x = this.arrowDimension['square']['width'];\n        var y = this.arrowDimension['square']['height'];\n        var point = this.manipulateSaveCtx(canvasDraw, x, y);\n        x = point.x + parent.activeObj.strokeSettings.strokeWidth;\n        y = point.y + parent.activeObj.strokeSettings.strokeWidth;\n        this.dx = actPoint.endX - actPoint.startX;\n        this.dy = actPoint.endY - actPoint.startY;\n        var angle = Math.atan2(this.dy, this.dx);\n        canvasDraw.lineWidth = (parent.activeObj.strokeSettings.strokeWidth);\n        if (parent.activeObj.triangleDirection === 'right') {\n            canvasDraw.fillStyle = parent.activeObj.strokeSettings.strokeColor;\n            if (parent.activeObj.end === 'squareSolid' && parent.activeObj.start === 'none') {\n                this.shapeLine(canvasDraw, actPoint.startX, actPoint.startY, actPoint.endX, actPoint.endY);\n            }\n            canvasDraw.translate(actPoint.endX, actPoint.endY);\n            canvasDraw.rotate(angle);\n            if (parent.activeObj.end === 'squareSolid') {\n                canvasDraw.fillRect(-x + y / 2, -y / 2, x, y);\n            }\n            canvasDraw.strokeRect(-x + y / 2, -y / 2, x, y);\n            canvasDraw.rotate(-angle);\n            canvasDraw.translate(-actPoint.endX, -actPoint.endY);\n            parent.activeObj.rotatedAngle = angle;\n            this.squareEndIntersectX1 = actPoint.endX - (y / 2) * Math.cos(angle);\n            this.squareEndIntersectY1 = actPoint.endY - (y / 2) * Math.sin(angle);\n            if (parent.activeObj.end === 'square' && parent.activeObj.start !== 'square' && parent.activeObj.start !== 'circle'\n                && parent.activeObj.end === 'square') {\n                this.shapeLine(canvasDraw, actPoint.startX, actPoint.startY, this.squareEndIntersectX1, this.squareEndIntersectY1);\n            }\n            else if ((parent.activeObj.start === 'circle') && parent.activeObj.end === 'square') {\n                this.shapeLine(canvasDraw, this.squareEndIntersectX1, this.squareEndIntersectY1, this.startCircleIntersectX1, this.startCircleIntersectY1);\n            }\n            else if ((parent.activeObj.start === 'square') && parent.activeObj.end === 'square') {\n                this.shapeLine(canvasDraw, this.squareEndIntersectX1, this.squareEndIntersectY1, this.squareStartIntersectX1, this.squareStartIntersectY1);\n            }\n        }\n        else if (parent.activeObj.triangleDirection === 'left') {\n            canvasDraw.translate(actPoint.startX, actPoint.startY);\n            canvasDraw.rotate(angle);\n            if (parent.activeObj.end === 'squareSolid') {\n                canvasDraw.fillRect(y / 2 - x, -y / 2, x, y);\n            }\n            canvasDraw.strokeRect(y / 2 - x, -y / 2, x, y);\n            canvasDraw.rotate(-angle);\n            canvasDraw.translate(-actPoint.startX, -actPoint.startY);\n            parent.activeObj.rotatedAngle = angle;\n            this.squareEndIntersectX1 = actPoint.startX + (y / 2) * Math.cos(angle);\n            this.squareEndIntersectY1 = actPoint.startY + (y / 2) * Math.sin(angle);\n            if (parent.activeObj.end === 'square' && parent.activeObj.start !== 'square' &&\n                parent.activeObj.start !== 'circle' && parent.activeObj.end === 'square') {\n                this.shapeLine(canvasDraw, actPoint.endX, actPoint.endY, this.squareEndIntersectX1, this.squareEndIntersectY1);\n            }\n            else if ((parent.activeObj.start === 'circle') && parent.activeObj.end === 'square') {\n                this.shapeLine(canvasDraw, this.squareEndIntersectX1, this.squareEndIntersectY1, this.startCircleIntersectX1, this.startCircleIntersectY1);\n            }\n            else if ((parent.activeObj.start === 'square') && parent.activeObj.end === 'square') {\n                this.shapeLine(canvasDraw, this.squareEndIntersectX1, this.squareEndIntersectY1, this.squareStartIntersectX1, this.squareStartIntersectY1);\n            }\n        }\n    };\n    Draw.prototype.arrowCircle = function (canvasDraw, start) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        if ((start && parent.activeObj.triangleDirection === 'left') ||\n            (!start && parent.activeObj.triangleDirection === 'right')) {\n            canvasDraw.lineWidth = (parent.activeObj.strokeSettings.strokeWidth);\n            var circleRadius = this.arrowDimension['circle']['width'];\n            var point = this.manipulateSaveCtx(canvasDraw, circleRadius, null);\n            circleRadius = point.x + parent.activeObj.strokeSettings.strokeWidth;\n            canvasDraw.beginPath();\n            canvasDraw.arc(actPoint.endX, actPoint.endY, circleRadius, 0, 2 * Math.PI);\n            canvasDraw.stroke();\n            canvasDraw.closePath();\n            this.dx = actPoint.endX - actPoint.startX;\n            this.dy = actPoint.endY - actPoint.startY;\n            var a = this.dx * this.dx + this.dy * this.dy;\n            var b = 2 * (this.dx * (actPoint.startX - actPoint.endX) + this.dy * (actPoint.startY - actPoint.endY));\n            var c = (actPoint.startX - actPoint.endX) *\n                (actPoint.startX - actPoint.endX) +\n                (actPoint.startY - actPoint.endY) *\n                    (actPoint.startY - actPoint.endY) - circleRadius * circleRadius;\n            var intersect = b * b - 4 * a * c;\n            if (intersect >= 0) {\n                canvasDraw.fillStyle = parent.activeObj.strokeSettings.strokeColor;\n                var t2 = (-b - Math.sqrt(intersect)) / (2 * a);\n                var intersectionX1 = actPoint.startX + this.dx * t2;\n                var intersectionY1 = actPoint.startY + this.dy * t2;\n                if (start) {\n                    this.startCircleIntersectX1 = intersectionX1;\n                    this.startCircleIntersectY1 = intersectionY1;\n                    canvasDraw.beginPath();\n                    canvasDraw.fill();\n                    canvasDraw.beginPath();\n                    if (parent.activeObj.start === 'circle' && parent.activeObj.end === 'circle') {\n                        this.shapeLine(canvasDraw, this.startCircleIntersectX1, this.startCircleIntersectY1, this.endCircleIntersectX1, this.endCircleIntersectY1);\n                    }\n                    else if (parent.activeObj.start === 'circle' && parent.activeObj.end !== 'circle' && parent.activeObj.end !== 'square') {\n                        this.shapeLine(canvasDraw, actPoint.startX, actPoint.startY, this.startCircleIntersectX1, this.startCircleIntersectY1);\n                    }\n                    canvasDraw.stroke();\n                    canvasDraw.closePath();\n                }\n                else {\n                    this.endCircleIntersectX1 = intersectionX1;\n                    this.endCircleIntersectY1 = intersectionY1;\n                    if (parent.activeObj.end === 'circle' && (parent.activeObj.start !== 'circle' && parent.activeObj.start !== 'square')) {\n                        this.shapeLine(canvasDraw, actPoint.startX, actPoint.startY, this.endCircleIntersectX1, this.endCircleIntersectY1);\n                    }\n                }\n            }\n            var angle = Math.atan2(this.dy, this.dx);\n            parent.activeObj.rotatedAngle = angle;\n        }\n        else if ((start && parent.activeObj.triangleDirection === 'right') ||\n            (!start && parent.activeObj.triangleDirection === 'left')) {\n            canvasDraw.lineWidth = (parent.activeObj.strokeSettings.strokeWidth);\n            var circleRadius = this.arrowDimension['circle']['width'];\n            var point = this.manipulateSaveCtx(canvasDraw, circleRadius, null);\n            circleRadius = point.x + parent.activeObj.strokeSettings.strokeWidth;\n            canvasDraw.beginPath();\n            canvasDraw.arc(actPoint.startX, actPoint.startY, circleRadius, 0, 2 * Math.PI);\n            canvasDraw.stroke();\n            canvasDraw.closePath();\n            this.dx = actPoint.startX - actPoint.endX;\n            this.dy = actPoint.startY - actPoint.endY;\n            var a = this.dx * this.dx + this.dy * this.dy;\n            var b = 2 * (this.dx * (actPoint.endX - actPoint.startX) +\n                this.dy * (actPoint.endY - actPoint.startY));\n            var c = (actPoint.endX - actPoint.startX) *\n                (actPoint.endX - actPoint.startX) +\n                (actPoint.endY - actPoint.startY) *\n                    (actPoint.endY - actPoint.startY) - circleRadius * circleRadius;\n            var intersect = b * b - 4 * a * c;\n            if (intersect >= 0) {\n                canvasDraw.fillStyle = parent.activeObj.strokeSettings.strokeColor;\n                var t2 = (-b - Math.sqrt(intersect)) / (2 * a);\n                var intersectionX1 = actPoint.endX + this.dx * t2;\n                var intersectionY1 = actPoint.endY + this.dy * t2;\n                if (start) {\n                    this.startCircleIntersectX1 = intersectionX1;\n                    this.startCircleIntersectY1 = intersectionY1;\n                    if (parent.activeObj.start === 'circle' && parent.activeObj.end === 'circle') {\n                        this.shapeLine(canvasDraw, this.endCircleIntersectX1, this.endCircleIntersectY1, this.startCircleIntersectX1, this.startCircleIntersectY1);\n                    }\n                    else if (parent.activeObj.start === 'circle' && parent.activeObj.end !== 'circle' && parent.activeObj.end !== 'square') {\n                        this.shapeLine(canvasDraw, actPoint.endX, actPoint.endY, this.startCircleIntersectX1, this.startCircleIntersectY1);\n                    }\n                }\n                else {\n                    this.endCircleIntersectX1 = intersectionX1;\n                    this.endCircleIntersectY1 = intersectionY1;\n                    canvasDraw.beginPath();\n                    canvasDraw.fill();\n                    canvasDraw.beginPath();\n                    if (parent.activeObj.end === 'circle' && (parent.activeObj.start !== 'circle' && parent.activeObj.start !== 'square')) {\n                        this.shapeLine(canvasDraw, actPoint.endX, actPoint.endY, this.endCircleIntersectX1, this.endCircleIntersectY1);\n                    }\n                }\n            }\n            var angle = Math.atan2(this.dy, this.dx);\n            parent.activeObj.rotatedAngle = angle;\n        }\n    };\n    Draw.prototype.arrowCircleSolid = function (canvasDraw, start) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        if ((start && parent.activeObj.triangleDirection === 'left') ||\n            (!start && parent.activeObj.triangleDirection === 'right')) {\n            canvasDraw.lineWidth = (parent.activeObj.strokeSettings.strokeWidth);\n            canvasDraw.beginPath();\n            canvasDraw.fillStyle = parent.activeObj.strokeSettings.strokeColor;\n            if ((start && (parent.activeObj.start === 'circleSolid' && parent.activeObj.end === 'none') ||\n                (parent.activeObj.start === 'circleSolid' && parent.activeObj.end !== 'circle' && parent.activeObj.end !== 'square')) ||\n                (!start && (parent.activeObj.end === 'circleSolid' && parent.activeObj.start === 'none'))) {\n                this.shapeLine(canvasDraw, actPoint.startX, actPoint.startY, actPoint.endX, actPoint.endY);\n            }\n            var circleRadius = this.arrowDimension['circle']['width'];\n            var point = this.manipulateSaveCtx(canvasDraw, circleRadius, null);\n            circleRadius = point.x + parent.activeObj.strokeSettings.strokeWidth;\n            this.dx = actPoint.endX - actPoint.startX;\n            this.dy = actPoint.endY - actPoint.startY;\n            canvasDraw.save();\n            canvasDraw.beginPath();\n            canvasDraw.arc(actPoint.endX, actPoint.endY, circleRadius, 0, 2 * Math.PI);\n            canvasDraw.stroke();\n            canvasDraw.fill();\n            canvasDraw.closePath();\n            parent.activeObj.rotatedAngle = Math.atan2(this.dy, this.dx);\n        }\n        else if ((start && parent.activeObj.triangleDirection === 'right') ||\n            (!start && parent.activeObj.triangleDirection === 'left')) {\n            canvasDraw.lineWidth = (parent.activeObj.strokeSettings.strokeWidth);\n            canvasDraw.beginPath();\n            canvasDraw.fillStyle = parent.activeObj.strokeSettings.strokeColor;\n            if ((start && (parent.activeObj.start === 'circleSolid' && parent.activeObj.end === 'none') ||\n                (parent.activeObj.start === 'circleSolid' && parent.activeObj.end !== 'circle' && parent.activeObj.end !== 'square')) ||\n                !start && (parent.activeObj.end === 'circleSolid' && parent.activeObj.start === 'none')) {\n                this.shapeLine(canvasDraw, actPoint.startX, actPoint.startY, actPoint.endX, actPoint.endY);\n            }\n            var circleRadius = this.arrowDimension['circle']['width'];\n            var point = this.manipulateSaveCtx(canvasDraw, circleRadius, null);\n            circleRadius = point.x + parent.activeObj.strokeSettings.strokeWidth;\n            this.dx = actPoint.endX - actPoint.startX;\n            this.dy = actPoint.endY - actPoint.startY;\n            canvasDraw.save();\n            canvasDraw.beginPath();\n            canvasDraw.arc(actPoint.startX, actPoint.startY, circleRadius, 0, 2 * Math.PI);\n            canvasDraw.stroke();\n            canvasDraw.fill();\n            canvasDraw.closePath();\n            parent.activeObj.rotatedAngle = Math.atan2(this.dy, this.dx);\n        }\n    };\n    Draw.prototype.arrowBar = function (canvasDraw, start) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        if ((start && parent.activeObj.triangleDirection === 'left') ||\n            (!start && parent.activeObj.triangleDirection === 'right')) {\n            canvasDraw.lineWidth = (parent.activeObj.strokeSettings.strokeWidth);\n            canvasDraw.beginPath();\n            canvasDraw.fillStyle = parent.activeObj.strokeSettings.strokeColor;\n            if ((start && (parent.activeObj.start === 'bar' && parent.activeObj.end === 'none') ||\n                (parent.activeObj.start === 'bar' && (parent.activeObj.end !== 'circle' && parent.activeObj.end !== 'square'))) ||\n                (!start && ((parent.activeObj.end === 'bar' && parent.activeObj.start === 'none') ||\n                    (parent.activeObj.end === 'bar' && (parent.activeObj.start !== 'circle' && parent.activeObj.start !== 'square'))))) {\n                this.shapeLine(canvasDraw, actPoint.startX, actPoint.startY, actPoint.endX, actPoint.endY);\n            }\n            var x = this.arrowDimension['bar']['width'];\n            var y = this.arrowDimension['bar']['height'];\n            var point = this.manipulateSaveCtx(canvasDraw, x, y);\n            x = point.x + parent.activeObj.strokeSettings.strokeWidth;\n            y = point.y + parent.activeObj.strokeSettings.strokeWidth;\n            this.dx = actPoint.endX - actPoint.startX;\n            this.dy = actPoint.endY - actPoint.startY;\n            var angle = Math.atan2(this.dy, this.dx);\n            canvasDraw.translate(actPoint.endX, actPoint.endY);\n            canvasDraw.rotate(angle);\n            canvasDraw.fillRect(-x + y / 4, -y / 2, x, y);\n            canvasDraw.rotate(-angle);\n            canvasDraw.translate(-actPoint.endX, -actPoint.endY);\n            parent.activeObj.rotatedAngle = angle;\n        }\n        else if ((start && parent.activeObj.triangleDirection === 'right') ||\n            (!start && parent.activeObj.triangleDirection === 'left')) {\n            canvasDraw.lineWidth = (parent.activeObj.strokeSettings.strokeWidth);\n            canvasDraw.beginPath();\n            canvasDraw.fillStyle = parent.activeObj.strokeSettings.strokeColor;\n            if ((start && (parent.activeObj.start === 'bar' && parent.activeObj.end === 'none')\n                || (parent.activeObj.start === 'bar' && (parent.activeObj.end !== 'circle' && parent.activeObj.end !== 'square'))) ||\n                (!start && (parent.activeObj.end === 'bar' && parent.activeObj.start === 'none'))) {\n                this.shapeLine(canvasDraw, actPoint.startX, actPoint.startY, actPoint.endX, actPoint.endY);\n            }\n            var x = this.arrowDimension['bar']['width'];\n            var y = this.arrowDimension['bar']['height'];\n            var point = this.manipulateSaveCtx(canvasDraw, x, y);\n            x = point.x + parent.activeObj.strokeSettings.strokeWidth;\n            y = point.y + parent.activeObj.strokeSettings.strokeWidth;\n            this.dx = actPoint.endX - actPoint.startX;\n            this.dy = actPoint.endY - actPoint.startY;\n            var angle = Math.atan2(this.dy, this.dx);\n            canvasDraw.translate(actPoint.startX, actPoint.startY);\n            canvasDraw.rotate(angle);\n            canvasDraw.fillRect(y / 4 - x, -y / 2, x, y);\n            canvasDraw.rotate(-angle);\n            canvasDraw.translate(-actPoint.startX, -actPoint.startY);\n            parent.activeObj.rotatedAngle = angle;\n        }\n    };\n    Draw.prototype.shapeText = function (canvasDraw) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var rows = parent.activeObj.keyHistory.split('\\n');\n        var height = parent.activeObj.textSettings.fontSize + parent.activeObj.textSettings.fontSize * 0.25;\n        var lineHeight = ((height * rows.length) - (parent.activeObj.textSettings.fontSize * rows.length)) / rows.length;\n        for (var i = 0; i < rows.length; i++) {\n            var text = rows[i];\n            var yPoint = ((i + 1) * parent.activeObj.textSettings.fontSize * 0.85) + (i * lineHeight);\n            if (parent.transform.degree === -360) {\n                parent.transform.degree = 0;\n            }\n            if (parent.transform.degree === 0 || parent.transform.degree === 180) {\n                if (parent.activeObj.textSettings.fontSize > actPoint.height) {\n                    parent.activeObj.textSettings.fontSize = actPoint.height -\n                        (actPoint.height * 0.1);\n                }\n            }\n            else {\n                if (parent.activeObj.textSettings.fontSize > actPoint.width) {\n                    parent.activeObj.textSettings.fontSize = actPoint.width -\n                        (actPoint.width * 0.1);\n                }\n            }\n            canvasDraw.strokeStyle = parent.activeObj.strokeSettings.strokeColor;\n            canvasDraw.fillStyle = parent.activeObj.strokeSettings.strokeColor;\n            var textStyle = '';\n            if (parent.activeObj.textSettings.bold) {\n                textStyle = 'bold ';\n            }\n            if (parent.activeObj.textSettings.italic) {\n                textStyle = 'italic ';\n            }\n            if (parent.activeObj.textSettings.bold && parent.activeObj.textSettings.italic) {\n                textStyle = 'italic bold ';\n            }\n            canvasDraw.font = textStyle + parent.activeObj.textSettings.fontSize + 'px' + ' ' +\n                parent.activeObj.textSettings.fontFamily;\n            if (parent.activeObj.flipObjColl.length === 4) {\n                parent.activeObj.flipObjColl = [];\n                parent.activeObj.shapeFlip = '';\n            }\n            for (var j = 0, len = parent.activeObj.flipObjColl.length; j < len; j++) {\n                if (parent.activeObj.flipObjColl[j].toLowerCase() === 'horizontal') {\n                    canvasDraw.translate(canvasDraw.canvas.width, 0);\n                    canvasDraw.scale(-1, 1);\n                    actPoint = this.updateActPoint('horizontal', canvasDraw);\n                }\n                else if (parent.activeObj.flipObjColl[j].toLowerCase() === 'vertical') {\n                    canvasDraw.translate(0, canvasDraw.canvas.height);\n                    canvasDraw.scale(1, -1);\n                    actPoint = this.updateActPoint('vertical', canvasDraw);\n                }\n            }\n            if (parent.activeObj.shapeDegree !== parent.transform.degree) {\n                this.rotateText(canvasDraw);\n            }\n            else {\n                canvasDraw.fillText(text, actPoint.startX + parent.activeObj.textSettings.fontSize * 0.1, actPoint.startY + yPoint);\n            }\n            for (var k = 0, len = parent.activeObj.flipObjColl.length; k < len; k++) {\n                if (parent.activeObj.flipObjColl[k].toLowerCase() === 'horizontal') {\n                    canvasDraw.translate(canvasDraw.canvas.width, 0);\n                    canvasDraw.scale(-1, 1);\n                    actPoint = this.updateActPoint('horizontal', canvasDraw);\n                }\n                else if (parent.activeObj.flipObjColl[k].toLowerCase() === 'vertical') {\n                    canvasDraw.translate(0, canvasDraw.canvas.height);\n                    canvasDraw.scale(1, -1);\n                    actPoint = this.updateActPoint('vertical', canvasDraw);\n                }\n            }\n        }\n        parent.currObjType.isText = false;\n    };\n    Draw.prototype.updateActPoint = function (degree, canvasDraw) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        if (degree.toLowerCase() === 'horizontal') {\n            if (actPoint.startX <= canvasDraw.canvas.width / 2) {\n                actPoint.startX = canvasDraw.canvas.width / 2 + ((canvasDraw.canvas.width / 2) -\n                    actPoint.endX);\n                actPoint.endX = actPoint.startX +\n                    actPoint.width;\n                this.updateActiveObject(actPoint, parent.activeObj);\n            }\n            else if (actPoint.startX >= canvasDraw.canvas.width / 2) {\n                actPoint.startX = canvasDraw.canvas.width - actPoint.endX;\n                actPoint.endX = actPoint.startX +\n                    actPoint.width;\n                this.updateActiveObject(actPoint, parent.activeObj);\n            }\n        }\n        else if (degree.toLowerCase() === 'vertical') {\n            if (actPoint.startY <= canvasDraw.canvas.height / 2) {\n                actPoint.startY = canvasDraw.canvas.height / 2 + ((canvasDraw.canvas.height / 2) - actPoint.endY);\n                actPoint.endY = actPoint.startY + actPoint.height;\n                this.updateActiveObject(actPoint, parent.activeObj);\n            }\n            else if (actPoint.startY >= canvasDraw.canvas.height / 2) {\n                actPoint.startY = canvasDraw.canvas.height - actPoint.endY;\n                actPoint.endY = actPoint.startY + actPoint.height;\n                this.updateActiveObject(actPoint, parent.activeObj);\n            }\n        }\n        return actPoint;\n    };\n    Draw.prototype.rotateText = function (canvasDraw) {\n        var parent = this.parent;\n        var startX = parent.activeObj.activePoint.startX;\n        var startY = parent.activeObj.activePoint.startY;\n        var degree;\n        var actPoint = parent.activeObj.activePoint;\n        if (parent.activeObj.shapeDegree === 0) {\n            degree = parent.transform.degree;\n        }\n        else {\n            degree = parent.transform.degree - parent.activeObj.shapeDegree;\n        }\n        if (degree === -450) {\n            degree = -90;\n        }\n        if (degree < 0) {\n            degree = 360 + degree;\n        }\n        if (degree % 360 === 0 && (parent.transform.degree !== -360 || parent.transform.currFlipState === '')) {\n            startX = actPoint.startX + parent.activeObj.textSettings.fontSize * 0.15;\n            startY = actPoint.startY + (actPoint.endY - actPoint.startY);\n            var rows = parent.activeObj.keyHistory.split('\\n');\n            for (var i = 0; i < rows.length; i++) {\n                startY = actPoint.startY + (i * parent.activeObj.textSettings.fontSize + parent.activeObj.textSettings.fontSize * 0.25);\n                canvasDraw.fillText(rows[i], startX, startY);\n            }\n        }\n        else if (degree % 90 === 0 && degree % 180 !== 0) {\n            canvasDraw.translate(parent.lowerCanvas.width / 2, parent.lowerCanvas.height / 2);\n            canvasDraw.rotate(Math.PI / 180 * degree);\n            canvasDraw.translate(-parent.lowerCanvas.height / 2, -parent.lowerCanvas.width / 2);\n            if (degree % 90 === 0 && degree % 270 !== 0) {\n                startY = (parent.lowerCanvas.width - actPoint.endX) +\n                    parent.activeObj.textSettings.fontSize * 0.4;\n                startX = actPoint.startY;\n            }\n            else if (degree % 270 === 0) {\n                startX = parent.lowerCanvas.height - actPoint.endY;\n                startY = actPoint.startX + parent.activeObj.textSettings.fontSize * 0.4;\n            }\n            this.textFlipDegree(canvasDraw, startX, startY);\n            canvasDraw.translate(parent.lowerCanvas.height / 2, parent.lowerCanvas.width / 2);\n            canvasDraw.rotate(Math.PI / 180 * -degree);\n            canvasDraw.translate(-parent.lowerCanvas.width / 2, -parent.lowerCanvas.height / 2);\n        }\n        else {\n            canvasDraw.translate(parent.lowerCanvas.width / 2, parent.lowerCanvas.height / 2);\n            canvasDraw.rotate(Math.PI / 180 * degree);\n            startX = parent.lowerCanvas.width - actPoint.endX;\n            startY = (parent.lowerCanvas.height - actPoint.endY) +\n                parent.activeObj.textSettings.fontSize * 0.4;\n            canvasDraw.translate(-parent.lowerCanvas.width / 2, -parent.lowerCanvas.height / 2);\n            this.textFlipDegree(canvasDraw, startX, startY);\n            canvasDraw.translate(parent.lowerCanvas.width / 2, parent.lowerCanvas.height / 2);\n            canvasDraw.rotate(Math.PI / 180 * -degree);\n            canvasDraw.translate(-parent.lowerCanvas.width / 2, -parent.lowerCanvas.height / 2);\n        }\n        if (parent.transform.degree === 360 || parent.transform.degree === -360) {\n            parent.transform.degree = 0;\n        }\n    };\n    Draw.prototype.textFlipDegree = function (canvasDraw, startX, startY) {\n        var parent = this.parent;\n        var rows = parent.activeObj.keyHistory.split('\\n');\n        var height = parent.activeObj.textSettings.fontSize;\n        var lineHeight = ((height * rows.length) - (parent.activeObj.textSettings.fontSize * rows.length)) / rows.length;\n        var yPoint = (parent.activeObj.textSettings.fontSize * 0.85) + lineHeight;\n        for (var i = 0; i < rows.length; i++) {\n            var text = rows[i];\n            if (i > 0) {\n                if (i === 1) {\n                    yPoint -= (parent.activeObj.textSettings.fontSize * 0.85);\n                }\n                yPoint += parent.activeObj.textSettings.fontSize + parent.activeObj.textSettings.fontSize * 0.15;\n            }\n            canvasDraw.fillText(text, startX + parent.activeObj.textSettings.fontSize * 0.15, startY +\n                yPoint + (i > 0 ? parent.activeObj.textSettings.fontSize * 0.25 : -parent.activeObj.textSettings.fontSize * 0.35));\n        }\n    };\n    Draw.prototype.clearOuterCanvas = function (context) {\n        var parent = this.parent;\n        var destLeft = parent.img.destLeft;\n        var destTop = parent.img.destTop;\n        if (parent.img.destWidth < parent.lowerCanvas.width) {\n            var left = parent.img.destLeft > 0 ? parent.img.destLeft : 0;\n            context.clearRect(0, 0, left, parent.lowerCanvas.height);\n            context.clearRect(parent.img.destLeft + parent.img.destWidth, 0, left, parent.lowerCanvas.height);\n        }\n        if (parent.img.destHeight < parent.lowerCanvas.height) {\n            var top_1 = parent.img.destTop > 0 ? parent.img.destTop : 0;\n            context.clearRect(0, 0, parent.lowerCanvas.width, top_1);\n            context.clearRect(0, parent.img.destTop + parent.img.destHeight, parent.lowerCanvas.width, top_1);\n        }\n        if (parent.transform.currFlipState !== '') {\n            parent.img.destLeft = destLeft;\n            parent.img.destTop = destTop;\n        }\n    };\n    Draw.prototype.setDestPoints = function () {\n        var maxDimension;\n        var parent = this.parent;\n        if (parent.transform.degree % 90 === 0 && parent.transform.degree % 180 !== 0) {\n            var obj = { width: 0, height: 0 };\n            parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false,\n                value: { width: parent.img.srcHeight, height: parent.img.srcWidth, obj: obj } });\n            maxDimension = obj;\n            if (this.isRotateZoom) {\n                maxDimension.width += (maxDimension.width * parent.transform.zoomFactor);\n                maxDimension.height += (maxDimension.height * parent.transform.zoomFactor);\n                parent.img.destWidth = maxDimension.height;\n                parent.img.destHeight = maxDimension.width;\n            }\n            parent.img.destLeft = (parent.lowerCanvas.clientWidth - maxDimension.height) / 2;\n            parent.img.destTop = (parent.lowerCanvas.clientHeight - maxDimension.width) / 2;\n            parent.img.destWidth = maxDimension.height;\n            parent.img.destHeight = maxDimension.width;\n        }\n        else {\n            var obj = { width: 0, height: 0 };\n            parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false,\n                value: { width: parent.img.srcWidth, height: parent.img.srcHeight, obj: obj } });\n            maxDimension = obj;\n            if (this.isRotateZoom) {\n                maxDimension.width += (maxDimension.width * parent.transform.zoomFactor);\n                maxDimension.height += (maxDimension.height * parent.transform.zoomFactor);\n                parent.img.destWidth = maxDimension.width;\n                parent.img.destHeight = maxDimension.height;\n            }\n            parent.img.destLeft = (parent.lowerCanvas.clientWidth - maxDimension.width) / 2;\n            parent.img.destTop = (parent.lowerCanvas.clientHeight - maxDimension.height) / 2;\n            parent.img.destWidth = maxDimension.width;\n            parent.img.destHeight = maxDimension.height;\n        }\n    };\n    Draw.prototype.updateCurrTransState = function (type, isPreventDestination, isRotatePan) {\n        var parent = this.parent;\n        var destLeft = parent.img.destLeft;\n        var destTop = parent.img.destTop;\n        if (type === 'initial') {\n            this.lowerContext.setTransform(1, 0, 0, 1, 0, 0);\n            if (isNullOrUndefined(isPreventDestination)) {\n                this.setDestPoints();\n            }\n        }\n        this.currTransState(type, null, null, isRotatePan);\n        if (parent.transform.degree === 0 && parent.transform.currFlipState === '') {\n            parent.img.destLeft = destLeft;\n            parent.img.destTop = destTop;\n        }\n        if (parent.isCircleCrop || (parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle')) {\n            if (isRotatePan) {\n                parent.img.destLeft += parent.panPoint.totalPannedClientPoint.x;\n                parent.img.destTop +=\n                    parent.panPoint.totalPannedClientPoint.y;\n            }\n            parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                value: { context: this.lowerContext, isSave: null, isFlip: null } });\n            if (isRotatePan) {\n                parent.img.destLeft -= parent.panPoint.totalPannedClientPoint.x;\n                parent.img.destTop -=\n                    parent.panPoint.totalPannedClientPoint.y;\n            }\n        }\n    };\n    Draw.prototype.currTransState = function (type, isPreventDimension, context, isPreventCircleCrop) {\n        var parent = this.parent;\n        context = context ? context : this.lowerContext;\n        if (type === 'initial') {\n            this.setTransformColl(context, type);\n        }\n        else if (type === 'reverse') {\n            this.setTransformColl(context, type);\n            this.setClientTransDim(isPreventDimension);\n            if (parent.isCircleCrop || (parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle'\n                && isNullOrUndefined(isPreventCircleCrop))) {\n                if (isPreventCircleCrop) {\n                    parent.img.destLeft += parent.panPoint.totalPannedClientPoint.x;\n                    parent.img.destTop += parent.panPoint.totalPannedClientPoint.y;\n                }\n                parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                    value: { context: this.lowerContext, isSave: null, isFlip: null } });\n                if (isPreventCircleCrop) {\n                    parent.img.destLeft -= parent.panPoint.totalPannedClientPoint.x;\n                    parent.img.destTop -= parent.panPoint.totalPannedClientPoint.y;\n                }\n            }\n        }\n    };\n    Draw.prototype.setTransformColl = function (context, type) {\n        var parent = this.parent;\n        if (type === 'initial') {\n            for (var i = 0, len = parent.rotateFlipColl.length; i < len; i++) {\n                this.setTransform(context, parent.rotateFlipColl[i]);\n            }\n        }\n        else if (type === 'reverse') {\n            for (var i = parent.rotateFlipColl.length - 1; i >= 0; i--) {\n                this.setTransform(context, parent.rotateFlipColl[i], true);\n            }\n        }\n    };\n    Draw.prototype.setTransform = function (context, value, isReverse) {\n        var parent = this.parent;\n        if (isReverse && value === 90) {\n            value = -90;\n        }\n        else if (isReverse && value === -90) {\n            value = 90;\n        }\n        if (value === 'horizontal' && parent.transform.degree % 90 === 0 && parent.transform.degree % 180 !== 0) {\n            value = 'vertical';\n        }\n        else if (value === 'vertical' && parent.transform.degree % 90 === 0 && parent.transform.degree % 180 !== 0) {\n            value = 'horizontal';\n        }\n        parent.notify('transform', { prop: 'setReverseRotate', onPropertyChange: false, value: { bool: true } });\n        parent.notify('transform', { prop: 'setReverseFlip', onPropertyChange: false, value: { isReverseFlip: true } });\n        if (isNullOrUndefined(isReverse)) {\n            context.clearRect(0, 0, context.canvas.width, context.canvas.height);\n        }\n        switch (value) {\n            case 90:\n            case -90:\n                context.translate(context.canvas.width / 2, context.canvas.height / 2);\n                context.rotate(Math.PI / 180 * value);\n                context.translate(-context.canvas.width / 2, -context.canvas.height / 2);\n                break;\n            case 'horizontal':\n                context.translate(context.canvas.width, 0);\n                context.scale(-1, 1);\n                break;\n            case 'vertical':\n                context.translate(0, context.canvas.height);\n                context.scale(1, -1);\n                break;\n        }\n        parent.notify('transform', { prop: 'setReverseRotate', onPropertyChange: false, value: { bool: false } });\n        parent.notify('transform', { prop: 'setReverseFlip', onPropertyChange: false, value: { isReverseFlip: false } });\n    };\n    Draw.prototype.drawImgToCanvas = function (maxDimension) {\n        var parent = this.parent;\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        parent.img.destWidth = maxDimension.width;\n        parent.img.destHeight = maxDimension.height;\n        if (this.isInitialLoading) {\n            parent.notify('filter', { prop: 'initFilter', onPropertyChange: false });\n            this.isInitialLoading = false;\n        }\n        var temp = this.lowerContext.filter;\n        parent.notify('filter', { prop: 'updateBrightFilter', onPropertyChange: false });\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        this.lowerContext.drawImage(parent.baseImg, parent.img.srcLeft, parent.img.srcTop, parent.img.srcWidth, parent.img.srcHeight, parent.img.destLeft, parent.img.destTop, parent.img.destWidth, parent.img.destHeight);\n        if ((parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle') || parent.isCircleCrop) {\n            parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                value: { context: this.lowerContext, isSave: null, isFlip: null } });\n        }\n        this.lowerContext.filter = temp;\n    };\n    Draw.prototype.renderImage = function (isMouseWheel) {\n        var parent = this.parent;\n        var temp = this.lowerContext.filter;\n        parent.notify('shape', { prop: 'applyActObj', onPropertyChange: false, value: { isMouseDown: null } });\n        this.upperContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        if (isMouseWheel) {\n            this.setTransformColl(this.lowerContext, 'initial');\n        }\n        else {\n            if (parent.transform.zoomFactor > 0) {\n                this.isRotateZoom = true;\n            }\n            this.updateCurrTransState('initial');\n        }\n        parent.notify('filter', { prop: 'updateBrightFilter', onPropertyChange: false });\n        parent.notify('transform', { prop: 'setDestPointsForFlipState', onPropertyChange: false });\n        this.lowerContext.drawImage(parent.baseImg, parent.img.srcLeft, parent.img.srcTop, parent.img.srcWidth, parent.img.srcHeight, parent.img.destLeft, parent.img.destTop, parent.img.destWidth, parent.img.destHeight);\n        parent.notify('transform', { prop: 'setDestPointsForFlipState', onPropertyChange: false });\n        if (isMouseWheel) {\n            this.setTransformColl(this.lowerContext, 'reverse');\n        }\n        else {\n            this.updateCurrTransState('reverse');\n            this.isRotateZoom = false;\n        }\n        this.lowerContext.filter = 'none';\n        parent.notify('shape', { prop: 'iterateObjColl', onPropertyChange: false });\n        parent.notify('freehand-draw', { prop: 'freehandRedraw', onPropertyChange: false,\n            value: { context: this.lowerContext, points: null } });\n        this.lowerContext.filter = temp;\n        if (parent.isCircleCrop || (parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle')) {\n            parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                value: { context: this.lowerContext, isSave: null, isFlip: null } });\n        }\n    };\n    Draw.prototype.imageOnLoad = function (src) {\n        var _this = this;\n        var parent = this.parent;\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        var proxy = this;\n        parent.baseImg.src = src;\n        parent.baseImg.onload = function () {\n            parent.notify('filter', { prop: 'update-finetunes', onPropertyChange: false });\n            proxy.lowerContext.drawImage(parent.baseImg, 0, 0, proxy.parent.lowerCanvas.width, proxy.parent.lowerCanvas.height);\n            hideSpinner(parent.element);\n            parent.element.style.opacity = '1';\n            proxy.updateCanvas();\n            if (parent.currObjType.isUndoZoom) {\n                parent.currObjType.isUndoZoom = false;\n                proxy.parent.lowerCanvas.style.display = 'block';\n            }\n            parent.isUndoRedo = _this.isErrorImage = false;\n            if (!isBlazor()) {\n                if (Browser.isDevice) {\n                    parent.notify('toolbar', { prop: 'destroy-top-toolbar', onPropertyChange: false });\n                    parent.notify('toolbar', { prop: 'destroy-bottom-toolbar', onPropertyChange: false });\n                    var eventargs = { isApplyBtn: false, isDevice: Browser.isDevice, isOkBtn: null };\n                    parent.notify('toolbar', { prop: 'init-main-toolbar', onPropertyChange: false, value: eventargs });\n                    parent.notify('toolbar', { prop: 'create-bottom-toolbar', onPropertyChange: false });\n                }\n                else {\n                    parent.notify('toolbar', { prop: 'destroy-top-toolbar', onPropertyChange: false });\n                    var eventargs = { isApplyBtn: false, isDevice: false, isOkBtn: null };\n                    parent.notify('toolbar', { prop: 'init-main-toolbar', onPropertyChange: false, value: eventargs });\n                }\n            }\n            else {\n                parent.updateToolbar(parent.element, 'imageLoaded', 'initial');\n                if (Browser.isDevice) {\n                    parent.element.querySelector('.e-bottom-toolbar-area').style.display = 'block';\n                    parent.element.querySelector('.e-canvas-wrapper').style.height = (parent.element.offsetHeight\n                        - parent.toolbarHeight * 2) - 3 + 'px';\n                }\n            }\n        };\n        parent.baseImg.onerror = function () {\n            hideSpinner(parent.element);\n            // proxy.reset();\n            // proxy.parent.baseImg.src = proxy.baseImgSrc;\n            proxy.isErrorImage = true;\n            proxy.errorLoading();\n        };\n    };\n    Draw.prototype.errorLoading = function () {\n        var parent = this.parent;\n        var fileOpened = { fileName: null, fileType: null, isValidImage: false };\n        if (isBlazor() && parent.events && parent.events.fileOpened.hasDelegate === true) {\n            parent.dotNetRef.invokeMethodAsync('FileOpenEventAsync', 'FileOpened', fileOpened);\n        }\n        else {\n            parent.trigger('fileOpened', fileOpened);\n        }\n    };\n    Draw.prototype.updateCanvas = function () {\n        var parent = this.parent;\n        var fileOpened = { fileName: this.fileName, fileType: this.fileType, isValidImage: true };\n        parent.img.srcWidth = parent.baseImg.width;\n        parent.img.srcHeight = parent.baseImg.height;\n        var obj = { width: 0, height: 0 };\n        parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false,\n            value: { width: parent.img.srcWidth, height: parent.img.srcHeight, obj: obj } });\n        var maxDimension = obj;\n        parent.img.destLeft = (parent.lowerCanvas.clientWidth - maxDimension.width) / 2;\n        parent.img.destTop = (parent.lowerCanvas.clientHeight - maxDimension.height) / 2;\n        this.drawImgToCanvas(maxDimension);\n        this.zoomCrop.width = parent.img.destWidth;\n        this.zoomCrop.height = parent.img.destHeight;\n        parent.notify('transform', { prop: 'setCropDimension', onPropertyChange: false,\n            value: { width: parent.img.destWidth, height: parent.img.destHeight } });\n        var point = { startX: parent.img.destLeft, startY: parent.img.destTop, width: parent.img.destWidth,\n            height: parent.img.destHeight };\n        parent.notify('crop', { prop: 'setCropDestPoints', onPropertyChange: false, value: { point: point } });\n        var temp = this.lowerContext.filter;\n        this.lowerContext.filter = 'none';\n        parent.notify('shape', { prop: 'iterateObjColl', onPropertyChange: false });\n        parent.notify('freehand-draw', { prop: 'zoomFHDColl', onPropertyChange: false, value: { isPreventApply: null } });\n        this.lowerContext.filter = temp;\n        if (parent.img.destWidth > 0 && parent.img.destHeight > 0) {\n            parent.isImageLoaded = true;\n        }\n        if (parent.isUndoRedo) {\n            if (parent.transform.currFlipState !== '') {\n                parent.notify('transform', { prop: 'flipImage', onPropertyChange: false,\n                    value: { direction: parent.toPascalCase(parent.transform.currFlipState) } });\n            }\n        }\n        if (parent.disabled) {\n            parent.element.setAttribute('class', 'e-disabled');\n        }\n        if (parent.isImageLoaded && parent.element.style.opacity !== '0.5') {\n            if (isBlazor() && parent.events && parent.events.fileOpened.hasDelegate === true) {\n                parent.dotNetRef.invokeMethodAsync('FileOpenEventAsync', 'FileOpened', fileOpened);\n            }\n            else {\n                parent.trigger('fileOpened', fileOpened);\n            }\n        }\n        if (parent.zoomSettings.zoomFactor !== 1 || parent.zoomSettings.zoomPoint) {\n            parent.zoom(parent.zoomSettings.zoomFactor, parent.zoomSettings.zoomPoint);\n        }\n        if (isNullOrUndefined(this.initZoomValue)) {\n            this.initZoomValue = parent.zoomSettings.zoomFactor;\n        }\n        this.isImageEdited = false;\n    };\n    Draw.prototype.performCancel = function (isContextualToolbar) {\n        var parent = this.parent;\n        isContextualToolbar = isContextualToolbar ? isContextualToolbar : false;\n        var obj = { bool: false };\n        parent.notify('selection', { prop: 'getFreehandDrawEditing', onPropertyChange: false, value: { obj: obj } });\n        if (obj['bool']) {\n            parent.notify('freehand-draw', { prop: 'cancelFhd', onPropertyChange: false });\n            if (!isBlazor()) {\n                parent.notify('toolbar', { prop: 'destroy-qa-toolbar', onPropertyChange: false });\n            }\n            else {\n                parent.updateToolbar(parent.element, 'destroyQuickAccessToolbar');\n            }\n            parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'cancel' } });\n        }\n        else if (parent.textArea.style.display === 'block') {\n            parent.textArea.style.display = 'none';\n            parent.textArea.value = '';\n            parent.textArea.style.transform = '';\n            if (this.prevActObj) {\n                parent.activeObj = this.prevActObj;\n                this.prevActObj = null;\n            }\n            else {\n                parent.activeObj.strokeSettings = this.tempStrokeSettings;\n                parent.activeObj.textSettings = this.tempTextSettings;\n            }\n            parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'cancel' } });\n            if (this.isShapeTextInserted) {\n                parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            }\n            parent.notify('shape', { prop: 'applyActObj', onPropertyChange: false, value: { isMouseDown: true } });\n            if (!isBlazor()) {\n                parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n            }\n            else {\n                parent.updateToolbar(parent.element, 'imageLoaded');\n            }\n        }\n        else if ((!isBlazor() && document.querySelector('#' + parent.element.id + '_sliderWrapper')) || (isBlazor() && !parent.element.querySelector('.e-ie-contextual-slider').classList.contains('e-hidden')) ||\n            parent.currObjType.isFiltered) {\n            this.lowerContext.filter = this.tempAdjValue;\n            parent.canvasFilter = this.tempAdjValue;\n            parent.notify('filter', { prop: 'setAdjustmentValue', onPropertyChange: false, value: { adjustmentValue: this.tempAdjValue } });\n            parent.initialAdjustmentValue = this.tempAdjValue;\n            if (this.lowerContext.filter.split(' ').length > 1 &&\n                this.lowerContext.filter.split(' ')[0].split('(')[1].split(')')[0] === '1') {\n                parent.notify('filter', { prop: 'setBrightnessAdjusted', onPropertyChange: false, value: { isBrightnessAdjusted: false } });\n            }\n            parent.currentFilter = this.tempFilter;\n            this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n            this.redrawImgWithObj();\n            parent.currObjType.isFiltered = false;\n            var obj_3 = { tempAdjustmentLevel: null };\n            parent.notify('filter', { prop: 'getTempAdjustmentLevel', onPropertyChange: false, value: { obj: obj_3 } });\n            parent.notify('filter', { prop: 'setAdjustmentLevel', onPropertyChange: false,\n                value: { adjustmentLevel: extend({}, obj_3['tempAdjustmentLevel'], {}, true) } });\n            parent.notify('undo-redo', { prop: 'setUndoRedoStep', onPropertyChange: false, value: { step: this.tempUndoRedoStep } });\n            parent.upperCanvas.style.cursor = parent.cursor = 'default';\n            parent.currObjType.isCustomCrop = false;\n            this.tempStrokeSettings = { strokeColor: '#fff', fillColor: '', strokeWidth: null };\n            this.clearOuterCanvas(this.lowerContext);\n            if ((parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle') || parent.isCircleCrop) {\n                parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                    value: { context: this.lowerContext, isSave: null, isFlip: null } });\n            }\n            var eventargs = { type: 'main', isApplyBtn: null, isCropping: null, isZooming: null };\n            if (!isBlazor()) {\n                parent.element.querySelector('.e-contextual-toolbar-wrapper').classList.add('e-hide');\n                parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: eventargs });\n            }\n            else {\n                parent.updateToolbar(parent.element, 'imageLoaded');\n            }\n            parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'cancel' } });\n        }\n        else {\n            if (isContextualToolbar) {\n                var eventargs = { type: 'main', isApplyBtn: null, isCropping: null, isZooming: null };\n                if (!isBlazor()) {\n                    parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: eventargs });\n                }\n                else {\n                    parent.updateToolbar(parent.element, 'imageLoaded');\n                }\n            }\n            else {\n                this.cancelItems();\n                parent.togglePan = false;\n                parent.notify('selection', { prop: 'setDragCanvas', value: { bool: false } });\n            }\n        }\n        this.isShapeTextInserted = false;\n        this.isNewPath = false;\n        if (!isBlazor()) {\n            parent.notify('toolbar', { prop: 'refresh-dropdown-btn', value: { isDisabled: false } });\n            parent.notify('toolbar', { prop: 'setCurrentToolbar', value: { type: 'main' } });\n        }\n    };\n    Draw.prototype.cancelItems = function () {\n        var parent = this.parent;\n        var isCropSelection = false;\n        var splitWords;\n        var shapes = ['rectangle', 'ellipse', 'line', 'arrow', 'path'];\n        if (parent.activeObj.shape !== undefined) {\n            splitWords = parent.activeObj.shape.split('-');\n        }\n        if (splitWords === undefined && parent.currObjType.isCustomCrop) {\n            isCropSelection = true;\n        }\n        else if (splitWords !== undefined && splitWords[0] === 'crop') {\n            isCropSelection = true;\n        }\n        if (isCropSelection && parent.isCropTab) {\n            parent.isCropTab = false;\n            parent.transform.zoomFactor = parent.transform.defaultZoomFactor;\n        }\n        if (parent.togglePen) {\n            this.cancelPen();\n        }\n        else if (parent.activeObj.shape === 'text') {\n            this.cancelText(isCropSelection);\n        }\n        else if (shapes.indexOf(parent.activeObj.shape) !== -1) {\n            this.cancelShape();\n        }\n        else if (isCropSelection) {\n            this.cancelSelection();\n        }\n        else {\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'cancel' } });\n        }\n        parent.notify('selection', { prop: 'setCurrentDrawingShape', onPropertyChange: false, value: { value: '' } });\n        parent.upperCanvas.style.cursor = parent.cursor = 'default';\n        parent.currObjType.isCustomCrop = false;\n        this.tempStrokeSettings = { strokeColor: '#fff', fillColor: '', strokeWidth: null };\n        var eventargs = { type: 'main', isApplyBtn: null, isCropping: false, isZooming: null };\n        if (!isBlazor()) {\n            parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: eventargs });\n        }\n        else {\n            parent.updateToolbar(parent.element, 'imageLoaded');\n        }\n    };\n    Draw.prototype.cancelPen = function () {\n        var parent = this.parent;\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        parent.togglePen = false;\n        parent.upperCanvas.style.cursor = parent.cursor = 'default';\n        // eslint-disable-next-line\n        var tempPointsColl = extend([], parent.pointColl, [], true);\n        parent.pointColl = {};\n        for (var i = 0; i < this.tempFreehandCounter; i++) {\n            parent.pointColl[i] = tempPointsColl[i];\n        }\n        parent.freehandCounter = this.tempFreehandCounter;\n        parent.notify('freehand-draw', { prop: 'setCurrentFreehandDrawIndex', value: { value: this.tempCurrFhdIndex } });\n        parent.activeObj.strokeSettings = this.tempStrokeSettings;\n        parent.notify('shape', { prop: 'setStrokeSettings',\n            value: { strokeSettings: parent.activeObj.strokeSettings, strokeColor: null, fillColor: null, strokeWidth: null } });\n        parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'cancel' } });\n        parent.notify('selection', { prop: 'setFreehandDrawCustomized', value: { isFreehandDrawCustomized: false } });\n    };\n    Draw.prototype.cancelText = function (isCropSelection) {\n        var parent = this.parent;\n        parent.notify('shape', { prop: 'setTextSettings', onPropertyChange: false,\n            value: { textSettings: this.tempTextSettings, fontFamily: null, fontSize: null } });\n        parent.notify('shape', { prop: 'setStrokeSettings',\n            value: { strokeSettings: this.tempStrokeSettings, strokeColor: null, fillColor: null, strokeWidth: null } });\n        if (isNullOrUndefined(parent.activeObj.currIndex)) {\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        }\n        else {\n            var object = { appliedUndoRedoColl: [] };\n            parent.notify('undo-redo', { prop: 'getAppliedUndoRedoColl', value: { obj: object } });\n            var len = object['appliedUndoRedoColl'].length;\n            if (this.prevActObj && object['appliedUndoRedoColl'][len - 1] &&\n                object['appliedUndoRedoColl'][len - 1].currentObjColl[object['appliedUndoRedoColl'][len - 1].currentObjColl.length - 1].currIndex\n                    === this.prevActObj.currIndex) {\n                parent.activeObj = this.prevActObj;\n                this.prevActObj = null;\n            }\n            else {\n                parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            }\n            if (parent.activeObj.shape && parent.activeObj.keyHistory === 'Enter Text') {\n                parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                parent.notify('shape', { prop: 'draw-shape-text' });\n                parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'cancel' } });\n                parent.notify('shape', { prop: 'applyActObj', onPropertyChange: false, value: { isMouseDown: true } });\n            }\n            else if (parent.activeObj.shape) {\n                parent.notify('shape', { prop: 'redraw-text' });\n                parent.notify('selection', { prop: 'redrawShape', onPropertyChange: false, value: { obj: parent.activeObj } });\n                if (!isCropSelection && parent.activeObj.topLeftCircle !== undefined) {\n                    parent.notify('shape', { prop: 'applyActObj', onPropertyChange: false, value: { isMouseDown: true } });\n                }\n                parent.clearSelection();\n            }\n        }\n        if (!isBlazor()) {\n            parent.notify('toolbar', { prop: 'destroy-qa-toolbar', onPropertyChange: false });\n        }\n        else {\n            parent.updateToolbar(parent.element, 'destroyQuickAccessToolbar');\n        }\n        this.tempTextSettings = { text: 'Enter Text', fontFamily: 'Arial', fontSize: null, fontRatio: null, bold: false,\n            italic: false, underline: false };\n    };\n    Draw.prototype.cancelShape = function () {\n        var parent = this.parent;\n        parent.notify('shape', { prop: 'setStrokeSettings',\n            value: { strokeSettings: this.tempStrokeSettings, strokeColor: null, fillColor: null, strokeWidth: null } });\n        if (isNullOrUndefined(parent.activeObj.currIndex)) {\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        }\n        else if (this.isNewPath) {\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            this.renderImage();\n        }\n        else {\n            var object = { appliedUndoRedoColl: [] };\n            parent.notify('undo-redo', { prop: 'getAppliedUndoRedoColl', value: { obj: object } });\n            var len = object['appliedUndoRedoColl'].length;\n            if (this.prevActObj && object['appliedUndoRedoColl'][len - 1] &&\n                object['appliedUndoRedoColl'][len - 1].currentObjColl[object['appliedUndoRedoColl'][len - 1].currentObjColl.length - 1].currIndex\n                    === this.prevActObj.currIndex) {\n                parent.activeObj = this.prevActObj;\n                this.prevActObj = null;\n                parent.notify('selection', { prop: 'redrawShape', onPropertyChange: false, value: { obj: parent.activeObj } });\n                parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'cancel' } });\n                parent.notify('shape', { prop: 'applyActObj', onPropertyChange: false, value: { isMouseDown: true } });\n            }\n            else {\n                parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            }\n        }\n        parent.currObjType.isDragging = false;\n        if (!isBlazor()) {\n            parent.notify('toolbar', { prop: 'destroy-qa-toolbar', onPropertyChange: false });\n        }\n        else {\n            parent.updateToolbar(parent.element, 'destroyQuickAccessToolbar');\n        }\n    };\n    Draw.prototype.cancelSelection = function () {\n        var parent = this.parent;\n        if (parent.cancelCropSelection) {\n            parent.cropObj = extend({}, parent.cancelCropSelection.previousCropObj, {}, true);\n            parent.afterCropActions = parent.cancelCropSelection.previousObj.afterCropActions;\n            parent.notify('undo-redo', { prop: 'undoDefault', onPropertyChange: false, value: { obj: parent.cancelCropSelection } });\n            parent.currSelectionPoint = extend({}, parent.cancelCropSelection.previousCropObj.activeObj, true);\n            if (parent.currSelectionPoint && isNullOrUndefined(parent.currSelectionPoint.shape)) {\n                parent.currSelectionPoint = null;\n            }\n            this.clearOuterCanvas(this.lowerContext);\n            if (parent.isCircleCrop || (parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle')) {\n                parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                    value: { context: this.lowerContext, isSave: null, isFlip: null } });\n            }\n        }\n    };\n    Draw.prototype.updateFlipPan = function (tempSelectionObj) {\n        var parent = this.parent;\n        if (parent.transform.currFlipState !== '') {\n            var temp = this.lowerContext.filter;\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            parent.notify('transform', { prop: 'rotatedFlip', onPropertyChange: false });\n            this.lowerContext.filter = 'none';\n            parent.notify('freehand-draw', { prop: 'freehandRedraw', onPropertyChange: false,\n                value: { context: this.lowerContext, points: null } });\n            this.lowerContext.filter = temp;\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            if (tempSelectionObj) {\n                this.drawObject('duplicate', tempSelectionObj);\n            }\n        }\n    };\n    Draw.prototype.select = function (type, startX, startY, width, height) {\n        var parent = this.parent;\n        if (!parent.disabled && parent.isImageLoaded) {\n            var object = { currObj: {} };\n            parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n            var previousObj = object['currObj'];\n            previousObj.objColl = extend([], parent.objColl, [], true);\n            previousObj.pointColl = extend([], parent.pointColl, [], true);\n            previousObj.afterCropActions = parent.afterCropActions;\n            var selPointCollObj = { selPointColl: null };\n            parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                value: { obj: selPointCollObj } });\n            previousObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n            parent.notify('crop', { prop: 'setPreviousCropCurrentObj', onPropertyChange: false, value: { obj: previousObj } });\n            if (parent.transform.zoomFactor > 0 && parent.activeObj.shape && parent.activeObj.shape.split('-')[0] === 'crop' && isNullOrUndefined(this.currSelPoint)) {\n                this.currSelPoint = extend({}, parent.activeObj, {}, true);\n            }\n            var isPrevent = false;\n            var splitWords = void 0;\n            if (parent.activeObj.shape !== undefined) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (splitWords === undefined && parent.currObjType.isCustomCrop) {\n                isPrevent = true;\n            }\n            else if (splitWords !== undefined && splitWords[0] === 'crop') {\n                isPrevent = true;\n            }\n            var obj = { currObj: {} };\n            parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: obj } });\n            var prevObj = obj['currObj'];\n            prevObj.objColl = extend([], parent.objColl, [], true);\n            prevObj.pointColl = extend([], parent.pointColl, [], true);\n            prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n            parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                value: { x: null, y: null, isMouseDown: null } });\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            parent.notify('shape', { prop: 'setKeyHistory', onPropertyChange: false, value: { keyHistory: '' } });\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            parent.upperCanvas.style.display = 'block';\n            if (parent.currSelectionPoint || parent.transform.defaultZoomFactor !== 0 ||\n                (parent.transform.degree !== 0 && parent.panPoint.totalPannedInternalPoint.x !== 0 &&\n                    parent.panPoint.totalPannedInternalPoint.y !== 0 && !isPrevent)) {\n                parent.isCircleCrop = false;\n                if (parent.transform.defaultZoomFactor !== 0) {\n                    var isCropTab = parent.isCropTab;\n                    parent.isCropTab = false;\n                    parent.notify('transform', { prop: 'resetZoom', onPropertyChange: false });\n                    parent.isCropTab = isCropTab;\n                    this.resetPanPoints();\n                }\n                parent.notify('freehand-draw', { prop: 'updateFHDColl', onPropertyChange: false });\n                parent.isCropTab = true;\n                parent.isCircleCrop = false;\n                parent.notify('crop', { prop: 'setCurrSelPoints', onPropertyChange: false, value: { isSetDimension: true } });\n                parent.transform.zoomFactor = parent.transform.cropZoomFactor;\n                if (isNullOrUndefined(parent.cropObj.activeObj.shape)) {\n                    parent.currObjType.shape = 'crop-' + type.toLowerCase();\n                    this.drawNewSelection(type, startX, startY, width, height);\n                }\n            }\n            else {\n                if (type === 'custom') {\n                    parent.currObjType.shape = '';\n                }\n                this.drawNewSelection(type, startX, startY, width, height);\n            }\n        }\n    };\n    Draw.prototype.drawNewSelection = function (type, startX, startY, width, height) {\n        var parent = this.parent;\n        var points;\n        var cropShape = 'crop-' + type;\n        if (cropShape.toLowerCase() === 'crop-custom') {\n            if (parent.currObjType.shape === '' || parent.currObjType.shape === 'crop-custom') {\n                this.drawCustomSelection('crop-custom', startX, startY, width, height);\n            }\n        }\n        else if (cropShape.toLowerCase() === 'crop-canvas') {\n            parent.upperCanvas.style.display = 'block';\n            parent.notify('selection', { prop: 'setDragCanvas', value: { bool: true } });\n        }\n        else {\n            parent.currObjType.isCustomCrop = false;\n            parent.currObjType.shape = cropShape.toLowerCase();\n            if (width && height) {\n                points = { startX: startX, startY: startY, endX: startX + width, endY: startY + height,\n                    width: width, height: height };\n            }\n            else if (width && cropShape === 'crop-circle') {\n                points = { startX: startX, startY: startY, endX: startX + width, endY: startY + width,\n                    width: width, height: width };\n            }\n            parent.activeObj.shape = cropShape.toLowerCase();\n            this.updateSelectionInsert(points);\n        }\n    };\n    Draw.prototype.updateSelectionInsert = function (points) {\n        var _this = this;\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        var obj = { shapeSettingsObj: {} };\n        parent.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: obj } });\n        var selectionSettings = { type: parent.getSelectionType(obj['shapeSettingsObj']['type']), startX: obj['shapeSettingsObj']['startX'],\n            startY: obj['shapeSettingsObj']['startY'], width: obj['shapeSettingsObj']['width'], height: obj['shapeSettingsObj']['height'] };\n        var selectionChangingArgs = { action: 'insert', previousSelectionSettings: selectionSettings,\n            currentSelectionSettings: selectionSettings };\n        if (isBlazor() && parent.events && parent.events.onSelectionResizeStart.hasDelegate === true) {\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            parent.dotNetRef.invokeMethodAsync('SelectionEventAsync', 'OnSelectionResizeStart', selectionChangingArgs).then(function (selectionChangingArgs) {\n                parent.notify('shape', { prop: 'updSelChangeEventArgs', onPropertyChange: false,\n                    value: { selectionSettings: selectionChangingArgs.currentSelectionSettings } });\n                if (selectionChangingArgs.currentSelectionSettings.type === 'Custom') {\n                    _this.drawObject('duplicate', parent.activeObj, null, null, true);\n                }\n                else {\n                    if (actPoint.startX !== 0 || actPoint.startY !== 0 ||\n                        actPoint.width !== 0 || actPoint.height !== 0) {\n                        points = { startX: actPoint.startX, startY: actPoint.startY,\n                            endX: actPoint.endX, endY: actPoint.endY,\n                            width: actPoint.width, height: actPoint.height };\n                    }\n                    _this.drawObject('duplicate', null, true, points);\n                }\n            });\n        }\n        else {\n            parent.trigger('selectionChanging', selectionChangingArgs);\n            parent.notify('shape', { prop: 'updSelChangeEventArgs', onPropertyChange: false,\n                value: { selectionSettings: selectionChangingArgs.currentSelectionSettings } });\n            if (selectionChangingArgs.currentSelectionSettings.type === 'Custom') {\n                this.drawObject('duplicate', parent.activeObj, null, null, true);\n            }\n            else {\n                if (actPoint.startX !== 0 || actPoint.startY !== 0 ||\n                    actPoint.width !== 0 || actPoint.height !== 0) {\n                    points = { startX: actPoint.startX, startY: actPoint.startY,\n                        endX: actPoint.endX, endY: actPoint.endY,\n                        width: actPoint.width, height: actPoint.height };\n                }\n                this.drawObject('duplicate', null, true, points);\n            }\n        }\n    };\n    Draw.prototype.drawCustomSelection = function (cropShape, startX, startY, width, height) {\n        var parent = this.parent;\n        var actPoint = parent.activeObj.activePoint;\n        parent.currObjType.isCustomCrop = true;\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        parent.currObjType.shape = parent.activeObj.shape = cropShape.toLowerCase();\n        if (!isNullOrUndefined(startX) && !isNullOrUndefined(startY) && !isNullOrUndefined(width) && !isNullOrUndefined(height)) {\n            actPoint.startX = startX;\n            actPoint.startY = startY;\n            actPoint.endX = startX + width;\n            actPoint.endY = startY + height;\n            actPoint.width = width;\n            actPoint.height = height;\n        }\n        else {\n            if (isNullOrUndefined(parent.transform.zoomFactor) || parent.transform.zoomFactor === 0) {\n                var imgLeft_1 = parent.img.destLeft;\n                var imgTop_1 = parent.img.destTop;\n                var imgWidth_1 = parent.img.destWidth;\n                var imgHeight_1 = parent.img.destHeight;\n                var lowerCanvasWidth_1 = parent.lowerCanvas.width;\n                var lowerCanvasHeight_1 = parent.lowerCanvas.height;\n                var activePoint_1 = actPoint;\n                if (imgLeft_1 >= 0 && imgTop_1 >= 0) {\n                    activePoint_1.startX = imgLeft_1;\n                    activePoint_1.startY = imgTop_1;\n                    activePoint_1.endX = imgLeft_1 + imgWidth_1;\n                    activePoint_1.endY = imgTop_1 + imgHeight_1;\n                }\n                else if (imgLeft_1 >= 0) {\n                    activePoint_1.startX = imgLeft_1;\n                    activePoint_1.startY = 7.5;\n                    activePoint_1.endX = imgLeft_1 + imgWidth_1;\n                    activePoint_1.endY = lowerCanvasHeight_1 - 15;\n                }\n                else if (imgTop_1 >= 0) {\n                    activePoint_1.startX = 7.5;\n                    activePoint_1.startY = imgTop_1;\n                    activePoint_1.endX = lowerCanvasWidth_1 - 15;\n                    activePoint_1.endY = imgTop_1 + imgHeight_1;\n                }\n                else {\n                    activePoint_1.startX = 7.5;\n                    activePoint_1.startY = 7.5;\n                    activePoint_1.endX = lowerCanvasWidth_1 - 15;\n                    activePoint_1.endY = lowerCanvasHeight_1 - 15;\n                }\n            }\n            else {\n                var imgLeft_2 = parent.img.destLeft;\n                var imgTop_2 = parent.img.destTop;\n                var imgWidth_2 = parent.img.destWidth;\n                var imgHeight_2 = parent.img.destHeight;\n                var lowerCanvasWidth_2 = parent.lowerCanvas.width;\n                var lowerCanvasHeight_2 = parent.lowerCanvas.height;\n                var activePoint_2 = actPoint;\n                activePoint_2.startX = Math.max(imgLeft_2 > 0 ? imgLeft_2 : 7.5, imgLeft_2);\n                activePoint_2.startY = Math.max(imgTop_2 > 0 ? imgTop_2 : 7.5, imgTop_2);\n                activePoint_2.endX = Math.min(imgLeft_2 + imgWidth_2 + 15 < lowerCanvasWidth_2 ? imgLeft_2 + imgWidth_2 - 15 :\n                    lowerCanvasWidth_2 - 15, imgLeft_2 + imgWidth_2);\n                activePoint_2.endY = Math.min(imgTop_2 + imgHeight_2 + 15 < lowerCanvasHeight_2 ? imgTop_2 + imgHeight_2 - 15 :\n                    lowerCanvasHeight_2 - 15, imgTop_2 + imgHeight_2);\n            }\n            var imgLeft = parent.img.destLeft;\n            var imgTop = parent.img.destTop;\n            var imgWidth = parent.img.destWidth;\n            var imgHeight = parent.img.destHeight;\n            var lowerCanvasWidth = parent.lowerCanvas.clientWidth;\n            var lowerCanvasHeight = parent.lowerCanvas.clientHeight;\n            var activePoint = actPoint;\n            activePoint.startX = Math.max(activePoint.startX, imgLeft);\n            activePoint.startY = Math.max(activePoint.startY, imgTop);\n            activePoint.endX = Math.min(activePoint.endX, imgLeft + imgWidth);\n            activePoint.endY = Math.min(activePoint.endY, imgTop + imgHeight);\n            if (activePoint.startX === imgLeft && imgLeft + imgWidth > lowerCanvasWidth) {\n                activePoint.endX = lowerCanvasWidth - 15;\n            }\n            if (activePoint.startY === imgTop && imgTop + imgHeight > lowerCanvasHeight) {\n                activePoint.endY = lowerCanvasHeight - 15;\n            }\n            parent.activeObj = this.updateWidthHeight(parent.activeObj);\n            this.updateActiveObject(actPoint, parent.activeObj);\n        }\n        this.updateSelectionInsert();\n    };\n    Draw.prototype.callUpdateCurrTransState = function () {\n        var parent = this.parent;\n        var tempObjColl = extend([], parent.objColl, [], true);\n        var tempActiveObj = extend({}, parent.activeObj, {}, true);\n        parent.objColl = [];\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        this.isRotateZoom = true;\n        this.updateCurrTransState('initial');\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        if (parent.transform.degree === 0 && parent.rotateFlipColl.length > 0) {\n            parent.img.destLeft += parent.panPoint.totalPannedPoint.x;\n            parent.img.destTop += parent.panPoint.totalPannedPoint.y;\n        }\n        parent.img.destLeft += parent.panPoint.totalPannedInternalPoint.x;\n        parent.img.destTop += parent.panPoint.totalPannedInternalPoint.y;\n        var temp = this.lowerContext.filter;\n        if (parent.transform.degree === 0) {\n            parent.notify('transform', { prop: 'setDestPointsForFlipState', onPropertyChange: false });\n        }\n        parent.notify('filter', { prop: 'updateBrightFilter', onPropertyChange: false });\n        this.lowerContext.drawImage(parent.baseImg, parent.img.srcLeft, parent.img.srcTop, parent.img.srcWidth, parent.img.srcHeight, parent.img.destLeft, parent.img.destTop, parent.img.destWidth, parent.img.destHeight);\n        this.updateCurrTransState('reverse');\n        if (parent.transform.degree === 0 && parent.rotateFlipColl.length > 0) {\n            parent.img.destLeft += parent.panPoint.totalPannedPoint.x;\n            parent.img.destTop += parent.panPoint.totalPannedPoint.y;\n        }\n        this.isRotateZoom = false;\n        parent.objColl = tempObjColl;\n        var tempTogglePen = parent.togglePen;\n        parent.togglePen = false;\n        this.lowerContext.filter = 'none';\n        parent.notify('shape', { prop: 'iterateObjColl', onPropertyChange: false });\n        parent.img.destLeft += parent.panPoint.totalPannedInternalPoint.x;\n        parent.img.destTop += parent.panPoint.totalPannedInternalPoint.y;\n        parent.notify('freehand-draw', { prop: 'freehandRedraw', onPropertyChange: false,\n            value: { context: this.lowerContext, points: null } });\n        parent.img.destLeft -= parent.panPoint.totalPannedInternalPoint.x;\n        parent.img.destTop -= parent.panPoint.totalPannedInternalPoint.y;\n        parent.togglePen = tempTogglePen;\n        this.lowerContext.filter = temp;\n        parent.activeObj = tempActiveObj;\n    };\n    Draw.prototype.resetPanPoints = function () {\n        this.parent.panPoint.totalPannedPoint = { x: 0, y: 0 };\n        this.parent.panPoint.totalPannedClientPoint = { x: 0, y: 0 };\n        this.parent.panPoint.totalPannedInternalPoint = { x: 0, y: 0 };\n    };\n    Draw.prototype.setClientTransDim = function (isPreventDimension) {\n        var parent = this.parent;\n        if (parent.transform.degree % 90 === 0 && parent.transform.degree % 180 !== 0) {\n            parent.img.destLeft = (parent.lowerCanvas.width - parent.img.destHeight) / 2;\n            parent.img.destTop = (parent.lowerCanvas.height - parent.img.destWidth) / 2;\n            var temp = parent.img.destWidth;\n            parent.img.destWidth = parent.img.destHeight;\n            parent.img.destHeight = temp;\n        }\n        else {\n            if (isNullOrUndefined(isPreventDimension)) {\n                parent.img.destLeft = (parent.lowerCanvas.width - parent.img.destWidth) / 2;\n                parent.img.destTop = (parent.lowerCanvas.height - parent.img.destHeight) / 2;\n            }\n        }\n    };\n    Draw.prototype.redrawImgWithObj = function () {\n        var parent = this.parent;\n        var obj = { canvasFilter: parent.canvasFilter };\n        this.lowerContext.filter = obj['canvasFilter'];\n        if (parent.rotateFlipColl.length !== 0) {\n            var totalPannedInternalPoint = extend({}, parent.panPoint.totalPannedInternalPoint, {}, true);\n            var destPoints = { startX: parent.img.destLeft, startY: parent.img.destTop, width: parent.img.destWidth,\n                height: parent.img.destHeight };\n            this.callUpdateCurrTransState();\n            parent.panPoint.totalPannedInternalPoint = totalPannedInternalPoint;\n            parent.img.destLeft = destPoints.startX;\n            parent.img.destTop = destPoints.startY;\n            parent.img.destWidth = destPoints.width;\n            parent.img.destHeight = destPoints.height;\n        }\n        else {\n            this.callUpdateCurrTransState();\n        }\n        if (parent.isCircleCrop) {\n            parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                value: { context: this.lowerContext, isSave: null, isFlip: null } });\n        }\n        var tempFilter = this.lowerContext.filter;\n        this.lowerContext.filter = parent.getDefaultFilter();\n        parent.notify('shape', { prop: 'iterateObjColl', onPropertyChange: false });\n        parent.notify('freehand-draw', { prop: 'freehandRedraw', onPropertyChange: false,\n            value: { context: this.lowerContext, points: null } });\n        this.lowerContext.filter = tempFilter;\n    };\n    Draw.prototype.setCurrentObj = function (obj) {\n        var parent = this.parent;\n        var isObj = obj ? true : false;\n        obj = obj ? obj : parent.cropObj;\n        parent.transform.cropZoomFactor = obj.cropZoom;\n        parent.transform.defaultZoomFactor = obj.defaultZoom;\n        if (!isObj) {\n            parent.transform.zoomFactor = obj.cropZoom;\n        }\n        else {\n            if (obj.activeObj.shape && obj.activeObj.shape.split('-')[0] === 'crop') {\n                parent.transform.zoomFactor = obj.cropZoom;\n            }\n            else {\n                parent.transform.zoomFactor = obj.defaultZoom;\n            }\n        }\n        parent.setProperties({ zoomSettings: { zoomFactor: obj.zoomFactor } }, true);\n        parent.notify('transform', { prop: 'setPreviousZoomValue', onPropertyChange: false, value: { previousZoomValue: obj.previousZoomValue } });\n        parent.panPoint.totalPannedPoint = extend({}, obj.totalPannedPoint, {}, true);\n        parent.panPoint.totalPannedClientPoint = extend({}, obj.totalPannedClientPoint, {}, true);\n        parent.panPoint.totalPannedInternalPoint = extend({}, obj.totalPannedInternalPoint, {}, true);\n        var point = extend({}, obj.tempFlipPanPoint, {}, true);\n        parent.notify('crop', { prop: 'setTempFlipPanPoint', onPropertyChange: false, value: { point: point } });\n        parent.rotateFlipColl = extend([], obj.rotateFlipColl, [], true);\n        parent.transform.degree = obj.degree;\n        parent.transform.currFlipState = obj.currFlipState;\n        parent.img.destLeft = obj.destPoints.startX;\n        parent.img.destTop = obj.destPoints.startY;\n        parent.img.destWidth = obj.destPoints.width;\n        parent.img.destHeight = obj.destPoints.height;\n        parent.img.srcLeft = obj.srcPoints.startX;\n        parent.img.srcTop = obj.srcPoints.startY;\n        parent.img.srcWidth = obj.srcPoints.width;\n        parent.img.srcHeight = obj.srcPoints.height;\n        if (obj.afterCropActions) {\n            parent.afterCropActions = obj.afterCropActions;\n        }\n        this.lowerContext.filter = obj.filter;\n        parent.notify('filter', { prop: 'setBrightnessAdjusted', onPropertyChange: false, value: { isBrightnessAdjusted: obj.isBrightAdjust } });\n        var isCircleCrop = parent.isCircleCrop;\n        var currSelectionPoint;\n        if (isNullOrUndefined(parent.currSelectionPoint)) {\n            currSelectionPoint = null;\n        }\n        else {\n            currSelectionPoint = extend({}, parent.currSelectionPoint, {}, true);\n            parent.currSelectionPoint = null;\n        }\n        parent.isCircleCrop = false;\n        this.drawCropSelectionImage(obj, false);\n        if (parent.transform.degree !== 0) {\n            if (parent.transform.currFlipState === '') {\n                parent.notify('transform', { prop: 'rotatePan', onPropertyChange: false,\n                    value: { isCropSelection: null, isDefaultZoom: null } });\n            }\n            else {\n                parent.notify('transform', { prop: 'drawPannedImage', value: { xDiff: 0, yDiff: 0 } });\n            }\n            parent.img.destLeft = obj.destPoints.startX;\n            parent.img.destTop = obj.destPoints.startY;\n            parent.panPoint.totalPannedClientPoint = extend({}, obj.totalPannedClientPoint, {}, true);\n            parent.panPoint.totalPannedInternalPoint = extend({}, obj.totalPannedInternalPoint, {}, true);\n        }\n        parent.activeObj = extend({}, obj.activeObj, {}, true);\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        if (parent.activeObj.activePoint.width !== 0 && parent.activeObj.activePoint.height !== 0) {\n            this.drawObject('duplicate', null, null, null, true);\n        }\n        var activeObj = extend({}, obj.activeObj, {}, true);\n        var isAfterCropAction = false;\n        if (parent.afterCropActions.length > 0) {\n            var object = { collection: parent.afterCropActions };\n            parent.notify('shape', { prop: 'alignRotateFlipColl', onPropertyChange: false,\n                value: { collection: parent.afterCropActions, isRotateFlipCollection: null, obj: object } });\n            parent.afterCropActions = object['collection'];\n        }\n        var afterCropActions = extend([], parent.afterCropActions, [], true);\n        if (!isObj && afterCropActions.length > 0) {\n            isAfterCropAction = true;\n            for (var i = 0; i < afterCropActions.length; i++) {\n                if (afterCropActions[i] === 'horizontalflip' || afterCropActions[i] === 'verticalflip') {\n                    parent.activeObj = extend({}, currSelectionPoint, {}, true);\n                    this.rotatedFlipCropSel = true;\n                }\n                parent.notify('transform', { prop: 'updateTransform', onPropertyChange: false, value: { text: afterCropActions[i] } });\n            }\n            activeObj = extend({}, parent.activeObj, {}, true);\n            this.resetPanPoints();\n            parent.activeObj = activeObj;\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            if (parent.activeObj.activePoint.width !== 0 && parent.activeObj.activePoint.height !== 0) {\n                this.drawObject('duplicate', null, null, null, true);\n            }\n            if (obj.degree !== parent.transform.degree) {\n                parent.transform.cropZoomFactor = null;\n                parent.transform.zoomFactor = 0;\n            }\n            parent.notify('freehand-draw', { prop: 'updateFHDColl', onPropertyChange: false });\n            if (this.rotatedFlipCropSel) {\n                this.rotatedFlipCropSel = false;\n            }\n        }\n        parent.afterCropActions = afterCropActions;\n        if (!this.isCancelAction && !isAfterCropAction) {\n            parent.notify('freehand-draw', { prop: 'updateFHDColl', onPropertyChange: false });\n            parent.notify('freehand-draw', { prop: 'zoomFHDColl', onPropertyChange: false, value: { isPreventApply: null } });\n            parent.img.destLeft = obj.destPoints.startX;\n            parent.img.destTop = obj.destPoints.startY;\n        }\n        parent.activeObj = activeObj;\n        parent.isCircleCrop = isCircleCrop;\n        if (isNullOrUndefined(currSelectionPoint)) {\n            parent.currSelectionPoint = null;\n        }\n        else {\n            parent.currSelectionPoint = extend({}, currSelectionPoint, {}, true);\n            if (parent.currSelectionPoint && isNullOrUndefined(parent.currSelectionPoint.shape)) {\n                parent.currSelectionPoint = null;\n            }\n        }\n    };\n    Draw.prototype.drawCropSelectionImage = function (obj, isObj) {\n        var parent = this.parent;\n        var temp = this.lowerContext.filter;\n        parent.clearContext(this.lowerContext);\n        parent.clearContext(this.upperContext);\n        this.lowerContext.setTransform(1, 0, 0, 1, 0, 0);\n        if (isObj) {\n            this.updateCurrTransState('initial');\n        }\n        else {\n            this.setTransformColl(this.lowerContext, 'initial');\n        }\n        parent.notify('transform', { prop: 'setDestPointsForFlipState', onPropertyChange: false });\n        parent.notify('filter', { prop: 'updateBrightFilter', onPropertyChange: false });\n        this.lowerContext.drawImage(parent.baseImg, parent.img.srcLeft, parent.img.srcTop, parent.img.srcWidth, parent.img.srcHeight, parent.img.destLeft, parent.img.destTop, parent.img.destWidth, parent.img.destHeight);\n        if (isObj) {\n            this.updateCurrTransState('reverse');\n        }\n        else {\n            this.setTransformColl(this.lowerContext, 'reverse');\n        }\n        parent.img.destLeft = parent.cropObj.destPoints.startX;\n        parent.img.destTop = parent.cropObj.destPoints.startY;\n        var activeObj = extend({}, obj.activeObj, {}, true);\n        this.lowerContext.filter = 'none';\n        if (this.isCancelAction) {\n            parent.notify('shape', { prop: 'zoomObjColl', onPropertyChange: false, value: { isPreventApply: null } });\n            parent.notify('freehand-draw', { prop: 'zoomFHDColl', onPropertyChange: false, value: { isPreventApply: null } });\n        }\n        else {\n            parent.img.destLeft = obj.destPoints.startX;\n            parent.img.destTop = obj.destPoints.startY;\n            parent.img.destWidth = obj.destPoints.width;\n            parent.img.destHeight = obj.destPoints.height;\n            parent.img.srcLeft = obj.srcPoints.startX;\n            parent.img.srcTop = obj.srcPoints.startY;\n            parent.img.srcWidth = obj.srcPoints.width;\n            parent.img.srcHeight = obj.srcPoints.height;\n            var destPoints = { startX: parent.img.destLeft, startY: parent.img.destTop, width: parent.img.destWidth,\n                height: parent.img.destHeight };\n            parent.img.destLeft = obj.activeObj.activePoint.startX;\n            parent.img.destTop = obj.activeObj.activePoint.startY;\n            parent.img.destWidth = obj.activeObj.activePoint.width;\n            parent.img.destHeight = obj.activeObj.activePoint.height;\n            parent.notify('shape', { prop: 'zoomObjColl', onPropertyChange: false, value: { isPreventApply: null } });\n            parent.notify('freehand-draw', { prop: 'zoomFHDColl', onPropertyChange: false, value: { isPreventApply: null } });\n            parent.img.destLeft = destPoints.startX;\n            parent.img.destTop = destPoints.startY;\n            parent.img.destWidth = destPoints.width;\n            parent.img.destHeight = destPoints.height;\n        }\n        parent.activeObj = activeObj;\n        this.lowerContext.filter = temp;\n    };\n    Draw.prototype.performPointZoom = function (x, y, type) {\n        var parent = this.parent;\n        var ratioX = (x - parent.img.destLeft) / parent.img.destWidth;\n        var ratioY = (y - parent.img.destTop) / parent.img.destHeight;\n        var isUndoRedo = parent.isUndoRedo;\n        parent.isUndoRedo = true;\n        parent.setProperties({ zoomSettings: { zoomPoint: { x: x, y: y } } }, true);\n        if (type === 'zoomIn') {\n            parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                value: { zoomFactor: .1, zoomPoint: null } });\n        }\n        else if (type === 'zoomOut') {\n            parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                value: { zoomFactor: -.1, zoomPoint: null } });\n        }\n        parent.isUndoRedo = isUndoRedo;\n        if (parent.transform.zoomFactor > 0) {\n            var destLeft = parent.img.destLeft;\n            var destTop = parent.img.destTop;\n            var activeObj = extend({}, parent.activeObj, {}, true);\n            if (parent.transform.degree === 0) {\n                parent.img.destLeft = x - (ratioX * parent.img.destWidth);\n                parent.img.destTop = y - (ratioY * parent.img.destHeight);\n                this.drawZoomPanImage(parent.img.destLeft - destLeft, parent.img.destTop - destTop);\n            }\n            else {\n                var isCropTab = parent.isCropTab;\n                parent.isCropTab = true;\n                var objColl = extend([], parent.objColl, [], true);\n                var pointColl = extend([], parent.pointColl, [], true);\n                parent.objColl = [];\n                parent.pointColl = [];\n                parent.freehandCounter = 0;\n                var object = { selPointColl: null };\n                parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                    value: { obj: object } });\n                var cropSelPointColl = object['selPointColl'];\n                parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n                    value: { obj: { selPointColl: [] } } });\n                parent.panPoint.currentPannedPoint = { x: (x - (ratioX * parent.img.destWidth)) - destLeft,\n                    y: (y - (ratioY * parent.img.destHeight)) - destTop };\n                parent.notify('transform', { prop: 'rotatePan', onPropertyChange: false,\n                    value: { isCropSelection: null, isDefaultZoom: null } });\n                parent.isCropTab = isCropTab;\n                parent.objColl = objColl;\n                parent.pointColl = pointColl;\n                parent.freehandCounter = parent.pointColl.length;\n                parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n                    value: { obj: { selPointColl: cropSelPointColl } } });\n                parent.notify('shape', { prop: 'panObjColl', onPropertyChange: false,\n                    value: { xDiff: parent.panPoint.currentPannedPoint.x, yDiff: parent.panPoint.currentPannedPoint.y, panRegion: '' } });\n                parent.notify('freehand-draw', { prop: 'panFHDColl', onPropertyChange: false,\n                    value: { xDiff: parent.panPoint.currentPannedPoint.x, yDiff: parent.panPoint.currentPannedPoint.y, panRegion: '' } });\n            }\n            this.adjustPanning(activeObj);\n            parent.activeObj = activeObj;\n            if (parent.activeObj.activePoint.width !== 0 && parent.activeObj.activePoint.height !== 0) {\n                this.drawObject('duplicate', null, null, null, true);\n            }\n        }\n    };\n    Draw.prototype.adjustPanning = function (activeObj) {\n        var parent = this.parent;\n        if (activeObj.activePoint.width !== 0 && activeObj.activePoint.height !== 0) {\n            var destLeft = parent.img.destLeft;\n            var destTop = parent.img.destTop;\n            var point = { x: 0, y: 0 };\n            if (parent.img.destLeft > activeObj.activePoint.startX) {\n                point.x = parent.img.destLeft - activeObj.activePoint.startX;\n            }\n            else if (parent.img.destLeft + parent.img.destWidth < activeObj.activePoint.startX + activeObj.activePoint.width) {\n                point.x = (parent.img.destLeft + parent.img.destWidth) - (activeObj.activePoint.startX + activeObj.activePoint.width);\n            }\n            if (parent.img.destTop > activeObj.activePoint.startY) {\n                point.y = parent.img.destTop - activeObj.activePoint.startY;\n            }\n            else if (parent.img.destTop + parent.img.destHeight < activeObj.activePoint.startY + activeObj.activePoint.height) {\n                point.y = (parent.img.destTop + parent.img.destHeight) - (activeObj.activePoint.startY + activeObj.activePoint.height);\n            }\n            if (parent.transform.degree === 0) {\n                parent.img.destLeft -= point.x;\n                parent.img.destTop -= point.y;\n                this.drawZoomPanImage(parent.img.destLeft - destLeft, parent.img.destTop - destTop);\n            }\n            else {\n                var isCropTab = parent.isCropTab;\n                parent.isCropTab = true;\n                var objColl = extend([], parent.objColl, [], true);\n                var pointColl = extend([], parent.pointColl, [], true);\n                parent.objColl = [];\n                parent.pointColl = [];\n                parent.freehandCounter = 0;\n                var object = { selPointColl: null };\n                parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                    value: { obj: object } });\n                var cropSelPointColl = object['selPointColl'];\n                parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n                    value: { obj: { selPointColl: [] } } });\n                parent.img.destLeft -= point.x;\n                parent.img.destTop -= point.y;\n                parent.panPoint.currentPannedPoint = { x: parent.img.destLeft - destLeft, y: parent.img.destTop - destTop };\n                parent.notify('transform', { prop: 'rotatePan', onPropertyChange: false,\n                    value: { isCropSelection: null, isDefaultZoom: null } });\n                parent.isCropTab = isCropTab;\n                parent.objColl = objColl;\n                parent.pointColl = pointColl;\n                parent.freehandCounter = parent.pointColl.length;\n                parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n                    value: { obj: { selPointColl: cropSelPointColl } } });\n                parent.notify('shape', { prop: 'panObjColl', onPropertyChange: false,\n                    value: { xDiff: parent.panPoint.currentPannedPoint.x, yDiff: parent.panPoint.currentPannedPoint.y, panRegion: '' } });\n                parent.notify('freehand-draw', { prop: 'panFHDColl', onPropertyChange: false,\n                    value: { xDiff: parent.panPoint.currentPannedPoint.x, yDiff: parent.panPoint.currentPannedPoint.y, panRegion: '' } });\n            }\n        }\n    };\n    Draw.prototype.drawZoomPanImage = function (x, y) {\n        var parent = this.parent;\n        parent.notify('shape', { prop: 'panObjColl', onPropertyChange: false,\n            value: { xDiff: x, yDiff: y, panRegion: '' } });\n        parent.notify('freehand-draw', { prop: 'panFHDColl', onPropertyChange: false,\n            value: { xDiff: x, yDiff: y, panRegion: '' } });\n        this.renderImage(true);\n        var obj = { width: 0, height: 0 };\n        parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false,\n            value: { width: parent.img.srcWidth, height: parent.img.srcHeight, obj: obj } });\n        var maxDimension = obj;\n        maxDimension.width += (maxDimension.width * parent.transform.zoomFactor);\n        maxDimension.height += (maxDimension.height * parent.transform.zoomFactor);\n        parent.panPoint.totalPannedPoint.x += x;\n        parent.panPoint.totalPannedPoint.y += y;\n        parent.notify('crop', { prop: 'setTempFlipPanPoint', onPropertyChange: false, value: { point: { x: 0, y: 0 } } });\n    };\n    Draw.prototype.openNewImage = function () {\n        var parent = this.parent;\n        var inMemoryContext = parent.inMemoryCanvas.getContext('2d');\n        showSpinner(parent.element);\n        parent.element.style.opacity = '0.5';\n        var toolbar = document.querySelector('#' + parent.element.id + '_currPos');\n        if (toolbar) {\n            toolbar.style.display = 'none';\n        }\n        var obj = { defToolbarItems: null };\n        if (!isBlazor()) {\n            parent.notify('toolbar', { prop: 'getDefToolbarItems', value: { obj: obj } });\n            if (obj['defToolbarItems'].length === 0 &&\n                (isNullOrUndefined(document.getElementById(parent.element.id + '_toolbar')))) {\n                var height = parent.element.querySelector('#' + parent.element.id + '_toolbarArea').clientHeight;\n                parent.notify('toolbar', { prop: 'setToolbarHeight', value: { height: height } });\n            }\n        }\n        else {\n            if (parent.element.querySelector('#' + parent.element.id + '_toolbarArea')) {\n                parent.toolbarHeight = parent.element.querySelector('#' + parent.element.id + '_toolbarArea').clientHeight;\n            }\n        }\n        parent.reset();\n        parent.update();\n        parent.transform.degree = 0;\n        parent.transform.zoomFactor = 0;\n        parent.isImageLoaded = false;\n        parent.currSelectionPoint = null;\n        var type = typeof (this.openURL);\n        if (type === 'string') {\n            var fileName = this.openURL.split('.');\n            if (fileName.length > 1) {\n                fileName = fileName[fileName.length - 2].split('/');\n                this.fileName = fileName[fileName.length - 1];\n            }\n            else {\n                this.fileName = 'ImageEditor';\n            }\n            this.fileType = this.getFileExtensionFromURL(this.openURL);\n            if (this.fileType) {\n                this.fileType = parent.toPascalCase(this.fileType);\n                var fileType = this.fileType.toLowerCase();\n                if (fileType === 'jpg' || fileType === 'jpeg') {\n                    this.fileType = 'Jpeg';\n                    fileType = 'jpeg';\n                }\n                if (fileType !== 'jpeg' && fileType !== 'png' && fileType !== 'svg') {\n                    this.fileType = null;\n                }\n            }\n            this.imageOnLoad(this.openURL);\n        }\n        else {\n            this.fileName = 'ImageEditor';\n            this.fileType = null;\n            parent.lowerCanvas = document.querySelector('#' + parent.element.id + '_lowerCanvas');\n            parent.upperCanvas = document.querySelector('#' + parent.element.id + '_upperCanvas');\n            this.lowerContext = parent.lowerCanvas.getContext('2d');\n            this.upperContext = parent.upperCanvas.getContext('2d');\n            parent.clearContext(this.lowerContext);\n            parent.clearContext(this.upperContext);\n            parent.clearContext(inMemoryContext);\n            parent.inMemoryCanvas.width = this.openURL.width;\n            parent.inMemoryCanvas.height = this.openURL.height;\n            inMemoryContext.putImageData(this.openURL, 0, 0);\n            parent.baseImg.src = parent.inMemoryCanvas.toDataURL();\n        }\n    };\n    Draw.prototype.dlgBtnClick = function () {\n        var parent = this.parent;\n        parent.export();\n        if (this.isFileChanged) {\n            parent.isImageLoaded = this.isFileChanged = false;\n            parent.reset();\n            this.checkToolbarTemplate(this.inputElem, this.openURL);\n        }\n        else {\n            this.reset();\n            this.openNewImage();\n        }\n        if (!isBlazor()) {\n            getComponent(document.getElementById(parent.element.id + '_dialog'), 'dialog').destroy();\n        }\n        this.isImageEdited = false;\n    };\n    Draw.prototype.dlgCloseBtnClick = function () {\n        var parent = this.parent;\n        this.baseImgSrc = parent.baseImg.src;\n        if (this.isFileChanged) {\n            parent.isImageLoaded = this.isFileChanged = false;\n            parent.reset();\n            this.checkToolbarTemplate(this.inputElem, this.openURL);\n        }\n        else {\n            this.reset();\n            this.openNewImage();\n        }\n        if (!isBlazor()) {\n            getComponent(document.getElementById(parent.element.id + '_dialog'), 'dialog').destroy();\n        }\n        this.isImageEdited = false;\n    };\n    Draw.prototype.showDialogPopup = function () {\n        this.parent.element.querySelector('#' + this.parent.element.id + '_dialog').style.display = 'block';\n        var dialog = new Dialog({\n            header: 'Confirm Save Changes',\n            closeOnEscape: true,\n            content: '<span>Do you want to save the changes you made to the image?</span>',\n            target: document.getElementById('target'),\n            width: '285px',\n            isModal: true,\n            animationSettings: { effect: 'Zoom' },\n            close: this.dlgCloseBtnClick.bind(this),\n            buttons: [\n                { click: this.dlgCloseBtnClick.bind(this),\n                    buttonModel: { content: 'No', iconCss: 'e-icons e-close' }\n                },\n                { click: this.dlgBtnClick.bind(this),\n                    buttonModel: { content: 'Yes', isPrimary: true, iconCss: 'e-icons e-check' } }\n            ]\n        });\n        dialog.appendTo('#' + this.parent.element.id + '_dialog');\n    };\n    Draw.prototype.restoreOldImage = function () {\n        if (this.parent.isImageLoaded) {\n            // if (this.isImageEdited || this.parent.pointColl.length > 0 || this.parent.objColl.length > 0) {\n            //     this.showDialogPopup();\n            // } else {\n            // this.reset();\n            // this.openNewImage();\n            // }\n            // const data: ImageData = this.parent.getImageData();\n            // const canvas: HTMLCanvasElement = document.createElement('canvas');\n            // canvas.width = data.width; canvas.height = data.height;\n            // canvas.getContext('2d').putImageData(data, 0, 0);\n            // this.baseImgSrc = canvas.toDataURL();\n            this.reset();\n            this.openNewImage();\n        }\n        else {\n            this.openNewImage();\n        }\n    };\n    Draw.prototype.open = function (data) {\n        if (!this.parent.disabled) {\n            this.openURL = data;\n            this.restoreOldImage();\n        }\n    };\n    Draw.prototype.getInitialLoaded = function (object) {\n        object['isInitialLoaded'] = this.isInitialLoading;\n    };\n    Draw.prototype.getFileExtensionFromURL = function (url) {\n        var lastDotIndex = url.lastIndexOf('.');\n        if (lastDotIndex !== -1) {\n            return url.slice(lastDotIndex + 1).toLowerCase();\n        }\n        return null;\n    };\n    Draw.prototype.fileSelect = function (inputElement, args) {\n        var parent = this.parent;\n        if (!parent.disabled) {\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            var filesData = args.target.files[0];\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            var fileData = filesData;\n            var fileExtension = fileData.name && fileData.name.split('.')[1].toLowerCase();\n            if (fileExtension && ['jpg', 'jpeg', 'png', 'svg'].indexOf(fileExtension) === -1) {\n                this.errorLoading();\n                return;\n            }\n            showSpinner(parent.element);\n            parent.element.style.opacity = '0.5';\n            this.inputElem = inputElement;\n            fileExtension = fileData.name && fileData.name.split('.')[1];\n            if (fileExtension) {\n                var fileType = parent.toPascalCase(fileExtension);\n                if (fileType === 'JPG' || fileType === 'Jpg') {\n                    this.fileType = 'Jpeg';\n                }\n                else {\n                    this.fileType = fileType;\n                }\n            }\n            else {\n                this.fileType = null;\n            }\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            var URL_1 = window.URL;\n            var url = URL_1.createObjectURL(filesData);\n            this.openURL = url;\n            if (parent.isImageLoaded && (this.isImageEdited || parent.pointColl.length > 0 || parent.objColl.length > 0)) {\n                this.isFileChanged = true;\n                if (!isBlazor()) {\n                    this.showDialogPopup();\n                }\n                else {\n                    parent.dotNetRef.invokeMethodAsync('UpdateDialog');\n                }\n            }\n            else {\n                this.checkToolbarTemplate(inputElement, url);\n            }\n        }\n    };\n    Draw.prototype.checkToolbarTemplate = function (inputElement, url) {\n        var parent = this.parent;\n        if (isNullOrUndefined(parent.toolbarTemplate)) {\n            parent.reset();\n            parent.update();\n        }\n        this.fileName = inputElement.value.split('\\\\')[inputElement.value.split('\\\\').length - 1];\n        this.fileName = this.fileName.split('.')[0];\n        this.imageOnLoad(url.toString());\n        inputElement.value = '';\n    };\n    Draw.prototype.moveToSelectionRange = function (type, activeObj) {\n        var parent = this.parent;\n        if (parent.activeObj.shape) {\n            var isRotated = false;\n            for (var i = 0; i < parent.rotateFlipColl.length; i++) {\n                if (parent.rotateFlipColl[i] === 90 || parent.rotateFlipColl[i] === -90) {\n                    isRotated = true;\n                    break;\n                }\n            }\n            if (isRotated) {\n                var zoomFactor = parent.transform.zoomFactor;\n                parent.objColl.push(parent.activeObj);\n                parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                if (type === 'rotateleft' || type === 'rotateright') {\n                    if (parent.transform.degree % 90 === 0 && parent.transform.degree % 180 !== 0) {\n                        if (parent.objColl[parent.objColl.length - 1].activePoint.width < activeObj.activePoint.height) {\n                            for (var i = 2; i < parent.zoomSettings.maxZoomFactor; i++) {\n                                if (parent.objColl[parent.objColl.length - 1].activePoint.width >= activeObj.activePoint.height ||\n                                    this.isSelectionBiggerThanCanvas(parent.objColl[parent.objColl.length - 1]) ||\n                                    this.isSelectionOutsideCanvas(parent.objColl[parent.objColl.length - 1])) {\n                                    if (!isNullOrUndefined(zoomFactor)) {\n                                        parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                                            value: { zoomFactor: -0.1, zoomPoint: null } });\n                                    }\n                                    break;\n                                }\n                                zoomFactor += 0.1;\n                                parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                                    value: { zoomFactor: zoomFactor, zoomPoint: null } });\n                            }\n                        }\n                        else {\n                            for (var i = 2; i < parent.zoomSettings.maxZoomFactor; i++) {\n                                if (parent.objColl[parent.objColl.length - 1].activePoint.width >= activeObj.activePoint.height ||\n                                    this.isSelectionBiggerThanCanvas(parent.objColl[parent.objColl.length - 1]) ||\n                                    this.isSelectionOutsideCanvas(parent.objColl[parent.objColl.length - 1])) {\n                                    if (!isNullOrUndefined(zoomFactor)) {\n                                        parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                                            value: { zoomFactor: 0.1, zoomPoint: null } });\n                                    }\n                                    break;\n                                }\n                                zoomFactor -= .1;\n                                parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                                    value: { zoomFactor: zoomFactor, zoomPoint: null } });\n                            }\n                        }\n                    }\n                    else {\n                        if (parent.objColl[parent.objColl.length - 1].activePoint.height < activeObj.activePoint.width) {\n                            for (var i = 2; i < parent.zoomSettings.maxZoomFactor; i++) {\n                                if (parent.objColl[parent.objColl.length - 1].activePoint.height >= activeObj.activePoint.width ||\n                                    this.isSelectionBiggerThanCanvas(parent.objColl[parent.objColl.length - 1]) ||\n                                    this.isSelectionOutsideCanvas(parent.objColl[parent.objColl.length - 1])) {\n                                    if (!isNullOrUndefined(zoomFactor)) {\n                                        parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                                            value: { zoomFactor: -0.1, zoomPoint: null } });\n                                    }\n                                    break;\n                                }\n                                zoomFactor += 0.1;\n                                parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                                    value: { zoomFactor: zoomFactor, zoomPoint: null } });\n                            }\n                        }\n                        else {\n                            for (var i = 2; i < parent.zoomSettings.maxZoomFactor; i++) {\n                                if (parent.objColl[parent.objColl.length - 1].activePoint.height >= activeObj.activePoint.width ||\n                                    this.isSelectionBiggerThanCanvas(parent.objColl[parent.objColl.length - 1]) ||\n                                    this.isSelectionOutsideCanvas(parent.objColl[parent.objColl.length - 1])) {\n                                    if (!isNullOrUndefined(zoomFactor)) {\n                                        parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                                            value: { zoomFactor: 0.1, zoomPoint: null } });\n                                    }\n                                    break;\n                                }\n                                zoomFactor -= .1;\n                                parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                                    value: { zoomFactor: zoomFactor, zoomPoint: null } });\n                            }\n                        }\n                    }\n                }\n                var panX = (parent.lowerCanvas.clientWidth / 2) - (parent.objColl[parent.objColl.length - 1].activePoint.startX +\n                    (parent.objColl[parent.objColl.length - 1].activePoint.width / 2));\n                var panY = (parent.lowerCanvas.clientHeight / 2) - (parent.objColl[parent.objColl.length - 1].activePoint.startY +\n                    (parent.objColl[parent.objColl.length - 1].activePoint.height / 2));\n                if (parent.transform.degree === 0) {\n                    parent.img.destLeft += panX;\n                    parent.img.destTop += panY;\n                    parent.notify('transform', { prop: 'drawPannImage', value: { point: { x: panX, y: panY } } });\n                }\n                else {\n                    parent.panPoint.currentPannedPoint = { x: panX, y: panY };\n                    parent.notify('transform', { prop: 'drawPannedImage', value: { xDiff: panX, yDiff: panY } });\n                    parent.panPoint.currentPannedPoint = { x: 0, y: 0 };\n                }\n                parent.notify('transform', { prop: 'setTempPanMove', onPropertyChange: false,\n                    value: { point: null } });\n                parent.activeObj = extend({}, parent.objColl[parent.objColl.length - 1]);\n                parent.objColl.pop();\n                parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj } });\n            }\n        }\n    };\n    Draw.prototype.isSelectionBiggerThanCanvas = function (obj) {\n        var isBigger = false;\n        if (obj.activePoint.startX <= this.parent.img.destLeft ||\n            obj.activePoint.startY <= this.parent.img.destTop ||\n            obj.activePoint.endX >= this.parent.img.destLeft + this.parent.img.destWidth ||\n            obj.activePoint.endY >= this.parent.img.destTop + this.parent.img.destHeight) {\n            isBigger = true;\n        }\n        return isBigger;\n    };\n    Draw.prototype.isSelectionOutsideCanvas = function (obj) {\n        var isOutside = false;\n        if ((obj.activePoint.height < this.parent.lowerCanvas.height - this.parent.toolbarHeight) ||\n            (obj.activePoint.width < this.parent.lowerCanvas.width)) {\n            isOutside = true;\n        }\n        return isOutside;\n    };\n    return Draw;\n}());\nexport { Draw };\n","import { extend, isBlazor, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { hideSpinner, showSpinner } from '@syncfusion/ej2-popups';\nvar Export = /** @class */ (function () {\n    function Export(parent) {\n        this.parent = parent;\n        this.addEventListener();\n    }\n    Export.prototype.destroy = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.removeEventListener();\n    };\n    Export.prototype.addEventListener = function () {\n        this.parent.on('export', this.export, this);\n        this.parent.on('destroyed', this.destroy, this);\n    };\n    Export.prototype.removeEventListener = function () {\n        this.parent.off('export', this.export);\n        this.parent.off('destroyed', this.destroy);\n    };\n    Export.prototype.export = function (args) {\n        if (isBlazor()) {\n            var obj = { shape: '' };\n            this.parent.notify('selection', { prop: 'getCurrentDrawingShape', onPropertyChange: false, value: { obj: obj } });\n            if (obj['shape'] !== '') {\n                this.parent.notify('selection', { prop: 'setCurrentDrawingShape', onPropertyChange: false, value: { value: '' } });\n                this.parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            }\n        }\n        else {\n            this.parent.notify('toolbar', { prop: 'refreshShapeDrawing', onPropertyChange: false });\n        }\n        this.updatePvtVar();\n        switch (args.prop) {\n            case 'export':\n                this.exportImg(args.value['type'], args.value['fileName']);\n                break;\n            case 'exportToCanvas':\n                this.exportToCanvas(args.value['object']);\n                break;\n        }\n    };\n    Export.prototype.getModuleName = function () {\n        return 'export';\n    };\n    Export.prototype.updatePvtVar = function () {\n        var parent = this.parent;\n        if (parent.lowerCanvas) {\n            this.lowerContext = parent.lowerCanvas.getContext('2d');\n        }\n    };\n    Export.prototype.exportImg = function (type, fileName) {\n        var _this = this;\n        var parent = this.parent;\n        var obj = { fileName: '' };\n        parent.notify('draw', { prop: 'getFileName', onPropertyChange: false, value: { obj: obj } });\n        var imageName = obj['fileName'];\n        if (!parent.disabled && parent.isImageLoaded) {\n            var dummyObj = { bool: false };\n            parent.notify('selection', { prop: 'getFreehandDrawEditing', onPropertyChange: false, value: { obj: dummyObj } });\n            if (dummyObj['bool']) {\n                parent.notify('freehand-draw', { prop: 'applyFhd', onPropertyChange: false });\n            }\n            if (parent.togglePen) {\n                parent.currObjType.isZoomed = true;\n                parent.notify('shape', { prop: 'apply', onPropertyChange: false, value: { shape: null, obj: null, canvas: null } });\n            }\n            if (parent.textArea.style.display === 'block') {\n                parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                    value: { x: null, y: null, isMouseDown: null } });\n            }\n            parent.notify('shape', { prop: 'applyActObj', onPropertyChange: false, value: { isMouseDown: null } });\n            var obj_1 = { canvasFilter: this.parent.canvasFilter };\n            this.lowerContext.filter = obj_1['canvasFilter'];\n            type = type ? type : 'Png';\n            parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                value: { x: null, y: null, isMouseDown: null } });\n            var beforeSave = { cancel: false, fileName: fileName ? fileName : imageName,\n                fileType: type };\n            if (isBlazor() && parent.events && parent.events.saving.hasDelegate === true) {\n                /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                parent.dotNetRef.invokeMethodAsync('BeforeSaveEventAsync', 'BeforeSave', beforeSave).then(function (beforeSave) {\n                    _this.beforeSaveEvent(beforeSave, type, fileName, imageName);\n                });\n            }\n            else {\n                parent.trigger('beforeSave', beforeSave);\n                this.beforeSaveEvent(beforeSave, type, fileName, imageName);\n            }\n        }\n    };\n    Export.prototype.beforeSaveEvent = function (observableSaveArgs, type, fileName, imageName) {\n        var parent = this.parent;\n        if (!observableSaveArgs.cancel) {\n            parent.currObjType.isSave = true;\n            fileName = observableSaveArgs.fileName ? observableSaveArgs.fileName : fileName;\n            var lowerCaseType = type.toLowerCase();\n            fileName = fileName || imageName;\n            if (lowerCaseType === 'svg') {\n                this.toSVGImg(fileName);\n            }\n            else {\n                this.toBlobFn(fileName, lowerCaseType);\n            }\n            var saved = { fileName: fileName ? fileName : imageName, fileType: type };\n            parent.trigger('saved', saved);\n            if (!isBlazor()) {\n                parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n            }\n            parent.lowerCanvas.style.left = parent.upperCanvas.style.left = '';\n            parent.lowerCanvas.style.top = parent.upperCanvas.style.top = '';\n            parent.lowerCanvas.style.maxWidth = parent.upperCanvas.style.maxWidth = '';\n            parent.lowerCanvas.style.maxHeight = parent.upperCanvas.style.maxHeight = '';\n        }\n    };\n    Export.prototype.toSVGImg = function (fileName) {\n        var parent = this.parent;\n        showSpinner(parent.element);\n        parent.element.style.opacity = '0.5';\n        var tempCanvas = this.exportToCanvas();\n        var dataUrl = tempCanvas.toDataURL();\n        hideSpinner(parent.element);\n        parent.element.style.opacity = '1';\n        var svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n        svg.setAttribute('width', tempCanvas.style.maxWidth);\n        svg.setAttribute('height', tempCanvas.style.maxHeight);\n        var XLinkNS = 'http://www.w3.org/1999/xlink';\n        var img = document.createElementNS('http://www.w3.org/2000/svg', 'image');\n        img.setAttributeNS(null, 'height', tempCanvas.height.toString());\n        img.setAttributeNS(null, 'width', tempCanvas.width.toString());\n        img.setAttributeNS(XLinkNS, 'xlink:href', dataUrl);\n        svg.appendChild(img);\n        var prefix = 'data:image/svg+xml;base64,';\n        var header = '<svg' + ' xmlns=\"http://www.w3.org/2000/svg\"' + ' xmlns:xlink=\"http://www.w3.org/1999/xlink\"'\n            + (\" width=\\\"\" + tempCanvas.width + \"\\\"\") + (\" height=\\\"\" + tempCanvas.height + \"\\\"\") + '>';\n        var footer = '</svg>';\n        var body = svg.innerHTML;\n        var data = header + body + footer;\n        var svgDataUrl = prefix + btoa(data);\n        if (fileName === null) {\n            return svgDataUrl;\n        }\n        else {\n            this.downloadImg(svgDataUrl, fileName + '.' + 'svg');\n            return null;\n        }\n    };\n    Export.prototype.toBlobFn = function (fileName, type) {\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        var proxy = this;\n        var parent = this.parent;\n        showSpinner(parent.element);\n        parent.element.style.opacity = '0.5';\n        var tempCanvas = this.exportToCanvas();\n        // eslint-disable-next-line @typescript-eslint/tslint/config\n        tempCanvas.toBlob(function (blob) {\n            var blobUrl = URL.createObjectURL(blob);\n            proxy.downloadImg(blobUrl, fileName + '.' + type);\n            hideSpinner(parent.element);\n            parent.element.style.opacity = '1';\n        }, 'image/png');\n    };\n    Export.prototype.exportToCanvas = function (object) {\n        var parent = this.parent;\n        var width;\n        var height;\n        if (parent.currSelectionPoint) {\n            width = parent.img.srcWidth;\n            height = parent.img.srcHeight;\n        }\n        else {\n            width = parent.baseImg.width;\n            height = parent.baseImg.height;\n        }\n        var obj = { width: 0, height: 0 };\n        parent.notify('crop', { prop: 'calcRatio', onPropertyChange: false,\n            value: { obj: obj, dimension: { width: width, height: height } } });\n        var ratio = obj;\n        var tempContextFilter = this.lowerContext.filter;\n        // Manipulating blur value\n        if (this.lowerContext.filter !== 'none') {\n            var splitWords = this.lowerContext.filter.split(' ');\n            var value = parseFloat(splitWords[5].split('(')[1]);\n            value *= ((ratio.width + ratio.height) / 2);\n            splitWords[5] = 'blur(' + value + 'px)';\n            this.lowerContext.filter = splitWords.join(' ');\n        }\n        var tempCanvas = parent.createElement('canvas', {\n            id: parent.element.id + '_tempCanvas', attrs: { name: 'canvasImage' }\n        });\n        var tempContext = tempCanvas.getContext('2d');\n        tempCanvas.width = width;\n        tempCanvas.height = height;\n        var dimObj = { width: 0, height: 0 };\n        parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false,\n            value: { width: width, height: height, obj: dimObj } });\n        var maxDimension = dimObj;\n        tempCanvas.style.maxWidth = maxDimension.width + 'px';\n        tempCanvas.style.maxHeight = maxDimension.height + 'px';\n        var temp = this.lowerContext.filter;\n        parent.notify('filter', { prop: 'updateBrightFilter', onPropertyChange: false });\n        tempContext.filter = this.lowerContext.filter;\n        tempContext.drawImage(parent.baseImg, parent.img.srcLeft, parent.img.srcTop, parent.img.srcWidth, parent.img.srcHeight, 0, 0, width, height);\n        this.lowerContext.filter = temp;\n        if (parent.transform.degree !== 0 || parent.transform.currFlipState !== '') {\n            this.updateSaveContext(tempContext);\n            this.exportTransformedImage(tempContext);\n        }\n        if (parent.objColl.length > 0) {\n            var temp_1 = tempContext.filter;\n            tempContext.filter = 'none';\n            var tempObjColl = extend([], parent.objColl, [], true);\n            for (var i = 0, len = parent.objColl.length; i < len; i++) {\n                var activePoint = parent.objColl[i].activePoint;\n                // Subtracting destination left and top points\n                activePoint.startX -= parent.img.destLeft;\n                activePoint.startY -= parent.img.destTop;\n                activePoint.endX -= parent.img.destLeft;\n                activePoint.endY -= parent.img.destTop;\n                activePoint.width = activePoint.endX - activePoint.startX;\n                activePoint.height = activePoint.endY - activePoint.startY;\n                // Manipulating points\n                activePoint.startX *= ratio.width;\n                activePoint.startY *= ratio.height;\n                activePoint.endX *= ratio.width;\n                activePoint.endY *= ratio.height;\n                activePoint.width = activePoint.endX - activePoint.startX;\n                activePoint.height = activePoint.endY - activePoint.startY;\n                parent.objColl[i].strokeSettings.strokeWidth *= ((ratio.width + ratio.height) / 2);\n                if (parent.objColl[i].shape === 'text') {\n                    parent.objColl[i].textSettings.fontSize *= ((ratio.width + ratio.height) / 2);\n                }\n                else if (parent.objColl[i].shape === 'path') {\n                    for (var l = 0; l < parent.objColl[i].pointColl.length; l++) {\n                        parent.objColl[i].pointColl[l].x =\n                            (parent.objColl[i].pointColl[l].x - parent.img.destLeft) * ratio.width;\n                        parent.objColl[i].pointColl[l].y =\n                            (parent.objColl[i].pointColl[l].y - parent.img.destTop) * ratio.height;\n                    }\n                }\n                parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'saveContext', obj: parent.objColl[i], isCropRatio: null,\n                        points: null, isPreventDrag: true, saveContext: tempContext, isPreventSelection: null } });\n            }\n            tempContext.filter = temp_1;\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            parent.objColl = tempObjColl;\n        }\n        if (parent.freehandCounter > 0) {\n            // eslint-disable-next-line\n            var tempPointColl = extend({}, parent.pointColl, {}, true);\n            for (var n = 0; n < parent.freehandCounter; n++) {\n                parent.points = extend([], parent.pointColl[n].points, []);\n                parent.notify('freehand-draw', { prop: 'setPointCounter', onPropertyChange: false, value: { value: 0 } });\n                var len = parent.points.length;\n                parent.pointColl[n].strokeWidth *= ((ratio.width + ratio.height) / 2);\n                for (var l = 0; l < len; l++) {\n                    parent.points[l].x = (parent.points[l].x - parent.img.destLeft) * ratio.width;\n                    parent.points[l].y = (parent.points[l].y - parent.img.destTop) * ratio.height;\n                }\n            }\n            parent.notify('freehand-draw', { prop: 'freehandRedraw', onPropertyChange: false,\n                value: { context: tempContext, points: null } });\n            parent.pointColl = tempPointColl;\n        }\n        if (parent.isCircleCrop) {\n            parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                value: { context: tempContext, isSave: true, isFlip: null } });\n        }\n        this.lowerContext.filter = tempContextFilter;\n        parent.canvasFilter = tempContextFilter;\n        if (object) {\n            object['canvas'] = tempCanvas;\n        }\n        return tempCanvas;\n    };\n    Export.prototype.downloadImg = function (blob, fileName) {\n        var a = document.createElement('a');\n        a.href = blob;\n        a.target = '_parent';\n        a.download = fileName;\n        (document.body || document.documentElement).appendChild(a);\n        a.click();\n        a.parentNode.removeChild(a);\n    };\n    Export.prototype.exportTransformedImage = function (tempContext) {\n        var parent = this.parent;\n        var degree = parent.transform.degree;\n        for (var i = 0, len = parent.rotateFlipColl.length; i < len; i++) {\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            var flip = parent.rotateFlipColl[i];\n            if (typeof flip === 'number') {\n                this.exportRotate(tempContext, flip);\n            }\n            else if (flip === 'horizontal') {\n                this.exportFlip(tempContext, true, false);\n            }\n            else if (flip === 'vertical') {\n                this.exportFlip(tempContext, false, true);\n            }\n        }\n        parent.transform.degree = degree;\n    };\n    Export.prototype.exportRotate = function (tempContext, degree) {\n        var parent = this.parent;\n        this.setMaxDim(parent.transform.degree, tempContext.canvas);\n        tempContext.translate(tempContext.canvas.width / 2, tempContext.canvas.height / 2);\n        tempContext.rotate(Math.PI / 180 * degree);\n        tempContext.drawImage(parent.inMemoryCanvas, -tempContext.canvas.height / 2, -tempContext.canvas.width / 2, tempContext.canvas.height, tempContext.canvas.width);\n        this.updateSaveContext(tempContext);\n    };\n    Export.prototype.exportFlip = function (tempContext, flipHorizontal, flipVertical) {\n        if (flipHorizontal) {\n            tempContext.translate(tempContext.canvas.width, 0);\n            tempContext.scale(-1, 1);\n        }\n        if (flipVertical) {\n            tempContext.translate(0, tempContext.canvas.height);\n            tempContext.scale(1, -1);\n        }\n        tempContext.drawImage(this.parent.inMemoryCanvas, 0, 0);\n        this.updateSaveContext(tempContext);\n    };\n    Export.prototype.updateSaveContext = function (tempContext) {\n        var inMemoryContext = this.parent.inMemoryCanvas.getContext('2d');\n        tempContext.setTransform(1, 0, 0, 1, 0, 0);\n        var imageData = tempContext.getImageData(0, 0, tempContext.canvas.width, tempContext.canvas.height);\n        this.parent.inMemoryCanvas.width = imageData.width;\n        this.parent.inMemoryCanvas.height = imageData.height;\n        inMemoryContext.putImageData(imageData, 0, 0);\n    };\n    Export.prototype.setMaxDim = function (degree, tempCanvas) {\n        var newWidth;\n        var newHeight;\n        if (degree % 90 === 0 && degree % 180 !== 0) {\n            newWidth = isNullOrUndefined(this.parent.currSelectionPoint) ? this.parent.baseImg.height : this.parent.img.srcHeight;\n            newHeight = isNullOrUndefined(this.parent.currSelectionPoint) ? this.parent.baseImg.width : this.parent.img.srcWidth;\n        }\n        else if (degree % 180 === 0 || degree === 0) {\n            newWidth = isNullOrUndefined(this.parent.currSelectionPoint) ? this.parent.baseImg.width : this.parent.img.srcWidth;\n            newHeight = isNullOrUndefined(this.parent.currSelectionPoint) ? this.parent.baseImg.height : this.parent.img.srcHeight;\n        }\n        tempCanvas.width = newWidth;\n        tempCanvas.height = newHeight;\n        var obj = { width: 0, height: 0 };\n        this.parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false,\n            value: { width: newWidth, height: newHeight, obj: obj } });\n        var maxDimension = obj;\n        tempCanvas.style.maxWidth = maxDimension.width + 'px';\n        tempCanvas.style.maxHeight = maxDimension.height + 'px';\n    };\n    return Export;\n}());\nexport { Export };\n","import { isNullOrUndefined, extend } from '@syncfusion/ej2-base';\nvar Filter = /** @class */ (function () {\n    function Filter(parent) {\n        this.adjustmentLevel = { brightness: 0, contrast: 0, hue: 0, opacity: 100, saturation: 0, blur: 0,\n            exposure: 0, sharpen: false, bw: false }; // for toolbar slider value\n        this.tempAdjustmentLevel = { brightness: 0, contrast: 0, hue: 0, opacity: 100, saturation: 0, blur: 0,\n            exposure: 0, sharpen: false, bw: false }; // for temp toolbar slider value\n        this.adjustmentValue = ''; // for internal slider value\n        this.isBrightnessAdjusted = false;\n        this.appliedFilter = '';\n        this.parent = parent;\n        this.addEventListener();\n    }\n    Filter.prototype.destroy = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.removeEventListener();\n    };\n    Filter.prototype.addEventListener = function () {\n        this.parent.on('filter', this.filter, this);\n        this.parent.on('destroyed', this.destroy, this);\n    };\n    Filter.prototype.removeEventListener = function () {\n        this.parent.off('filter', this.filter);\n        this.parent.off('destroyed', this.destroy);\n    };\n    Filter.prototype.filter = function (args) {\n        this.updatePrivateVariables();\n        switch (args.prop) {\n            case 'finetuneImage':\n                this.finetuneImage(args.value['option'], args.value['value']);\n                break;\n            case 'applyImageFilter':\n                this.setFilter(args.value['option']);\n                break;\n            case 'update-finetunes':\n                this.updateFinetunes();\n                break;\n            case 'updateBrightFilter':\n                this.updateBrightFilter();\n                break;\n            case 'set-adjustment':\n                this.setAdjustment(args.value['operation']);\n                break;\n            case 'update-filter':\n                this.updateFilter(args.value['operation'], args.value['filter']);\n                break;\n            case 'initFilter':\n                this.initFilter();\n                break;\n            case 'setCurrAdjValue':\n                this.setCurrAdjValue(args.value['type'], args.value['value']);\n                break;\n            case 'updateAdj':\n                this.updateAdj(args.value['type'], args.value['value'], args.value['isPreview'], args.value['ctx']);\n                break;\n            case 'getCurrentObj':\n                this.getCurrentObj(args.value['object']);\n                break;\n            case 'getAdjustmentLevel':\n                args.value['obj']['adjustmentLevel'] = this.adjustmentLevel;\n                break;\n            case 'setAdjustmentLevel':\n                this.adjustmentLevel = args.value['adjustmentLevel'];\n                break;\n            case 'getTempAdjustmentLevel':\n                args.value['obj']['tempAdjustmentLevel'] = this.tempAdjustmentLevel;\n                break;\n            case 'setTempAdjustmentLevel':\n                this.tempAdjustmentLevel = args.value['tempAdjustmentLevel'];\n                break;\n            case 'setAdjustmentValue':\n                this.adjustmentValue = args.value['adjustmentValue'];\n                break;\n            case 'getBrightnessAdjusted':\n                args.value['obj']['isBrightnessAdjusted'] = this.isBrightnessAdjusted;\n                break;\n            case 'setBrightnessAdjusted':\n                this.isBrightnessAdjusted = args.value['isBrightnessAdjusted'];\n                if (this.parent.currentFilter.split('_') && this.parent.currentFilter.split('_')[1] === 'cold') {\n                    this.isBrightnessAdjusted = false;\n                }\n                break;\n            case 'reset':\n                this.reset();\n                break;\n        }\n    };\n    Filter.prototype.updatePrivateVariables = function () {\n        var parent = this.parent;\n        if (parent.lowerCanvas) {\n            this.lowerContext = parent.lowerCanvas.getContext('2d');\n        }\n    };\n    Filter.prototype.getModuleName = function () {\n        return 'filter';\n    };\n    Filter.prototype.updateBrightFilter = function () {\n        var splitWords = this.lowerContext.filter.split(' ');\n        if (this.isBrightnessAdjusted && splitWords.length > 0 && !isNullOrUndefined(splitWords[4])) {\n            var opacityValue = parseFloat(splitWords[4].split('(')[1]);\n            splitWords[4] = 'opacity(' + (opacityValue - 0.3) + ')';\n            this.lowerContext.filter = splitWords.join(' ');\n        }\n    };\n    Filter.prototype.reset = function () {\n        this.adjustmentLevel = { brightness: 0, contrast: 0, hue: 0, opacity: 100, saturation: 0,\n            blur: 0, exposure: 0, sharpen: false, bw: false };\n        this.tempAdjustmentLevel = { brightness: 0, contrast: 0, hue: 0, opacity: 100, saturation: 0,\n            blur: 0, exposure: 0, sharpen: false, bw: false };\n        this.adjustmentValue = this.parent.getDefaultFilter();\n        this.isBrightnessAdjusted = false;\n        this.appliedFilter = '';\n    };\n    Filter.prototype.updateFinetunes = function () {\n        var parent = this.parent;\n        var fs = parent.finetuneSettings;\n        if (fs) {\n            if (fs.brightness) {\n                this.adjustmentLevel.brightness = fs.brightness.defaultValue;\n                this.tempAdjustmentLevel.brightness = fs.brightness.defaultValue;\n            }\n            if (fs.contrast) {\n                this.adjustmentLevel.contrast = fs.contrast.defaultValue;\n                this.tempAdjustmentLevel.contrast = fs.contrast.defaultValue;\n            }\n            if (fs.hue) {\n                this.adjustmentLevel.hue = fs.hue.defaultValue;\n                this.tempAdjustmentLevel.hue = fs.hue.defaultValue;\n            }\n            if (fs.saturation) {\n                this.adjustmentLevel.saturation = fs.saturation.defaultValue;\n                this.tempAdjustmentLevel.saturation = fs.saturation.defaultValue;\n            }\n            if (fs.exposure) {\n                this.adjustmentLevel.exposure = fs.exposure.defaultValue;\n                this.tempAdjustmentLevel.exposure = fs.exposure.defaultValue;\n            }\n            if (fs.opacity) {\n                this.adjustmentLevel.opacity = fs.opacity.defaultValue;\n                this.tempAdjustmentLevel.opacity = fs.opacity.defaultValue;\n            }\n            if (fs.blur) {\n                this.adjustmentLevel.blur = fs.blur.defaultValue;\n                this.tempAdjustmentLevel.blur = fs.blur.defaultValue;\n            }\n            parent.notify('draw', { prop: 'isInitialLoading', onPropertyChange: false, value: { isInitialLoading: true } });\n        }\n    };\n    Filter.prototype.initFilter = function () {\n        this.setFilterAdj('brightness', this.adjustmentLevel.brightness);\n        this.setFilterAdj('contrast', this.adjustmentLevel.contrast);\n        this.setFilterAdj('hue', this.adjustmentLevel.hue);\n        this.setFilterAdj('saturation', this.adjustmentLevel.saturation);\n        this.setFilterAdj('exposure', this.adjustmentLevel.exposure);\n        this.setFilterAdj('opacity', this.adjustmentLevel.opacity);\n        this.setFilterAdj('blur', this.adjustmentLevel.blur);\n    };\n    Filter.prototype.updateAdj = function (type, value, isPreview, ctx) {\n        var parent = this.parent;\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        var splitWords = this.lowerContext.filter.split(' ');\n        var values = [];\n        var opacityValue;\n        var brightnessValue;\n        if (splitWords[4]) {\n            opacityValue = parseFloat(splitWords[4].split('(')[1]);\n        }\n        if (splitWords[0]) {\n            brightnessValue = parseFloat(splitWords[0].split('(')[1]);\n        }\n        var brightness = this.getFilterValue(this.adjustmentLevel.brightness);\n        var saturation = this.getFilterValue(this.adjustmentLevel.saturation);\n        var excludedTypes = ['brightness', 'contrast', 'hue', 'saturation', 'exposure', 'opacity', 'blur'];\n        if (excludedTypes.indexOf(type) === -1) {\n            if (isNullOrUndefined(isPreview) && (this.adjustmentLevel.sharpen || this.adjustmentLevel.bw)) {\n                parent.isUndoRedo = true;\n                var temp = this.lowerContext.filter;\n                this.lowerContext.filter = 'none';\n                parent.notify('shape', { prop: 'iterateObjColl', onPropertyChange: false });\n                parent.notify('freehand-draw', { prop: 'freehandRedraw', onPropertyChange: false,\n                    value: { context: this.lowerContext, points: null } });\n                this.lowerContext.filter = temp;\n                parent.isUndoRedo = false;\n            }\n        }\n        if (brightness !== 1) {\n            splitWords[4] = 'opacity(' + (opacityValue - 0.3) + ')';\n        }\n        var saturate;\n        var bright;\n        var saturatePercent;\n        var contrast;\n        var saturatePercentage;\n        switch (type) {\n            case 'brightness':\n                if (parseFloat(splitWords[3].split('(')[1]) !== 100) {\n                    value += 0.1;\n                }\n                splitWords[0] = 'brightness(' + value + ')';\n                this.adjustmentValue = splitWords.join(' ');\n                break;\n            case 'contrast':\n                splitWords[1] = 'contrast(' + value + '%)';\n                this.adjustmentValue = splitWords.join(' ');\n                break;\n            case 'hue':\n                splitWords[2] = 'hue-rotate(' + value + 'deg)';\n                this.adjustmentValue = splitWords.join(' ');\n                break;\n            case 'saturation':\n                splitWords[3] = 'saturate(' + value + '%)';\n                if (saturation !== 1) {\n                    splitWords[0] = 'brightness(' + (brightnessValue + 0.09) + ')';\n                }\n                this.adjustmentValue = splitWords.join(' ');\n                break;\n            case 'opacity':\n                if (parseFloat(splitWords[0].split('(')[1]) !== 1) {\n                    value -= 0.2;\n                }\n                splitWords[4] = 'opacity(' + value + ')';\n                this.adjustmentValue = splitWords.join(' ');\n                break;\n            case 'blur':\n                splitWords[5] = 'blur(' + value + 'px)';\n                this.adjustmentValue = splitWords.join(' ');\n                break;\n            case 'exposure':\n                if (brightness !== 1) {\n                    splitWords[4] = 'opacity(' + (opacityValue - 0.3) + ')';\n                }\n                if (value > 1) {\n                    value -= 1;\n                    value += brightness;\n                }\n                else if (value < 1) {\n                    value = 1 - value;\n                    value = brightness - value;\n                }\n                splitWords[0] = 'brightness(' + value + ')';\n                this.adjustmentValue = splitWords.join(' ');\n                break;\n            case 'chrome':\n                saturate = this.getSaturationFilterValue(this.adjustmentLevel.saturation);\n                saturate *= 100;\n                value = saturate + (saturate * 0.4);\n                splitWords[3] = 'saturate(' + value + '%)';\n                values = this.adjustmentValue.split(' ');\n                splitWords[0] = values[0];\n                splitWords[1] = values[1];\n                splitWords[2] = values[2];\n                splitWords[4] = values[4];\n                splitWords[5] = values[5];\n                splitWords[6] = 'sepia(0%)';\n                splitWords[7] = 'grayscale(0%)';\n                splitWords[8] = 'invert(0%)';\n                break;\n            case 'cold':\n                // Adjusting Brightness\n                bright = this.getFilterValue(this.adjustmentLevel.brightness);\n                bright *= 100;\n                value = bright * 0.9;\n                value *= 0.01;\n                splitWords[0] = 'brightness(' + value + ')';\n                // Adjusting Contrast\n                contrast = this.getFilterValue(this.adjustmentLevel.contrast);\n                contrast *= 100;\n                value = contrast + (contrast * 0.5);\n                splitWords[1] = 'contrast(' + value + '%)';\n                // Adjusting Saturation\n                saturatePercentage = this.getSaturationFilterValue(this.adjustmentLevel.saturation);\n                saturatePercentage *= 100;\n                value = saturatePercentage;\n                splitWords[3] = 'saturate(' + value + '%)';\n                values = this.adjustmentValue.split(' ');\n                splitWords[2] = values[2];\n                splitWords[4] = values[4];\n                splitWords[5] = values[5];\n                splitWords[6] = 'sepia(0%)';\n                splitWords[7] = 'grayscale(0%)';\n                splitWords[8] = 'invert(0%)';\n                break;\n            case 'warm':\n                saturatePercent = this.getSaturationFilterValue(this.adjustmentLevel.saturation);\n                saturatePercent *= 100;\n                value = saturatePercent + (saturatePercent * 0.4);\n                splitWords[3] = 'saturate(' + value + '%)';\n                splitWords[6] = 'sepia(25%)';\n                values = this.adjustmentValue.split(' ');\n                splitWords[0] = values[0];\n                splitWords[1] = values[1];\n                splitWords[2] = values[2];\n                splitWords[4] = values[4];\n                splitWords[5] = values[5];\n                splitWords[7] = 'grayscale(0%)';\n                splitWords[8] = 'invert(0%)';\n                break;\n            case 'grayscale':\n                splitWords[7] = 'grayscale(100%)';\n                values = this.adjustmentValue.split(' ');\n                splitWords[0] = values[0];\n                splitWords[1] = values[1];\n                splitWords[2] = values[2];\n                splitWords[3] = values[3];\n                splitWords[4] = values[4];\n                splitWords[5] = values[5];\n                splitWords[6] = 'sepia(0%)';\n                splitWords[8] = 'invert(0%)';\n                break;\n            case 'sepia':\n                splitWords[6] = 'sepia(100%)';\n                values = this.adjustmentValue.split(' ');\n                splitWords[0] = values[0];\n                splitWords[1] = values[1];\n                splitWords[2] = values[2];\n                splitWords[3] = values[3];\n                splitWords[4] = values[4];\n                splitWords[5] = values[5];\n                splitWords[7] = 'grayscale(0%)';\n                splitWords[8] = 'invert(0%)';\n                break;\n            case 'invert':\n                splitWords[8] = 'invert(100%)';\n                values = this.adjustmentValue.split(' ');\n                splitWords[0] = values[0];\n                splitWords[1] = values[1];\n                splitWords[2] = values[2];\n                splitWords[3] = values[3];\n                splitWords[4] = values[4];\n                splitWords[5] = values[5];\n                splitWords[6] = 'sepia(0%)';\n                splitWords[7] = 'grayscale(0%)';\n                break;\n        }\n        if (type !== 'sharpen' && type !== 'blackandwhite') {\n            if (isNullOrUndefined(isPreview)) {\n                if (type === 'default') {\n                    splitWords = this.getDefaultCurrentFilter(splitWords);\n                }\n                this.lowerContext.filter = splitWords.join(' ');\n            }\n            splitWords = this.setTempFilterValue(brightness, isPreview, splitWords, type);\n            parent.notify('draw', { prop: 'setRotateZoom', onPropertyChange: false, value: { isRotateZoom: true } });\n            parent.notify('draw', { prop: 'updateCurrTransState', onPropertyChange: false,\n                value: { type: 'initial', isPreventDestination: null, isRotatePan: null } });\n            this.appliedFilter = this.lowerContext.filter;\n            this.lowerContext.drawImage(parent.baseImg, parent.img.srcLeft, parent.img.srcTop, parent.img.srcWidth, parent.img.srcHeight, parent.img.destLeft, parent.img.destTop, parent.img.destWidth, parent.img.destHeight);\n            parent.notify('draw', { prop: 'updateCurrTransState', onPropertyChange: false,\n                value: { type: 'reverse', isPreventDestination: null, isRotatePan: null } });\n            parent.notify('draw', { prop: 'setRotateZoom', onPropertyChange: false, value: { isRotateZoom: false } });\n            if (brightness !== 1) {\n                splitWords[4] = 'opacity(' + opacityValue + ')';\n            }\n            else if (saturation !== 1) {\n                splitWords[0] = 'brightness(' + brightnessValue + ')';\n            }\n            if ((type === 'exposure' && brightness !== 1) || (type === 'saturation' && saturation !== 1)) {\n                splitWords[0] = 'brightness(' + brightnessValue + ')';\n            }\n            splitWords = this.setTempFilterValue(brightness, isPreview, splitWords, type);\n            if (isNullOrUndefined(isPreview)) {\n                this.lowerContext.filter = splitWords.join(' ');\n            }\n            parent.initialAdjustmentValue = splitWords.join(' ');\n            var tempFilter = this.lowerContext.filter;\n            this.lowerContext.filter = 'brightness(' + 1 + ') ' + 'contrast(' + 100 + '%) ' + 'hue-rotate(' + 0 + 'deg) ' +\n                'saturate(' + 100 + '%) ' + 'opacity(' + 1 + ') ' + 'blur(' + 0 + 'px) ' + 'sepia(0%) ' + 'grayscale(0%) ' + 'invert(0%)';\n            parent.notify('shape', { prop: 'iterateObjColl', onPropertyChange: false });\n            parent.notify('freehand-draw', { prop: 'freehandRedraw', onPropertyChange: false,\n                value: { context: this.lowerContext, points: null } });\n            this.lowerContext.filter = tempFilter;\n            parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n            if ((parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle') || parent.isCircleCrop) {\n                parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                    value: { context: this.lowerContext, isSave: null, isFlip: null } });\n            }\n            this.isBrightnessAdjusted = brightness !== 1;\n        }\n        var filter = splitWords.join(' ');\n        if (ctx) {\n            ctx.filter = filter;\n        }\n    };\n    Filter.prototype.setTempFilterValue = function (brightness, isPreview, splitWords, type) {\n        if (isPreview) {\n            if (type === 'default') {\n                splitWords = this.getDefaultCurrentFilter(splitWords);\n            }\n            else if (brightness !== 1) {\n                var tempSplitWords = this.lowerContext.filter.split(' ');\n                tempSplitWords[4] = splitWords[4];\n                this.lowerContext.filter = tempSplitWords.join(' ');\n            }\n        }\n        return splitWords;\n    };\n    Filter.prototype.getDefaultCurrentFilter = function (splitWords) {\n        var values = this.adjustmentValue.split(' ');\n        splitWords = [\n            values[0],\n            values[1],\n            values[2],\n            values[3],\n            values[4],\n            values[5],\n            'sepia(0%)',\n            'grayscale(0%)',\n            'invert(0%)'\n        ];\n        return splitWords;\n    };\n    Filter.prototype.getFilterValue = function (value) {\n        return (value === 0) ? 1 : 1 + ((value * 0.5) / 100);\n    };\n    Filter.prototype.getSaturationFilterValue = function (value) {\n        return value === 0 ? 1 : 1 + (value / 100);\n    };\n    Filter.prototype.setFilterAdj = function (type, value) {\n        var parent = this.parent;\n        parent.notify('freehand-draw', { prop: 'apply-pen-draw', onPropertyChange: false });\n        this.adjustmentLevel[\"\" + type] = value;\n        switch (type) {\n            case 'brightness':\n            case 'contrast':\n            case 'exposure':\n                value = this.getFilterValue(value);\n                if (type === 'contrast') {\n                    value *= 100;\n                }\n                break;\n            case 'hue':\n                value *= 3;\n                break;\n            case 'saturation':\n                value = this.getSaturationFilterValue(value) * 100;\n                break;\n            case 'opacity':\n                if (value >= 50) {\n                    value /= 100;\n                }\n                else if (value === 40) {\n                    value = 0.45;\n                }\n                else if (value === 30) {\n                    value = 0.40;\n                }\n                else if (value === 20) {\n                    value = 0.35;\n                }\n                else if (value === 10) {\n                    value = 0.30;\n                }\n                else if (value === 0) {\n                    value = 0.25;\n                }\n                break;\n            case 'blur':\n                if (value !== 0) {\n                    value /= 20;\n                    // Since 0.5 is not working in blur we consider from 1\n                    value += 0.5;\n                }\n                break;\n        }\n        var prevCropObj = extend({}, parent.cropObj, {}, true);\n        var prevObj = this.getCurrentObj();\n        prevObj.objColl = extend([], parent.objColl, [], true);\n        prevObj.pointColl = extend([], parent.pointColl, [], true);\n        prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false, value: { obj: selPointCollObj } });\n        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        this.updateAdj(type, value);\n        parent.notify('undo-redo', {\n            prop: 'updateUndoRedoColl',\n            onPropertyChange: false,\n            value: {\n                operation: type,\n                previousObj: prevObj,\n                previousObjColl: prevObj.objColl,\n                previousPointColl: prevObj.pointColl,\n                previousSelPointColl: prevObj.selPointColl,\n                previousCropObj: prevCropObj,\n                previousText: null,\n                currentText: null,\n                previousFilter: null,\n                isCircleCrop: null\n            }\n        });\n    };\n    Filter.prototype.setFilter = function (type) {\n        var parent = this.parent;\n        type = type.toLowerCase();\n        parent.notify('freehand-draw', { prop: 'apply-pen-draw', onPropertyChange: false });\n        var obj = { currentFilter: this.parent.currentFilter };\n        var prevFilter = obj['currentFilter'];\n        var prevCropObj = extend({}, parent.cropObj, {}, true);\n        var prevObj = this.getCurrentObj();\n        prevObj.objColl = extend([], parent.objColl, [], true);\n        prevObj.pointColl = extend([], parent.pointColl, [], true);\n        prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        this.updateAdj(type, null);\n        parent.notify('draw', { prop: 'setImageEdited', onPropertyChange: false });\n        parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n            value: { operation: type, previousObj: prevObj, previousObjColl: prevObj.objColl,\n                previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                previousCropObj: prevCropObj, previousText: null,\n                currentText: null, previousFilter: prevFilter, isCircleCrop: null } });\n    };\n    Filter.prototype.setAdjustment = function (type) {\n        var splitWords = this.lowerContext.filter.split(' ');\n        var value;\n        var valueArr;\n        switch (type) {\n            case 'brightness':\n                valueArr = splitWords[0].split('(');\n                value = parseFloat(valueArr[1].split(')')[0]);\n                this.adjustmentLevel.brightness = this.setFilterValue(value);\n                break;\n            case 'contrast':\n                valueArr = splitWords[1].split('(');\n                value = parseFloat(valueArr[1].split(')')[0]);\n                value /= 100;\n                this.adjustmentLevel.contrast = this.setFilterValue(value);\n                break;\n            case 'hue':\n                valueArr = splitWords[2].split('(');\n                value = parseFloat(valueArr[1].split(')')[0]);\n                value /= 3;\n                this.adjustmentLevel.hue = value;\n                break;\n            case 'saturation':\n                valueArr = splitWords[3].split('(');\n                value = parseFloat(valueArr[1].split(')')[0]);\n                value /= 100;\n                this.adjustmentLevel.saturation = this.setSaturationFilterValue(value);\n                break;\n            case 'opacity':\n                valueArr = splitWords[4].split('(');\n                value = parseFloat(valueArr[1].split(')')[0]);\n                if (value === 0.45) {\n                    value = 40;\n                }\n                else if (value === 0.40) {\n                    value = 30;\n                }\n                else if (value === 0.35) {\n                    value = 20;\n                }\n                else if (value === 0.30) {\n                    value = 10;\n                }\n                else if (value === 0.25) {\n                    value = 0;\n                }\n                else {\n                    value *= 100;\n                }\n                this.adjustmentLevel.opacity = value;\n                break;\n            case 'blur':\n                valueArr = splitWords[5].split('(');\n                value = parseFloat(valueArr[1].split(')')[0]);\n                value *= 20;\n                this.adjustmentLevel.blur = value;\n                break;\n            case 'exposure':\n                valueArr = splitWords[0].split('(');\n                value = parseFloat(valueArr[1].split(')')[0]);\n                this.adjustmentLevel.exposure = this.setFilterValue(value);\n                break;\n        }\n    };\n    Filter.prototype.setFilterValue = function (value) {\n        return Math.round((value === 1) ? 0 : ((value - 1) * 100) / 0.5);\n    };\n    Filter.prototype.setSaturationFilterValue = function (value) {\n        return Math.round((value === 1) ? 0 : (value - 1) * 100);\n    };\n    Filter.prototype.updateFilter = function (type, previousFilter) {\n        var parent = this.parent;\n        var validTypes = ['default', 'chrome', 'cold', 'warm', 'grayscale', 'blackandwhite', 'sepia', 'invert', 'sharpen'];\n        if (validTypes.indexOf(type) !== -1) {\n            var selEle = parent.element.querySelector('.e-contextual-toolbar-wrapper .e-toolbar-item.e-selected');\n            if (selEle) {\n                selEle.classList.remove('e-selected');\n            }\n            var filterCanvas = document.getElementById(parent.element.id + '_' + type + 'Canvas');\n            if (filterCanvas) {\n                filterCanvas.parentElement.classList.add('e-selected');\n            }\n            this.parent.currentFilter = previousFilter ? previousFilter : parent.element.id + '_' + type;\n        }\n    };\n    Filter.prototype.finetuneImage = function (finetuneOption, value) {\n        var parent = this.parent;\n        if (!parent.disabled && parent.isImageLoaded) {\n            switch (finetuneOption.toLowerCase()) {\n                case 'brightness':\n                    this.setFilterAdj('brightness', value);\n                    break;\n                case 'contrast':\n                    this.setFilterAdj('contrast', value);\n                    break;\n                case 'hue':\n                    this.setFilterAdj('hue', value);\n                    break;\n                case 'saturation':\n                    this.setFilterAdj('saturation', value);\n                    break;\n                case 'opacity':\n                    this.setFilterAdj('opacity', value);\n                    break;\n                case 'blur':\n                    this.setFilterAdj('blur', value);\n                    break;\n                case 'exposure':\n                    this.setFilterAdj('exposure', value);\n                    break;\n            }\n            this.parent.canvasFilter = this.lowerContext.filter;\n            parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n        }\n    };\n    Filter.prototype.setCurrAdjValue = function (type, value) {\n        this.parent.notify('draw', { prop: 'setImageEdited', onPropertyChange: false });\n        switch (type) {\n            case 'brightness':\n                this.setFilterAdj('brightness', value);\n                break;\n            case 'contrast':\n                this.setFilterAdj('contrast', value);\n                break;\n            case 'hue':\n                this.setFilterAdj('hue', value);\n                break;\n            case 'saturation':\n                this.setFilterAdj('saturation', value);\n                break;\n            case 'opacity':\n                this.setFilterAdj('opacity', value);\n                break;\n            case 'blur':\n                this.setFilterAdj('blur', value);\n                break;\n            case 'exposure':\n                this.setFilterAdj('exposure', value);\n                break;\n        }\n    };\n    Filter.prototype.getCurrentObj = function (dummyObj) {\n        var parent = this.parent;\n        var tempFlipPanPointObj = { point: null };\n        parent.notify('crop', { prop: 'getTempFlipPanPoint', value: { obj: tempFlipPanPointObj } });\n        var zoomObj = { previousZoomValue: null };\n        parent.notify('transform', { prop: 'getPreviousZoomValue', value: { obj: zoomObj } });\n        var obj = { cropZoom: 0, defaultZoom: 0, totalPannedPoint: { x: 0, y: 0 }, totalPannedClientPoint: { x: 0, y: 0 },\n            totalPannedInternalPoint: { x: 0, y: 0 }, tempFlipPanPoint: { x: 0, y: 0 }, activeObj: {},\n            rotateFlipColl: [], degree: 0, currFlipState: '', zoomFactor: 0, previousZoomValue: 0,\n            destPoints: { startX: 0, startY: 0, width: 0, height: 0 },\n            srcPoints: { startX: 0, startY: 0, width: 0, height: 0 }, filter: '', isBrightAdjust: this.isBrightnessAdjusted };\n        obj.cropZoom = parent.transform.cropZoomFactor;\n        obj.defaultZoom = parent.transform.defaultZoomFactor;\n        obj.zoomFactor = parent.zoomSettings.zoomFactor;\n        obj.previousZoomValue = zoomObj['previousZoomValue'];\n        obj.totalPannedPoint = extend({}, parent.panPoint.totalPannedPoint, {}, true);\n        obj.totalPannedClientPoint = extend({}, parent.panPoint.totalPannedClientPoint, {}, true);\n        obj.totalPannedInternalPoint = extend({}, parent.panPoint.totalPannedInternalPoint, {}, true);\n        obj.tempFlipPanPoint = extend({}, tempFlipPanPointObj['point'], {}, true);\n        obj.activeObj = extend({}, parent.activeObj, {}, true);\n        obj.rotateFlipColl = extend([], parent.rotateFlipColl, [], true);\n        obj.degree = parent.transform.degree;\n        obj.currFlipState = parent.transform.currFlipState;\n        obj.destPoints = { startX: parent.img.destLeft, startY: parent.img.destTop, endX: 0, endY: 0,\n            width: parent.img.destWidth, height: parent.img.destHeight };\n        obj.srcPoints = { startX: parent.img.srcLeft, startY: parent.img.srcTop, endX: 0, endY: 0,\n            width: parent.img.srcWidth, height: parent.img.srcHeight };\n        obj.filter = this.lowerContext.filter;\n        if (dummyObj) {\n            dummyObj['currObj'] = obj;\n        }\n        return obj;\n    };\n    return Filter;\n}());\nexport { Filter };\n","import { EventHandler, extend, isBlazor, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { ShapeType } from '../index';\nvar FreehandDrawing = /** @class */ (function () {\n    function FreehandDrawing(parent) {\n        this.fhdObj = { lastWidth: 0, lastVelocity: 0, time: 0, pointX: 0, pointY: 0 };\n        this.isFreehandDrawing = false;\n        this.freehandDownPoint = { x: 0, y: 0 };\n        this.isFreehandPointMoved = false;\n        this.pointCounter = 0;\n        // eslint-disable-next-line\n        this.selPointColl = {};\n        this.currFHDIdx = 0; // Specifies id for every freehand drawing - uses while deleting\n        this.selPoints = [];\n        this.dummyPoints = [];\n        this.tempFHDStyles = { strokeColor: null, fillColor: null, strokeWidth: null };\n        this.parent = parent;\n        this.addEventListener();\n    }\n    FreehandDrawing.prototype.destroy = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.removeEventListener();\n    };\n    FreehandDrawing.prototype.addEventListener = function () {\n        this.parent.on('freehand-draw', this.draw, this);\n        this.parent.on('destroyed', this.destroy, this);\n    };\n    FreehandDrawing.prototype.removeEventListener = function () {\n        this.parent.off('freehand-draw', this.draw);\n        this.parent.off('destroyed', this.destroy);\n    };\n    FreehandDrawing.prototype.draw = function (args) {\n        this.updateFhdPvtVar();\n        switch (args.prop) {\n            case 'hoverFhd': {\n                this.hoverFhd(args.value['strokeColor'], args.value['strokeWidth']);\n                break;\n            }\n            case 'freehandDownHandler':\n                this.freehandDownHandler(args.value['e'], args.value['canvas']);\n                break;\n            case 'freehandUpHandler':\n                this.freehandUpHandler(args.value['e'], args.value['canvas'], args.value['context']);\n                break;\n            case 'handle-freehand-draw': {\n                var id = parseInt(args.value['id'].split('_')[1], 10) - 1;\n                if (this.isFHDIdx(id)) {\n                    this.deleteFhd(id, true);\n                }\n                break;\n            }\n            case 'freehandRedraw':\n                this.freehandRedraw(args.value['context'], args.value['points']);\n                break;\n            case 'deleteFhd': {\n                var id = parseInt(args.value['id'].split('_')[1], 10) - 1;\n                this.deleteFhd(id, true);\n                break;\n            }\n            case 'selectFhd': {\n                var id = null;\n                if (args.value['id']) {\n                    id = parseInt(args.value['id'].split('_')[1], 10) - 1;\n                }\n                this.selectFhd(id);\n                break;\n            }\n            case 'applyFhd':\n                this.applyFhd();\n                break;\n            case 'cancelFhd':\n                this.cancelFhd();\n                break;\n            case 'updateFHDCurPts':\n                this.updateFHDCurPts();\n                break;\n            case 'rotateFhdColl':\n                this.rotateFhdColl();\n                break;\n            case 'flipFHDColl':\n                this.flipFHDColl(args.value['value']);\n                break;\n            case 'panFHDColl':\n                this.panFHDColl(args.value['xDiff'], args.value['yDiff'], args.value['panRegion']);\n                break;\n            case 'updateFHDColl':\n                this.updateFHDColl();\n                break;\n            case 'zoomFHDColl':\n                this.zoomFHDColl(args.value['isPreventApply']);\n                break;\n            case 'apply-pen-draw':\n                this.applyPenDraw();\n                break;\n            case 'freeHandDraw':\n                this.freeHandDraw(args.value['value']);\n                break;\n            case 'isFHDIdx':\n                this.isFHDIdx(args.value['index'], args.value['obj']);\n                break;\n            case 'getSqPtFD':\n                this.getSqPtFD(args.value['idx'], args.value['obj']);\n                break;\n            case 'getSelPointColl':\n                args.value['obj']['selPointColl'] = extend([], this.selPointColl);\n                break;\n            case 'setSelPointColl':\n                this.selPointColl = extend([], args.value['obj']['selPointColl']);\n                break;\n            case 'setFreehandDrawHoveredIndex':\n                this.fhdHovIdx = args.value['index'];\n                break;\n            case 'getFreehandDrawHoveredIndex':\n                args.value['obj']['index'] = this.fhdHovIdx;\n                break;\n            case 'setPointCounter':\n                this.pointCounter = args.value['value'];\n                break;\n            case 'getPenStrokeWidth':\n                args.value['obj']['penStrokeWidth'] = this.penStrokeWidth;\n                break;\n            case 'setPenStrokeWidth':\n                this.penStrokeWidth = args.value['value'];\n                break;\n            case 'getCurrentFreehandDrawIndex':\n                args.value['obj']['currentFreehandDrawIndex'] = this.currFHDIdx;\n                break;\n            case 'setCurrentFreehandDrawIndex':\n                this.currFHDIdx = args.value['value'];\n                break;\n            case 'updateCropPtsForSel':\n                this.updateCropPtsForSel();\n                break;\n            case 'getFreehandDrawSelectedId':\n                args.value['obj']['freehandDrawSelectedId'] = this.fhdSelID;\n                break;\n            case 'resetFreehandDrawSelectedId':\n                this.fhdSelID = null;\n                break;\n            case 'getTempFreeHandDrawEditingStyles':\n                args.value['obj']['tempFreeHandDrawEditingStyles'] = this.tempFHDStyles;\n                break;\n            case 'setFreehandSelectedIndex':\n                this.fhdSelIdx = args.value['index'];\n                break;\n            case 'getFreehandSelectedIndex':\n                args.value['obj']['freehandSelectedIndex'] = this.fhdSelIdx;\n                break;\n            case 'reset':\n                this.reset();\n                break;\n        }\n    };\n    FreehandDrawing.prototype.updateFhdPvtVar = function () {\n        var parent = this.parent;\n        if (parent.lowerCanvas) {\n            this.lowerContext = parent.lowerCanvas.getContext('2d');\n        }\n        if (parent.upperCanvas) {\n            this.upperContext = parent.upperCanvas.getContext('2d');\n        }\n    };\n    FreehandDrawing.prototype.reset = function () {\n        this.fhdObj = { lastWidth: 0, lastVelocity: 0, time: 0, pointX: 0, pointY: 0 };\n        this.isFreehandDrawing = this.isFreehandPointMoved = false;\n        this.selPoints = [];\n        this.dummyPoints = [];\n        this.freehandDownPoint = { x: 0, y: 0 };\n        this.selPointColl = {};\n        this.fhdHovIdx = null;\n        this.pointCounter = 0;\n        this.fhdSelID = null;\n        this.penStrokeWidth = undefined;\n        this.currFHDIdx = 0;\n        this.fhdSelIdx = null;\n        this.tempFHDStyles = { strokeColor: null, fillColor: null, strokeWidth: null };\n    };\n    FreehandDrawing.prototype.getModuleName = function () {\n        return 'freehand-draw';\n    };\n    FreehandDrawing.prototype.hoverFhd = function (fillStyle, strokeWidth) {\n        var parent = this.parent;\n        parent.lowerCanvas = document.querySelector('#' + parent.element.id + '_lowerCanvas');\n        this.lowerContext = parent.lowerCanvas.getContext('2d');\n        parent.upperCanvas = document.querySelector('#' + parent.element.id + '_upperCanvas');\n        this.upperContext = parent.upperCanvas.getContext('2d');\n        var context = this.upperContext;\n        var idx = -1;\n        if (this.fhdHovIdx > -1) {\n            idx = this.fhdHovIdx;\n        }\n        else {\n            idx = this.fhdSelIdx;\n        }\n        parent.points = extend([], parent.pointColl[idx].points);\n        this.pointCounter = 0;\n        var len = parent.points.length;\n        var controlPoint1;\n        var controlPoint2;\n        var startPoint;\n        var endPoint;\n        var minStrokeWidth = 0;\n        var maxStrokeWidth = 0;\n        context.fillStyle = fillStyle ? fillStyle : parent.pointColl[idx].strokeColor;\n        context.strokeStyle = context.fillStyle;\n        minStrokeWidth = maxStrokeWidth = this.penStrokeWidth = strokeWidth ?\n            strokeWidth : parent.pointColl[idx].strokeWidth;\n        if (len === 1) {\n            controlPoint1 = controlPoint2 = startPoint = endPoint = parent.points[0];\n            this.startDraw(context, controlPoint1, controlPoint2, startPoint, endPoint, minStrokeWidth, maxStrokeWidth);\n        }\n        for (var l = 0; l < len - 3; l++) {\n            if (parent.points[l + 1] && parent.points[l + 2] && parent.points[l + 2]) {\n                controlPoint1 = (this.calcCurveCP(parent.points[l + 0], parent.points[l + 1], parent.points[l + 2])).controlPoint2;\n                controlPoint2 = (this.calcCurveCP(parent.points[l + 1], parent.points[l + 2], parent.points[l + 3])).controlPoint1;\n                if (l === 0) {\n                    startPoint = parent.points[l];\n                }\n                else {\n                    startPoint = parent.points[l + 1];\n                }\n                endPoint = parent.points[l + 2];\n                this.startDraw(context, controlPoint1, controlPoint2, startPoint, endPoint, minStrokeWidth, maxStrokeWidth);\n            }\n        }\n        context.closePath();\n        // Outer selection\n        var point = this.getSqPtFD(idx);\n        var tempLineWidth = context.lineWidth;\n        context.lineWidth = 2;\n        context.strokeStyle = parent.themeColl[parent.theme]['primaryColor'];\n        context.beginPath();\n        context.rect(point.startX, point.startY, point.width, point.height);\n        context.stroke();\n        context.closePath();\n        context.lineWidth = tempLineWidth;\n    };\n    FreehandDrawing.prototype.freehandDownHandler = function (e, canvas) {\n        this.parent.lowerCanvas = document.querySelector('#' + this.parent.element.id + '_lowerCanvas');\n        this.lowerContext = this.parent.lowerCanvas.getContext('2d');\n        this.parent.upperCanvas = document.querySelector('#' + this.parent.element.id + '_upperCanvas');\n        this.upperContext = this.parent.upperCanvas.getContext('2d');\n        this.fhdObj.time = new Date().getTime();\n        this.isFreehandDrawing = true;\n        if (e.type === 'mousedown') {\n            this.freehandDownPoint = { x: e.clientX, y: e.clientY };\n        }\n        else {\n            this.freehandDownPoint = { x: e.touches[0].clientX, y: e.touches[0].clientY };\n        }\n        this.isFreehandPointMoved = false;\n        EventHandler.add(canvas, 'mousemove touchmove', this.freehandMoveHandler, this);\n    };\n    FreehandDrawing.prototype.freehandUpHandler = function (e, canvas, context) {\n        var rect = canvas.getBoundingClientRect();\n        var parent = this.parent;\n        EventHandler.remove(canvas, 'mousemove touchmove', this.freehandMoveHandler);\n        if (parent.points.length === 0) {\n            if (e.type === 'mouseup') {\n                this.processPoint(e.clientX - rect.left, e.clientY - rect.top, true, context);\n            }\n            else {\n                if (!this.isFreehandPointMoved) {\n                    this.processPoint(this.freehandDownPoint.x - rect.left, this.freehandDownPoint.y - rect.top, true, context);\n                }\n            }\n        }\n        context.closePath();\n        var prevCropObj = extend({}, parent.cropObj, {}, true);\n        var object = { currObj: {} };\n        parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var prevObj = object['currObj'];\n        prevObj.objColl = extend([], parent.objColl, [], true);\n        prevObj.pointColl = extend([], parent.pointColl, [], true);\n        prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        var fhCnt = parent.freehandCounter;\n        parent.pointColl[fhCnt] = {};\n        parent.pointColl[fhCnt].points = extend([], parent.points);\n        parent.pointColl[fhCnt].strokeColor = parent.activeObj.strokeSettings.strokeColor;\n        parent.pointColl[fhCnt].strokeWidth = this.penStrokeWidth;\n        parent.pointColl[fhCnt].flipState = parent.transform.currFlipState;\n        parent.pointColl[fhCnt].id = 'pen_' + (this.currFHDIdx + 1);\n        parent.points = [];\n        this.dummyPoints = [];\n        this.selPointColl[fhCnt] = {};\n        this.selPointColl[fhCnt].points = extend([], this.selPoints);\n        this.selPoints = [];\n        this.pointCounter = 0;\n        parent.freehandCounter++;\n        this.currFHDIdx++;\n        this.isFreehandDrawing = false;\n        parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n            value: { operation: 'freehand-draw', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                previousCropObj: prevCropObj, previousText: null,\n                currentText: null, previousFilter: null, isCircleCrop: null } });\n    };\n    FreehandDrawing.prototype.freehandMoveHandler = function (e) {\n        this.isFreehandPointMoved = true;\n        var rect = this.parent.upperCanvas.getBoundingClientRect();\n        var x;\n        var y;\n        if (e.type === 'mousemove') {\n            x = e.clientX - rect.left;\n            y = e.clientY - rect.top;\n        }\n        else {\n            x = e.touches[0].clientX - rect.left;\n            y = e.touches[0].clientY - rect.top;\n        }\n        if (this.isFreehandDrawing) {\n            this.processPoint(x, y, false, this.upperContext);\n        }\n    };\n    FreehandDrawing.prototype.processPoint = function (x, y, mouseDown, context) {\n        var parent = this.parent;\n        var lastPoint = this.point(x, y, new Date().getTime());\n        lastPoint = parent.points.length > 0 && parent.points[parent.points.length - 1];\n        var isLastPointTooClose = lastPoint ? this.distanceTo(lastPoint) <= 5 : false;\n        var controlPoint1;\n        var controlPoint2;\n        var startPoint;\n        var endPoint;\n        this.selPoints.push({ x: x, y: y, ratioX: (x - parent.img.destLeft) / parent.img.destWidth,\n            ratioY: (y - parent.img.destTop) / parent.img.destHeight,\n            time: this.fhdObj.time });\n        if (!lastPoint || !(lastPoint && isLastPointTooClose) || mouseDown) {\n            this.fhdObj.time = new Date().getTime();\n            parent.points.push({ x: x, y: y, ratioX: (x - parent.img.destLeft) / parent.img.destWidth,\n                ratioY: (y - parent.img.destTop) / parent.img.destHeight,\n                time: this.fhdObj.time });\n            this.dummyPoints.push({ x: x, y: y, ratioX: (x - parent.img.destLeft) / parent.img.destWidth,\n                ratioY: (y - parent.img.destTop) / parent.img.destHeight,\n                time: this.fhdObj.time });\n            if (this.dummyPoints.length > 2) {\n                if (this.dummyPoints.length === 3) {\n                    this.dummyPoints.unshift(this.dummyPoints[0]);\n                }\n                var p0 = this.dummyPoints[0];\n                var p1 = this.dummyPoints[1];\n                var p2 = this.dummyPoints[2];\n                var p3 = this.dummyPoints[3];\n                controlPoint1 = this.calcCurveCP(p0, p1, p2).controlPoint2;\n                controlPoint2 = this.calcCurveCP(p1, p2, p3).controlPoint1;\n                startPoint = this.dummyPoints[1];\n                endPoint = this.dummyPoints[2];\n                var minStrokeWidth = 0.5;\n                var maxStrokeWidth = 5;\n                if (!isNullOrUndefined(this.penStrokeWidth)) {\n                    minStrokeWidth = maxStrokeWidth = this.penStrokeWidth;\n                }\n                this.startDraw(context, controlPoint1, controlPoint2, startPoint, endPoint, minStrokeWidth, maxStrokeWidth);\n                this.pointCounter++;\n                this.dummyPoints.shift();\n            }\n            if (mouseDown) {\n                controlPoint1 = controlPoint2 = startPoint = endPoint = { x: x, y: y, time: new Date().getTime() };\n                var minStrokeWidth = 0.5;\n                var maxStrokeWidth = 5;\n                if (!isNullOrUndefined(this.penStrokeWidth)) {\n                    minStrokeWidth = maxStrokeWidth = this.penStrokeWidth;\n                }\n                this.startDraw(context, controlPoint1, controlPoint2, startPoint, endPoint, minStrokeWidth, maxStrokeWidth);\n            }\n        }\n    };\n    FreehandDrawing.prototype.calcCurveCP = function (p1, p2, p3) {\n        if (!p2) {\n            p2 = p1;\n        }\n        if (!p3) {\n            p3 = p2;\n        }\n        var dx1 = p1.x - p2.x;\n        var dy1 = p1.y - p2.y;\n        var dx2 = p2.x - p3.x;\n        var dy2 = p2.y - p3.y;\n        var m1 = { x: (p1.x + p2.x) / 2.0, y: (p1.y + p2.y) / 2.0 };\n        var m2 = { x: (p2.x + p3.x) / 2.0, y: (p2.y + p3.y) / 2.0 };\n        var l1 = Math.sqrt(dx1 * dx1 + dy1 * dy1);\n        var l2 = Math.sqrt(dx2 * dx2 + dy2 * dy2);\n        var dxm = (m1.x - m2.x);\n        var dym = (m1.y - m2.y);\n        var k = l2 / (l1 + l2);\n        var cm = { x: m2.x + dxm * k, y: m2.y + dym * k };\n        var tx = p2.x - cm.x;\n        var ty = p2.y - cm.y;\n        return {\n            controlPoint1: this.point(m1.x + tx, m1.y + ty, 0),\n            controlPoint2: this.point(m2.x + tx, m2.y + ty, 0)\n        };\n    };\n    FreehandDrawing.prototype.point = function (x, y, time) {\n        this.fhdObj.pointX = x;\n        this.fhdObj.pointY = y;\n        return { x: this.fhdObj.pointX, y: this.fhdObj.pointY, time: time };\n    };\n    FreehandDrawing.prototype.startDraw = function (context, controlPoint1, controlPoint2, startPoint, endPoint, minStrokeWidth, maxStrokeWidth) {\n        var tempVelocity;\n        tempVelocity = this.pointVelocity(startPoint);\n        tempVelocity = 0.7 * tempVelocity + (1 - 0.7) * this.fhdObj.lastVelocity;\n        var newWidth = Math.max(maxStrokeWidth / (0.7 + 1), minStrokeWidth);\n        this.drawCurve(this.fhdObj.time, newWidth, context, controlPoint1, controlPoint2, startPoint, endPoint, maxStrokeWidth);\n        this.fhdObj.lastVelocity = tempVelocity;\n        this.fhdObj.time = newWidth;\n    };\n    FreehandDrawing.prototype.pointVelocity = function (startPoint) {\n        return (this.fhdObj.time !== startPoint.time) ? this.distanceTo(startPoint) /\n            (this.fhdObj.time - startPoint.time) : 0;\n    };\n    FreehandDrawing.prototype.distanceTo = function (start) {\n        return Math.sqrt(Math.pow(this.fhdObj.pointX - start.x, 2) + Math.pow(this.fhdObj.pointY - start.y, 2));\n    };\n    FreehandDrawing.prototype.drawCurve = function (startWidth, endWidth, context, controlPoint1, controlPoint2, startPoint, endPoint, maxStrokeWidth) {\n        var width;\n        var i;\n        var t1;\n        var t2;\n        var t3;\n        var u1;\n        var u2;\n        var u3;\n        var x;\n        var y;\n        var widthValue = endWidth - startWidth;\n        var bezierLength = this.bezierLength(controlPoint1, controlPoint2, startPoint, endPoint);\n        var drawSteps = Math.ceil(bezierLength) * 2;\n        context.beginPath();\n        for (i = 0; i < drawSteps; i++) {\n            t1 = i / drawSteps;\n            t2 = t1 * t1;\n            t3 = t2 * t1;\n            u1 = 1 - t1;\n            u2 = u1 * u1;\n            u3 = u2 * u1;\n            x = u3 * startPoint.x;\n            x += 3 * u2 * t1 * controlPoint1.x;\n            x += 3 * u1 * t2 * controlPoint2.x;\n            x += t3 * endPoint.x;\n            y = u3 * startPoint.y;\n            y += 3 * u2 * t1 * controlPoint1.y;\n            y += 3 * u1 * t2 * controlPoint2.y;\n            y += t3 * endPoint.y;\n            width = Math.min(startWidth + t3 * widthValue, maxStrokeWidth);\n            this.drawArc(x, y, width, context);\n        }\n        context.closePath();\n        context.fill();\n    };\n    FreehandDrawing.prototype.bezierLength = function (controlPoint1, controlPoint2, startPoint, endPoint) {\n        var steps = 10;\n        var length = 0;\n        var i;\n        var t;\n        var pointX1;\n        var pointY1;\n        var pointX2;\n        var pointY2;\n        var pointX3;\n        var pointY3;\n        for (i = 0; i <= steps; i++) {\n            t = i / steps;\n            pointX1 = this.bezierPoint(t, startPoint.x, controlPoint1.x, controlPoint2.x, endPoint.x);\n            pointY1 = this.bezierPoint(t, startPoint.y, controlPoint1.y, controlPoint2.y, endPoint.y);\n            if (i > 0) {\n                pointX3 = pointX1 - pointX2;\n                pointY3 = pointY1 - pointY2;\n                length += Math.sqrt(pointX3 * pointX3 + pointY3 * pointY3);\n            }\n            pointX2 = pointX1;\n            pointY2 = pointY1;\n        }\n        return length;\n    };\n    FreehandDrawing.prototype.bezierPoint = function (t, startPoint, cp1, cp2, endPoint) {\n        return startPoint * (1.0 - t) * (1.0 - t) * (1.0 - t) + 3.0 * cp1 * (1.0 - t) * (1.0 - t) * t + 3.0 *\n            cp2 * (1.0 - t) * t * t + endPoint * t * t * t;\n    };\n    FreehandDrawing.prototype.drawArc = function (x, y, size, context) {\n        if ((x > this.parent.img.destLeft && y > this.parent.img.destTop && x < (this.parent.img.destLeft + this.parent.img.destWidth) &&\n            y < (this.parent.img.destTop + this.parent.img.destHeight) ||\n            (context !== this.lowerContext && context !== this.upperContext))) {\n            context.moveTo(x, y);\n            context.arc(x, y, size, 0, 2 * Math.PI, false);\n        }\n    };\n    FreehandDrawing.prototype.freehandRedraw = function (context, points) {\n        var parent = this.parent;\n        parent.lowerCanvas = document.querySelector('#' + parent.element.id + '_lowerCanvas');\n        this.lowerContext = parent.lowerCanvas.getContext('2d');\n        parent.upperCanvas = document.querySelector('#' + parent.element.id + '_upperCanvas');\n        this.upperContext = parent.upperCanvas.getContext('2d');\n        var temp = context.filter;\n        context.filter = 'none';\n        if (points) {\n            parent.pointColl[parent.freehandCounter] = {};\n            parent.pointColl[parent.freehandCounter].points = points;\n            parent.pointColl[parent.freehandCounter].strokeColor = parent.activeObj.strokeSettings.strokeColor;\n            parent.pointColl[parent.freehandCounter].strokeWidth = this.penStrokeWidth;\n            parent.pointColl[parent.freehandCounter].flipState = parent.transform.currFlipState;\n            parent.freehandCounter++;\n        }\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            parent.points = extend([], parent.pointColl[n].points);\n            this.pointCounter = 0;\n            var len = parent.points.length;\n            var controlPoint1 = void 0;\n            var controlPoint2 = void 0;\n            var startPoint = void 0;\n            var endPoint = void 0;\n            var minStrokeWidth = void 0;\n            var maxStrokeWidth = void 0;\n            if (len > 0) {\n                context.fillStyle = parent.pointColl[n].strokeColor;\n                minStrokeWidth = maxStrokeWidth = this.penStrokeWidth = parent.pointColl[n].strokeWidth;\n            }\n            if (len === 1) {\n                controlPoint1 = controlPoint2 = startPoint = endPoint = parent.points[0];\n                this.startDraw(context, controlPoint1, controlPoint2, startPoint, endPoint, minStrokeWidth, maxStrokeWidth);\n            }\n            for (var l = 0; l < len - 3; l++) {\n                if (parent.points[l + 1] && parent.points[l + 2] && parent.points[l + 2]) {\n                    controlPoint1 = (this.calcCurveCP(parent.points[l + 0], parent.points[l + 1], parent.points[l + 2])).controlPoint2;\n                    controlPoint2 = (this.calcCurveCP(parent.points[l + 1], parent.points[l + 2], parent.points[l + 3])).controlPoint1;\n                    if (l === 0) {\n                        startPoint = parent.points[l];\n                    }\n                    else {\n                        startPoint = parent.points[l + 1];\n                    }\n                    endPoint = parent.points[l + 2];\n                    this.startDraw(context, controlPoint1, controlPoint2, startPoint, endPoint, minStrokeWidth, maxStrokeWidth);\n                }\n            }\n            context.closePath();\n        }\n        context.filter = temp;\n    };\n    FreehandDrawing.prototype.getSqPtFD = function (idx, obj) {\n        var activePoint = { startX: 0, startY: 0, endX: 0, endY: 0, width: 0, height: 0 };\n        var sPoints = extend([], this.selPointColl[idx].points, []);\n        this.parent.points = extend([], this.parent.pointColl[idx].points);\n        this.pointCounter = 0;\n        var len = sPoints.length;\n        for (var l = 0; l < len; l++) {\n            if (activePoint.startX === 0 && activePoint.startY === 0 && activePoint.endX === 0 && activePoint.endY === 0) {\n                activePoint.startX = sPoints[l].x;\n                activePoint.startY = sPoints[l].y;\n                activePoint.endX = sPoints[l].x;\n                activePoint.endY = sPoints[l].y;\n            }\n            else {\n                activePoint.startX = Math.min(activePoint.startX, sPoints[l].x);\n                activePoint.startY = Math.min(activePoint.startY, sPoints[l].y);\n                activePoint.endX = Math.max(activePoint.endX, sPoints[l].x);\n                activePoint.endY = Math.max(activePoint.endY, sPoints[l].y);\n            }\n        }\n        activePoint.startX -= this.penStrokeWidth;\n        activePoint.startY -= this.penStrokeWidth;\n        activePoint.endX += this.penStrokeWidth;\n        activePoint.endY += this.penStrokeWidth;\n        activePoint.width = activePoint.endX - activePoint.startX;\n        activePoint.height = activePoint.endY - activePoint.startY;\n        if (obj) {\n            obj['activePoint'] = activePoint;\n        }\n        return activePoint;\n    };\n    FreehandDrawing.prototype.applyPenDraw = function () {\n        var parent = this.parent;\n        if (parent.currObjType.shape === 'freehanddraw') {\n            parent.notify('shape', { prop: 'apply', onPropertyChange: false, value: { shape: null, obj: null, canvas: null } });\n            parent.upperCanvas.style.cursor = parent.cursor = 'default';\n            parent.currObjType.shape = '';\n        }\n        parent.notify('shape', { prop: 'clearActObj' });\n    };\n    FreehandDrawing.prototype.applyFhd = function () {\n        var parent = this.parent;\n        // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        var selectedPoint = parent.pointColl[this.fhdSelIdx];\n        if (selectedPoint.strokeColor === '#42a5f5') {\n            selectedPoint.strokeColor = this.tempFHDStyles.strokeColor;\n        }\n        if (!isBlazor()) {\n            parent.notify('toolbar', { prop: 'setSelectedFreehandColor', value: { color: '#42a5f5' } });\n        }\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null } });\n        if (!isBlazor()) {\n            parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n        }\n        if (selectedPoint) {\n            selectedPoint.isSelected = false;\n        }\n        parent.notify('selection', { prop: 'resetFreehandDrawVariables' });\n        this.fhdHovIdx = this.fhdSelIdx = null;\n    };\n    FreehandDrawing.prototype.cancelFhd = function () {\n        var parent = this.parent;\n        if (!isBlazor()) {\n            parent.notify('toolbar', { prop: 'setSelectedFreehandColor', value: { color: '#42a5f5' } });\n        }\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        this.pointCounter = 0;\n        if (parent.pointColl[this.fhdSelIdx]) {\n            parent.pointColl[this.fhdSelIdx].strokeColor = this.tempFHDStyles.strokeColor;\n            parent.pointColl[this.fhdSelIdx].strokeWidth = this.tempFHDStyles.strokeWidth;\n            parent.pointColl[this.fhdSelIdx].isSelected = false;\n        }\n        this.fhdHovIdx = this.fhdSelIdx = this.fhdSelID = null;\n        parent.notify('selection', { prop: 'resetFreehandDrawVariables' });\n        parent.activeObj.strokeSettings.strokeColor = this.tempFHDStyles.strokeColor;\n        parent.activeObj.strokeSettings.strokeWidth = this.penStrokeWidth = this.tempFHDStyles.strokeWidth;\n        this.tempFHDStyles = { strokeColor: null, strokeWidth: null, fillColor: null };\n        if (!isBlazor()) {\n            parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n        }\n    };\n    FreehandDrawing.prototype.selectFhd = function (index) {\n        var _this = this;\n        var parent = this.parent;\n        parent.notify('selection', { prop: 'setFreehandDrawEditing', onPropertyChange: false, value: { bool: true } });\n        if (index || index === 0) {\n            if (this.isFHDIdx(index)) {\n                this.fhdSelIdx = this.fhdHovIdx = index;\n                this.hoverFhd();\n                parent.upperCanvas.style.cursor = parent.cursor = 'pointer';\n            }\n            else {\n                return;\n            }\n        }\n        this.fhdSelIdx = this.fhdHovIdx;\n        parent.pointColl[this.fhdSelIdx].isSelected = true;\n        this.fhdSelID = parent.pointColl[this.fhdSelIdx].id;\n        if (parent.pointColl[this.fhdHovIdx].strokeColor !== '#42a5f5') {\n            parent.activeObj.strokeSettings.strokeColor = this.tempFHDStyles.strokeColor =\n                parent.pointColl[this.fhdHovIdx].strokeColor;\n        }\n        parent.activeObj.strokeSettings.strokeWidth = this.tempFHDStyles.strokeWidth =\n            parent.pointColl[this.fhdHovIdx].strokeWidth;\n        var obj = { bool: false };\n        parent.notify('selection', { prop: 'getFreehandDrawEditing', onPropertyChange: false, value: { obj: obj } });\n        if (obj['bool']) {\n            var shapeSettings = { id: 'pen_' + (this.fhdSelIdx + 1), type: ShapeType.FreehandDraw,\n                startX: parent.pointColl[this.fhdSelIdx].points[0].x, startY: parent.pointColl[this.fhdSelIdx].points[0].y,\n                strokeColor: parent.pointColl[this.fhdSelIdx].strokeColor, strokeWidth: parent.pointColl[this.fhdSelIdx].strokeWidth,\n                points: parent.pointColl[this.fhdSelIdx].points };\n            var shapeChangingArgs = { action: 'select', previousShapeSettings: shapeSettings,\n                currentShapeSettings: shapeSettings };\n            if (isBlazor() && parent.events && parent.events.shapeChanging.hasDelegate === true) {\n                /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                parent.dotNetRef.invokeMethodAsync('ShapeEventAsync', 'OnShape', shapeChangingArgs).then(function (shapeChangingArgs) {\n                    parent.activeObj.strokeSettings.strokeColor = parent.pointColl[_this.fhdSelIdx].strokeColor =\n                        shapeChangingArgs.currentShapeSettings.strokeColor;\n                    parent.activeObj.strokeSettings.strokeWidth = parent.pointColl[_this.fhdSelIdx].strokeWidth =\n                        shapeChangingArgs.currentShapeSettings.strokeWidth;\n                    parent.pointColl[_this.fhdSelIdx].points = shapeChangingArgs.currentShapeSettings.points;\n                    _this.freehandRedraw(_this.upperContext);\n                    parent.updateToolbar(parent.element, 'colorToolbar');\n                });\n            }\n            else {\n                parent.trigger('shapeChanging', shapeChangingArgs);\n                parent.activeObj.strokeSettings.strokeColor = parent.pointColl[this.fhdSelIdx].strokeColor =\n                    shapeChangingArgs.currentShapeSettings.strokeColor;\n                parent.activeObj.strokeSettings.strokeWidth = parent.pointColl[this.fhdSelIdx].strokeWidth =\n                    shapeChangingArgs.currentShapeSettings.strokeWidth;\n                parent.pointColl[this.fhdSelIdx].points = shapeChangingArgs.currentShapeSettings.points;\n                this.freehandRedraw(this.upperContext);\n                parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'pen',\n                        isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n            }\n        }\n        else {\n            parent.okBtn();\n        }\n    };\n    FreehandDrawing.prototype.deleteFhd = function (index, isId) {\n        var parent = this.parent;\n        if (this.isFHDIdx(index)) {\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            // eslint-disable-next-line\n            var tempPointColl = extend({}, parent.pointColl, {}, true);\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            var tempSelPointColl = extend({}, this.selPointColl, {}, true);\n            parent.pointColl = {};\n            this.selPointColl = {};\n            var count = 0;\n            if (isNullOrUndefined(isId)) {\n                for (var i = 0; i < parent.freehandCounter; i++) {\n                    if (i !== index) {\n                        parent.pointColl[count] = tempPointColl[i];\n                        this.selPointColl[count] = tempSelPointColl[i];\n                        count++;\n                    }\n                }\n            }\n            else {\n                for (var i = 0; i < parent.freehandCounter; i++) {\n                    if (parseInt(tempPointColl[i].id.split('_')[1], 10) - 1 !== index) {\n                        parent.pointColl[count] = tempPointColl[i];\n                        this.selPointColl[count] = tempSelPointColl[i];\n                        count++;\n                    }\n                }\n            }\n            parent.freehandCounter -= 1;\n            this.fhdHovIdx = this.fhdSelIdx = null;\n            parent.notify('selection', { prop: 'resetFreehandDrawVariables' });\n            parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: true } });\n            if (!isBlazor()) {\n                parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n            }\n        }\n    };\n    FreehandDrawing.prototype.zoomX = function (x) {\n        return (x * this.parent.img.destWidth) + this.parent.img.destLeft;\n    };\n    FreehandDrawing.prototype.zoomY = function (y) {\n        return (y * this.parent.img.destHeight) + this.parent.img.destTop;\n    };\n    FreehandDrawing.prototype.zoomFHDColl = function (isPreventApply) {\n        var parent = this.parent;\n        // Updating point collection for zoom\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            parent.points = extend([], parent.pointColl[n].points, []);\n            this.pointCounter = 0;\n            var len = parent.points.length;\n            for (var l = 0; l < len; l++) {\n                parent.points[l].x = this.zoomX(parent.points[l].ratioX);\n                parent.points[l].y = this.zoomY(parent.points[l].ratioY);\n            }\n        }\n        // Updating each points for cursor styles for zoom\n        this.updateFHDCurPts();\n        if (isNullOrUndefined(isPreventApply)) {\n            this.freehandRedraw(this.lowerContext, null);\n        }\n    };\n    FreehandDrawing.prototype.updateFHDCurPts = function () {\n        var parent = this.parent;\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            if (this.selPointColl[n]) {\n                this.selPoints = extend([], this.selPointColl[n].points, []);\n                this.pointCounter = 0;\n                var len = this.selPoints.length;\n                for (var l = 0; l < len; l++) {\n                    this.selPoints[l].x = this.zoomX(this.selPoints[l].ratioX);\n                    this.selPoints[l].y = this.zoomY(this.selPoints[l].ratioY);\n                }\n            }\n        }\n    };\n    FreehandDrawing.prototype.rotateFhdColl = function () {\n        var parent = this.parent;\n        // Update rotation points for point collection\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            parent.points = extend([], parent.pointColl[n].points, []);\n            this.pointCounter = 0;\n            var len = parent.points.length;\n            for (var l = 0; l < len; l++) {\n                parent.points[l].y = parent.img.destTop + (parent.img.destHeight * parent.points[l].ratioX);\n                parent.points[l].x = (parent.img.destLeft + parent.img.destWidth) - (parent.img.destWidth *\n                    parent.points[l].ratioY);\n                parent.points[l].ratioX = (parent.points[l].x - parent.img.destLeft) / parent.img.destWidth;\n                parent.points[l].ratioY = (parent.points[l].y - parent.img.destTop) / parent.img.destHeight;\n            }\n        }\n        // Update rotation points for each point for cursor styles\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            if (this.selPointColl[n]) {\n                this.selPoints = extend([], this.selPointColl[n].points, []);\n                this.pointCounter = 0;\n                var len = this.selPoints.length;\n                for (var l = 0; l < len; l++) {\n                    this.selPoints[l].y = parent.img.destTop + (parent.img.destHeight * this.selPoints[l].ratioX);\n                    this.selPoints[l].x = (parent.img.destLeft + parent.img.destWidth) - (parent.img.destWidth *\n                        this.selPoints[l].ratioY);\n                    this.selPoints[l].ratioX = (this.selPoints[l].x - parent.img.destLeft) / parent.img.destWidth;\n                    this.selPoints[l].ratioY = (this.selPoints[l].y - parent.img.destTop) / parent.img.destHeight;\n                }\n            }\n        }\n        this.updateFHDCurPts();\n    };\n    FreehandDrawing.prototype.flipFHDColl = function (value) {\n        var lowercaseValue = value.toLowerCase();\n        if (lowercaseValue === 'horizontal') {\n            this.pointsHorizontalFlip();\n        }\n        else if (lowercaseValue === 'vertical') {\n            this.pointsVerticalFlip();\n        }\n        else {\n            this.pointsHorizontalFlip();\n            for (var i = 0; i < this.parent.freehandCounter; i++) {\n                this.parent.pointColl[i].shapeFlip = '';\n            }\n            this.pointsVerticalFlip();\n        }\n    };\n    FreehandDrawing.prototype.pointsHorizontalFlip = function () {\n        var parent = this.parent;\n        // Update flip value for point collection\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            if (parent.pointColl[n].shapeFlip !== parent.transform.currFlipState) {\n                parent.points = extend([], parent.pointColl[n].points, []);\n                this.pointCounter = 0;\n                var len = parent.points.length;\n                for (var l = 0; l < len; l++) {\n                    if (parent.points[l].x <= parent.img.destLeft + (parent.img.destWidth / 2)) {\n                        parent.points[l].x = (parent.img.destLeft + parent.img.destWidth) - (parent.points[l].x\n                            - parent.img.destLeft);\n                    }\n                    else if (parent.points[l].x >= parent.img.destLeft + (parent.img.destWidth / 2)) {\n                        parent.points[l].x = parent.img.destLeft + (parent.img.destLeft + parent.img.destWidth -\n                            parent.points[l].x);\n                    }\n                    parent.points[l].ratioX = (parent.points[l].x - parent.img.destLeft) / parent.img.destWidth;\n                    parent.points[l].ratioY = (parent.points[l].y - parent.img.destTop) / parent.img.destHeight;\n                }\n                parent.pointColl[n].shapeFlip = parent.transform.currFlipState;\n            }\n        }\n        // Update flip value for each points for cursor styles\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            if (this.selPointColl[n]) {\n                if (this.selPointColl[n].shapeFlip !== parent.transform.currFlipState) {\n                    this.selPoints = extend([], this.selPointColl[n].points, []);\n                    this.pointCounter = 0;\n                    var len = this.selPoints.length;\n                    for (var l = 0; l < len; l++) {\n                        if (this.selPoints[l].x <= parent.img.destLeft + (parent.img.destWidth / 2)) {\n                            this.selPoints[l].x = (parent.img.destLeft + parent.img.destWidth) - (this.selPoints[l].x -\n                                parent.img.destLeft);\n                        }\n                        else if (this.selPoints[l].x >= parent.img.destLeft + (parent.img.destWidth / 2)) {\n                            this.selPoints[l].x = parent.img.destLeft + (parent.img.destLeft + parent.img.destWidth -\n                                this.selPoints[l].x);\n                        }\n                        this.selPoints[l].ratioX = (this.selPoints[l].x - parent.img.destLeft) / parent.img.destWidth;\n                        this.selPoints[l].ratioY = (this.selPoints[l].y - parent.img.destTop) / parent.img.destHeight;\n                    }\n                }\n            }\n        }\n        this.updateFHDCurPts();\n    };\n    FreehandDrawing.prototype.pointsVerticalFlip = function () {\n        var parent = this.parent;\n        // Update flip value for point collection\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            if (parent.pointColl[n].shapeFlip !== parent.transform.currFlipState) {\n                parent.points = extend([], parent.pointColl[n].points, []);\n                this.pointCounter = 0;\n                var len = parent.points.length;\n                for (var l = 0; l < len; l++) {\n                    if (parent.points[l].y <= parent.img.destTop + (parent.img.destHeight / 2)) {\n                        parent.points[l].y = (parent.img.destTop + parent.img.destHeight) -\n                            (parent.points[l].y - parent.img.destTop);\n                    }\n                    else if (parent.points[l].y >= parent.img.destTop + (parent.img.destHeight / 2)) {\n                        parent.points[l].y = parent.img.destTop + (parent.img.destTop + parent.img.destHeight -\n                            parent.points[l].y);\n                    }\n                    parent.points[l].ratioX = (parent.points[l].x - parent.img.destLeft) / parent.img.destWidth;\n                    parent.points[l].ratioY = (parent.points[l].y - parent.img.destTop) / parent.img.destHeight;\n                }\n                parent.pointColl[n].shapeFlip = parent.transform.currFlipState;\n            }\n        }\n        // Update flip value for each points for cursor styles\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            if (this.selPointColl[n]) {\n                if (this.selPointColl[n].shapeFlip !== parent.transform.currFlipState) {\n                    this.selPoints = extend([], this.selPointColl[n].points, []);\n                    this.pointCounter = 0;\n                    var len = this.selPoints.length;\n                    for (var l = 0; l < len; l++) {\n                        if (this.selPoints[l].y <= parent.img.destTop + (parent.img.destHeight / 2)) {\n                            this.selPoints[l].y = (parent.img.destTop + parent.img.destHeight) - (this.selPoints[l].y -\n                                parent.img.destTop);\n                        }\n                        else if (this.selPoints[l].y >= parent.img.destTop + (parent.img.destHeight / 2)) {\n                            this.selPoints[l].y = parent.img.destTop + (parent.img.destTop + parent.img.destHeight -\n                                this.selPoints[l].y);\n                        }\n                        this.selPoints[l].ratioX = (this.selPoints[l].x - parent.img.destLeft) / parent.img.destWidth;\n                        this.selPoints[l].ratioY = (this.selPoints[l].y - parent.img.destTop) / parent.img.destHeight;\n                    }\n                }\n            }\n        }\n        this.updateFHDCurPts();\n    };\n    FreehandDrawing.prototype.updateFHDColl = function () {\n        var parent = this.parent;\n        for (var i = 0; i < parent.objColl.length; i++) {\n            parent.objColl[i].imageRatio = { startX: ((parent.objColl[i].activePoint.startX - parent.img.destLeft) /\n                    parent.img.destWidth), startY: ((parent.objColl[i].activePoint.startY - parent.img.destTop) / parent.img.destHeight),\n                endX: ((parent.objColl[i].activePoint.endX - parent.img.destLeft) / parent.img.destWidth),\n                endY: ((parent.objColl[i].activePoint.endY - parent.img.destTop) / parent.img.destHeight),\n                width: parent.img.destWidth / parent.objColl[i].activePoint.width, height: parent.img.destHeight /\n                    parent.objColl[i].activePoint.height };\n            if (parent.objColl[i].shape === 'path') {\n                for (var j = 0; j < parent.objColl[i].pointColl.length; j++) {\n                    parent.objColl[i].pointColl[j].ratioX =\n                        (parent.objColl[i].pointColl[j].x - parent.img.destLeft) / parent.img.destWidth;\n                    parent.objColl[i].pointColl[j].ratioY =\n                        (parent.objColl[i].pointColl[j].y - parent.img.destTop) / parent.img.destHeight;\n                }\n            }\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        }\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            parent.points = extend([], parent.pointColl[n].points, []);\n            this.pointCounter = 0;\n            var len = parent.points.length;\n            for (var l = 0; l < len; l++) {\n                parent.points[l].ratioX = (parent.points[l].x - parent.img.destLeft) / parent.img.destWidth;\n                parent.points[l].ratioY = (parent.points[l].y - parent.img.destTop) / parent.img.destHeight;\n            }\n        }\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            if (this.selPointColl[n]) {\n                this.selPoints = extend([], this.selPointColl[n].points, []);\n                this.pointCounter = 0;\n                var len = this.selPoints.length;\n                for (var l = 0; l < len; l++) {\n                    this.selPoints[l].ratioX = (this.selPoints[l].x - parent.img.destLeft) / parent.img.destWidth;\n                    this.selPoints[l].ratioY = (this.selPoints[l].y - parent.img.destTop) / parent.img.destHeight;\n                }\n            }\n        }\n    };\n    FreehandDrawing.prototype.panFHDColl = function (xDiff, yDiff, panRegion) {\n        var parent = this.parent;\n        // Updating point collection for panning\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            parent.points = extend([], parent.pointColl[n].points, []);\n            this.pointCounter = 0;\n            var len = parent.points.length;\n            for (var l = 0; l < len; l++) {\n                if (panRegion === '' || panRegion === 'vertical') {\n                    parent.points[l].x += xDiff;\n                }\n                else {\n                    parent.points[l].x -= xDiff;\n                }\n                if (panRegion === '' || panRegion === 'horizontal') {\n                    parent.points[l].y += yDiff;\n                }\n                else {\n                    parent.points[l].y -= yDiff;\n                }\n            }\n        }\n        // Updating each points for cursor styles for panning\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            if (this.selPointColl[n]) {\n                this.selPoints = extend([], this.selPointColl[n].points, []);\n                this.pointCounter = 0;\n                var len = this.selPoints.length;\n                for (var l = 0; l < len; l++) {\n                    if (panRegion === '' || panRegion === 'vertical') {\n                        this.selPoints[l].x += xDiff;\n                    }\n                    else {\n                        this.selPoints[l].x -= xDiff;\n                    }\n                    if (panRegion === '' || panRegion === 'horizontal') {\n                        this.selPoints[l].y += yDiff;\n                    }\n                    else {\n                        this.selPoints[l].y -= yDiff;\n                    }\n                }\n            }\n        }\n        this.freehandRedraw(this.lowerContext, null);\n    };\n    FreehandDrawing.prototype.freeHandDraw = function (value) {\n        var parent = this.parent;\n        if (value) {\n            parent.points = [];\n            this.dummyPoints = [];\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            parent.togglePen = true;\n            parent.upperCanvas.style.cursor = parent.cursor = 'crosshair';\n            parent.upperCanvas.style.display = 'block';\n            if (isNullOrUndefined(parent.activeObj.strokeSettings)) {\n                var obj = { strokeSettings: {} };\n                parent.notify('shape', { prop: 'getStrokeSettings', onPropertyChange: false,\n                    value: { obj: obj } });\n                parent.activeObj.strokeSettings = obj['strokeSettings'];\n            }\n            if (isNullOrUndefined(parent.activeObj.strokeSettings.strokeWidth)) {\n                parent.activeObj.strokeSettings.strokeWidth = 4;\n            }\n            if (!isBlazor()) {\n                parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'pen',\n                        isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n            }\n            else {\n                parent.updateToolbar(parent.element, 'pen');\n            }\n        }\n        else {\n            parent.upperCanvas.style.cursor = parent.cursor = 'default';\n            parent.notify('shape', { prop: 'apply', onPropertyChange: false, value: { shape: null, obj: null, canvas: null } });\n            if (!isBlazor()) {\n                parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n                parent.notify('toolbar', { prop: 'setCurrentToolbar', value: { type: 'main' } });\n            }\n            else {\n                parent.updateToolbar(parent.element, 'imageLoaded');\n            }\n            parent.notify('selection', { prop: 'setFreehandDrawCustomized', value: { isFreehandDrawCustomized: false } });\n        }\n    };\n    FreehandDrawing.prototype.isFHDIdx = function (index, obj) {\n        var isIndex = false;\n        for (var i = 0; i < this.parent.freehandCounter; i++) {\n            if (this.parent.pointColl[i].id &&\n                parseInt(this.parent.pointColl[i].id.split('_')[1], 10) - 1 === index) {\n                isIndex = true;\n                break;\n            }\n        }\n        if (obj) {\n            obj['isIndex'] = isIndex;\n        }\n        return isIndex;\n    };\n    FreehandDrawing.prototype.updateCropPtsForSel = function () {\n        var parent = this.parent;\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            var obj = { selPointColl: extend([], this.selPointColl) };\n            if (obj['selPointColl'][n]) {\n                this.selPoints = extend([], obj['selPointColl'][n].points, []);\n                this.pointCounter = 0;\n                var len = this.selPoints.length;\n                for (var l = 0; l < len; l++) {\n                    this.selPoints[l].ratioX = (this.selPoints[l].x -\n                        parent.activeObj.activePoint.startX) / parent.activeObj.activePoint.width;\n                    this.selPoints[l].ratioY = (this.selPoints[l].y -\n                        parent.activeObj.activePoint.startY) / parent.activeObj.activePoint.height;\n                }\n            }\n        }\n    };\n    return FreehandDrawing;\n}());\nexport { FreehandDrawing };\n","import { Browser, EventHandler, extend, isBlazor, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { ZoomTrigger } from '../index';\nvar Selection = /** @class */ (function () {\n    function Selection(parent) {\n        this.diffPoint = { x: 0, y: 0 }; // updates resize points\n        this.oldPoint = {};\n        this.isTouch = false;\n        this.isObjSelected = false;\n        this.isFhdPoint = false; // Specifies whether mouse cursor is on freehand drawing point or not\n        this.dragPoint = { startX: 0, startY: 0, endX: 0, endY: 0 }; // updates drag start and end points in mousedown and mousemove\n        this.isShapeInserted = false;\n        this.tempActiveObj = { activePoint: { startX: 0, startY: 0, endX: 0, endY: 0, width: 0, height: 0 },\n            flipObjColl: [], triangle: [], triangleRatio: [] }; // for undo redo\n        this.isFirstMove = false; // for pinch zoom\n        this.startTouches = []; // for pinch zoom\n        this.tempTouches = []; // for pinch zoom\n        this.currMousePoint = { x: 0, y: 0 }; // To prevent mouse move event on pinch zoom\n        this.cursorTargetId = '';\n        this.isPreventDragging = false; // Shapes dragging is prevented when crop region is inside shape points\n        this.dragElement = '';\n        this.textRow = 1; // text area row count\n        this.mouseDownPoint = { x: 0, y: 0 };\n        this.previousPoint = { x: 0, y: 0 }; // updates prev x and y points in mouseMove\n        this.zoomType = 'Toolbar';\n        this.isInitialTextEdited = false;\n        this.dragCanvas = false;\n        this.isFhdCustomized = false;\n        this.touchEndPoint = {};\n        this.isFhdEditing = false; // Specifies whether freehand drawing is in editing mode or not\n        this.currentDrawingShape = '';\n        this.initialPrevObj = {};\n        this.touchTime = 0;\n        this.resizedElement = '';\n        this.parent = parent;\n        this.addEventListener();\n    }\n    Selection.prototype.destroy = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.removeEventListener();\n    };\n    Selection.prototype.addEventListener = function () {\n        this.parent.on('selection', this.selection, this);\n        this.parent.on('destroyed', this.destroy, this);\n    };\n    Selection.prototype.removeEventListener = function () {\n        this.parent.off('selection', this.selection);\n        this.parent.off('destroyed', this.destroy);\n    };\n    Selection.prototype.selection = function (args) {\n        var _this = this;\n        this.updatePrivateVariables();\n        switch (args.prop) {\n            case 'mouse-up':\n                this.selMouseUpEvent();\n                break;\n            case 'setCursor':\n                this.setCursor(args.value['x'], args.value['y']);\n                break;\n            case 'updateActivePoint':\n                this.updateActivePoint(args.value['x'], args.value['y'], args.value['isCropSelection']);\n                break;\n            case 'updateCursorStyles':\n                this.updateCursorStyles(args.value['x'], args.value['y'], args.value['type']);\n                break;\n            case 'setTextSelection':\n                this.setTextSelection(args.value['width'], args.value['height']);\n                break;\n            case 'setActivePoint':\n                this.setActivePoint(args.value['startX'], args.value['startY']);\n                break;\n            case 'clearSelection':\n                this.clearSelection();\n                break;\n            case 'calcShapeRatio':\n                this.calcShapeRatio(args.value['x'], args.value['y'], args.value['imgWidth'], args.value['imgHeight']);\n                break;\n            case 'applyCurrShape':\n                this.applyCurrShape(args.value['isShapeClick']);\n                break;\n            case 'tab':\n                this.performTabAction();\n                break;\n            case 'setDragDirection':\n                this.setDragDirection(args.value['width'], args.value['height']);\n                break;\n            case 'clearUpperCanvas':\n                if (this.isTouch) {\n                    setTimeout(function () {\n                        _this.parent.upperCanvas.getContext('2d').clearRect(0, 0, _this.parent.upperCanvas.width, _this.parent.upperCanvas.height);\n                    }, 550);\n                }\n                break;\n            case 'resetFreehandDrawVariables':\n                this.isFhdEditing = this.isFhdPoint = false;\n                break;\n            case 'isShapeInserted':\n                this.isShapeInserted = args.value['bool'];\n                break;\n            case 'redrawShape':\n                this.redrawShape(args.value['obj']);\n                break;\n            case 'setTextBoxStylesToActObj':\n                this.setTextBoxStylesToActObj();\n                break;\n            case 'mouseDownEventHandler':\n                this.mouseDownEventHandler(args.value['e']);\n                break;\n            case 'mouseMoveEventHandler':\n                this.mouseMoveEventHandler(args.value['e']);\n                break;\n            case 'mouseUpEventHandler':\n                this.mouseUpEventHandler(args.value['e']);\n                break;\n            case 'canvasMouseDownHandler':\n                this.canvasMouseDownHandler(args.value['e']);\n                break;\n            case 'canvasMouseMoveHandler':\n                this.canvasMouseMoveHandler(args.value['e']);\n                break;\n            case 'canvasMouseUpHandler':\n                this.canvasMouseUpHandler(args.value['e']);\n                break;\n            case 'touchStartHandler':\n                this.touchStartHandler(args.value['e']);\n                break;\n            case 'keyDownEventHandler':\n                this.keyDownEventHandler(args.value['e']);\n                break;\n            case 'handleScroll':\n                this.handleScroll(args.value['e']);\n                break;\n            case 'textKeyDown':\n                setTimeout(this.textKeyDown.bind(this), 1, args.value['e']);\n                break;\n            case 'deleteItem':\n                this.deleteItem();\n                break;\n            case 'updatePrevShapeSettings':\n                this.updatePrevShapeSettings(args.value['obj']);\n                break;\n            case 'getZoomType':\n                args.value['obj']['zoomType'] = this.zoomType;\n                break;\n            case 'setZoomType':\n                this.zoomType = args.value['zoomType'];\n                break;\n            case 'setInitialTextEdit':\n                this.isInitialTextEdited = args.value['bool'];\n                break;\n            case 'setDragCanvas':\n                this.dragCanvas = args.value['bool'];\n                break;\n            case 'setFreehandDrawCustomized':\n                this.isFhdCustomized = args.value['isFreehandDrawCustomized'];\n                break;\n            case 'setTouchEndPoint':\n                this.touchEndPoint.x = args.value['x'];\n                this.touchEndPoint.y = args.value['y'];\n                break;\n            case 'getPanDown':\n                args.value['obj']['panDown'] = this.panDown;\n                break;\n            case 'setPanDown':\n                this.panDown = args.value['panDown'];\n                break;\n            case 'getFreehandDrawEditing':\n                args.value['obj']['bool'] = this.isFhdEditing;\n                break;\n            case 'setFreehandDrawEditing':\n                this.isFhdEditing = args.value['bool'];\n                break;\n            case 'getTempActObj':\n                args.value['obj']['tempObj'] = this.tempActiveObj;\n                break;\n            case 'setTempActObj':\n                this.tempActiveObj = args.value['obj'];\n                break;\n            case 'isInside':\n                this.isInside(args.value['x'], args.value['y'], args.value['z1'], args.value['z2'], args.value['z3'], args.value['z4']);\n                break;\n            case 'setDragElement':\n                this.dragElement = args.value['value'];\n                break;\n            case 'setObjSelected':\n                this.isObjSelected = args.value['bool'];\n                break;\n            case 'adjustActObjForLineArrow':\n                this.adjustActObjForLineArrow(args.value['obj']);\n                break;\n            case 'findTarget':\n                this.findTarget(args.value['x'], args.value['y'], args.value['type']);\n                break;\n            case 'getCurrentFlipState':\n                this.getCurrentFlipState();\n                break;\n            case 'setDragWidth':\n                this.setDragWidth(args.value['width']);\n                break;\n            case 'setDragHeight':\n                this.setDragHeight(args.value['setDragHeight']);\n                break;\n            case 'annotate':\n                this.currentDrawingShape = args.value['shape'];\n                if (args.value['shape'] === 'text') {\n                    this.parent.activeObj.textSettings.fontSize = 100;\n                    this.parent.activeObj.keyHistory = 'Enter Text';\n                    this.parent.notify('shape', { prop: 'initializeTextShape', onPropertyChange: false,\n                        value: { text: null, fontFamily: null, fontSize: null, bold: null, italic: null, strokeColor: null } });\n                }\n                else if (args.value['shape'] === 'path') {\n                    this.parent.activeObj.pointColl = [];\n                }\n                break;\n            case 'getCurrentDrawingShape':\n                args.value['obj']['shape'] = this.currentDrawingShape;\n                break;\n            case 'setCurrentDrawingShape':\n                this.currentDrawingShape = args.value['value'];\n                break;\n            case 'getTransRotationPoint':\n                this.getTransRotationPoint(args.value['obj'], args.value['object']);\n                break;\n            case 'adjustNEPoints':\n                this.adjustNEPoints(args.value['rectangle'], args.value['x'], args.value['y'], args.value['angle']);\n                break;\n            case 'adjustRotationPoints':\n                this.adjustRotationPoints(args.value['rectangle'], args.value['x'], args.value['y'], args.value['angle']);\n                break;\n            case 'getResizeDirection':\n                this.getResizeDirection(args.value['rectangle'], args.value['x'], args.value['y'], args.value['angle']);\n                break;\n            case 'setResizedElement':\n                this.resizedElement = args.value['value'];\n                break;\n            case 'reset':\n                this.reset();\n                break;\n            case 'unWireEvent':\n                this.unwireEvent();\n                break;\n            case 'updPtCollForShpRot':\n                this.updPtCollForShpRot(args.value['obj']);\n                break;\n        }\n    };\n    Selection.prototype.getModuleName = function () {\n        return 'selection';\n    };\n    Selection.prototype.updatePrivateVariables = function () {\n        var parent = this.parent;\n        if (parent.lowerCanvas) {\n            this.lowerContext = parent.lowerCanvas.getContext('2d');\n        }\n        if (parent.upperCanvas) {\n            this.upperContext = parent.upperCanvas.getContext('2d');\n        }\n    };\n    Selection.prototype.reset = function () {\n        this.diffPoint = { x: 0, y: 0 };\n        this.oldPoint = {};\n        this.isTouch = this.isObjSelected = this.isFhdPoint = this.isShapeInserted = false;\n        this.dragPoint = { startX: 0, startY: 0, endX: 0, endY: 0 };\n        this.tempActiveObj = { activePoint: { startX: 0, startY: 0, endX: 0, endY: 0, width: 0, height: 0 },\n            flipObjColl: [], triangle: [], triangleRatio: [] };\n        this.isFirstMove = false;\n        this.cursorTargetId = this.dragElement = '';\n        this.startTouches = [];\n        this.tempTouches = [];\n        this.currMousePoint = { x: 0, y: 0 };\n        this.isPreventDragging = false;\n        this.timer = undefined;\n        this.tempObjColl = undefined;\n        this.textRow = 1;\n        this.mouseDownPoint = { x: 0, y: 0 };\n        this.previousPoint = { x: 0, y: 0 };\n        this.zoomType = 'Toolbar';\n        this.isInitialTextEdited = false;\n        this.dragCanvas = false;\n        this.isFhdCustomized = false;\n        this.touchEndPoint = {};\n        this.panDown = null;\n        this.isFhdEditing = false;\n        this.pathAdjustedIndex = null;\n        this.touchTime = 0;\n        this.currentDrawingShape = '';\n        this.initialPrevObj = {};\n        this.resizedElement = '';\n    };\n    Selection.prototype.performTabAction = function () {\n        if (this.parent.textArea.style.display === 'block') {\n            var allowUndoRedoPush = this.applyCurrShape(false);\n            this.parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                value: { x: null, y: null, isMouseDown: null } });\n            if (allowUndoRedoPush) {\n                this.parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n            }\n        }\n    };\n    Selection.prototype.selMouseUpEvent = function () {\n        this.oldPoint.x = undefined;\n        this.oldPoint.y = undefined;\n    };\n    Selection.prototype.getMouseCursor = function (actObj, x, y, isCropSelection, isApply) {\n        var rotationCirclePoint = this.getTransRotationPoint(actObj);\n        var cursor = 'default';\n        var ratio = isApply ? 0 : ((actObj.topLeftCircle.radius * 2));\n        if (x >= (actObj.topLeftCircle.startX - ratio) &&\n            x <= (actObj.topLeftCircle.startX + ratio) &&\n            y >= (actObj.topLeftCircle.startY - ratio) &&\n            y <= (actObj.topLeftCircle.startY + ratio)) {\n            cursor = 'nw-resize';\n        }\n        else if (x >= (actObj.topLeftCircle.startX - ratio) &&\n            x <= (actObj.topRightCircle.startX - ratio) &&\n            y >= (actObj.topCenterCircle.startY - ratio) &&\n            y <= (actObj.topCenterCircle.startY + ratio)) {\n            cursor = 'n-resize';\n        }\n        else if (x >= (actObj.topRightCircle.startX - ratio) &&\n            x <= (actObj.topRightCircle.startX + ratio) &&\n            y >= (actObj.topRightCircle.startY - ratio) &&\n            y <= (actObj.topRightCircle.startY + ratio)) {\n            cursor = 'ne-resize';\n        }\n        else if (x >= (actObj.centerLeftCircle.startX - ratio) &&\n            x <= (actObj.centerLeftCircle.startX + ratio) &&\n            y >= (actObj.topLeftCircle.startY - ratio) &&\n            y <= (actObj.bottomLeftCircle.startY - ratio)) {\n            cursor = 'w-resize';\n        }\n        else if (x >= (actObj.centerRightCircle.startX - ratio) &&\n            x <= (actObj.centerRightCircle.startX + ratio) &&\n            y >= (actObj.topRightCircle.startY - ratio) &&\n            y <= (actObj.bottomRightCircle.startY - ratio)) {\n            cursor = 'e-resize';\n        }\n        else if (x >= (actObj.bottomLeftCircle.startX - ratio) &&\n            x <= (actObj.bottomLeftCircle.startX + ratio) &&\n            y >= (actObj.bottomLeftCircle.startY - ratio) &&\n            y <= (actObj.bottomLeftCircle.startY + ratio)) {\n            cursor = 'sw-resize';\n        }\n        else if (x >= (actObj.bottomLeftCircle.startX - ratio) &&\n            x <= (actObj.bottomRightCircle.startX - ratio) &&\n            y >= (actObj.bottomCenterCircle.startY - ratio) &&\n            y <= (actObj.bottomCenterCircle.startY + ratio)) {\n            cursor = 's-resize';\n        }\n        else if (x >= (actObj.bottomRightCircle.startX - ratio) &&\n            x <= (actObj.bottomRightCircle.startX + ratio) &&\n            y >= (actObj.bottomRightCircle.startY - ratio) &&\n            y <= (actObj.bottomRightCircle.startY + ratio)) {\n            cursor = 'se-resize';\n        }\n        else if ((x >= actObj.activePoint.startX &&\n            x <= actObj.activePoint.endX) && (y >= actObj.activePoint.startY &&\n            y <= actObj.activePoint.endY)) {\n            if (isCropSelection) {\n                cursor = 'grab';\n            }\n            else {\n                cursor = 'move';\n            }\n        }\n        else if (rotationCirclePoint && !isApply &&\n            x >= (rotationCirclePoint.x - (actObj.bottomCenterCircle.radius + 2)) &&\n            x <= rotationCirclePoint.x + (actObj.bottomCenterCircle.radius + 2) &&\n            y >= rotationCirclePoint.y - (actObj.bottomCenterCircle.radius + 2) &&\n            y <= rotationCirclePoint.y + (actObj.bottomCenterCircle.radius + 2)) {\n            cursor = 'grabbing';\n        }\n        else {\n            cursor = 'default';\n        }\n        return cursor;\n    };\n    Selection.prototype.setCursor = function (x, y) {\n        var parent = this.parent;\n        var lowerCanvas = document.querySelector('#' + parent.element.id + '_lowerCanvas');\n        var upperCanvas = document.querySelector('#' + parent.element.id + '_upperCanvas');\n        var isCropSelection = false;\n        var splitWords;\n        if (this.currentDrawingShape !== '') {\n            upperCanvas.style.cursor = parent.cursor = 'crosshair';\n            return;\n        }\n        if (parent.currObjType.isDragging) {\n            if (this.dragElement === '') {\n                upperCanvas.style.cursor = parent.cursor = 'move';\n            }\n            else {\n                upperCanvas.style.cursor = parent.cursor = this.dragElement;\n            }\n            return;\n        }\n        if (parent.activeObj.horTopLine !== undefined) {\n            if (parent.activeObj.shape !== undefined) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (splitWords === undefined && parent.currObjType.isCustomCrop) {\n                isCropSelection = true;\n            }\n            else if (splitWords !== undefined && splitWords[0] === 'crop') {\n                isCropSelection = true;\n            }\n            if (!isCropSelection && parent.togglePan) {\n                lowerCanvas.style.cursor = upperCanvas.style.cursor = parent.cursor = 'grab';\n            }\n            var cursor = upperCanvas.style.cursor;\n            var actObj = extend({}, parent.activeObj, {}, true);\n            this.cursorTargetId = actObj.currIndex;\n            var degree = void 0;\n            if (actObj.shapeDegree === 0) {\n                degree = parent.transform.degree;\n            }\n            else {\n                degree = parent.transform.degree - actObj.shapeDegree;\n            }\n            if (degree < 0) {\n                degree = 360 + degree;\n            }\n            if (actObj.shape === 'line' || actObj.shape === 'arrow') {\n                this.setCursorForLineArrow(actObj, x, y, upperCanvas);\n            }\n            else if (actObj.shape === 'path') {\n                this.setCursorForPath(actObj, x, y, upperCanvas);\n            }\n            else if (!isNullOrUndefined(actObj.rotatedAngle) && actObj.rotatedAngle !== 0) {\n                this.setCursorForRotatedObject(actObj, x, y, upperCanvas);\n            }\n            else {\n                upperCanvas.style.cursor = parent.cursor = this.getMouseCursor(actObj, x, y, isCropSelection, false);\n                if ((actObj.shape === 'text') && (parent.cursor === 'n-resize' ||\n                    parent.cursor === 's-resize' || parent.cursor === 'e-resize' ||\n                    parent.cursor === 'w-resize')) {\n                    upperCanvas.style.cursor = parent.cursor = 'move';\n                }\n            }\n            if (cursor === 'default' && parent.cursor === 'default' && isCropSelection) {\n                upperCanvas.style.cursor = parent.cursor = 'grab';\n            }\n            if (cursor === 'grab' && parent.cursor === 'default') {\n                upperCanvas.style.cursor = parent.cursor = 'grab';\n            }\n        }\n        else if (parent.togglePan && !parent.togglePen) {\n            lowerCanvas.style.cursor = upperCanvas.style.cursor = parent.cursor = 'grab';\n        }\n        else {\n            if (parent.currObjType.isCustomCrop || parent.togglePen) {\n                upperCanvas.style.cursor = parent.cursor = 'crosshair';\n            }\n            else {\n                upperCanvas.style.cursor = parent.cursor = 'default';\n            }\n        }\n        if (parent.cursor === 'default' || parent.cursor === 'grab') {\n            var cursor = upperCanvas.style.cursor;\n            if (parent.objColl.length > 0 && (parent.cursor !== 'grab' || !isCropSelection)) {\n                this.setCursorFromObj(x, y, parent.objColl, upperCanvas, isCropSelection);\n            }\n            if (cursor === 'grab' && parent.cursor === 'default') {\n                upperCanvas.style.cursor = parent.cursor = 'grab';\n            }\n        }\n        if ((parent.cursor === 'default' || parent.cursor === 'grab')\n            && parent.pointColl[0] && (parent.cursor !== 'grab' || !isCropSelection)\n            && !parent.currObjType.isDragging && !parent.currObjType.isResize) {\n            this.setCursorForFreehandDrawing(x, y, upperCanvas);\n        }\n    };\n    Selection.prototype.setCursorForPath = function (actObj, x, y, upperCanvas) {\n        this.setCursorForLineArrow(actObj, x, y, upperCanvas);\n        var parent = this.parent;\n        if (parent.cursor === 'default') {\n            var obj = extend({}, actObj, null, true);\n            var isMove = false;\n            for (var i = 1; i < actObj.pointColl.length; i++) {\n                if (isMove) {\n                    break;\n                }\n                obj.activePoint.startX = actObj.pointColl[i - 1].x;\n                obj.activePoint.startY = actObj.pointColl[i - 1].y;\n                obj.activePoint.endX = actObj.pointColl[i].x;\n                obj.activePoint.endY = actObj.pointColl[i].y;\n                parent.notify('shape', { prop: 'setPointCollForLineArrow', onPropertyChange: false,\n                    value: { obj: obj } });\n                for (var j = 0; j < obj.pointColl.length; j++) {\n                    var point = obj.pointColl[j];\n                    if (!isNullOrUndefined(point.x - (actObj.topLeftCircle.radius * 2)) &&\n                        !isNullOrUndefined(point.x + (actObj.topLeftCircle.radius * 2)) &&\n                        !isNullOrUndefined(point.y - (actObj.topLeftCircle.radius * 2)) &&\n                        !isNullOrUndefined(point.y + (actObj.topLeftCircle.radius * 2)) &&\n                        x >= (point.x - (actObj.topLeftCircle.radius * 2)) &&\n                        x <= (point.x + (actObj.topLeftCircle.radius * 2)) &&\n                        y >= (point.y - (actObj.topLeftCircle.radius * 2)) &&\n                        y <= (point.y + (actObj.topLeftCircle.radius * 2))) {\n                        upperCanvas.style.cursor = parent.cursor = 'move';\n                        isMove = true;\n                        break;\n                    }\n                    else {\n                        upperCanvas.style.cursor = parent.cursor = 'default';\n                    }\n                }\n            }\n        }\n        return parent.cursor;\n    };\n    Selection.prototype.setCursorForLineArrow = function (actObj, x, y, upperCanvas) {\n        var index;\n        for (var i = 0; i < actObj.pointColl.length; i++) {\n            var point = actObj.pointColl[i];\n            if (x >= (point.x - (actObj.topLeftCircle.radius * 2)) && x <= (point.x + (actObj.topLeftCircle.radius * 2)) &&\n                y >= (point.y - (actObj.topLeftCircle.radius * 2)) && y <= (point.y + (actObj.topLeftCircle.radius * 2))) {\n                upperCanvas.style.cursor = this.parent.cursor = 'move';\n                index = i;\n                break;\n            }\n            else {\n                upperCanvas.style.cursor = this.parent.cursor = 'default';\n            }\n        }\n        return index;\n    };\n    Selection.prototype.setCursorForRotatedObject = function (actObj, x, y, upperCanvas) {\n        this.resizedElement = '';\n        var parent = this.parent;\n        if (x >= (actObj.horTopLinePointColl[0].x - (actObj.bottomCenterCircle.radius + 2)) &&\n            x <= (actObj.horTopLinePointColl[0].x + (actObj.bottomCenterCircle.radius + 2)) &&\n            y >= (actObj.horTopLinePointColl[0].y - (actObj.bottomCenterCircle.radius + 2)) &&\n            y <= (actObj.horTopLinePointColl[0].y + (actObj.bottomCenterCircle.radius + 2))) {\n            upperCanvas.style.cursor = parent.cursor = 'nw-resize';\n        }\n        else if (x >= (actObj.horTopLinePointColl[Math.round(actObj.horTopLinePointColl.length / 2)].x - 5) &&\n            x <= (actObj.horTopLinePointColl[Math.round(actObj.horTopLinePointColl.length / 2)].x + 5) &&\n            y >= (actObj.horTopLinePointColl[Math.round(actObj.horTopLinePointColl.length / 2)].y - 5) &&\n            y <= (actObj.horTopLinePointColl[Math.round(actObj.horTopLinePointColl.length / 2)].y + 5)) {\n            upperCanvas.style.cursor = parent.cursor = this.resizedElement = 'n-resize';\n        }\n        else if (x >= (actObj.horTopLinePointColl[Math.round(actObj.horTopLinePointColl.length - 1)].x -\n            (actObj.bottomCenterCircle.radius + 2)) &&\n            x <= (actObj.horTopLinePointColl[Math.round(actObj.horTopLinePointColl.length - 1)].x +\n                (actObj.bottomCenterCircle.radius + 2)) &&\n            y >= (actObj.horTopLinePointColl[Math.round(actObj.horTopLinePointColl.length - 1)].y -\n                (actObj.bottomCenterCircle.radius + 2)) &&\n            y <= (actObj.horTopLinePointColl[Math.round(actObj.horTopLinePointColl.length - 1)].y +\n                (actObj.bottomCenterCircle.radius + 2))) {\n            upperCanvas.style.cursor = parent.cursor = 'ne-resize';\n        }\n        else if (x >= (actObj.verLeftLinePointColl[Math.round(actObj.verLeftLinePointColl.length / 2)].x - 5) &&\n            x <= (actObj.verLeftLinePointColl[Math.round(actObj.verLeftLinePointColl.length / 2)].x + 5) &&\n            y >= (actObj.verLeftLinePointColl[Math.round(actObj.verLeftLinePointColl.length / 2)].y - 5)\n            && y <= (actObj.verLeftLinePointColl[Math.round(actObj.verLeftLinePointColl.length / 2)].y + 5)) {\n            upperCanvas.style.cursor = parent.cursor = this.resizedElement = 'w-resize';\n        }\n        else if (x >= (actObj.verRightLinePointColl[Math.round(actObj.verRightLinePointColl.length / 2)].x - 5) &&\n            x <= (actObj.verRightLinePointColl[Math.round(actObj.verRightLinePointColl.length / 2)].x + 5)\n            && y >= (actObj.verRightLinePointColl[Math.round(actObj.verRightLinePointColl.length / 2)].y - 5) &&\n            y <= (actObj.verRightLinePointColl[Math.round(actObj.verRightLinePointColl.length / 2)].y + 5)) {\n            upperCanvas.style.cursor = parent.cursor = this.resizedElement = 'e-resize';\n        }\n        else if (x >= (actObj.horBottomLinePointColl[0].x - (actObj.bottomCenterCircle.radius + 2)) &&\n            x <= (actObj.horBottomLinePointColl[0].x + (actObj.bottomCenterCircle.radius + 2)) &&\n            y >= (actObj.horBottomLinePointColl[0].y - (actObj.bottomCenterCircle.radius + 2)) &&\n            y <= (actObj.horBottomLinePointColl[0].y + (actObj.bottomCenterCircle.radius + 2))) {\n            upperCanvas.style.cursor = parent.cursor = 'sw-resize';\n        }\n        else if (x >= (actObj.horBottomLinePointColl[Math.round(actObj.horBottomLinePointColl.length / 2)].x - 5) &&\n            x <= (actObj.horBottomLinePointColl[Math.round(actObj.horBottomLinePointColl.length / 2)].x + 5) &&\n            y >= (actObj.horBottomLinePointColl[Math.round(actObj.horBottomLinePointColl.length / 2)].y - 5) &&\n            y <= (actObj.horBottomLinePointColl[Math.round(actObj.horBottomLinePointColl.length / 2)].y + 5)) {\n            upperCanvas.style.cursor = parent.cursor = this.resizedElement = 's-resize';\n        }\n        else if (x >= (actObj.horBottomLinePointColl[Math.round(actObj.horBottomLinePointColl.length - 1)].x -\n            (actObj.bottomCenterCircle.radius + 2)) &&\n            x <= (actObj.horBottomLinePointColl[Math.round(actObj.horBottomLinePointColl.length - 1)].x +\n                (actObj.bottomCenterCircle.radius + 2)) &&\n            y >= (actObj.horBottomLinePointColl[Math.round(actObj.horBottomLinePointColl.length - 1)].y -\n                (actObj.bottomCenterCircle.radius + 2)) &&\n            y <= (actObj.horBottomLinePointColl[Math.round(actObj.horBottomLinePointColl.length - 1)].y +\n                (actObj.bottomCenterCircle.radius + 2))) {\n            upperCanvas.style.cursor = parent.cursor = 'se-resize';\n        }\n        else if (actObj.rotationCirclePointColl &&\n            x >= (actObj.rotationCirclePointColl.x - (actObj.bottomCenterCircle.radius + 2)) &&\n            x <= actObj.rotationCirclePointColl.x + (actObj.bottomCenterCircle.radius + 2) &&\n            y >= actObj.rotationCirclePointColl.y - (actObj.bottomCenterCircle.radius + 2) &&\n            y <= actObj.rotationCirclePointColl.y + (actObj.bottomCenterCircle.radius + 2)) {\n            upperCanvas.style.cursor = parent.cursor = 'grabbing';\n        }\n        else {\n            upperCanvas.style.cursor = parent.cursor = 'default';\n            var isPointsInsideRectangle = this.getRectanglePoints(actObj.activePoint.startX, actObj.activePoint.startY, actObj.activePoint.width, actObj.activePoint.height, actObj.rotatedAngle * (180 / Math.PI), x, y);\n            if (isPointsInsideRectangle) {\n                upperCanvas.style.cursor = parent.cursor = 'move';\n            }\n        }\n        if (parent.cursor === 'default') {\n            for (var i = 0, len = actObj.horTopLinePointColl.length; i < len; i++) {\n                if (x >= (actObj.horTopLinePointColl[i].x - 5) &&\n                    x <= (actObj.horTopLinePointColl[i].x + 5) &&\n                    y >= (actObj.horTopLinePointColl[i].y - 5) &&\n                    y <= (actObj.horTopLinePointColl[i].y + 5)) {\n                    upperCanvas.style.cursor = parent.cursor = this.resizedElement = 'n-resize';\n                    break;\n                }\n            }\n        }\n        if (parent.cursor === 'default') {\n            for (var i = 0, len = actObj.horBottomLinePointColl.length; i < len; i++) {\n                if (x >= (actObj.horBottomLinePointColl[i].x - 5) &&\n                    x <= (actObj.horBottomLinePointColl[i].x + 5) &&\n                    y >= (actObj.horBottomLinePointColl[i].y - 5) &&\n                    y <= (actObj.horBottomLinePointColl[i].y + 5)) {\n                    upperCanvas.style.cursor = parent.cursor = this.resizedElement = 's-resize';\n                    break;\n                }\n            }\n        }\n        if (parent.cursor === 'default') {\n            for (var i = 0, len = actObj.verLeftLinePointColl.length; i < len; i++) {\n                if (x >= (actObj.verLeftLinePointColl[i].x - 5) &&\n                    x <= (actObj.verLeftLinePointColl[i].x + 5) &&\n                    y >= (actObj.verLeftLinePointColl[i].y - 5) &&\n                    y <= (actObj.verLeftLinePointColl[i].y + 5)) {\n                    upperCanvas.style.cursor = parent.cursor = this.resizedElement = 'w-resize';\n                    break;\n                }\n            }\n        }\n        if (parent.cursor === 'default') {\n            for (var i = 0, len = actObj.verRightLinePointColl.length; i < len; i++) {\n                if (x >= (actObj.verRightLinePointColl[i].x - 5) &&\n                    x <= (actObj.verRightLinePointColl[i].x + 5) &&\n                    y >= (actObj.verRightLinePointColl[i].y - 5) &&\n                    y <= (actObj.verRightLinePointColl[i].y + 5)) {\n                    upperCanvas.style.cursor = parent.cursor = this.resizedElement = 'e-resize';\n                    break;\n                }\n            }\n        }\n        this.adjustCursorStylesForRotatedState(actObj);\n        return parent.cursor;\n    };\n    Selection.prototype.adjustCursorStylesForRotatedState = function (actObj) {\n        var parent = this.parent;\n        var length = actObj.rotatedAngle * (180 / Math.PI);\n        length = length > 0 ? Math.floor(length) : Math.ceil(length);\n        if ((length >= 92 && length <= 182) || (length >= -178 && length <= -88)) {\n            var cursorMap = { 'nw-resize': 'ne-resize', 'n-resize': 's-resize',\n                'ne-resize': 'nw-resize', 'w-resize': 'e-resize', 'e-resize': 'w-resize',\n                'sw-resize': 'se-resize', 's-resize': 'n-resize', 'se-resize': 'sw-resize'\n            };\n            if (parent.cursor in cursorMap) {\n                parent.cursor = cursorMap[parent.cursor];\n            }\n        }\n        parent.upperCanvas.style.cursor = this.getResizeElement((actObj.rotatedAngle * (180 / Math.PI)), parent.cursor);\n        return parent.cursor;\n    };\n    Selection.prototype.getResizeElement = function (degree, element) {\n        var resizeMappings = [];\n        if (element === 'nw-resize') {\n            resizeMappings = [\n                [337.5, 22.5, 'nw-resize'], [22.5, 67.5, 'n-resize'], [67.5, 112.5, 'ne-resize'],\n                [112.5, 157.5, 'e-resize'], [157.5, 202.5, 'se-resize'],\n                [202.5, 247.5, 's-resize'], [247.5, 292.5, 'sw-resize'],\n                [292.5, 337.5, 'w-resize']\n            ];\n        }\n        else if (element === 'n-resize') {\n            resizeMappings = [\n                [337.5, 22.5, 'n-resize'], [22.5, 67.5, 'ne-resize'], [67.5, 112.5, 'e-resize'],\n                [112.5, 157.5, 'se-resize'], [157.5, 202.5, 's-resize'], [202.5, 247.5, 'sw-resize'],\n                [247.5, 292.5, 'w-resize'], [292.5, 337.5, 'nw-resize']\n            ];\n        }\n        else if (element === 'ne-resize') {\n            resizeMappings = [\n                [337.5, 22.5, 'ne-resize'], [22.5, 67.5, 'e-resize'],\n                [67.5, 112.5, 'se-resize'], [112.5, 157.5, 's-resize'], [157.5, 202.5, 'sw-resize'],\n                [202.5, 247.5, 'w-resize'], [247.5, 292.5, 'nw-resize'], [292.5, 337.5, 'n-resize']\n            ];\n        }\n        else if (element === 'e-resize') {\n            resizeMappings = [\n                [337.5, 22.5, 'e-resize'], [22.5, 67.5, 'se-resize'], [67.5, 112.5, 's-resize'],\n                [112.5, 157.5, 'sw-resize'], [157.5, 202.5, 'w-resize'], [202.5, 247.5, 'nw-resize'],\n                [247.5, 292.5, 'n-resize'], [292.5, 337.5, 'ne-resize']\n            ];\n        }\n        else if (element === 'se-resize') {\n            resizeMappings = [\n                [337.5, 22.5, 'se-resize'], [22.5, 67.5, 's-resize'], [67.5, 112.5, 'sw-resize'],\n                [112.5, 157.5, 'w-resize'], [157.5, 202.5, 'nw-resize'], [202.5, 247.5, 'n-resize'],\n                [247.5, 292.5, 'ne-resize'], [292.5, 337.5, 'e-resize']\n            ];\n        }\n        else if (element === 's-resize') {\n            resizeMappings = [\n                [337.5, 22.5, 's-resize'], [22.5, 67.5, 'sw-resize'], [67.5, 112.5, 'w-resize'],\n                [112.5, 157.5, 'nw-resize'], [157.5, 202.5, 'n-resize'], [202.5, 247.5, 'ne-resize'],\n                [247.5, 292.5, 'e-resize'], [292.5, 337.5, 'se-resize']\n            ];\n        }\n        else if (element === 'sw-resize') {\n            resizeMappings = [\n                [337.5, 22.5, 'sw-resize'], [22.5, 67.5, 'w-resize'], [67.5, 112.5, 'nw-resize'],\n                [112.5, 157.5, 'n-resize'], [157.5, 202.5, 'ne-resize'], [202.5, 247.5, 'e-resize'],\n                [247.5, 292.5, 'se-resize'], [292.5, 337.5, 's-resize']\n            ];\n        }\n        else if (element === 'w-resize') {\n            resizeMappings = [\n                [337.5, 22.5, 'w-resize'], [22.5, 67.5, 'nw-resize'], [67.5, 112.5, 'n-resize'],\n                [112.5, 157.5, 'ne-resize'], [157.5, 202.5, 'e-resize'], [202.5, 247.5, 'se-resize'],\n                [247.5, 292.5, 's-resize'], [292.5, 337.5, 'sw-resize']\n            ];\n        }\n        var positiveDegree = degree < 0 ? 360 - Math.abs(degree) : degree;\n        for (var _i = 0, resizeMappings_1 = resizeMappings; _i < resizeMappings_1.length; _i++) {\n            var _a = resizeMappings_1[_i], startDegree = _a[0], endDegree = _a[1], resizeElement = _a[2];\n            if ((positiveDegree > startDegree && positiveDegree <= endDegree) ||\n                (positiveDegree + 360 > startDegree && positiveDegree + 360 <= endDegree)) {\n                return resizeElement;\n            }\n        }\n        return element;\n    };\n    Selection.prototype.setCursorForFreehandDrawing = function (x, y, upperCanvas) {\n        var upperContext = upperCanvas.getContext('2d');\n        var parent = this.parent;\n        var textArea = document.querySelector('#' + parent.element.id + '_textArea');\n        var isEntered = false;\n        parent.notify('freehand-draw', { prop: 'setFreehandDrawHoveredIndex', onPropertyChange: false,\n            value: { index: -1 } });\n        var sPoints;\n        for (var n = 0; n < parent.freehandCounter; n++) {\n            var obj = { selPointColl: {} };\n            parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false, value: { obj: obj } });\n            sPoints = extend([], obj['selPointColl'][n].points, []);\n            parent.points = extend([], parent.pointColl[n].points, []);\n            parent.notify('freehand-draw', { prop: 'setPointCounter', onPropertyChange: false, value: { value: 0 } });\n            var len = sPoints.length;\n            for (var l = 0; l < len; l++) {\n                if (l !== 0) {\n                    var isInside = false;\n                    if (sPoints[l - 1] && sPoints[l]) {\n                        isInside = this.isInside(x, y, sPoints[l - 1].x, sPoints[l - 1].y, sPoints[l].x, sPoints[l].y);\n                    }\n                    if (isInside) {\n                        this.isFhdPoint = true;\n                        parent.notify('freehand-draw', { prop: 'setFreehandDrawHoveredIndex', onPropertyChange: false,\n                            value: { index: n } });\n                        parent.notify('freehand-draw', { prop: 'hoverFhd', onPropertyChange: false,\n                            value: { strokeColor: null, strokeWidth: null } });\n                        upperCanvas.style.cursor = parent.cursor = 'pointer';\n                        isEntered = true;\n                        break;\n                    }\n                    else if (!this.isFhdEditing || parent.pointColl[n].isSelected) {\n                        if (this.isFhdPoint || this.isFhdEditing) {\n                            upperContext.clearRect(0, 0, upperCanvas.width, upperCanvas.height);\n                            if (parent.activeObj.shape && textArea.style.display === 'none') {\n                                parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj } });\n                            }\n                        }\n                        if (this.isFhdEditing) {\n                            var strokeColor = parent.pointColl[n].strokeColor;\n                            parent.notify('freehand-draw', { prop: 'hoverFhd', onPropertyChange: false,\n                                value: { strokeColor: strokeColor, strokeWidth: parent.pointColl[n].strokeWidth } });\n                        }\n                        else {\n                            parent.notify('freehand-draw', { prop: 'setFreehandDrawHoveredIndex', onPropertyChange: false,\n                                value: { index: null } });\n                        }\n                        this.isFhdPoint = false;\n                    }\n                }\n                else {\n                    if (x > parent.points[l].x - parent.pointColl[n].strokeWidth &&\n                        x < parent.points[l].x + parent.pointColl[n].strokeWidth &&\n                        y > parent.points[l].y - parent.pointColl[n].strokeWidth &&\n                        y < parent.points[l].y + parent.pointColl[n].strokeWidth) {\n                        this.isFhdPoint = true;\n                        parent.notify('freehand-draw', { prop: 'setFreehandDrawHoveredIndex', onPropertyChange: false,\n                            value: { index: n } });\n                        parent.notify('freehand-draw', { prop: 'hoverFhd', onPropertyChange: false,\n                            value: { strokeColor: null, strokeWidth: null } });\n                        upperCanvas.style.cursor = parent.cursor = 'pointer';\n                        isEntered = true;\n                        break;\n                    }\n                    else if (!this.isFhdEditing || parent.pointColl[n].isSelected) {\n                        if (this.isFhdPoint || this.isFhdEditing) {\n                            upperContext.clearRect(0, 0, upperCanvas.width, upperCanvas.height);\n                            if (parent.activeObj.shape && textArea.style.display === 'none') {\n                                parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj } });\n                            }\n                        }\n                        if (this.isFhdEditing) {\n                            var strokeColor = parent.pointColl[n].strokeColor;\n                            parent.notify('freehand-draw', { prop: 'hoverFhd', onPropertyChange: false,\n                                value: { strokeColor: strokeColor, strokeWidth: parent.pointColl[n].strokeWidth } });\n                        }\n                        this.isFhdPoint = false;\n                    }\n                }\n            }\n            if (isEntered) {\n                break;\n            }\n        }\n    };\n    Selection.prototype.setCursorFromObj = function (x, y, obj, upperCanvas, isCropSelection) {\n        var parent = this.parent;\n        for (var i = 0, len = obj.length; i < len; i++) {\n            if (parent.cursor === 'move') {\n                return;\n            }\n            var actObj = extend({}, obj[i], {}, true);\n            this.cursorTargetId = actObj.currIndex;\n            if (actObj.shape === 'line' || actObj.shape === 'arrow') {\n                this.setCursorForLineArrow(actObj, x, y, upperCanvas);\n            }\n            else if (actObj.shape === 'path') {\n                this.setCursorForPath(actObj, x, y, upperCanvas);\n            }\n            else if (!isNullOrUndefined(actObj.rotatedAngle) && actObj.rotatedAngle !== 0) {\n                this.setCursorForRotatedObject(actObj, x, y, upperCanvas);\n            }\n            else {\n                upperCanvas.style.cursor = parent.cursor = this.getMouseCursor(actObj, x, y, isCropSelection, true);\n            }\n        }\n    };\n    Selection.prototype.isInside = function (x, y, z1, z2, z3, z4) {\n        var x1 = Math.min(z1, z3);\n        var x2 = Math.max(z1, z3);\n        var y1 = Math.min(z2, z4);\n        var y2 = Math.max(z2, z4);\n        if ((x1 <= x && x <= x2) && (y1 <= y && y <= y2)) {\n            return true;\n        }\n        else {\n            return false;\n        }\n    };\n    Selection.prototype.updateActivePoint = function (x, y, isCropSelection) {\n        var parent = this.parent;\n        var obj = { width: 0, height: 0 };\n        parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false,\n            value: { width: parent.activeObj.activePoint.width, height: parent.activeObj.activePoint.height, obj: obj } });\n        var maxDimension = obj;\n        var previousShapeSettings = this.updatePrevShapeSettings();\n        var shapeResizingArgs = { action: 'resize', previousShapeSettings: previousShapeSettings };\n        var shapeMovingArgs = { action: 'move', previousShapeSettings: previousShapeSettings };\n        this.shapeResizingArgs = shapeResizingArgs;\n        this.shapeMovingArgs = shapeMovingArgs;\n        if (parent.activeObj.shape === 'text' && this.dragElement !== '') {\n            parent.notify('shape', { prop: 'updateFontRatio', onPropertyChange: false,\n                value: { obj: parent.activeObj, isTextArea: null } });\n        }\n        if (this.currentDrawingShape !== '' && (this.dragElement === '' || this.dragElement === 'move')) {\n            if (parent.activeObj.shape === 'line' || parent.activeObj.shape === 'arrow' ||\n                parent.activeObj.shape === 'path') {\n                this.dragElement = 'e-resize';\n            }\n            else {\n                if (x > parent.activeObj.activePoint.startX && y > parent.activeObj.activePoint.startY) {\n                    this.dragElement = 'se-resize';\n                }\n                else if (x < parent.activeObj.activePoint.startX && y > parent.activeObj.activePoint.startY) {\n                    this.dragElement = 'sw-resize';\n                }\n                else if (x > parent.activeObj.activePoint.startX && y < parent.activeObj.activePoint.startY) {\n                    this.dragElement = 'ne-resize';\n                }\n                else if (x < parent.activeObj.activePoint.startX && y < parent.activeObj.activePoint.startY) {\n                    this.dragElement = 'nw-resize';\n                }\n            }\n        }\n        if (parent.activeObj.shape === 'arrow') {\n            if (Math.atan2(x - parent.lowerCanvas.width / 2, y - parent.lowerCanvas.height / 2) > 0) {\n                parent.activeObj.rotatedAngle = -Math.atan2(x - parent.lowerCanvas.width / 2, y - parent.lowerCanvas.height / 2);\n            }\n            else {\n                parent.activeObj.rotatedAngle = Math.abs(Math.atan2(x - parent.lowerCanvas.width / 2, y - parent.lowerCanvas.height / 2));\n            }\n        }\n        var degree;\n        var isHorizontalflip = false;\n        var isVerticalflip = false;\n        switch (this.dragElement.toLowerCase()) {\n            case 'nw-resize':\n                this.updateNWPoints(x, y, maxDimension);\n                parent.notify('shape', { prop: 'updateArrowDirection', onPropertyChange: false,\n                    value: { obj: parent.activeObj, flip: null, rotatedDegree: null } });\n                this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'resize');\n                break;\n            case 'n-resize':\n                this.updateNPoints(x, y);\n                parent.notify('shape', { prop: 'updateArrowDirection', onPropertyChange: false,\n                    value: { obj: parent.activeObj, flip: null, rotatedDegree: null } });\n                this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'resize');\n                break;\n            case 'ne-resize':\n                this.updateNEPoints(x, y, maxDimension);\n                parent.notify('shape', { prop: 'updateArrowDirection', onPropertyChange: false,\n                    value: { obj: parent.activeObj, flip: null, rotatedDegree: null } });\n                this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'resize');\n                break;\n            case 'w-resize':\n                this.updateWPoints(x, y);\n                parent.notify('shape', { prop: 'updateArrowDirection', onPropertyChange: false,\n                    value: { obj: parent.activeObj, flip: null, rotatedDegree: null } });\n                this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'resize');\n                break;\n            case 'e-resize':\n                this.updateEPoints(x, y);\n                parent.notify('shape', { prop: 'updateArrowDirection', onPropertyChange: false,\n                    value: { obj: parent.activeObj, flip: null, rotatedDegree: null } });\n                this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'resize');\n                break;\n            case 'sw-resize':\n                this.updateSWPoints(x, y, maxDimension);\n                parent.notify('shape', { prop: 'updateArrowDirection', onPropertyChange: false,\n                    value: { obj: parent.activeObj, flip: null, rotatedDegree: null } });\n                this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'resize');\n                break;\n            case 's-resize':\n                this.updateSPoints(x, y);\n                parent.notify('shape', { prop: 'updateArrowDirection', onPropertyChange: false,\n                    value: { obj: parent.activeObj, flip: null, rotatedDegree: null } });\n                this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'resize');\n                break;\n            case 'se-resize':\n                this.updateSEPoints(x, y, maxDimension);\n                parent.notify('shape', { prop: 'updateArrowDirection', onPropertyChange: false,\n                    value: { obj: parent.activeObj, flip: null, rotatedDegree: null } });\n                this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'resize');\n                break;\n            case 'grabbing':\n                if (Math.atan2(x - (parent.activeObj.activePoint.startX + (parent.activeObj.activePoint.width / 2)), y - (parent.activeObj.activePoint.startY + (parent.activeObj.activePoint.height / 2))) > 0) {\n                    parent.activeObj.rotatedAngle = -Math.atan2(x - (parent.activeObj.activePoint.startX + (parent.activeObj.activePoint.width\n                        / 2)), y - (parent.activeObj.activePoint.startY + (parent.activeObj.activePoint.height / 2)));\n                }\n                else {\n                    parent.activeObj.rotatedAngle = Math.abs(Math.atan2(x - (parent.activeObj.activePoint.startX +\n                        (parent.activeObj.activePoint.width / 2)), y - (parent.activeObj.activePoint.startY +\n                        (parent.activeObj.activePoint.height / 2))));\n                }\n                if (parent.activeObj.shapeDegree === 0) {\n                    degree = parent.transform.degree;\n                }\n                else {\n                    degree = parent.transform.degree - parent.activeObj.shapeDegree;\n                }\n                if (degree < 0) {\n                    degree = 360 + degree;\n                }\n                for (var i = 0, len = parent.activeObj.flipObjColl.length; i < len; i++) {\n                    if (parent.activeObj.flipObjColl[i].toLowerCase() === 'horizontal') {\n                        isHorizontalflip = true;\n                    }\n                    else if (parent.activeObj.flipObjColl[i].toLowerCase() === 'vertical') {\n                        isVerticalflip = true;\n                    }\n                }\n                parent.activeObj.rotatedAngle -= (degree * (Math.PI / 180));\n                if (degree === 0 || degree === 360) {\n                    if (isVerticalflip) {\n                        parent.activeObj.rotatedAngle -= (180 * (Math.PI / 180));\n                    }\n                }\n                else if (degree === 90 || degree === -270) {\n                    if (isHorizontalflip) {\n                        parent.activeObj.rotatedAngle -= (180 * (Math.PI / 180));\n                    }\n                }\n                else if (degree === 180 || degree === -180) {\n                    if (isVerticalflip) {\n                        parent.activeObj.rotatedAngle -= (180 * (Math.PI / 180));\n                    }\n                }\n                else if (degree === 270 || degree === -90) {\n                    if (isHorizontalflip) {\n                        parent.activeObj.rotatedAngle -= (180 * (Math.PI / 180));\n                    }\n                }\n                break;\n            case 'pathdrag':\n                if (!isNullOrUndefined(this.pathAdjustedIndex)) {\n                    parent.activeObj.pointColl[this.pathAdjustedIndex].x = x;\n                    parent.activeObj.pointColl[this.pathAdjustedIndex].y = y;\n                }\n                break;\n            default:\n                if (!isCropSelection && !parent.currObjType.isCustomCrop) {\n                    if (this.dragPoint.startX) {\n                        var width = (this.dragPoint.endX - this.previousPoint.x);\n                        var height = (this.dragPoint.endY - this.previousPoint.y);\n                        parent.activeObj.activePoint.startX += width;\n                        parent.activeObj.activePoint.endX += width;\n                        parent.activeObj.activePoint.startY += height;\n                        parent.activeObj.activePoint.endY += height;\n                        if (parent.activeObj.shape !== 'line' && parent.activeObj.shape !== 'arrow' &&\n                            parent.activeObj.rotationCirclePointColl) {\n                            parent.activeObj.rotationCirclePointColl.x += width;\n                            parent.activeObj.rotationCirclePointColl.y += height;\n                            parent.activeObj.rotationCirclePoint.x += width;\n                            parent.activeObj.rotationCirclePoint.y += height;\n                        }\n                        if (parent.activeObj.shape === 'path') {\n                            for (var i = 0, len = parent.activeObj.pointColl.length; i < len; i++) {\n                                parent.activeObj.pointColl[i].x += width;\n                                parent.activeObj.pointColl[i].y += height;\n                            }\n                        }\n                        if (!this.isPreventDragging && (parent.activeObj.activePoint.startX < parent.img.destLeft ||\n                            parent.activeObj.activePoint.startY < parent.img.destTop || parent.activeObj.activePoint.endX >\n                            parent.img.destLeft + parent.img.destWidth || parent.activeObj.activePoint.endY > parent.img.destTop\n                            + parent.img.destHeight)) {\n                            parent.activeObj.activePoint.startX -= width;\n                            parent.activeObj.activePoint.endX -= width;\n                            parent.activeObj.activePoint.startY -= height;\n                            parent.activeObj.activePoint.endY -= height;\n                            if (parent.activeObj.shape !== 'line' && parent.activeObj.shape !== 'arrow' &&\n                                parent.activeObj.rotationCirclePointColl) {\n                                parent.activeObj.rotationCirclePointColl.x -= width;\n                                parent.activeObj.rotationCirclePointColl.y -= height;\n                                parent.activeObj.rotationCirclePoint.x -= width;\n                                parent.activeObj.rotationCirclePoint.y -= height;\n                            }\n                            this.setDragWidth(width);\n                            this.setDragHeight(height);\n                        }\n                    }\n                    else {\n                        parent.activeObj.activePoint.startX = x < this.mouseDownPoint.x ? x : this.mouseDownPoint.x;\n                        parent.activeObj.activePoint.startY = y < this.mouseDownPoint.y ? y : this.mouseDownPoint.y;\n                        x = x < this.mouseDownPoint.x ? this.mouseDownPoint.x : x;\n                        y = y < this.mouseDownPoint.y ? this.mouseDownPoint.y : y;\n                        parent.activeObj.activePoint.endX = x;\n                        parent.activeObj.activePoint.endY = y;\n                    }\n                    this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'move');\n                }\n                break;\n        }\n    };\n    Selection.prototype.triggerShapeChange = function (shapeResizingArgs, shapeMovingArgs, type) {\n        var parent = this.parent;\n        parent.activeObj.activePoint.width = parent.activeObj.activePoint.endX - parent.activeObj.activePoint.startX;\n        parent.activeObj.activePoint.height = parent.activeObj.activePoint.endY - parent.activeObj.activePoint.startY;\n        var currentShapeSettings = this.updatePrevShapeSettings();\n        shapeResizingArgs.currentShapeSettings = this.shapeResizingArgs.currentShapeSettings = currentShapeSettings;\n        shapeMovingArgs.currentShapeSettings = this.shapeMovingArgs.currentShapeSettings = currentShapeSettings;\n        if (type === 'resize') {\n            this.isCropSelection = false;\n            var splitWords = void 0;\n            if (parent.activeObj.shape !== undefined) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (splitWords !== undefined && splitWords[0] === 'crop') {\n                this.isCropSelection = true;\n            }\n            if (!this.isCropSelection && this.parent.eventType !== 'resize' && isBlazor() && parent.events && this.parent.events.onShapeResizeStart.hasDelegate === true) {\n                shapeResizingArgs.action = this.currentDrawingShape !== '' ? 'drawing' : 'resize-start';\n                /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                parent.dotNetRef.invokeMethodAsync('ShapeEventAsync', 'OnShapeResizeStart', shapeResizingArgs).then(function (shapeResizingArgs) {\n                    parent.notify('shape', { prop: 'updateShapeChangeEventArgs', onPropertyChange: false,\n                        value: { shapeSettings: shapeResizingArgs.currentShapeSettings } });\n                });\n            }\n            else if (!this.isCropSelection) {\n                if (this.currentDrawingShape !== '') {\n                    shapeResizingArgs.action = 'drawing';\n                }\n                parent.trigger('shapeChanging', shapeResizingArgs);\n                parent.notify('shape', { prop: 'updateShapeChangeEventArgs', onPropertyChange: false,\n                    value: { shapeSettings: shapeResizingArgs.currentShapeSettings } });\n            }\n            else {\n                var selectionResizingArgs = { action: shapeResizingArgs.action,\n                    previousSelectionSettings: { type: parent.getSelectionType(parent.activeObj.shape),\n                        startX: shapeResizingArgs.previousShapeSettings.startX,\n                        startY: shapeResizingArgs.previousShapeSettings.startY,\n                        width: shapeResizingArgs.previousShapeSettings.width,\n                        height: shapeResizingArgs.previousShapeSettings.height },\n                    currentSelectionSettings: { type: parent.getSelectionType(parent.activeObj.shape),\n                        startX: shapeResizingArgs.currentShapeSettings.startX,\n                        startY: shapeResizingArgs.currentShapeSettings.startY,\n                        width: shapeResizingArgs.currentShapeSettings.width,\n                        height: shapeResizingArgs.currentShapeSettings.height } };\n                this.selectionResizingArgs = selectionResizingArgs;\n                if (isBlazor() && isNullOrUndefined(this.parent.eventType) && parent.events &&\n                    parent.events.onSelectionResizeStart.hasDelegate === true) {\n                    selectionResizingArgs.action = 'resize-start';\n                    /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                    parent.dotNetRef.invokeMethodAsync('SelectionEventAsync', 'OnSelectionResizeStart', selectionResizingArgs).then(function (selectionResizingArgs) {\n                        parent.notify('shape', { prop: 'updSelChangeEventArgs', onPropertyChange: false,\n                            value: { selectionSettings: selectionResizingArgs.currentSelectionSettings } });\n                    });\n                }\n                else {\n                    parent.trigger('selectionChanging', selectionResizingArgs);\n                    parent.notify('shape', { prop: 'updSelChangeEventArgs', onPropertyChange: false,\n                        value: { selectionSettings: selectionResizingArgs.currentSelectionSettings } });\n                }\n            }\n        }\n        else {\n            if (isBlazor() && isNullOrUndefined(this.parent.eventType) && parent.events &&\n                parent.events.onShapeDragStart.hasDelegate === true) {\n                shapeMovingArgs.action = 'drag-start';\n                /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                parent.dotNetRef.invokeMethodAsync('ShapeEventAsync', 'OnShapeDragStart', shapeMovingArgs).then(function (shapeMovingArgs) {\n                    parent.notify('shape', { prop: 'updateShapeChangeEventArgs', onPropertyChange: false,\n                        value: { shapeSettings: shapeMovingArgs.currentShapeSettings } });\n                });\n            }\n            else {\n                parent.trigger('shapeChanging', shapeMovingArgs);\n                parent.notify('shape', { prop: 'updateShapeChangeEventArgs', onPropertyChange: false,\n                    value: { shapeSettings: shapeMovingArgs.currentShapeSettings } });\n            }\n        }\n        this.parent.eventType = type;\n    };\n    Selection.prototype.setDragWidth = function (width) {\n        var parent = this.parent;\n        var tempWidth = width;\n        if (tempWidth >= 0) {\n            for (var i = 0; i < tempWidth; i++) {\n                width = tempWidth - i;\n                parent.activeObj.activePoint.startX += width;\n                parent.activeObj.activePoint.endX += width;\n                if (parent.activeObj.activePoint.startX >= parent.img.destLeft &&\n                    parent.activeObj.activePoint.endX <= parent.img.destLeft + parent.img.destWidth) {\n                    break;\n                }\n                else {\n                    parent.activeObj.activePoint.startX -= width;\n                    parent.activeObj.activePoint.endX -= width;\n                }\n            }\n        }\n        else {\n            for (var i = 1; i < Math.abs(tempWidth); i++) {\n                width = tempWidth + i;\n                parent.activeObj.activePoint.startX += width;\n                parent.activeObj.activePoint.endX += width;\n                if (parent.activeObj.activePoint.startX >= parent.img.destLeft &&\n                    parent.activeObj.activePoint.endX <= parent.img.destLeft + parent.img.destWidth) {\n                    break;\n                }\n                else {\n                    parent.activeObj.activePoint.startX -= width;\n                    parent.activeObj.activePoint.endX -= width;\n                }\n            }\n        }\n    };\n    Selection.prototype.setDragHeight = function (height) {\n        var parent = this.parent;\n        var tempHeight = height;\n        if (tempHeight >= 0) {\n            for (var i = 1; i < tempHeight; i++) {\n                height = tempHeight - i;\n                parent.activeObj.activePoint.startY += height;\n                parent.activeObj.activePoint.endY += height;\n                if (parent.activeObj.activePoint.startY >= parent.img.destTop &&\n                    parent.activeObj.activePoint.endY <= parent.img.destTop + parent.img.destHeight) {\n                    break;\n                }\n                else {\n                    parent.activeObj.activePoint.startY -= height;\n                    parent.activeObj.activePoint.endY -= height;\n                }\n            }\n        }\n        else {\n            for (var i = 0; i < Math.abs(tempHeight); i++) {\n                height = tempHeight + i;\n                parent.activeObj.activePoint.startY += height;\n                parent.activeObj.activePoint.endY += height;\n                if (parent.activeObj.activePoint.startY >= parent.img.destTop &&\n                    parent.activeObj.activePoint.endY <= parent.img.destTop + parent.img.destHeight) {\n                    break;\n                }\n                else {\n                    parent.activeObj.activePoint.startY -= height;\n                    parent.activeObj.activePoint.endY -= height;\n                }\n            }\n        }\n    };\n    Selection.prototype.limitDrag = function (isStart) {\n        var parent = this.parent;\n        var startX = isStart ? parent.activeObj.activePoint.startX : parent.activeObj.activePoint.endX;\n        var startY = isStart ? parent.activeObj.activePoint.startY : parent.activeObj.activePoint.endY;\n        var endX = isStart ? parent.activeObj.activePoint.endX : parent.activeObj.activePoint.startX;\n        var endY = isStart ? parent.activeObj.activePoint.endY : parent.activeObj.activePoint.startY;\n        if (startX < parent.img.destLeft) {\n            startX = parent.img.destLeft;\n        }\n        if (startY < parent.img.destTop) {\n            startY = parent.img.destTop;\n        }\n        if (endX > parent.img.destLeft + parent.img.destWidth) {\n            endX = parent.img.destLeft + parent.img.destWidth;\n        }\n        if (endY > parent.img.destTop + parent.img.destHeight) {\n            endY = parent.img.destTop + parent.img.destHeight;\n        }\n        if (isStart) {\n            parent.activeObj.activePoint.startX = startX;\n            parent.activeObj.activePoint.startY = startY;\n            parent.activeObj.activePoint.endX = endX;\n            parent.activeObj.activePoint.endY = endY;\n        }\n        else {\n            parent.activeObj.activePoint.startX = endX;\n            parent.activeObj.activePoint.startY = endY;\n            parent.activeObj.activePoint.endX = startX;\n            parent.activeObj.activePoint.endY = startY;\n        }\n    };\n    Selection.prototype.preventDraggingInvertly = function () {\n        var parent = this.parent;\n        if (!this.isPreventDragging && parent.activeObj.rotatedAngle === 0) {\n            this.limitDrag(true);\n            if (parent.activeObj.shape === 'line' || parent.activeObj.shape === 'arrow' ||\n                parent.activeObj.shape === 'path') {\n                this.limitDrag(false);\n            }\n        }\n    };\n    Selection.prototype.preventTextDraggingInvertly = function () {\n        var parent = this.parent;\n        var isLimiting = false;\n        if (!this.isPreventDragging) {\n            if (parent.activeObj.activePoint.startX < parent.img.destLeft ||\n                parent.activeObj.activePoint.startY < parent.img.destTop ||\n                parent.activeObj.activePoint.endX > parent.img.destLeft + parent.img.destWidth ||\n                parent.activeObj.activePoint.endY > parent.img.destTop + parent.img.destHeight) {\n                isLimiting = true;\n            }\n        }\n        return isLimiting;\n    };\n    Selection.prototype.preventInverseResize = function (tempActiveObj) {\n        var parent = this.parent;\n        if (parent.activeObj.activePoint.width < 0) {\n            parent.activeObj.activePoint.width = 0;\n            parent.activeObj.activePoint.startX = tempActiveObj.activePoint.startX;\n            parent.activeObj.activePoint.endX = tempActiveObj.activePoint.endX;\n        }\n        if (parent.activeObj.activePoint.height < 0) {\n            parent.activeObj.activePoint.height = 0;\n            parent.activeObj.activePoint.startY = tempActiveObj.activePoint.startY;\n            parent.activeObj.activePoint.endY = tempActiveObj.activePoint.endY;\n        }\n    };\n    Selection.prototype.getScaleRatio = function (scale) {\n        var parent = this.parent;\n        var point = { x: scale, y: scale };\n        if (parent.activeObj.shape && parent.activeObj.shape !== 'crop-custom' &&\n            parent.activeObj.shape !== 'crop-circle' && parent.activeObj.shape !== 'crop-square') {\n            var ratio = parent.activeObj.shape.split('-');\n            if (ratio.length > 1) {\n                ratio = ratio[1].split(':');\n                var newScale = scale / (parseInt(ratio[1], 10));\n                point.x = newScale * (parseInt(ratio[0], 10));\n                point.y = newScale * (parseInt(ratio[1], 10));\n            }\n        }\n        return point;\n    };\n    Selection.prototype.updateNWPoints = function (x, y, maxDimension) {\n        var parent = this.parent;\n        var diff;\n        var width;\n        var height;\n        var scale;\n        var percentage;\n        var prevDiffX = this.diffPoint.x;\n        var prevDiffY = this.diffPoint.y;\n        var tempActiveObj = extend({}, parent.activeObj, null, true);\n        if (parent.activeObj.shape === 'text') {\n            if (this.oldPoint.x === undefined && this.oldPoint.y === undefined) {\n                this.diffPoint.x = parent.activeObj.activePoint.startX - x;\n                this.diffPoint.y = parent.activeObj.activePoint.startY - y;\n            }\n            else {\n                this.diffPoint.x = this.oldPoint.x - x;\n                this.diffPoint.y = this.oldPoint.y - y;\n            }\n            this.oldPoint.x = x;\n            this.oldPoint.y = y;\n            if (this.diffPoint.x <= prevDiffX && this.diffPoint.y >= prevDiffY) {\n                diff = Math.min(this.diffPoint.x, this.diffPoint.y);\n            }\n            else {\n                diff = Math.max(this.diffPoint.x, this.diffPoint.y);\n            }\n            percentage = (diff / 10);\n            parent.activeObj.activePoint.startX -= (maxDimension.width / 100) * percentage;\n            parent.activeObj.activePoint.startY -= (maxDimension.height / 100) * percentage;\n            if (this.preventTextDraggingInvertly()) {\n                parent.activeObj.activePoint.startX += (maxDimension.width / 100) * percentage;\n                parent.activeObj.activePoint.startY += (maxDimension.height / 100) * percentage;\n            }\n            parent.activeObj.activePoint.width = parent.activeObj.activePoint.endX - parent.activeObj.activePoint.startX;\n            parent.activeObj.activePoint.height = parent.activeObj.activePoint.endY - parent.activeObj.activePoint.startY;\n            parent.notify('shape', { prop: 'updateFontSize', onPropertyChange: false,\n                value: { obj: parent.activeObj } });\n        }\n        else {\n            var splitWords = void 0;\n            if (parent.activeObj.shape !== undefined) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (parent.activeObj.shape === 'crop-custom' || (parent.activeObj.shape !== undefined && splitWords[0] !== 'crop')) {\n                this.adjustNWPoints(parent.activeObj.activePoint, x, y, parent.activeObj.rotatedAngle);\n                if (parent.activeObj.activePoint.startX > parent.activeObj.activePoint.endX) {\n                    var temp = parent.activeObj.activePoint.startX;\n                    parent.activeObj.activePoint.startX = parent.activeObj.activePoint.endX;\n                    parent.activeObj.activePoint.endX = temp;\n                    this.dragElement = parent.upperCanvas.style.cursor = parent.cursor = 'ne-resize';\n                }\n                if (parent.activeObj.activePoint.startY > parent.activeObj.activePoint.endY) {\n                    var temp = parent.activeObj.activePoint.startY;\n                    parent.activeObj.activePoint.startY = parent.activeObj.activePoint.endY;\n                    parent.activeObj.activePoint.endY = temp;\n                    this.dragElement = parent.upperCanvas.style.cursor = parent.cursor = 'sw-resize';\n                }\n                this.preventDraggingInvertly();\n            }\n            else {\n                if (parent.activeObj.activePoint.startX < x && parent.activeObj.activePoint.startY < y) {\n                    width = x - parent.activeObj.activePoint.startX;\n                    height = y - parent.activeObj.activePoint.startY;\n                    scale = Math.min(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    parent.activeObj.activePoint.startX += newScale.x;\n                    parent.activeObj.activePoint.startY += newScale.y;\n                    var left = parent.img.destLeft > 0 ? parent.img.destLeft : 0;\n                    var top_1 = parent.img.destTop > 0 ? parent.img.destTop : 0;\n                    if (parent.activeObj.activePoint.startX < left || parent.activeObj.activePoint.startY < top_1) {\n                        parent.activeObj.activePoint.startX -= newScale.x;\n                        parent.activeObj.activePoint.startY -= newScale.y;\n                    }\n                }\n                else {\n                    width = parent.activeObj.activePoint.startX - x;\n                    height = y - parent.activeObj.activePoint.endY;\n                    scale = Math.max(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    parent.activeObj.activePoint.startX -= newScale.x;\n                    parent.activeObj.activePoint.startY -= newScale.y;\n                    var left = parent.img.destLeft > 0 ? parent.img.destLeft : 0;\n                    var top_2 = parent.img.destTop > 0 ? parent.img.destTop : 0;\n                    if (parent.activeObj.activePoint.startX < left || parent.activeObj.activePoint.startY < top_2) {\n                        parent.activeObj.activePoint.startX += newScale.x;\n                        parent.activeObj.activePoint.startY += newScale.y;\n                    }\n                }\n            }\n            parent.activeObj.activePoint.width = parent.activeObj.activePoint.endX - parent.activeObj.activePoint.startX;\n            parent.activeObj.activePoint.height = parent.activeObj.activePoint.endY - parent.activeObj.activePoint.startY;\n            this.preventInverseResize(tempActiveObj);\n        }\n    };\n    Selection.prototype.updateNPoints = function (x, y) {\n        var parent = this.parent;\n        var width;\n        var height;\n        var scale;\n        if (parent.activeObj.shape !== 'text') {\n            var splitWords = void 0;\n            if (parent.activeObj.shape) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (parent.activeObj.shape === 'crop-custom' || (parent.activeObj.shape && splitWords[0] !== 'crop')) {\n                if (parent.activeObj.shape !== 'line' && parent.activeObj.shape !== 'arrow' && parent.activeObj.shape !== 'path' &&\n                    parent.activeObj.rotatedAngle !== 0 && this.dragPoint.startX) {\n                    if (this.dragPoint.startX && this.dragPoint.startY) {\n                        this.previousPoint.x = this.dragPoint.endX;\n                        this.previousPoint.y = this.dragPoint.endY;\n                        this.dragPoint.endX = x;\n                        this.dragPoint.endY = y;\n                    }\n                    width = (this.dragPoint.endX - this.previousPoint.x);\n                    height = (this.dragPoint.endY - this.previousPoint.y);\n                    this.adjustRotationPoints(parent.activeObj.activePoint, width, height, parent.activeObj.rotatedAngle);\n                }\n                else {\n                    parent.activeObj.activePoint.startY = y;\n                    parent.activeObj.activePoint.height = parent.activeObj.activePoint.endY - parent.activeObj.activePoint.startY;\n                }\n                if (parent.activeObj.activePoint.startY > parent.activeObj.activePoint.endY) {\n                    var temp = parent.activeObj.activePoint.startY;\n                    parent.activeObj.activePoint.startY = parent.activeObj.activePoint.endY;\n                    parent.activeObj.activePoint.endY = temp;\n                    this.dragElement = this.resizedElement = 's-resize';\n                }\n                this.preventDraggingInvertly();\n            }\n            else {\n                if (parent.activeObj.activePoint.endX > x && parent.activeObj.activePoint.startY < y) {\n                    width = parent.activeObj.activePoint.endX - x;\n                    height = y - parent.activeObj.activePoint.startY;\n                    scale = Math.min(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    parent.activeObj.activePoint.endX -= newScale.x;\n                    parent.activeObj.activePoint.startY += newScale.y;\n                    if (parent.activeObj.activePoint.endX > (parent.img.destLeft + parent.img.destWidth) ||\n                        parent.activeObj.activePoint.startY < parent.img.destTop) {\n                        parent.activeObj.activePoint.endX += newScale.x;\n                        parent.activeObj.activePoint.startY -= newScale.y;\n                    }\n                }\n                else {\n                    width = x - parent.activeObj.activePoint.endX;\n                    height = parent.activeObj.activePoint.startY - y;\n                    scale = Math.max(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    parent.activeObj.activePoint.endX += newScale.x;\n                    parent.activeObj.activePoint.startY -= newScale.y;\n                    if (parent.activeObj.activePoint.endX > (parent.img.destLeft + parent.img.destWidth) ||\n                        parent.activeObj.activePoint.startY < parent.img.destTop) {\n                        parent.activeObj.activePoint.endX -= newScale.x;\n                        parent.activeObj.activePoint.startY += newScale.y;\n                    }\n                }\n                parent.activeObj.activePoint.width = parent.activeObj.activePoint.endX - parent.activeObj.activePoint.startX;\n                parent.activeObj.activePoint.height = parent.activeObj.activePoint.endY - parent.activeObj.activePoint.startY;\n            }\n        }\n    };\n    Selection.prototype.updateNEPoints = function (x, y, maxDimension) {\n        var parent = this.parent;\n        var diff;\n        var width;\n        var height;\n        var scale;\n        var percentage;\n        var prevDiffX = this.diffPoint.x;\n        var prevDiffY = this.diffPoint.y;\n        var tempActiveObj = extend({}, parent.activeObj, null, true);\n        if (parent.activeObj.shape === 'text') {\n            if (this.oldPoint.x === undefined && this.oldPoint.y === undefined) {\n                this.diffPoint.x = x - parent.activeObj.activePoint.endX;\n                this.diffPoint.y = parent.activeObj.activePoint.startY - y;\n            }\n            else {\n                this.diffPoint.x = x - this.oldPoint.x;\n                this.diffPoint.y = this.oldPoint.y - y;\n            }\n            this.oldPoint.x = x;\n            this.oldPoint.y = y;\n            if (this.diffPoint.x <= prevDiffX && this.diffPoint.y >= prevDiffY) {\n                diff = Math.min(this.diffPoint.x, this.diffPoint.y);\n            }\n            else {\n                diff = Math.max(this.diffPoint.x, this.diffPoint.y);\n            }\n            percentage = (diff / 10);\n            parent.activeObj.activePoint.endX += (maxDimension.width / 100) * percentage;\n            parent.activeObj.activePoint.startY -= (maxDimension.height / 100) * percentage;\n            if (this.preventTextDraggingInvertly()) {\n                parent.activeObj.activePoint.endX -= (maxDimension.width / 100) * percentage;\n                parent.activeObj.activePoint.startY += (maxDimension.height / 100) * percentage;\n            }\n            parent.activeObj.activePoint.width = parent.activeObj.activePoint.endX - parent.activeObj.activePoint.startX;\n            parent.activeObj.activePoint.height = parent.activeObj.activePoint.endY - parent.activeObj.activePoint.startY;\n            parent.notify('shape', { prop: 'updateFontSize', onPropertyChange: false,\n                value: { obj: parent.activeObj } });\n        }\n        else {\n            var splitWords = void 0;\n            if (parent.activeObj.shape) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (parent.activeObj.shape === 'crop-custom' || (parent.activeObj.shape !== undefined && splitWords[0] !== 'crop')) {\n                this.adjustNEPoints(parent.activeObj.activePoint, x, y, parent.activeObj.rotatedAngle);\n                if (parent.activeObj.activePoint.endX < parent.activeObj.activePoint.startX) {\n                    var temp = parent.activeObj.activePoint.endX;\n                    parent.activeObj.activePoint.endX = parent.activeObj.activePoint.startX;\n                    parent.activeObj.activePoint.startX = temp;\n                    this.dragElement = parent.upperCanvas.style.cursor = parent.cursor = 'nw-resize';\n                }\n                if (parent.activeObj.activePoint.startY > parent.activeObj.activePoint.endY) {\n                    var temp = parent.activeObj.activePoint.startY;\n                    parent.activeObj.activePoint.startY = parent.activeObj.activePoint.endY;\n                    parent.activeObj.activePoint.endY = temp;\n                    this.dragElement = parent.upperCanvas.style.cursor = parent.cursor = 'se-resize';\n                }\n                this.preventDraggingInvertly();\n            }\n            else {\n                if (parent.activeObj.activePoint.endX > x && parent.activeObj.activePoint.startY < y) {\n                    width = parent.activeObj.activePoint.endX - x;\n                    height = y - parent.activeObj.activePoint.startY;\n                    scale = Math.min(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    parent.activeObj.activePoint.endX -= newScale.x;\n                    parent.activeObj.activePoint.startY += newScale.y;\n                    var endX = parent.img.destLeft + parent.img.destWidth < parent.lowerCanvas.width ?\n                        parent.img.destLeft + parent.img.destWidth : parent.lowerCanvas.width;\n                    var endY = parent.img.destTop > 0 ? parent.img.destTop : 0;\n                    if (parent.activeObj.activePoint.endX > endX || parent.activeObj.activePoint.startY < endY) {\n                        parent.activeObj.activePoint.endX += newScale.x;\n                        parent.activeObj.activePoint.startY -= newScale.y;\n                    }\n                }\n                else {\n                    width = x - parent.activeObj.activePoint.endX;\n                    height = parent.activeObj.activePoint.startY - y;\n                    scale = Math.max(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    parent.activeObj.activePoint.endX += newScale.x;\n                    parent.activeObj.activePoint.startY -= newScale.y;\n                    var endX = parent.img.destLeft + parent.img.destWidth < parent.lowerCanvas.width ?\n                        parent.img.destLeft + parent.img.destWidth : parent.lowerCanvas.width;\n                    var endY = parent.img.destTop > 0 ? parent.img.destTop : 0;\n                    if (parent.activeObj.activePoint.endX > endX || parent.activeObj.activePoint.startY < endY) {\n                        parent.activeObj.activePoint.endX -= newScale.x;\n                        parent.activeObj.activePoint.startY += newScale.y;\n                    }\n                }\n            }\n            parent.activeObj.activePoint.width = parent.activeObj.activePoint.endX - parent.activeObj.activePoint.startX;\n            parent.activeObj.activePoint.height = parent.activeObj.activePoint.endY - parent.activeObj.activePoint.startY;\n            this.preventInverseResize(tempActiveObj);\n        }\n    };\n    Selection.prototype.updateWPoints = function (x, y) {\n        var parent = this.parent;\n        var width;\n        var height;\n        var scale;\n        if (parent.activeObj.shape !== 'text') {\n            var splitWords = void 0;\n            if (parent.activeObj.shape) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (parent.activeObj.shape === 'crop-custom' || (parent.activeObj.shape && splitWords[0] !== 'crop')) {\n                if (parent.activeObj.shape !== 'line' && parent.activeObj.shape !== 'arrow' && parent.activeObj.shape !== 'path' &&\n                    parent.activeObj.rotatedAngle !== 0 && this.dragPoint.startX) {\n                    if (this.dragPoint.startX && this.dragPoint.startY) {\n                        this.previousPoint.x = this.dragPoint.endX;\n                        this.previousPoint.y = this.dragPoint.endY;\n                        this.dragPoint.endX = x;\n                        this.dragPoint.endY = y;\n                    }\n                    width = (this.dragPoint.endX - this.previousPoint.x);\n                    height = (this.dragPoint.endY - this.previousPoint.y);\n                    this.adjustRotationPoints(parent.activeObj.activePoint, width, height, parent.activeObj.rotatedAngle);\n                }\n                else {\n                    parent.activeObj.activePoint.startX = x;\n                    parent.activeObj.activePoint.width = parent.activeObj.activePoint.endX - parent.activeObj.activePoint.startX;\n                }\n                if (parent.activeObj.shape === 'line' || parent.activeObj.shape === 'arrow' || parent.activeObj.shape === 'path') {\n                    parent.activeObj.activePoint.startY = y;\n                    parent.activeObj.activePoint.height = parent.activeObj.activePoint.endY - parent.activeObj.activePoint.startY;\n                    if (this.adjustActObjForLineArrow()) {\n                        this.dragElement = 'e-resize';\n                        if (parent.activeObj.triangleDirection === 'right') {\n                            parent.activeObj.triangleDirection = 'left';\n                        }\n                        else if (parent.activeObj.triangleDirection === 'left') {\n                            parent.activeObj.triangleDirection = 'right';\n                        }\n                    }\n                }\n                else if (parent.activeObj.activePoint.startX > parent.activeObj.activePoint.endX) {\n                    var temp = parent.activeObj.activePoint.startX;\n                    parent.activeObj.activePoint.startX = parent.activeObj.activePoint.endX;\n                    parent.activeObj.activePoint.endX = temp;\n                    this.dragElement = this.resizedElement = 'e-resize';\n                }\n                this.preventDraggingInvertly();\n            }\n            else {\n                if (parent.activeObj.activePoint.startX < x && parent.activeObj.activePoint.endY > y) {\n                    width = x - parent.activeObj.activePoint.startX;\n                    height = parent.activeObj.activePoint.endY - y;\n                    scale = Math.min(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    parent.activeObj.activePoint.startX += newScale.x;\n                    parent.activeObj.activePoint.endY -= newScale.y;\n                    if (parent.activeObj.activePoint.startX < parent.img.destLeft || parent.activeObj.activePoint.endY >\n                        (parent.img.destTop + parent.img.destHeight)) {\n                        parent.activeObj.activePoint.startX -= newScale.x;\n                        parent.activeObj.activePoint.endY += newScale.y;\n                    }\n                }\n                else {\n                    width = parent.activeObj.activePoint.startX - x;\n                    height = y - parent.activeObj.activePoint.endY;\n                    scale = Math.max(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    parent.activeObj.activePoint.startX -= newScale.x;\n                    parent.activeObj.activePoint.endY += newScale.y;\n                    if (parent.activeObj.activePoint.startX < parent.img.destLeft || parent.activeObj.activePoint.endY >\n                        (parent.img.destTop + parent.img.destHeight)) {\n                        parent.activeObj.activePoint.startX += newScale.x;\n                        parent.activeObj.activePoint.endY -= newScale.y;\n                    }\n                }\n                parent.activeObj.activePoint.width = parent.activeObj.activePoint.endX - parent.activeObj.activePoint.startX;\n                parent.activeObj.activePoint.height = parent.activeObj.activePoint.endY - parent.activeObj.activePoint.startY;\n            }\n        }\n    };\n    Selection.prototype.updateEPoints = function (x, y) {\n        var parent = this.parent;\n        var width;\n        var height;\n        var scale;\n        if (parent.activeObj.shape !== 'text') {\n            var splitWords = void 0;\n            if (parent.activeObj.shape) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (parent.activeObj.shape === 'crop-custom' || (parent.activeObj.shape && splitWords[0] !== 'crop')) {\n                if (parent.activeObj.shape !== 'line' && parent.activeObj.shape !== 'arrow' && parent.activeObj.shape !== 'path' &&\n                    parent.activeObj.rotatedAngle !== 0 && this.dragPoint.startX) {\n                    if (this.dragPoint.startX && this.dragPoint.startY) {\n                        this.previousPoint.x = this.dragPoint.endX;\n                        this.previousPoint.y = this.dragPoint.endY;\n                        this.dragPoint.endX = x;\n                        this.dragPoint.endY = y;\n                    }\n                    width = (this.dragPoint.endX - this.previousPoint.x);\n                    height = (this.dragPoint.endY - this.previousPoint.y);\n                    this.adjustRotationPoints(parent.activeObj.activePoint, width, height, parent.activeObj.rotatedAngle);\n                }\n                else {\n                    parent.activeObj.activePoint.endX = x;\n                    parent.activeObj.activePoint.width = parent.activeObj.activePoint.endX - parent.activeObj.activePoint.startX;\n                }\n                if (parent.activeObj.shape === 'line' || parent.activeObj.shape === 'arrow' || parent.activeObj.shape === 'path') {\n                    parent.activeObj.activePoint.endY = y;\n                    parent.activeObj.activePoint.height = parent.activeObj.activePoint.endY - parent.activeObj.activePoint.startY;\n                    if (this.adjustActObjForLineArrow()) {\n                        this.dragElement = 'w-resize';\n                        if (parent.activeObj.triangleDirection === 'right') {\n                            parent.activeObj.triangleDirection = 'left';\n                        }\n                        else if (parent.activeObj.triangleDirection === 'left') {\n                            parent.activeObj.triangleDirection = 'right';\n                        }\n                    }\n                }\n                else if (parent.activeObj.activePoint.endX < parent.activeObj.activePoint.startX) {\n                    var temp = parent.activeObj.activePoint.endX;\n                    parent.activeObj.activePoint.endX = parent.activeObj.activePoint.startX;\n                    parent.activeObj.activePoint.startX = temp;\n                    this.dragElement = this.resizedElement = 'w-resize';\n                }\n                this.preventDraggingInvertly();\n            }\n            else {\n                if (parent.activeObj.activePoint.endX > x && parent.activeObj.activePoint.endY > y) {\n                    width = parent.activeObj.activePoint.endX - x;\n                    height = parent.activeObj.activePoint.endY - y;\n                    scale = Math.min(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    parent.activeObj.activePoint.endX -= newScale.x;\n                    parent.activeObj.activePoint.endY -= newScale.y;\n                    if (parent.activeObj.activePoint.endX > (parent.img.destLeft + parent.img.destWidth) ||\n                        parent.activeObj.activePoint.endY > (parent.img.destTop + parent.img.destHeight)) {\n                        parent.activeObj.activePoint.endX += newScale.x;\n                        parent.activeObj.activePoint.endY += newScale.y;\n                    }\n                }\n                else {\n                    width = x - parent.activeObj.activePoint.endX;\n                    height = y - parent.activeObj.activePoint.endY;\n                    scale = Math.max(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    parent.activeObj.activePoint.endX += newScale.x;\n                    parent.activeObj.activePoint.endY += newScale.y;\n                    if (parent.activeObj.activePoint.endX > (parent.img.destLeft + parent.img.destWidth) ||\n                        parent.activeObj.activePoint.endY > (parent.img.destTop + parent.img.destHeight)) {\n                        parent.activeObj.activePoint.endX -= newScale.x;\n                        parent.activeObj.activePoint.endY -= newScale.y;\n                    }\n                }\n                parent.activeObj.activePoint.width = parent.activeObj.activePoint.endX - parent.activeObj.activePoint.startX;\n                parent.activeObj.activePoint.height = parent.activeObj.activePoint.endY - parent.activeObj.activePoint.startY;\n            }\n        }\n    };\n    Selection.prototype.updateSWPoints = function (x, y, maxDimension) {\n        var parent = this.parent;\n        var diff;\n        var width;\n        var height;\n        var scale;\n        var percentage;\n        var prevDiffX = this.diffPoint.x;\n        var prevDiffY = this.diffPoint.y;\n        var tempActiveObj = extend({}, parent.activeObj, null, true);\n        if (parent.activeObj.shape === 'text') {\n            if (isNullOrUndefined(this.oldPoint.x) && isNullOrUndefined(this.oldPoint.y)) {\n                this.diffPoint.x = parent.activeObj.activePoint.startX - x;\n                this.diffPoint.y = y - parent.activeObj.activePoint.endY;\n            }\n            else {\n                this.diffPoint.x = this.oldPoint.x - x;\n                this.diffPoint.y = y - this.oldPoint.y;\n            }\n            this.oldPoint.x = x;\n            this.oldPoint.y = y;\n            if (this.diffPoint.x <= prevDiffX && this.diffPoint.y >= prevDiffY) {\n                diff = Math.min(this.diffPoint.x, this.diffPoint.y);\n            }\n            else {\n                diff = Math.max(this.diffPoint.x, this.diffPoint.y);\n            }\n            percentage = (diff / 10);\n            parent.activeObj.activePoint.startX -= (maxDimension.width / 100) * percentage;\n            parent.activeObj.activePoint.endY += (maxDimension.height / 100) * percentage;\n            if (this.preventTextDraggingInvertly()) {\n                parent.activeObj.activePoint.startX += (maxDimension.width / 100) * percentage;\n                parent.activeObj.activePoint.endY -= (maxDimension.height / 100) * percentage;\n            }\n            parent.activeObj.activePoint.width = parent.activeObj.activePoint.endX - parent.activeObj.activePoint.startX;\n            parent.activeObj.activePoint.height = parent.activeObj.activePoint.endY - parent.activeObj.activePoint.startY;\n            parent.notify('shape', { prop: 'updateFontSize', onPropertyChange: false,\n                value: { obj: parent.activeObj } });\n        }\n        else {\n            var splitWords = void 0;\n            if (parent.activeObj.shape !== undefined) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (parent.activeObj.shape === 'crop-custom' || (parent.activeObj.shape !== undefined && splitWords[0] !== 'crop')) {\n                this.adjustSWPoints(parent.activeObj.activePoint, x, y, parent.activeObj.rotatedAngle);\n                if (parent.activeObj.activePoint.startX > parent.activeObj.activePoint.endX) {\n                    var temp = parent.activeObj.activePoint.startX;\n                    parent.activeObj.activePoint.startX = parent.activeObj.activePoint.endX;\n                    parent.activeObj.activePoint.endX = temp;\n                    this.dragElement = parent.upperCanvas.style.cursor = parent.cursor = 'se-resize';\n                }\n                if (parent.activeObj.activePoint.endY < parent.activeObj.activePoint.startY) {\n                    var temp = parent.activeObj.activePoint.endY;\n                    parent.activeObj.activePoint.endY = parent.activeObj.activePoint.startY;\n                    parent.activeObj.activePoint.startY = temp;\n                    this.dragElement = parent.upperCanvas.style.cursor = parent.cursor = 'nw-resize';\n                }\n                this.preventDraggingInvertly();\n            }\n            else {\n                if (parent.activeObj.activePoint.startX < x && parent.activeObj.activePoint.endY > y) {\n                    width = x - parent.activeObj.activePoint.startX;\n                    height = parent.activeObj.activePoint.endY - y;\n                    scale = Math.min(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    parent.activeObj.activePoint.startX += newScale.x;\n                    parent.activeObj.activePoint.endY -= newScale.y;\n                    var endX = parent.img.destLeft > 0 ? parent.img.destLeft : 0;\n                    var endY = parent.img.destTop + parent.img.destHeight < parent.lowerCanvas.height ? parent.img.destTop +\n                        parent.img.destHeight : parent.lowerCanvas.height;\n                    if (parent.activeObj.activePoint.startX < endX || parent.activeObj.activePoint.endY > endY) {\n                        parent.activeObj.activePoint.startX -= newScale.x;\n                        parent.activeObj.activePoint.endY += newScale.y;\n                    }\n                }\n                else {\n                    width = parent.activeObj.activePoint.startX - x;\n                    height = y - parent.activeObj.activePoint.endY;\n                    scale = Math.max(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    parent.activeObj.activePoint.startX -= newScale.x;\n                    parent.activeObj.activePoint.endY += newScale.y;\n                    var endX = parent.img.destLeft > 0 ? parent.img.destLeft : 0;\n                    var endY = parent.img.destTop + parent.img.destHeight < parent.lowerCanvas.height ? parent.img.destTop +\n                        parent.img.destHeight : parent.lowerCanvas.height;\n                    if (parent.activeObj.activePoint.startX < endX || parent.activeObj.activePoint.endY > endY) {\n                        parent.activeObj.activePoint.startX += newScale.x;\n                        parent.activeObj.activePoint.endY -= newScale.y;\n                    }\n                }\n            }\n            parent.activeObj.activePoint.width = parent.activeObj.activePoint.endX - parent.activeObj.activePoint.startX;\n            parent.activeObj.activePoint.height = parent.activeObj.activePoint.endY - parent.activeObj.activePoint.startY;\n            this.preventInverseResize(tempActiveObj);\n        }\n    };\n    Selection.prototype.updateSPoints = function (x, y) {\n        var parent = this.parent;\n        var width;\n        var height;\n        var scale;\n        if (parent.activeObj.shape !== 'text') {\n            var splitWords = void 0;\n            if (parent.activeObj.shape) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (parent.activeObj.shape === 'crop-custom' || (parent.activeObj.shape && splitWords[0] !== 'crop')) {\n                if (parent.activeObj.shape !== 'line' && parent.activeObj.shape !== 'arrow' && parent.activeObj.shape !== 'path' &&\n                    parent.activeObj.rotatedAngle !== 0 && this.dragPoint.startX) {\n                    if (this.dragPoint.startX && this.dragPoint.startY) {\n                        this.previousPoint.x = this.dragPoint.endX;\n                        this.previousPoint.y = this.dragPoint.endY;\n                        this.dragPoint.endX = x;\n                        this.dragPoint.endY = y;\n                    }\n                    width = (this.dragPoint.endX - this.previousPoint.x);\n                    height = (this.dragPoint.endY - this.previousPoint.y);\n                    this.adjustRotationPoints(parent.activeObj.activePoint, width, height, parent.activeObj.rotatedAngle);\n                }\n                else {\n                    parent.activeObj.activePoint.endY = y;\n                    parent.activeObj.activePoint.height = parent.activeObj.activePoint.endY - parent.activeObj.activePoint.startY;\n                }\n                if (parent.activeObj.activePoint.endY < parent.activeObj.activePoint.startY) {\n                    var temp = parent.activeObj.activePoint.endY;\n                    parent.activeObj.activePoint.endY = parent.activeObj.activePoint.startY;\n                    parent.activeObj.activePoint.startY = temp;\n                    this.dragElement = this.resizedElement = 'n-resize';\n                }\n                this.preventDraggingInvertly();\n            }\n            else {\n                if (parent.activeObj.activePoint.endX > x && parent.activeObj.activePoint.endY > y) {\n                    width = parent.activeObj.activePoint.endX - x;\n                    height = parent.activeObj.activePoint.endY - y;\n                    scale = Math.min(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    parent.activeObj.activePoint.endX -= newScale.x;\n                    parent.activeObj.activePoint.endY -= newScale.y;\n                    if (parent.activeObj.activePoint.endX > (parent.img.destLeft + parent.img.destWidth) ||\n                        parent.activeObj.activePoint.endY > (parent.img.destTop + parent.img.destHeight)) {\n                        parent.activeObj.activePoint.endX += newScale.x;\n                        parent.activeObj.activePoint.endY += newScale.y;\n                    }\n                }\n                else {\n                    width = x - parent.activeObj.activePoint.endX;\n                    height = y - parent.activeObj.activePoint.endY;\n                    scale = Math.max(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    parent.activeObj.activePoint.endX += newScale.x;\n                    parent.activeObj.activePoint.endY += newScale.x;\n                    if (parent.activeObj.activePoint.endX > (parent.img.destLeft + parent.img.destWidth) ||\n                        parent.activeObj.activePoint.endY > (parent.img.destTop + parent.img.destHeight)) {\n                        parent.activeObj.activePoint.endX -= newScale.x;\n                        parent.activeObj.activePoint.endY -= newScale.y;\n                    }\n                }\n                parent.activeObj.activePoint.width = parent.activeObj.activePoint.endX - parent.activeObj.activePoint.startX;\n                parent.activeObj.activePoint.height = parent.activeObj.activePoint.endY - parent.activeObj.activePoint.startY;\n            }\n        }\n    };\n    Selection.prototype.updateSEPoints = function (x, y, maxDimension) {\n        var parent = this.parent;\n        var diff;\n        var width;\n        var height;\n        var scale;\n        var percentage;\n        var prevDiffX = this.diffPoint.x;\n        var prevDiffY = this.diffPoint.y;\n        var tempActiveObj = extend({}, parent.activeObj, null, true);\n        if (parent.activeObj.shape === 'text') {\n            if (this.oldPoint.x === undefined && this.oldPoint.y === undefined) {\n                this.diffPoint.x = x - parent.activeObj.activePoint.endX;\n                this.diffPoint.y = y - parent.activeObj.activePoint.endY;\n            }\n            else {\n                this.diffPoint.x = x - this.oldPoint.x;\n                this.diffPoint.y = y - this.oldPoint.y;\n            }\n            this.oldPoint.x = x;\n            this.oldPoint.y = y;\n            if (this.diffPoint.x >= prevDiffX && this.diffPoint.y >= prevDiffY) {\n                diff = Math.max(this.diffPoint.x, this.diffPoint.y);\n            }\n            else {\n                diff = Math.min(this.diffPoint.x, this.diffPoint.y);\n            }\n            percentage = (diff / 10);\n            parent.activeObj.activePoint.endX += (maxDimension.width / 50) * percentage;\n            parent.activeObj.activePoint.endY += (maxDimension.height / 50) * percentage;\n            if (this.preventTextDraggingInvertly()) {\n                parent.activeObj.activePoint.endX -= (maxDimension.width / 50) * percentage;\n                parent.activeObj.activePoint.endY -= (maxDimension.height / 50) * percentage;\n            }\n            parent.activeObj.activePoint.width = parent.activeObj.activePoint.endX - parent.activeObj.activePoint.startX;\n            parent.activeObj.activePoint.height = parent.activeObj.activePoint.endY - parent.activeObj.activePoint.startY;\n            parent.notify('shape', { prop: 'updateFontSize', onPropertyChange: false,\n                value: { obj: parent.activeObj } });\n        }\n        else {\n            var splitWords = void 0;\n            if (parent.activeObj.shape !== undefined) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (parent.activeObj.shape === 'crop-custom' || (parent.activeObj.shape !== undefined && splitWords[0] !== 'crop')) {\n                this.adjustSEPoints(parent.activeObj.activePoint, x, y, parent.activeObj.rotatedAngle);\n                if (parent.activeObj.activePoint.endX < parent.activeObj.activePoint.startX) {\n                    var temp = parent.activeObj.activePoint.endX;\n                    parent.activeObj.activePoint.endX = parent.activeObj.activePoint.startX;\n                    parent.activeObj.activePoint.startX = temp;\n                    this.dragElement = parent.upperCanvas.style.cursor = parent.cursor = 'sw-resize';\n                }\n                if (parent.activeObj.activePoint.endY < parent.activeObj.activePoint.startY) {\n                    var temp = parent.activeObj.activePoint.endY;\n                    parent.activeObj.activePoint.endY = parent.activeObj.activePoint.startY;\n                    parent.activeObj.activePoint.startY = temp;\n                    this.dragElement = parent.upperCanvas.style.cursor = parent.cursor = 'ne-resize';\n                }\n                this.preventDraggingInvertly();\n            }\n            else {\n                if (parent.activeObj.activePoint.endX > x && parent.activeObj.activePoint.endY > y) {\n                    width = parent.activeObj.activePoint.endX - x;\n                    height = parent.activeObj.activePoint.endY - y;\n                    scale = Math.min(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    parent.activeObj.activePoint.endX -= newScale.x;\n                    parent.activeObj.activePoint.endY -= newScale.y;\n                    var endX = parent.img.destLeft + parent.img.destWidth < parent.lowerCanvas.width ?\n                        parent.img.destLeft + parent.img.destWidth : parent.lowerCanvas.width;\n                    var endY = parent.img.destTop + parent.img.destHeight < parent.lowerCanvas.height ?\n                        parent.img.destTop + parent.img.destHeight : parent.lowerCanvas.height;\n                    if (parent.activeObj.activePoint.endX > endX || parent.activeObj.activePoint.endY > endY) {\n                        parent.activeObj.activePoint.endX += newScale.x;\n                        parent.activeObj.activePoint.endY += newScale.y;\n                    }\n                }\n                else {\n                    width = x - parent.activeObj.activePoint.endX;\n                    height = y - parent.activeObj.activePoint.endY;\n                    scale = Math.max(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    parent.activeObj.activePoint.endX += newScale.x;\n                    parent.activeObj.activePoint.endY += newScale.y;\n                    var endX = parent.img.destLeft + parent.img.destWidth < parent.lowerCanvas.width ? parent.img.destLeft +\n                        parent.img.destWidth : parent.lowerCanvas.width;\n                    var endY = parent.img.destTop + parent.img.destHeight < parent.lowerCanvas.height ? parent.img.destTop +\n                        parent.img.destHeight : parent.lowerCanvas.height;\n                    if (parent.activeObj.activePoint.endX > endX || parent.activeObj.activePoint.endY > endY) {\n                        parent.activeObj.activePoint.endX -= newScale.x;\n                        parent.activeObj.activePoint.endY -= newScale.y;\n                    }\n                }\n            }\n            parent.activeObj.activePoint.width = parent.activeObj.activePoint.endX - parent.activeObj.activePoint.startX;\n            parent.activeObj.activePoint.height = parent.activeObj.activePoint.endY - parent.activeObj.activePoint.startY;\n            this.preventInverseResize(tempActiveObj);\n        }\n    };\n    Selection.prototype.adjustNWPoints = function (rectangle, x, y, angle) {\n        var cx = rectangle.startX + rectangle.width / 2;\n        var cy = rectangle.startY + rectangle.height / 2;\n        var rotatedC = this.rotatePoints(rectangle.endX, rectangle.endY, cx, cy, angle);\n        var newCenter = [(rotatedC[0] + x) / 2, (rotatedC[1] + y) / 2];\n        var newBottomRight = this.rotatePoints(rotatedC[0], rotatedC[1], newCenter[0], newCenter[1], -angle);\n        var newTopLeft = this.rotatePoints(x, y, newCenter[0], newCenter[1], -angle);\n        rectangle.endX = newBottomRight[0];\n        rectangle.endY = newBottomRight[1];\n        rectangle.startY = newTopLeft[1];\n        rectangle.startX = newTopLeft[0];\n        rectangle.width = rectangle.endX - rectangle.startX;\n        rectangle.height = rectangle.endY - rectangle.startY;\n        return rectangle;\n    };\n    Selection.prototype.adjustNEPoints = function (rectangle, x, y, angle) {\n        var cx = rectangle.startX + rectangle.width / 2;\n        var cy = rectangle.startY + rectangle.height / 2;\n        var rotatedD = this.rotatePoints(rectangle.startX, rectangle.endY, cx, cy, angle);\n        var newCenter = [(rotatedD[0] + x) / 2, (rotatedD[1] + y) / 2];\n        var newBottomLeft = this.rotatePoints(rotatedD[0], rotatedD[1], newCenter[0], newCenter[1], -angle);\n        var newTopRight = this.rotatePoints(x, y, newCenter[0], newCenter[1], -angle);\n        rectangle.startX = newBottomLeft[0];\n        rectangle.endY = newBottomLeft[1];\n        rectangle.width = newTopRight[0] - newBottomLeft[0];\n        rectangle.height = newBottomLeft[1] - newTopRight[1];\n        rectangle.endX = rectangle.startX + rectangle.width;\n        rectangle.startY = rectangle.endY - rectangle.height;\n        return rectangle;\n    };\n    Selection.prototype.adjustSWPoints = function (rectangle, x, y, angle) {\n        var cx = rectangle.startX + rectangle.width / 2;\n        var cy = rectangle.startY + rectangle.height / 2;\n        var rotatedB = this.rotatePoints(rectangle.endX, rectangle.startY, cx, cy, angle);\n        var newCenter = [(rotatedB[0] + x) / 2, (rotatedB[1] + y) / 2];\n        var newTopRight = this.rotatePoints(rotatedB[0], rotatedB[1], newCenter[0], newCenter[1], -angle);\n        var newBottomLeft = this.rotatePoints(x, y, newCenter[0], newCenter[1], -angle);\n        rectangle.endX = newTopRight[0];\n        rectangle.startY = newTopRight[1];\n        rectangle.startX = newBottomLeft[0];\n        rectangle.endY = newBottomLeft[1];\n        rectangle.width = rectangle.endX - rectangle.startX;\n        rectangle.height = rectangle.endY - rectangle.startY;\n        return rectangle;\n    };\n    Selection.prototype.adjustSEPoints = function (rectangle, x, y, angle) {\n        var cx = rectangle.startX + rectangle.width / 2;\n        var cy = rectangle.startY + rectangle.height / 2;\n        var rotatedA = this.rotatePoints(rectangle.startX, rectangle.startY, cx, cy, angle);\n        var newCenter = [(rotatedA[0] + x) / 2, (rotatedA[1] + y) / 2];\n        var newTopLeft = this.rotatePoints(rotatedA[0], rotatedA[1], newCenter[0], newCenter[1], -angle);\n        var newBottomRight = this.rotatePoints(x, y, newCenter[0], newCenter[1], -angle);\n        rectangle.startX = newTopLeft[0];\n        rectangle.startY = newTopLeft[1];\n        rectangle.width = newBottomRight[0] - newTopLeft[0];\n        rectangle.height = newBottomRight[1] - newTopLeft[1];\n        rectangle.endX = rectangle.startX + rectangle.width;\n        rectangle.endY = rectangle.startY + rectangle.height;\n        return rectangle;\n    };\n    Selection.prototype.adjustRotationPoints = function (rectangle, x, y, angle) {\n        var cx = rectangle.startX + rectangle.width / 2;\n        var cy = rectangle.startY + rectangle.height / 2;\n        this.getResizeDirection(rectangle, x, y, angle);\n        var rotatedA = this.rotatePoints(rectangle.startX, rectangle.startY, cx, cy, angle);\n        var rotatedB = this.rotatePoints(rectangle.endX, rectangle.startY, cx, cy, angle);\n        var rotatedC = this.rotatePoints(rectangle.endX, rectangle.endY, cx, cy, angle);\n        var rotatedD = this.rotatePoints(rectangle.startX, rectangle.endY, cx, cy, angle);\n        var newCenter = [(rotatedA[0] + rotatedC[0]) / 2, (rotatedA[1] + rotatedC[1]) / 2];\n        var newTopLeft = this.rotatePoints(rotatedA[0], rotatedA[1], newCenter[0], newCenter[1], -angle);\n        var newBottomLeft = this.rotatePoints(rotatedD[0], rotatedD[1], newCenter[0], newCenter[1], -angle);\n        var newTopRight = this.rotatePoints(rotatedB[0], rotatedB[1], newCenter[0], newCenter[1], -angle);\n        rectangle.startX = newTopLeft[0];\n        rectangle.startY = newTopLeft[1];\n        rectangle.endX = newTopRight[0];\n        rectangle.endY = newBottomLeft[1];\n        rectangle.width = rectangle.endX - rectangle.startX;\n        rectangle.height = rectangle.endY - rectangle.startY;\n        return rectangle;\n    };\n    Selection.prototype.rotatePoints = function (x, y, cx, cy, angle) {\n        return [\n            (x - cx) * Math.cos(angle) - (y - cy) * Math.sin(angle) + cx,\n            (x - cx) * Math.sin(angle) + (y - cy) * Math.cos(angle) + cy\n        ];\n    };\n    Selection.prototype.setResizedValue = function (element, value, x, y) {\n        switch (element) {\n            case 'x':\n                value += x;\n                break;\n            case 'y':\n                value += y;\n                break;\n            case 'abs-x':\n                value += (x > 0 ? -x : Math.abs(x));\n                break;\n            case 'abs-y':\n                value += (y > 0 ? -y : Math.abs(y));\n                break;\n            case 'y-abs-x':\n                value += (y + ((x > 0 ? -x : Math.abs(x)) / 2));\n                break;\n            case 'abs-x-abs-y':\n                value += ((x > 0 ? -x : Math.abs(x)) + ((y > 0 ? -y : Math.abs(y)) / 2));\n                break;\n            case 'abs-y-x':\n                value += ((y > 0 ? -y : Math.abs(y)) + (x / 2));\n                break;\n            case 'x-y':\n                value += (x + (y / 2));\n                break;\n        }\n        return value;\n    };\n    Selection.prototype.getResizeDirection = function (rectangle, x, y, angle) {\n        var rotatedAngle = angle * (180 / Math.PI);\n        var element = this.getResizedElement(rotatedAngle, this.resizedElement);\n        if (this.resizedElement === 'e-resize') {\n            rectangle.width = this.setResizedValue(element, rectangle.width, x, y);\n            rectangle.endX = rectangle.width + rectangle.startX;\n        }\n        else if (this.resizedElement === 'n-resize') {\n            rectangle.startY = this.setResizedValue(element, rectangle.startY, x, y);\n            rectangle.height = rectangle.endY - rectangle.startY;\n        }\n        else if (this.resizedElement === 'w-resize') {\n            rectangle.startX = this.setResizedValue(element, rectangle.startX, x, y);\n            rectangle.width = rectangle.startX + rectangle.endX;\n        }\n        else if (this.resizedElement === 's-resize') {\n            rectangle.height = this.setResizedValue(element, rectangle.height, x, y);\n            rectangle.endY = rectangle.height + rectangle.startY;\n        }\n    };\n    Selection.prototype.getResizedElement = function (degree, element) {\n        var resizeMappings = [];\n        if (element === 'n-resize') {\n            resizeMappings = [\n                [337.5, 360, 'y'],\n                [0, 22.5, 'y'],\n                [22.5, 67.5, 'y-abs-x'],\n                [67.5, 112.5, 'abs-x'],\n                [112.5, 157.5, 'abs-x-abs-y'],\n                [157.5, 202.5, 'abs-y'],\n                [202.5, 247.5, 'abs-y-x'],\n                [247.5, 292.5, 'x'],\n                [292.5, 337.5, 'x-y']\n            ];\n        }\n        else if (element === 'e-resize') {\n            resizeMappings = [\n                [337.5, 360, 'x'],\n                [0, 22.5, 'x'],\n                [22.5, 67.5, 'x-y'],\n                [67.5, 112.5, 'y'],\n                [112.5, 157.5, 'y-abs-x'],\n                [157.5, 202.5, 'abs-x'],\n                [202.5, 247.5, 'abs-x-abs-y'],\n                [247.5, 292.5, 'abs-y'],\n                [292.5, 337.5, 'abs-y-x']\n            ];\n        }\n        else if (element === 's-resize') {\n            resizeMappings = [\n                [337.5, 360, 'y'],\n                [0, 22.5, 'y'],\n                [22.5, 67.5, 'y-abs-x'],\n                [67.5, 112.5, 'abs-x'],\n                [112.5, 157.5, 'abs-x-abs-y'],\n                [157.5, 202.5, 'abs-y'],\n                [202.5, 247.5, 'abs-y-x'],\n                [247.5, 292.5, 'x'],\n                [292.5, 337.5, 'x-y']\n            ];\n        }\n        else if (element === 'w-resize') {\n            resizeMappings = [\n                [337.5, 360, 'x'],\n                [0, 22.5, 'x'],\n                [22.5, 67.5, 'x-y'],\n                [67.5, 112.5, 'y'],\n                [112.5, 157.5, 'y-abs-x'],\n                [157.5, 202.5, 'abs-x'],\n                [202.5, 247.5, 'abs-x-abs-y'],\n                [247.5, 292.5, 'abs-y'],\n                [292.5, 337.5, 'abs-y-x']\n            ];\n        }\n        var positiveDegree = degree < 0 ? 360 - Math.abs(degree) : degree;\n        for (var _i = 0, resizeMappings_2 = resizeMappings; _i < resizeMappings_2.length; _i++) {\n            var _a = resizeMappings_2[_i], startDegree = _a[0], endDegree = _a[1], resizeElement = _a[2];\n            if ((positiveDegree > startDegree && positiveDegree <= endDegree) ||\n                (positiveDegree + 360 > startDegree && positiveDegree + 360 <= endDegree)) {\n                return resizeElement;\n            }\n        }\n        return element;\n    };\n    Selection.prototype.updateCursorStyles = function (x, y, type) {\n        var parent = this.parent;\n        var isResize = false;\n        if (parent.activeObj.keyHistory !== '' && parent.activeObj.shape === undefined && !parent.currObjType.isCustomCrop &&\n            !parent.currObjType.isLine && parent.currObjType.isText) {\n            parent.activeObj.shape = 'text';\n        }\n        var actObj = extend({}, parent.activeObj, {}, true);\n        if (isNullOrUndefined(actObj.topLeftCircle)) {\n            return;\n        }\n        var degree;\n        if (actObj.shapeDegree === 0) {\n            degree = parent.transform.degree;\n        }\n        else {\n            degree = parent.transform.degree - actObj.shapeDegree;\n        }\n        if (degree < 0) {\n            degree = 360 + degree;\n        }\n        if (this.isObjSelected) {\n            if (actObj.shape === 'line' || actObj.shape === 'arrow') {\n                isResize = this.updateCursorStylesForLineArrow(x, y, actObj);\n            }\n            else if (actObj.shape === 'path') {\n                isResize = this.updateCursorStylesForPath(x, y, actObj);\n            }\n            else if (actObj.rotatedAngle) {\n                this.setCursorForRotatedObject(actObj, x, y, parent.upperCanvas);\n                if (parent.cursor === 'grabbing') {\n                    parent.upperCanvas.style.cursor = this.parent.cursor = 'grabbing';\n                    this.dragElement = parent.cursor;\n                }\n                else if (parent.cursor === 'move') {\n                    this.dragPoint.startX = this.previousPoint.x = this.dragPoint.endX = x;\n                    this.dragPoint.startY = this.previousPoint.y = this.dragPoint.endY = y;\n                }\n                else if (parent.cursor !== 'default') {\n                    isResize = true;\n                    this.dragElement = parent.cursor;\n                    parent.currObjType.isResize = true;\n                }\n            }\n            else {\n                var rotationCirclePoint = this.getTransRotationPoint(actObj);\n                if (x >= (actObj.topLeftCircle.startX - (actObj.topLeftCircle.radius * 2)) &&\n                    x <= (actObj.topLeftCircle.startX + (actObj.topLeftCircle.radius * 2)) &&\n                    y >= (actObj.topLeftCircle.startY - (actObj.topLeftCircle.radius * 2)) &&\n                    y <= (actObj.topLeftCircle.startY + (actObj.topLeftCircle.radius * 2)) && this.dragElement !== 'nw-resize') {\n                    actObj.topLeftCircle.startX = actObj.topLeftCircle.startY = 0;\n                    parent.upperCanvas.style.cursor = parent.cursor = 'nw-resize';\n                    isResize = true;\n                    this.dragElement = parent.upperCanvas.style.cursor;\n                }\n                else if (x >= (actObj.topLeftCircle.startX - (actObj.topLeftCircle.radius * 2)) &&\n                    x <= (actObj.topRightCircle.startX - (actObj.topLeftCircle.radius * 2)) &&\n                    y >= (actObj.topCenterCircle.startY - (actObj.topLeftCircle.radius * 2)) &&\n                    y <= (actObj.topCenterCircle.startY + (actObj.topLeftCircle.radius * 2)) && this.dragElement !== 'n-resize') {\n                    actObj.topCenterCircle.startX = actObj.topCenterCircle.startY = 0;\n                    parent.upperCanvas.style.cursor = parent.cursor = 'n-resize';\n                    isResize = true;\n                    this.dragElement = parent.upperCanvas.style.cursor;\n                }\n                else if (x >= (actObj.topRightCircle.startX - (actObj.topLeftCircle.radius * 2)) &&\n                    x <= (actObj.topRightCircle.startX + (actObj.topLeftCircle.radius * 2)) &&\n                    y >= (actObj.topRightCircle.startY - (actObj.topLeftCircle.radius * 2)) &&\n                    y <= (actObj.topRightCircle.startY + (actObj.topLeftCircle.radius * 2)) && this.dragElement !== 'ne-resize') {\n                    actObj.topRightCircle.startX = actObj.topRightCircle.startY = 0;\n                    parent.upperCanvas.style.cursor = parent.cursor = 'ne-resize';\n                    isResize = true;\n                    this.dragElement = parent.upperCanvas.style.cursor;\n                }\n                else if (x >= (actObj.centerLeftCircle.startX - (actObj.topLeftCircle.radius * 2)) &&\n                    x <= (actObj.centerLeftCircle.startX + (actObj.topLeftCircle.radius * 2)) &&\n                    y >= (actObj.topLeftCircle.startY - (actObj.topLeftCircle.radius * 2)) &&\n                    y <= (actObj.bottomLeftCircle.startY - (actObj.topLeftCircle.radius * 2)) && this.dragElement !== 'w-resize') {\n                    actObj.centerLeftCircle.startX = actObj.centerLeftCircle.startY = 0;\n                    parent.upperCanvas.style.cursor = parent.cursor = 'w-resize';\n                    isResize = true;\n                    this.dragElement = parent.upperCanvas.style.cursor;\n                }\n                else if (x >= (actObj.centerRightCircle.startX - (actObj.topLeftCircle.radius * 2)) &&\n                    x <= (actObj.centerRightCircle.startX + (actObj.topLeftCircle.radius * 2)) &&\n                    y >= (actObj.topRightCircle.startY - (actObj.topLeftCircle.radius * 2)) &&\n                    y <= (actObj.bottomRightCircle.startY - (actObj.topLeftCircle.radius * 2)) && this.dragElement !== 'e-resize') {\n                    actObj.centerRightCircle.startX = actObj.centerRightCircle.startY = 0;\n                    parent.upperCanvas.style.cursor = parent.cursor = 'e-resize';\n                    isResize = true;\n                    this.dragElement = parent.upperCanvas.style.cursor;\n                }\n                else if (x >= (actObj.bottomLeftCircle.startX - (actObj.topLeftCircle.radius * 2)) &&\n                    x <= (actObj.bottomLeftCircle.startX + (actObj.topLeftCircle.radius * 2)) &&\n                    y >= (actObj.bottomLeftCircle.startY - (actObj.topLeftCircle.radius * 2)) &&\n                    y <= (actObj.bottomLeftCircle.startY + (actObj.topLeftCircle.radius * 2)) && this.dragElement !== 'sw-resize') {\n                    actObj.bottomLeftCircle.startX = actObj.bottomLeftCircle.startY = 0;\n                    parent.upperCanvas.style.cursor = parent.cursor = 'sw-resize';\n                    isResize = true;\n                    this.dragElement = parent.upperCanvas.style.cursor;\n                }\n                else if (x >= (actObj.bottomLeftCircle.startX - (actObj.topLeftCircle.radius * 2)) &&\n                    x <= (actObj.bottomRightCircle.startX - (actObj.topLeftCircle.radius * 2)) &&\n                    y >= (actObj.bottomCenterCircle.startY - (actObj.topLeftCircle.radius * 2)) &&\n                    y <= (actObj.bottomCenterCircle.startY + (actObj.topLeftCircle.radius * 2)) && this.dragElement !== 's-resize') {\n                    actObj.bottomCenterCircle.startX = actObj.bottomCenterCircle.startY = 0;\n                    parent.upperCanvas.style.cursor = parent.cursor = 's-resize';\n                    isResize = true;\n                    this.dragElement = parent.upperCanvas.style.cursor;\n                }\n                else if (x >= (actObj.bottomRightCircle.startX - (actObj.topLeftCircle.radius * 2)) &&\n                    x <= (actObj.bottomRightCircle.startX + (actObj.topLeftCircle.radius * 2)) &&\n                    y >= (actObj.bottomRightCircle.startY - (actObj.topLeftCircle.radius * 2)) &&\n                    y <= (actObj.bottomRightCircle.startY + (actObj.topLeftCircle.radius * 2)) && this.dragElement !== 'se-resize') {\n                    actObj.bottomRightCircle.startX = actObj.bottomRightCircle.startY = 0;\n                    parent.upperCanvas.style.cursor = parent.cursor = 'se-resize';\n                    isResize = true;\n                    this.dragElement = parent.upperCanvas.style.cursor;\n                }\n                else if (rotationCirclePoint &&\n                    x >= rotationCirclePoint.x - (actObj.topLeftCircle.radius * 2) &&\n                    x <= rotationCirclePoint.x + (actObj.topLeftCircle.radius * 2) &&\n                    y >= rotationCirclePoint.y - (actObj.topLeftCircle.radius * 2) &&\n                    y <= rotationCirclePoint.y + (actObj.topLeftCircle.radius * 2) && this.dragElement !== 'grabbing') {\n                    parent.upperCanvas.style.cursor = parent.cursor = 'grabbing';\n                    this.dragElement = parent.upperCanvas.style.cursor;\n                }\n                else {\n                    this.dragPoint.startX = this.previousPoint.x = this.dragPoint.endX = x;\n                    this.dragPoint.startY = this.previousPoint.y = this.dragPoint.endY = y;\n                }\n                if ((actObj.shape === 'text') && (parent.cursor === 'n-resize' ||\n                    parent.cursor === 's-resize' || parent.cursor === 'e-resize' ||\n                    parent.cursor === 'w-resize')) {\n                    parent.upperCanvas.style.cursor = parent.cursor = 'move';\n                    this.dragElement = '';\n                    this.dragPoint.startX = this.previousPoint.x = this.dragPoint.endX = x;\n                    this.dragPoint.startY = this.previousPoint.y = this.dragPoint.endY = y;\n                }\n            }\n        }\n        else {\n            this.dragPoint.startX = this.previousPoint.x = this.dragPoint.endX = x;\n            this.dragPoint.startY = this.previousPoint.y = this.dragPoint.endY = y;\n        }\n        this.previousPoint.x = this.previousPoint.y = this.diffPoint.x = this.diffPoint.y = 0;\n        if (type === 'touchstart') {\n            if (isResize || (x >= actObj.activePoint.startX && x <= actObj.activePoint.endX\n                && y >= actObj.activePoint.startY && y <= actObj.activePoint.endY) || this.dragElement === 'grabbing') {\n                parent.currObjType.isDragging = true;\n            }\n            else if (actObj.shape === 'line' || actObj.shape === 'arrow') {\n                this.setCursorForLineArrow(actObj, x, y, parent.upperCanvas);\n                if (parent.cursor === 'move') {\n                    parent.currObjType.isDragging = true;\n                }\n            }\n            else if (actObj.shape === 'path') {\n                this.setCursorForPath(actObj, x, y, parent.upperCanvas);\n                if (parent.cursor === 'move') {\n                    parent.currObjType.isDragging = true;\n                }\n            }\n        }\n        else {\n            parent.currObjType.isDragging = true;\n        }\n        if (actObj.rotatedAngle !== 0 && (this.dragElement === 'e-resize' ||\n            this.dragElement === 'w-resize' || this.dragElement === 'n-resize' ||\n            this.dragElement === 's-resize')) {\n            this.dragPoint.startX = this.previousPoint.x = this.dragPoint.endX = x;\n            this.dragPoint.startY = this.previousPoint.y = this.dragPoint.endY = y;\n        }\n    };\n    Selection.prototype.updateCursorStylesForLineArrow = function (x, y, actObj) {\n        var isResize = false;\n        var parent = this.parent;\n        var point;\n        for (var i = 0; i < 5; i++) {\n            point = actObj.pointColl[i];\n            if (x >= (point.x - (actObj.topLeftCircle.radius * 2)) && x <= (point.x + (actObj.topLeftCircle.radius * 2)) &&\n                y >= (point.y - (actObj.topLeftCircle.radius * 2)) && y <= (point.y + (actObj.topLeftCircle.radius * 2))) {\n                actObj.centerLeftCircle.startX = actObj.centerLeftCircle.startY = 0;\n                this.dragElement = 'w-resize';\n                isResize = true;\n                break;\n            }\n        }\n        if (!isResize) {\n            for (var i = 1; i < 6; i++) {\n                point = actObj.pointColl[actObj.pointColl.length - i];\n                if (x >= (point.x - (actObj.topLeftCircle.radius * 2)) && x <= (point.x + (actObj.topLeftCircle.radius * 2)) &&\n                    y >= (point.y - (actObj.topLeftCircle.radius * 2)) && y <= (point.y + (actObj.topLeftCircle.radius * 2))) {\n                    actObj.centerRightCircle.startX = actObj.centerRightCircle.startY = 0;\n                    this.dragElement = 'e-resize';\n                    isResize = true;\n                    break;\n                }\n            }\n        }\n        if (!isResize) {\n            for (var i = 0; i < actObj.pointColl.length; i++) {\n                point = actObj.pointColl[i];\n                if (x >= (point.x - (actObj.topLeftCircle.radius * 2)) && x <= (point.x + (actObj.topLeftCircle.radius * 2)) &&\n                    y >= (point.y - (actObj.topLeftCircle.radius * 2)) && y <= (point.y + (actObj.topLeftCircle.radius * 2))) {\n                    parent.upperCanvas.style.cursor = parent.cursor = 'move';\n                    this.dragPoint.startX = this.previousPoint.x = this.dragPoint.endX = x;\n                    this.dragPoint.startY = this.previousPoint.y = this.dragPoint.endY = y;\n                    break;\n                }\n                else {\n                    parent.upperCanvas.style.cursor = parent.cursor = 'default';\n                }\n            }\n        }\n        return isResize;\n    };\n    Selection.prototype.updateCursorStylesForPath = function (x, y, actObj) {\n        var isResize = false;\n        this.pathAdjustedIndex = this.setCursorForLineArrow(actObj, x, y, this.parent.upperCanvas);\n        if (this.parent.cursor === 'move') {\n            isResize = true;\n            this.dragElement = 'pathDrag';\n        }\n        if (!isResize) {\n            this.parent.upperCanvas.style.cursor = this.parent.cursor = 'move';\n            this.dragPoint.startX = this.previousPoint.x = this.dragPoint.endX = x;\n            this.dragPoint.startY = this.previousPoint.y = this.dragPoint.endY = y;\n        }\n        return isResize;\n    };\n    Selection.prototype.setTextSelection = function (width, height) {\n        var parent = this.parent;\n        var degree = parent.transform.degree;\n        if (parent.activeObj.shapeDegree === 0) {\n            degree = parent.transform.degree;\n        }\n        else {\n            degree = parent.transform.degree - parent.activeObj.shapeDegree;\n        }\n        if (degree < 0) {\n            degree = 360 + degree;\n        }\n        for (var i = 0, len = parent.activeObj.flipObjColl.length; i < len; i++) {\n            var flip = parent.activeObj.flipObjColl[i].toLowerCase();\n            switch (degree) {\n                case 0:\n                    switch (flip) {\n                        case 'horizontal':\n                            parent.activeObj.activePoint = { startX: parent.activeObj.activePoint.endX - width,\n                                startY: parent.activeObj.activePoint.startY,\n                                endX: (parent.activeObj.activePoint.endX),\n                                endY: parent.activeObj.activePoint.startY + (height ? height : 0) };\n                            break;\n                        case 'vertical':\n                            parent.activeObj.activePoint.startY = parent.activeObj.activePoint.endY - height;\n                            parent.activeObj.activePoint = { startX: parent.activeObj.activePoint.startX,\n                                startY: parent.activeObj.activePoint.startY,\n                                endX: (parent.activeObj.activePoint.startX + (width ? width : 0)),\n                                endY: parent.activeObj.activePoint.endY };\n                            break;\n                        default:\n                            parent.activeObj.activePoint = { startX: parent.activeObj.activePoint.startX,\n                                startY: parent.activeObj.activePoint.startY,\n                                endX: (parent.activeObj.activePoint.startX + (width ? width : 0)),\n                                endY: parent.activeObj.activePoint.startY + (height ? height : 0) };\n                            break;\n                    }\n                    break;\n                case 90:\n                    switch (flip) {\n                        case 'horizontal':\n                            parent.activeObj.activePoint.endX = parent.activeObj.activePoint.startX + height;\n                            parent.activeObj.activePoint = { startX: parent.activeObj.activePoint.startX,\n                                startY: parent.activeObj.activePoint.startY, endX: (parent.activeObj.activePoint.endX),\n                                endY: parent.activeObj.activePoint.startY + (width ? width : 0) };\n                            break;\n                        case 'vertical':\n                            parent.activeObj.activePoint.startX = parent.activeObj.activePoint.endX - height;\n                            parent.activeObj.activePoint = { startX: parent.activeObj.activePoint.startX,\n                                startY: parent.activeObj.activePoint.endY - width,\n                                endX: (parent.activeObj.activePoint.endX),\n                                endY: parent.activeObj.activePoint.endY };\n                            break;\n                        default:\n                            parent.activeObj.activePoint.startX = parent.activeObj.activePoint.endX - height;\n                            parent.activeObj.activePoint = { startX: parent.activeObj.activePoint.startX,\n                                startY: parent.activeObj.activePoint.startY, endX: (parent.activeObj.activePoint.endX),\n                                endY: parent.activeObj.activePoint.startY + (width ? width : 0) };\n                            break;\n                    }\n                    break;\n                case 180:\n                    switch (flip) {\n                        case 'horizontal':\n                            parent.activeObj.activePoint.startY = parent.activeObj.activePoint.endY - height;\n                            parent.activeObj.activePoint = { startX: parent.activeObj.activePoint.startX,\n                                startY: parent.activeObj.activePoint.startY,\n                                endX: (parent.activeObj.activePoint.startX + width),\n                                endY: parent.activeObj.activePoint.endY };\n                            break;\n                        case 'vertical':\n                            parent.activeObj.activePoint.endY = parent.activeObj.activePoint.startY + height;\n                            parent.activeObj.activePoint = { endX: parent.activeObj.activePoint.endX, endY: parent.activeObj.activePoint.endY,\n                                startX: (parent.activeObj.activePoint.endX - (width ? width : 0)),\n                                startY: parent.activeObj.activePoint.startY };\n                            break;\n                        default:\n                            parent.activeObj.activePoint = { endX: parent.activeObj.activePoint.endX, endY: parent.activeObj.activePoint.endY,\n                                startX: (parent.activeObj.activePoint.endX - (width ? width : 0)),\n                                startY: parent.activeObj.activePoint.endY - (height ? height : 0) };\n                            break;\n                    }\n                    break;\n                case 270:\n                    switch (flip) {\n                        case 'horizontal':\n                            parent.activeObj.activePoint.startX = parent.activeObj.activePoint.endX - height;\n                            parent.activeObj.activePoint = { startX: parent.activeObj.activePoint.startX,\n                                startY: parent.activeObj.activePoint.endY - (width ? width : 0),\n                                endX: parent.activeObj.activePoint.endX,\n                                endY: parent.activeObj.activePoint.endY };\n                            break;\n                        case 'vertical':\n                            parent.activeObj.activePoint = { startX: parent.activeObj.activePoint.startX,\n                                startY: parent.activeObj.activePoint.startY,\n                                endX: (parent.activeObj.activePoint.startX + height),\n                                endY: parent.activeObj.activePoint.startY + (width ? width : 0) };\n                            break;\n                        default:\n                            parent.activeObj.activePoint.endX = parent.activeObj.activePoint.startX + height;\n                            parent.activeObj.activePoint = { startX: parent.activeObj.activePoint.startX,\n                                startY: parent.activeObj.activePoint.endY - (width ? width : 0),\n                                endX: parent.activeObj.activePoint.endX,\n                                endY: parent.activeObj.activePoint.endY };\n                            break;\n                    }\n                    break;\n            }\n        }\n        if (parent.activeObj.flipObjColl.length === 0) {\n            switch (degree) {\n                case 0:\n                    parent.activeObj.activePoint = { startX: parent.activeObj.activePoint.startX, startY: parent.activeObj.activePoint.startY,\n                        endX: (parent.activeObj.activePoint.startX + (width ? width : 0)),\n                        endY: parent.activeObj.activePoint.startY + (height ? height : 0) };\n                    break;\n                case 90:\n                    parent.activeObj.activePoint.startX = parent.activeObj.activePoint.endX - height;\n                    parent.activeObj.activePoint = { startX: parent.activeObj.activePoint.startX, startY: parent.activeObj.activePoint.startY,\n                        endX: (parent.activeObj.activePoint.endX),\n                        endY: parent.activeObj.activePoint.startY + (width ? width : 0) };\n                    break;\n                case 180:\n                    parent.activeObj.activePoint = { endX: parent.activeObj.activePoint.endX, endY: parent.activeObj.activePoint.endY,\n                        startX: (parent.activeObj.activePoint.endX - (width ? width : 0)),\n                        startY: parent.activeObj.activePoint.endY - (height ? height : 0) };\n                    break;\n                case 270:\n                    parent.activeObj.activePoint.endX = parent.activeObj.activePoint.startX + height;\n                    parent.activeObj.activePoint = { startX: parent.activeObj.activePoint.startX,\n                        startY: parent.activeObj.activePoint.endY - (width ? width : 0),\n                        endX: parent.activeObj.activePoint.endX,\n                        endY: parent.activeObj.activePoint.endY };\n                    break;\n            }\n        }\n        parent.activeObj.activePoint.width = parent.activeObj.activePoint.endX - parent.activeObj.activePoint.startX;\n        parent.activeObj.activePoint.height = parent.activeObj.activePoint.endY - parent.activeObj.activePoint.startY;\n        if (parent.transform.degree === 360 || parent.transform.degree === -360) {\n            parent.transform.degree = 0;\n        }\n    };\n    Selection.prototype.setActivePoint = function (startX, startY) {\n        var parent = this.parent;\n        if (isNullOrUndefined(parent.activeObj.activePoint)) {\n            return;\n        }\n        if (parent.currObjType.isText) {\n            var textWidth = startX ? startX : 0;\n            var textHeight = startY ? startY : parent.activeObj.textSettings.fontSize;\n            if (parent.activeObj.textSettings.fontSize === undefined) {\n                parent.activeObj.textSettings.fontSize = (Math.abs(parent.baseImg.width - parent.baseImg.height)) * 0.1;\n            }\n            this.setTextSelection(textWidth, textHeight);\n            this.mouseDownPoint.x = parent.activeObj.activePoint.endX;\n            this.mouseDownPoint.y = parent.activeObj.activePoint.endY;\n            if (parent.activeObj.horTopLine !== undefined) {\n                parent.activeObj.activePoint = extend({}, parent.activeObj.activePoint, {}, true);\n            }\n            parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate' } });\n        }\n        else if (startX && startY) {\n            parent.activeObj.activePoint.startX = this.mouseDownPoint.x = startX;\n            parent.activeObj.activePoint.startY = this.mouseDownPoint.y = startY;\n            parent.currObjType.isDragging = true;\n        }\n        else {\n            var selectInfo = parent.activeObj;\n            parent.activeObj.activePoint = { startX: selectInfo.horTopLine.startX, startY: selectInfo.horTopLine.startY,\n                endX: selectInfo.horTopLine.endX, endY: selectInfo.horTopLine.endY };\n            parent.activeObj.activePoint.width = parent.activeObj.activePoint.endX - parent.activeObj.activePoint.startX;\n            parent.activeObj.activePoint.height = parent.activeObj.activePoint.endY - parent.activeObj.activePoint.startY;\n        }\n    };\n    Selection.prototype.mouseDownEventHandler = function (e) {\n        var _this = this;\n        var parent = this.parent;\n        if (e.type === 'touchstart') {\n            this.isTouch = true;\n        }\n        else {\n            this.isTouch = false;\n        }\n        if (e.type === 'touchstart' && e.currentTarget === parent.lowerCanvas && !parent.isImageLoaded) {\n            return;\n        }\n        this.isCropSelection = false;\n        this.isPan = true;\n        var splitWords;\n        if (parent.activeObj.shape !== undefined) {\n            splitWords = parent.activeObj.shape.split('-');\n        }\n        if (splitWords !== undefined && splitWords[0] === 'crop') {\n            this.isCropSelection = true;\n        }\n        if (this.isCropSelection) {\n            this.dragCanvas = parent.togglePan = true;\n        }\n        var imageEditorClickEventArgs = { point: this.setXYPoints(e) };\n        if (isBlazor() && parent.events && parent.events.clicked.hasDelegate === true) {\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            parent.dotNetRef.invokeMethodAsync('ClickEventAsync', 'click', imageEditorClickEventArgs).then(function (imageEditorClickEventArgs) {\n                _this.clickEvent(imageEditorClickEventArgs, e);\n            });\n        }\n        else {\n            parent.trigger('click', imageEditorClickEventArgs);\n            this.clickEvent(imageEditorClickEventArgs, e);\n        }\n    };\n    Selection.prototype.getImagePoints = function (x, y) {\n        var parent = this.parent;\n        if (x < parent.img.destLeft) {\n            x = parent.img.destLeft;\n        }\n        else if (x > parent.img.destLeft + parent.img.destWidth) {\n            x = parent.img.destLeft + parent.img.destWidth;\n        }\n        if (y < parent.img.destTop) {\n            y = parent.img.destTop;\n        }\n        else if (y > parent.img.destTop + parent.img.destHeight) {\n            y = parent.img.destTop + parent.img.destHeight;\n        }\n        return { x: x, y: y };\n    };\n    Selection.prototype.clickEvent = function (imageEditorClickEventArgs, e) {\n        var parent = this.parent;\n        var x = imageEditorClickEventArgs.point.x;\n        var y = imageEditorClickEventArgs.point.y;\n        var cursor = parent.activeObj.shape && parent.activeObj.shape === 'text' ?\n            parent.cursor : 'default';\n        if (this.currentDrawingShape !== '') {\n            var object_1 = { currObj: {} };\n            parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object_1 } });\n            this.initialPrevObj = object_1['currObj'];\n            this.initialPrevObj.objColl = extend([], parent.objColl, [], true);\n            this.initialPrevObj.pointColl = extend([], parent.pointColl, [], true);\n            this.initialPrevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n            var selPointCollObj = { selPointColl: null };\n            parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                value: { obj: selPointCollObj } });\n            this.initialPrevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n            this.setActivePoint(x, y);\n            if (this.currentDrawingShape === 'path') {\n                var point = this.getImagePoints(x, y);\n                parent.activeObj.pointColl.push({ x: point.x, y: point.y });\n                if (parent.activeObj.activePoint.width !== 0 && parent.activeObj.activePoint.height !== 0) {\n                    parent.activeObj.activePoint.width = 0;\n                    parent.activeObj.activePoint.height = 0;\n                    parent.activeObj.activePoint.startX = parent.activeObj.pointColl[parent.activeObj.pointColl.length - 1].x;\n                    parent.activeObj.activePoint.startY = parent.activeObj.pointColl[parent.activeObj.pointColl.length - 1].y;\n                }\n            }\n            parent.activeObj.activePoint.endX = parent.activeObj.activePoint.startX;\n            parent.activeObj.activePoint.endY = parent.activeObj.activePoint.startY;\n            parent.currObjType.isDragging = true;\n            return;\n        }\n        if (this.isCropSelection && this.dragCanvas) {\n            this.setCursor(x, y);\n            if (parent.cursor !== 'move' && parent.cursor !== 'crosshair' &&\n                parent.cursor !== 'default' && parent.cursor !== 'grab') {\n                this.isPan = false;\n            }\n        }\n        if (parent.activeObj.shape) {\n            this.isObjSelected = true;\n        }\n        else {\n            this.isObjSelected = false;\n        }\n        var object = { currObj: {} };\n        parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var prevObj = object['currObj'];\n        var activeObj = extend({}, parent.activeObj, null, true);\n        var isShape = this.isShapeTouch(e, this.isCropSelection);\n        var isFreehandDraw = this.isFreehandDrawTouch(e, this.isCropSelection);\n        var isShapeClick = isShape ? isShape : this.isShapeClick(e, this.isCropSelection);\n        var allowUndoRedoPush = this.applyCurrShape(isShapeClick);\n        if (this.isTouch && !isShape && activeObj.shape && !this.isCropSelection) {\n            if (this.applyObj(x, y)) {\n                parent.okBtn(true);\n                parent.notify('draw', { prop: 'setPrevActObj', onPropertyChange: false, value: { prevActObj: null } });\n            }\n            var prevCropObj = extend({}, parent.cropObj, {}, true);\n            parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                value: { operation: 'shapeTransform', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                    previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                    previousCropObj: prevCropObj, previousText: null,\n                    currentText: null, previousFilter: null, isCircleCrop: parent.isCircleCrop } });\n            if (allowUndoRedoPush) {\n                parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n            }\n        }\n        if (!isShape && !parent.togglePen && !this.isCropSelection) {\n            if (!isBlazor()) {\n                parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n                parent.notify('toolbar', { prop: 'close-contextual-toolbar', onPropertyChange: false });\n            }\n            else if (parent.isImageLoaded) {\n                parent.updateToolbar(parent.element, 'imageLoaded', 'okBtnClick');\n            }\n        }\n        if (this.dragCanvas && this.isPan && (parent.cursor === 'grab' || this.isTouch)\n            && !isShape && !isFreehandDraw && !parent.togglePen) {\n            if (this.applyObj(x, y)) {\n                parent.okBtn(true);\n                if (allowUndoRedoPush) {\n                    parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n                }\n                parent.notify('draw', { prop: 'setPrevActObj', onPropertyChange: false, value: { prevActObj: null } });\n            }\n            if (this.isFhdEditing) {\n                parent.notify('freehand-draw', { prop: 'applyFhd', onPropertyChange: false });\n                this.isFhdCustomized = false;\n                if (!isBlazor()) {\n                    parent.notify('toolbar', { prop: 'destroy-qa-toolbar', onPropertyChange: false });\n                }\n            }\n            if (parent.activeObj.shape && (parent.activeObj.shape === 'rectangle' ||\n                parent.activeObj.shape === 'ellipse' || parent.activeObj.shape === 'line' ||\n                parent.activeObj.shape === 'arrow' || parent.activeObj.shape === 'path' || parent.activeObj.shape === 'text')) {\n                parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                    value: { x: null, y: null, isMouseDown: null } });\n                parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                if (!isBlazor()) {\n                    parent.notify('toolbar', { prop: 'setCurrentToolbar', value: { type: 'main' } });\n                    parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n                }\n                else {\n                    parent.updateToolbar(parent.element, 'imageLoaded');\n                }\n            }\n            this.canvasMouseDownHandler(e);\n        }\n        else {\n            var isLineArrow = false;\n            if (parent.activeObj.shape && (parent.activeObj.shape === 'line' ||\n                parent.activeObj.shape === 'arrow')) {\n                isLineArrow = true;\n            }\n            var points = this.setXYPoints(e);\n            var x_1 = points.x;\n            var y_1 = points.y;\n            if (this.applyObj(x_1, y_1)) {\n                parent.okBtn(true);\n                if (allowUndoRedoPush) {\n                    parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n                }\n                parent.notify('draw', { prop: 'setPrevActObj', onPropertyChange: false, value: { prevActObj: null } });\n            }\n            parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                value: { x: x_1, y: y_1, isMouseDown: true } });\n            var obj = { index: null };\n            parent.notify('freehand-draw', { prop: 'getFreehandDrawHoveredIndex', onPropertyChange: false, value: { obj: obj } });\n            var indexObj = { freehandSelectedIndex: null };\n            parent.notify('freehand-draw', { prop: 'getFreehandSelectedIndex', onPropertyChange: false, value: { obj: indexObj } });\n            if (this.isFhdPoint || (this.isFhdCustomized && !parent.togglePen)) {\n                if (!isNullOrUndefined(indexObj['freehandSelectedIndex']) &&\n                    indexObj['freehandSelectedIndex'] !== obj['index']) {\n                    var tempHoveredIndex = obj['index'];\n                    parent.okBtn();\n                    this.isFhdCustomized = false;\n                    parent.notify('freehand-draw', { prop: 'setFreehandDrawHoveredIndex', onPropertyChange: false,\n                        value: { index: tempHoveredIndex } });\n                    if (obj['index'] > -1) {\n                        var strokeColor = parent.pointColl[obj['index']].strokeColor;\n                        parent.notify('freehand-draw', { prop: 'hoverFhd', onPropertyChange: false,\n                            value: { strokeColor: strokeColor, strokeWidth: parent.pointColl[obj['index']].strokeWidth } });\n                    }\n                }\n                indexObj['freehandSelectedIndex'] = null;\n                parent.notify('freehand-draw', { prop: 'getFreehandSelectedIndex', onPropertyChange: false, value: { obj: indexObj } });\n                if (!isNullOrUndefined(obj['index']) && obj['index'] > -1) {\n                    parent.notify('freehand-draw', { prop: 'selectFhd', value: { type: 'ok' } });\n                    if (!isBlazor()) {\n                        parent.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: true } });\n                    }\n                    else {\n                        parent.updateToolbar(parent.element, 'pen');\n                        parent.updateToolbar(parent.element, 'quickAccessToolbar', 'pen');\n                    }\n                }\n                else if (indexObj['freehandSelectedIndex']) {\n                    parent.okBtn();\n                    var strokeColor = parent.pointColl[indexObj['freehandSelectedIndex']].strokeColor;\n                    parent.notify('freehand-draw', { prop: 'hoverFhd', onPropertyChange: false,\n                        value: { strokeColor: strokeColor, strokeWidth: parent.pointColl[indexObj['freehandSelectedIndex']].strokeWidth } });\n                }\n            }\n            else {\n                if (this.isFhdEditing) {\n                    parent.notify('freehand-draw', { prop: 'cancelFhd', value: { type: 'ok' } });\n                    if (document.getElementById(parent.element.id + '_quickAccessToolbarArea')) {\n                        document.getElementById(parent.element.id + '_quickAccessToolbarArea').style.display = 'none';\n                    }\n                }\n                if (!isBlazor()) {\n                    parent.notify('toolbar', { prop: 'close-contextual-toolbar', onPropertyChange: false });\n                }\n                this.isFhdEditing = false;\n                if (isLineArrow) {\n                    this.setCursor(x_1, y_1);\n                }\n                else if (cursor !== 'default') {\n                    parent.upperCanvas.style.cursor = parent.cursor = cursor;\n                }\n                // this.setCursor(x, y);\n                if (parent.cursor === 'crosshair' || (Browser.isDevice && parent.togglePen)) {\n                    if (parent.togglePen) {\n                        if (isNullOrUndefined(parent.activeObj.strokeSettings)) {\n                            var obj_1 = { strokeSettings: {} };\n                            parent.notify('shape', { prop: 'getStrokeSettings', onPropertyChange: false,\n                                value: { obj: obj_1 } });\n                            parent.activeObj.strokeSettings = obj_1['strokeSettings'];\n                        }\n                        var obj_2 = { penStrokeWidth: null };\n                        parent.notify('freehand-draw', { prop: 'getPenStrokeWidth', onPropertyChange: false, value: { obj: obj_2 } });\n                        if (isNullOrUndefined(obj_2['penStrokeWidth'])) {\n                            parent.notify('freehand-draw', { prop: 'setPenStrokeWidth', onPropertyChange: false, value: { value: 2 } });\n                        }\n                        this.upperContext.strokeStyle = parent.activeObj.strokeSettings.strokeColor;\n                        this.upperContext.fillStyle = parent.activeObj.strokeSettings.strokeColor;\n                        parent.notify('freehand-draw', { prop: 'freehandDownHandler', onPropertyChange: false,\n                            value: { e: e, canvas: parent.upperCanvas } });\n                    }\n                    else {\n                        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                    }\n                    parent.currObjType.isActiveObj = false;\n                    this.dragElement = '';\n                    this.dragPoint.startX = this.dragPoint.startY = this.dragPoint.endX = this.dragPoint.endY = 0;\n                }\n                if ((parent.cursor !== 'crosshair' && e.type.toLowerCase() === 'touchstart') ||\n                    (parent.currObjType.isActiveObj && parent.cursor !== 'default' && !parent.togglePen)) {\n                    if (parent.currObjType.isUndoAction) {\n                        parent.notify('undo-redo', { prop: 'refreshUrc', value: { bool: null } });\n                    }\n                    this.findTarget(x_1, y_1, e.type);\n                }\n                else if ((parent.currObjType.shape === '' || parent.currObjType.isCustomCrop) && !parent.togglePen && parent.cursor !== 'default') {\n                    this.setActivePoint(x_1, y_1);\n                }\n            }\n        }\n        this.isShapeInserted = false;\n        this.tempActiveObj = extend({}, parent.activeObj, {}, true);\n    };\n    Selection.prototype.mouseMoveEventHandler = function (e) {\n        var parent = this.parent;\n        var cursor = parent.cursor;\n        var canvasCursor = parent.upperCanvas.style.cursor;\n        e.preventDefault();\n        var bbox = parent.lowerCanvas.getBoundingClientRect();\n        if (e.type === 'touchmove' && e.touches.length === 2) {\n            if (this.isFirstMove) {\n                this.startTouches = this.targetTouches(e.touches);\n                this.tempTouches = [];\n                this.tempTouches.push({ x: (e.touches[0].clientX || (e.touches[0].pageX - parent.lowerCanvas.offsetLeft) - bbox.left),\n                    y: (e.touches[0].clientY || (e.touches[0].pageY - parent.lowerCanvas.offsetTop)) - bbox.top });\n                this.tempTouches.push({ x: (e.touches[1].clientX || (e.touches[1].pageX - parent.lowerCanvas.offsetLeft)) - bbox.left,\n                    y: (e.touches[1].clientY || (e.touches[1].pageY - parent.lowerCanvas.offsetTop)) - bbox.top });\n            }\n            else {\n                var firstFingerX = (e.touches[0].clientX || (e.touches[0].pageX - parent.lowerCanvas.offsetLeft)) - bbox.left;\n                var firstFingerY = (e.touches[0].clientY || (e.touches[0].pageY - parent.lowerCanvas.offsetTop)) - bbox.top;\n                var secondFingerX = (e.touches[1].clientX || (e.touches[1].pageX - parent.lowerCanvas.offsetLeft)) - bbox.left;\n                var secondFingerY = (e.touches[1].clientY || (e.touches[1].pageY - parent.lowerCanvas.offsetTop)) - bbox.top;\n                var center = { x: firstFingerX < secondFingerX ? secondFingerX - ((secondFingerX - firstFingerX) / 2) :\n                        firstFingerX - ((firstFingerX - secondFingerX) / 2), y: firstFingerY < secondFingerY ?\n                        secondFingerY - ((secondFingerY - firstFingerY) / 2) : firstFingerY - ((firstFingerY - secondFingerY) / 2) };\n                if (this.currMousePoint.x !== center.x && this.currMousePoint.y !== center.y) {\n                    var type = '';\n                    if (e.type === 'touchmove' && (parent.zoomSettings.zoomTrigger & ZoomTrigger.Pinch) === ZoomTrigger.Pinch) {\n                        this.zoomType = 'Pinch';\n                        var scale = this.calculateScale(this.startTouches, this.targetTouches(e.touches));\n                        this.startTouches = this.targetTouches(e.touches);\n                        if (scale > 1) {\n                            type = 'zoomIn';\n                        }\n                        else if (scale < 1) {\n                            type = 'zoomOut';\n                        }\n                    }\n                    if (type !== '') {\n                        parent.notify('draw', { prop: 'performPointZoom', onPropertyChange: false,\n                            value: { x: center.x, y: center.y, type: type } });\n                    }\n                    this.tempTouches = [];\n                    this.tempTouches.push({ x: e.touches[0].clientX || (e.touches[0].pageX - parent.lowerCanvas.offsetLeft),\n                        y: e.touches[0].clientY || (e.touches[0].pageY - parent.lowerCanvas.offsetTop) });\n                    this.tempTouches.push({ x: e.touches[1].clientX || (e.touches[1].pageX - parent.lowerCanvas.offsetLeft),\n                        y: e.touches[1].clientY || (e.touches[1].pageY - parent.lowerCanvas.offsetTop) });\n                    this.currMousePoint.x = center.x;\n                    this.currMousePoint.y = center.y;\n                }\n            }\n            this.isFirstMove = false;\n            return;\n        }\n        var x;\n        var y;\n        if (e.type === 'mousemove') {\n            x = e.clientX;\n            y = e.clientY;\n        }\n        else {\n            this.touchEndPoint.x = x = e.touches[0].clientX;\n            this.touchEndPoint.y = y = e.touches[0].clientY;\n        }\n        x -= bbox.left;\n        y -= bbox.top;\n        this.canvasMouseMoveHandler(e);\n        var isCropSelection = false;\n        var splitWords;\n        if (parent.activeObj.shape !== undefined) {\n            splitWords = parent.activeObj.shape.split('-');\n        }\n        if (splitWords !== undefined && splitWords[0] === 'crop') {\n            isCropSelection = true;\n        }\n        if (isCropSelection) {\n            parent.notify('transform', { prop: 'disableZoomOutBtn', value: { isZoomOut: true } });\n        }\n        parent.upperCanvas.style.cursor = canvasCursor;\n        parent.cursor = cursor;\n        if (parent.currObjType.isActiveObj && (parent.activeObj.activePoint !== undefined || parent.objColl.length > 0) &&\n            !this.dragCanvas || parent.activeObj.activePoint !== undefined) {\n            if (this.dragElement === '') {\n                this.setCursor(x, y);\n                if ((parent.activeObj.activePoint &&\n                    (parent.activeObj.activePoint.width === 0 || (!isNullOrUndefined(parent.activeObj.currIndex) &&\n                        this.cursorTargetId !== parent.activeObj.currIndex)))\n                    && parent.cursor !== 'default' &&\n                    parent.cursor !== 'move' && parent.cursor !== 'crosshair'\n                    && parent.cursor !== 'grab' && parent.cursor !== 'pointer') {\n                    parent.upperCanvas.style.cursor = parent.cursor = 'move';\n                }\n                this.findTarget(x, y, e.type);\n            }\n        }\n        if (parent.currObjType.isDragging) {\n            this.upperContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n            this.updateActivePoint(x, y, isCropSelection);\n            parent.notify('shape', { prop: 'updateTrianglePoints', onPropertyChange: false, value: { obj: parent.activeObj } });\n            if (this.isPreventDragging) {\n                if ((parent.activeObj.activePoint.startX > parent.img.destLeft) &&\n                    (parent.activeObj.activePoint.endX < parent.img.destLeft + parent.img.destWidth) &&\n                    (parent.activeObj.activePoint.startY > parent.img.destTop)\n                    && (parent.activeObj.activePoint.endY < parent.img.destTop + parent.img.destHeight)) {\n                    this.isPreventDragging = false;\n                }\n                parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: null, isCropRatio: null,\n                        points: null, isPreventDrag: true, saveContext: null, isPreventSelection: null } });\n            }\n            else {\n                parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: null, isCropRatio: null,\n                        points: null, isPreventDrag: null, saveContext: null, isPreventSelection: null } });\n            }\n            if (isCropSelection) {\n                this.dragCanvas = parent.togglePan = true;\n            }\n        }\n    };\n    Selection.prototype.mouseUpEventHandler = function (e) {\n        var _this = this;\n        var parent = this.parent;\n        if (e.type === 'touchstart') {\n            this.isTouch = false;\n        }\n        else if (e.type === 'touchend') {\n            e.stopImmediatePropagation();\n        }\n        e.preventDefault();\n        if (parent.togglePan) {\n            this.canvasMouseUpHandler(e);\n        }\n        var x;\n        var y;\n        if (e.type === 'mouseup') {\n            x = e.clientX;\n            y = e.clientY;\n        }\n        else {\n            x = this.touchEndPoint.x;\n            y = this.touchEndPoint.y;\n        }\n        var bbox = parent.lowerCanvas.getBoundingClientRect();\n        x -= bbox.left;\n        y -= bbox.top;\n        if (e.type === 'touchend') {\n            this.startTouches = this.tempTouches = [];\n            this.isFirstMove = false;\n            if (parent.textArea.style.display === 'none') {\n                this.timer = 0;\n            }\n        }\n        var isCropSelection = false;\n        var splitWords;\n        if (parent.activeObj.shape !== undefined) {\n            splitWords = parent.activeObj.shape.split('-');\n        }\n        if (splitWords !== undefined && splitWords[0] === 'crop') {\n            isCropSelection = true;\n        }\n        if (isBlazor() && this.parent.eventType) {\n            if (this.parent.eventType === 'pan') {\n                if (parent.events && parent.events.onPanEnd.hasDelegate === true) {\n                    parent.dotNetRef.invokeMethodAsync('PanEventAsync', 'OnPanEnd', this.parent.panEventArgs);\n                }\n            }\n            else if (this.parent.eventType === 'resize') {\n                if (!this.isCropSelection && this.parent.events && this.parent.events.onShapeResizeEnd.hasDelegate === true) {\n                    this.shapeResizingArgs.currentShapeSettings = this.updatePrevShapeSettings();\n                    this.shapeResizingArgs.action = this.currentDrawingShape !== '' ? 'drawing' : 'resize-end';\n                    /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                    this.parent.dotNetRef.invokeMethodAsync('ShapeEventAsync', 'OnShapeResizeEnd', this.shapeResizingArgs).then(function (shapeResizingArgs) {\n                        _this.parent.notify('shape', { prop: 'updateShapeChangeEventArgs', onPropertyChange: false,\n                            value: { shapeSettings: shapeResizingArgs.currentShapeSettings } });\n                    });\n                }\n                else if (this.shapeResizingArgs && this.selectionResizingArgs && this.parent.events &&\n                    this.parent.events.onSelectionResizeEnd.hasDelegate === true) {\n                    var currentSelectionSettings = { type: this.parent.activeObj.shape,\n                        startX: this.shapeResizingArgs.currentShapeSettings.startX,\n                        startY: this.shapeResizingArgs.currentShapeSettings.startY,\n                        width: this.shapeResizingArgs.currentShapeSettings.width,\n                        height: this.shapeResizingArgs.currentShapeSettings.height };\n                    this.selectionResizingArgs.currentSelectionSettings = currentSelectionSettings;\n                    this.selectionResizingArgs.action = 'resize-end';\n                    /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                    this.parent.dotNetRef.invokeMethodAsync('SelectionEventAsync', 'OnSelectionResizeEnd', this.selectionResizingArgs).then(function (selectionResizingArgs) {\n                        _this.parent.notify('shape', { prop: 'updateSelectionChangeEventArgs', onPropertyChange: false,\n                            value: { selectionSettings: selectionResizingArgs.currentSelectionSettings } });\n                    });\n                }\n            }\n            else {\n                if (this.shapeMovingArgs && this.parent.events && this.parent.events.onShapeDragEnd.hasDelegate === true) {\n                    this.shapeMovingArgs.currentShapeSettings = this.updatePrevShapeSettings();\n                    this.shapeMovingArgs.action = 'drag-end';\n                    /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                    this.parent.dotNetRef.invokeMethodAsync('ShapeEventAsync', 'OnShapeDragEnd', this.shapeMovingArgs).then(function (shapeMovingArgs) {\n                        _this.parent.notify('shape', { prop: 'updateShapeChangeEventArgs', onPropertyChange: false,\n                            value: { shapeSettings: shapeMovingArgs.currentShapeSettings } });\n                    });\n                }\n            }\n            this.shapeResizingArgs = null;\n            this.shapeMovingArgs = null;\n            this.parent.panEventArgs = null;\n            this.parent.eventType = null;\n        }\n        if (this.currentDrawingShape === 'path') {\n            return;\n        }\n        if (e.currentTarget === parent.upperCanvas) {\n            this.pathAdjustedIndex = null;\n            if (this.currentDrawingShape !== '') {\n                if (this.currentDrawingShape === 'text') {\n                    var prevCropObj_1 = extend({}, parent.cropObj, {}, true);\n                    parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                        value: { operation: 'shapeTransform', previousObj: this.initialPrevObj, previousObjColl: this.initialPrevObj.objColl,\n                            previousPointColl: this.initialPrevObj.pointColl, previousSelPointColl: this.initialPrevObj.selPointColl,\n                            previousCropObj: prevCropObj_1, previousText: null,\n                            currentText: null, previousFilter: null, isCircleCrop: null } });\n                }\n                else {\n                    parent.notify('undo-redo', { prop: 'updateUrObj', onPropertyChange: false, value: { objColl: this.initialPrevObj.objColl } });\n                }\n                this.isShapeInserted = true;\n                this.currentDrawingShape = '';\n                if (parent.activeObj.activePoint.width === 0 && parent.activeObj.activePoint.height === 0) {\n                    parent.notify('draw', { prop: 'performCancel', value: { isContextualToolbar: null } });\n                }\n            }\n            this.adjustActObjForLineArrow();\n            this.updPtCollForShpRot();\n            parent.currObjType.shape = parent.currObjType.shape.toLowerCase();\n            var prevCropObj = extend({}, parent.cropObj, {}, true);\n            var object = { currObj: {} };\n            parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n            var prevObj = object['currObj'];\n            prevObj.objColl = extend([], parent.objColl, [], true);\n            prevObj.pointColl = extend([], parent.pointColl, [], true);\n            prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n            var selPointCollObj = { selPointColl: null };\n            parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                value: { obj: selPointCollObj } });\n            prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n            if (!parent.togglePen && !isCropSelection) {\n                if (this.tempObjColl && parent.activeObj.activePoint.width !== 0) {\n                    parent.objColl.push(parent.activeObj);\n                    if (JSON.stringify(parent.activeObj.activePoint) !== JSON.stringify(this.tempActiveObj.activePoint)) {\n                        parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                            value: { operation: 'shapeTransform', previousObj: prevObj, previousObjColl: this.tempObjColl,\n                                previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                                previousCropObj: prevCropObj, previousText: null,\n                                currentText: null, previousFilter: null, isCircleCrop: null } });\n                    }\n                    this.redrawShape(parent.objColl[parent.objColl.length - 1], true);\n                    this.tempObjColl = undefined;\n                }\n                if (!this.isFhdEditing) {\n                    this.applyCurrActObj(x, y);\n                    parent.currObjType.isResize = false;\n                    if (!isBlazor()) {\n                        parent.notify('toolbar', { prop: 'destroy-qa-toolbar', onPropertyChange: false });\n                    }\n                }\n            }\n            if (parent.activeObj) {\n                var isCropSelection_1 = false;\n                var splitWords_1;\n                if (parent.activeObj.shape !== undefined) {\n                    splitWords_1 = parent.activeObj.shape.split('-');\n                }\n                if (splitWords_1 === undefined && (parent.currObjType.isCustomCrop || parent.togglePen)) {\n                    isCropSelection_1 = true;\n                }\n                else if (splitWords_1 !== undefined && splitWords_1[0] === 'crop') {\n                    isCropSelection_1 = true;\n                }\n                if (!isBlazor()) {\n                    if ((parent.activeObj.shape === 'rectangle') || (parent.activeObj.shape === 'ellipse')\n                        || (parent.activeObj.shape === 'line' || parent.activeObj.shape === 'arrow' || parent.activeObj.shape === 'path')) {\n                        parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'shapes',\n                                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                    }\n                    else if (parent.activeObj.shape === 'text') {\n                        parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'text',\n                                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                    }\n                    else if (this.isFhdEditing) {\n                        parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'pen',\n                                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                    }\n                    else if (!isCropSelection_1) {\n                        var eventargs = { type: 'main', isApplyBtn: null, isCropping: false, isZooming: null };\n                        parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: eventargs });\n                    }\n                    parent.notify('toolbar', { prop: 'update-toolbar-items', onPropertyChange: false });\n                }\n                else {\n                    if ((parent.activeObj.shape === 'rectangle') || (parent.activeObj.shape === 'ellipse')\n                        || (parent.activeObj.shape === 'line' || parent.activeObj.shape === 'arrow' || parent.activeObj.shape === 'path')) {\n                        parent.updateToolbar(parent.element, parent.activeObj.shape);\n                    }\n                    else if (parent.activeObj.shape === 'text') {\n                        parent.updateToolbar(parent.element, 'text');\n                    }\n                }\n            }\n        }\n        if (parent.activeObj.shape !== undefined) {\n            splitWords = parent.activeObj.shape.split('-');\n        }\n        if (splitWords !== undefined && splitWords[0] === 'crop') {\n            isCropSelection = true;\n        }\n        if (parent.activeObj.shape && !isCropSelection && e.currentTarget === parent.upperCanvas &&\n            parent.textArea.style.display === 'none') {\n            if (parent.activeObj.shape === 'text') {\n                if (!isBlazor()) {\n                    parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'text',\n                            isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                }\n            }\n            else {\n                if (!isBlazor()) {\n                    parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'shapes',\n                            isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                }\n            }\n            if (!isBlazor()) {\n                parent.notify('toolbar', { prop: 'update-toolbar-items', onPropertyChange: false });\n                parent.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: null } });\n            }\n            else {\n                parent.updateToolbar(parent.element, 'quickAccessToolbar', parent.activeObj.shape);\n            }\n        }\n        if (parent.togglePen && e.currentTarget === parent.upperCanvas) {\n            parent.notify('freehand-draw', { prop: 'freehandUpHandler', onPropertyChange: false,\n                value: { e: e, canvas: parent.upperCanvas, context: this.upperContext } });\n        }\n        else {\n            parent.currObjType.shape = '';\n        }\n        this.dragElement = '';\n        parent.currObjType.isInitialLine = parent.currObjType.isDragging = false;\n        this.selMouseUpEvent();\n    };\n    Selection.prototype.adjustActObjForLineArrow = function (obj) {\n        var isAdjusted = false;\n        var parent = this.parent;\n        obj = obj ? obj : parent.activeObj;\n        if (obj.shape && (obj.shape === 'line' || parent.activeObj.shape === 'arrow')) {\n            var temp = void 0;\n            if ((this.dragElement === 'e-resize' && obj.activePoint.endX < obj.activePoint.startX) ||\n                (this.dragElement === 'w-resize' && obj.activePoint.startX > obj.activePoint.endX)) {\n                isAdjusted = true;\n                temp = obj.activePoint.startX;\n                obj.activePoint.startX = obj.activePoint.endX;\n                obj.activePoint.endX = temp;\n                temp = obj.activePoint.startY;\n                obj.activePoint.startY = obj.activePoint.endY;\n                obj.activePoint.endY = temp;\n            }\n            obj.activePoint.width = Math.abs(obj.activePoint.endX - obj.activePoint.startX);\n            obj.activePoint.height = Math.abs(obj.activePoint.endY - obj.activePoint.startY);\n            if (parent.activeObj.shape !== 'path') {\n                parent.notify('shape', { prop: 'setPointCollForLineArrow', onPropertyChange: false,\n                    value: { obj: obj } });\n                // Updating ratio for point collection\n                for (var i = 0; i < obj.pointColl.length; i++) {\n                    obj.pointColl[i].ratioX = (obj.pointColl[i].x -\n                        parent.img.destLeft) / parent.img.destWidth;\n                    obj.pointColl[i].ratioY = (obj.pointColl[i].y -\n                        parent.img.destTop) / parent.img.destHeight;\n                }\n            }\n        }\n        return isAdjusted;\n    };\n    Selection.prototype.updPtCollForShpRot = function (obj) {\n        var parent = this.parent;\n        obj = obj ? obj : parent.activeObj;\n        if (obj.shape && obj.rotatedAngle !== 0) {\n            parent.notify('shape', { prop: 'setPointCollForShapeRotation', onPropertyChange: false,\n                value: { obj: obj } });\n            // Updating ratio for point collection\n            for (var i = 0; i < obj.horTopLinePointColl.length; i++) {\n                obj.horTopLinePointColl[i].ratioX = (obj.horTopLinePointColl[i].x -\n                    parent.img.destLeft) / parent.img.destWidth;\n                obj.horTopLinePointColl[i].ratioY = (obj.horTopLinePointColl[i].y -\n                    parent.img.destTop) / parent.img.destHeight;\n            }\n            for (var i = 0; i < obj.horBottomLinePointColl.length; i++) {\n                obj.horBottomLinePointColl[i].ratioX = (obj.horBottomLinePointColl[i].x -\n                    parent.img.destLeft) / parent.img.destWidth;\n                obj.horBottomLinePointColl[i].ratioY = (obj.horBottomLinePointColl[i].y -\n                    parent.img.destTop) / parent.img.destHeight;\n            }\n            for (var i = 0; i < obj.verLeftLinePointColl.length; i++) {\n                obj.verLeftLinePointColl[i].ratioX = (obj.verLeftLinePointColl[i].x -\n                    parent.img.destLeft) / parent.img.destWidth;\n                obj.verLeftLinePointColl[i].ratioY = (obj.verLeftLinePointColl[i].y -\n                    parent.img.destTop) / parent.img.destHeight;\n            }\n            for (var i = 0; i < obj.verRightLinePointColl.length; i++) {\n                obj.verRightLinePointColl[i].ratioX = (obj.verRightLinePointColl[i].x -\n                    parent.img.destLeft) / parent.img.destWidth;\n                obj.verRightLinePointColl[i].ratioY = (obj.verRightLinePointColl[i].y -\n                    parent.img.destTop) / parent.img.destHeight;\n            }\n        }\n    };\n    Selection.prototype.setXYPoints = function (e) {\n        e.preventDefault();\n        var x;\n        var y;\n        if (e.type === 'mousedown') {\n            x = e.clientX;\n            y = e.clientY;\n        }\n        else {\n            this.touchEndPoint.x = x = e.touches[0].clientX;\n            this.touchEndPoint.y = y = e.touches[0].clientY;\n        }\n        var bbox = this.parent.lowerCanvas.getBoundingClientRect();\n        x -= bbox.left;\n        y -= bbox.top;\n        return { x: x, y: y };\n    };\n    Selection.prototype.getCurrentIndex = function () {\n        var index;\n        var parent = this.parent;\n        for (var i = 0; i < parent.objColl.length; i++) {\n            if (parent.activeObj.currIndex === parent.objColl[i].currIndex) {\n                index = i;\n                break;\n            }\n        }\n        return index;\n    };\n    Selection.prototype.isShapeClick = function (e, isCropSelection) {\n        var parent = this.parent;\n        var isShape = false;\n        if (parent.togglePen) {\n            return isShape;\n        }\n        if (parent.activeObj.shape && parent.activeObj.shape === 'text' && this.isShapeInserted) {\n            var isTextArea = parent.textArea.style.display === 'block' ? true : false;\n            var activeObj = extend({}, parent.activeObj, null, true);\n            parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                value: { x: null, y: null, isMouseDown: true } });\n            var points = this.setXYPoints(e);\n            var x = points.x;\n            var y = points.y;\n            isShape = this.findTargetObj(x, y, isCropSelection);\n            if (!isCropSelection) {\n                this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            }\n            if (isTextArea) {\n                parent.textArea.value = parent.objColl[parent.objColl.length - 1].keyHistory;\n                parent.textArea.style.display = 'block';\n                parent.activeObj = activeObj;\n                var index = this.getCurrentIndex();\n                if (isNullOrUndefined(index)) {\n                    parent.objColl.pop();\n                }\n                else {\n                    parent.objColl.splice(index, 1);\n                }\n            }\n            else if (!isShape && activeObj.shape) {\n                parent.activeObj = activeObj;\n                var index = this.getCurrentIndex();\n                if ((!isNullOrUndefined(index) &&\n                    JSON.stringify(parent.activeObj.activePoint) === JSON.stringify(parent.objColl[index].activePoint))) {\n                    parent.objColl.splice(index, 1);\n                }\n                else if (isNullOrUndefined(parent.activeObj.currIndex)) {\n                    parent.objColl.pop();\n                }\n            }\n        }\n        return isShape;\n    };\n    Selection.prototype.isShapeTouch = function (e, isCropSelection) {\n        var parent = this.parent;\n        var isShape = false;\n        if (e.type === 'touchstart' && !parent.togglePen) {\n            if (parent.activeObj && parent.activeObj.shape === 'text') {\n                this.timer = setTimeout(this.setTimer.bind(this), 1000, e);\n            }\n            var isTextArea = parent.textArea.style.display === 'block' ? true : false;\n            var activeObj = extend({}, parent.activeObj, null, true);\n            parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                value: { x: null, y: null, isMouseDown: true } });\n            var points = this.setXYPoints(e);\n            var x = points.x;\n            var y = points.y;\n            isShape = this.findTargetObj(x, y, isCropSelection);\n            if (!isCropSelection) {\n                this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            }\n            if (isTextArea) {\n                parent.textArea.value = parent.objColl[parent.objColl.length - 1].keyHistory;\n                parent.textArea.style.display = 'block';\n                parent.activeObj = activeObj;\n                var index = this.getCurrentIndex();\n                if (isNullOrUndefined(index)) {\n                    parent.objColl.pop();\n                }\n                else {\n                    parent.objColl.splice(index, 1);\n                }\n            }\n            else if (!isShape && activeObj.shape) {\n                parent.activeObj = activeObj;\n                var index = this.getCurrentIndex();\n                if (!isCropSelection) {\n                    if ((!isNullOrUndefined(index) && JSON.stringify(parent.activeObj.activePoint) ===\n                        JSON.stringify(parent.objColl[index].activePoint))) {\n                        parent.objColl.splice(index, 1);\n                    }\n                    else if (isNullOrUndefined(parent.activeObj.currIndex)) {\n                        parent.objColl.pop();\n                    }\n                }\n            }\n            // this.timer = null;\n        }\n        return isShape;\n    };\n    Selection.prototype.isFreehandDrawTouch = function (e, isCropSelection) {\n        var parent = this.parent;\n        var isFreehandDraw = false;\n        if (e.type === 'touchstart' && !isCropSelection && !parent.togglePen) {\n            var isTextArea = parent.textArea.style.display === 'block' ? true : false;\n            var activeObj = extend({}, parent.activeObj, null, true);\n            parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                value: { x: null, y: null, isMouseDown: true } });\n            var points = this.setXYPoints(e);\n            var x = points.x;\n            var y = points.y;\n            this.setCursor(x, y);\n            if (this.isFhdPoint) {\n                isFreehandDraw = true;\n            }\n            if (isTextArea) {\n                parent.textArea.value = parent.objColl[parent.objColl.length - 1].keyHistory;\n                parent.textArea.style.display = 'block';\n                parent.activeObj = activeObj;\n                var index = this.getCurrentIndex();\n                if (isNullOrUndefined(index)) {\n                    parent.objColl.pop();\n                }\n                else {\n                    parent.objColl.splice(index, 1);\n                }\n            }\n            else if (activeObj.shape) {\n                parent.activeObj = activeObj;\n                var index = this.getCurrentIndex();\n                if (!isCropSelection) {\n                    if ((!isNullOrUndefined(index) && JSON.stringify(parent.activeObj.activePoint) ===\n                        JSON.stringify(parent.objColl[index].activePoint))) {\n                        parent.objColl.splice(index, 1);\n                    }\n                    else if (isNullOrUndefined(parent.activeObj.currIndex)) {\n                        parent.objColl.pop();\n                    }\n                }\n            }\n        }\n        return isFreehandDraw;\n    };\n    Selection.prototype.applyObj = function (x, y) {\n        var parent = this.parent;\n        var isApply = false;\n        if (parent.activeObj.shape && (parent.activeObj.shape === 'rectangle' || parent.activeObj.shape === 'ellipse' ||\n            parent.activeObj.shape === 'text' || parent.activeObj.shape === 'line' || parent.activeObj.shape === 'arrow' ||\n            parent.activeObj.shape === 'path')) {\n            if (x >= (parent.activeObj.activePoint.startX - (parent.activeObj.topLeftCircle.radius * 2)) &&\n                x <= (parent.activeObj.activePoint.endX + (parent.activeObj.topLeftCircle.radius * 2)) &&\n                y >= (parent.activeObj.activePoint.startY - (parent.activeObj.topLeftCircle.radius * 2)) &&\n                y <= (parent.activeObj.activePoint.endY + (parent.activeObj.topLeftCircle.radius * 2))) {\n                isApply = false;\n            }\n            else if (parent.upperCanvas.style.cursor !== 'default' && parent.upperCanvas.style.cursor !== 'grab' &&\n                parent.upperCanvas.style.cursor !== 'crosshair' && parent.upperCanvas.style.cursor !== 'pointer' &&\n                parent.upperCanvas.style.cursor !== 'move') {\n                isApply = false;\n            }\n            else {\n                isApply = true;\n            }\n        }\n        return isApply;\n    };\n    Selection.prototype.applyCurrShape = function (isShapeClick) {\n        var parent = this.parent;\n        var isApply = false;\n        if (parent.togglePen) {\n            return isApply;\n        }\n        var obj = extend({}, parent.activeObj, null, true);\n        if (this.isShapeInserted && parent.activeObj.shape === 'text' && isShapeClick) {\n            this.isInitialTextEdited = true;\n            parent.notify('draw', { prop: 'setShapeTextInsert', onPropertyChange: false, value: { bool: true } });\n        }\n        if (parent.textArea.style.display === 'block') {\n            var activeObj = extend({}, parent.activeObj, null, true);\n            parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                value: { x: null, y: null, isMouseDown: null } });\n            obj = extend({}, parent.objColl[parent.objColl.length - 1], null, true);\n            parent.objColl.pop();\n            parent.activeObj = extend({}, activeObj, null, true);\n            parent.textArea.value = obj.keyHistory;\n            parent.textArea.style.display = 'block';\n            var strokeColor = obj.strokeSettings && obj.strokeSettings.strokeColor ? obj.strokeSettings.strokeColor.split('(')[0] === 'rgb' ?\n                this.rgbToHex(parseFloat(obj.strokeSettings.strokeColor.split('(')[1].split(',')[0]), parseFloat(obj.strokeSettings.strokeColor.split('(')[1].split(',')[1]), parseFloat(obj.strokeSettings.strokeColor.split('(')[1].split(',')[2])) :\n                obj.strokeSettings.strokeColor : null;\n            if (strokeColor && strokeColor === '#ffffff') {\n                strokeColor = '#fff';\n            }\n            if (this.tempActiveObj.strokeSettings && this.tempActiveObj.strokeSettings.strokeColor &&\n                this.tempActiveObj.strokeSettings.strokeColor === '#ffffff') {\n                this.tempActiveObj.strokeSettings.strokeColor = '#fff';\n            }\n            if (obj.keyHistory !== this.tempActiveObj.keyHistory ||\n                (strokeColor && (strokeColor !== this.tempActiveObj.strokeSettings.strokeColor)) ||\n                obj.textSettings.fontFamily !== this.tempActiveObj.textSettings.fontFamily ||\n                Math.round(obj.textSettings.fontSize) !== Math.round(this.tempActiveObj.textSettings.fontSize) ||\n                Math.round(obj.textSettings.fontRatio) !== Math.round(this.tempActiveObj.textSettings.fontRatio) ||\n                obj.textSettings.bold !== this.tempActiveObj.textSettings.bold ||\n                obj.textSettings.italic !== this.tempActiveObj.textSettings.italic ||\n                obj.textSettings.underline !== this.tempActiveObj.textSettings.underline) {\n                isApply = true;\n            }\n            if (this.isInitialTextEdited && !isApply) {\n                isApply = true;\n                this.isInitialTextEdited = false;\n            }\n        }\n        else {\n            this.tempActiveObj.activePoint.height = Math.abs(this.tempActiveObj.activePoint.height);\n            isApply = JSON.stringify(obj) !== JSON.stringify(this.tempActiveObj);\n        }\n        return isApply;\n    };\n    Selection.prototype.canvasMouseDownHandler = function (e) {\n        var parent = this.parent;\n        e.preventDefault();\n        var x;\n        var y;\n        if (e.type === 'mousedown') {\n            x = e.offsetX || (e.pageX - parent.lowerCanvas.offsetLeft);\n            y = e.offsetY || (e.pageY - parent.lowerCanvas.offsetTop);\n        }\n        else {\n            x = e.touches[0].clientX || (e.touches[0].pageX - parent.lowerCanvas.offsetLeft);\n            y = e.touches[0].clientY || (e.touches[0].pageY - parent.lowerCanvas.offsetTop);\n        }\n        var bbox = parent.lowerCanvas.getBoundingClientRect();\n        x -= bbox.left;\n        y -= bbox.top;\n        this.panDown = { x: x, y: y };\n        var tempPanMoveObj = { tempPanMove: null };\n        parent.notify('transform', { prop: 'getTempPanMove', onPropertyChange: false,\n            value: { obj: tempPanMoveObj } });\n        if (isNullOrUndefined(tempPanMoveObj['tempPanMove'])) {\n            parent.notify('transform', { prop: 'setTempPanMove', onPropertyChange: false,\n                value: { point: { x: x, y: y } } });\n        }\n    };\n    Selection.prototype.canvasMouseMoveHandler = function (e) {\n        var parent = this.parent;\n        if (this.dragCanvas) {\n            parent.lowerCanvas.style.cursor = 'grab';\n        }\n        else {\n            this.dragCanvas = parent.togglePan = false;\n            parent.lowerCanvas.style.cursor = parent.upperCanvas.style.cursor = parent.cursor = 'default';\n        }\n        var x;\n        var y;\n        if (e.type === 'mousemove') {\n            x = e.offsetX;\n            y = e.offsetY;\n        }\n        else {\n            x = e.touches[0].clientX || (e.touches[0].pageX - parent.lowerCanvas.offsetLeft);\n            y = e.touches[0].clientY || (e.touches[0].pageY - parent.lowerCanvas.offsetTop);\n        }\n        var bbox = parent.lowerCanvas.getBoundingClientRect();\n        x -= bbox.left;\n        y -= bbox.top;\n        var panMove = { x: x, y: y };\n        parent.notify('transform', { prop: 'setPanMove', onPropertyChange: false,\n            value: { point: { x: x, y: y } } });\n        if (this.panDown && panMove && parent.togglePan && this.dragCanvas) {\n            parent.notify('transform', { prop: 'drawPannedImage', onPropertyChange: false,\n                value: { xDiff: null, yDiff: null } });\n        }\n    };\n    Selection.prototype.canvasMouseUpHandler = function (e) {\n        var parent = this.parent;\n        e.preventDefault();\n        var panMoveObj = { panMove: null };\n        parent.notify('transform', { prop: 'getPanMove', onPropertyChange: false,\n            value: { obj: panMoveObj } });\n        if (parent.togglePan) {\n            if (this.panDown && panMoveObj['panMove'] && parent.togglePan && this.dragCanvas) {\n                this.panDown = null;\n                parent.notify('transform', { prop: 'setPanMove', onPropertyChange: false,\n                    value: { point: null } });\n                parent.notify('transform', { prop: 'setTempPanMove', onPropertyChange: false,\n                    value: { point: null } });\n            }\n        }\n        if (this.currentDrawingShape !== 'path') {\n            parent.currObjType.isDragging = false;\n        }\n    };\n    Selection.prototype.touchStartHandler = function (e) {\n        e.preventDefault();\n        if (this.touchTime === 0) {\n            this.touchTime = new Date().getTime();\n        }\n        else {\n            if (((new Date().getTime()) - this.touchTime) < 400) {\n                this.parent.notify('shape', { prop: 'stopPathDrawing', onPropertyChange: false, value: { e: e } });\n                this.touchTime = 0;\n            }\n            else {\n                this.touchTime = new Date().getTime();\n            }\n        }\n        if (e.touches.length === 2) {\n            this.isFirstMove = true;\n        }\n        else {\n            this.mouseDownEventHandler(e);\n        }\n        EventHandler.add(this.parent.lowerCanvas, 'touchend', this.mouseUpEventHandler, this);\n        EventHandler.add(this.parent.lowerCanvas, 'touchmove', this.mouseMoveEventHandler, this);\n        EventHandler.add(this.parent.upperCanvas, 'touchend', this.mouseUpEventHandler, this);\n        EventHandler.add(this.parent.upperCanvas, 'touchmove', this.mouseMoveEventHandler, this);\n    };\n    Selection.prototype.unwireEvent = function () {\n        EventHandler.remove(this.parent.lowerCanvas, 'touchend', this.mouseUpEventHandler);\n        EventHandler.remove(this.parent.lowerCanvas, 'touchmove', this.mouseMoveEventHandler);\n        EventHandler.remove(this.parent.upperCanvas, 'touchend', this.mouseUpEventHandler);\n        EventHandler.remove(this.parent.upperCanvas, 'touchmove', this.mouseMoveEventHandler);\n    };\n    Selection.prototype.keyDownEventHandler = function (e) {\n        var _this = this;\n        var parent = this.parent;\n        if (e.ctrlKey && (e.key === '+' || e.key === '-')) {\n            e.preventDefault();\n        }\n        var obj = { fileName: '', fileType: null };\n        parent.notify('draw', { prop: 'getFileName', onPropertyChange: false, value: { obj: obj } });\n        var beforeSave = { fileName: obj['fileName'], fileType: obj['fileType'], cancel: false };\n        var splitWords;\n        switch (e.key) {\n            case (e.ctrlKey && 's'):\n                if (isBlazor() && parent.events && parent.events.saving.hasDelegate === true) {\n                    /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                    parent.dotNetRef.invokeMethodAsync('BeforeSaveEventAsync', 'BeforeSave', beforeSave).then(function (args) {\n                        _this.beforeSaveEvent(args, e);\n                    });\n                }\n                else {\n                    parent.trigger('beforeSave', beforeSave);\n                    this.beforeSaveEvent(beforeSave, e);\n                }\n                break;\n            case (e.ctrlKey && 'z'):\n                if (parent.allowUndoRedo) {\n                    parent.notify('undo-redo', { prop: 'call-undo' });\n                }\n                break;\n            case (e.ctrlKey && 'y'):\n                if (parent.allowUndoRedo) {\n                    parent.notify('undo-redo', { prop: 'call-redo' });\n                }\n                break;\n            case (e.ctrlKey && '+'):\n                if ((parent.zoomSettings.zoomTrigger & ZoomTrigger.Commands) === ZoomTrigger.Commands) {\n                    this.zoomType = 'Commands';\n                    parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                        value: { zoomFactor: .1, zoomPoint: null } });\n                }\n                break;\n            case (e.ctrlKey && '-'):\n                if ((parent.zoomSettings.zoomTrigger & ZoomTrigger.Commands) === ZoomTrigger.Commands) {\n                    this.zoomType = 'Commands';\n                    parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                        value: { zoomFactor: -.1, zoomPoint: null } });\n                }\n                break;\n            case 'Delete':\n                this.deleteItem();\n                break;\n            case 'Escape':\n                parent.notify('draw', { prop: 'performCancel', value: { isContextualToolbar: null } });\n                break;\n            case 'Enter':\n                if (parent.activeObj.shape) {\n                    splitWords = parent.activeObj.shape.split('-');\n                }\n                if (this.isKeyBoardCrop(e) &&\n                    parent.activeObj.horTopLine && (parent.activeObj.shape && splitWords[0] === 'crop')) {\n                    parent.crop();\n                }\n                break;\n            case 'Tab':\n                this.performTabAction();\n                break;\n            default:\n                if (Browser.isDevice && parent.textArea.style.display === 'block') {\n                    setTimeout(this.textKeyDown.bind(this), 1, e);\n                }\n                break;\n        }\n    };\n    Selection.prototype.isKeyBoardCrop = function (e) {\n        var bool = false;\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var target = e.target;\n        if ((target.id === this.parent.element.id + '_ok' || target.id === '') && !isBlazor()) {\n            bool = true;\n        }\n        return bool;\n    };\n    Selection.prototype.beforeSaveEvent = function (observableSaveArgs, e) {\n        var parent = this.parent;\n        if (!observableSaveArgs.cancel) {\n            parent.notify('export', { prop: 'export', onPropertyChange: false,\n                value: { type: observableSaveArgs.fileType, fileName: observableSaveArgs.fileName } });\n        }\n        e.preventDefault();\n        e.stopImmediatePropagation();\n    };\n    Selection.prototype.handleScroll = function (e) {\n        var parent = this.parent;\n        var x;\n        var y;\n        var isInsideCanvas = false;\n        if (e.type === 'mousewheel') {\n            // eslint-disable-next-line\n            x = e.clientX;\n            y = e.clientY;\n        }\n        var bbox = parent.lowerCanvas.getBoundingClientRect();\n        x -= bbox.left;\n        y -= bbox.top;\n        if (x > parent.img.destLeft && x < parent.img.destLeft + parent.img.destWidth && y > parent.img.destTop &&\n            y < parent.img.destTop + parent.img.destHeight) {\n            isInsideCanvas = true;\n        }\n        e.stopPropagation();\n        if (e.ctrlKey === true && isInsideCanvas) {\n            e.preventDefault();\n            if (!parent.isCropTab && (parent.activeObj.shape && parent.activeObj.shape.split('-')[0] !== 'crop')) {\n                parent.okBtn();\n                if (!isBlazor()) {\n                    parent.notify('toolbar', { prop: 'close-contextual-toolbar', onPropertyChange: false });\n                }\n            }\n            var type = '';\n            if (e.type === 'mousewheel' && (parent.zoomSettings.zoomTrigger & ZoomTrigger.MouseWheel) === ZoomTrigger.MouseWheel) {\n                this.zoomType = 'MouseWheel';\n                // eslint-disable-next-line\n                if (e.wheelDelta > 0) {\n                    type = 'zoomIn';\n                }\n                else {\n                    type = 'zoomOut';\n                }\n            }\n            if (type !== '') {\n                parent.notify('draw', { prop: 'performPointZoom', onPropertyChange: false,\n                    value: { x: x, y: y, type: type } });\n            }\n        }\n    };\n    Selection.prototype.textKeyDown = function (e) {\n        var parent = this.parent;\n        if (String.fromCharCode(e.which) === '\\r') {\n            this.textRow += 1;\n        }\n        parent.textArea.setAttribute('rows', this.textRow.toString());\n        parent.textArea.style.height = 'auto';\n        parent.textArea.style.height = parent.textArea.scrollHeight + 'px';\n        parent.notify('shape', { prop: 'setTextBoxWidth', onPropertyChange: false, value: { e: e } });\n        if (Browser.isDevice) {\n            parent.textArea.style.width = parseFloat(parent.textArea.style.width) + parent.textArea.style.fontSize + 'px';\n        }\n        var rows = parent.textArea.value.split('\\n');\n        this.textRow = rows.length;\n        parent.textArea.setAttribute('rows', this.textRow.toString());\n        this.isInitialTextEdited = false;\n    };\n    Selection.prototype.clearSelection = function () {\n        var parent = this.parent;\n        if (!parent.disabled && parent.isImageLoaded) {\n            parent.togglePen = false;\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            this.dragElement = '';\n            this.dragPoint.startX = this.dragPoint.startY = this.dragPoint.endX = this.dragPoint.endY = 0;\n            parent.currObjType.shape = '';\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            parent.currObjType.isActiveObj = true;\n            parent.currObjType.isCustomCrop = false;\n            parent.upperCanvas.style.cursor = parent.cursor = 'default';\n        }\n    };\n    Selection.prototype.setDragDirection = function (width, height) {\n        var arcRadius = (7.5);\n        var parent = this.parent;\n        if (parent.img.destWidth > parent.img.destHeight) {\n            parent.activeObj.activePoint.startX = this.dragPoint.startX = ((width / 2) - (height / 2))\n                + arcRadius;\n            parent.activeObj.activePoint.startY = this.dragPoint.startY = ((height / 2) - (height / 2))\n                + arcRadius;\n            parent.activeObj.activePoint.endX = ((width / 2) + (height / 2)) - arcRadius;\n            parent.activeObj.activePoint.endY = ((height / 2) + (height / 2)) - arcRadius;\n        }\n        else {\n            parent.activeObj.activePoint.startY = this.dragPoint.startX = ((height / 2) - (width) / 2)\n                + arcRadius;\n            parent.activeObj.activePoint.endY = ((height / 2) + (width) / 2) - arcRadius;\n            parent.activeObj.activePoint.startX = this.dragPoint.startX = arcRadius;\n            parent.activeObj.activePoint.endX = width - arcRadius;\n        }\n    };\n    Selection.prototype.calcShapeRatio = function (x, y, imgWidth, imgHeight) {\n        var parent = this.parent;\n        var arcRadius = (7.5);\n        var originalWidth = imgWidth;\n        var originalHeight = imgHeight;\n        var presetRatio = x / y;\n        var standardSize = originalWidth >= originalHeight ? originalWidth : originalHeight;\n        var width = standardSize * presetRatio;\n        var height = standardSize;\n        var scaleWidth = this.getScale(width, originalWidth);\n        var snippetArray = [];\n        for (var i = 0; i < 2; i++) {\n            if (i === 0) {\n                snippetArray.push(width * scaleWidth);\n            }\n            else {\n                snippetArray.push(height * scaleWidth);\n            }\n        }\n        width = snippetArray[0];\n        height = snippetArray[1];\n        var scaleHeight = this.getScale(height, originalHeight);\n        var snippetArray1 = [];\n        for (var i = 0; i < 2; i++) {\n            if (i === 0) {\n                snippetArray1.push(width * scaleHeight);\n            }\n            else {\n                snippetArray1.push(height * scaleHeight);\n            }\n        }\n        width = snippetArray1[0];\n        height = snippetArray1[1];\n        parent.activeObj.activePoint.width = width;\n        parent.activeObj.activePoint.height = height;\n        parent.activeObj.activePoint.startX = (this.dragPoint.startX = (originalWidth - width) / 2) + arcRadius;\n        parent.activeObj.activePoint.startY = (this.dragPoint.startY = (originalHeight - height) / 2) + arcRadius;\n        parent.activeObj.activePoint.endX = ((originalWidth - width) / 2 + width) - arcRadius;\n        parent.activeObj.activePoint.endY = ((originalHeight - height) / 2 + height) - arcRadius;\n        if (parent.activeObj.activePoint.startX < parent.img.destLeft && parent.img.destLeft + parent.img.destWidth >\n            parent.lowerCanvas.clientWidth) {\n            parent.activeObj.activePoint.startX = parent.img.destLeft;\n            parent.activeObj.activePoint.endX = parent.activeObj.activePoint.startX + width - arcRadius;\n        }\n        if (parent.activeObj.activePoint.startY < parent.img.destTop && parent.img.destTop + parent.img.destHeight >\n            parent.lowerCanvas.clientHeight) {\n            parent.activeObj.activePoint.startY = parent.img.destTop;\n            parent.activeObj.activePoint.endY = parent.activeObj.activePoint.startY + height - arcRadius;\n        }\n        parent.activeObj.activePoint.width = parent.activeObj.activePoint.endX - parent.activeObj.activePoint.startX;\n        parent.activeObj.activePoint.height = parent.activeObj.activePoint.endY - parent.activeObj.activePoint.startY;\n    };\n    Selection.prototype.getScale = function (value, originalValue) {\n        return value > originalValue ? originalValue / value : 1;\n    };\n    Selection.prototype.findTarget = function (x, y, type) {\n        var parent = this.parent;\n        if (type.toLowerCase() === 'mousedown' || type.toLowerCase() === 'touchstart') {\n            var splitWords = void 0;\n            var isCrop = false;\n            if (parent.activeObj.shape) {\n                splitWords = parent.activeObj.shape.split('-');\n                if (splitWords[0] === 'crop') {\n                    isCrop = true;\n                }\n            }\n            this.findTargetObj(x, y, isCrop);\n            this.updateCursorStyles(x, y, type);\n        }\n        else {\n            switch (this.dragElement.toLowerCase()) {\n                case 'nw-resize':\n                    parent.activeObj.topLeftCircle.startX = x;\n                    parent.activeObj.topLeftCircle.startY = y;\n                    break;\n                case 'n-resize':\n                    parent.activeObj.topCenterCircle.startX = x;\n                    parent.activeObj.topCenterCircle.startY = y;\n                    break;\n                case 'ne-resize':\n                    parent.activeObj.topRightCircle.startX = x;\n                    parent.activeObj.topRightCircle.startY = y;\n                    break;\n                case 'w-resize':\n                    parent.activeObj.centerLeftCircle.startX = x;\n                    parent.activeObj.centerLeftCircle.startY = y;\n                    break;\n                case 'e-resize':\n                    parent.activeObj.centerRightCircle.startX = x;\n                    parent.activeObj.centerRightCircle.startY = y;\n                    break;\n                case 'sw-resize':\n                    parent.activeObj.bottomLeftCircle.startX = x;\n                    parent.activeObj.bottomLeftCircle.startY = y;\n                    break;\n                case 's-resize':\n                    parent.activeObj.bottomCenterCircle.startX = x;\n                    parent.activeObj.bottomCenterCircle.startY = y;\n                    break;\n                case 'se-resize':\n                    parent.activeObj.bottomRightCircle.startX = x;\n                    parent.activeObj.bottomRightCircle.startY = y;\n                    break;\n                default:\n                    if (this.dragPoint.startX && this.dragPoint.startY) {\n                        this.previousPoint.x = this.dragPoint.endX;\n                        this.previousPoint.y = this.dragPoint.endY;\n                        this.dragPoint.endX = x;\n                        this.dragPoint.endY = y;\n                    }\n                    break;\n            }\n        }\n    };\n    Selection.prototype.findTargetObj = function (x, y, isCrop) {\n        var _this = this;\n        var parent = this.parent;\n        var isShape = false;\n        if (parent.objColl.length !== 0 && !parent.currObjType.isCustomCrop && !isCrop) {\n            var diffX = 0;\n            var i = void 0;\n            for (var index = 0; index < parent.objColl.length; index++) {\n                var cursor = parent.upperCanvas.style.cursor;\n                this.setCursor(x, y);\n                var actObj = extend({}, parent.objColl[index], {}, true);\n                if (actObj.shape === 'line' || actObj.shape === 'arrow') {\n                    for (var j = 0; j < actObj.pointColl.length; j++) {\n                        if (x >= actObj.pointColl[j].x - (actObj.topLeftCircle.radius * 2) &&\n                            x <= actObj.pointColl[j].x + (actObj.topLeftCircle.radius * 2) &&\n                            y >= actObj.pointColl[j].y - (actObj.topLeftCircle.radius * 2) &&\n                            y <= actObj.pointColl[j].y + (actObj.topLeftCircle.radius * 2)) {\n                            if (this.isTouch || parent.cursor === 'move' ||\n                                parent.cursor === 'grab' || this.isShapeInserted) {\n                                if (diffX === 0 || diffX > x - actObj.activePoint.startX) {\n                                    diffX = x - parent.objColl[index].activePoint.startX;\n                                    i = index;\n                                }\n                            }\n                            else if (parent.objColl[index].currIndex === this.tempActiveObj.currIndex) {\n                                i = index;\n                            }\n                            break;\n                        }\n                    }\n                }\n                else if (actObj.shape === 'path') {\n                    var cursor_1 = this.setCursorForPath(actObj, x, y, parent.upperCanvas);\n                    if (cursor_1 !== 'default' && cursor_1 !== 'grab') {\n                        if (this.isTouch || parent.cursor === 'move' || parent.cursor === 'grab' || this.isShapeInserted) {\n                            if (diffX === 0 || diffX > x - actObj.activePoint.startX) {\n                                diffX = x - parent.objColl[index].activePoint.startX;\n                                i = index;\n                            }\n                        }\n                        else if (parent.objColl[index].currIndex === this.tempActiveObj.currIndex) {\n                            i = index;\n                        }\n                    }\n                }\n                else if (actObj.rotatedAngle !== 0) {\n                    var cursor_2 = this.setCursorForRotatedObject(actObj, x, y, parent.upperCanvas);\n                    if (cursor_2 !== 'default' && cursor_2 !== 'grab') {\n                        if (this.isTouch || parent.cursor === 'move' || parent.cursor === 'grab' || this.isShapeInserted) {\n                            if (diffX === 0 || diffX > x - actObj.activePoint.startX) {\n                                diffX = x - parent.objColl[index].activePoint.startX;\n                                i = index;\n                            }\n                        }\n                        else if (parent.objColl[index].currIndex === this.tempActiveObj.currIndex) {\n                            i = index;\n                        }\n                    }\n                }\n                else {\n                    var rotationCirclePoint = this.getTransRotationPoint(actObj);\n                    if ((x >= (actObj.activePoint.startX - (actObj.topLeftCircle.radius * 2)) &&\n                        x <= (actObj.activePoint.endX + (actObj.topLeftCircle.radius * 2)) &&\n                        y >= (actObj.activePoint.startY - (actObj.topLeftCircle.radius * 2)) &&\n                        y <= (actObj.activePoint.endY + (actObj.topLeftCircle.radius * 2))) ||\n                        (rotationCirclePoint &&\n                            x >= (rotationCirclePoint.x - (actObj.topLeftCircle.radius * 2)) &&\n                            x <= (rotationCirclePoint.x + (actObj.topLeftCircle.radius * 2)) &&\n                            y >= (rotationCirclePoint.y - (actObj.topLeftCircle.radius * 2)) &&\n                            y <= (rotationCirclePoint.y + (actObj.topLeftCircle.radius * 2)))) {\n                        if (this.isTouch || cursor === 'move' || cursor === 'grabbing' || this.isShapeInserted\n                            || parent.cursor === 'move' || parent.cursor === 'grabbing') {\n                            if (diffX === 0 || diffX > x - actObj.activePoint.startX) {\n                                diffX = x - parent.objColl[index].activePoint.startX;\n                                i = index;\n                            }\n                        }\n                        else if (parent.objColl[index].currIndex === this.tempActiveObj.currIndex) {\n                            i = index;\n                        }\n                    }\n                }\n            }\n            if (isNullOrUndefined(i)) {\n                parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                isShape = false;\n            }\n            else {\n                this.tempObjColl = extend([], parent.objColl, [], true);\n                parent.currObjType.isCustomCrop = false;\n                parent.activeObj = extend({}, parent.objColl[i], {}, true);\n                var temp = extend({}, parent.objColl[i], {}, true);\n                parent.objColl.splice(i, 1);\n                if (parent.transform.degree === 0) {\n                    var temp_1 = this.lowerContext.filter;\n                    this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n                    parent.notify('filter', { prop: 'updateBrightFilter', onPropertyChange: false });\n                    this.lowerContext.drawImage(parent.baseImg, parent.img.srcLeft, parent.img.srcTop, parent.img.srcWidth, parent.img.srcHeight, parent.img.destLeft, parent.img.destTop, parent.img.destWidth, parent.img.destHeight);\n                    this.lowerContext.filter = 'none';\n                    parent.notify('shape', { prop: 'iterateObjColl', onPropertyChange: false });\n                    parent.activeObj = extend({}, temp_1, {}, true);\n                    parent.notify('freehand-draw', { prop: 'freehandRedraw', onPropertyChange: false,\n                        value: { context: this.lowerContext, points: null } });\n                    this.lowerContext.filter = temp_1;\n                    this.getCurrentFlipState();\n                }\n                else {\n                    parent.notify('draw', { prop: 'callUpdateCurrTransState', onPropertyChange: false });\n                    parent.notify('freehand-draw', { prop: 'freehandRedraw', onPropertyChange: false,\n                        value: { context: this.lowerContext, points: null } });\n                }\n                parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n                if ((parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle') || parent.isCircleCrop) {\n                    parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                        value: { context: this.lowerContext, isSave: null, isFlip: null } });\n                }\n                this.setActivePoint();\n                parent.activeObj = extend({}, temp, {}, true);\n                var tempStrokeSettings = extend({}, parent.activeObj.strokeSettings, {}, true);\n                parent.notify('draw', { prop: 'setTempStrokeSettings', onPropertyChange: false,\n                    value: { tempStrokeSettings: tempStrokeSettings } });\n                var tempTextSettings = extend({}, parent.activeObj.textSettings, {}, true);\n                parent.notify('draw', { prop: 'setTempTextSettings', onPropertyChange: false, value: { tempTextSettings: tempTextSettings } });\n                var shapeSettings = this.updatePrevShapeSettings();\n                var shapeChangingArgs_1 = { action: 'select', previousShapeSettings: shapeSettings,\n                    currentShapeSettings: shapeSettings };\n                if (parent.activeObj.shape === 'line' || parent.activeObj.shape === 'arrow') {\n                    shapeChangingArgs_1.currentShapeSettings.width = parent.activeObj.activePoint.endX - parent.activeObj.activePoint.startX;\n                    shapeChangingArgs_1.currentShapeSettings.height = parent.activeObj.activePoint.endY - parent.activeObj.activePoint.startY;\n                }\n                this.isCropSelection = false;\n                var splitWords = void 0;\n                if (parent.activeObj.shape !== undefined) {\n                    splitWords = parent.activeObj.shape.split('-');\n                }\n                if (splitWords !== undefined && splitWords[0] === 'crop') {\n                    this.isCropSelection = true;\n                }\n                if (!this.isCropSelection && isBlazor() && isNullOrUndefined(this.parent.eventType) &&\n                    parent.events && parent.events.shapeChanging.hasDelegate === true) {\n                    /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                    parent.dotNetRef.invokeMethodAsync('ShapeEventAsync', 'OnShape', shapeChangingArgs_1).then(function (shapeChangingArgs) {\n                        _this.shapeEvent(shapeChangingArgs);\n                    });\n                }\n                else if (!this.isCropSelection) {\n                    parent.trigger('shapeChanging', shapeChangingArgs_1);\n                    this.shapeEvent(shapeChangingArgs_1);\n                }\n                else {\n                    var selectionChangingArgs = { action: shapeChangingArgs_1.action,\n                        previousSelectionSettings: { type: parent.getSelectionType(parent.activeObj.shape),\n                            startX: shapeChangingArgs_1.previousShapeSettings.startX,\n                            startY: shapeChangingArgs_1.previousShapeSettings.startY,\n                            width: shapeChangingArgs_1.previousShapeSettings.width,\n                            height: shapeChangingArgs_1.previousShapeSettings.height },\n                        currentSelectionSettings: { type: parent.getSelectionType(parent.activeObj.shape),\n                            startX: shapeChangingArgs_1.currentShapeSettings.startX,\n                            startY: shapeChangingArgs_1.currentShapeSettings.startY,\n                            width: shapeChangingArgs_1.currentShapeSettings.width,\n                            height: shapeChangingArgs_1.currentShapeSettings.height } };\n                    if (isBlazor() && parent.events && parent.events.onSelectionResizeStart.hasDelegate === true) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        parent.dotNetRef.invokeMethodAsync('SelectionEventAsync', 'OnSelectionResizeStart', selectionChangingArgs).then(function (selectionChangingArgs) {\n                            shapeChangingArgs_1.currentShapeSettings.startX = selectionChangingArgs.currentSelectionSettings.startX;\n                            shapeChangingArgs_1.currentShapeSettings.startY = selectionChangingArgs.currentSelectionSettings.startY;\n                            shapeChangingArgs_1.currentShapeSettings.width = selectionChangingArgs.currentSelectionSettings.width;\n                            shapeChangingArgs_1.currentShapeSettings.height = selectionChangingArgs.currentSelectionSettings.height;\n                            _this.shapeEvent(shapeChangingArgs_1);\n                        });\n                    }\n                    else {\n                        parent.trigger('selectionChanging', selectionChangingArgs);\n                        shapeChangingArgs_1.currentShapeSettings.startX = selectionChangingArgs.currentSelectionSettings.startX;\n                        shapeChangingArgs_1.currentShapeSettings.startY = selectionChangingArgs.currentSelectionSettings.startY;\n                        shapeChangingArgs_1.currentShapeSettings.width = selectionChangingArgs.currentSelectionSettings.width;\n                        shapeChangingArgs_1.currentShapeSettings.height = selectionChangingArgs.currentSelectionSettings.height;\n                        this.shapeEvent(shapeChangingArgs_1);\n                    }\n                }\n                isShape = true;\n            }\n        }\n        return isShape;\n    };\n    Selection.prototype.shapeEvent = function (shapeChangingArgs) {\n        var parent = this.parent;\n        parent.notify('shape', { prop: 'updateShapeChangeEventArgs', onPropertyChange: false,\n            value: { shapeSettings: shapeChangingArgs.currentShapeSettings } });\n        if (parent.activeObj.activePoint) {\n            var obj = { prevActObj: null };\n            parent.notify('draw', { prop: 'getPrevActObj', onPropertyChange: false, value: { obj: obj } });\n            if (isNullOrUndefined(obj['prevActObj'])) {\n                parent.notify('draw', { prop: 'setPrevActObj', onPropertyChange: false,\n                    value: { prevActObj: extend({}, parent.activeObj, {}, true) } });\n            }\n            parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj, isCropRatio: null,\n                    points: null, isPreventDrag: true, saveContext: null, isPreventSelection: true } });\n            if (!this.isShapeInserted) {\n                if (parent.activeObj.activePoint.startX < parent.img.destLeft) {\n                    this.isPreventDragging = true;\n                }\n                else if (parent.activeObj.activePoint.endX > parent.img.destLeft + parent.img.destWidth) {\n                    this.isPreventDragging = true;\n                }\n                else if (parent.activeObj.activePoint.startY < parent.img.destTop) {\n                    this.isPreventDragging = true;\n                }\n                else if (parent.activeObj.activePoint.endY > parent.img.destTop + parent.img.destHeight) {\n                    this.isPreventDragging = true;\n                }\n            }\n        }\n    };\n    // eslint-disable-next-line\n    Selection.prototype.targetTouches = function (touches) {\n        var bbox = this.parent.lowerCanvas.getBoundingClientRect();\n        var p1 = { x: touches[0].pageX - bbox.left, y: touches[0].pageY - bbox.top };\n        var p2 = { x: touches[1].pageX - bbox.left, y: touches[1].pageY - bbox.top };\n        var points = [p1, p2];\n        return points;\n    };\n    Selection.prototype.calculateScale = function (startTouches, endTouches) {\n        var startDistance = this.getDistance(startTouches[0], startTouches[1]);\n        var endDistance = this.getDistance(endTouches[0], endTouches[1]);\n        return endDistance / startDistance;\n    };\n    Selection.prototype.getDistance = function (a, b) {\n        var x = 0;\n        var y = 0;\n        if (a && b) {\n            x = a.x - b.x;\n            y = a.y - b.y;\n        }\n        return Math.sqrt(x * x + y * y);\n    };\n    Selection.prototype.redrawShape = function (obj, isMouseUp) {\n        var parent = this.parent;\n        for (var i = 0, len = parent.objColl.length; i < len; i++) {\n            if (JSON.stringify(obj) === JSON.stringify(parent.objColl[i])) {\n                parent.objColl.splice(i, 1);\n                break;\n            }\n        }\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        if (this.isPreventDragging) {\n            if (parent.activeObj.activePoint.startX > parent.img.destLeft) {\n                this.isPreventDragging = false;\n            }\n            if (isMouseUp && parent.activeObj.rotatedAngle !== 0) {\n                parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: null, isCropRatio: null,\n                        points: null, isPreventDrag: true, saveContext: null, isPreventSelection: null } });\n            }\n            else {\n                parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: null, isCropRatio: null,\n                        points: null, isPreventDrag: true, saveContext: null, isPreventSelection: null } });\n            }\n        }\n        else {\n            if (isMouseUp && parent.activeObj.rotatedAngle !== 0) {\n                parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: null, isCropRatio: null,\n                        points: null, isPreventDrag: true, saveContext: null, isPreventSelection: null } });\n            }\n            else {\n                parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: null, isCropRatio: null,\n                        points: null, isPreventDrag: true, saveContext: null, isPreventSelection: null } });\n            }\n        }\n    };\n    Selection.prototype.setTimer = function (e) {\n        if (this.timer > 10) {\n            clearTimeout(this.timer);\n            this.timer = 0;\n            this.parent.notify('shape', { prop: 'findTextTarget', onPropertyChange: false, value: { e: e } });\n            if (Browser.isDevice) {\n                this.upperContext.clearRect(0, 0, this.parent.upperCanvas.width, this.parent.upperCanvas.height);\n            }\n        }\n    };\n    Selection.prototype.applyCurrActObj = function (x, y) {\n        var parent = this.parent;\n        var isInside = false;\n        var actObj = extend({}, parent.activeObj, {}, true);\n        if (isNullOrUndefined(actObj.activePoint)) {\n            return;\n        }\n        var radius = actObj.topLeftCircle ? actObj.topLeftCircle.radius : 0;\n        if ((x >= Math.floor(actObj.activePoint.startX) &&\n            x <= Math.ceil(actObj.activePoint.endX) &&\n            y >= Math.floor(actObj.activePoint.startY) &&\n            y <= Math.ceil(actObj.activePoint.endY))) {\n            isInside = true;\n        }\n        else if (radius !== 0 && (x >= Math.floor(actObj.activePoint.startX) - radius &&\n            x <= Math.ceil(actObj.activePoint.endX) + radius &&\n            y >= Math.floor(actObj.activePoint.startY) - radius &&\n            y <= Math.ceil(actObj.activePoint.endY) + radius)) {\n            isInside = true;\n            this.tempActiveObj = { activePoint: { startX: 0, startY: 0, endX: 0, endY: 0, width: 0, height: 0 },\n                flipObjColl: [], triangle: [], triangleRatio: [] };\n        }\n        else if (actObj.shape === 'text' && this.dragElement !== '') {\n            isInside = true;\n        }\n        else if (actObj.shape === 'line' || actObj.shape === 'arrow') {\n            var smallPoint = { x: actObj.activePoint.startX < actObj.activePoint.endX ? actObj.activePoint.startX :\n                    actObj.activePoint.endX,\n                y: actObj.activePoint.startY < actObj.activePoint.endY ? actObj.activePoint.startY : actObj.activePoint.endY };\n            var largePoint = { x: actObj.activePoint.startX > actObj.activePoint.endX ? actObj.activePoint.startX :\n                    actObj.activePoint.endX,\n                y: actObj.activePoint.startY > actObj.activePoint.endY ? actObj.activePoint.startY : actObj.activePoint.endY };\n            if (x >= (Math.floor(smallPoint.x) - 5) && x <= (Math.ceil(largePoint.x) + 5) &&\n                y >= (Math.floor(smallPoint.y) - 5) && y <= (Math.ceil(largePoint.y) + 5)) {\n                isInside = true;\n            }\n        }\n        else if (actObj.shape === 'path') {\n            var cursor = this.setCursorForPath(actObj, x, y, parent.upperCanvas);\n            if (cursor === 'move') {\n                isInside = true;\n            }\n        }\n        else if (this.dragElement === 'grabbing') {\n            isInside = true;\n        }\n        else if (actObj.rotatedAngle !== 0) {\n            var cursor = this.setCursorForRotatedObject(actObj, x, y, parent.upperCanvas);\n            if ((cursor !== 'default' && cursor !== 'grab') || this.dragElement === 'n-resize' || this.dragElement === 'e-resize' ||\n                this.dragElement === 's-resize' || this.dragElement === 'w-resize') {\n                isInside = true;\n            }\n        }\n        if (!isInside) {\n            if (isNullOrUndefined(parent.activeObj.currIndex)) {\n                parent.activeObj.currIndex = 'shape_' + (parent.objColl.length + 1);\n            }\n            parent.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n            if (parent.activeObj.horTopLine !== undefined && parent.activeObj.horTopLine.startX !== 0 && parent.activeObj.horTopLine.endX\n                !== 0 && !parent.currObjType.isCustomCrop && parent.currObjType.shape !== '') {\n                parent.objColl.push(extend({}, parent.activeObj, {}, true));\n            }\n            if (parent.activeObj.shape === 'text' || (parent.currObjType.shape === 'ellipse' || parent.currObjType.shape === 'rectangle' ||\n                parent.currObjType.shape === 'line' || parent.activeObj.shape === 'arrow' || parent.activeObj.shape === 'path')) {\n                var tempFilter = this.lowerContext.filter;\n                this.lowerContext.filter = 'brightness(' + 1 + ') ' + 'contrast(' + 100 + '%) ' + 'hue-rotate(' + 0 + 'deg) ' +\n                    'saturate(' + 100 + '%) ' + 'opacity(' + 1 + ') ' + 'blur(' + 0 + 'px) ' + 'sepia(0%) ' + 'grayscale(0%) ' +\n                    'invert(0%)';\n                for (var i = 0; i < parent.objColl.length; i++) {\n                    var obj = { isInside: false };\n                    parent.notify('crop', { prop: 'isObjInImage', onPropertyChange: false,\n                        value: { obj: parent.objColl[i], object: obj } });\n                    if (obj['isInside']) {\n                        parent.notify('shape', { prop: 'apply', onPropertyChange: false,\n                            value: { shape: parent.objColl[i].shape, obj: parent.objColl[i], canvas: null } });\n                        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                    }\n                }\n                parent.notify('freehand-draw', { prop: 'zoomFHDColl', onPropertyChange: false, value: { isPreventApply: null } });\n                this.lowerContext.filter = tempFilter;\n                if (parent.activeObj.shape) {\n                    parent.notify('shape', { prop: 'apply', onPropertyChange: false,\n                        value: { shape: null, obj: null, canvas: null } });\n                }\n                parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n                parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.upperContext } });\n                if (parent.isCircleCrop) {\n                    parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                        value: { context: this.lowerContext, isSave: null, isFlip: null } });\n                }\n            }\n            if (!isBlazor()) {\n                parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n            }\n        }\n    };\n    Selection.prototype.getCurrentFlipState = function () {\n        var parent = this.parent;\n        if (parent.rotateFlipColl.length !== 0) {\n            var totalPannedInternalPoint = extend({}, parent.panPoint.totalPannedInternalPoint, {}, true);\n            parent.notify('draw', { prop: 'callUpdateCurrTransState', onPropertyChange: false });\n            parent.panPoint.totalPannedInternalPoint = totalPannedInternalPoint;\n        }\n        else {\n            parent.notify('draw', { prop: 'callUpdateCurrTransState', onPropertyChange: false });\n        }\n    };\n    Selection.prototype.setTextBoxStylesToActObj = function () {\n        var parent = this.parent;\n        parent.activeObj.textSettings.fontFamily = parent.textArea.style.fontFamily;\n        parent.activeObj.strokeSettings.strokeColor = parent.textArea.style.color !== '' &&\n            parent.textArea.style.color.split('(')[1] && parent.textArea.style.color.split('(')[1].split(',')[0] &&\n            parent.textArea.style.color.split('(')[1].split(',')[1] && parent.textArea.style.color.split('(')[1].split(',')[2] ?\n            this.rgbToHex(parseFloat(parent.textArea.style.color.split('(')[1].split(',')[0]), parseFloat(parent.textArea.style.color.split('(')[1].split(',')[1]), parseFloat(parent.textArea.style.color.split('(')[1].split(',')[2])) :\n            parent.textArea.style.color;\n        if (parent.textArea.style.fontWeight === 'bold') {\n            parent.activeObj.textSettings.bold = true;\n        }\n        else {\n            parent.activeObj.textSettings.bold = false;\n        }\n        if (parent.textArea.style.fontStyle === 'italic') {\n            parent.activeObj.textSettings.italic = true;\n        }\n        else {\n            parent.activeObj.textSettings.italic = false;\n        }\n        parent.activeObj.textSettings.fontSize = (parseFloat(parent.textArea.style.fontSize));\n    };\n    Selection.prototype.rgbToHex = function (r, g, b) {\n        return '#' + this.componentToHex(r) + this.componentToHex(g) + this.componentToHex(b);\n    };\n    Selection.prototype.componentToHex = function (rgb) {\n        var hex = rgb.toString(16);\n        return hex.length === 1 ? '0' + hex : hex;\n    };\n    Selection.prototype.deleteItem = function () {\n        var parent = this.parent;\n        var shapeChangingArgs = {};\n        var previousShapeSettings = {};\n        if (this.isFhdEditing) {\n            this.updateFreehandDrawColorChange();\n            var prevCropObj = extend({}, parent.cropObj, {}, true);\n            var object = { currObj: {} };\n            parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n            var prevObj = object['currObj'];\n            prevObj.objColl = extend([], parent.objColl, [], true);\n            prevObj.pointColl = extend([], parent.pointColl, [], true);\n            prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n            var selPointCollObj = { selPointColl: null };\n            parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                value: { obj: selPointCollObj } });\n            prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n            var obj = { freehandDrawSelectedId: null };\n            parent.notify('freehand-draw', { prop: 'getFreehandDrawSelectedId', onPropertyChange: false, value: { obj: obj } });\n            parent.notify('freehand-draw', { prop: 'deleteFhd', value: { id: obj['freehandDrawSelectedId'] } });\n            parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                value: { operation: 'deleteFreehandDrawing', previousObj: prevObj, previousObjColl: this.tempObjColl,\n                    previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                    previousCropObj: prevCropObj, previousText: null,\n                    currentText: null, previousFilter: null, isCircleCrop: null } });\n            parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n            parent.notify('freehand-draw', { prop: 'resetFreehandDrawSelectedId' });\n        }\n        else if (parent.textArea.style.display === 'none') {\n            var obj = { prevActObj: null };\n            parent.notify('draw', { prop: 'getPrevActObj', onPropertyChange: false, value: { obj: obj } });\n            if (obj['prevActObj']) {\n                obj['prevActObj']['activePoint']['width'] = Math.abs(obj['prevActObj']['activePoint']['width']);\n                obj['prevActObj']['activePoint']['height'] = Math.abs(obj['prevActObj']['activePoint']['height']);\n            }\n            if (obj['prevActObj'] && JSON.stringify(obj['prevActObj']) !== JSON.stringify(parent.activeObj)) {\n                var index = parent.activeObj.currIndex;\n                parent.notify('draw', { prop: 'performCancel', value: { isContextualToolbar: null } });\n                for (var i = 0; i < parent.objColl.length; i++) {\n                    if (parent.objColl[i].currIndex === index) {\n                        parent.objColl.splice(i, 1);\n                        parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null } });\n                        break;\n                    }\n                }\n            }\n            var object = { isNewPath: null };\n            parent.notify('draw', { prop: 'getNewPath', value: { obj: object } });\n            if (object['isNewPath']) {\n                parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                parent.notify('draw', { prop: 'render-image', value: { isMouseWheel: null } });\n                if (!isBlazor()) {\n                    parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n                }\n                else {\n                    parent.updateToolbar(parent.element, 'imageLoaded');\n                }\n            }\n            else if (parent.activeObj.shape) {\n                parent.objColl.push(parent.activeObj);\n                var prevCropObj = extend({}, parent.cropObj, {}, true);\n                var object_2 = { currObj: {} };\n                parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object_2 } });\n                var prevObj = object_2['currObj'];\n                prevObj.objColl = extend([], parent.objColl, [], true);\n                prevObj.pointColl = extend([], parent.pointColl, [], true);\n                prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n                var selPointCollObj = { selPointColl: null };\n                parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                    value: { obj: selPointCollObj } });\n                prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n                parent.objColl.pop();\n                previousShapeSettings = this.updatePrevShapeSettings();\n                shapeChangingArgs = { action: 'delete', previousShapeSettings: previousShapeSettings, currentShapeSettings: null };\n                parent.notify('shape', { prop: 'setKeyHistory', onPropertyChange: false, value: { keyHistory: '' } });\n                parent.clearSelection();\n                if (isBlazor() && parent.events && parent.events.shapeChanging.hasDelegate === true) {\n                    parent.dotNetRef.invokeMethodAsync('ShapeEventAsync', 'OnShape', shapeChangingArgs);\n                }\n                else {\n                    parent.trigger('shapeChanging', shapeChangingArgs);\n                    if (!isBlazor()) {\n                        parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n                    }\n                }\n                if (!isNullOrUndefined(prevObj.objColl[prevObj.objColl.length - 1].currIndex)) {\n                    parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                        value: { operation: 'deleteObj', previousObj: prevObj, previousObjColl: this.tempObjColl,\n                            previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                            previousCropObj: prevCropObj, previousText: null,\n                            currentText: null, previousFilter: null, isCircleCrop: null } });\n                    parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n                }\n            }\n            parent.notify('draw', { prop: 'setPrevActObj', onPropertyChange: false, value: { prevActObj: null } });\n        }\n        if (document.getElementById(parent.element.id + '_quickAccessToolbarArea')) {\n            document.getElementById(parent.element.id + '_quickAccessToolbarArea').style.display = 'none';\n        }\n    };\n    Selection.prototype.updateFreehandDrawColorChange = function () {\n        var parent = this.parent;\n        var indexObj = { freehandSelectedIndex: null };\n        parent.notify('freehand-draw', { prop: 'getFreehandSelectedIndex', onPropertyChange: false, value: { obj: indexObj } });\n        if (!isNullOrUndefined(indexObj['freehandSelectedIndex']) && !isNullOrUndefined(parent.pointColl[indexObj['freehandSelectedIndex']])\n            && parent.pointColl[indexObj['freehandSelectedIndex']].strokeColor === '#42a5f5') {\n            var obj = { tempFreeHandDrawEditingStyles: null };\n            parent.notify('freehand-draw', { prop: 'getTempFreeHandDrawEditingStyles', value: { obj: obj } });\n            parent.pointColl[indexObj['freehandSelectedIndex']].strokeColor = obj['tempFreeHandDrawEditingStyles'].strokeColor;\n        }\n    };\n    Selection.prototype.updatePrevShapeSettings = function (obj) {\n        var parent = this.parent;\n        var fontStyle = [];\n        if (parent.activeObj.shape === 'text' && parent.activeObj.textSettings) {\n            if (parent.activeObj.textSettings.bold) {\n                fontStyle.push('bold');\n            }\n            if (parent.activeObj.textSettings.italic) {\n                fontStyle.push('italic');\n            }\n            if (parent.activeObj.textSettings.underline) {\n                fontStyle.push('underline');\n            }\n        }\n        var shapeSettingsObj = {\n            id: !isNullOrUndefined(parent.activeObj.currIndex) ? parent.activeObj.currIndex : null,\n            type: parent.toPascalCase(parent.activeObj.shape),\n            startX: parent.activeObj.activePoint.startX, startY: parent.activeObj.activePoint.startY,\n            width: parent.activeObj.activePoint.width, height: parent.activeObj.activePoint.height,\n            strokeColor: parent.activeObj.strokeSettings ? parent.activeObj.strokeSettings.strokeColor : null,\n            strokeWidth: parent.activeObj.strokeSettings ? parent.activeObj.strokeSettings.strokeWidth : null,\n            fillColor: parent.activeObj.strokeSettings ? parent.activeObj.strokeSettings.fillColor : null,\n            radius: parent.activeObj.shape === 'ellipse' ? parent.activeObj.activePoint.width / 2 : null,\n            length: parent.activeObj.shape === 'line' || parent.activeObj.shape === 'arrow' ? parent.activeObj.activePoint.width : null,\n            text: parent.activeObj.shape === 'text' ? (parent.activeObj.keyHistory ? parent.activeObj.keyHistory :\n                (parent.activeObj.textSettings.text ? parent.activeObj.textSettings.text : null)) : null,\n            fontSize: parent.activeObj.shape === 'text' ? (parent.activeObj.textSettings ? parent.activeObj.textSettings.fontSize : null) : null,\n            fontFamily: parent.activeObj.shape === 'text' ? (parent.activeObj.textSettings ? parent.activeObj.textSettings.fontFamily : null) : null,\n            fontStyle: parent.activeObj.shape === 'text' ? fontStyle : null,\n            color: parent.activeObj.shape === 'text' ? (parent.activeObj.strokeSettings ? parent.activeObj.strokeSettings.strokeColor : null) : null\n        };\n        if (obj) {\n            obj['shapeSettingsObj'] = shapeSettingsObj;\n        }\n        return shapeSettingsObj;\n    };\n    Selection.prototype.getRectanglePoints = function (rectX, rectY, rectWidth, rectHeight, rectAngle, pointX, pointY) {\n        var centerX = rectX + rectWidth / 2;\n        var centerY = rectY + rectHeight / 2;\n        var angleRad = rectAngle * (Math.PI / 180);\n        var cosAngle = Math.cos(angleRad);\n        var sinAngle = Math.sin(angleRad);\n        var localX = pointX - centerX;\n        var localY = pointY - centerY;\n        var rotatedX = localX * cosAngle + localY * sinAngle;\n        var rotatedY = -localX * sinAngle + localY * cosAngle;\n        var halfWidth = rectWidth / 2;\n        var halfHeight = rectHeight / 2;\n        // Check if the rotated point is within the bounds of the rectangle\n        if (rotatedX >= -halfWidth && rotatedX <= halfWidth && rotatedY >= -halfHeight &&\n            rotatedY <= halfHeight) {\n            return true; // Point is inside the rotated rectangle\n        }\n        else {\n            return false; // Point is outside the rotated rectangle\n        }\n    };\n    Selection.prototype.getTransRotationPoint = function (obj, object) {\n        var rotationCirclePoint;\n        var degree;\n        var isHorizontalflip = false;\n        var isVerticalflip = false;\n        if (obj.shapeDegree === 0) {\n            degree = this.parent.transform.degree;\n        }\n        else {\n            degree = this.parent.transform.degree - obj.shapeDegree;\n        }\n        if (degree < 0) {\n            degree = 360 + degree;\n        }\n        if (obj.flipObjColl) {\n            for (var i = 0; i < obj.flipObjColl.length; i++) {\n                if (obj.flipObjColl[i].toLowerCase() === 'horizontal') {\n                    isHorizontalflip = true;\n                }\n                else if (obj.flipObjColl[i].toLowerCase() === 'vertical') {\n                    isVerticalflip = true;\n                }\n            }\n        }\n        if (degree === 0 || degree === 360) {\n            if (isVerticalflip) {\n                rotationCirclePoint = { x: obj.topCenterCircle.startX,\n                    y: obj.topCenterCircle.startY - obj.rotationCircleLine };\n            }\n            else {\n                rotationCirclePoint = { x: obj.bottomCenterCircle.startX,\n                    y: obj.bottomCenterCircle.startY + obj.rotationCircleLine };\n            }\n        }\n        else if (degree === 90 || degree === -270) {\n            if (isHorizontalflip) {\n                rotationCirclePoint = { x: obj.centerRightCircle.startX +\n                        obj.rotationCircleLine, y: obj.centerLeftCircle.startY };\n            }\n            else {\n                rotationCirclePoint = { x: obj.centerLeftCircle.startX -\n                        obj.rotationCircleLine, y: obj.centerLeftCircle.startY };\n            }\n        }\n        else if (degree === 180 || degree === -180) {\n            if (isVerticalflip) {\n                rotationCirclePoint = { x: obj.bottomCenterCircle.startX,\n                    y: obj.bottomCenterCircle.startY + obj.rotationCircleLine };\n            }\n            else {\n                rotationCirclePoint = { x: obj.topCenterCircle.startX,\n                    y: obj.topCenterCircle.startY - obj.rotationCircleLine };\n            }\n        }\n        else if (degree === 270 || degree === -90) {\n            if (isHorizontalflip) {\n                rotationCirclePoint = { x: obj.centerLeftCircle.startX -\n                        obj.rotationCircleLine, y: obj.centerLeftCircle.startY };\n            }\n            else {\n                rotationCirclePoint = { x: obj.centerRightCircle.startX +\n                        obj.rotationCircleLine, y: obj.centerLeftCircle.startY };\n            }\n        }\n        if (object) {\n            object['rotationCirclePoint'] = rotationCirclePoint;\n        }\n        return rotationCirclePoint;\n    };\n    return Selection;\n}());\nexport { Selection };\n","import { EventHandler, extend, isBlazor, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { ShapeType } from '../index';\nvar Shape = /** @class */ (function () {\n    function Shape(parent) {\n        this.textSettings = { text: 'Enter Text', fontFamily: 'Arial', fontSize: null, fontRatio: null, bold: false, italic: false, underline: false };\n        this.strokeSettings = { strokeColor: '#fff', fillColor: '', strokeWidth: null };\n        this.keyHistory = ''; // text history\n        this.parent = parent;\n        this.addEventListener();\n    }\n    Shape.prototype.destroy = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.removeEventListener();\n    };\n    Shape.prototype.addEventListener = function () {\n        this.parent.on('shape', this.shape, this);\n        this.parent.on('destroyed', this.destroy, this);\n    };\n    Shape.prototype.removeEventListener = function () {\n        this.parent.off('shape', this.shape);\n        this.parent.off('destroyed', this.destroy);\n    };\n    Shape.prototype.shape = function (args) {\n        this.initShapePvtProps();\n        switch (args.prop) {\n            case 'drawEllipse':\n                this.drawEllipse(args.value['x'], args.value['y'], args.value['radiusX'], args.value['radiusY'], args.value['strokeWidth'], args.value['strokeColor'], args.value['fillColor']);\n                break;\n            case 'drawLine':\n                this.drawLine(args.value['startX'], args.value['startY'], args.value['endX'], args.value['endY'], args.value['strokeWidth'], args.value['strokeColor']);\n                break;\n            case 'drawArrow':\n                this.drawArrow(args.value['startX'], args.value['startY'], args.value['endX'], args.value['endY'], args.value['strokeWidth'], args.value['strokeColor'], args.value['arrowStart'], args.value['arrowEnd']);\n                break;\n            case 'drawPath':\n                this.drawPath(args.value['pointColl'], args.value['strokeWidth'], args.value['strokeColor']);\n                break;\n            case 'drawRectangle':\n                this.drawRectangle(args.value['x'], args.value['y'], args.value['width'], args.value['height'], args.value['strokeWidth'], args.value['strokeColor'], args.value['fillColor']);\n                break;\n            case 'drawText':\n                this.drawText(args.value['x'], args.value['y'], args.value['text'], args.value['fontFamily'], args.value['fontSize'], args.value['bold'], args.value['italic'], args.value['color']);\n                break;\n            case 'redrawActObj':\n                this.redrawActObj(args.value['x'], args.value['y'], args.value['isMouseDown']);\n                break;\n            case 'apply':\n                this.apply(args.value['shape'], args.value['obj'], args.value['canvas']);\n                break;\n            case 'updateShapeChangeEventArgs':\n                this.updateShapeChangeEventArgs(args.value['shapeSettings']);\n                break;\n            case 'updSelChangeEventArgs':\n                this.updSelChangeEventArgs(args.value['selectionSettings']);\n                break;\n            case 'iterateObjColl':\n                this.iterateObjColl();\n                break;\n            case 'updImgRatioForActObj':\n                this.updImgRatioForActObj();\n                break;\n            case 'zoomObjColl':\n                this.zoomObjColl(args.value['isPreventApply']);\n                break;\n            case 'redrawObj':\n                this.redrawObj(args.value['degree']);\n                break;\n            case 'rotateObjColl':\n                this.rotateObjColl();\n                break;\n            case 'draw-shape-text':\n                this.drawShapeText();\n                break;\n            case 'redraw-text':\n                this.redrawText();\n                break;\n            case 'draw-shape':\n                this.drawShape(args.value['obj'], args.value['strokeWidth'], args.value['strokeColor'], args.value['fillColor'], args.value['start'], args.value['width'], args.value['height']);\n                break;\n            case 'renderTextArea':\n                this.renderTextArea(args.value['x'], args.value['y'], args.value['actObj']);\n                break;\n            case 'setTextBoxWidth':\n                this.setTextBoxWidth(args.value['e']);\n                break;\n            case 'findTextTarget':\n                this.findTextTarget(args.value['e']);\n                break;\n            case 'panObjColl':\n                this.panObjColl(args.value['xDiff'], args.value['yDiff'], args.value['panRegion']);\n                break;\n            case 'updateFontStyles':\n                this.updateFontStyles(args.value['isTextBox']);\n                break;\n            case 'applyFontStyle':\n                this.applyFontStyle(args.value['item']);\n                break;\n            case 'updateFontRatio':\n                this.updateFontRatio(args.value['obj'], args.value['isTextArea']);\n                break;\n            case 'updateFontSize':\n                this.updateFontSize(args.value['obj']);\n                break;\n            case 'updateObjColl':\n                this.updateObjColl(args.value['item'], args.value['objColl']);\n                break;\n            case 'pushActItemIntoObj':\n                this.pushActItemIntoObj();\n                break;\n            case 'clearActObj':\n                this.clearActObj();\n                break;\n            case 'refreshActiveObj':\n                this.refreshActiveObj();\n                break;\n            case 'applyActObj':\n                this.applyActObj(args.value['isMouseDown']);\n                break;\n            case 'wireEvent':\n                EventHandler.add(this.parent.upperCanvas, 'dblclick', this.findTextTarget, this);\n                EventHandler.add(this.parent.textArea, 'mousedown', this.findTextTarget, this);\n                break;\n            case 'unWireEvent':\n                EventHandler.remove(this.parent.upperCanvas, 'dblclick', this.findTextTarget);\n                EventHandler.remove(this.parent.textArea, 'mousedown', this.findTextTarget);\n                break;\n            case 'getShapeSetting':\n                this.getShapeSetting(args.value['id'], args.value['obj']);\n                break;\n            case 'getShapeSettings':\n                this.getShapeSettings(args.value['obj']);\n                break;\n            case 'isPointsInRange':\n                this.isPointsInRange(args.value['x'], args.value['y'], args.value['obj']);\n                break;\n            case 'alignRotateFlipColl':\n                this.alignRotateFlipColl(args.value['collection'], args.value['isRotateFlipCollection'], args.value['obj']);\n                break;\n            case 'selectShape':\n                this.selectShape(args.value['id'], args.value['obj']);\n                break;\n            case 'deleteShape':\n                this.deleteShape(args.value['id']);\n                break;\n            case 'getMaxText':\n                this.getMaxText(args.value['isTextBox'], args.value['text'], args.value['obj']);\n                break;\n            case 'setPointCollForLineArrow':\n                args.value['obj'].pointColl = this.getLinePoints(args.value['obj'].activePoint.startX, args.value['obj'].activePoint.startY, args.value['obj'].activePoint.endX, args.value['obj'].activePoint.endY);\n                break;\n            case 'setPointCollForShapeRotation':\n                this.setPointCollForShapeRotation(args.value['obj']);\n                break;\n            case 'setTextSettings':\n                if (args.value['textSettings']) {\n                    this.textSettings = args.value['textSettings'];\n                }\n                else if (args.value['fontFamily']) {\n                    this.textSettings.fontFamily = args.value['fontFamily'];\n                }\n                else if (args.value['fontSize']) {\n                    this.textSettings.fontSize = args.value['fontSize'];\n                }\n                break;\n            case 'setStrokeSettings':\n                if (args.value['strokeSettings']) {\n                    this.strokeSettings = args.value['strokeSettings'];\n                }\n                else if (args.value['strokeColor']) {\n                    this.strokeSettings.strokeColor = args.value['strokeColor'];\n                }\n                else if (args.value['fillColor']) {\n                    this.strokeSettings.fillColor = args.value['fillColor'];\n                }\n                else if (args.value['strokeWidth']) {\n                    this.strokeSettings.strokeWidth = args.value['strokeWidth'];\n                }\n                break;\n            case 'getStrokeSettings':\n                args.value['obj']['strokeSettings'] = this.strokeSettings;\n                break;\n            case 'setKeyHistory':\n                this.keyHistory = args.value['keyHistory'];\n                break;\n            case 'getKeyHistory':\n                args.value['obj']['keyHistory'] = this.keyHistory;\n                break;\n            case 'setTextBoxPos':\n                this.setTextBoxPos(args.value['actObj'], args.value['degree'], args.value['flip'], args.value['x'], args.value['y']);\n                break;\n            case 'setTextBoxPoints':\n                this.setTextBoxPoints(args.value['actObj'], args.value['degree'], args.value['flip'], args.value['x'], args.value['y']);\n                break;\n            case 'alignTextAreaIntoCanvas':\n                this.alignTextAreaIntoCanvas();\n                break;\n            case 'initializeTextShape':\n                this.initializeTextShape(args.value['text'], args.value['fontFamily'], args.value['fontSize'], args.value['bold'], args.value['italic'], args.value['strokeColor']);\n                break;\n            case 'stopPathDrawing':\n                this.stopPathDrawing(args.value['e']);\n                break;\n            case 'updateArrowRatio':\n                this.updateArrowRatio(args.value['obj']);\n                break;\n            case 'getSquarePointForRotatedShape':\n                this.getSquarePointForRotatedShape(args.value['obj'], args.value['object']);\n                break;\n            case 'reset':\n                this.reset();\n                break;\n        }\n    };\n    Shape.prototype.getModuleName = function () {\n        return 'shape';\n    };\n    Shape.prototype.initShapePvtProps = function () {\n        if (this.parent.lowerCanvas) {\n            this.lowerContext = this.parent.lowerCanvas.getContext('2d');\n        }\n        if (this.parent.upperCanvas) {\n            this.upperContext = this.parent.upperCanvas.getContext('2d');\n        }\n    };\n    Shape.prototype.reset = function () {\n        this.textSettings =\n            { text: 'Enter Text', fontFamily: 'Arial', fontSize: null, fontRatio: null, bold: false, italic: false, underline: false };\n        this.strokeSettings = { strokeColor: '#fff', fillColor: '', strokeWidth: null };\n    };\n    Shape.prototype.drawEllipse = function (x, y, radiusX, radiusY, strokeWidth, strokeColor, fillColor, degree) {\n        this.initializeShape('ellipse');\n        var start = x && y ? { x: x, y: y } : null;\n        this.drawShape('ellipse', strokeWidth, strokeColor, fillColor, start, radiusX, radiusY, null, null, null, degree);\n    };\n    Shape.prototype.drawLine = function (startX, startY, endX, endY, strokeWidth, strokeColor) {\n        this.initializeShape('line');\n        var start = startX && startY ? { x: startX, y: startY } : null;\n        var width = endX - startX;\n        var height = endY - startY;\n        this.drawShape('line', strokeWidth, strokeColor, null, start, width, height);\n    };\n    Shape.prototype.drawPath = function (pointColl, strokeWidth, strokeColor) {\n        this.initializeShape('path');\n        if (pointColl) {\n            this.drawShape('path', strokeWidth, strokeColor, null, null, null, null, pointColl);\n        }\n        else {\n            this.drawShape('line', strokeWidth, strokeColor, null, null, null, null);\n            var obj = extend({}, this.parent.objColl[this.parent.objColl.length - 1], null, true);\n            obj.shape = 'path';\n            obj.lineDraw = null;\n            obj.pointColl = [{ x: obj.activePoint.startX, y: obj.activePoint.startY },\n                { x: obj.activePoint.endX, y: obj.activePoint.endY }];\n            this.parent.objColl[this.parent.objColl.length - 1] = obj;\n        }\n    };\n    Shape.prototype.drawArrow = function (startX, startY, endX, endY, strokeWidth, strokeColor, arrowStart, arrowEnd) {\n        this.initializeShape('arrow');\n        var start = startX && startY ? { x: startX, y: startY } : null;\n        var width = endX - startX;\n        var height = endY - startY;\n        this.drawShape('arrow', strokeWidth, strokeColor, null, start, width, height, null, arrowStart, arrowEnd);\n    };\n    Shape.prototype.drawRectangle = function (x, y, width, height, strokeWidth, strokeColor, fillColor, degree) {\n        this.initializeShape('rectangle');\n        var start = x && y ? { x: x, y: y } : null;\n        this.drawShape('rectangle', strokeWidth, strokeColor, fillColor, start, width, height, null, null, null, degree);\n    };\n    Shape.prototype.drawText = function (x, y, text, fontFamily, fontSize, bold, italic, color) {\n        this.drawShapeText(text, fontFamily, fontSize, bold, italic, color, x, y);\n    };\n    Shape.prototype.initializeShape = function (type) {\n        this.redrawActObj();\n        this.parent.activeObj.shape = type;\n        if (this.parent.currObjType.shape === 'freehanddraw') {\n            this.apply();\n            this.parent.upperCanvas.style.cursor = this.parent.cursor = 'default';\n            this.parent.currObjType.shape = '';\n        }\n        this.parent.currObjType.isCustomCrop = false;\n    };\n    Shape.prototype.updateWidthHeight = function (obj) {\n        obj.activePoint.width = obj.activePoint.endX - obj.activePoint.startX;\n        obj.activePoint.height = obj.activePoint.endY - obj.activePoint.startY;\n        return obj;\n    };\n    Shape.prototype.setDimension = function (width, height) {\n        if (width && height) {\n            this.parent.activeObj.activePoint.width = width;\n            this.parent.activeObj.activePoint.height = height;\n            if (this.parent.currObjType.shape.toLowerCase() === 'ellipse') {\n                this.parent.activeObj.activePoint.width = 2 * width;\n                this.parent.activeObj.activePoint.height = 2 * height;\n            }\n        }\n    };\n    Shape.prototype.getArrowType = function (type) {\n        var arrowType = type;\n        if (type) {\n            var typeToArrowType = { 'None': 'none', 'Arrow': 'arrow', 'SolidArrow': 'arrowSolid',\n                'Circle': 'circle', 'SolidCircle': 'circleSolid', 'Square': 'square', 'SolidSquare': 'squareSolid', 'Bar': 'bar' };\n            arrowType = typeToArrowType[\"\" + type];\n        }\n        return arrowType;\n    };\n    Shape.prototype.drawShape = function (type, strokeWidth, strokeColor, fillColor, start, width, height, pointColl, arrowStart, arrowEnd, degree) {\n        var _this = this;\n        var parent = this.parent;\n        if (!parent.disabled && parent.isImageLoaded) {\n            parent.notify('draw', { prop: 'setImageEdited', onPropertyChange: false });\n            this.redrawActObj();\n            var objColl_1 = extend([], parent.objColl, [], true);\n            parent.togglePen = false;\n            this.keyHistory = '';\n            this.parent.upperCanvas.style.display = 'block';\n            this.refreshActiveObj();\n            parent.currObjType.shape = type;\n            if (parent.currObjType.shape.toLowerCase() === 'path' && isNullOrUndefined(pointColl)) {\n                parent.activeObj.shape = parent.currObjType.shape.toLowerCase();\n                parent.activeObj.pointColl = [];\n                parent.upperCanvas.style.cursor = this.parent.cursor = 'crosshair';\n                parent.notify('selection', { prop: 'setCurrentDrawingShape', onPropertyChange: false, value: { value: 'path' } });\n                if (!isBlazor()) {\n                    parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'shapes',\n                            isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                    parent.notify('toolbar', { prop: 'update-toolbar-items', onPropertyChange: false });\n                }\n            }\n            else {\n                if (parent.currObjType.shape.toLowerCase() !== 'freehanddraw' && parent.currObjType.shape.toLowerCase() !== '') {\n                    parent.activeObj.shape = parent.currObjType.shape.toLowerCase();\n                    this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                    if (isNullOrUndefined(parent.activeObj.strokeSettings)) {\n                        parent.activeObj.strokeSettings = this.strokeSettings;\n                    }\n                    if (parent.currObjType.shape.toLowerCase() === 'path' && pointColl) {\n                        parent.activeObj.pointColl = pointColl;\n                    }\n                    parent.activeObj.strokeSettings.strokeWidth = strokeWidth ? strokeWidth : parent.activeObj.strokeSettings.strokeWidth;\n                    parent.activeObj.strokeSettings.strokeColor = strokeColor ? strokeColor : parent.activeObj.strokeSettings.strokeColor;\n                    parent.activeObj.strokeSettings.fillColor = fillColor ? fillColor : parent.activeObj.strokeSettings.fillColor;\n                    var tempWidth = parent.img.destWidth > 100 ? 100 : parent.img.destWidth / 2;\n                    var tempHeight = parent.img.destHeight > 100 ? 100 : parent.img.destHeight / 2;\n                    parent.activeObj.activePoint.width = tempWidth;\n                    parent.activeObj.activePoint.height = tempHeight;\n                    if (parent.currObjType.shape.toLowerCase() === 'line' || parent.currObjType.shape.toLowerCase() === 'arrow') {\n                        parent.activeObj.lineDraw = 'horizontal';\n                        parent.activeObj.activePoint.height = 0;\n                        if (parent.currObjType.shape.toLowerCase() === 'arrow') {\n                            parent.activeObj.activePoint.width += 50;\n                            parent.activeObj.start = this.getArrowType(arrowStart);\n                            parent.activeObj.end = this.getArrowType(arrowEnd);\n                        }\n                    }\n                    else if (parent.currObjType.shape.toLowerCase() === 'rectangle') {\n                        parent.activeObj.activePoint.width += parent.activeObj.activePoint.width / 2;\n                    }\n                    this.setDimension(width, height);\n                    if (start) {\n                        parent.activeObj.activePoint.startX = start.x;\n                        parent.activeObj.activePoint.startY = start.y;\n                        parent.activeObj.activePoint.endX = parent.activeObj.activePoint.startX +\n                            parent.activeObj.activePoint.width;\n                        parent.activeObj.activePoint.endY = parent.activeObj.activePoint.startY +\n                            parent.activeObj.activePoint.height;\n                    }\n                    else {\n                        this.setCenterPoints();\n                    }\n                    this.setPointCollForLineAndArrow();\n                    if (parent.currObjType.shape.toLowerCase() === 'arrow') {\n                        parent.activeObj.triangleDirection = 'right';\n                    }\n                    parent.currObjType.isDragging = parent.currObjType.isCustomCrop = false;\n                    this.initShapeProps();\n                    var obj = { shapeSettingsObj: {} };\n                    parent.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: obj } });\n                    var shapeSettings = obj['shapeSettingsObj'];\n                    var shapeChangingArgs = { action: 'insert', previousShapeSettings: shapeSettings,\n                        currentShapeSettings: shapeSettings };\n                    if (isBlazor() && parent.events && parent.events.shapeChanging.hasDelegate === true) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        this.parent.dotNetRef.invokeMethodAsync('ShapeEventAsync', 'OnShape', shapeChangingArgs).then(function (shapeChangingArgs) {\n                            _this.updateShapeChangeEventArgs(shapeChangingArgs.currentShapeSettings);\n                            _this.setDimension(width, height);\n                            parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate' } });\n                            if (degree) {\n                                parent.activeObj.rotatedAngle = degree * (Math.PI / 180);\n                                parent.notify('selection', { prop: 'updPtCollForShpRot', onPropertyChange: false, value: { obj: parent.activeObj } });\n                            }\n                            parent.updateToolbar(parent.element, 'quickAccessToolbar', 'shape');\n                            parent.notify('selection', { prop: 'isShapeInserted', onPropertyChange: false, value: { bool: true } });\n                            parent.notify('undo-redo', { prop: 'updateUrObj', onPropertyChange: false, value: { objColl: objColl_1 } });\n                            if (parent.isPublicMethod) {\n                                parent.notify('undo-redo', { prop: 'updateUndoRedo', onPropertyChange: false });\n                            }\n                            parent.isPublicMethod = false;\n                        });\n                    }\n                    else {\n                        parent.trigger('shapeChanging', shapeChangingArgs);\n                        this.updateShapeChangeEventArgs(shapeChangingArgs.currentShapeSettings);\n                        this.setDimension(width, height);\n                        parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate' } });\n                        if (degree) {\n                            parent.activeObj.rotatedAngle = degree * (Math.PI / 180);\n                            parent.notify('selection', { prop: 'updPtCollForShpRot', onPropertyChange: false, value: { obj: parent.activeObj } });\n                        }\n                        if (!isBlazor()) {\n                            parent.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: null } });\n                        }\n                        else {\n                            parent.updateToolbar(parent.element, 'quickAccessToolbar', 'shape');\n                        }\n                        parent.notify('selection', { prop: 'isShapeInserted', onPropertyChange: false, value: { bool: true } });\n                        parent.notify('undo-redo', { prop: 'updateUrObj', onPropertyChange: false, value: { objColl: objColl_1 } });\n                        parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'shapes',\n                                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                        parent.notify('toolbar', { prop: 'update-toolbar-items', onPropertyChange: false });\n                        if (parent.isPublicMethod) {\n                            parent.notify('undo-redo', { prop: 'updateUndoRedo', onPropertyChange: false });\n                        }\n                        parent.isPublicMethod = false;\n                    }\n                }\n            }\n        }\n    };\n    Shape.prototype.initShapeProps = function () {\n        var parent = this.parent;\n        parent.activeObj.shapeDegree = parent.transform.degree;\n        parent.activeObj.shapeFlip = parent.transform.currFlipState;\n        parent.activeObj.textFlip = parent.transform.currFlipState;\n        parent.activeObj.flipObjColl = [];\n    };\n    Shape.prototype.setPointCollForLineAndArrow = function () {\n        var parent = this.parent;\n        if (parent.activeObj.shape === 'line' || parent.activeObj.shape === 'arrow') {\n            parent.activeObj.pointColl = this.getLinePoints(parent.activeObj.activePoint.startX, parent.activeObj.activePoint.startY, parent.activeObj.activePoint.endX, parent.activeObj.activePoint.endY);\n            if (parent.activeObj.pointColl) {\n                for (var i = 0, len = parent.activeObj.pointColl.length; i < len; i++) {\n                    parent.activeObj.pointColl[i].ratioX = (parent.activeObj.pointColl[i].x -\n                        parent.img.destLeft) / parent.img.destWidth;\n                    parent.activeObj.pointColl[i].ratioY = (parent.activeObj.pointColl[i].y -\n                        parent.img.destTop) / parent.img.destHeight;\n                }\n            }\n        }\n    };\n    Shape.prototype.prevObjColl = function () {\n        var parent = this.parent;\n        var object = { currObj: {} };\n        parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        this.prevObj = object['currObj'];\n        this.prevObj.objColl = extend([], parent.objColl, [], true);\n        this.prevObj.pointColl = extend([], parent.pointColl, [], true);\n        this.prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        this.prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n    };\n    Shape.prototype.drawShapeText = function (text, fontFamily, fontSize, bold, italic, strokeColor, x, y) {\n        var _this = this;\n        var parent = this.parent;\n        if (!parent.disabled && parent.isImageLoaded) {\n            if (parent.currObjType.shape === 'freehanddraw') {\n                this.apply();\n                parent.upperCanvas.style.cursor = parent.cursor = 'default';\n                parent.currObjType.shape = '';\n            }\n            parent.notify('draw', { prop: 'setImageEdited', onPropertyChange: false });\n            parent.togglePen = false;\n            this.redrawActObj();\n            this.prevObjColl();\n            this.refreshActiveObj();\n            parent.activeObj.shape = parent.currObjType.shape = 'text';\n            parent.currObjType.isCustomCrop = false;\n            this.initializeTextShape(text, fontFamily, fontSize, bold, italic, strokeColor);\n            parent.currObjType.isText = parent.currObjType.isInitialText = true;\n            if (isNullOrUndefined(parent.activeObj.textSettings.fontSize)) {\n                if (parent.img.destWidth > parent.img.destHeight) {\n                    parent.activeObj.textSettings.fontSize = (parent.img.destWidth / 15);\n                }\n                else {\n                    parent.activeObj.textSettings.fontSize = (parent.img.destHeight / 15);\n                }\n                if (parent.activeObj.textSettings.fontSize < 20) {\n                    parent.activeObj.textSettings.fontSize = 20;\n                }\n            }\n            if (parent.img.destWidth < 100) {\n                parent.activeObj.textSettings.fontSize = Math.floor((parent.img.destWidth / 20));\n            }\n            else if (parent.img.destHeight < 100) {\n                parent.activeObj.textSettings.fontSize = Math.floor((parent.img.destHeight / 20));\n            }\n            parent.activeObj.shapeDegree = parent.transform.degree;\n            parent.activeObj.shapeFlip = parent.transform.currFlipState;\n            parent.activeObj.flipObjColl = [];\n            this.updateFontStyles();\n            var width = this.upperContext.measureText(parent.activeObj.textSettings.text).width +\n                parent.activeObj.textSettings.fontSize * 0.5;\n            var height = parent.activeObj.textSettings.fontSize + parent.activeObj.textSettings.fontSize * 0.25;\n            if (!isNullOrUndefined(x) && !isNullOrUndefined(y)) {\n                parent.activeObj.activePoint.startX = x;\n                parent.activeObj.activePoint.startY = y;\n                parent.activeObj.activePoint.endX = parent.activeObj.activePoint.startX + width;\n                parent.activeObj.activePoint.endY = parent.activeObj.activePoint.startY + height;\n            }\n            else {\n                this.setCenterPoints(true, width, height);\n            }\n            var obj = { shapeSettingsObj: {} };\n            parent.notify('selection', { prop: 'updatePrevShapeSettings', onPropertyChange: false, value: { obj: obj } });\n            var shapeSettings = obj['shapeSettingsObj'];\n            var shapeChangingArgs = { action: 'insert', previousShapeSettings: shapeSettings,\n                currentShapeSettings: shapeSettings };\n            if (isBlazor() && parent.events && parent.events.shapeChanging.hasDelegate === true) {\n                /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                parent.dotNetRef.invokeMethodAsync('ShapeEventAsync', 'OnShape', shapeChangingArgs).then(function (shapeChangingArgs) {\n                    _this.drawShapeTextEvent(shapeChangingArgs);\n                    if (parent.isPublicMethod) {\n                        parent.notify('undo-redo', { prop: 'updateUndoRedo', onPropertyChange: false });\n                    }\n                    parent.isPublicMethod = false;\n                });\n            }\n            else {\n                parent.trigger('shapeChanging', shapeChangingArgs);\n                this.drawShapeTextEvent(shapeChangingArgs);\n                if (parent.isPublicMethod) {\n                    parent.notify('undo-redo', { prop: 'updateUndoRedo', onPropertyChange: false });\n                }\n                parent.isPublicMethod = false;\n            }\n        }\n    };\n    Shape.prototype.drawShapeTextEvent = function (shapeChangingArgs) {\n        var parent = this.parent;\n        this.updateShapeChangeEventArgs(shapeChangingArgs.currentShapeSettings);\n        this.addLetter(parent.activeObj.textSettings.text);\n        parent.activeObj.textFlip = parent.transform.currFlipState;\n        this.updateFontRatio(parent.activeObj);\n        parent.objColl.push(parent.activeObj);\n        var prevCropObj = extend({}, parent.cropObj, {}, true);\n        parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n            value: { operation: 'shapeTransform', previousObj: this.prevObj, previousObjColl: this.prevObj.objColl,\n                previousPointColl: this.prevObj.pointColl, previousSelPointColl: this.prevObj.selPointColl,\n                previousCropObj: prevCropObj, previousText: null,\n                currentText: null, previousFilter: null, isCircleCrop: null } });\n        parent.notify('selection', { prop: 'redrawShape', onPropertyChange: false,\n            value: { obj: parent.objColl[parent.objColl.length - 1] } });\n        if (!isBlazor()) {\n            parent.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: null } });\n        }\n        else {\n            parent.updateToolbar(parent.element, 'quickAccessToolbar', 'text');\n        }\n        parent.notify('selection', { prop: 'isShapeInserted', onPropertyChange: false, value: { bool: true } });\n        if (!isBlazor()) {\n            parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'text',\n                    isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n            parent.notify('toolbar', { prop: 'update-toolbar-items', onPropertyChange: false });\n        }\n        else {\n            parent.updateToolbar(parent.element, 'text');\n        }\n    };\n    Shape.prototype.initializeTextShape = function (text, fontFamily, fontSize, bold, italic, strokeColor) {\n        var parent = this.parent;\n        this.keyHistory = '';\n        parent.upperCanvas.style.display = 'block';\n        if (isNullOrUndefined(parent.activeObj.textSettings)) {\n            parent.activeObj.textSettings = this.textSettings;\n        }\n        if (isNullOrUndefined(parent.activeObj.strokeSettings)) {\n            parent.activeObj.strokeSettings = this.strokeSettings;\n        }\n        parent.activeObj.strokeSettings.strokeColor = strokeColor || parent.activeObj.strokeSettings.strokeColor;\n        parent.activeObj.textSettings.text = text || parent.activeObj.textSettings.text;\n        parent.activeObj.textSettings.fontFamily = fontFamily || parent.activeObj.textSettings.fontFamily;\n        parent.activeObj.textSettings.fontSize = fontSize || parent.activeObj.textSettings.fontSize;\n        parent.activeObj.textSettings.bold = bold || parent.activeObj.textSettings.bold;\n        parent.activeObj.textSettings.italic = italic || parent.activeObj.textSettings.italic;\n    };\n    Shape.prototype.redrawActObj = function (x, y, isMouseDown) {\n        var splitWords;\n        var parent = this.parent;\n        if (parent.activeObj.shape) {\n            splitWords = parent.activeObj.shape.split('-');\n        }\n        if (parent.activeObj.horTopLine && (parent.activeObj.shape && splitWords[0] !== 'crop')) {\n            if (parent.textArea.style.display === 'block') {\n                parent.notify('selection', { prop: 'setTextBoxStylesToActObj', onPropertyChange: false });\n                this.updateFontRatio(parent.activeObj, true);\n                if (x && y) {\n                    if ((x !== parent.activeObj.activePoint.startX) && (y !== parent.activeObj.activePoint.startY)) {\n                        this.updateTextFromTextArea();\n                    }\n                }\n                else {\n                    this.updateTextFromTextArea();\n                    parent.textArea.style.transform = '';\n                    parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n                }\n                this.refreshActiveObj();\n            }\n            else {\n                this.applyActObj(isMouseDown);\n            }\n        }\n    };\n    Shape.prototype.apply = function (shape, obj, canvas) {\n        var parent = this.parent;\n        if (!parent.disabled) {\n            if (parent.togglePen && !parent.currObjType.isCustomCrop) {\n                var destLeft = parent.img.destLeft;\n                var destTop = parent.img.destTop;\n                var destWidth = parent.img.destWidth;\n                var destHeight = parent.img.destHeight;\n                parent.notify('draw', { prop: 'callUpdateCurrTransState', onPropertyChange: false });\n                var temp = this.lowerContext.filter;\n                this.lowerContext.filter = 'none';\n                parent.togglePen = false;\n                this.iterateObjColl();\n                parent.notify('freehandDraw', { prop: 'freehandRedraw', onPropertyChange: false,\n                    value: { context: this.lowerContext, points: null } });\n                parent.togglePen = false;\n                if (parent.isCircleCrop || (parent.currSelectionPoint &&\n                    parent.currSelectionPoint.shape === 'crop-circle')) {\n                    parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                        value: { context: this.lowerContext, isSave: null, isFlip: null } });\n                }\n                parent.img.destLeft = destLeft;\n                parent.img.destTop = destTop;\n                parent.img.destWidth = destWidth;\n                parent.img.destHeight = destHeight;\n                this.lowerContext.filter = temp;\n            }\n            else {\n                canvas = canvas ? canvas : 'original';\n                if (isNullOrUndefined(parent.activeObj.shape) && isNullOrUndefined(shape)) {\n                    parent.currObjType.shape = '';\n                }\n                else {\n                    parent.currObjType.shape = shape || parent.currObjType.shape;\n                }\n                if (parent.currObjType.shape !== '') {\n                    this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                    if (parent.activeObj.shape === 'text') {\n                        parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: canvas, obj: obj, isCropRatio: null,\n                                points: null, isPreventDrag: true, saveContext: null, isPreventSelection: null } });\n                        parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n                    }\n                    else {\n                        parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: canvas, obj: obj } });\n                    }\n                    parent.activeObj.shape = parent.currObjType.shape.toLowerCase();\n                    if (!shape && parent.currObjType.shape !== '' && !parent.currObjType.isCustomCrop) {\n                        parent.objColl.push(extend({}, parent.activeObj, {}, true));\n                    }\n                    this.keyHistory = '';\n                }\n            }\n        }\n    };\n    Shape.prototype.setCenterPoints = function (text, width, height) {\n        var parent = this.parent;\n        var renderWidth;\n        var renderHeight;\n        if (text && width && height) {\n            renderWidth = width;\n            renderHeight = height;\n        }\n        else {\n            renderWidth = parent.activeObj.activePoint.width;\n            renderHeight = parent.activeObj.activePoint.height;\n        }\n        parent.activeObj.activePoint.startX = (parent.lowerCanvas.width / 2) - renderWidth / 2;\n        parent.activeObj.activePoint.startY = (parent.lowerCanvas.height / 2) - renderHeight / 2;\n        parent.activeObj.activePoint.endX = (parent.lowerCanvas.width / 2) + renderWidth / 2;\n        parent.activeObj.activePoint.endY = (parent.lowerCanvas.height / 2) + renderHeight / 2;\n    };\n    Shape.prototype.updSelChangeEventArgs = function (selectionSettings) {\n        var parent = this.parent;\n        parent.activeObj.activePoint.startX = selectionSettings.startX;\n        parent.activeObj.activePoint.startY = selectionSettings.startY;\n        parent.activeObj.activePoint.width = selectionSettings.width;\n        parent.activeObj.activePoint.height = selectionSettings.height;\n        parent.activeObj.activePoint.endX = parent.activeObj.activePoint.startX + parent.activeObj.activePoint.width;\n        parent.activeObj.activePoint.endY = parent.activeObj.activePoint.startY + parent.activeObj.activePoint.height;\n    };\n    Shape.prototype.updateShapeChangeEventArgs = function (shapeSettings) {\n        var parent = this.parent;\n        parent.activeObj.currIndex = shapeSettings.id;\n        parent.activeObj.activePoint.startX = shapeSettings.startX;\n        parent.activeObj.activePoint.startY = shapeSettings.startY;\n        parent.activeObj.activePoint.width = shapeSettings.width;\n        parent.activeObj.activePoint.height = shapeSettings.height;\n        parent.activeObj.activePoint.endX = parent.activeObj.activePoint.startX + parent.activeObj.activePoint.width;\n        parent.activeObj.activePoint.endY = parent.activeObj.activePoint.startY + parent.activeObj.activePoint.height;\n        parent.activeObj.strokeSettings.strokeColor = shapeSettings.strokeColor;\n        parent.activeObj.strokeSettings.fillColor = shapeSettings.fillColor;\n        switch (parent.activeObj.shape) {\n            case 'ellipse':\n                parent.activeObj.activePoint.width = shapeSettings.radius * 2;\n                break;\n            case 'line':\n            case 'arrow':\n                parent.activeObj.activePoint.width = shapeSettings.length;\n                break;\n            case 'text':\n                parent.activeObj.keyHistory = parent.activeObj.textSettings.text = shapeSettings.text;\n                parent.activeObj.textSettings.fontSize = shapeSettings.fontSize;\n                parent.activeObj.strokeSettings.strokeColor = shapeSettings.color;\n                parent.activeObj.textSettings.fontFamily = shapeSettings.fontFamily;\n                break;\n            case 'rectangle':\n                break;\n        }\n        if (parent.activeObj.shape === 'text' && parent.activeObj.textSettings) {\n            for (var i = 0; i < shapeSettings.fontStyle.length; i++) {\n                switch (shapeSettings.fontStyle[i]) {\n                    case 'bold':\n                        parent.activeObj.textSettings.bold = true;\n                        break;\n                    case 'italic':\n                        parent.activeObj.textSettings.italic = true;\n                        break;\n                    case 'underline':\n                        parent.activeObj.textSettings.underline = true;\n                        break;\n                }\n            }\n        }\n    };\n    Shape.prototype.addLetter = function (letter) {\n        var parent = this.parent;\n        if (parent.textArea.style.display === 'none' && (parent.currObjType.isText || parent.activeObj.shape === 'text')) {\n            if (letter === 'Backspace') {\n                this.keyHistory = this.keyHistory.slice(0, -1);\n            }\n            else {\n                this.keyHistory += letter;\n            }\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            this.updateFontStyles();\n            var width = this.upperContext.measureText(this.keyHistory).width\n                + parent.activeObj.textSettings.fontSize * 0.5;\n            var height = parent.activeObj.textSettings.fontSize + parent.activeObj.textSettings.fontSize * 0.25;\n            this.upperContext.fillText(this.keyHistory, parent.activeObj.activePoint.startX, parent.activeObj.activePoint.startY +\n                parent.activeObj.textSettings.fontSize);\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            parent.currObjType.isText = true;\n            parent.notify('selection', { prop: 'setActivePoint', onPropertyChange: false,\n                value: { startX: width, startY: height } });\n        }\n    };\n    Shape.prototype.redrawText = function () {\n        var parent = this.parent;\n        var fontStyle = '';\n        if (parent.activeObj.textSettings.bold) {\n            fontStyle += 'bold ';\n        }\n        if (parent.activeObj.textSettings.italic) {\n            fontStyle += 'italic ';\n        }\n        this.upperContext.font = fontStyle + parent.activeObj.textSettings.fontSize + 'px ' + parent.activeObj.textSettings.fontFamily;\n        var rows = parent.activeObj.keyHistory.split('\\n');\n        var text = parent.textArea.style.display === 'block' ? this.getMaxText(true) : this.getMaxText();\n        var width = this.upperContext.measureText(text).width + parent.activeObj.textSettings.fontSize * 0.5;\n        var height = rows.length * (parent.activeObj.textSettings.fontSize + parent.activeObj.textSettings.fontSize * 0.25);\n        parent.notify('selection', { prop: 'setTextSelection', onPropertyChange: false,\n            value: { width: width, height: height } });\n        parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: parent.activeObj.activePoint, obj: parent.activeObj,\n                isMouseMove: null, x: null, y: null } });\n        parent.notify('selection', { prop: 'redrawShape', onPropertyChange: false,\n            value: { obj: parent.activeObj } });\n    };\n    Shape.prototype.updateTextFromTextArea = function () {\n        var parent = this.parent;\n        var allowUndoRedo = false;\n        var prevCropObj = extend({}, parent.cropObj, {}, true);\n        var object = { currObj: {} };\n        parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var prevObj = object['currObj'];\n        prevObj.objColl = extend([], parent.objColl, [], true);\n        prevObj.pointColl = extend([], parent.pointColl, [], true);\n        prevObj.afterCropActions = extend([], this.parent.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        if (parent.activeObj.keyHistory !== parent.textArea.value) {\n            allowUndoRedo = true;\n        }\n        parent.activeObj.keyHistory = parent.textArea.value;\n        parent.textArea.style.display = 'none';\n        parent.textArea.value = '';\n        this.updateFontStyles();\n        var width = this.upperContext.measureText(parent.activeObj.keyHistory).width +\n            parent.activeObj.textSettings.fontSize * 0.5;\n        var height = parent.activeObj.textSettings.fontSize + this.parent.activeObj.textSettings.fontSize * 0.25;\n        var rows = parent.activeObj.keyHistory.split('\\n');\n        if (rows.length > 1) {\n            height *= rows.length;\n            var widthColl = [];\n            for (var i = 0, len = rows.length; i < len; i++) {\n                widthColl.push(this.upperContext.measureText(rows[i]).width +\n                    parent.activeObj.textSettings.fontSize * 0.5);\n            }\n            width = Math.max.apply(Math, widthColl);\n        }\n        parent.notify('selection', { prop: 'setTextSelection', onPropertyChange: false,\n            value: { width: width, height: height } });\n        parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: parent.activeObj.activePoint, obj: parent.activeObj,\n                isMouseMove: null, x: null, y: null } });\n        this.updImgRatioForActObj();\n        if (allowUndoRedo) {\n            this.apply(parent.activeObj.shape, parent.activeObj);\n            parent.objColl.push(extend({}, parent.activeObj, {}, true));\n            parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                value: { operation: 'text', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                    previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                    previousCropObj: prevCropObj, previousText: parent.activeObj.keyHistory,\n                    currentText: parent.textArea.value, previousFilter: null, isCircleCrop: null } });\n        }\n        else {\n            this.apply(parent.activeObj.shape, parent.activeObj);\n            parent.objColl.push(extend({}, parent.activeObj, {}, true));\n        }\n    };\n    Shape.prototype.iterateObjColl = function () {\n        var parent = this.parent;\n        for (var i = 0, len = parent.objColl.length; i < len; i++) {\n            this.apply(parent.objColl[i].shape, parent.objColl[i]);\n            this.refreshActiveObj();\n        }\n    };\n    Shape.prototype.updImgRatioForActObj = function () {\n        var parent = this.parent;\n        parent.activeObj.imageRatio = { startX: ((parent.activeObj.activePoint.startX - parent.img.destLeft) /\n                parent.img.destWidth),\n            startY: ((parent.activeObj.activePoint.startY - parent.img.destTop) / parent.img.destHeight),\n            endX: ((parent.activeObj.activePoint.endX - parent.img.destLeft) / parent.img.destWidth),\n            endY: ((parent.activeObj.activePoint.endY - parent.img.destTop) / parent.img.destHeight),\n            width: parent.img.destWidth / parent.activeObj.activePoint.width, height: parent.img.destHeight /\n                parent.activeObj.activePoint.height };\n        if (parent.activeObj.rotationCirclePointColl) {\n            parent.activeObj.rotationCirclePointColl.ratioX = (parent.activeObj.rotationCirclePointColl.x -\n                parent.img.destLeft) / parent.img.destWidth;\n            parent.activeObj.rotationCirclePointColl.ratioY = (parent.activeObj.rotationCirclePointColl.y -\n                parent.img.destTop) / parent.img.destHeight;\n        }\n        if (parent.activeObj.shape === 'path') {\n            this.updatePathRatio(parent.activeObj);\n        }\n        else if (parent.activeObj.shape === 'arrow') {\n            this.updateArrowRatio(parent.activeObj);\n        }\n    };\n    Shape.prototype.zoomObjColl = function (preventApply) {\n        var parent = this.parent;\n        for (var i = 0, len = parent.objColl.length; i < len; i++) {\n            var currObj = parent.objColl[i];\n            currObj.activePoint.startX = (currObj.imageRatio.startX * parent.img.destWidth) + parent.img.destLeft;\n            currObj.activePoint.startY = (currObj.imageRatio.startY * parent.img.destHeight) + parent.img.destTop;\n            currObj.activePoint.endX = (currObj.imageRatio.endX * parent.img.destWidth) + parent.img.destLeft;\n            currObj.activePoint.endY = (currObj.imageRatio.endY * parent.img.destHeight) + parent.img.destTop;\n            currObj = this.updateWidthHeight(currObj);\n            if (currObj.shape === 'text') {\n                this.updateFontSize(currObj);\n            }\n            else if (currObj.shape === 'line' || currObj.shape === 'arrow') {\n                currObj.pointColl = this.getLinePoints(currObj.activePoint.startX, currObj.activePoint.startY, currObj.activePoint.endX, currObj.activePoint.endY);\n                for (var n = 0, len_1 = currObj.pointColl.length; n < len_1; n++) {\n                    currObj.pointColl[n].ratioX =\n                        (currObj.pointColl[n].x - parent.img.destLeft) / parent.img.destWidth;\n                    currObj.pointColl[n].ratioY =\n                        (currObj.pointColl[n].y - parent.img.destTop) / parent.img.destHeight;\n                }\n                if (currObj.shape === 'arrow') {\n                    this.updateArrowSize(currObj);\n                }\n            }\n            else if (currObj.shape === 'path') {\n                for (var l = 0, len_2 = currObj.pointColl.length; l < len_2; l++) {\n                    currObj.pointColl[l].x = (currObj.pointColl[l].ratioX * parent.img.destWidth)\n                        + parent.img.destLeft;\n                    currObj.pointColl[l].y = (currObj.pointColl[l].ratioY * parent.img.destHeight) +\n                        parent.img.destTop;\n                }\n                this.updatePathRatio(currObj);\n            }\n            parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: currObj.activePoint,\n                    obj: currObj } });\n            if (isNullOrUndefined(preventApply)) {\n                var temp = this.lowerContext.filter;\n                this.lowerContext.filter = 'none';\n                this.apply(currObj.shape, currObj);\n                this.refreshActiveObj();\n                this.lowerContext.filter = temp;\n            }\n            if (currObj.shape !== 'line' && currObj.shape !== 'arrow' && currObj.shape !== 'path' && currObj.rotatedAngle !== 0) {\n                this.setPointCollForShapeRotation(currObj);\n                currObj.rotationCirclePoint.x =\n                    (currObj.rotationCirclePoint.ratioX * parent.img.destWidth) + parent.img.destLeft;\n                currObj.rotationCirclePoint.y =\n                    (currObj.rotationCirclePoint.ratioY * parent.img.destHeight) + parent.img.destTop;\n                currObj.rotationCirclePointColl.x =\n                    (currObj.rotationCirclePointColl.ratioX * parent.img.destWidth) +\n                        parent.img.destLeft;\n                currObj.rotationCirclePointColl.y =\n                    (currObj.rotationCirclePointColl.ratioY * parent.img.destHeight) +\n                        parent.img.destTop;\n            }\n        }\n    };\n    Shape.prototype.redrawObj = function (degree) {\n        var parent = this.parent;\n        if (this.parent.objColl.length > 0) {\n            if (degree === 'horizontal' || degree === 'vertical' || degree === 'Horizontal' || degree === 'Vertical' ||\n                degree === 'horizontalVertical' || degree === 'verticalHorizontal') {\n                this.updateCurrentActiveObjPoint(degree.toLowerCase());\n            }\n            else if (typeof (degree) === 'number') {\n                this.updateCurrentActiveObjPoint(degree);\n                var tempFilter = this.lowerContext.filter;\n                this.lowerContext.filter = 'brightness(' + 1 + ') ' + 'contrast(' + 100 + '%) ' + 'hue-rotate(' + 0 + 'deg) ' +\n                    'saturate(' + 100 + '%) ' + 'opacity(' + 1 + ') ' + 'blur(' + 0 + 'px) ' + 'sepia(0%) ' + 'grayscale(0%) ' + 'invert(0%)';\n                for (var i = 0, len = parent.objColl.length; i < len; i++) {\n                    var splitWords = parent.objColl[i].shape.split('-');\n                    if (splitWords[0] !== 'crop') {\n                        this.apply(parent.objColl[i].shape, parent.objColl[i]);\n                    }\n                }\n                this.lowerContext.filter = tempFilter;\n            }\n        }\n    };\n    Shape.prototype.updateCurrentActiveObjPoint = function (degree) {\n        var parent = this.parent;\n        var currActObjIndex;\n        for (var index = 0, len = parent.objColl.length; index < len; index++) {\n            var currObj = parent.objColl[index];\n            if (parent.activeObj.shape === currObj.shape &&\n                parent.activeObj.activePoint.startX === currObj.activePoint.startX &&\n                parent.activeObj.activePoint.startY === currObj.activePoint.startY &&\n                parent.activeObj.activePoint.endX === currObj.activePoint.endX &&\n                parent.activeObj.activePoint.endY === currObj.activePoint.endY &&\n                parent.activeObj.currIndex === currObj.currIndex) {\n                currActObjIndex = index;\n                break;\n            }\n        }\n        if (degree === 'horizontal' || degree === 'vertical' || degree === 'Horizontal' || degree === 'Vertical' ||\n            degree === 'horizontalvertical' || degree === 'verticalhorizontal') {\n            if (degree === 'horizontal' || degree === 'Horizontal') {\n                for (var i = 0, len = parent.objColl.length; i < len; i++) {\n                    var currObj = parent.objColl[i];\n                    if (currObj.shapeFlip !== parent.transform.currFlipState) {\n                        if (currObj.activePoint.startX <= parent.img.destLeft + (parent.img.destWidth / 2)) {\n                            currObj.activePoint.endX = (parent.img.destLeft + parent.img.destWidth) - (currObj.activePoint.startX -\n                                parent.img.destLeft);\n                            currObj.activePoint.startX = currObj.activePoint.endX - currObj.activePoint.width;\n                            parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: currObj.activePoint, obj: currObj } });\n                        }\n                        else if (currObj.activePoint.startX >= parent.img.destLeft + (parent.img.destWidth / 2)) {\n                            currObj.activePoint.startX = parent.img.destLeft + (parent.img.destLeft + parent.img.destWidth -\n                                currObj.activePoint.endX);\n                            currObj.activePoint.endX = currObj.activePoint.startX + currObj.activePoint.width;\n                            parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: currObj.activePoint,\n                                    obj: currObj } });\n                        }\n                        if (currObj.shape === 'line' || currObj.shape === 'arrow' || currObj.shape === 'path') {\n                            this.flipLineArrowObj(currObj, 'horizontal');\n                        }\n                        else if (currObj.rotatedAngle !== 0) {\n                            currObj.rotatedAngle = currObj.rotatedAngle + (Math.PI - currObj.rotatedAngle) * 2;\n                            if (currObj.rotationCirclePointColl.x <= parent.img.destLeft + (parent.img.destWidth / 2)) {\n                                currObj.rotationCirclePointColl.x = (parent.img.destLeft + parent.img.destWidth) -\n                                    (currObj.rotationCirclePointColl.x - parent.img.destLeft);\n                            }\n                            else if (currObj.rotationCirclePointColl.x >= parent.img.destLeft + (parent.img.destWidth / 2)) {\n                                currObj.rotationCirclePointColl.x = parent.img.destLeft +\n                                    (parent.img.destLeft + parent.img.destWidth - currObj.rotationCirclePointColl.x);\n                            }\n                            currObj.rotationCirclePointColl.ratioX =\n                                (currObj.rotationCirclePointColl.x - parent.img.destLeft) / parent.img.destWidth;\n                        }\n                        currObj.shapeFlip = parent.transform.currFlipState;\n                        currObj.imageRatio = { startX: ((currObj.activePoint.startX - parent.img.destLeft) / parent.img.destWidth),\n                            startY: ((currObj.activePoint.startY - parent.img.destTop) / parent.img.destHeight),\n                            endX: ((currObj.activePoint.endX - parent.img.destLeft) / parent.img.destWidth),\n                            endY: ((currObj.activePoint.endY - parent.img.destTop) / parent.img.destHeight),\n                            width: parent.img.destWidth / currObj.activePoint.width,\n                            height: parent.img.destHeight / currObj.activePoint.height };\n                    }\n                }\n            }\n            else if (degree === 'vertical' || degree === 'Vertical') {\n                for (var i = 0; i < parent.objColl.length; i++) {\n                    var currObj = parent.objColl[i];\n                    if (currObj.shapeFlip !== parent.transform.currFlipState) {\n                        if (currObj.activePoint.startY <= parent.img.destTop + (parent.img.destHeight / 2)) {\n                            currObj.activePoint.endY = (parent.img.destTop + parent.img.destHeight) -\n                                (currObj.activePoint.startY - parent.img.destTop);\n                            currObj.activePoint.startY = currObj.activePoint.endY - currObj.activePoint.height;\n                            parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: currObj.activePoint,\n                                    obj: currObj } });\n                        }\n                        else if (currObj.activePoint.startY >= this.parent.lowerCanvas.height / 2) {\n                            currObj.activePoint.startY = parent.img.destTop + (parent.img.destTop +\n                                parent.img.destHeight - currObj.activePoint.endY);\n                            currObj.activePoint.endY = currObj.activePoint.startY +\n                                currObj.activePoint.height;\n                            parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: currObj.activePoint,\n                                    obj: currObj } });\n                        }\n                        if (currObj.shape === 'line' || currObj.shape === 'arrow' ||\n                            currObj.shape === 'path') {\n                            this.flipLineArrowObj(currObj, 'vertical');\n                        }\n                        else if (currObj.rotatedAngle !== 0) {\n                            currObj.rotatedAngle = -currObj.rotatedAngle;\n                            if (currObj.rotationCirclePointColl.y <= parent.img.destTop + (parent.img.destHeight / 2)) {\n                                currObj.rotationCirclePointColl.y = (parent.img.destTop + parent.img.destHeight) -\n                                    (currObj.rotationCirclePointColl.y - parent.img.destTop);\n                            }\n                            else if (currObj.rotationCirclePointColl.y >= parent.img.destTop +\n                                (parent.img.destHeight / 2)) {\n                                currObj.rotationCirclePointColl.y = parent.img.destTop + (parent.img.destTop +\n                                    parent.img.destHeight - currObj.rotationCirclePointColl.y);\n                            }\n                            currObj.rotationCirclePointColl.ratioY =\n                                (currObj.rotationCirclePointColl.y - parent.img.destTop) / parent.img.destHeight;\n                        }\n                        currObj.shapeFlip = parent.transform.currFlipState;\n                        currObj.imageRatio = { startX: ((currObj.activePoint.startX - parent.img.destLeft) / parent.img.destWidth),\n                            startY: ((currObj.activePoint.startY - parent.img.destTop) / parent.img.destHeight),\n                            endX: ((currObj.activePoint.endX - parent.img.destLeft) / parent.img.destWidth),\n                            endY: ((currObj.activePoint.endY - parent.img.destTop) / parent.img.destHeight),\n                            width: parent.img.destWidth / currObj.activePoint.width,\n                            height: parent.img.destHeight / currObj.activePoint.height };\n                    }\n                }\n            }\n            else if (degree === 'verticalhorizontal' || degree === 'horizontalvertical') {\n                for (var i = 0, len = parent.objColl.length; i < len; i++) {\n                    var currObj = parent.objColl[i];\n                    if (currObj.shapeFlip !== parent.transform.currFlipState) {\n                        if (currObj.activePoint.startX <= parent.img.destLeft + (parent.img.destWidth / 2)) {\n                            currObj.activePoint.endX = (parent.img.destLeft + parent.img.destWidth) - (currObj.activePoint.startX -\n                                parent.img.destLeft);\n                            currObj.activePoint.startX = currObj.activePoint.endX - currObj.activePoint.width;\n                            parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: currObj.activePoint, obj: currObj } });\n                        }\n                        else if (currObj.activePoint.startX >= parent.img.destLeft + (parent.img.destWidth / 2)) {\n                            currObj.activePoint.startX = parent.img.destLeft + (parent.img.destLeft +\n                                parent.img.destWidth - currObj.activePoint.endX);\n                            currObj.activePoint.endX = currObj.activePoint.startX + currObj.activePoint.width;\n                            parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: currObj.activePoint, obj: currObj } });\n                        }\n                        if (currObj.activePoint.startY <= parent.img.destTop + (parent.img.destHeight / 2)) {\n                            currObj.activePoint.endY = (parent.img.destTop + parent.img.destHeight) -\n                                (currObj.activePoint.startY - parent.img.destTop);\n                            currObj.activePoint.startY = currObj.activePoint.endY -\n                                currObj.activePoint.height;\n                            parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: currObj.activePoint, obj: currObj } });\n                        }\n                        else if (currObj.activePoint.startY >= this.parent.lowerCanvas.height / 2) {\n                            currObj.activePoint.startY = parent.img.destTop + (parent.img.destTop +\n                                parent.img.destHeight - currObj.activePoint.endY);\n                            currObj.activePoint.endY = currObj.activePoint.startY +\n                                currObj.activePoint.height;\n                            parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: currObj.activePoint, obj: currObj } });\n                        }\n                        if (currObj.shape === 'line' || currObj.shape === 'arrow' || currObj.shape === 'path') {\n                            this.flipLineArrowObj(currObj, degree);\n                        }\n                        currObj.shapeFlip = parent.transform.currFlipState;\n                        currObj.imageRatio = { startX: ((currObj.activePoint.startX - parent.img.destLeft) / parent.img.destWidth),\n                            startY: ((currObj.activePoint.startY - parent.img.destTop) / parent.img.destHeight),\n                            endX: ((currObj.activePoint.endX - parent.img.destLeft) / parent.img.destWidth),\n                            endY: ((currObj.activePoint.endY - parent.img.destTop) / parent.img.destHeight),\n                            width: parent.img.destWidth / currObj.activePoint.width,\n                            height: parent.img.destHeight / currObj.activePoint.height };\n                    }\n                }\n            }\n            if (currActObjIndex !== undefined) {\n                parent.activeObj = extend({}, parent.objColl[currActObjIndex], {}, true);\n            }\n        }\n        else if (degree === 90) {\n            this.rotateObjColl();\n        }\n        else if (degree === -90) {\n            for (var i = 0; i < 3; i++) {\n                this.rotateObjColl();\n            }\n        }\n        else if (typeof (degree) === 'number') {\n            if (degree > 0) {\n                this.rotateObjColl();\n            }\n            else {\n                for (var i = 0; i < 3; i++) {\n                    this.rotateObjColl();\n                }\n            }\n        }\n    };\n    Shape.prototype.rotateObjColl = function () {\n        var parent = this.parent;\n        for (var i = 0, len = parent.objColl.length; i < len; i++) {\n            var currObj = parent.objColl[i];\n            currObj.activePoint.startY = parent.img.destTop + (parent.img.destHeight * currObj.imageRatio.startX);\n            currObj.activePoint.endY = parent.img.destTop + (parent.img.destHeight * currObj.imageRatio.endX);\n            currObj.activePoint.startX = (parent.img.destLeft + parent.img.destWidth) -\n                (parent.img.destWidth * currObj.imageRatio.endY);\n            currObj.activePoint.endX = (parent.img.destLeft + parent.img.destWidth) -\n                (parent.img.destWidth * currObj.imageRatio.startY);\n            currObj = this.updateWidthHeight(parent.objColl[i]);\n            this.updateFontSize(currObj);\n            if (currObj.shape === 'line' || currObj.shape === 'arrow' ||\n                currObj.shape === 'path') {\n                this.rotateLineArrowObj(currObj);\n                if (currObj.shape === 'arrow') {\n                    this.updateArrowSize(currObj);\n                }\n            }\n            else if (currObj.rotatedAngle !== 0) {\n                currObj.rotationCirclePointColl.y = parent.img.destTop + (parent.img.destHeight * currObj.rotationCirclePointColl.ratioX);\n                currObj.rotationCirclePointColl.x = (parent.img.destLeft + parent.img.destWidth) -\n                    (parent.img.destWidth * currObj.rotationCirclePointColl.ratioY);\n                currObj.rotationCirclePointColl.ratioX = (currObj.rotationCirclePointColl.x\n                    - parent.img.destLeft) / parent.img.destWidth;\n                currObj.rotationCirclePointColl.ratioY = (currObj.rotationCirclePointColl.y\n                    - parent.img.destTop) / parent.img.destHeight;\n            }\n        }\n        for (var i = 0, len = parent.objColl.length; i < len; i++) {\n            parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: parent.objColl[i].activePoint, obj: parent.objColl[i] } });\n        }\n        // Update current image ratio for all objects\n        for (var i = 0, len = parent.objColl.length; i < len; i++) {\n            var currObj = parent.objColl[i];\n            currObj.imageRatio = { startX: ((currObj.activePoint.startX - parent.img.destLeft) / parent.img.destWidth),\n                startY: ((currObj.activePoint.startY - parent.img.destTop) / parent.img.destHeight),\n                endX: ((currObj.activePoint.endX - parent.img.destLeft) / parent.img.destWidth),\n                endY: ((currObj.activePoint.endY - parent.img.destTop) / parent.img.destHeight),\n                width: parent.img.destWidth / currObj.activePoint.width,\n                height: parent.img.destHeight / currObj.activePoint.height };\n        }\n    };\n    Shape.prototype.rotateLineArrowObj = function (obj) {\n        if (isNullOrUndefined(obj.pointColl)) {\n            return;\n        }\n        var parent = this.parent;\n        if (obj.pointColl.length > 0) {\n            for (var n = 0; n < obj.pointColl.length; n++) {\n                obj.pointColl[n].y = parent.img.destTop + (parent.img.destHeight * obj.pointColl[n].ratioX);\n                obj.pointColl[n].x = (parent.img.destLeft + parent.img.destWidth) - (parent.img.destWidth *\n                    obj.pointColl[n].ratioY);\n            }\n            for (var n = 0; n < obj.pointColl.length; n++) {\n                obj.pointColl[n].ratioX = (obj.pointColl[n].x - parent.img.destLeft) / parent.img.destWidth;\n                obj.pointColl[n].ratioY = (obj.pointColl[n].y - parent.img.destTop) / parent.img.destHeight;\n            }\n            var prevPoint = void 0;\n            if (isNullOrUndefined(obj.pointColl[obj.pointColl.length - 2])) {\n                prevPoint = { x: 0, y: 0 };\n            }\n            else {\n                prevPoint = { x: obj.pointColl[obj.pointColl.length - 2].x, y: obj.pointColl[obj.pointColl.length - 2].y };\n            }\n            var diffX = obj.pointColl[obj.pointColl.length - 1].x - prevPoint.x;\n            var diffY = obj.pointColl[obj.pointColl.length - 1].y - prevPoint.y;\n            obj.activePoint.startX = obj.pointColl[0].x;\n            obj.activePoint.startY = obj.pointColl[0].y;\n            obj.activePoint.endX = obj.pointColl[obj.pointColl.length - 1].x + (diffX / 2);\n            obj.activePoint.endY = obj.pointColl[obj.pointColl.length - 1].y + (diffY / 2);\n            obj = this.updateWidthHeight(obj);\n        }\n    };\n    Shape.prototype.flipLineArrowObj = function (obj, value) {\n        if (isNullOrUndefined(obj.pointColl)) {\n            return;\n        }\n        if (value.toLowerCase() === 'horizontal') {\n            this.lineArrowHorizontalFlip(obj);\n        }\n        else if (value.toLowerCase() === 'vertical') {\n            this.lineArrowVerticalFlip(obj);\n        }\n        else {\n            this.lineArrowHorizontalFlip(obj);\n            obj.shapeFlip = '';\n            this.lineArrowVerticalFlip(obj);\n        }\n        obj.activePoint.startX = obj.pointColl[0].x;\n        obj.activePoint.startY = obj.pointColl[0].y;\n        obj.activePoint.endX = obj.pointColl[obj.pointColl.length - 1].x;\n        obj.activePoint.endY = obj.pointColl[obj.pointColl.length - 1].y;\n        if (obj.activePoint.startX > obj.activePoint.endX) {\n            var temp = obj.activePoint.startX;\n            obj.activePoint.startX = obj.activePoint.endX;\n            obj.activePoint.endX = temp;\n            temp = obj.activePoint.startY;\n            obj.activePoint.startY = obj.activePoint.endY;\n            obj.activePoint.endY = temp;\n        }\n    };\n    Shape.prototype.lineArrowHorizontalFlip = function (obj) {\n        var parent = this.parent;\n        // Update flip value for point collection\n        if (obj.shapeFlip !== parent.transform.currFlipState) {\n            for (var l = 0, len = obj.pointColl.length; l < len; l++) {\n                var currPoint = obj.pointColl[l];\n                if (currPoint.x <= parent.img.destLeft + (parent.img.destWidth / 2)) {\n                    currPoint.x = (parent.img.destLeft + parent.img.destWidth) - (currPoint.x\n                        - parent.img.destLeft);\n                }\n                else if (currPoint.x >= parent.img.destLeft + (parent.img.destWidth / 2)) {\n                    currPoint.x = parent.img.destLeft + (parent.img.destLeft + parent.img.destWidth -\n                        currPoint.x);\n                }\n                currPoint.ratioX = (currPoint.x - parent.img.destLeft) / parent.img.destWidth;\n                currPoint.ratioY = (currPoint.y - parent.img.destTop) / parent.img.destHeight;\n            }\n            if (obj.shape === 'arrow') {\n                var value = obj.start;\n                obj.start = obj.end;\n                obj.end = value;\n            }\n            obj.shapeFlip = parent.transform.currFlipState;\n        }\n    };\n    Shape.prototype.lineArrowVerticalFlip = function (obj) {\n        var parent = this.parent;\n        // Update flip value for point collection\n        if (obj.shapeFlip !== parent.transform.currFlipState) {\n            for (var l = 0, len = obj.pointColl.length; l < len; l++) {\n                var currPoint = obj.pointColl[l];\n                if (currPoint.y <= parent.img.destTop + (parent.img.destHeight / 2)) {\n                    currPoint.y = (parent.img.destTop + parent.img.destHeight) -\n                        (currPoint.y - parent.img.destTop);\n                }\n                else if (currPoint.y >= parent.img.destTop + (parent.img.destHeight / 2)) {\n                    currPoint.y = parent.img.destTop + (parent.img.destTop + parent.img.destHeight -\n                        currPoint.y);\n                }\n                currPoint.ratioX = (currPoint.x - parent.img.destLeft) / parent.img.destWidth;\n                currPoint.ratioY = (currPoint.y - parent.img.destTop) / parent.img.destHeight;\n            }\n            obj.shapeFlip = parent.transform.currFlipState;\n        }\n    };\n    Shape.prototype.getRotDegOfShape = function (obj) {\n        var degree;\n        if (obj.shapeDegree === 0) {\n            degree = this.parent.transform.degree;\n        }\n        else {\n            degree = this.parent.transform.degree - obj.shapeDegree;\n        }\n        if (degree < 0) {\n            degree = 360 + degree;\n        }\n        return degree;\n    };\n    Shape.prototype.renderTextArea = function (x, y, actObj) {\n        var parent = this.parent;\n        var degree = this.getRotDegOfShape(parent.activeObj);\n        this.transformTextArea();\n        if (!isBlazor()) {\n            parent.notify('toolbar', { prop: 'destroy-qa-toolbar', onPropertyChange: false });\n        }\n        else {\n            parent.updateToolbar(parent.element, 'destroyQuickAccessToolbar');\n        }\n        if (parent.element.querySelector('#' + parent.element.id + '_duplicate')) {\n            parent.element.querySelector('#' + parent.element.id + '_duplicate').classList.add('e-disabled');\n        }\n        if (parent.element.querySelector('#' + parent.element.id + '_remove')) {\n            parent.element.querySelector('#' + parent.element.id + '_remove').classList.add('e-disabled');\n        }\n        if (parent.element.querySelector('#' + parent.element.id + '_editText')) {\n            parent.element.querySelector('#' + parent.element.id + '_editText').classList.add('e-disabled');\n        }\n        parent.textArea.style.display = 'block';\n        parent.textArea.style.left = x + 'px';\n        parent.textArea.style.top = y + 'px';\n        parent.textArea.style.fontFamily = actObj.textSettings.fontFamily;\n        parent.textArea.style.fontSize = actObj.textSettings.fontSize + 'px';\n        parent.textArea.style.color = actObj.strokeSettings.strokeColor;\n        parent.textArea.style.fontWeight = actObj.textSettings.bold ? 'bold' : 'normal';\n        parent.textArea.style.fontStyle = actObj.textSettings.italic ? 'italic' : 'normal';\n        parent.textArea.style.border = '2px solid ' + parent.themeColl[parent.theme]['primaryColor'];\n        parent.textArea.value = actObj.keyHistory;\n        parent.textArea.style.overflow = 'hidden';\n        parent.textArea.style.width = 'auto';\n        parent.textArea.style.height = 'auto';\n        parent.textArea.focus();\n        var zoomFactor = parent.transform.zoomFactor;\n        var _a = actObj.activePoint, width = _a.width, height = _a.height;\n        if (degree % 90 === 0 && degree % 180 !== 0 && degree !== 0) {\n            parent.textArea.style.width = (zoomFactor === 0 ? height : height) + 'px';\n            parent.textArea.style.height = (zoomFactor === 0 ? width : width) + 'px';\n        }\n        else {\n            parent.textArea.style.width = (zoomFactor === 0 ? width : width) + 'px';\n            parent.textArea.style.height = (zoomFactor === 0 ? height : height) + 'px';\n        }\n        this.setTextBoxWidth();\n        var obj = { flipColl: null };\n        parent.notify('transform', { prop: 'getFlipColl', onPropertyChange: false, value: { obj: obj } });\n        if (obj['flipColl'].length <= 1) {\n            this.setTextBoxHeight();\n        }\n        if (degree % 90 === 0 && degree % 180 !== 0) {\n            if (parseFloat(parent.textArea.style.left) + parseFloat(parent.textArea.style.width) > parent.img.destTop +\n                parent.img.destHeight) {\n                this.alignTextAreaIntoCanvas();\n            }\n        }\n        else {\n            if (parseFloat(parent.textArea.style.left) + parseFloat(parent.textArea.style.width) > parent.img.destLeft +\n                parent.img.destWidth) {\n                this.alignTextAreaIntoCanvas();\n            }\n        }\n        parent.notify('selection', { prop: 'clearUpperCanvas', onPropertyChange: false });\n    };\n    Shape.prototype.setTextBoxWidth = function (e) {\n        var parent = this.parent;\n        var text = this.getMaxText(true);\n        if (parent.textArea.style.display === 'block') {\n            this.updateFontStyles(true);\n        }\n        else {\n            this.updateFontStyles();\n        }\n        var textAreaWidth = (this.upperContext.measureText(text).width + (parseFloat(parent.textArea.style.fontSize) / 2));\n        var letterWidth = e ? this.upperContext.measureText(String.fromCharCode(e.which)).width : 0;\n        var actObj = extend({}, parent.activeObj, {}, true);\n        var flip = '';\n        var degree = this.getRotDegOfShape(actObj);\n        if (actObj.shapeFlip !== parent.transform.currFlipState) {\n            flip = '';\n        }\n        else {\n            flip = parent.transform.currFlipState;\n        }\n        if ((e && parseFloat(parent.textArea.style.width) < (textAreaWidth + letterWidth)) || isNullOrUndefined(e)) {\n            if (degree === 0) {\n                if (flip.toLowerCase() === 'horizontal') {\n                    if ((parseFloat(parent.textArea.style.left) - parent.img.destLeft) - textAreaWidth - letterWidth > 0) {\n                        parent.textArea.style.width = (textAreaWidth + letterWidth) + 'px';\n                    }\n                }\n                else if ((parent.img.destWidth - (parseFloat(parent.textArea.style.left) -\n                    parent.img.destLeft)) > (textAreaWidth + letterWidth)) {\n                    parent.textArea.style.width = (textAreaWidth + letterWidth) + 'px';\n                }\n            }\n            else if (degree === 90) {\n                if (flip.toLowerCase() === 'vertical') {\n                    if ((parseFloat(parent.textArea.style.top) - parent.img.destTop) - textAreaWidth - letterWidth > 0) {\n                        parent.textArea.style.width = (textAreaWidth + letterWidth) + 'px';\n                    }\n                }\n                else if ((parent.img.destHeight - (parseFloat(parent.textArea.style.top) -\n                    parent.img.destTop)) > (textAreaWidth + letterWidth)) {\n                    parent.textArea.style.width = (textAreaWidth + letterWidth) + 'px';\n                }\n            }\n            else if (degree === 180) {\n                var textAreaLeft = parseFloat(parent.textArea.style.left);\n                var destLeft = parent.img.destLeft;\n                if (flip.toLowerCase() === 'horizontal') {\n                    var remainingWidth = parent.img.destWidth - (textAreaLeft - destLeft);\n                    if (remainingWidth > textAreaWidth + letterWidth) {\n                        parent.textArea.style.width = (textAreaWidth + letterWidth) + 'px';\n                    }\n                }\n                else {\n                    var distanceToLeft = textAreaLeft - destLeft;\n                    if (distanceToLeft - textAreaWidth - letterWidth > 0) {\n                        parent.textArea.style.width = (textAreaWidth + letterWidth) + 'px';\n                    }\n                }\n            }\n            else if (degree === 270) {\n                var textAreaTop = parseFloat(parent.textArea.style.top);\n                var destTop = parent.img.destTop;\n                if (flip.toLowerCase() === 'vertical') {\n                    var remainingHeight = parent.img.destHeight - (textAreaTop - destTop);\n                    if (remainingHeight > textAreaWidth + letterWidth) {\n                        parent.textArea.style.width = (textAreaWidth + letterWidth) + 'px';\n                    }\n                }\n                else {\n                    var distanceToTop = textAreaTop - destTop;\n                    if (distanceToTop - textAreaWidth - letterWidth > 0) {\n                        parent.textArea.style.width = (textAreaWidth + letterWidth) + 'px';\n                    }\n                }\n            }\n        }\n    };\n    Shape.prototype.setTextBoxHeight = function () {\n        var parent = this.parent;\n        var textAreaTop;\n        var actObj = extend({}, parent.activeObj, {}, true);\n        var flip = '';\n        var degree = this.getRotDegOfShape(actObj);\n        if (actObj.textFlip === parent.transform.currFlipState) {\n            flip = '';\n        }\n        else if (actObj.textFlip === '') {\n            flip = parent.transform.currFlipState;\n        }\n        else {\n            flip = actObj.textFlip;\n        }\n        switch (degree) {\n            case 0:\n                if (flip.toLowerCase() === 'vertical') {\n                    parent.textArea.style.maxHeight = (parent.img.destHeight - (parent.img.destHeight -\n                        parseFloat(parent.textArea.style.top))) + 'px';\n                }\n                else {\n                    textAreaTop = parseFloat(parent.textArea.style.top) - parent.img.destTop;\n                    parent.textArea.style.maxHeight = (parent.img.destHeight - textAreaTop) + 'px';\n                }\n                break;\n            case 90:\n                if (flip.toLowerCase() === 'horizontal') {\n                    parent.textArea.style.maxHeight = (parent.img.destWidth - (parseFloat(parent.textArea.style.left) -\n                        parent.img.destLeft)) + 'px';\n                }\n                else {\n                    parent.textArea.style.maxHeight = (parseFloat(parent.textArea.style.left) - parent.img.destLeft) + 'px';\n                }\n                break;\n            case 180:\n                if (flip.toLowerCase() === 'vertical') {\n                    textAreaTop = parseFloat(parent.textArea.style.top) - parent.img.destTop;\n                    parent.textArea.style.maxHeight = (parent.img.destHeight - textAreaTop) + 'px';\n                }\n                else {\n                    parent.textArea.style.maxHeight = (parseFloat(parent.textArea.style.top) - parent.img.destTop) + 'px';\n                }\n                break;\n            case 270:\n                if (flip.toLowerCase() === 'horizontal') {\n                    parent.textArea.style.maxHeight = (parseFloat(parent.textArea.style.left) - parent.img.destLeft) + 'px';\n                }\n                else {\n                    parent.textArea.style.maxHeight = parent.img.destWidth - (parseFloat(parent.textArea.style.left)\n                        - parent.img.destLeft) + 'px';\n                }\n                break;\n        }\n    };\n    Shape.prototype.updatePathRatio = function (obj) {\n        var parent = this.parent;\n        for (var i = 0, len = obj.pointColl.length; i < len; i++) {\n            var currPoint = obj.pointColl[i];\n            currPoint.ratioX = (currPoint.x - parent.img.destLeft) / parent.img.destWidth;\n            currPoint.ratioY = (currPoint.y - parent.img.destTop) / parent.img.destHeight;\n        }\n    };\n    Shape.prototype.stopPathDrawing = function (e) {\n        var parent = this.parent;\n        if (parent.activeObj.shape === 'path') {\n            var obj = { shape: null };\n            parent.notify('selection', { prop: 'getCurrentDrawingShape', value: { obj: obj } });\n            if (obj['shape'] === 'path') {\n                var prevCropObj = extend({}, this.parent.cropObj, {}, true);\n                var object = { currObj: {} };\n                this.parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n                var prevObj = object['currObj'];\n                prevObj.objColl = extend([], this.parent.objColl, [], true);\n                prevObj.pointColl = extend([], this.parent.pointColl, [], true);\n                prevObj.afterCropActions = extend([], this.parent.afterCropActions, [], true);\n                var selPointCollObj = { selPointColl: null };\n                this.parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                    value: { obj: selPointCollObj } });\n                prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n                parent.notify('selection', { prop: 'setCurrentDrawingShape', value: { value: '' } });\n                parent.currObjType.isDragging = false;\n                if (e.type !== 'touchstart') {\n                    parent.activeObj.pointColl.pop();\n                }\n                this.updatePathRatio(parent.activeObj);\n                parent.objColl.push(parent.activeObj);\n                parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                    value: { operation: 'shapeTransform', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                        previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                        previousCropObj: prevCropObj, previousText: null,\n                        currentText: null, previousFilter: null, isCircleCrop: null } });\n                parent.objColl.pop();\n                parent.notify('selection', { prop: 'mouseUpEventHandler', value: { e: e } });\n                parent.notify('draw', { prop: 'setNewPath', value: { bool: true } });\n                if (parent.objColl[parent.objColl.length - 1]) {\n                    parent.selectShape(parent.objColl[parent.objColl.length - 1].currIndex);\n                }\n                if (!isBlazor()) {\n                    parent.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: null } });\n                }\n                else {\n                    parent.updateToolbar(parent.element, 'quickAccessToolbar', parent.activeObj.shape);\n                }\n            }\n        }\n    };\n    Shape.prototype.findTextTarget = function (e) {\n        var parent = this.parent;\n        if (parent.activeObj.shape !== 'text') {\n            this.stopPathDrawing(e);\n            return;\n        }\n        var x;\n        var y;\n        if (e.type === 'dblclick') {\n            x = e.clientX;\n            y = e.clientY;\n        }\n        else if (e.type === 'touchstart') {\n            x = e.touches[0].clientX;\n            y = e.touches[0].clientY;\n            parent.notify('selection', { prop: 'setTouchEndPoint', onPropertyChange: false,\n                value: { x: e.touches[0].clientX, y: e.touches[0].clientY } });\n        }\n        parent.notify('toolbar', { prop: 'setPreventZoomBtn', onPropertyChange: false, value: { isPrevent: true } });\n        parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'text',\n                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n        parent.notify('toolbar', { prop: 'setPreventZoomBtn', onPropertyChange: false, value: { isPrevent: false } });\n        parent.notify('toolbar', { prop: 'update-toolbar-items', onPropertyChange: false });\n        if (!isNullOrUndefined(x) && !isNullOrUndefined(y)) {\n            var bbox = this.parent.lowerCanvas.getBoundingClientRect();\n            x -= bbox.left;\n            y -= bbox.top;\n            var flip = '';\n            var degree = this.getRotDegOfShape(parent.activeObj);\n            if (parent.activeObj.textFlip === '') {\n                if (parent.activeObj.textFlip === parent.transform.currFlipState) {\n                    flip = '';\n                }\n                else {\n                    flip = parent.transform.currFlipState;\n                }\n            }\n            else {\n                if (parent.activeObj.textFlip === parent.transform.currFlipState) {\n                    flip = '';\n                }\n                else if (parent.transform.currFlipState === '') {\n                    flip = parent.activeObj.textFlip;\n                }\n                else {\n                    flip = parent.transform.currFlipState;\n                }\n            }\n            var temp = void 0;\n            if (parent.textArea.style.display === 'none') {\n                temp = extend({}, parent.activeObj, {}, true);\n                for (var i = 0; i < parent.objColl.length; i++) {\n                    if (JSON.stringify(parent.activeObj) === JSON.stringify(parent.objColl[i])) {\n                        parent.objColl.splice(i, 1);\n                    }\n                }\n                this.refreshActiveObj();\n                this.upperContext.clearRect(0, 0, this.parent.upperCanvas.width, this.parent.upperCanvas.height);\n                this.lowerContext.clearRect(0, 0, this.parent.upperCanvas.width, this.parent.upperCanvas.height);\n                parent.notify('draw', { prop: 'redrawImgWithObj', onPropertyChange: false });\n                if ((parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle') || parent.isCircleCrop) {\n                    parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                        value: { context: this.lowerContext, isSave: null, isFlip: null } });\n                }\n                parent.activeObj = temp;\n                this.updateFontStyles();\n                var actObj = extend({}, parent.activeObj, {}, true);\n                if (x >= (actObj.activePoint.startX - (actObj.topLeftCircle.radius * 2)) &&\n                    x <= (actObj.activePoint.endX + (actObj.topLeftCircle.radius * 2)) &&\n                    y >= (actObj.activePoint.startY - (actObj.topLeftCircle.radius * 2)) &&\n                    y <= (actObj.activePoint.endY + (actObj.topLeftCircle.radius * 2))) {\n                    this.upperContext.clearRect(0, 0, this.parent.upperCanvas.width, this.parent.upperCanvas.height);\n                    if (actObj.flipObjColl.length === 4) {\n                        actObj.flipObjColl = [];\n                        flip = '';\n                        actObj.shapeFlip = '';\n                    }\n                    if (flip === '' && actObj.flipObjColl.length > 1) {\n                        flip = actObj.flipObjColl[actObj.flipObjColl.length - 1];\n                    }\n                    if (actObj.flipObjColl.length <= 1) {\n                        var points = this.setTextBoxPos(actObj, degree, flip, x, y);\n                        x = points.x;\n                        y = points.y;\n                    }\n                    else {\n                        var points = this.setTextBoxPoints(actObj, degree, flip, x, y);\n                        x = points.x;\n                        y = points.y;\n                    }\n                    if (parent.activeObj.rotatedAngle !== 0) {\n                        x = parent.activeObj.horTopLinePointColl[0].x;\n                        y = parent.activeObj.horTopLinePointColl[0].y;\n                    }\n                    this.renderTextArea(x, y, actObj);\n                }\n                else {\n                    this.applyActObj();\n                }\n            }\n        }\n        else if (parent.textArea.style.display === 'block' && this.selectedText() !== '' && e.type === 'mousedown') {\n            var temp = parent.textArea.value;\n            parent.textArea.value += 'a';\n            parent.textArea.value = temp;\n        }\n        else if (parent.textArea.style.display === 'none') {\n            parent.textArea.style.display = 'block';\n        }\n    };\n    Shape.prototype.setTextBoxPos = function (actObj, degree, flip, x, y) {\n        var point = { x: x, y: y };\n        switch (degree) {\n            case 0:\n                if (flip.toLowerCase() === 'horizontal') {\n                    point.x = actObj.activePoint.endX;\n                    point.y = actObj.activePoint.startY;\n                }\n                else if (flip.toLowerCase() === 'vertical') {\n                    point.x = actObj.activePoint.startX;\n                    point.y = actObj.activePoint.endY;\n                }\n                else {\n                    point.x = actObj.activePoint.startX;\n                    point.y = actObj.activePoint.startY;\n                }\n                break;\n            case 90:\n                if (flip.toLowerCase() === 'horizontal') {\n                    point.x = actObj.activePoint.startX;\n                    point.y = actObj.activePoint.startY;\n                }\n                else if (flip.toLowerCase() === 'vertical') {\n                    point.x = actObj.activePoint.endX;\n                    point.y = actObj.activePoint.endY;\n                }\n                else {\n                    point.x = actObj.activePoint.endX;\n                    point.y = actObj.activePoint.startY;\n                }\n                break;\n            case 180:\n                if (flip.toLowerCase() === 'horizontal') {\n                    point.x = actObj.activePoint.startX;\n                    point.y = actObj.activePoint.endY;\n                }\n                else if (flip.toLowerCase() === 'vertical') {\n                    point.x = actObj.activePoint.endX;\n                    point.y = actObj.activePoint.startY;\n                }\n                else {\n                    point.x = actObj.activePoint.endX;\n                    point.y = actObj.activePoint.endY;\n                }\n                break;\n            case 270:\n                if (flip.toLowerCase() === 'horizontal') {\n                    point.x = actObj.activePoint.endX;\n                    point.y = actObj.activePoint.endY;\n                }\n                else if (flip.toLowerCase() === 'vertical') {\n                    point.x = actObj.activePoint.startX;\n                    point.y = actObj.activePoint.startY;\n                }\n                else {\n                    point.x = actObj.activePoint.startX;\n                    point.y = actObj.activePoint.endY;\n                }\n                break;\n        }\n        return point;\n    };\n    Shape.prototype.setTextBoxPoints = function (actObj, degree, flip, x, y) {\n        var point = { x: x, y: y };\n        switch (degree) {\n            case 0:\n                if (actObj.flipObjColl[0] && actObj.flipObjColl[0].toLowerCase() === 'horizontal') {\n                    if (flip.toLowerCase() === 'horizontal') {\n                        point.x = (actObj.activePoint.startX);\n                        point.y = (actObj.activePoint.startY);\n                    }\n                    else if (flip.toLowerCase() === 'vertical') {\n                        point.x = (actObj.activePoint.endX);\n                        point.y = (actObj.activePoint.endY);\n                    }\n                }\n                else {\n                    if (flip.toLowerCase() === 'horizontal') {\n                        point.x = (actObj.activePoint.endX);\n                        point.y = (actObj.activePoint.endY);\n                    }\n                    else if (flip.toLowerCase() === 'vertical') {\n                        point.x = (actObj.activePoint.endX);\n                        point.y = (actObj.activePoint.startY);\n                    }\n                }\n                break;\n            case 90:\n                if (actObj.flipObjColl[0] && actObj.flipObjColl[0].toLowerCase() === 'horizontal') {\n                    if (flip.toLowerCase() === 'horizontal') {\n                        point.x = (actObj.activePoint.endX);\n                        point.y = (actObj.activePoint.endY);\n                    }\n                    else if (flip.toLowerCase() === 'vertical') {\n                        point.x = (actObj.activePoint.startX);\n                        point.y = (actObj.activePoint.endY);\n                    }\n                }\n                else {\n                    if (flip.toLowerCase() === 'horizontal') {\n                        point.x = (actObj.activePoint.startX);\n                        point.y = (actObj.activePoint.endY);\n                    }\n                    else if (flip.toLowerCase() === 'vertical') {\n                        point.x = (actObj.activePoint.startX);\n                        point.y = (actObj.activePoint.startY);\n                    }\n                }\n                break;\n            case 180:\n                if (actObj.flipObjColl[0] && actObj.flipObjColl[0].toLowerCase() === 'horizontal') {\n                    if (flip.toLowerCase() === 'horizontal') {\n                        point.x = (actObj.activePoint.startX);\n                        point.y = (actObj.activePoint.startY);\n                    }\n                    else if (flip.toLowerCase() === 'vertical') {\n                        point.x = (actObj.activePoint.startX);\n                        point.y = (actObj.activePoint.startY);\n                    }\n                }\n                else {\n                    if (flip.toLowerCase() === 'horizontal') {\n                        point.x = (actObj.activePoint.startX);\n                        point.y = (actObj.activePoint.startY);\n                    }\n                    else if (flip.toLowerCase() === 'vertical') {\n                        point.x = (actObj.activePoint.startX);\n                        point.y = (actObj.activePoint.endY);\n                    }\n                }\n                break;\n            case 270:\n                if (actObj.flipObjColl[0] && actObj.flipObjColl[0].toLowerCase() === 'horizontal') {\n                    if (flip.toLowerCase() === 'horizontal') {\n                        point.x = (actObj.activePoint.startX);\n                        point.y = (actObj.activePoint.startY);\n                    }\n                    else if (flip.toLowerCase() === 'vertical') {\n                        point.x = (actObj.activePoint.endX);\n                        point.y = (actObj.activePoint.startY);\n                    }\n                }\n                else {\n                    if (flip.toLowerCase() === 'horizontal') {\n                        point.x = (actObj.activePoint.endX);\n                        point.y = (actObj.activePoint.startY);\n                    }\n                    else if (flip.toLowerCase() === 'vertical') {\n                        point.x = (actObj.activePoint.endX);\n                        point.y = (actObj.activePoint.endY);\n                    }\n                }\n                break;\n        }\n        return point;\n    };\n    Shape.prototype.selectedText = function () {\n        var start = this.parent.textArea.selectionStart;\n        var finish = this.parent.textArea.selectionEnd;\n        return this.parent.textArea.value.substring(start, finish);\n    };\n    Shape.prototype.panObjColl = function (xDiff, yDiff, panRegion) {\n        var parent = this.parent;\n        for (var i = 0, len = parent.objColl.length; i < len; i++) {\n            var currObj = parent.objColl[i];\n            if (panRegion === '' || panRegion === 'vertical') {\n                currObj.activePoint.startX += xDiff;\n                currObj.activePoint.endX += xDiff;\n                if (currObj.rotationCirclePointColl) {\n                    currObj.rotationCirclePointColl.x += xDiff;\n                }\n                if (currObj.shape === 'path') {\n                    for (var l = 0, len_3 = currObj.pointColl.length; l < len_3; l++) {\n                        currObj.pointColl[l].x += xDiff;\n                    }\n                }\n            }\n            else {\n                currObj.activePoint.startX -= xDiff;\n                currObj.activePoint.endX -= xDiff;\n                if (currObj.rotationCirclePointColl) {\n                    currObj.rotationCirclePointColl.x -= xDiff;\n                }\n                if (currObj.shape === 'path') {\n                    for (var l = 0, len_4 = currObj.pointColl.length; l < len_4; l++) {\n                        currObj.pointColl[l].x -= xDiff;\n                    }\n                }\n            }\n            if (panRegion === '' || panRegion === 'horizontal') {\n                currObj.activePoint.startY += yDiff;\n                currObj.activePoint.endY += yDiff;\n                if (currObj.rotationCirclePointColl) {\n                    currObj.rotationCirclePointColl.y += yDiff;\n                }\n                if (currObj.shape === 'path') {\n                    for (var l = 0; l < currObj.pointColl.length; l++) {\n                        currObj.pointColl[l].y += yDiff;\n                    }\n                }\n            }\n            else {\n                currObj.activePoint.startY -= yDiff;\n                currObj.activePoint.endY -= yDiff;\n                if (currObj.rotationCirclePointColl) {\n                    currObj.rotationCirclePointColl.y -= yDiff;\n                }\n                if (currObj.shape === 'path') {\n                    for (var l = 0; l < currObj.pointColl.length; l++) {\n                        currObj.pointColl[l].y -= yDiff;\n                    }\n                }\n            }\n            currObj = this.updateWidthHeight(currObj);\n            parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: currObj.activePoint,\n                    obj: currObj } });\n            if (currObj.shape === 'line' || currObj.shape === 'arrow') {\n                currObj.pointColl = this.getLinePoints(currObj.activePoint.startX, currObj.activePoint.startY, currObj.activePoint.endX, currObj.activePoint.endY);\n                for (var j = 0, len_5 = currObj.pointColl.length; j < len_5; j++) {\n                    currObj.pointColl[j].ratioX =\n                        (currObj.pointColl[j].x - parent.img.destLeft) / parent.img.destWidth;\n                    currObj.pointColl[j].ratioY =\n                        (currObj.pointColl[j].y - parent.img.destTop) / parent.img.destHeight;\n                }\n            }\n            var temp = this.lowerContext.filter;\n            this.lowerContext.filter = 'none';\n            this.apply(currObj.shape, currObj);\n            this.lowerContext.filter = temp;\n            this.refreshActiveObj();\n        }\n    };\n    Shape.prototype.updateFontStyles = function (isTextBox) {\n        var parent = this.parent;\n        this.upperContext.strokeStyle = parent.activeObj.strokeSettings.strokeColor;\n        this.upperContext.fillStyle = parent.activeObj.strokeSettings.strokeColor;\n        var textStyle = '';\n        if (parent.activeObj.textSettings.bold) {\n            textStyle = 'bold ';\n        }\n        if (parent.activeObj.textSettings.italic) {\n            textStyle = 'italic ';\n        }\n        if (parent.activeObj.textSettings.bold && parent.activeObj.textSettings.italic) {\n            textStyle = 'italic bold ';\n        }\n        var fontSize = isTextBox ? parseFloat(parent.textArea.style.fontSize) : parent.activeObj.textSettings.fontSize;\n        var fontFamily = parent.textArea.style.display === 'block' ? parent.textArea.style.fontFamily : parent.activeObj.textSettings.fontFamily;\n        this.upperContext.font = textStyle + fontSize + 'px' + ' ' + fontFamily;\n    };\n    Shape.prototype.applyFontStyle = function (item) {\n        var parent = this.parent;\n        this.pushActItemIntoObj();\n        var objColl = extend([], parent.objColl, [], true);\n        parent.objColl.pop();\n        if (parent.textArea.style.display === 'none') {\n            this.updateFontRatio(parent.activeObj);\n        }\n        else {\n            this.updateFontRatio(parent.activeObj, true);\n        }\n        switch (item) {\n            case 'default':\n                this.updateFontStyle(item, objColl, 'normal', 'normal');\n                break;\n            case 'bold':\n                this.updateFontStyle(item, objColl, 'bold', 'normal');\n                break;\n            case 'italic':\n                this.updateFontStyle(item, objColl, 'normal', 'italic');\n                break;\n            case 'bolditalic':\n                this.updateFontStyle(item, objColl, 'bold', 'italic');\n                break;\n        }\n    };\n    Shape.prototype.updateFontStyle = function (item, objColl, fontWeight, fontStyle) {\n        var parent = this.parent;\n        if (parent.textArea.style.display === 'block') {\n            var width = this.getTextAreaWidth(item);\n            parent.textArea.style.width = width + 'px';\n            parent.textArea.style.fontWeight = fontWeight;\n            parent.textArea.style.fontStyle = fontStyle;\n            this.updateObjColl(item, objColl);\n        }\n        else {\n            this.textSettings.bold = parent.activeObj.textSettings.bold = fontWeight === 'normal' ? false : true;\n            this.textSettings.italic = parent.activeObj.textSettings.italic = fontStyle === 'normal' ? false : true;\n            this.redrawText();\n            parent.notify('undo-redo', { prop: 'updateUrObj', onPropertyChange: false, value: { objColl: objColl } });\n        }\n    };\n    Shape.prototype.updateArrowRatio = function (obj) {\n        var parent = this.parent;\n        var object = { arrowDimension: null };\n        parent.notify('draw', { prop: 'getArrowDimension', onPropertyChange: false, value: { obj: object } });\n        var length;\n        if (Math.abs(obj.activePoint.width) > Math.abs(obj.activePoint.height)) {\n            length = Math.abs(obj.activePoint.width);\n        }\n        else {\n            length = Math.abs(obj.activePoint.height);\n        }\n        var dimension;\n        var dimensions = ['bar', 'arrow', 'arrowSolid', 'circle', 'square'];\n        for (var _i = 0, dimensions_1 = dimensions; _i < dimensions_1.length; _i++) {\n            dimension = dimensions_1[_i];\n            var ratioX = length / object['arrowDimension'][dimension]['width'];\n            var ratioY = length / object['arrowDimension'][dimension]['height'];\n            object['arrowDimension'][dimension]['ratioX'] = ratioX;\n            object['arrowDimension'][dimension]['ratioY'] = ratioY;\n        }\n    };\n    Shape.prototype.updateArrowSize = function (obj) {\n        var object = { arrowDimension: null };\n        this.parent.notify('draw', { prop: 'getArrowDimension', onPropertyChange: false, value: { obj: object } });\n        var length;\n        if (Math.abs(obj.activePoint.width) > Math.abs(obj.activePoint.height)) {\n            length = Math.abs(obj.activePoint.width);\n        }\n        else {\n            length = Math.abs(obj.activePoint.height);\n        }\n        var dimension;\n        var dimensions = ['bar', 'arrow', 'arrowSolid', 'circle', 'square'];\n        for (var _i = 0, dimensions_2 = dimensions; _i < dimensions_2.length; _i++) {\n            dimension = dimensions_2[_i];\n            var ratioX = object['arrowDimension'][dimension]['ratioX'];\n            var ratioY = object['arrowDimension'][dimension]['ratioY'];\n            object['arrowDimension'][dimension]['width'] = length / ratioX;\n            object['arrowDimension'][dimension]['height'] = length / ratioY;\n        }\n    };\n    Shape.prototype.updateFontRatio = function (obj, isTextArea) {\n        var parent = this.parent;\n        var text = this.getMaxText(isTextArea);\n        var width = this.upperContext.measureText(text).width +\n            parent.activeObj.textSettings.fontSize * 0.5;\n        var height = (parent.activeObj.textSettings.fontSize + parent.activeObj.textSettings.fontSize * 0.25);\n        var degree = this.getRotDegOfShape(obj);\n        if (isNullOrUndefined(isTextArea)) {\n            if (degree === 0 || Math.abs(degree) === 180) {\n                obj.textSettings.fontRatio = width / obj.textSettings.fontSize;\n            }\n            else {\n                obj.textSettings.fontRatio = height / obj.textSettings.fontSize;\n            }\n        }\n        else if (isTextArea) {\n            obj.textSettings.fontRatio = width / parseFloat(parent.textArea.style.fontSize);\n        }\n    };\n    Shape.prototype.updateFontSize = function (obj) {\n        var degree = this.getRotDegOfShape(obj);\n        if (degree === 0 || Math.abs(degree) === 180) {\n            obj.textSettings.fontSize = (obj.activePoint.width / obj.textSettings.fontRatio);\n        }\n        else {\n            obj.textSettings.fontSize = (obj.activePoint.height / obj.textSettings.fontRatio);\n        }\n    };\n    Shape.prototype.updateObjColl = function (item, objColl) {\n        var parent = this.parent;\n        var prevCropObj = extend({}, parent.cropObj, {}, true);\n        var object = { currObj: {} };\n        parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var prevObj = object['currObj'];\n        prevObj.objColl = objColl;\n        prevObj.pointColl = extend([], parent.pointColl, [], true);\n        prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        var tempBold = parent.activeObj.textSettings.bold;\n        var tempItalic = parent.activeObj.textSettings.italic;\n        switch (item) {\n            case 'default':\n                parent.activeObj.textSettings.bold = false;\n                parent.activeObj.textSettings.italic = false;\n                break;\n            case 'bold':\n                parent.activeObj.textSettings.bold = true;\n                parent.activeObj.textSettings.italic = false;\n                break;\n            case 'italic':\n                parent.activeObj.textSettings.bold = false;\n                parent.activeObj.textSettings.italic = true;\n                break;\n            case 'bolditalic':\n                parent.activeObj.textSettings.bold = true;\n                parent.activeObj.textSettings.italic = true;\n                break;\n        }\n        parent.objColl.push(parent.activeObj);\n        parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n            value: { operation: 'textAreaCustomization', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                previousCropObj: prevCropObj, previousText: null,\n                currentText: null, previousFilter: null, isCircleCrop: null } });\n        parent.objColl.pop();\n        parent.activeObj.textSettings.bold = tempBold;\n        parent.activeObj.textSettings.italic = tempItalic;\n    };\n    Shape.prototype.pushActItemIntoObj = function () {\n        if (this.parent.textArea.style.display === 'none') {\n            this.parent.objColl.push(this.parent.activeObj);\n        }\n        else {\n            var temp = extend({}, this.parent.activeObj, {}, true);\n            this.parent.notify('selection', { prop: 'setTextBoxStylesToActObj', onPropertyChange: false });\n            this.parent.objColl.push(this.parent.activeObj);\n            this.parent.activeObj = temp;\n        }\n    };\n    Shape.prototype.clearActObj = function () {\n        if (this.parent.textArea.style.display === 'none') {\n            this.refreshActiveObj();\n            this.applyActObj();\n            this.refreshActiveObj();\n            this.parent.currObjType.isCustomCrop = false;\n        }\n    };\n    Shape.prototype.refreshActiveObj = function () {\n        this.parent.activeObj = {};\n        this.parent.activeObj.activePoint = { startX: 0, startY: 0, endX: 0, endY: 0, width: 0, height: 0 };\n        this.parent.activeObj.triangle = [];\n        this.parent.activeObj.triangleRatio = [];\n        this.parent.activeObj.flipObjColl = [];\n        this.parent.activeObj.strokeSettings = this.strokeSettings;\n        this.parent.activeObj.textSettings = this.textSettings;\n        this.parent.activeObj.rotatedAngle = 0;\n    };\n    Shape.prototype.applyActObj = function (isMouseDown) {\n        var isActObj = false;\n        if (this.parent.activeObj.shape !== undefined && this.parent.activeObj.shape === 'text' && this.parent.activeObj.keyHistory === '') {\n            this.refreshActiveObj();\n            this.upperContext.clearRect(0, 0, this.parent.upperCanvas.width, this.parent.upperCanvas.height);\n        }\n        else {\n            var splitWords = void 0;\n            var isCropSelection = false;\n            if (this.parent.activeObj.shape !== undefined) {\n                splitWords = this.parent.activeObj.shape.split('-');\n            }\n            if (splitWords === undefined && this.parent.currObjType.isCustomCrop) {\n                isCropSelection = true;\n            }\n            else if (splitWords !== undefined && splitWords[0] === 'crop') {\n                isCropSelection = true;\n            }\n            if (this.parent.activeObj.shape && !isCropSelection && this.parent.activeObj.shape !== 'shape') {\n                for (var i = 0; i < this.parent.objColl.length; i++) {\n                    if (JSON.stringify(this.parent.activeObj) === JSON.stringify(this.parent.objColl[i])) {\n                        isActObj = true;\n                        break;\n                    }\n                }\n                if (!isActObj) {\n                    if (isNullOrUndefined(this.parent.activeObj.currIndex)) {\n                        this.parent.activeObj.currIndex = 'shape_' + (this.parent.objColl.length + 1);\n                    }\n                    this.updImgRatioForActObj();\n                    var splitWords_1 = this.parent.activeObj.currIndex.split('_');\n                    var tempObjColl = this.parent.objColl.splice(0, parseInt(splitWords_1[1], 10) - 1);\n                    tempObjColl.push(extend({}, this.parent.activeObj, {}, true));\n                    for (var i = 0; i < this.parent.objColl.length; i++) {\n                        tempObjColl.push(this.parent.objColl[i]);\n                    }\n                    this.parent.objColl = tempObjColl;\n                    tempObjColl = [];\n                    this.refreshActiveObj();\n                    this.lowerContext.clearRect(0, 0, this.parent.lowerCanvas.width, this.parent.lowerCanvas.height);\n                    this.parent.notify('draw', { prop: 'redrawImgWithObj', onPropertyChange: false });\n                    this.parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n                    this.parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.upperContext } });\n                    this.parent.currObjType.shape = '';\n                    this.refreshActiveObj();\n                    if (this.parent.isCircleCrop) {\n                        this.parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                            value: { context: this.lowerContext, isSave: null, isFlip: null } });\n                    }\n                    if (!isBlazor()) {\n                        this.parent.notify('toolbar', { prop: 'destroy-qa-toolbar', onPropertyChange: false });\n                    }\n                    else {\n                        this.parent.updateToolbar(this.parent.element, 'destroyQuickAccessToolbar');\n                    }\n                    if (isNullOrUndefined(isMouseDown)) {\n                        this.parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n                        this.parent.notify('draw', { prop: 'setPrevActObj', onPropertyChange: false, value: { prevActObj: null } });\n                    }\n                }\n            }\n        }\n    };\n    Shape.prototype.alignTextAreaIntoCanvas = function () {\n        var parent = this.parent;\n        var letters = parent.textArea.value;\n        parent.textArea.value = '';\n        for (var i = 0, len = letters.length; i < len; i++) {\n            parent.textArea.value += letters[i];\n            parent.textArea.style.height = 'auto';\n            parent.textArea.style.height = parent.textArea.scrollHeight + 'px';\n            this.setTextBoxWidth();\n        }\n    };\n    Shape.prototype.transformTextArea = function () {\n        var parent = this.parent;\n        if (parent.activeObj.shape === 'text') {\n            parent.textArea.style.transformOrigin = '0 0';\n            var rotatedDegree = parent.activeObj.rotatedAngle * (180 / Math.PI);\n            var scale = '';\n            var degree = this.getRotDegOfShape(parent.activeObj);\n            if (parent.activeObj.flipObjColl.length > 0) {\n                // need to add scale value according to length.\n                for (var i = 0; i < parent.activeObj.flipObjColl.length; i++) {\n                    if (degree !== 0 && degree % 90 === 0 && degree !== 180) {\n                        scale += parent.activeObj.flipObjColl[i].toLowerCase() === 'horizontal' ? 'scale(1, -1)' :\n                            'scale(-1, 1)';\n                    }\n                    else {\n                        scale += parent.activeObj.flipObjColl[i].toLowerCase() === 'horizontal' ? 'scale(-1, 1)' :\n                            'scale(1, -1)';\n                    }\n                    degree += rotatedDegree;\n                    if (parent.activeObj.flipObjColl[i].toLowerCase() === 'horizontal') {\n                        parent.textArea.style.transform = 'rotate(' + degree + 'deg)' + scale;\n                    }\n                    else if (parent.activeObj.flipObjColl[i].toLowerCase() === 'vertical') {\n                        parent.textArea.style.transform = 'rotate(' + degree + 'deg)' + scale;\n                    }\n                }\n            }\n            else {\n                degree += rotatedDegree;\n                parent.textArea.style.transform = 'rotate(' + degree + 'deg)';\n            }\n        }\n    };\n    Shape.prototype.getTextAreaWidth = function (item) {\n        var parent = this.parent;\n        var tempBold = parent.activeObj.textSettings.bold;\n        var tempItalic = parent.activeObj.textSettings.italic;\n        switch (item) {\n            case 'default':\n                parent.activeObj.textSettings.bold = false;\n                parent.activeObj.textSettings.italic = false;\n                break;\n            case 'bold':\n                parent.activeObj.textSettings.bold = true;\n                parent.activeObj.textSettings.italic = false;\n                break;\n            case 'italic':\n                parent.activeObj.textSettings.bold = false;\n                parent.activeObj.textSettings.italic = true;\n                break;\n            case 'bolditalic':\n                parent.activeObj.textSettings.bold = true;\n                parent.activeObj.textSettings.italic = true;\n                break;\n        }\n        this.updateFontStyles();\n        var width;\n        if (parent.textArea.style.display === 'none') {\n            width = this.upperContext.measureText(parent.activeObj.keyHistory).width +\n                parent.activeObj.textSettings.fontSize * 0.5;\n        }\n        else {\n            width = this.upperContext.measureText(parent.textArea.value).width +\n                parent.activeObj.textSettings.fontSize * 0.5;\n        }\n        parent.activeObj.textSettings.bold = tempBold;\n        parent.activeObj.textSettings.italic = tempItalic;\n        return width;\n    };\n    Shape.prototype.getObjDetails = function (obj) {\n        var parent = this.parent;\n        var shapeDetails = {};\n        shapeDetails.id = obj.currIndex;\n        shapeDetails.type = parent.toPascalCase(obj.shape);\n        shapeDetails.startX = obj.activePoint.startX;\n        shapeDetails.startY = obj.activePoint.startY;\n        switch (obj.shape) {\n            case 'rectangle':\n                shapeDetails.width = obj.activePoint.width;\n                shapeDetails.height = obj.activePoint.height;\n                shapeDetails.strokeColor = obj.strokeSettings.strokeColor;\n                shapeDetails.fillColor = obj.strokeSettings.fillColor;\n                shapeDetails.strokeWidth = obj.strokeSettings.strokeWidth;\n                break;\n            case 'ellipse':\n                shapeDetails.radius = obj.activePoint.width / 2;\n                shapeDetails.strokeColor = obj.strokeSettings.strokeColor;\n                shapeDetails.fillColor = obj.strokeSettings.fillColor;\n                shapeDetails.strokeWidth = obj.strokeSettings.strokeWidth;\n                break;\n            case 'line':\n            case 'arrow':\n                shapeDetails.length = obj.activePoint.width;\n                shapeDetails.strokeColor = obj.strokeSettings.strokeColor;\n                shapeDetails.strokeWidth = obj.strokeSettings.strokeWidth;\n                break;\n            case 'text':\n                shapeDetails.text = obj.keyHistory;\n                shapeDetails.fontSize = obj.textSettings.fontSize;\n                shapeDetails.color = obj.strokeSettings.strokeColor;\n                shapeDetails.fontStyle = [];\n                if (obj.textSettings.bold) {\n                    shapeDetails.fontStyle.push('bold');\n                }\n                if (obj.textSettings.italic) {\n                    shapeDetails.fontStyle.push('italic');\n                }\n                break;\n            case 'path':\n                shapeDetails.strokeColor = obj.strokeSettings.strokeColor;\n                shapeDetails.strokeWidth = obj.strokeSettings.strokeWidth;\n                break;\n        }\n        return shapeDetails;\n    };\n    Shape.prototype.getFreehandDrawDetails = function (index) {\n        var parent = this.parent;\n        var shapeDetails = {};\n        shapeDetails.id = parent.pointColl[index].id;\n        shapeDetails.type = ShapeType.FreehandDraw;\n        shapeDetails.points = extend([], parent.pointColl[index].points);\n        shapeDetails.strokeColor = parent.pointColl[index].strokeColor;\n        shapeDetails.strokeWidth = parent.pointColl[index].strokeWidth;\n        return shapeDetails;\n    };\n    Shape.prototype.getShapeSetting = function (id, obj) {\n        var parent = this.parent;\n        var shapeDetails;\n        if (!parent.disabled && parent.isImageLoaded) {\n            this.applyActObj();\n            if (id.split('_')[0] === 'shape') {\n                var obj_1;\n                for (var i = 0, len = parent.objColl.length; i < len; i++) {\n                    if (parent.objColl[i].currIndex === id) {\n                        obj_1 = extend({}, parent.objColl[i], {}, true);\n                        break;\n                    }\n                }\n                shapeDetails = this.getObjDetails(obj_1);\n            }\n            else if (id.split('_')[0] === 'pen') {\n                shapeDetails = this.getFreehandDrawDetails(parseInt(id.split('_')[1], 10) - 1);\n            }\n        }\n        obj['shapeDetails'] = shapeDetails;\n    };\n    Shape.prototype.getShapeSettings = function (obj) {\n        var parent = this.parent;\n        var shapeDetailsColl = [];\n        if (!parent.disabled && parent.isImageLoaded) {\n            this.applyActObj();\n            for (var i = 0, len = parent.objColl.length; i < len; i++) {\n                var shapeDetails = this.getObjDetails(parent.objColl[i]);\n                shapeDetailsColl.push(shapeDetails);\n            }\n            for (var i = 0; i < parent.freehandCounter; i++) {\n                var shapeDetails = this.getFreehandDrawDetails(i);\n                shapeDetailsColl.push(shapeDetails);\n            }\n        }\n        obj['shapeDetailsColl'] = shapeDetailsColl;\n    };\n    Shape.prototype.isPointsInRange = function (x, y, obj) {\n        var inRange = false;\n        if (!isNullOrUndefined(x) && !isNullOrUndefined(y) && x >= this.parent.img.destLeft && y >= this.parent.img.destTop &&\n            x <= this.parent.img.destLeft + this.parent.img.destWidth && y <= this.parent.img.destTop + this.parent.img.destHeight) {\n            inRange = true;\n        }\n        obj['inRange'] = inRange;\n    };\n    Shape.prototype.alignRotateFlipColl = function (collection, isRotateFlipCollection, obj) {\n        collection = this.popForDefaultTransformedState(collection);\n        collection = this.popForDefaultFlipState(collection);\n        collection = this.popForDefaultRotateState(collection);\n        if (collection.length === 0 && isRotateFlipCollection) {\n            this.parent.transform.degree = 0;\n            this.parent.transform.currFlipState = '';\n        }\n        obj['collection'] = collection;\n        return collection;\n    };\n    Shape.prototype.popForDefaultTransformedState = function (collection) {\n        var rotateRight = 0;\n        var rotateleft = 0;\n        var horizontal = 0;\n        var vertical = 0;\n        for (var i = 0; i < collection.length; i++) {\n            if (collection[i] === 90 || collection[i] === 'rotateRight') {\n                rotateRight++;\n                rotateleft = 0;\n                horizontal = 0;\n                vertical = 0;\n                if (rotateRight === 4) {\n                    collection.pop();\n                    collection.pop();\n                    collection.pop();\n                    collection.pop();\n                }\n            }\n            else if (collection[i] === -90 || collection[i] === 'rotateLeft') {\n                rotateleft++;\n                rotateRight = 0;\n                horizontal = 0;\n                vertical = 0;\n                if (rotateleft === 4) {\n                    collection.pop();\n                    collection.pop();\n                    collection.pop();\n                    collection.pop();\n                }\n            }\n            else if (collection[i] === 'horizontal' || collection[i] === 'Horizontal'\n                || collection[i] === 'horizontalflip') {\n                horizontal++;\n                rotateleft = 0;\n                rotateRight = 0;\n                vertical = 0;\n                if (horizontal === 2) {\n                    collection.pop();\n                    collection.pop();\n                }\n            }\n            else if (collection[i] === 'vertical' || collection[i] === 'Vertical'\n                || collection[i] === 'verticalflip') {\n                vertical++;\n                horizontal = 0;\n                rotateleft = 0;\n                rotateRight = 0;\n                if (vertical === 2) {\n                    collection.pop();\n                    collection.pop();\n                }\n            }\n        }\n        return collection;\n    };\n    Shape.prototype.popForDefaultFlipState = function (collection) {\n        for (var i = 0; i < collection.length; i++) {\n            if (!isNullOrUndefined(collection[i + 3])) {\n                if ((collection[i] === 'horizontal' || collection[i] === 'Horizontal'\n                    || collection[i] === 'horizontalFlip')\n                    && (collection[i + 1] === 'vertical' || collection[i + 1] === 'Vertical'\n                        || collection[i] === 'verticalFlip') &&\n                    (collection[i + 2] === 'horizontal' || collection[i + 2] === 'Horizontal'\n                        || collection[i] === 'horizontalFlip') &&\n                    (collection[i + 3] === 'vertical' || collection[i + 3] === 'Vertical'\n                        || collection[i] === 'verticalFlip')) {\n                    collection.pop();\n                    collection.pop();\n                    collection.pop();\n                    collection.pop();\n                }\n                else if ((collection[i] === 'vertical' || collection[i] === 'Vertical'\n                    || collection[i] === 'verticalFlip')\n                    && (collection[i + 1] === 'horizontal' || collection[i + 1] === 'Horizontal'\n                        || collection[i + 1] === 'horizontalFlip') &&\n                    (collection[i + 2] === 'vertical' || collection[i + 2] === 'Vertical' || collection[i] === 'verticalFlip') &&\n                    (collection[i + 3] === 'horizontal' || collection[i + 3] === 'Horizontal' || collection[i] === 'horizontalFlip')) {\n                    collection.pop();\n                    collection.pop();\n                    collection.pop();\n                    collection.pop();\n                }\n            }\n        }\n        return collection;\n    };\n    Shape.prototype.popForDefaultRotateState = function (collection) {\n        for (var i = 0; i < collection.length; i++) {\n            if (!isNullOrUndefined(collection[i + 1])) {\n                if ((collection[i] === 90 || collection[i] === 'rotateRight') &&\n                    (collection[i + 1] === -90 || collection[i] === 'rotateLeft')) {\n                    collection.pop();\n                    collection.pop();\n                }\n                else if ((collection[i] === -90 || collection[i] === 'rotateLeft') &&\n                    (collection[i + 1] === 90 || collection[i] === 'rotateRight')) {\n                    collection.pop();\n                    collection.pop();\n                }\n            }\n        }\n        return collection;\n    };\n    Shape.prototype.selectShape = function (id, obj) {\n        var parent = this.parent;\n        var isSelected = false;\n        if (!parent.disabled && parent.isImageLoaded) {\n            this.applyActObj();\n            if (id.split('_')[0] === 'shape') {\n                var obj_2;\n                for (var i = 0, len = parent.objColl.length; i < len; i++) {\n                    if (parent.objColl[i].currIndex === id) {\n                        obj_2 = extend({}, parent.objColl[i], {}, true);\n                        break;\n                    }\n                }\n                if (isNullOrUndefined(obj_2)) {\n                    isSelected = false;\n                }\n                else {\n                    isSelected = true;\n                    parent.activeObj = obj_2;\n                    var object = { canvasFilter: null };\n                    parent.notify('toolbar', { prop: 'getCanvasFilter', onPropertyChange: false, value: { obj: object } });\n                    this.lowerContext.filter = object['canvasFilter'];\n                    parent.notify('selection', { prop: 'redrawShape', onPropertyChange: false,\n                        value: { obj: parent.activeObj } });\n                    if (!isBlazor()) {\n                        if (parent.activeObj.shape === 'text') {\n                            parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'text',\n                                    isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                        }\n                        else if (parent.activeObj.shape === 'pen') {\n                            parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'pen',\n                                    isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                        }\n                        else {\n                            parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'shapes',\n                                    isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                        }\n                        parent.notify('toolbar', { prop: 'update-toolbar-items', onPropertyChange: false });\n                        parent.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: null } });\n                    }\n                    else {\n                        parent.updateToolbar(parent.element, parent.activeObj.shape);\n                        if (parent.activeObj.shape === 'path') {\n                            parent.updateToolbar(this.parent.element, 'path', 'pathQuickAccessToolbar');\n                        }\n                        else {\n                            parent.updateToolbar(parent.element, 'quickAccessToolbar', parent.activeObj.shape);\n                        }\n                    }\n                }\n            }\n            else if (id.split('_')[0] === 'pen') {\n                var object = { bool: false };\n                parent.notify('selection', { prop: 'getFreehandDrawEditing', onPropertyChange: false, value: { obj: object } });\n                if (object['bool']) {\n                    parent.okBtn();\n                }\n                var obj_3 = { isIndex: false };\n                parent.notify('freehand-draw', { prop: 'isFHDIdx', value: { index: parseInt(id.split('_')[1], 10) - 1, obj: obj_3 } });\n                if (obj_3['isIndex']) {\n                    isSelected = true;\n                    parent.notify('freehand-draw', { prop: 'selectFhd', value: { id: id } });\n                    if (!isBlazor()) {\n                        parent.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: true } });\n                        parent.notify('toolbar', { prop: 'update-toolbar-items', onPropertyChange: false });\n                    }\n                    else {\n                        parent.updateToolbar(parent.element, 'pen');\n                        parent.updateToolbar(parent.element, 'quickAccessToolbar', 'pen');\n                    }\n                }\n                else {\n                    isSelected = false;\n                }\n            }\n        }\n        obj['isSelected'] = isSelected;\n    };\n    Shape.prototype.deleteShape = function (id) {\n        var parent = this.parent;\n        if (!parent.disabled && parent.isImageLoaded) {\n            this.applyActObj();\n            if (id.split('_')[0] === 'shape') {\n                for (var i = 0, len = parent.objColl.length; i < len; i++) {\n                    if (parent.objColl[i].currIndex === id) {\n                        parent.objColl.splice(i, 1);\n                        break;\n                    }\n                }\n            }\n            else if (id.split('_')[0] === 'pen') {\n                parent.notify('freehand-draw', { prop: 'handle-freehand-draw', value: { id: id } });\n            }\n            var object = { canvasFilter: null };\n            parent.notify('toolbar', { prop: 'getCanvasFilter', onPropertyChange: false, value: { obj: object } });\n            this.lowerContext.filter = object['canvasFilter'];\n            this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n            parent.notify('draw', { prop: 'redrawImgWithObj', onPropertyChange: false });\n            if (!isBlazor()) {\n                parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n            }\n            else {\n                parent.updateToolbar(parent.element, 'imageLoaded');\n            }\n        }\n    };\n    Shape.prototype.getMaxText = function (isTextBox, text, obj) {\n        if (isNullOrUndefined(text)) {\n            text = isTextBox ? this.parent.textArea.value : this.parent.activeObj.keyHistory;\n        }\n        var maxi;\n        var rows = text.split('\\n');\n        var maxStr = rows[0].length;\n        var maxText = rows[0];\n        for (var i = 1; i < rows.length; i++) {\n            maxi = rows[i].length;\n            if (maxi > maxStr) {\n                maxText = rows[i];\n                maxStr = maxi;\n            }\n        }\n        if (obj) {\n            obj['maxText'] = maxText;\n        }\n        return maxText;\n    };\n    Shape.prototype.getLinePoints = function (x1, y1, x2, y2) {\n        var points = [];\n        var i;\n        var j;\n        if (x1 === x2) {\n            if (y1 < y2) {\n                i = [x1, y1];\n                j = [x2, y2];\n            }\n            else {\n                j = [x1, y1];\n                i = [x2, y2];\n            }\n            var m = this.getSlope(i, j, true);\n            var b = this.getIntercept(i, m);\n            for (var y = i[1]; y <= j[1]; y++) {\n                var x = m * y + b;\n                points.push({ x: x, y: y });\n            }\n        }\n        else {\n            if (x1 < x2) {\n                i = [x1, y1];\n                j = [x2, y2];\n            }\n            else {\n                j = [x1, y1];\n                i = [x2, y2];\n            }\n            var m = this.getSlope(i, j, false);\n            var b = this.getIntercept(i, m);\n            for (var x = i[0]; x <= j[0]; x++) {\n                var y = m * x + b;\n                points.push({ x: x, y: y });\n            }\n        }\n        if (Math.floor(x1) === Math.floor(x2) || (points.length < 10 && (y2 - y1 > 10 || y1 - y2 > 10))) {\n            points = [];\n            var lesserY = Math.min(y1, y2);\n            for (var i_1 = 0; i_1 < Math.abs(Math.floor(y2) - Math.floor(y1)); i_1++) {\n                points.push({ x: x1, y: lesserY + i_1 });\n            }\n            if (points.length > 1) {\n                var prev = void 0;\n                if (isNullOrUndefined(points[points.length - 2])) {\n                    prev = { x: 0, y: 0 };\n                }\n                else {\n                    prev = points[points.length - 2];\n                }\n                var diffX = points[points.length - 1]['x'] - prev.x;\n                var diffY = points[points.length - 1]['y'] - prev.y;\n                points.push({ x: points[points.length - 1]['x'] + (diffX / 2), y: points[points.length - 1]['y'] + (diffY / 2) });\n            }\n        }\n        else if (Math.floor(y1) === Math.floor(y2) || (points.length < 10 && (x2 - x1 > 10 || x1 - x2 > 10))) {\n            points = [];\n            var lesserX = Math.min(x1, x2);\n            for (var i_2 = 0; i_2 < Math.abs(Math.floor(x2) - Math.floor(x1)); i_2++) {\n                points.push({ x: lesserX + i_2, y: y1 });\n            }\n            if (points.length > 1) {\n                var prev = void 0;\n                if (isNullOrUndefined(points[points.length - 2])) {\n                    prev = { x: 0, y: 0 };\n                }\n                else {\n                    prev = points[points.length - 2];\n                }\n                var diffX = points[points.length - 1]['x'] - prev.x;\n                var diffY = points[points.length - 1]['y'] - prev.y;\n                points.push({ x: points[points.length - 1]['x'] + (diffX / 2), y: points[points.length - 1]['y'] + (diffY / 2) });\n            }\n        }\n        return points;\n    };\n    Shape.prototype.getSlope = function (a, b, isSameAxis) {\n        var slope;\n        if (isSameAxis) {\n            if (a[1] === b[1]) {\n                return null;\n            }\n            slope = (b[0] - a[0]) / (b[1] - a[1]);\n        }\n        else {\n            if (a[0] === b[0]) {\n                return null;\n            }\n            slope = (b[1] - a[1]) / (b[0] - a[0]);\n        }\n        return slope;\n    };\n    Shape.prototype.getIntercept = function (point, getSlope) {\n        if (getSlope === null) {\n            return point[0];\n        }\n        return point[1] - getSlope * point[0];\n    };\n    Shape.prototype.setPointCollForShapeRotation = function (obj) {\n        var center = { x: obj.activePoint.startX + (obj.activePoint.width / 2), y: obj.activePoint.startY +\n                (obj.activePoint.height / 2) };\n        var p1 = { x: Math.cos(obj.rotatedAngle) * (obj.activePoint.startX - center.x) - Math.sin(obj.rotatedAngle) *\n                (obj.activePoint.startY - center.y) + center.x,\n            y: Math.sin(obj.rotatedAngle) * (obj.activePoint.startX - center.x) + Math.cos(obj.rotatedAngle) *\n                (obj.activePoint.startY - center.y) + center.y };\n        var p2 = { x: Math.cos(obj.rotatedAngle) * (obj.activePoint.endX - center.x) - Math.sin(obj.rotatedAngle) *\n                (obj.activePoint.startY - center.y) + center.x,\n            y: Math.sin(obj.rotatedAngle) * (obj.activePoint.endX - center.x) + Math.cos(obj.rotatedAngle) * (obj.activePoint.startY\n                - center.y) + center.y };\n        var p3 = { x: Math.cos(obj.rotatedAngle) * (obj.activePoint.startX - center.x) - Math.sin(obj.rotatedAngle) *\n                (obj.activePoint.endY - center.y) + center.x,\n            y: Math.sin(obj.rotatedAngle) * (obj.activePoint.startX - center.x) + Math.cos(obj.rotatedAngle) * (obj.activePoint.endY\n                - center.y) + center.y };\n        var p4 = { x: Math.cos(obj.rotatedAngle) * (obj.activePoint.endX - center.x) - Math.sin(obj.rotatedAngle) *\n                (obj.activePoint.endY - center.y) + center.x,\n            y: Math.sin(obj.rotatedAngle) * (obj.activePoint.endX - center.x) + Math.cos(obj.rotatedAngle) * (obj.activePoint.endY\n                - center.y) + center.y };\n        obj.horTopLinePointColl = this.getLinePoints(p1.x, p1.y, p2.x, p2.y);\n        obj.horBottomLinePointColl = this.getLinePoints(p3.x, p3.y, p4.x, p4.y);\n        obj.verLeftLinePointColl = this.getLinePoints(p1.x, p1.y, p3.x, p3.y);\n        obj.verRightLinePointColl = this.getLinePoints(p2.x, p2.y, p4.x, p4.y);\n        obj.verLeftLinePointColl.reverse();\n        obj.verRightLinePointColl.reverse();\n        // Updating ratio for point collection\n        for (var i = 0; i < obj.horTopLinePointColl.length; i++) {\n            obj.horTopLinePointColl[i].ratioX = (obj.horTopLinePointColl[i].x -\n                this.parent.img.destLeft) / this.parent.img.destWidth;\n            obj.horTopLinePointColl[i].ratioY = (obj.horTopLinePointColl[i].y -\n                this.parent.img.destTop) / this.parent.img.destHeight;\n        }\n        for (var i = 0; i < obj.horBottomLinePointColl.length; i++) {\n            obj.horBottomLinePointColl[i].ratioX = (obj.horBottomLinePointColl[i].x -\n                this.parent.img.destLeft) / this.parent.img.destWidth;\n            obj.horBottomLinePointColl[i].ratioY = (obj.horBottomLinePointColl[i].y -\n                this.parent.img.destTop) / this.parent.img.destHeight;\n        }\n        for (var i = 0; i < obj.verLeftLinePointColl.length; i++) {\n            obj.verLeftLinePointColl[i].ratioX = (obj.verLeftLinePointColl[i].x -\n                this.parent.img.destLeft) / this.parent.img.destWidth;\n            obj.verLeftLinePointColl[i].ratioY = (obj.verLeftLinePointColl[i].y -\n                this.parent.img.destTop) / this.parent.img.destHeight;\n        }\n        for (var i = 0; i < obj.verRightLinePointColl.length; i++) {\n            obj.verRightLinePointColl[i].ratioX = (obj.verRightLinePointColl[i].x -\n                this.parent.img.destLeft) / this.parent.img.destWidth;\n            obj.verRightLinePointColl[i].ratioY = (obj.verRightLinePointColl[i].y -\n                this.parent.img.destTop) / this.parent.img.destHeight;\n        }\n        if (this.parent.upperCanvas.style.cursor !== 'move') {\n            var object = { rotationCirclePoint: null };\n            this.parent.notify('selection', { prop: 'getTransRotationPoint', value: { obj: obj, object: object } });\n            var rotationCirclePoint = object['rotationCirclePoint'];\n            if (rotationCirclePoint) {\n                obj.rotationCirclePointColl = { x: Math.cos(obj.rotatedAngle) * (rotationCirclePoint.x - center.x) -\n                        Math.sin(obj.rotatedAngle) * (rotationCirclePoint.y - center.y) + center.x,\n                    y: Math.sin(obj.rotatedAngle) * (rotationCirclePoint.x - center.x) + Math.cos(obj.rotatedAngle)\n                        * (rotationCirclePoint.y - center.y) + center.y };\n                obj.rotationCirclePointColl.ratioX = (obj.rotationCirclePointColl.x - this.parent.img.destLeft) /\n                    this.parent.img.destWidth;\n                obj.rotationCirclePointColl.ratioY = (obj.rotationCirclePointColl.y - this.parent.img.destTop) /\n                    this.parent.img.destHeight;\n            }\n        }\n    };\n    Shape.prototype.getSquarePointForRotatedShape = function (obj, object) {\n        var point = { startX: 0, startY: 0, endX: 0, endY: 0, width: 0, height: 0 };\n        var center = { x: obj.activePoint.startX + (obj.activePoint.width / 2), y: obj.activePoint.startY +\n                (obj.activePoint.height / 2) };\n        var p1 = { x: Math.cos(obj.rotatedAngle) * (obj.activePoint.startX - center.x) - Math.sin(obj.rotatedAngle)\n                * (obj.activePoint.startY - center.y) + center.x,\n            y: Math.sin(obj.rotatedAngle) * (obj.activePoint.startX - center.x) + Math.cos(obj.rotatedAngle) * (obj.activePoint.startY\n                - center.y) + center.y };\n        var p2 = { x: Math.cos(obj.rotatedAngle) * (obj.activePoint.endX - center.x) - Math.sin(obj.rotatedAngle) *\n                (obj.activePoint.startY - center.y) + center.x,\n            y: Math.sin(obj.rotatedAngle) * (obj.activePoint.endX - center.x) + Math.cos(obj.rotatedAngle) * (obj.activePoint.startY\n                - center.y) + center.y };\n        var p3 = { x: Math.cos(obj.rotatedAngle) * (obj.activePoint.startX - center.x) - Math.sin(obj.rotatedAngle) *\n                (obj.activePoint.endY - center.y) + center.x,\n            y: Math.sin(obj.rotatedAngle) * (obj.activePoint.startX - center.x) + Math.cos(obj.rotatedAngle) * (obj.activePoint.endY\n                - center.y) + center.y };\n        var p4 = { x: Math.cos(obj.rotatedAngle) * (obj.activePoint.endX - center.x) - Math.sin(obj.rotatedAngle) *\n                (obj.activePoint.endY - center.y) + center.x,\n            y: Math.sin(obj.rotatedAngle) * (obj.activePoint.endX - center.x) + Math.cos(obj.rotatedAngle) *\n                (obj.activePoint.endY - center.y) + center.y };\n        point.startX = p1.x;\n        point.startY = p1.y;\n        point.endX = p1.x;\n        point.endY = p1.y;\n        if (point.startX > p2.x) {\n            point.startX = p2.x;\n        }\n        if (point.startX > p3.x) {\n            point.startX = p3.x;\n        }\n        if (point.startX > p4.x) {\n            point.startX = p4.x;\n        }\n        if (point.startY > p2.y) {\n            point.startY = p2.y;\n        }\n        if (point.startY > p3.y) {\n            point.startY = p3.y;\n        }\n        if (point.startY > p4.y) {\n            point.startY = p4.y;\n        }\n        if (point.endX < p2.x) {\n            point.endX = p2.x;\n        }\n        if (point.endX < p3.x) {\n            point.endX = p3.x;\n        }\n        if (point.endX < p4.x) {\n            point.endX = p4.x;\n        }\n        if (point.endY < p2.y) {\n            point.endY = p2.y;\n        }\n        if (point.endY < p3.y) {\n            point.endY = p3.y;\n        }\n        if (point.endY < p4.y) {\n            point.endY = p4.y;\n        }\n        point.width = point.endX - point.startX;\n        point.height = point.endY - point.startY;\n        if (object) {\n            object['activePoint'] = point;\n        }\n        return point;\n    };\n    return Shape;\n}());\nexport { Shape };\n","import { Browser, extend, getComponent, isBlazor, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { Direction } from '../index';\nimport { hideSpinner, showSpinner } from '@syncfusion/ej2-popups';\nvar Transform = /** @class */ (function () {\n    function Transform(parent) {\n        this.isReverseFlip = false; // True when rotate method is called from iteration\n        this.disablePan = false; // auto enable / disable pan while zooming\n        this.isReverseRotate = false; // True when rotate method is called from iteration\n        this.flipColl = []; // To store flip order\n        this.prevZoomValue = 1;\n        this.cropDimension = { width: 0, height: 0 };\n        this.isPreventSelect = false;\n        this.parent = parent;\n        this.addEventListener();\n    }\n    Transform.prototype.destroy = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.removeEventListener();\n    };\n    Transform.prototype.addEventListener = function () {\n        this.parent.on('transform', this.transform, this);\n        this.parent.on('destroyed', this.destroy, this);\n    };\n    Transform.prototype.removeEventListener = function () {\n        this.parent.off('transform', this.transform);\n        this.parent.off('destroyed', this.destroy);\n    };\n    Transform.prototype.transform = function (args) {\n        this.initTransformPvtVar();\n        switch (args.prop) {\n            case 'rotateImage':\n                this.rotateImage(args.value['degree']);\n                break;\n            case 'flipImage':\n                this.flipImage(args.value['direction']);\n                break;\n            case 'setDestPointsForFlipState':\n                this.setDestPointsForFlipState();\n                break;\n            case 'zoomAction':\n                this.zoomAction(args.value['zoomFactor'], args.value['zoomPoint']);\n                break;\n            case 'disableZoomOutBtn':\n                this.disableZoomOutBtn(args.value['isZoomOut']);\n                break;\n            case 'rotatedFlip':\n                this.rotatedFlip();\n                break;\n            case 'drawPannedImage':\n                this.drawPannedImage(args.value['xDiff'], args.value['yDiff']);\n                break;\n            case 'drawPannImage':\n                this.drawPannImage(args.value['point']);\n                break;\n            case 'performTransformation':\n                this.performTransformation(args.value['text']);\n                break;\n            case 'updateTransform':\n                this.updateTransform(args.value['text']);\n                break;\n            case 'rotatePan':\n                this.rotatePan(args.value['isCropSelection'], args.value['isDefaultZoom']);\n                break;\n            case 'drawRotatedImage':\n                this.drawRotatedImage(args.value['degree']);\n                break;\n            case 'limitPan':\n                this.limitPan();\n                break;\n            case 'updateFlipActiveObj':\n                this.updateFlipActiveObj(args.value['panRegion']);\n                break;\n            case 'resetZoom':\n                this.resetZoom();\n                break;\n            case 'pan':\n                this.pan(args.value['value']);\n                break;\n            case 'zoom':\n                this.zoom(args.value['zoomFactor'], args.value['zoomPoint']);\n                break;\n            case 'setCurrPanRegion':\n                this.setCurrPanRegion(args.value['region'], args.value['type'], args.value['obj']);\n                break;\n            case 'rotate':\n                this.rotate(args.value['degree'], args.value['obj']);\n                break;\n            case 'flip':\n                this.flip(args.value['direction']);\n                break;\n            case 'update':\n                this.update();\n                break;\n            case 'calcMaxDimension':\n                this.calcMaxDimension(args.value['width'], args.value['height'], args.value['obj']);\n                break;\n            case 'updatePanPoints':\n                this.updatePanPoints(args.value['panRegion'], args.value['obj']);\n                break;\n            case 'getPanMove':\n                args.value['obj']['panMove'] = this.panMove;\n                break;\n            case 'setPanMove':\n                this.panMove = args.value['point'];\n                break;\n            case 'getTempPanMove':\n                args.value['obj']['tempPanMove'] = this.tempPanMove;\n                break;\n            case 'setTempPanMove':\n                this.tempPanMove = args.value['point'];\n                break;\n            case 'setReverseFlip':\n                this.isReverseFlip = args.value['isReverseFlip'];\n                break;\n            case 'setDisablePan':\n                this.disablePan = args.value['bool'];\n                break;\n            case 'setCurrDestinationPoint':\n                this.currDestPoint = args.value['point'];\n                this.currDestPoint.startX -= this.parent.cropObj.totalPannedPoint.x;\n                this.currDestPoint.startY -= this.parent.cropObj.totalPannedPoint.y;\n                break;\n            case 'setReverseRotate':\n                this.isReverseRotate = args.value['bool'];\n                break;\n            case 'getFlipColl':\n                args.value['obj']['flipColl'] = this.flipColl;\n                break;\n            case 'setFlipColl':\n                this.flipColl = args.value['flipColl'];\n                break;\n            case 'getPreviousZoomValue':\n                args.value['obj']['previousZoomValue'] = this.prevZoomValue;\n                break;\n            case 'setPreviousZoomValue':\n                this.prevZoomValue = args.value['previousZoomValue'];\n                break;\n            case 'getCropDimension':\n                args.value['obj']['cropDimension'] = this.cropDimension;\n                break;\n            case 'setCropDimension':\n                this.cropDimension.width = args.value['width'];\n                this.cropDimension.height = args.value['height'];\n                break;\n            case 'getPreventSelect':\n                args.value['obj']['bool'] = this.isPreventSelect;\n                break;\n            case 'setPreventSelect':\n                this.isPreventSelect = args.value['bool'];\n                break;\n            case 'reset':\n                this.reset();\n                break;\n        }\n    };\n    Transform.prototype.getModuleName = function () {\n        return 'transform';\n    };\n    Transform.prototype.initTransformPvtVar = function () {\n        if (this.parent.lowerCanvas) {\n            this.lowerContext = this.parent.lowerCanvas.getContext('2d');\n        }\n        if (this.parent.upperCanvas) {\n            this.upperContext = this.parent.upperCanvas.getContext('2d');\n        }\n    };\n    Transform.prototype.reset = function () {\n        this.zoomBtnHold = null;\n        this.tempPanMove = null;\n        this.panMove = null;\n        this.disablePan = false;\n        this.currDestPoint = null;\n        this.isReverseRotate = false;\n        this.flipColl = [];\n        this.transCurrObj = null;\n        this.prevZoomValue = 1;\n        this.isPreventSelect = false;\n    };\n    Transform.prototype.rotateImage = function (degree) {\n        var _this = this;\n        var parent = this.parent;\n        var transitionArgs = { cancel: false, previousDegree: parent.transform.degree,\n            currentDegree: Math.abs(parent.transform.degree + degree) === 360 ? 0 : parent.transform.degree + degree };\n        if (!this.isPreventSelect && isBlazor() && parent.events && parent.events.rotating.hasDelegate === true) {\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            parent.dotNetRef.invokeMethodAsync('RotateEventAsync', 'OnRotate', transitionArgs).then(function (args) {\n                _this.rotateEvent(args, degree);\n            });\n        }\n        else {\n            if (!this.isPreventSelect) {\n                parent.trigger('rotating', transitionArgs);\n            }\n            this.rotateEvent(transitionArgs, degree);\n        }\n    };\n    Transform.prototype.rotateEvent = function (transitionArgs, degree) {\n        var parent = this.parent;\n        if (!transitionArgs.cancel) {\n            var prevObj = void 0;\n            if (isNullOrUndefined(this.transCurrObj)) {\n                var object = { currObj: {} };\n                parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n                prevObj = object['currObj'];\n                prevObj.objColl = extend([], parent.objColl, null, true);\n                prevObj.pointColl = extend({}, parent.pointColl, null, true);\n                prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n                var selPointCollObj = { selPointColl: null };\n                parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                    value: { obj: selPointCollObj } });\n                prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n            }\n            parent.afterCropActions.push(degree === 90 ? 'rotateRight' : 'rotateLeft');\n            var splitWords = [];\n            var activeObjShape = void 0;\n            if (parent.activeObj.activePoint && parent.activeObj.shape) {\n                if (parent.activeObj.shape !== undefined) {\n                    splitWords = parent.activeObj.shape.split('-');\n                }\n                if (parent.currObjType.isCustomCrop || splitWords[0] === 'crop') {\n                    activeObjShape = parent.currObjType.isCustomCrop ? 'custom' : splitWords[1];\n                    parent.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n                    parent.objColl.push(parent.activeObj);\n                    parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                }\n            }\n            parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                value: { x: null, y: null, isMouseDown: true } });\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            this.drawRotatedImage(degree);\n            parent.notify('draw', { prop: 'setImageEdited', onPropertyChange: false });\n            parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n            parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.upperContext } });\n            if (parent.isCircleCrop) {\n                parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                    value: { context: this.lowerContext, isSave: null, isFlip: null } });\n            }\n            if (activeObjShape) {\n                this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                parent.activeObj = extend({}, parent.objColl[parent.objColl.length - 1], {}, true);\n                parent.objColl.pop();\n                parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj } });\n            }\n            parent.isUndoRedo = false;\n            var obj = { collection: parent.rotateFlipColl };\n            parent.notify('shape', { prop: 'alignRotateFlipColl', onPropertyChange: false,\n                value: { collection: parent.rotateFlipColl, isRotateFlipCollection: true, obj: obj } });\n            parent.rotateFlipColl = obj['collection'];\n            if (parent.cropObj.activeObj.shape && !this.isPreventSelect) {\n                this.isPreventSelect = true;\n                parent.select('custom');\n                this.isPreventSelect = false;\n                parent.setProperties({ zoomSettings: { zoomFactor: 1 } }, true);\n                this.prevZoomValue = parent.zoomSettings.zoomFactor;\n            }\n        }\n    };\n    Transform.prototype.drawRotatedImage = function (degree) {\n        var parent = this.parent;\n        if (degree === 0) {\n            parent.transform.degree = 0;\n        }\n        else {\n            parent.transform.degree += degree;\n        }\n        if (Math.abs(parent.transform.degree) === 360) {\n            parent.transform.degree = 0;\n        }\n        parent.notify('draw', { prop: 'setDestPoints', onPropertyChange: false });\n        var tempObjColl = extend([], parent.objColl, [], true);\n        var tempActiveObj = extend({}, parent.activeObj, {}, true);\n        parent.objColl = [];\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        if (!this.isReverseRotate) {\n            parent.notify('draw', { prop: 'updateCurrTransState', onPropertyChange: false,\n                value: { type: 'initial', isPreventDestination: null, isRotatePan: null } });\n        }\n        this.rotateDegree(degree);\n        if (!this.isReverseRotate) {\n            parent.notify('draw', { prop: 'updateCurrTransState', onPropertyChange: false,\n                value: { type: 'reverse', isPreventDestination: null, isRotatePan: null } });\n            parent.rotateFlipColl.push(degree);\n        }\n        parent.objColl = extend([], tempObjColl, [], true);\n        parent.activeObj = extend({}, tempActiveObj, {}, true);\n        if (parent.isCircleCrop) {\n            parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                value: { context: this.lowerContext, isSave: null, isFlip: null } });\n        }\n        parent.notify('shape', { prop: 'redrawObj', onPropertyChange: false, value: { degree: degree } });\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        if (degree > 0) {\n            parent.notify('freehand-draw', { prop: 'rotateFhdColl', onPropertyChange: false });\n        }\n        else {\n            for (var i = 0; i < 3; i++) {\n                parent.notify('freehand-draw', { prop: 'rotateFhdColl', onPropertyChange: false });\n            }\n        }\n        parent.notify('freehand-draw', { prop: 'freehandRedraw', onPropertyChange: false,\n            value: { context: this.lowerContext, points: null } });\n        this.updateCurrSelectionPoint(degree);\n    };\n    Transform.prototype.rotateDegree = function (degree) {\n        var parent = this.parent;\n        this.lowerContext.save();\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        this.lowerContext.translate(parent.lowerCanvas.width / 2, parent.lowerCanvas.height / 2);\n        this.lowerContext.rotate(Math.PI / 180 * degree);\n        this.lowerContext.translate(-parent.lowerCanvas.width / 2, -parent.lowerCanvas.height / 2);\n        var temp = this.lowerContext.filter;\n        this.parent.notify('filter', { prop: 'updateBrightFilter', onPropertyChange: false });\n        this.lowerContext.drawImage(this.parent.baseImg, this.parent.img.srcLeft, this.parent.img.srcTop, this.parent.img.srcWidth, this.parent.img.srcHeight, this.parent.img.destLeft, this.parent.img.destTop, this.parent.img.destWidth, this.parent.img.destHeight);\n        this.lowerContext.filter = temp;\n        this.lowerContext.translate(parent.lowerCanvas.width / 2, parent.lowerCanvas.height / 2);\n        this.lowerContext.rotate(Math.PI / 180 * -degree);\n        this.lowerContext.translate(-parent.lowerCanvas.width / 2, -parent.lowerCanvas.height / 2);\n        this.lowerContext.restore();\n    };\n    Transform.prototype.updateCurrSelectionPoint = function (degree) {\n        var parent = this.parent;\n        if (parent.currSelectionPoint && this.currDestPoint) {\n            var activeObj = extend({}, parent.activeObj, {}, true);\n            var objColl = extend([], parent.objColl, [], true);\n            var srcPoints = { startX: parent.img.srcLeft, startY: parent.img.srcTop, width: parent.img.srcWidth,\n                height: parent.img.srcHeight };\n            var destPoints = { startX: parent.img.destLeft, startY: parent.img.destTop, width: parent.img.destWidth,\n                height: parent.img.destHeight };\n            parent.objColl = [];\n            parent.objColl.push(extend({}, parent.currSelectionPoint, {}, true));\n            if (isNullOrUndefined(parent.objColl[0].imageRatio)) {\n                parent.activeObj = parent.objColl[0];\n                parent.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n                parent.objColl[0] = parent.activeObj;\n            }\n            parent.img.srcLeft = 0;\n            parent.img.srcTop = 0;\n            parent.img.srcWidth = parent.baseImg.width;\n            parent.img.srcHeight = parent.baseImg.height;\n            parent.img.destLeft = this.currDestPoint.startX;\n            parent.img.destTop = this.currDestPoint.startY;\n            parent.img.destWidth = this.currDestPoint.width;\n            parent.img.destHeight = this.currDestPoint.height;\n            if (typeof (degree) === 'number') {\n                parent.notify('draw', { prop: 'setDestPoints', onPropertyChange: false });\n                parent.notify('draw', { prop: 'setClientTransDim', onPropertyChange: false,\n                    value: { isPreventDimension: null } });\n            }\n            parent.notify('shape', { prop: 'redrawObj', onPropertyChange: false, value: { degree: degree } });\n            parent.currSelectionPoint = extend({}, parent.objColl[0], {}, true);\n            this.currDestPoint = { startX: parent.img.destLeft, startY: parent.img.destTop, width: parent.img.destWidth,\n                height: parent.img.destHeight };\n            parent.objColl = objColl;\n            parent.activeObj = activeObj;\n            parent.img.srcLeft = srcPoints.startX;\n            parent.img.srcTop = srcPoints.startY;\n            parent.img.srcWidth = srcPoints.width;\n            parent.img.srcHeight = srcPoints.height;\n            parent.img.destLeft = destPoints.startX;\n            parent.img.destTop = destPoints.startY;\n            parent.img.destWidth = destPoints.width;\n            parent.img.destHeight = destPoints.height;\n        }\n    };\n    Transform.prototype.flipImage = function (direction) {\n        var _this = this;\n        var parent = this.parent;\n        var transitionArgs = { direction: direction, cancel: false,\n            previousDirection: parent.toPascalCase(parent.transform.currFlipState) };\n        if (!this.isPreventSelect && isBlazor() && parent.events && parent.events.flipping.hasDelegate === true) {\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            parent.dotNetRef.invokeMethodAsync('FlipEventAsync', 'OnFlip', transitionArgs).then(function (args) {\n                _this.flipEvent(args, direction);\n            });\n        }\n        else {\n            if (!this.isPreventSelect) {\n                parent.trigger('flipping', transitionArgs);\n            }\n            this.flipEvent(transitionArgs, direction);\n        }\n    };\n    Transform.prototype.flipEvent = function (transitionArgs, direction) {\n        var parent = this.parent;\n        if (transitionArgs.cancel) {\n            return;\n        }\n        var prevObj;\n        if (isNullOrUndefined(this.transCurrObj)) {\n            var object = { currObj: {} };\n            parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n            prevObj = object['currObj'];\n            prevObj.objColl = extend([], parent.objColl, null, true);\n            prevObj.pointColl = extend({}, parent.pointColl, null, true);\n            prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n            var selPointCollObj = { selPointColl: null };\n            parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                value: { obj: selPointCollObj } });\n            prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        }\n        parent.afterCropActions.push(direction.toLowerCase() === 'horizontal' ? 'horizontalflip' : 'verticalflip');\n        var splitWords = [];\n        var activeObjShape;\n        if (parent.activeObj.activePoint) {\n            if (parent.activeObj.shape !== undefined) {\n                splitWords = parent.activeObj.shape.split('-');\n            }\n            if (parent.currObjType.isCustomCrop || splitWords[0] === 'crop') {\n                activeObjShape = parent.currObjType.isCustomCrop ? 'custom' : splitWords[1];\n                parent.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n                parent.objColl.push(parent.activeObj);\n                parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            }\n        }\n        parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n            value: { x: null, y: null, isMouseDown: true } });\n        parent.clearContext(this.lowerContext);\n        parent.clearContext(this.upperContext);\n        var tempObjColl = extend([], parent.objColl, [], true);\n        var tempActiveObj = extend({}, parent.activeObj, {}, true);\n        parent.objColl = [];\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        if (!this.isReverseFlip) {\n            parent.notify('draw', { prop: 'updateCurrTransState', onPropertyChange: false,\n                value: { type: 'initial', isPreventDestination: null, isRotatePan: null } });\n        }\n        var lowercaseDirection = direction.toLowerCase();\n        this.updateFlipState(lowercaseDirection);\n        if (lowercaseDirection === 'horizontal') {\n            parent.transform.currFlipState = (parent.transform.currFlipState.toLowerCase() === 'horizontal') ? '' : 'horizontal';\n        }\n        else {\n            parent.transform.currFlipState = (parent.transform.currFlipState.toLowerCase() === 'vertical') ? '' : 'vertical';\n        }\n        var selObj = { isSelected: null };\n        parent.notify('draw', { prop: 'getRotatedFlipCropSelection', onPropertyChange: false, value: { bool: selObj } });\n        if (selObj['isSelected']) {\n            parent.img.destLeft += parent.panPoint.totalPannedInternalPoint.x;\n            parent.img.destTop += parent.panPoint.totalPannedInternalPoint.y;\n        }\n        var temp = this.lowerContext.filter;\n        parent.notify('filter', { prop: 'updateBrightFilter', onPropertyChange: false });\n        this.lowerContext.drawImage(parent.baseImg, parent.img.srcLeft, parent.img.srcTop, parent.img.srcWidth, parent.img.srcHeight, parent.img.destLeft, parent.img.destTop, parent.img.destWidth, parent.img.destHeight);\n        this.lowerContext.filter = temp;\n        parent.notify('draw', { prop: 'setImageEdited', onPropertyChange: false });\n        this.updateFlipState(direction.toLowerCase());\n        if (!this.isReverseFlip) {\n            parent.notify('draw', { prop: 'updateCurrTransState', onPropertyChange: false,\n                value: { type: 'reverse', isPreventDestination: null, isRotatePan: null } });\n            this.updateFlipColl(direction.toLocaleLowerCase());\n            parent.rotateFlipColl.push(direction.toLowerCase());\n        }\n        if (parent.rotateFlipColl.length === 1) {\n            var panObj = { panRegion: '' };\n            parent.notify('crop', { prop: 'getCurrFlipState', onPropertyChange: false,\n                value: { panObj: panObj } });\n            if (panObj['panRegion'] === '') {\n                parent.notify('draw', { prop: 'setClientTransDim', onPropertyChange: false,\n                    value: { isPreventDimension: null } });\n            }\n            else {\n                this.setDestPointsForFlipState();\n            }\n        }\n        if (parent.isCircleCrop) {\n            parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                value: { context: this.lowerContext, isSave: null, isFlip: null } });\n        }\n        parent.objColl = extend([], tempObjColl, [], true);\n        parent.activeObj = extend({}, tempActiveObj, {}, true);\n        for (var i = 0, len = parent.objColl.length; i < len; i++) {\n            var flipObjColl = parent.objColl[i].flipObjColl;\n            if (flipObjColl.length === 0) {\n                flipObjColl.push(direction);\n            }\n            else if (flipObjColl[flipObjColl.length - 1] === direction) {\n                flipObjColl.pop();\n            }\n            else {\n                flipObjColl.push(direction);\n            }\n        }\n        parent.notify('shape', { prop: 'redrawObj', onPropertyChange: false, value: { degree: direction.toLowerCase() } });\n        var tempFilter = this.lowerContext.filter;\n        this.lowerContext.filter = 'brightness(' + 1 + ') ' + 'contrast(' + 100 + '%) ' + 'hue-rotate(' + 0 + 'deg) ' +\n            'saturate(' + 100 + '%) ' + 'opacity(' + 1 + ') ' + 'blur(' + 0 + 'px) ' + 'sepia(0%) ' + 'grayscale(0%) ' + 'invert(0%)';\n        parent.notify('shape', { prop: 'iterateObjColl', onPropertyChange: false });\n        if (direction.toLowerCase() === 'horizontal' || direction.toLowerCase() === 'vertical') {\n            parent.notify('freehand-draw', { prop: 'flipFHDColl', onPropertyChange: false,\n                value: { value: direction.toLowerCase() } });\n            parent.notify('freehand-draw', { prop: 'freehandRedraw', onPropertyChange: false,\n                value: { context: this.lowerContext, points: null } });\n        }\n        else {\n            parent.notify('freehand-draw', { prop: 'freehandRedraw', onPropertyChange: false,\n                value: { context: this.lowerContext, points: null } });\n        }\n        this.lowerContext.filter = tempFilter;\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        this.updateCurrSelectionPoint(direction.toLowerCase());\n        parent.isUndoRedo = false;\n        parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n        parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.upperContext } });\n        if (parent.isCircleCrop) {\n            parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                value: { context: this.lowerContext, isSave: null, isFlip: null } });\n        }\n        if (activeObjShape) {\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            parent.activeObj = extend({}, parent.objColl[parent.objColl.length - 1], {}, true);\n            parent.objColl.pop();\n            parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj } });\n        }\n        var obj = { collection: parent.rotateFlipColl };\n        parent.notify('shape', { prop: 'alignRotateFlipColl', onPropertyChange: false,\n            value: { collection: parent.rotateFlipColl, isRotateFlipCollection: true, obj: obj } });\n        parent.rotateFlipColl = obj['collection'];\n        if (parent.cropObj.activeObj.shape && !this.isPreventSelect) {\n            this.isPreventSelect = true;\n            parent.select('custom');\n            this.isPreventSelect = false;\n            parent.setProperties({ zoomSettings: { zoomFactor: 1 } }, true);\n            this.prevZoomValue = parent.zoomSettings.zoomFactor;\n        }\n    };\n    Transform.prototype.updateFlipState = function (direction) {\n        var degree = this.parent.transform.degree;\n        if (direction === 'horizontal') {\n            if (degree % 90 === 0 && degree % 180 !== 0) {\n                this.verticalFlip();\n            }\n            else {\n                this.horizontalFlip();\n            }\n        }\n        else if (direction === 'vertical') {\n            if (degree % 90 === 0 && degree % 180 !== 0) {\n                this.horizontalFlip();\n            }\n            else {\n                this.verticalFlip();\n            }\n        }\n    };\n    Transform.prototype.horizontalFlip = function () {\n        this.lowerContext.translate(this.lowerContext.canvas.width, 0);\n        this.lowerContext.scale(-1, 1);\n        this.upperContext.translate(this.upperContext.canvas.width, 0);\n        this.upperContext.scale(-1, 1);\n    };\n    Transform.prototype.verticalFlip = function () {\n        this.lowerContext.translate(0, this.lowerContext.canvas.height);\n        this.lowerContext.scale(1, -1);\n        this.upperContext.translate(0, this.upperContext.canvas.height);\n        this.upperContext.scale(1, -1);\n    };\n    Transform.prototype.updateFlipColl = function (direction) {\n        if (this.isPreventSelect) {\n            return;\n        }\n        if (this.flipColl.length === 0 || this.flipColl[this.flipColl.length - 1] !== direction) {\n            this.flipColl.push(direction);\n        }\n        else {\n            this.flipColl.pop();\n        }\n        if (this.flipColl.length >= 4) {\n            var lastFourItems = this.flipColl.slice(-4);\n            if ((lastFourItems[0] === 'horizontal' && lastFourItems[1] === 'vertical' &&\n                lastFourItems[2] === 'horizontal' && lastFourItems[3] === 'vertical') ||\n                (lastFourItems[0] === 'vertical' && lastFourItems[1] === 'horizontal' &&\n                    lastFourItems[2] === 'vertical' && lastFourItems[3] === 'horizontal')) {\n                this.flipColl.splice(-4);\n            }\n        }\n    };\n    Transform.prototype.setDestPointsForFlipState = function () {\n        var parent = this.parent;\n        var panObj = { panRegion: '' };\n        parent.notify('crop', { prop: 'getCurrFlipState', onPropertyChange: false,\n            value: { panObj: panObj } });\n        if (panObj['panRegion'] !== '') {\n            if (panObj['panRegion'] === 'horizontal') {\n                parent.img.destLeft = parent.lowerCanvas.clientWidth - (parent.img.destWidth + parent.img.destLeft);\n            }\n            else if (panObj['panRegion'] === 'vertical') {\n                parent.img.destTop = parent.lowerCanvas.clientHeight - (parent.img.destHeight + parent.img.destTop);\n            }\n            else {\n                parent.img.destLeft = parent.lowerCanvas.clientWidth - (parent.img.destWidth + parent.img.destLeft);\n                parent.img.destTop = parent.lowerCanvas.clientHeight - (parent.img.destHeight + parent.img.destTop);\n            }\n        }\n    };\n    Transform.prototype.zoomAction = function (zoomFactor, zoomPoint) {\n        var _this = this;\n        var parent = this.parent;\n        if (!parent.disabled && parent.isImageLoaded) {\n            if (parent.zoomSettings.zoomFactor >= parent.zoomSettings.maxZoomFactor && zoomFactor > 0 ||\n                (parent.zoomSettings.zoomFactor > parent.zoomSettings.minZoomFactor && zoomFactor < 0 && this.disableZoomOutBtn(true)) ||\n                (parent.zoomSettings.zoomFactor <= parent.zoomSettings.minZoomFactor && zoomFactor < 0)) {\n                if (!isBlazor()) {\n                    parent.notify('toolbar', { prop: 'zoom-up-handler', onPropertyChange: false });\n                }\n                return;\n            }\n            parent.notify('draw', { prop: 'setImageEdited', onPropertyChange: false });\n            var tempZoomFactor = zoomFactor;\n            zoomFactor = tempZoomFactor > 0 ? 0.1 : -0.1;\n            for (var i = 0; i < Math.abs(tempZoomFactor / 0.1); i++) {\n                if (this.prevZoomValue === 1) {\n                    this.prevZoomValue += zoomFactor > 0 ? zoomFactor * 10 : (zoomFactor * 10) / 10;\n                }\n                else if (this.prevZoomValue > 1) {\n                    this.prevZoomValue += (zoomFactor * 10);\n                }\n                else if (this.prevZoomValue < 1) {\n                    this.prevZoomValue += (zoomFactor * 10) / 10;\n                    var powerOften = Math.pow(10, 1);\n                    this.prevZoomValue = (Math.round(this.prevZoomValue * powerOften) / powerOften);\n                }\n            }\n            zoomFactor = tempZoomFactor;\n            parent.setProperties({ zoomSettings: { zoomFactor: this.prevZoomValue } }, true);\n            var splitWords = void 0;\n            this.tempActiveObj = null;\n            this.isShape = false;\n            if (parent.activeObj.shape !== undefined) {\n                if (parent.activeObj.shape === 'shape') {\n                    parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                }\n                else {\n                    splitWords = parent.activeObj.shape.split('-');\n                }\n            }\n            if (splitWords !== undefined && splitWords[0] === 'crop') {\n                this.tempActiveObj = extend({}, parent.activeObj, {}, true);\n                parent.isCropTab = true;\n            }\n            else if (parent.activeObj.shape && splitWords[0] !== 'crop') {\n                this.isShape = true;\n            }\n            var obj = { zoomType: null };\n            parent.notify('selection', { prop: 'getZoomType', onPropertyChange: false, value: { obj: obj } });\n            if (isNullOrUndefined(zoomPoint)) {\n                if (parent.isCropTab && this.tempActiveObj) {\n                    zoomPoint = { x: parent.activeObj.activePoint.startX + (parent.activeObj.activePoint.width / 2),\n                        y: parent.activeObj.activePoint.startY + (parent.activeObj.activePoint.height / 2) };\n                }\n                else {\n                    zoomPoint = { x: parent.lowerCanvas.clientWidth / 2, y: parent.lowerCanvas.clientHeight / 2 };\n                }\n                if (obj['zoomType'] === 'MouseWheel' || obj['zoomType'] === 'Pinch') {\n                    zoomPoint = { x: parent.zoomSettings.zoomPoint.x, y: parent.zoomSettings.zoomPoint.y };\n                }\n            }\n            var previousZoomFactor = parent.zoomSettings.zoomFactor - (zoomFactor * 10);\n            var zoomEventArgs = { zoomPoint: zoomPoint, cancel: false, previousZoomFactor: previousZoomFactor,\n                currentZoomFactor: parent.zoomSettings.zoomFactor, zoomTrigger: obj['zoomType'] };\n            if (!parent.isCropToolbar && isBlazor() && parent.events && parent.events.zooming.hasDelegate === true) {\n                /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                parent.dotNetRef.invokeMethodAsync('ZoomEventAsync', 'OnZoom', zoomEventArgs).then(function (args) {\n                    _this.zoomEvent(args, zoomFactor);\n                });\n            }\n            else {\n                if (!parent.isCropToolbar) {\n                    parent.trigger('zooming', zoomEventArgs);\n                }\n                this.zoomEvent(zoomEventArgs, zoomFactor);\n            }\n        }\n    };\n    Transform.prototype.zoomEvent = function (zoomEventArgs, zoomFactor) {\n        var parent = this.parent;\n        if (zoomEventArgs.cancel) {\n            return;\n        }\n        if (!isBlazor()) {\n            parent.notify('toolbar', { prop: 'close-contextual-toolbar', onPropertyChange: false });\n        }\n        else if (parent.element.querySelector('.e-contextual-toolbar-wrapper') && !parent.element.querySelector('.e-contextual-toolbar-wrapper').classList.contains('e-hidden')) {\n            parent.updateToolbar(parent.element, 'closeContextualToolbar');\n        }\n        parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n            value: { x: null, y: null, isMouseDown: true } });\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        this.upperContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        var object = { canvasFilter: this.parent.canvasFilter };\n        this.lowerContext.filter = object['canvasFilter'];\n        parent.upperCanvas.style.cursor = parent.cursor = 'default';\n        var objColl = extend([], parent.objColl, [], true);\n        if (!parent.isCropTab) {\n            if (parent.transform.degree !== 0) {\n                parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                    value: { x: null, y: null, isMouseDown: null } });\n                parent.panPoint.currentPannedPoint = { x: 0, y: 0 };\n                this.rotatePan(true, true);\n            }\n            else if (parent.transform.currFlipState !== '') {\n                parent.panPoint.totalPannedPoint = { x: 0, y: 0 };\n            }\n            parent.notify('freehand-draw', { prop: 'updateFHDColl', onPropertyChange: false });\n        }\n        if (parent.transform.degree === 0) {\n            this.drawZoomImgToCanvas(zoomFactor, this.tempActiveObj);\n            var panObj_1 = { panRegion: '' };\n            parent.notify('crop', { prop: 'getCurrFlipState', onPropertyChange: false,\n                value: { panObj: panObj_1 } });\n            if (panObj_1['panRegion'] !== '') {\n                parent.notify('crop', { prop: 'setTempFlipPanPoint', onPropertyChange: false, value: { point: parent.panPoint.totalPannedPoint, isAdd: true } });\n                objColl = extend([], parent.objColl, [], true);\n                parent.objColl = [];\n                var destLeft = parent.img.destLeft;\n                var destTop = parent.img.destTop;\n                this.setDestPointsForFlipState();\n                this.rotatedFlip();\n                parent.img.destLeft = destLeft;\n                parent.img.destTop = destTop;\n                parent.objColl = objColl;\n                parent.notify('shape', { prop: 'zoomObjColl', onPropertyChange: false, value: { isPreventApply: null } });\n                parent.notify('freehand-draw', { prop: 'zoomFHDColl', onPropertyChange: false, value: { isPreventApply: null } });\n                parent.notify('freehand-draw', { prop: 'updateFHDColl', onPropertyChange: false });\n            }\n            if (parent.zoomSettings.zoomFactor <= parent.zoomSettings.minZoomFactor && !parent.isCropTab) {\n                parent.panPoint.totalPannedPoint = { x: 0, y: 0 };\n            }\n        }\n        else {\n            parent.notify('freehand-draw', { prop: 'updateFHDColl', onPropertyChange: false });\n            parent.panPoint.totalPannedClientPoint = { x: 0, y: 0 };\n            parent.panPoint.totalPannedInternalPoint = { x: 0, y: 0 };\n            this.rotateZoom(zoomFactor);\n            var panObj_2 = { panRegion: '' };\n            parent.notify('crop', { prop: 'getCurrFlipState', onPropertyChange: false,\n                value: { panObj: panObj_2 } });\n            if (panObj_2['panRegion'] !== '') {\n                var temp = this.lowerContext.filter;\n                this.lowerContext.filter = 'none';\n                parent.notify('shape', { prop: 'zoomObjColl', onPropertyChange: false, value: { isPreventApply: null } });\n                parent.notify('freehand-draw', { prop: 'zoomFHDColl', onPropertyChange: false, value: { isPreventApply: null } });\n                this.lowerContext.filter = temp;\n            }\n        }\n        var powerOften = Math.pow(10, 1);\n        if (parent.zoomSettings.zoomFactor <= parent.zoomSettings.minZoomFactor ||\n            (Math.round(parent.transform.zoomFactor * powerOften) / powerOften) === 2) {\n            clearInterval(this.zoomBtnHold);\n            this.zoomBtnHold = 0;\n        }\n        var panObj = { panRegion: '' };\n        parent.notify('crop', { prop: 'getCurrFlipState', onPropertyChange: false,\n            value: { panObj: panObj } });\n        if (panObj['panRegion'] === '') {\n            var temp = this.lowerContext.filter;\n            this.lowerContext.filter = 'none';\n            parent.notify('shape', { prop: 'zoomObjColl', onPropertyChange: false, value: { isPreventApply: null } });\n            parent.notify('freehand-draw', { prop: 'zoomFHDColl', onPropertyChange: false, value: { isPreventApply: null } });\n            this.lowerContext.filter = temp;\n        }\n        if ((parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle') || parent.isCircleCrop) {\n            parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                value: { context: this.lowerContext, isSave: null, isFlip: null } });\n        }\n        parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        if (this.tempActiveObj) {\n            parent.activeObj = extend({}, this.tempActiveObj, {}, true);\n            parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj } });\n            if (parent.zoomSettings.zoomFactor <= parent.zoomSettings.minZoomFactor) {\n                parent.currSelectionPoint = null;\n            }\n        }\n        parent.isUndoRedo = false;\n        var zoomOut;\n        if (!isBlazor()) {\n            zoomOut = document.querySelector('#' + parent.element.id + '_zoomOut');\n            if (zoomOut && parent.zoomSettings.zoomFactor <= parent.zoomSettings.minZoomFactor) {\n                zoomOut.classList.add('e-disabled');\n                zoomOut.parentElement.classList.add('e-overlay');\n            }\n            else if (zoomOut) {\n                zoomOut.classList.remove('e-disabled');\n                zoomOut.parentElement.classList.remove('e-overlay');\n            }\n        }\n        else {\n            zoomOut = parent.element.querySelector('#zoomout');\n            if (zoomOut && parent.zoomSettings.zoomFactor <= parent.zoomSettings.minZoomFactor) {\n                zoomOut.classList.add('e-overlay');\n            }\n            else if (zoomOut) {\n                zoomOut.classList.remove('e-overlay');\n            }\n        }\n        this.autoEnablePan();\n        if (this.tempActiveObj) {\n            parent.activeObj = extend({}, this.tempActiveObj, {}, true);\n        }\n        if (parent.activeObj.shape === 'crop-custom') {\n            parent.currObjType.isCustomCrop = true;\n        }\n        var panBtn = parent.element.querySelector('.e-img-pan .e-btn');\n        if (panBtn && parent.togglePan) {\n            panBtn.classList.add('e-selected-btn');\n        }\n        else if (panBtn) {\n            panBtn.classList.remove('e-selected-btn');\n        }\n        if (this.isShape) {\n            parent.activeObj = extend({}, parent.objColl[parent.objColl.length - 1], {}, true);\n            parent.objColl.pop();\n            parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj, isCropRatio: null,\n                    points: null, isPreventDrag: true, saveContext: null, isPreventSelection: null } });\n            if (!isBlazor()) {\n                parent.notify('toolbar', { prop: 'update-toolbar-items', onPropertyChange: false });\n                parent.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: null } });\n            }\n        }\n        if (!isBlazor()) {\n            parent.notify('toolbar', { prop: 'enable-disable-btns', onPropertyChange: false });\n        }\n        else {\n            parent.updateToolbar(parent.element, 'enableDisableToolbarBtn');\n        }\n        parent.notify('selection', { prop: 'setZoomType', onPropertyChange: false, value: { zoomType: 'Toolbar' } });\n    };\n    Transform.prototype.disableZoomOutBtn = function (isZoomOut) {\n        var parent = this.parent;\n        var isDisabled = false;\n        var zoomOut;\n        if (!isNullOrUndefined(isZoomOut)) {\n            parent.transform.zoomFactor -= 0.1;\n        }\n        if (!isBlazor()) {\n            zoomOut = document.querySelector('#' + parent.element.id + '_zoomOut');\n        }\n        else {\n            zoomOut = this.parent.element.querySelector('#zoomout');\n        }\n        var destLeft = parent.img.destLeft;\n        var destTop = parent.img.destTop;\n        var destWidth = parent.img.destWidth;\n        var destHeight = parent.img.destHeight;\n        if (parent.activeObj.shape) {\n            this.setZoomDimension(-0.1, parent.activeObj);\n            if (!isNullOrUndefined(zoomOut)) {\n                if (parent.img.destLeft > parent.activeObj.activePoint.startX || parent.img.destTop > parent.activeObj.activePoint.startY\n                    || parent.img.destLeft + parent.img.destWidth < parent.activeObj.activePoint.endX || parent.img.destTop +\n                    parent.img.destHeight < parent.activeObj.activePoint.endY || parent.zoomSettings.zoomFactor ===\n                    parent.zoomSettings.minZoomFactor) {\n                    if (!isBlazor()) {\n                        zoomOut.classList.add('e-disabled');\n                        zoomOut.parentElement.classList.add('e-overlay');\n                    }\n                    else {\n                        zoomOut.classList.add('e-overlay');\n                    }\n                    isDisabled = true;\n                }\n                else {\n                    if (!isBlazor()) {\n                        zoomOut.classList.remove('e-disabled');\n                        zoomOut.parentElement.classList.remove('e-overlay');\n                    }\n                    else {\n                        zoomOut.classList.remove('e-overlay');\n                    }\n                    isDisabled = false;\n                }\n            }\n        }\n        else {\n            this.setZoomDimension(-0.1, null);\n        }\n        if (!isNullOrUndefined(isZoomOut)) {\n            parent.transform.zoomFactor += 0.1;\n        }\n        parent.img.destLeft = destLeft;\n        parent.img.destTop = destTop;\n        parent.img.destWidth = destWidth;\n        parent.img.destHeight = destHeight;\n        return isDisabled;\n    };\n    Transform.prototype.drawZoomImgToCanvas = function (value, selectionObj) {\n        var parent = this.parent;\n        var powerOften = Math.pow(10, 1);\n        if ((Math.round(parent.transform.zoomFactor * powerOften) / powerOften) === 0.1 && value === -0.1) {\n            parent.transform.zoomFactor = 0;\n        }\n        else {\n            parent.transform.zoomFactor += value;\n        }\n        parent.transform[parent.isCropTab ? 'cropZoomFactor' : 'defaultZoomFactor'] = parent.transform.zoomFactor;\n        var maxDimension = { width: 0, height: 0 };\n        if (parent.isCropTab) {\n            maxDimension = this.cropZoom(value, selectionObj);\n        }\n        else {\n            maxDimension = this.calcMaxDimension(parent.img.srcWidth, parent.img.srcHeight);\n            maxDimension.width += (maxDimension.width * parent.transform.zoomFactor);\n            maxDimension.height += (maxDimension.height * parent.transform.zoomFactor);\n            parent.img.destLeft = (parent.lowerCanvas.clientWidth - maxDimension.width) / 2;\n            parent.img.destTop = (parent.lowerCanvas.clientHeight - maxDimension.height) / 2;\n        }\n        parent.notify('draw', { prop: 'draw-image-to-canvas', value: { dimension: maxDimension } });\n        maxDimension.width = this.cropDimension.width;\n        maxDimension.height = this.cropDimension.height;\n        maxDimension.width += (maxDimension.width * parent.transform.zoomFactor);\n        maxDimension.height += (maxDimension.height * parent.transform.zoomFactor);\n        parent.notify('draw', { prop: 'setZoomCropWidth', value: { width: maxDimension.width, height: maxDimension.height } });\n    };\n    Transform.prototype.rotatedFlip = function () {\n        var parent = this.parent;\n        this.isReverseFlip = true;\n        var tempCurrFlipState = parent.transform.currFlipState;\n        var tempFlipColl = this.flipColl;\n        var tempObjColl = extend([], parent.objColl, [], true);\n        var tempActiveObj = extend({}, parent.activeObj, {}, true);\n        this.flipColl = [];\n        parent.objColl = [];\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        parent.notify('draw', { prop: 'currTransState', onPropertyChange: false,\n            value: { type: 'initial', isPreventDestination: null, context: null, isPreventCircleCrop: null } });\n        var temp = this.lowerContext.filter;\n        parent.notify('filter', { prop: 'updateBrightFilter', onPropertyChange: false });\n        this.lowerContext.drawImage(parent.baseImg, parent.img.srcLeft, parent.img.srcTop, parent.img.srcWidth, parent.img.srcHeight, parent.img.destLeft, parent.img.destTop, parent.img.destWidth, parent.img.destHeight);\n        this.lowerContext.filter = temp;\n        parent.notify('draw', { prop: 'currTransState', onPropertyChange: false,\n            value: { type: 'reverse', isPreventDestination: true, context: null, isPreventCircleCrop: null } });\n        if (tempCurrFlipState === '' && parent.transform.currFlipState !== '') {\n            tempCurrFlipState = parent.transform.currFlipState;\n        }\n        parent.transform.currFlipState = tempCurrFlipState;\n        this.flipColl = tempFlipColl;\n        parent.objColl = extend([], tempObjColl, [], true);\n        this.lowerContext.filter = 'none';\n        parent.notify('shape', { prop: 'iterateObjColl', onPropertyChange: false });\n        this.lowerContext.filter = temp;\n        if (tempActiveObj.activePoint.width !== 0) {\n            parent.activeObj = extend({}, tempActiveObj, {}, true);\n        }\n        this.isReverseFlip = false;\n    };\n    Transform.prototype.rotateZoom = function (value) {\n        var parent = this.parent;\n        var powerOften = Math.pow(10, 1);\n        if ((Math.round(parent.transform.zoomFactor * powerOften) / powerOften) === 0.1 && value === -0.1) {\n            parent.transform.zoomFactor = 0;\n        }\n        else {\n            parent.transform.zoomFactor += value;\n        }\n        if (parent.isCropTab) {\n            parent.transform.cropZoomFactor = parent.transform.zoomFactor;\n        }\n        else {\n            parent.transform.defaultZoomFactor = parent.transform.zoomFactor;\n        }\n        var tempObjColl = extend([], parent.objColl, [], true);\n        var tempActiveObj = extend({}, parent.activeObj, {}, true);\n        parent.objColl = [];\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        parent.notify('draw', { prop: 'updateCurrTransState', onPropertyChange: false,\n            value: { type: 'initial', isPreventDestination: null, isRotatePan: null } });\n        parent.notify('draw', { prop: 'setRotateZoom', onPropertyChange: false, value: { isRotateZoom: true } });\n        parent.notify('draw', { prop: 'setDestPoints', onPropertyChange: false });\n        var temp = this.lowerContext.filter;\n        parent.notify('filter', { prop: 'updateBrightFilter', onPropertyChange: false });\n        this.lowerContext.drawImage(parent.baseImg, parent.img.srcLeft, parent.img.srcTop, parent.img.srcWidth, parent.img.srcHeight, parent.img.destLeft, parent.img.destTop, parent.img.destWidth, parent.img.destHeight);\n        this.lowerContext.filter = temp;\n        parent.notify('draw', { prop: 'setRotateZoom', onPropertyChange: false, value: { isRotateZoom: false } });\n        parent.notify('draw', { prop: 'updateCurrTransState', onPropertyChange: false,\n            value: { type: 'reverse', isPreventDestination: null, isRotatePan: null } });\n        parent.objColl = tempObjColl;\n        parent.activeObj = tempActiveObj;\n        var maxDimension = { width: this.cropDimension.width, height: this.cropDimension.height };\n        maxDimension.width += (maxDimension.width * parent.transform.zoomFactor);\n        maxDimension.height += (maxDimension.height * parent.transform.zoomFactor);\n        parent.notify('draw', { prop: 'setZoomCropWidth', value: { width: maxDimension.width, height: maxDimension.height } });\n    };\n    Transform.prototype.autoEnablePan = function () {\n        if (this.parent.transform.zoomFactor <= 0) {\n            this.parent.togglePan = false;\n            this.parent.notify('selection', { prop: 'setDragCanvas', value: { bool: false } });\n            this.parent.pan(false);\n            this.disablePan = false;\n        }\n        else {\n            this.parent.pan(!this.disablePan);\n        }\n    };\n    Transform.prototype.cropZoom = function (value, selectionObj) {\n        var parent = this.parent;\n        var destLeft = parent.img.destLeft;\n        var destTop = parent.img.destTop;\n        var maxDimension = { width: 0, height: 0 };\n        if (parent.img.srcLeft === 0 || parent.img.srcTop === 0) {\n            if (isNullOrUndefined(selectionObj)) {\n                maxDimension = this.setZoomDimension(value, null);\n            }\n            else {\n                maxDimension = this.setZoomDimension(value, selectionObj);\n            }\n        }\n        else {\n            if (parent.transform.degree % 90 === 0 && parent.transform.degree % 180 !== 0) {\n                maxDimension = this.calcMaxDimension(parent.img.srcHeight, parent.img.srcWidth);\n            }\n            else {\n                maxDimension = this.calcMaxDimension(parent.img.srcWidth, parent.img.srcHeight);\n            }\n            maxDimension.width += (maxDimension.width * parent.transform.zoomFactor);\n            maxDimension.height += (maxDimension.height * parent.transform.zoomFactor);\n        }\n        parent.img.destLeft = destLeft - ((maxDimension.width - parent.img.destWidth) / 2);\n        parent.img.destTop = destTop - ((maxDimension.height - parent.img.destHeight) / 2);\n        destLeft = parent.img.destLeft;\n        destTop = parent.img.destTop;\n        if (selectionObj) {\n            if (parent.img.destLeft > selectionObj.activePoint.startX) {\n                parent.img.destLeft = selectionObj.activePoint.startX;\n                if (parent.transform.degree === 0) {\n                    parent.panPoint.totalPannedPoint.x -= (destLeft - parent.img.destLeft);\n                }\n            }\n            if (parent.img.destTop > selectionObj.activePoint.startY) {\n                parent.img.destTop = selectionObj.activePoint.startY;\n                if (parent.transform.degree === 0) {\n                    parent.panPoint.totalPannedPoint.y -= (destTop - parent.img.destTop);\n                }\n            }\n            if (parent.img.destLeft + maxDimension.width < selectionObj.activePoint.endX) {\n                parent.img.destLeft = selectionObj.activePoint.endX - maxDimension.width;\n                if (parent.transform.degree === 0) {\n                    parent.panPoint.totalPannedPoint.x -= (destLeft - parent.img.destLeft);\n                }\n            }\n            if (parent.img.destTop + maxDimension.height < selectionObj.activePoint.endY) {\n                parent.img.destTop = selectionObj.activePoint.endY - maxDimension.height;\n                if (parent.transform.degree === 0) {\n                    parent.panPoint.totalPannedPoint.y -= (destTop - parent.img.destTop);\n                }\n            }\n        }\n        return maxDimension;\n    };\n    Transform.prototype.setZoomDimension = function (value, selectionObj) {\n        var parent = this.parent;\n        var maxDimension = { width: 0, height: 0 };\n        if (parent.transform.degree % 90 === 0 && parent.transform.degree % 180 !== 0) {\n            maxDimension = this.calcMaxDimension(parent.img.srcHeight, parent.img.srcWidth);\n        }\n        else {\n            maxDimension = this.calcMaxDimension(parent.img.srcWidth, parent.img.srcHeight);\n        }\n        maxDimension.width += (maxDimension.width * parent.transform.zoomFactor);\n        maxDimension.height += (maxDimension.height * parent.transform.zoomFactor);\n        parent.img.destLeft += ((parent.img.destWidth - maxDimension.width) / 2);\n        parent.img.destTop += ((parent.img.destHeight - maxDimension.height) / 2);\n        // While zoom out limit image to draw inside the selection range\n        if (value < 0 && selectionObj) {\n            var startX = selectionObj.activePoint.startX;\n            var startY = selectionObj.activePoint.startY;\n            var width = selectionObj.activePoint.width;\n            var height = selectionObj.activePoint.height;\n            var maxDestLeft = parent.img.destLeft + maxDimension.width;\n            var maxDestTop = parent.img.destTop + maxDimension.height;\n            if (parent.img.destLeft > startX) {\n                parent.img.destLeft = startX;\n            }\n            if (parent.img.destTop > startY) {\n                parent.img.destTop = startY;\n            }\n            if (maxDestLeft < startX + width) {\n                parent.img.destLeft = startX + width - maxDimension.width;\n            }\n            if (maxDestTop < startY + height) {\n                parent.img.destTop = startY + height - maxDimension.height;\n            }\n        }\n        else if (value < 0 && isNullOrUndefined(selectionObj)) {\n            if (parent.img.destLeft > 0) {\n                parent.img.destLeft = 0;\n            }\n            if (parent.img.destTop > 0) {\n                parent.img.destTop = 0;\n            }\n            if (parent.img.destLeft + maxDimension.width < parent.lowerCanvas.width) {\n                parent.img.destLeft = parent.lowerCanvas.width - parent.img.destWidth;\n            }\n            if (parent.img.destTop + maxDimension.height < parent.lowerCanvas.height) {\n                parent.img.destTop = parent.lowerCanvas.height - parent.img.destHeight;\n            }\n        }\n        return maxDimension;\n    };\n    Transform.prototype.drawPannedImage = function (xDiff, yDiff) {\n        var _this = this;\n        var parent = this.parent;\n        var obj = { panDown: null };\n        parent.notify('selection', { prop: 'getPanDown', onPropertyChange: false, value: { obj: obj } });\n        var panEventArgs = { startPoint: obj['panDown'], endPoint: this.panMove, cancel: false };\n        if (isBlazor() && isNullOrUndefined(this.parent.eventType) && parent.events && parent.events.onPanStart.hasDelegate === true) {\n            this.parent.eventType = 'pan';\n            this.parent.panEventArgs = panEventArgs;\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            parent.dotNetRef.invokeMethodAsync('PanEventAsync', 'OnPanStart', panEventArgs).then(function (args) {\n                _this.panEvent(args, xDiff, yDiff);\n            });\n        }\n        else {\n            parent.trigger('panning', panEventArgs);\n            this.panEvent(panEventArgs, xDiff, yDiff);\n        }\n    };\n    Transform.prototype.panEvent = function (panEventArgs, xDiff, yDiff) {\n        if (panEventArgs.cancel) {\n            return;\n        }\n        var parent = this.parent;\n        var isObjCreated = false;\n        if (parent.activeObj.shape && parent.activeObj.shape === 'shape') {\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        }\n        if (isNullOrUndefined(parent.activeObj.shape)) {\n            isObjCreated = true;\n            parent.activeObj.activePoint = { startX: parent.img.destLeft, startY: parent.img.destTop,\n                endX: parent.img.destLeft + parent.img.destWidth, endY: parent.img.destTop + parent.img.destHeight };\n            var startX = parent.activeObj.activePoint.startX;\n            var startY = parent.activeObj.activePoint.startY;\n            var endX = parent.activeObj.activePoint.endX;\n            var endY = parent.activeObj.activePoint.endY;\n            if (startX < 0) {\n                parent.activeObj.activePoint.startX = 0;\n            }\n            if (startY < 0) {\n                parent.activeObj.activePoint.startY = 0;\n            }\n            if (endX > parent.lowerCanvas.width) {\n                parent.activeObj.activePoint.endX =\n                    parent.lowerCanvas.width;\n            }\n            if (endY > parent.lowerCanvas.height) {\n                parent.activeObj.activePoint.endY =\n                    parent.lowerCanvas.height;\n            }\n            parent.activeObj.activePoint.width = parent.activeObj.activePoint.endX - parent.activeObj.activePoint.startX;\n            parent.activeObj.activePoint.height = parent.activeObj.activePoint.endY - parent.activeObj.activePoint.startY;\n            parent.activeObj.shape = 'crop-custom';\n            var obj = { strokeSettings: {} };\n            parent.notify('shape', { prop: 'getStrokeSettings', onPropertyChange: false,\n                value: { obj: obj } });\n            parent.activeObj.strokeSettings = obj['strokeSettings'];\n            parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: parent.activeObj.activePoint, obj: parent.activeObj,\n                    isMouseMove: null, x: null, y: null } });\n            parent.isCropTab = true;\n        }\n        if (parent.transform.degree === 0) {\n            var point = void 0;\n            if (isNullOrUndefined(xDiff) && isNullOrUndefined(yDiff)) {\n                point = this.updatePanPoints('');\n            }\n            else {\n                point = { x: xDiff, y: yDiff };\n            }\n            parent.panPoint.totalPannedPoint.x += point.x;\n            parent.panPoint.totalPannedPoint.y += point.y;\n            var tempSelectionObj = extend({}, parent.activeObj, {}, true);\n            var temp = this.lowerContext.filter;\n            this.drawPannImage(point);\n            this.lowerContext.filter = temp;\n            this.tempPanMove = extend({}, this.panMove, {}, true);\n            parent.activeObj = extend({}, tempSelectionObj, {}, true);\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            if (parent.activeObj.shape) {\n                parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj } });\n            }\n        }\n        else {\n            var tempFlipState = parent.transform.currFlipState;\n            parent.isCropTab = true;\n            if (isNullOrUndefined(xDiff) && isNullOrUndefined(yDiff)) {\n                parent.panPoint.currentPannedPoint = this.updatePanPoints('');\n            }\n            else {\n                parent.panPoint.currentPannedPoint = { x: xDiff, y: yDiff };\n            }\n            parent.transform.currFlipState = tempFlipState;\n            this.rotatePan();\n            parent.isCropTab = false;\n            this.tempPanMove = extend({}, this.panMove, {}, true);\n        }\n        if (isObjCreated) {\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            parent.isCropTab = false;\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        }\n    };\n    Transform.prototype.drawPannImage = function (point) {\n        var parent = this.parent;\n        var filter = this.lowerContext.filter;\n        var destPoints = { startX: parent.img.destLeft, startY: parent.img.destTop, width: parent.img.destWidth,\n            height: parent.img.destHeight };\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        parent.notify('draw', { prop: 'updateCurrTransState', onPropertyChange: false,\n            value: { type: 'initial', isPreventDestination: null, isRotatePan: null } });\n        parent.img.destLeft = destPoints.startX;\n        parent.img.destTop = destPoints.startY;\n        parent.img.destWidth = destPoints.width;\n        parent.img.destHeight = destPoints.height;\n        this.setDestPointsForFlipState();\n        parent.notify('filter', { prop: 'updateBrightFilter', onPropertyChange: false });\n        this.lowerContext.drawImage(parent.baseImg, parent.img.srcLeft, parent.img.srcTop, parent.img.srcWidth, parent.img.srcHeight, parent.img.destLeft, parent.img.destTop, parent.img.destWidth, parent.img.destHeight);\n        if ((parent.currSelectionPoint && parent.currSelectionPoint.shape === 'crop-circle') || parent.isCircleCrop) {\n            parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                value: { context: this.lowerContext, isSave: null, isFlip: true } });\n        }\n        this.lowerContext.filter = filter;\n        parent.notify('draw', { prop: 'updateCurrTransState', onPropertyChange: false,\n            value: { type: 'reverse', isPreventDestination: null, isRotatePan: null } });\n        parent.img.destLeft = destPoints.startX;\n        parent.img.destTop = destPoints.startY;\n        parent.img.destWidth = destPoints.width;\n        parent.img.destHeight = destPoints.height;\n        var temp = this.lowerContext.filter;\n        this.lowerContext.filter = 'none';\n        parent.notify('shape', { prop: 'panObjColl', onPropertyChange: false,\n            value: { xDiff: point.x, yDiff: point.y, panRegion: '' } });\n        parent.notify('freehand-draw', { prop: 'panFHDColl', onPropertyChange: false,\n            value: { xDiff: point.x, yDiff: point.y, panRegion: '' } });\n        this.lowerContext.filter = temp;\n        parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n        if (parent.isCircleCrop) {\n            parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                value: { context: this.lowerContext, isSave: null, isFlip: true } });\n        }\n    };\n    Transform.prototype.resetZoom = function () {\n        var parent = this.parent;\n        if (parent.transform.defaultZoomFactor !== 0) {\n            var isUndoRedo = parent.isUndoRedo;\n            var object = { currObj: {} };\n            parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n            this.transCurrObj = object['currObj'];\n            this.transCurrObj.objColl = extend([], parent.objColl, null, true);\n            this.transCurrObj.pointColl = extend({}, parent.pointColl, null, true);\n            this.transCurrObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n            var selPointCollObj = { selPointColl: null };\n            parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                value: { obj: selPointCollObj } });\n            this.transCurrObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n            parent.isUndoRedo = parent.isCropToolbar = true;\n            if (parent.transform.defaultZoomFactor > 0) {\n                this.zoomAction(-parent.transform.defaultZoomFactor);\n            }\n            else {\n                this.zoomAction(Math.abs(parent.transform.defaultZoomFactor));\n            }\n            parent.isCropToolbar = false;\n            parent.isUndoRedo = isUndoRedo;\n        }\n    };\n    Transform.prototype.performTransformation = function (text) {\n        var parent = this.parent;\n        var tempZoomFactor = parent.transform.defaultZoomFactor;\n        var isUndoRedo = parent.isUndoRedo;\n        var prevCropObj = extend({}, parent.cropObj, {}, true);\n        this.resetZoom();\n        this.updateTransform(text);\n        for (var i = 0, len = parent.objColl.length; i < len; i++) {\n            if (parent.objColl[i].flipObjColl.length > 0) {\n                var flipObjColl = { collection: parent.objColl[i].flipObjColl };\n                parent.notify('shape', { prop: 'alignRotateFlipColl', onPropertyChange: false,\n                    value: { collection: parent.objColl[i].flipObjColl, isRotateFlipCollection: null, obj: flipObjColl } });\n                parent.objColl[i].flipObjColl = flipObjColl['collection'];\n                if (parent.objColl[i].flipObjColl.length === 0) {\n                    parent.objColl[i].shapeFlip = '';\n                }\n            }\n        }\n        if (tempZoomFactor !== 0) {\n            parent.isUndoRedo = true;\n            this.zoomAction(tempZoomFactor);\n            parent.isUndoRedo = isUndoRedo;\n            var state = '';\n            if (text === 'rotateleft' || text === 'rotateright') {\n                state = 'rotate';\n            }\n            else if (text === 'horizontalflip' || text === 'verticalflip') {\n                state = 'flip';\n            }\n            parent.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                value: { operation: state, previousObj: this.transCurrObj, previousObjColl: this.transCurrObj.objColl,\n                    previousPointColl: this.transCurrObj.pointColl, previousSelPointColl: this.transCurrObj.selPointColl,\n                    previousCropObj: prevCropObj, previousText: null,\n                    currentText: null, previousFilter: null, isCircleCrop: null } });\n            this.transCurrObj = null;\n        }\n    };\n    Transform.prototype.updateTransform = function (text) {\n        switch (text.toLowerCase()) {\n            case 'rotateleft':\n                this.rotateImage(-90);\n                break;\n            case 'rotateright':\n                this.rotateImage(90);\n                break;\n            case 'horizontalflip':\n                this.flipImage(Direction.Horizontal);\n                break;\n            case 'verticalflip':\n                this.flipImage(Direction.Vertical);\n                break;\n        }\n    };\n    Transform.prototype.rotatePan = function (isCropSelection, isDefaultZoom) {\n        var parent = this.parent;\n        this.isReverseRotate = true;\n        var tempDegree = parent.transform.degree;\n        var rotatePanActiveObj;\n        var object = { selPointColl: null };\n        if (parent.activeObj.activePoint && parent.activeObj.shape) {\n            rotatePanActiveObj = extend({}, parent.activeObj, {}, true);\n        }\n        var tempObjColl = extend([], parent.objColl, [], true);\n        var tempPointColl = extend([], parent.pointColl, [], true);\n        parent.objColl = [];\n        parent.pointColl = [];\n        parent.freehandCounter = 0;\n        parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: object } });\n        var cropSelPointColl = object['selPointColl'];\n        parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n            value: { obj: { selPointColl: [] } } });\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        parent.notify('draw', { prop: 'setRotateZoom', onPropertyChange: false, value: { isRotateZoom: true } });\n        parent.notify('draw', { prop: 'updateCurrTransState', onPropertyChange: false,\n            value: { type: 'initial', isPreventDestination: null, isRotatePan: null } });\n        var initialDestLeft = parent.img.destLeft;\n        var initialDestTop = parent.img.destTop;\n        if (parent.isCropTab) {\n            parent.img.destLeft += parent.panPoint.totalPannedInternalPoint.x;\n            parent.img.destTop += parent.panPoint.totalPannedInternalPoint.y;\n        }\n        parent.notify('crop', { prop: 'updateRotatePan', onPropertyChange: false });\n        if (parent.isCropTab) {\n            parent.panPoint.totalPannedInternalPoint.x = parent.img.destLeft - initialDestLeft;\n            parent.panPoint.totalPannedInternalPoint.y = parent.img.destTop - initialDestTop;\n        }\n        var temp = this.lowerContext.filter;\n        parent.notify('filter', { prop: 'updateBrightFilter', onPropertyChange: false });\n        this.lowerContext.drawImage(parent.baseImg, parent.img.srcLeft, parent.img.srcTop, parent.img.srcWidth, parent.img.srcHeight, parent.img.destLeft, parent.img.destTop, parent.img.destWidth, parent.img.destHeight);\n        parent.notify('draw', { prop: 'setRotateZoom', onPropertyChange: false, value: { isRotateZoom: false } });\n        parent.notify('draw', { prop: 'updateCurrTransState', onPropertyChange: false,\n            value: { type: 'reverse', isPreventDestination: true, isRotatePan: true } });\n        var destLeft = parent.img.destLeft;\n        var destTop = parent.img.destTop;\n        parent.img.destLeft += parent.panPoint.totalPannedClientPoint.x;\n        parent.img.destTop += parent.panPoint.totalPannedClientPoint.y;\n        parent.img.destLeft += parent.panPoint.currentPannedPoint.x;\n        parent.img.destTop += parent.panPoint.currentPannedPoint.y;\n        parent.panPoint.totalPannedClientPoint.x = parent.img.destLeft - destLeft;\n        parent.panPoint.totalPannedClientPoint.y =\n            parent.img.destTop - destTop;\n        parent.objColl = tempObjColl;\n        parent.pointColl = tempPointColl;\n        parent.freehandCounter = parent.pointColl.length;\n        parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n            value: { obj: { selPointColl: cropSelPointColl } } });\n        parent.transform.degree = tempDegree;\n        this.lowerContext.filter = 'none';\n        if (isCropSelection) {\n            if (isDefaultZoom) {\n                parent.panPoint.totalPannedClientPoint.x = -parent.panPoint.totalPannedClientPoint.x;\n                parent.panPoint.totalPannedClientPoint.y = -parent.panPoint.totalPannedClientPoint.y;\n                parent.panPoint.currentPannedPoint = extend({}, parent.panPoint.totalPannedClientPoint, {}, true);\n                parent.panPoint.totalPannedClientPoint = { x: 0, y: 0 };\n                parent.img.destLeft += parent.panPoint.currentPannedPoint.x;\n                parent.img.destTop += parent.panPoint.currentPannedPoint.y;\n            }\n            else {\n                parent.panPoint.currentPannedPoint = extend({}, parent.panPoint.totalPannedClientPoint, {}, true);\n            }\n        }\n        parent.notify('shape', { prop: 'panObjColl', onPropertyChange: false,\n            value: { xDiff: parent.panPoint.currentPannedPoint.x, yDiff: parent.panPoint.currentPannedPoint.y, panRegion: '' } });\n        parent.notify('freehand-draw', { prop: 'panFHDColl', onPropertyChange: false,\n            value: { xDiff: parent.panPoint.currentPannedPoint.x, yDiff: parent.panPoint.currentPannedPoint.y, panRegion: '' } });\n        this.lowerContext.filter = temp;\n        parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        parent.activeObj = extend({}, rotatePanActiveObj, {}, true);\n        if (parent.activeObj.activePoint) {\n            parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj, isCropRatio: null,\n                    points: null, isPreventDrag: true, saveContext: null, isPreventSelection: null } });\n        }\n        this.isReverseRotate = false;\n    };\n    Transform.prototype.limitPan = function () {\n        var parent = this.parent;\n        if (parent.activeObj.activePoint) {\n            if (parent.img.destLeft > parent.activeObj.activePoint.startX) {\n                parent.img.destLeft = parent.activeObj.activePoint.startX;\n            }\n            if (parent.img.destTop > parent.activeObj.activePoint.startY) {\n                parent.img.destTop = parent.activeObj.activePoint.startY;\n            }\n            if (parent.img.destLeft + parent.img.destWidth < parent.activeObj.activePoint.endX) {\n                parent.img.destLeft = parent.activeObj.activePoint.endX - parent.img.destWidth;\n            }\n            if (parent.img.destTop + parent.img.destHeight < parent.activeObj.activePoint.endY) {\n                parent.img.destTop = parent.activeObj.activePoint.endY - parent.img.destHeight;\n            }\n        }\n    };\n    Transform.prototype.updateFlipActiveObj = function (panRegion) {\n        var parent = this.parent;\n        if (panRegion === 'horizontal') {\n            if (parent.activeObj.activePoint.startX > parent.lowerCanvas.width / 2) {\n                parent.activeObj.activePoint.endX = (parent.lowerCanvas.width / 2) -\n                    (parent.activeObj.activePoint.startX - (parent.lowerCanvas.width / 2));\n            }\n            else {\n                parent.activeObj.activePoint.endX = (parent.lowerCanvas.width / 2) + ((parent.lowerCanvas.width / 2) -\n                    parent.activeObj.activePoint.startX);\n            }\n            parent.activeObj.activePoint.startX = parent.activeObj.activePoint.endX - parent.activeObj.activePoint.width;\n        }\n        else if (panRegion === 'vertical') {\n            if (parent.activeObj.activePoint.startX > parent.lowerCanvas.width / 2) {\n                parent.activeObj.activePoint.endY = (parent.lowerCanvas.height / 2) -\n                    (parent.activeObj.activePoint.startY - (parent.lowerCanvas.height / 2));\n            }\n            else {\n                parent.activeObj.activePoint.endY = (parent.lowerCanvas.height / 2) +\n                    ((parent.lowerCanvas.height / 2) - parent.activeObj.activePoint.startY);\n            }\n            parent.activeObj.activePoint.startY = parent.activeObj.activePoint.endY - parent.activeObj.activePoint.height;\n        }\n        else if (panRegion === 'verticalHorizontal' || panRegion === 'horizontalVertical') {\n            if (parent.activeObj.activePoint.startX > parent.lowerCanvas.width / 2) {\n                parent.activeObj.activePoint.endX = (parent.lowerCanvas.width / 2) -\n                    (parent.activeObj.activePoint.startX - (parent.lowerCanvas.width / 2));\n                parent.activeObj.activePoint.endY = (parent.lowerCanvas.height / 2) -\n                    (parent.activeObj.activePoint.startY - (parent.lowerCanvas.height / 2));\n            }\n            else {\n                parent.activeObj.activePoint.endX = (parent.lowerCanvas.width / 2) + ((parent.lowerCanvas.width / 2) -\n                    parent.activeObj.activePoint.startX);\n                parent.activeObj.activePoint.endY = (parent.lowerCanvas.height / 2) +\n                    ((parent.lowerCanvas.height / 2) - parent.activeObj.activePoint.startY);\n            }\n            parent.activeObj.activePoint.startX = parent.activeObj.activePoint.endX - parent.activeObj.activePoint.width;\n            parent.activeObj.activePoint.startY = parent.activeObj.activePoint.endY - parent.activeObj.activePoint.height;\n        }\n        parent.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: parent.activeObj.activePoint, obj: parent.activeObj,\n                isMouseMove: null, x: null, y: null } });\n    };\n    Transform.prototype.pan = function (value) {\n        var parent = this.parent;\n        if (!parent.disabled && parent.isImageLoaded) {\n            if (value) {\n                parent.togglePan = true;\n                parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                    value: { x: null, y: null, isMouseDown: null } });\n                parent.notify('selection', { prop: 'setDragCanvas', value: { bool: true } });\n                parent.lowerCanvas.style.cursor = parent.upperCanvas.style.cursor = parent.cursor = 'grab';\n                parent.notify('selection', { prop: 'setPanDown', onPropertyChange: false, value: { panDown: null } });\n            }\n            else {\n                parent.togglePan = parent.currObjType.isCustomCrop = false;\n                parent.notify('selection', { prop: 'setDragCanvas', value: { bool: false } });\n                parent.lowerCanvas.style.cursor = parent.upperCanvas.style.cursor = parent.cursor = 'default';\n            }\n        }\n    };\n    Transform.prototype.zoom = function (zoomFactor, zoomPoint) {\n        var parent = this.parent;\n        if (!parent.disabled && parent.isImageLoaded) {\n            var value = this.getCurrentZoomFactor(zoomFactor);\n            if (isNullOrUndefined(zoomPoint)) {\n                this.zoomAction(value, zoomPoint);\n            }\n            else {\n                var type = value > 0 ? 'zoomIn' : 'zoomOut';\n                for (var i = 0; i < (Math.abs(value) * 10); i++) {\n                    parent.notify('draw', { prop: 'performPointZoom', onPropertyChange: false,\n                        value: { x: zoomPoint.x, y: zoomPoint.y, type: type } });\n                }\n            }\n        }\n    };\n    Transform.prototype.getCurrentZoomFactor = function (zoomFactor) {\n        return (zoomFactor - this.prevZoomValue) * 0.1;\n    };\n    Transform.prototype.setCurrPanRegion = function (region, type, obj) {\n        var panRegion = region;\n        if (region === '') {\n            if (type === 'horizontal') {\n                panRegion = 'horizontal';\n            }\n            else if (type === 'vertical') {\n                panRegion = 'vertical';\n            }\n        }\n        else if (region === 'horizontal') {\n            if (type === 'horizontal') {\n                panRegion = 'horizontalVertical';\n            }\n            else if (type === 'vertical') {\n                panRegion = 'verticalHorizontal';\n            }\n            else if (type === 90) {\n                panRegion = 'vertical';\n            }\n            else if (type === -90) {\n                panRegion = 'horizontal';\n            }\n        }\n        else if (region === 'vertical') {\n            if (type === 'horizontal') {\n                panRegion = 'horizontalVertical';\n            }\n            else if (type === 'vertical') {\n                panRegion = 'verticalHorizontal';\n            }\n            else if (type === 90) {\n                panRegion = 'horizontal';\n            }\n            else if (type === -90) {\n                panRegion = 'vertical';\n            }\n        }\n        else {\n            if (type === 'horizontal') {\n                panRegion = 'vertical';\n            }\n            else if (type === 'vertical') {\n                panRegion = 'horizontal';\n            }\n        }\n        obj['panRegion'] = panRegion;\n    };\n    Transform.prototype.rotate = function (degree, obj) {\n        var parent = this.parent;\n        var isRotate = false;\n        if (!parent.disabled && parent.isImageLoaded && (degree % 90 === 0)) {\n            this.rotateImage(degree);\n        }\n        obj['isRotate'] = isRotate;\n    };\n    Transform.prototype.flip = function (direction) {\n        var parent = this.parent;\n        if (!parent.disabled && parent.isImageLoaded) {\n            this.flipImage(direction);\n        }\n    };\n    Transform.prototype.update = function () {\n        var parent = this.parent;\n        var toolbarHeight = 0;\n        var isActiveObj = false;\n        var freehandObj = { bool: false };\n        if (parent.isImageLoaded) {\n            if ((parent.element.querySelector('#' + parent.element.id + '_contextualToolbar') &&\n                !parent.element.querySelector('#' + parent.element.id + '_contextualToolbar').parentElement.classList.contains('e-hide')) ||\n                (parent.element.querySelector('#' + parent.element.id + '_headWrapper')\n                    && !parent.element.querySelector('#' + parent.element.id + '_headWrapper').parentElement.classList.contains('e-hide'))) {\n                parent.element.querySelector('.e-contextual-toolbar-wrapper').classList.add('e-hide');\n                parent.okBtn();\n                if (!isBlazor()) {\n                    parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n                    parent.notify('toolbar', { prop: 'destroy-qa-toolbar', onPropertyChange: false });\n                }\n                else {\n                    parent.updateToolbar(parent.element, 'imageLoaded');\n                }\n            }\n            parent.notify('selection', { prop: 'getFreehandDrawEditing', onPropertyChange: false, value: { obj: freehandObj } });\n            if (freehandObj['bool']) {\n                if (!isBlazor()) {\n                    parent.notify('toolbar', { prop: 'destroy-qa-toolbar', onPropertyChange: false });\n                }\n                else {\n                    parent.updateToolbar(parent.element, 'destroyQuickAccessToolbar');\n                }\n            }\n            if (parent.activeObj.shape !== undefined) {\n                isActiveObj = true;\n                if (parent.textArea.style.display === 'block') {\n                    parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                        value: { x: null, y: null, isMouseDown: null } });\n                    if (!isBlazor()) {\n                        parent.notify('toolbar', { prop: 'destroy-qa-toolbar', onPropertyChange: false });\n                    }\n                    else {\n                        parent.updateToolbar(parent.element, 'destroyQuickAccessToolbar');\n                    }\n                }\n                else {\n                    parent.notify('shape', { prop: 'updImgRatioForActObj', onPropertyChange: false });\n                    parent.objColl.push(parent.activeObj);\n                }\n                parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            }\n        }\n        var tempFilter = this.lowerContext.filter;\n        var canvasWrapper = document.querySelector('#' + parent.element.id + '_canvasWrapper');\n        if (canvasWrapper) {\n            canvasWrapper.style.width = parent.element.offsetWidth - 2 + 'px';\n        }\n        parent.lowerCanvas.width = parent.upperCanvas.width = parent.element.offsetWidth - 2;\n        if (parent.toolbarTemplate) {\n            toolbarHeight = parent.element.querySelector('#' + parent.element.id + '_toolbarArea').clientHeight;\n        }\n        else if (parent.element.querySelector('#' + parent.element.id + '_toolbar')) {\n            toolbarHeight = parent.element.querySelector('#' + parent.element.id + '_toolbar').clientHeight;\n        }\n        parent.notify('toolbar', { prop: 'setToolbarHeight', value: { height: toolbarHeight } });\n        if (Browser.isDevice) {\n            if (canvasWrapper) {\n                canvasWrapper.style.height = parent.element.offsetHeight - (2 * toolbarHeight) - 5 + 'px';\n            }\n            parent.lowerCanvas.height = parent.upperCanvas.height = parent.element.offsetHeight - (2 * toolbarHeight) - 5;\n        }\n        else {\n            if (canvasWrapper) {\n                canvasWrapper.style.height = parent.element.offsetHeight - toolbarHeight - 3 + 'px';\n            }\n            parent.lowerCanvas.height = parent.upperCanvas.height = parent.element.offsetHeight - toolbarHeight - 3;\n        }\n        this.lowerContext.filter =\n            'brightness(' + 1 + ') ' + 'contrast(' + 100 + '%) ' + 'hue-rotate(' + 0 + 'deg) ' +\n                'saturate(' + 100 + '%) ' + 'opacity(' + 1 + ') ' + 'blur(' + 0 + 'px) ' + 'sepia(0%) ' + 'grayscale(0%) ' + 'invert(0%)';\n        parent.notify('filter', { prop: 'setAdjustmentValue', onPropertyChange: false, value: { adjustmentValue: this.lowerContext.filter } });\n        parent.canvasFilter = this.lowerContext.filter;\n        this.parent.initialAdjustmentValue = this.lowerContext.filter;\n        parent.clearContext(this.lowerContext);\n        this.parent.clearContext(this.upperContext);\n        if (parent.isImageLoaded) {\n            parent.notify('shape', { prop: 'applyActObj', onPropertyChange: false, value: { isMouseDown: null } });\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            this.lowerContext.filter = tempFilter;\n            parent.initialAdjustmentValue = tempFilter;\n            parent.canvasFilter = this.lowerContext.filter;\n            if (parent.isImageLoaded) {\n                showSpinner(parent.element);\n                parent.element.style.opacity = '0.5';\n            }\n            this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            if (canvasWrapper) {\n                canvasWrapper.style.width = parent.element.offsetWidth - 2 + 'px';\n                canvasWrapper.style.height = parent.element.offsetHeight + 'px';\n                var obj_1 = { toolbarHeight: !isBlazor() ? 0 : parent.toolbarHeight };\n                if (!isBlazor()) {\n                    parent.notify('toolbar', { prop: 'getToolbarHeight', value: { obj: obj_1 } });\n                }\n                if (Browser.isDevice) {\n                    canvasWrapper.style.height = (parseFloat(canvasWrapper.style.height) - (2 * obj_1['toolbarHeight'])) - 3 + 'px';\n                }\n                else {\n                    canvasWrapper.style.height = (parseFloat(canvasWrapper.style.height) - obj_1['toolbarHeight']) - 3 + 'px';\n                }\n            }\n            var obj = { width: 0, height: 0 };\n            parent.notify('transform', { prop: 'calcMaxDimension', onPropertyChange: false,\n                value: { width: parent.img.srcWidth, height: parent.img.srcHeight, obj: obj } });\n            var maxDimension = obj;\n            if (parent.transform.defaultZoomFactor > 0) {\n                maxDimension.width += (maxDimension.width * parent.transform.defaultZoomFactor);\n                maxDimension.height += (maxDimension.height * parent.transform.defaultZoomFactor);\n            }\n            parent.img.destLeft = (parent.lowerCanvas.clientWidth - maxDimension.width) / 2;\n            parent.img.destTop = (parent.lowerCanvas.clientHeight - maxDimension.height) / 2;\n            if (parent.transform.degree === 0 && parent.transform.currFlipState === '') {\n                if (parent.transform.defaultZoomFactor > 0) {\n                    parent.img.destLeft += parent.panPoint.totalPannedPoint.x;\n                    parent.img.destTop += parent.panPoint.totalPannedPoint.y;\n                }\n                parent.notify('draw', { prop: 'draw-image-to-canvas', value: { dimension: maxDimension } });\n            }\n            else {\n                parent.notify('draw', { prop: 'draw-image-to-canvas', value: { dimension: maxDimension } });\n                parent.notify('draw', { prop: 'updateCurrTransState', onPropertyChange: false,\n                    value: { type: 'initial', isPreventDestination: null, isRotatePan: null } });\n                var temp = this.lowerContext.filter;\n                parent.notify('filter', { prop: 'updateBrightFilter', onPropertyChange: false });\n                this.lowerContext.drawImage(parent.baseImg, parent.img.srcLeft, parent.img.srcTop, parent.img.srcWidth, parent.img.srcHeight, parent.img.destLeft, parent.img.destTop, parent.img.destWidth, parent.img.destHeight);\n                this.lowerContext.filter = temp;\n                parent.notify('draw', { prop: 'updateCurrTransState', onPropertyChange: false,\n                    value: { type: 'reverse', isPreventDestination: null, isRotatePan: null } });\n            }\n            parent.notify('shape', { prop: 'zoomObjColl', onPropertyChange: false, value: { isPreventApply: null } });\n            parent.notify('freehand-draw', { prop: 'zoomFHDColl', onPropertyChange: false, value: { isPreventApply: null } });\n            if (parent.isCircleCrop) {\n                parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                    value: { context: this.lowerContext, isSave: null, isFlip: null } });\n            }\n            hideSpinner(parent.element);\n            parent.element.style.opacity = '1';\n            var obj1 = { defToolbarItems: null };\n            if (!isBlazor()) {\n                parent.notify('toolbar', { prop: 'getDefToolbarItems', value: { obj: obj1 } });\n                if (obj1['defToolbarItems'] && obj1['defToolbarItems'].length > 0 && document.getElementById(parent.element.id + '_toolbar')) {\n                    /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                    var toolbar_1 = getComponent(parent.element.id + '_toolbar', 'toolbar');\n                    toolbar_1.refreshOverflow();\n                    if (parent.element.querySelector('.e-contextual-toolbar-wrapper')) {\n                        parent.element.querySelector('.e-contextual-toolbar-wrapper').classList.add('e-hide');\n                    }\n                }\n            }\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n            if (isActiveObj) {\n                parent.activeObj = extend({}, parent.objColl[parent.objColl.length - 1], null, true);\n                parent.objColl.pop();\n                if (parent.activeObj.activePoint.width !== 0 && parent.activeObj.activePoint.height !== 0) {\n                    parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj } });\n                    if (parent.activeObj.shape === 'rectangle' || parent.activeObj.shape === 'ellipse' || parent.activeObj.shape === 'text' ||\n                        parent.activeObj.shape === 'line' || parent.activeObj.shape === 'arrow' || parent.activeObj.shape === 'path') {\n                        if (!isBlazor()) {\n                            parent.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: null } });\n                        }\n                        else {\n                            parent.updateToolbar(parent.element, 'quickAccessToolbar', parent.activeObj.shape);\n                        }\n                    }\n                }\n            }\n            if (freehandObj['bool']) {\n                if (!isBlazor()) {\n                    parent.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: true } });\n                }\n                else {\n                    parent.updateToolbar(parent.element, 'quickAccessToolbar', 'pen');\n                }\n            }\n            if ((parent.transform.degree !== 0 || parent.transform.currFlipState !== '') && parent.transform.defaultZoomFactor > 0) {\n                var totalPannedPoint = extend({}, parent.panPoint.totalPannedPoint, null, true);\n                var totalPannedInternalPoint = extend({}, parent.panPoint.totalPannedInternalPoint, null, true);\n                var totalPannedClientPoint = extend({}, parent.panPoint.totalPannedClientPoint, null, true);\n                parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                    value: { zoomFactor: .1, zoomPoint: null } });\n                parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                    value: { zoomFactor: -.1, zoomPoint: null } });\n                if (parent.transform.degree === 0) {\n                    parent.img.destLeft += totalPannedPoint.x;\n                    parent.img.destTop += totalPannedPoint.y;\n                    parent.panPoint.totalPannedPoint = totalPannedPoint;\n                    parent.notify('draw', { prop: 'updateFlipPan', value: { tempSelectionObj: null } });\n                }\n                else {\n                    parent.panPoint.totalPannedInternalPoint = totalPannedInternalPoint;\n                    parent.panPoint.totalPannedClientPoint = totalPannedClientPoint;\n                    parent.panPoint.currentPannedPoint = { x: 0, y: 0 };\n                    parent.isCropTab = true;\n                    parent.notify('transform', { prop: 'rotatePan', onPropertyChange: false,\n                        value: { isCropSelection: null, isDefaultZoom: null } });\n                    parent.isCropTab = false;\n                }\n            }\n            else if (parent.transform.degree !== 0 && parent.transform.cropZoomFactor > 0) {\n                parent.transform.zoomFactor = 0;\n                parent.transform.cropZoomFactor = null;\n                if (!isBlazor()) {\n                    parent.notify('toolbar', { prop: 'enable-disable-btns', onPropertyChange: false });\n                }\n                else {\n                    parent.updateToolbar(parent.element, 'enableDisableToolbarBtn');\n                }\n            }\n        }\n    };\n    Transform.prototype.calcMaxDimension = function (width, height, obj) {\n        var object = { toolbarHeight: 0 };\n        if (!isBlazor()) {\n            this.parent.notify('toolbar', { prop: 'getToolbarHeight', value: { obj: object } });\n        }\n        else {\n            object['toolbarHeight'] = this.parent.toolbarHeight;\n        }\n        var canvasMaxWidth = this.parent.element.clientWidth;\n        var canvasMaxHeight = this.parent.element.clientHeight - object['toolbarHeight'];\n        canvasMaxHeight = Browser.isDevice ? canvasMaxHeight - object['toolbarHeight'] : canvasMaxHeight;\n        if (canvasMaxWidth > 30) {\n            canvasMaxWidth -= 30;\n        }\n        if (canvasMaxHeight > 30) {\n            canvasMaxHeight -= 30;\n        }\n        var widthScale = canvasMaxWidth / width;\n        var heightScale = canvasMaxHeight / height;\n        var cssMaxWidth = Math.min(width, canvasMaxWidth);\n        var cssMaxHeight = Math.min(height, canvasMaxHeight);\n        if (widthScale < 1 && widthScale < heightScale) {\n            cssMaxWidth = width * widthScale;\n            cssMaxHeight = height * widthScale;\n        }\n        else if (heightScale < 1 && heightScale < widthScale) {\n            cssMaxWidth = width * heightScale;\n            cssMaxHeight = height * heightScale;\n        }\n        var cropObj = { bool: null };\n        this.parent.notify('crop', { prop: 'getPreventScaling', onPropertyChange: false,\n            value: { obj: cropObj } });\n        if (cropObj['bool'] && this.parent.cropObj.activeObj.activePoint &&\n            this.parent.cropObj.activeObj.activePoint.width !== 0 && this.parent.cropObj.activeObj.activePoint.height !== 0) {\n            cssMaxWidth = this.parent.cropObj.activeObj.activePoint.width;\n            cssMaxHeight = this.parent.cropObj.activeObj.activePoint.height;\n        }\n        if (obj) {\n            obj['width'] = cssMaxWidth;\n            obj['height'] = cssMaxHeight;\n        }\n        return { width: cssMaxWidth, height: cssMaxHeight };\n    };\n    Transform.prototype.updatePanPoints = function (panRegion, obj) {\n        var parent = this.parent;\n        var tempActObj = extend({}, parent.activeObj, {}, true);\n        var tempDestLeft = parent.img.destLeft;\n        var tempDestTop = parent.img.destTop;\n        if (isNullOrUndefined(this.tempPanMove)) {\n            this.tempPanMove = { x: this.panMove.x, y: this.panMove.y };\n        }\n        var xDiff = this.panMove.x - this.tempPanMove.x;\n        var yDiff = this.panMove.y - this.tempPanMove.y;\n        switch (panRegion) {\n            case '':\n                parent.img.destLeft += xDiff;\n                parent.img.destTop += yDiff;\n                break;\n            case 'horizontal':\n                this.updateFlipActiveObj(panRegion);\n                xDiff = this.tempPanMove.x - this.panMove.x;\n                parent.img.destLeft += xDiff;\n                parent.img.destTop += yDiff;\n                break;\n            case 'vertical':\n                this.updateFlipActiveObj(panRegion);\n                yDiff = this.tempPanMove.y - this.panMove.y;\n                parent.img.destLeft += xDiff;\n                parent.img.destTop += yDiff;\n                break;\n            case 'horizontalVertical':\n                this.updateFlipActiveObj(panRegion);\n                xDiff = this.tempPanMove.x - this.panMove.x;\n                parent.img.destLeft += xDiff;\n                parent.img.destTop -= yDiff;\n                break;\n            case 'verticalHorizontal':\n                this.updateFlipActiveObj(panRegion);\n                yDiff = this.tempPanMove.y - this.panMove.y;\n                parent.img.destLeft -= xDiff;\n                parent.img.destTop += yDiff;\n                break;\n        }\n        this.limitPan();\n        parent.activeObj = tempActObj;\n        if (obj) {\n            obj['x'] = parent.img.destLeft - tempDestLeft;\n            obj['y'] = parent.img.destTop - tempDestTop;\n        }\n        return { x: parent.img.destLeft - tempDestLeft, y: parent.img.destTop - tempDestTop };\n    };\n    return Transform;\n}());\nexport { Transform };\n","import { isNullOrUndefined, extend, isBlazor } from '@syncfusion/ej2-base';\nvar UndoRedo = /** @class */ (function () {\n    function UndoRedo(parent) {\n        this.undoRedoStep = 0;\n        this.undoRedoColl = [];\n        this.appliedUndoRedoColl = [];\n        this.tempUndoRedoColl = [];\n        this.tempUndoRedoStep = 0;\n        this.parent = parent;\n        this.addEventListener();\n    }\n    UndoRedo.prototype.destroy = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.removeEventListener();\n    };\n    UndoRedo.prototype.addEventListener = function () {\n        this.parent.on('undo-redo', this.undoRedo, this);\n        this.parent.on('destroyed', this.destroy, this);\n    };\n    UndoRedo.prototype.removeEventListener = function () {\n        this.parent.off('undo-redo', this.undoRedo);\n        this.parent.off('destroyed', this.destroy);\n    };\n    UndoRedo.prototype.initializeUrPvtProp = function () {\n        if (this.parent.lowerCanvas) {\n            this.lowerContext = this.parent.lowerCanvas.getContext('2d');\n        }\n        if (this.parent.upperCanvas) {\n            this.upperContext = this.parent.upperCanvas.getContext('2d');\n        }\n    };\n    UndoRedo.prototype.undoRedo = function (args) {\n        this.initializeUrPvtProp();\n        switch (args.prop) {\n            case 'updateUndoRedoColl':\n                this.updateUrc(args.value['operation'], args.value['previousObj'], args.value['previousObjColl'], args.value['previousPointColl'], args.value['previousSelPointColl'], args.value['previousCropObj'], args.value['previousText'], args.value['currentText'], args.value['previousFilter'], args.value['isCircleCrop']);\n                break;\n            case 'refreshUrc':\n                this.refreshUrc(args.value['bool']);\n                break;\n            case 'updateCurrUrc':\n                this.updateCurrUrc(args.value['type']);\n                break;\n            case 'call-undo':\n                this.callUndo();\n                break;\n            case 'call-redo':\n                this.callRedo();\n                break;\n            case 'undo':\n                this.undo();\n                break;\n            case 'redo':\n                this.redo();\n                break;\n            case 'updateUrObj':\n                this.updateUrObj(args.value['objColl']);\n                break;\n            case 'updateUndoRedo':\n                this.updateUndoRedo();\n                break;\n            case 'getAppliedUndoRedoColl':\n                args.value['obj']['appliedUndoRedoColl'] = this.appliedUndoRedoColl;\n                break;\n            case 'getUndoRedoStep':\n                args.value['obj']['undoRedoStep'] = this.undoRedoStep;\n                break;\n            case 'setUndoRedoStep':\n                this.undoRedoStep = args.value['step'];\n                break;\n            case 'undoDefault':\n                this.undoDefault(args.value['obj']);\n                break;\n            case 'reset':\n                this.reset();\n                break;\n        }\n    };\n    UndoRedo.prototype.getModuleName = function () {\n        return 'undo-redo';\n    };\n    UndoRedo.prototype.reset = function () {\n        this.tempCurrSelPoint = null;\n        this.undoRedoStep = 0;\n        this.undoRedoColl = [];\n        this.appliedUndoRedoColl = [];\n        this.tempActObj = null;\n        this.tempUndoRedoColl = [];\n        this.tempUndoRedoStep = 0;\n    };\n    UndoRedo.prototype.refreshUrc = function (refreshToolbar) {\n        var parent = this.parent;\n        refreshToolbar = refreshToolbar ? refreshToolbar : false;\n        if (refreshToolbar) {\n            if (!isBlazor()) {\n                parent.notify('toolbar', { prop: 'setEnableDisableUndoRedo', value: { isPrevent: true } });\n            }\n            this.tempUndoRedoColl = extend([], this.appliedUndoRedoColl, [], true);\n            this.tempUndoRedoStep = this.undoRedoStep;\n        }\n        else if (!isBlazor()) {\n            parent.notify('toolbar', { prop: 'setEnableDisableUndoRedo', value: { isPrevent: false } });\n        }\n        this.undoRedoColl = this.undoRedoColl.slice(0, this.undoRedoStep);\n        this.appliedUndoRedoColl = this.appliedUndoRedoColl.slice(0, this.undoRedoStep);\n        parent.isUndoRedo = parent.currObjType.isUndoAction = false;\n        if (!isBlazor()) {\n            parent.notify('toolbar', { prop: 'enable-disable-btns' });\n        }\n        else {\n            parent.updateToolbar(parent.element, 'enableDisableToolbarBtn');\n        }\n    };\n    UndoRedo.prototype.updateCurrUrc = function (type) {\n        var parent = this.parent;\n        if (!isBlazor()) {\n            parent.notify('toolbar', { prop: 'setEnableDisableUndoRedo', value: { isPrevent: false } });\n        }\n        if (type === 'ok') {\n            parent.notify('draw', { prop: 'setShapeTextInsert', onPropertyChange: false, value: { bool: false } });\n            var collection = this.tempUndoRedoColl.length > 0 ?\n                extend([], this.tempUndoRedoColl, [], true) :\n                extend([], this.undoRedoColl, [], true);\n            var prevObj = this.undoRedoColl[this.undoRedoColl.length - 1];\n            if (isNullOrUndefined(this.appliedUndoRedoColl[this.appliedUndoRedoColl.length - 1])) {\n                if (this.undoRedoColl[0]) {\n                    prevObj.previousCropObj = collection[0].previousCropObj;\n                    prevObj.previousObj = collection[0].previousObj;\n                    prevObj.previousObjColl = collection[0].previousObjColl;\n                    prevObj.previousPointColl = collection[0].previousPointColl;\n                    prevObj.previousText = collection[0].previousText;\n                }\n            }\n            else {\n                prevObj.previousCropObj = this.appliedUndoRedoColl[this.appliedUndoRedoColl.length - 1].currentCropObj;\n                prevObj.previousObj = this.appliedUndoRedoColl[this.appliedUndoRedoColl.length - 1].currentObj;\n                prevObj.previousObjColl = this.appliedUndoRedoColl[this.appliedUndoRedoColl.length - 1].currentObjColl;\n                prevObj.previousPointColl = this.appliedUndoRedoColl[this.appliedUndoRedoColl.length - 1].currentPointColl;\n                prevObj.previousText = this.appliedUndoRedoColl[this.appliedUndoRedoColl.length - 1].currentText;\n            }\n            if (prevObj) {\n                var obj = this.getZeroZoomObjPointValue(prevObj.currentObjColl, prevObj.currentPointColl);\n                prevObj.currentObjColl = obj['obj'];\n                prevObj.currentPointColl = obj['point'];\n                this.appliedUndoRedoColl.push(prevObj);\n            }\n            this.tempUndoRedoColl = [];\n            this.tempUndoRedoStep = 0;\n        }\n        else if (this.tempUndoRedoColl.length > 0) {\n            this.appliedUndoRedoColl = extend([], this.tempUndoRedoColl, [], true);\n            this.undoRedoStep = this.tempUndoRedoStep;\n            this.tempUndoRedoColl = [];\n            this.tempUndoRedoStep = 0;\n        }\n        if (this.appliedUndoRedoColl.length > 16) {\n            this.appliedUndoRedoColl.splice(0, 1);\n        }\n        this.undoRedoColl = [];\n        this.undoRedoColl = extend([], this.appliedUndoRedoColl, [], true);\n        if (type === 'ok') {\n            this.undoRedoStep = this.undoRedoColl.length;\n            if (!isBlazor()) {\n                parent.notify('toolbar', { prop: 'enable-disable-btns' });\n            }\n            else {\n                parent.updateToolbar(parent.element, 'enableDisableToolbarBtn');\n            }\n        }\n        if (parent.transform.zoomFactor > 0) {\n            parent.togglePan = true;\n            parent.notify('selection', { prop: 'setDragCanvas', value: { bool: true } });\n        }\n    };\n    UndoRedo.prototype.cancelCropSelection = function () {\n        var parent = this.parent;\n        var isCropSelection = false;\n        var splitWords;\n        if (parent.activeObj.shape) {\n            splitWords = parent.activeObj.shape.split('-');\n        }\n        if (parent.currObjType.isCustomCrop || (splitWords && splitWords[0] === 'crop')) {\n            isCropSelection = true;\n        }\n        if (isCropSelection) {\n            parent.notify('draw', { prop: 'performCancel', value: { isContextualToolbar: null } });\n        }\n        if (this.tempUndoRedoColl.length !== 0 || this.tempUndoRedoStep !== 0) {\n            this.appliedUndoRedoColl = extend([], this.tempUndoRedoColl, [], true);\n            this.undoRedoColl = extend([], this.tempUndoRedoColl, [], true);\n            this.undoRedoStep = this.tempUndoRedoStep;\n            this.tempUndoRedoColl = [];\n            this.tempUndoRedoStep = 0;\n            if (!isBlazor()) {\n                parent.notify('toolbar', { prop: 'setEnableDisableUndoRedo', value: { isPrevent: false } });\n            }\n        }\n    };\n    UndoRedo.prototype.refreshToolbarActions = function () {\n        var parent = this.parent;\n        if (!isBlazor()) {\n            if (parent.activeObj.shape) {\n                parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'shapes',\n                        isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                parent.notify('toolbar', { prop: 'update-toolbar-items', onPropertyChange: false });\n            }\n            else {\n                parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n            }\n        }\n        else if (isNullOrUndefined(parent.activeObj.shape)) {\n            parent.updateToolbar(parent.element, 'imageLoaded');\n        }\n    };\n    UndoRedo.prototype.applyCurrentChanges = function () {\n        var parent = this.parent;\n        parent.currObjType.isFiltered = false;\n        if (parent.transform.zoomFactor === 0) {\n            parent.togglePan = false;\n            parent.notify('selection', { prop: 'setDragCanvas', value: { bool: false } });\n        }\n        if (parent.element.querySelector('.e-contextual-toolbar-wrapper') && !isBlazor()) {\n            parent.element.querySelector('.e-contextual-toolbar-wrapper').classList.add('e-hide');\n        }\n        if (parent.togglePen) {\n            parent.togglePen = false;\n            parent.upperCanvas.style.cursor = parent.cursor = 'default';\n            this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        }\n        if (this.appliedUndoRedoColl.length > 0) {\n            this.undoRedoColl = extend([], this.appliedUndoRedoColl, [], true);\n        }\n    };\n    UndoRedo.prototype.callUndo = function () {\n        this.applyCurrentChanges();\n        this.undo();\n    };\n    UndoRedo.prototype.callRedo = function () {\n        this.applyCurrentChanges();\n        this.redo();\n    };\n    UndoRedo.prototype.undo = function () {\n        var parent = this.parent;\n        this.cancelCropSelection();\n        if (!parent.disabled && parent.isImageLoaded) {\n            if (this.undoRedoStep > 0) {\n                this.refreshToolbarActions();\n                if (parent.activeObj.activePoint && parent.activeObj.activePoint.width !== 0) {\n                    this.tempActObj = parent.activeObj;\n                }\n                parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                this.undoRedoStep--;\n                if (!isBlazor()) {\n                    parent.notify('toolbar', { prop: 'enable-disable-btns' });\n                    if (parent.element.querySelector('.e-contextual-toolbar-wrapper')) {\n                        parent.element.querySelector('.e-contextual-toolbar-wrapper').classList.add('e-hide');\n                    }\n                }\n                else {\n                    parent.updateToolbar(parent.element, 'enableDisableToolbarBtn');\n                }\n                parent.isUndoRedo = true;\n                var obj = this.undoRedoColl[this.undoRedoStep];\n                if (this.undoRedoColl.length === this.undoRedoStep) {\n                    parent.currObjType.isUndoAction = false;\n                }\n                else {\n                    parent.currObjType.isUndoAction = true;\n                }\n                if (obj.operation !== 'textAreaCustomization' && parent.textArea.style.display === 'block') {\n                    parent.textArea.style.display = 'none';\n                }\n                parent.notify('draw', { prop: 'setCancelAction', onPropertyChange: false, value: { bool: true } });\n                var activeObj = void 0;\n                parent.cropObj = extend({}, obj.previousCropObj, {}, true);\n                parent.afterCropActions = obj.previousObj.afterCropActions;\n                this.lowerContext.filter = obj.previousObj.filter;\n                parent.canvasFilter = this.lowerContext.filter;\n                switch (obj.operation) {\n                    case 'shapeTransform':\n                        this.shapeTransform(obj.previousObjColl);\n                        break;\n                    case 'freehanddraw':\n                    case 'freehand-draw':\n                        this.updateFreehandDraw(obj.previousPointColl);\n                        break;\n                    case 'freehanddrawCustomized':\n                        this.updateFreehandDrawCustomized(obj.previousPointColl);\n                        break;\n                    case 'deleteFreehandDrawing':\n                    case 'deleteObj':\n                        this.updateDelete(obj.operation, obj.previousObjColl, obj.previousPointColl);\n                        break;\n                    case 'textAreaCustomization':\n                        this.updateTextAreaCustomization(activeObj, obj.previousObjColl);\n                        break;\n                    case 'text':\n                        this.updateText(obj.previousObjColl, true);\n                        break;\n                    default:\n                        this.undoDefault(obj);\n                        parent.notify('filter', { prop: 'set-adjustment', value: { operation: obj.operation } });\n                        parent.notify('filter', { prop: 'update-filter', value: { operation: obj.operation, filter: obj.filter } });\n                        break;\n                }\n                if (obj.operation === 'crop') {\n                    if (obj.previousObj.currSelectionPoint) {\n                        parent.currSelectionPoint = extend({}, obj.previousObj.currSelectionPoint, {}, true);\n                        if (parent.currSelectionPoint && isNullOrUndefined(parent.currSelectionPoint.shape)) {\n                            parent.currSelectionPoint = null;\n                        }\n                    }\n                    parent.updateCropTransformItems();\n                    parent.select('custom');\n                    if (parent.isCircleCrop) {\n                        parent.isCircleCrop = false;\n                        this.tempCurrSelPoint = extend({}, parent.currSelectionPoint, {}, true);\n                        parent.currSelectionPoint = null;\n                    }\n                    parent.notify('draw', { prop: 'performCancel', value: { isContextualToolbar: null } });\n                }\n                if ((this.undoRedoColl[this.undoRedoStep - 1]\n                    && this.undoRedoColl[this.undoRedoStep - 1].isCircleCrop)) {\n                    parent.isCircleCrop = true;\n                    parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                        value: { context: this.lowerContext, isSave: null, isFlip: null } });\n                }\n                this.endUndoRedo(obj.operation, true);\n            }\n        }\n    };\n    UndoRedo.prototype.redo = function () {\n        var parent = this.parent;\n        this.cancelCropSelection();\n        if (!parent.disabled && parent.isImageLoaded) {\n            if (this.undoRedoStep < this.appliedUndoRedoColl.length) {\n                this.refreshToolbarActions();\n                this.undoRedoStep++;\n                if (!isBlazor()) {\n                    parent.notify('toolbar', { prop: 'enable-disable-btns' });\n                }\n                else {\n                    parent.updateToolbar(parent.element, 'enableDisableToolbarBtn');\n                }\n                parent.isUndoRedo = true;\n                var obj = this.undoRedoColl[this.undoRedoStep - 1];\n                if (this.undoRedoColl.length === this.undoRedoStep) {\n                    parent.currObjType.isUndoAction = false;\n                }\n                else {\n                    parent.currObjType.isUndoAction = true;\n                }\n                if (obj.operation !== 'textAreaCustomization' && parent.textArea.style.display === 'block') {\n                    parent.textArea.style.display = 'none';\n                }\n                parent.notify('draw', { prop: 'setCancelAction', onPropertyChange: false, value: { bool: true } });\n                parent.cropObj = extend({}, obj.currentCropObj, {}, true);\n                parent.afterCropActions = obj.currentObj.afterCropActions;\n                this.lowerContext.filter = obj.currentObj.filter;\n                if (!isBlazor() && parent.element.querySelector('.e-contextual-toolbar-wrapper')) {\n                    parent.element.querySelector('.e-contextual-toolbar-wrapper').classList.add('e-hide');\n                }\n                parent.canvasFilter = this.lowerContext.filter;\n                var activeObj = void 0;\n                switch (obj.operation) {\n                    case 'shapeTransform':\n                        this.shapeTransform(obj.currentObjColl);\n                        break;\n                    case 'freehanddraw':\n                    case 'freehand-draw':\n                        this.updateFreehandDraw(obj.currentPointColl);\n                        break;\n                    case 'freehanddrawCustomized':\n                        this.updateFreehandDrawCustomized(obj.currentPointColl);\n                        break;\n                    case 'deleteFreehandDrawing':\n                    case 'deleteObj':\n                        this.updateDelete(obj.operation, obj.currentObjColl, obj.currentPointColl);\n                        break;\n                    case 'textAreaCustomization':\n                        this.updateTextAreaCustomization(activeObj, obj.currentObjColl);\n                        break;\n                    case 'text':\n                        this.updateText(obj.currentObjColl, false);\n                        break;\n                    default:\n                        parent.objColl = [];\n                        parent.pointColl = [];\n                        parent.freehandCounter = 0;\n                        parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n                            value: { obj: { selPointColl: [] } } });\n                        parent.notify('draw', { prop: 'setCurrentObj', onPropertyChange: false, value: { obj: obj.currentObj } });\n                        parent.img.destLeft = obj.currentObj.destPoints.startX;\n                        parent.img.destTop = obj.currentObj.destPoints.startY;\n                        activeObj = extend({}, parent.activeObj, {}, true);\n                        parent.objColl = extend([], obj.currentObjColl, [], true);\n                        parent.pointColl = extend([], obj.currentPointColl, [], true);\n                        parent.freehandCounter = parent.pointColl.length;\n                        parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n                            value: { obj: { selPointColl: extend([], obj.currentSelPointColl, [], true) } } });\n                        this.lowerContext.filter = 'none';\n                        parent.notify('shape', { prop: 'zoomObjColl', onPropertyChange: false, value: { isPreventApply: null } });\n                        parent.notify('freehand-draw', { prop: 'zoomFHDColl', onPropertyChange: false, value: { isPreventApply: null } });\n                        this.lowerContext.filter = obj.currentObj.filter;\n                        parent.activeObj = activeObj;\n                        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                        if (parent.activeObj.activePoint.width !== 0 && parent.activeObj.activePoint.height !== 0) {\n                            parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate' } });\n                        }\n                        parent.notify('filter', { prop: 'set-adjustment', value: { operation: obj.operation } });\n                        parent.notify('filter', { prop: 'update-filter', value: { operation: obj.operation } });\n                        break;\n                }\n                if (obj.operation === 'crop' && obj.isCircleCrop) {\n                    parent.isCircleCrop = true;\n                    parent.currSelectionPoint = extend({}, this.tempCurrSelPoint, {}, true);\n                    this.tempCurrSelPoint = null;\n                }\n                if (obj.operation === 'crop' && !obj.isCircleCrop) {\n                    parent.isCircleCrop = false;\n                }\n                if (obj.operation === 'crop' && obj.currentObj.currSelectionPoint) {\n                    parent.currSelectionPoint = extend({}, obj.currentObj.currSelectionPoint, {}, true);\n                }\n                if (parent.currSelectionPoint && isNullOrUndefined(parent.currSelectionPoint.shape)) {\n                    parent.currSelectionPoint = null;\n                }\n                this.endUndoRedo(obj.operation, false);\n            }\n        }\n    };\n    UndoRedo.prototype.shapeTransform = function (objColl) {\n        var parent = this.parent;\n        parent.objColl = extend([], objColl, [], true);\n        parent.notify('shape', { prop: 'zoomObjColl', onPropertyChange: false, value: { isPreventApply: null } });\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        parent.isUndoRedo = true;\n        parent.notify('draw', { prop: 'redrawImgWithObj', onPropertyChange: false });\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n    };\n    UndoRedo.prototype.updateFreehandDraw = function (pointColl) {\n        var parent = this.parent;\n        parent.pointColl = pointColl;\n        parent.freehandCounter = parent.pointColl.length;\n        parent.notify('freehand-draw', { prop: 'zoomFHDColl', onPropertyChange: false, value: { isPreventApply: null } });\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        parent.isUndoRedo = true;\n        parent.notify('draw', { prop: 'redrawImgWithObj', onPropertyChange: false });\n    };\n    UndoRedo.prototype.updateFreehandDrawCustomized = function (pointColl) {\n        var parent = this.parent;\n        parent.pointColl = pointColl;\n        parent.notify('freehand-draw', { prop: 'zoomFHDColl', onPropertyChange: false, value: { isPreventApply: null } });\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        parent.isUndoRedo = true;\n        parent.notify('draw', { prop: 'redrawImgWithObj', onPropertyChange: false });\n    };\n    UndoRedo.prototype.updateDelete = function (operation, objColl, pointColl) {\n        var parent = this.parent;\n        if (operation === 'deleteFreehandDrawing') {\n            parent.pointColl = pointColl;\n            parent.freehandCounter = parent.pointColl.length;\n            parent.notify('freehand-draw', { prop: 'zoomFHDColl', onPropertyChange: false, value: { isPreventApply: null } });\n        }\n        else if (operation === 'deleteObj') {\n            parent.objColl = objColl;\n            parent.notify('shape', { prop: 'zoomObjColl', onPropertyChange: false, value: { isPreventApply: null } });\n        }\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        parent.isUndoRedo = true;\n        parent.notify('draw', { prop: 'redrawImgWithObj', onPropertyChange: false });\n    };\n    UndoRedo.prototype.updateTextAreaCustomization = function (activeObj, objColl) {\n        var parent = this.parent;\n        parent.objColl = extend([], objColl, [], true);\n        parent.notify('shape', { prop: 'zoomObjColl', onPropertyChange: false, value: { isPreventApply: true } });\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        parent.isUndoRedo = true;\n        parent.notify('draw', { prop: 'redrawImgWithObj', onPropertyChange: false });\n        for (var i = 0, len = objColl.length; i < len; i++) {\n            if (this.tempActObj) {\n                if (this.tempActObj.currIndex === objColl[i].currIndex) {\n                    activeObj = extend({}, objColl[i], {}, true);\n                    parent.objColl.splice(i, 1);\n                    break;\n                }\n            }\n            else {\n                activeObj = extend({}, objColl[objColl.length - 1], {}, true);\n                parent.objColl.splice(i, 1);\n                break;\n            }\n        }\n        if (activeObj) {\n            this.updateTextBox(activeObj);\n        }\n        if (parent.textArea.style.display === 'block') {\n            parent.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                value: { x: null, y: null, isMouseDown: null } });\n        }\n    };\n    UndoRedo.prototype.updateText = function (objColl, allowActiveObj) {\n        var parent = this.parent;\n        if (this.tempActObj) {\n            parent.activeObj = extend({}, this.tempActObj, {}, true);\n        }\n        if (objColl.length === 0 && parent.objColl.length === 1) {\n            this.tempActObj = extend({}, parent.objColl[0], {}, true);\n        }\n        else {\n            for (var i = 0; i < parent.objColl.length; i++) {\n                if (parent.objColl[i] && isNullOrUndefined(objColl[i])) {\n                    this.tempActObj = extend({}, parent.objColl[i], {}, true);\n                    break;\n                }\n                if (objColl[i].currIndex !== parent.objColl[i].currIndex) {\n                    this.tempActObj = extend({}, parent.objColl[i], {}, true);\n                    break;\n                }\n            }\n        }\n        if (allowActiveObj) {\n            parent.activeObj = extend({}, this.tempActObj, {}, true);\n        }\n        parent.objColl = extend([], objColl, [], true);\n        parent.notify('shape', { prop: 'zoomObjColl', onPropertyChange: false, value: { isPreventApply: true } });\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        parent.isUndoRedo = true;\n        parent.notify('draw', { prop: 'redrawImgWithObj', onPropertyChange: false });\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n    };\n    UndoRedo.prototype.updateTextBox = function (obj) {\n        var parent = this.parent;\n        this.upperContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        this.lowerContext.clearRect(0, 0, parent.lowerCanvas.width, parent.lowerCanvas.height);\n        parent.notify('draw', { prop: 'redrawImgWithObj', onPropertyChange: false });\n        if (!isBlazor()) {\n            parent.notify('toolbar', { prop: 'destroy-qa-toolbar', onPropertyChange: false });\n        }\n        else {\n            parent.updateToolbar(parent.element, 'destroyQuickAccessToolbar');\n        }\n        parent.textArea.style.display = 'block';\n        parent.textArea.style.fontFamily = obj.textSettings.fontFamily;\n        parent.textArea.style.fontSize = obj.textSettings.fontSize + 'px';\n        parent.textArea.style.color = obj.strokeSettings.strokeColor;\n        parent.textArea.style.fontWeight = obj.textSettings.bold ? 'bold' : 'normal';\n        parent.textArea.style.fontStyle = obj.textSettings.italic ? 'italic' : 'normal';\n        parent.textArea.style.border = '2px solid ' + parent.themeColl[parent.theme]['primaryColor'];\n        parent.textArea.value = obj.keyHistory;\n        parent.activeObj = extend({}, obj, {}, true);\n        parent.notify('shape', { prop: 'updateFontStyles', onPropertyChange: false,\n            value: { isTextBox: null } });\n        parent.textArea.style.width = parent.activeObj.activePoint.width + 'px';\n    };\n    UndoRedo.prototype.undoDefault = function (obj) {\n        this.lowerContext.filter = obj.previousObj.filter;\n        var parent = this.parent;\n        parent.objColl = [];\n        parent.pointColl = [];\n        parent.freehandCounter = 0;\n        parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n            value: { obj: { selPointColl: [] } } });\n        parent.notify('draw', { prop: 'setCurrentObj', onPropertyChange: false, value: { obj: obj.previousObj } });\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        parent.img.destLeft = obj.previousObj.destPoints.startX;\n        parent.img.destTop = obj.previousObj.destPoints.startY;\n        var activeObj = extend({}, parent.activeObj, {}, true);\n        parent.objColl = extend([], obj.previousObjColl, [], true);\n        parent.pointColl = extend([], obj.previousPointColl, [], true);\n        parent.freehandCounter = parent.pointColl.length;\n        parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n            value: { obj: { selPointColl: extend([], obj.previousSelPointColl, [], true) } } });\n        this.lowerContext.filter = 'none';\n        parent.notify('shape', { prop: 'zoomObjColl', onPropertyChange: false, value: { isPreventApply: null } });\n        parent.notify('freehand-draw', { prop: 'zoomFHDColl', onPropertyChange: false, value: { isPreventApply: null } });\n        this.lowerContext.filter = obj.previousObj.filter;\n        parent.activeObj = activeObj;\n        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n        if (parent.activeObj.activePoint.width !== 0 && parent.activeObj.activePoint.height !== 0) {\n            parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate' } });\n        }\n    };\n    UndoRedo.prototype.endUndoRedo = function (operation, isUndo) {\n        var parent = this.parent;\n        parent.notify('draw', { prop: 'clearOuterCanvas', onPropertyChange: false, value: { context: this.lowerContext } });\n        if (parent.isCircleCrop && ((isUndo && operation !== 'crop') || !isUndo)) {\n            parent.notify('crop', { prop: 'cropCircle', onPropertyChange: false,\n                value: { context: this.lowerContext, isSave: null, isFlip: null } });\n        }\n        if (parent.transform.zoomFactor > 0) {\n            parent.notify('selection', { prop: 'setDragCanvas', value: { bool: true } });\n        }\n        parent.notify('draw', { prop: 'setCancelAction', onPropertyChange: false, value: { bool: false } });\n        if (!isBlazor()) {\n            if (parent.activeObj.shape && parent.activeObj.shape.split('-')[0] === 'crop') {\n                parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'main',\n                        isApplyBtn: true, isCropping: true, isZooming: null, cType: null } });\n            }\n            else {\n                parent.notify('toolbar', { prop: 'refresh-main-toolbar', onPropertyChange: false });\n            }\n            parent.notify('toolbar', { prop: 'enable-disable-btns' });\n        }\n        else if (isNullOrUndefined(parent.activeObj.shape) || parent.activeObj.shape.split('-')[0] !== 'crop') {\n            parent.updateToolbar(parent.element, 'imageLoaded');\n            parent.updateToolbar(parent.element, 'enableDisableToolbarBtn');\n        }\n        if (document.getElementById(parent.element.id + '_quickAccessToolbarArea')) {\n            document.getElementById(parent.element.id + '_quickAccessToolbarArea').style.display = 'none';\n        }\n        if (!isBlazor()) {\n            parent.notify('toolbar', { prop: 'enable-disable-btns' });\n        }\n        else {\n            parent.updateToolbar(parent.element, 'enableDisableToolbarBtn');\n        }\n        if (parent.transform.degree !== 0) {\n            parent.notify('transform', { prop: 'drawPannedImage', onPropertyChange: false,\n                value: { xDiff: 0, yDiff: 0 } });\n        }\n        parent.notify('filter', { prop: 'setAdjustmentValue', onPropertyChange: false, value: { adjustmentValue: this.lowerContext.filter } });\n        parent.currObjType.isCustomCrop = false;\n    };\n    UndoRedo.prototype.updateUrc = function (operation, previousObj, previousObjColl, previousPointColl, previousSelPointColl, previousCropObj, previousText, currentText, previousFilter, isCircleCrop) {\n        var parent = this.parent;\n        var obj = { isInitialLoaded: false };\n        if (parent.currObjType.isUndoAction) {\n            this.refreshUrc(true);\n        }\n        parent.notify('draw', { prop: 'isInitialLoaded', onPropertyChange: false, value: { object: obj } });\n        if (!obj['isInitialLoaded'] && parent.allowUndoRedo) {\n            var object = { currObj: {} };\n            parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n            var currentObj = object['currObj'];\n            currentObj.objColl = extend([], parent.objColl, [], true);\n            currentObj.pointColl = extend([], parent.pointColl, [], true);\n            currentObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n            var selPointCollObj = { selPointColl: null };\n            parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                value: { obj: selPointCollObj } });\n            currentObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n            if (operation === 'crop') {\n                currentObj.currSelectionPoint = extend({}, parent.currSelectionPoint, {}, true);\n            }\n            this.undoRedoColl.push({ operation: operation, previousObj: previousObj, currentObj: currentObj,\n                previousObjColl: previousObjColl, currentObjColl: currentObj.objColl,\n                previousPointColl: previousPointColl, currentPointColl: currentObj.pointColl,\n                previousSelPointColl: previousSelPointColl, currentSelPointColl: currentObj.selPointColl,\n                previousCropObj: previousCropObj, currentCropObj: extend({}, parent.cropObj, {}, true),\n                previousText: previousText, currentText: currentText, filter: previousFilter, isCircleCrop: isCircleCrop });\n            if (!isBlazor()) {\n                parent.notify('toolbar', { prop: 'enable-disable-btns', onPropertyChange: false });\n            }\n            else {\n                parent.updateToolbar(parent.element, 'enableDisableToolbarBtn');\n            }\n        }\n    };\n    UndoRedo.prototype.updateUrObj = function (objColl) {\n        var parent = this.parent;\n        if (parent.allowUndoRedo) {\n            if (parent.currObjType.isUndoAction) {\n                this.refreshUrc(true);\n            }\n            parent.objColl.push(parent.activeObj);\n            var cropObj = extend({}, parent.cropObj, {}, true);\n            var object = { currObj: {} };\n            parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n            var obj = object['currObj'];\n            obj.objColl = extend([], parent.objColl, [], true);\n            obj.pointColl = extend([], parent.pointColl, [], true);\n            obj.afterCropActions = extend([], parent.afterCropActions, [], true);\n            var selPointCollObj = { selPointColl: null };\n            parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n                value: { obj: selPointCollObj } });\n            obj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n            this.undoRedoColl.push({ operation: 'shapeTransform', previousObj: obj, currentObj: obj,\n                previousObjColl: objColl, currentObjColl: obj.objColl,\n                previousPointColl: obj.pointColl, currentPointColl: obj.pointColl,\n                previousSelPointColl: obj.selPointColl, currentSelPointColl: obj.selPointColl,\n                previousCropObj: cropObj, currentCropObj: cropObj });\n            parent.notify('selection', { prop: 'redrawShape', onPropertyChange: false,\n                value: { obj: parent.objColl[parent.objColl.length - 1] } });\n        }\n    };\n    UndoRedo.prototype.updateUndoRedo = function () {\n        var parent = this.parent;\n        var prevCropObj = extend({}, parent.cropObj, {}, true);\n        var object = { currObj: {} };\n        parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var prevObj = object['currObj'];\n        prevObj.objColl = extend([], parent.objColl, [], true);\n        prevObj.pointColl = extend([], parent.pointColl, [], true);\n        prevObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        parent.objColl.push(parent.activeObj);\n        this.updateUrc('shapeTransform', prevObj, prevObj.objColl, prevObj.pointColl, prevObj.selPointColl, prevCropObj);\n        parent.objColl.pop();\n        parent.notify('shape', { prop: 'applyActObj', onPropertyChange: false, value: { isMouseDown: null } });\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        if (!isBlazor()) {\n            parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'shapes',\n                    isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n            parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'main',\n                    isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n        }\n        else {\n            parent.updateToolbar(parent.element, 'imageLoaded');\n        }\n    };\n    UndoRedo.prototype.getZeroZoomObjPointValue = function (obj, point) {\n        var parent = this.parent;\n        var object = { currObj: {} };\n        parent.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var currentObj = object['currObj'];\n        currentObj.objColl = extend([], parent.objColl, [], true);\n        currentObj.pointColl = extend([], parent.pointColl, [], true);\n        currentObj.afterCropActions = extend([], parent.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        parent.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        currentObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        var cropDimensionObj = { cropDimension: null };\n        parent.notify('transform', { prop: 'getCropDimension', onPropertyChange: false, value: { obj: cropDimensionObj } });\n        var getZeroZoomObjColl = extend([], parent.objColl, [], true);\n        var getZeroZoomPointColl = extend([], parent.pointColl, [], true);\n        var arrowObj = { arrowDimension: null };\n        this.parent.notify('draw', { prop: 'getArrowDimension', onPropertyChange: false, value: { obj: arrowObj } });\n        var tempArrowObj = extend({}, arrowObj['arrowDimension'], {}, true);\n        if (parent.transform.zoomFactor > 0 && (obj.length > 0 || point.length > 0)) {\n            parent.objColl = obj;\n            parent.pointColl = point;\n            var isUndoRedo = parent.isUndoRedo;\n            if (parent.transform.zoomFactor !== 0) {\n                parent.isUndoRedo = parent.isCropTab = true;\n                parent.notify('freehand-draw', { prop: 'updateFHDColl', onPropertyChange: false });\n                var zoomSettings = extend({}, parent.zoomSettings, null, true);\n                if (parent.transform.zoomFactor > 0) {\n                    parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                        value: { zoomFactor: -parent.transform.zoomFactor, zoomPoint: null } });\n                }\n                else {\n                    parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                        value: { zoomFactor: Math.abs(parent.transform.zoomFactor), zoomPoint: null } });\n                }\n                parent.zoomSettings = zoomSettings;\n                parent.isCropTab = false;\n                parent.isUndoRedo = isUndoRedo;\n                getZeroZoomObjColl = extend([], parent.objColl, [], true);\n                getZeroZoomPointColl = extend([], parent.pointColl, [], true);\n                parent.objColl = [];\n                parent.pointColl = [];\n                parent.freehandCounter = 0;\n                parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n                    value: { obj: { selPointColl: [] } } });\n                parent.notify('transform', { prop: 'setCropDimension', onPropertyChange: false,\n                    value: { width: cropDimensionObj['cropDimension']['width'], height: cropDimensionObj['cropDimension']['height'] } });\n                var maxDimension = { width: cropDimensionObj['cropDimension']['width'], height: cropDimensionObj['cropDimension']['height'] };\n                maxDimension.width += (maxDimension.width * currentObj.defaultZoom);\n                maxDimension.height += (maxDimension.height * currentObj.defaultZoom);\n                parent.notify('draw', { prop: 'setZoomCropWidth', value: { width: maxDimension.width, height: maxDimension.height } });\n                parent.notify('draw', { prop: 'setCurrentObj', onPropertyChange: false, value: { obj: currentObj } });\n                parent.img.destLeft = currentObj.destPoints.startX;\n                parent.img.destTop = currentObj.destPoints.startY;\n                parent.panPoint.totalPannedPoint = currentObj.totalPannedPoint;\n                parent.panPoint.totalPannedClientPoint = currentObj.totalPannedClientPoint;\n                parent.panPoint.totalPannedInternalPoint = currentObj.totalPannedInternalPoint;\n                parent.objColl = extend([], currentObj.objColl, [], true);\n                parent.pointColl = extend([], currentObj.pointColl, [], true);\n                parent.freehandCounter = parent.pointColl.length;\n                parent.notify('draw', { prop: 'setArrowDimension', onPropertyChange: false, value: { arrowDimension: tempArrowObj } });\n                parent.notify('freehand-draw', { prop: 'setSelPointColl', onPropertyChange: false,\n                    value: { obj: { selPointColl: extend([], currentObj.selPointColl, [], true) } } });\n                this.lowerContext.filter = 'none';\n                parent.notify('shape', { prop: 'iterateObjColl', onPropertyChange: false });\n                parent.notify('freehand-draw', { prop: 'freehandRedraw', onPropertyChange: false,\n                    value: { context: this.lowerContext, points: null } });\n                parent.notify('freehand-draw', { prop: 'updateFHDCurPts', onPropertyChange: false });\n                this.lowerContext.filter = currentObj.filter;\n                if (parent.transform.degree !== 0) {\n                    parent.notify('transform', { prop: 'drawPannedImage', onPropertyChange: false,\n                        value: { xDiff: 0, yDiff: 0 } });\n                }\n            }\n        }\n        return { obj: getZeroZoomObjColl, point: getZeroZoomPointColl };\n    };\n    return UndoRedo;\n}());\nexport { UndoRedo };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { Component, NotifyPropertyChanges, Property, addClass, removeClass, extend, isBlazor } from '@syncfusion/ej2-base';\nimport { Event, EventHandler, getComponent, isNullOrUndefined, getUniqueID } from '@syncfusion/ej2-base';\nimport { createSpinner } from '@syncfusion/ej2-popups';\nimport { Complex, Browser, ChildProperty, compile as templateCompiler, compile } from '@syncfusion/ej2-base';\nimport { ToolbarModule, Crop, Draw, Filter, FreehandDrawing, Selection, Shape, Transform, UndoRedo, Export } from './../index';\nimport { ZoomTrigger, ImageFinetuneOption } from './../index';\n/**\n * This interface is used to specify settings for finetuning operations on images, including brightness, contrast, hue, saturation, exposure, opacity, and blur. It includes properties for setting minimum and maximum values for each of these options, as well as a default value.\n */\nvar FinetuneSettings = /** @class */ (function (_super) {\n    __extends(FinetuneSettings, _super);\n    function FinetuneSettings() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(null)\n    ], FinetuneSettings.prototype, \"brightness\", void 0);\n    __decorate([\n        Property(null)\n    ], FinetuneSettings.prototype, \"contrast\", void 0);\n    __decorate([\n        Property(null)\n    ], FinetuneSettings.prototype, \"hue\", void 0);\n    __decorate([\n        Property(null)\n    ], FinetuneSettings.prototype, \"saturation\", void 0);\n    __decorate([\n        Property(null)\n    ], FinetuneSettings.prototype, \"exposure\", void 0);\n    __decorate([\n        Property(null)\n    ], FinetuneSettings.prototype, \"opacity\", void 0);\n    __decorate([\n        Property(null)\n    ], FinetuneSettings.prototype, \"blur\", void 0);\n    return FinetuneSettings;\n}(ChildProperty));\nexport { FinetuneSettings };\n/**\n * An interface used to define the settings such as minimum, maximum, and default zoom factors, and the type of zooming which are available in the image editor control.\n */\nvar ZoomSettings = /** @class */ (function (_super) {\n    __extends(ZoomSettings, _super);\n    function ZoomSettings() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(null)\n    ], ZoomSettings.prototype, \"zoomTrigger\", void 0);\n    __decorate([\n        Property(1)\n    ], ZoomSettings.prototype, \"minZoomFactor\", void 0);\n    __decorate([\n        Property(10)\n    ], ZoomSettings.prototype, \"maxZoomFactor\", void 0);\n    __decorate([\n        Property(1)\n    ], ZoomSettings.prototype, \"zoomFactor\", void 0);\n    __decorate([\n        Property(null)\n    ], ZoomSettings.prototype, \"zoomPoint\", void 0);\n    return ZoomSettings;\n}(ChildProperty));\nexport { ZoomSettings };\n/**\n * This interface is used to specify settings for selection operations on images, including visibility, stroke color and fill color.\n */\nvar SelectionSettings = /** @class */ (function (_super) {\n    __extends(SelectionSettings, _super);\n    function SelectionSettings() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(true)\n    ], SelectionSettings.prototype, \"showCircle\", void 0);\n    __decorate([\n        Property(null)\n    ], SelectionSettings.prototype, \"strokeColor\", void 0);\n    __decorate([\n        Property(null)\n    ], SelectionSettings.prototype, \"fillColor\", void 0);\n    return SelectionSettings;\n}(ChildProperty));\nexport { SelectionSettings };\n/**\n * The Image Editor is a graphical user interface for editing images.\n *\n * {% codeBlock src='image-editor/default/index.md' %}{% endcodeBlock %}\n *\n * @remarks\n * The Image Editor component provides various image editing features such as zooming, cropping, rotating, inserting text and shapes (rectangles, ellipses, and lines), drawing freehand on top of an image, undo/redo, and more.\n *\n */\nvar ImageEditor = /** @class */ (function (_super) {\n    __extends(ImageEditor, _super);\n    /**\n     *\n     * Constructor for creating the widget\n     *\n     * @param  {ImageEditorModel} options - Specifies the image editor model\n     * @param  {string|HTMLDivElement} element - Specifies the target element\n     */\n    function ImageEditor(options, element) {\n        var _this = _super.call(this, options) || this;\n        /**\n         *\n         * Image Editor Private Properties\n         */\n        /** @hidden */\n        _this.isImageLoaded = false;\n        /** @hidden */\n        _this.activeObj = { activePoint: { startX: 0, startY: 0, endX: 0, endY: 0, width: 0, height: 0 },\n            flipObjColl: [], triangle: [], triangleRatio: [], rotatedAngle: 0 };\n        // current object's ui interaction properties\n        /** @hidden */\n        _this.currObjType = { shape: '', isDragging: false, isActiveObj: false, isText: false, isInitialText: false, isLine: false, isInitialLine: false,\n            isCustomCrop: false, isZoomed: false, isUndoZoom: false, isUndoAction: false, isFiltered: false, isSave: false, isResize: false };\n        /** @hidden */\n        _this.objColl = [];\n        /** @hidden */\n        // eslint-disable-next-line\n        _this.pointColl = {};\n        /** @hidden */\n        _this.freehandCounter = 0;\n        /** @hidden */\n        _this.points = [];\n        /** @hidden */\n        _this.togglePen = false;\n        /** @hidden */\n        _this.togglePan = false;\n        /** @hidden */\n        _this.img = { destLeft: 0, destTop: 0, destWidth: 0, destHeight: 0, srcLeft: 0, srcTop: 0, srcWidth: 0, srcHeight: 0 };\n        /** @hidden */\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        _this.rotateFlipColl = [];\n        // All prop values saved while cropping (to restore the image to its original state)\n        /** @hidden */\n        _this.cropObj = { cropZoom: 0, defaultZoom: 0, totalPannedPoint: { x: 0, y: 0 }, totalPannedClientPoint: { x: 0, y: 0 },\n            totalPannedInternalPoint: { x: 0, y: 0 }, tempFlipPanPoint: { x: 0, y: 0 }, activeObj: {}, rotateFlipColl: [],\n            degree: 0, currFlipState: '', destPoints: { startX: 0, startY: 0, width: 0, height: 0 },\n            srcPoints: { startX: 0, startY: 0, width: 0, height: 0 }, filter: '', isBrightAdjust: false,\n            zoomFactor: 0, previousZoomValue: 0 };\n        // Stored transformations performed after cropping\n        /** @hidden */\n        _this.afterCropActions = [];\n        /** @hidden */\n        _this.transform = { degree: 0, currFlipState: '', zoomFactor: 0, cropZoomFactor: null, defaultZoomFactor: 0 };\n        /** @hidden */\n        _this.panPoint = { currentPannedPoint: { x: 0, y: 0 }, totalPannedPoint: { x: 0, y: 0 }, totalPannedInternalPoint: { x: 0, y: 0 },\n            totalPannedClientPoint: { x: 0, y: 0 } };\n        /** @hidden */\n        _this.isUndoRedo = false;\n        /** @hidden */\n        _this.isCropTab = false;\n        /** @hidden */\n        _this.isCircleCrop = false;\n        /** @hidden */\n        _this.fontSizeColl = [];\n        /** @hidden */\n        _this.initialAdjustmentValue = '';\n        /** @hidden */\n        _this.currentFilter = '';\n        /** @hidden */\n        _this.canvasFilter = 'brightness(' + 1 + ') ' + 'contrast(' + 100 + '%) ' + 'hue-rotate(' + 0 + 'deg) ' +\n            'saturate(' + 100 + '%) ' + 'opacity(' + 1 + ') ' + 'blur(' + 0 + 'px) ' + 'sepia(0%) ' + 'grayscale(0%) ' + 'invert(0%)';\n        /** @hidden */\n        _this.toolbarHeight = 0;\n        /** @hidden */\n        _this.isPublicMethod = false;\n        /** @hidden */\n        _this.isCropToolbar = false;\n        /** @hidden */\n        _this.cursor = 'default';\n        if (!isBlazor()) {\n            ImageEditor_1.Inject(Crop, Draw, Selection, Transform, Export, ToolbarModule);\n            ImageEditor_1.Inject(UndoRedo);\n            ImageEditor_1.Inject(Filter);\n            ImageEditor_1.Inject(Shape);\n            ImageEditor_1.Inject(FreehandDrawing);\n            if (element) {\n                _this.appendTo(element);\n            }\n        }\n        else {\n            new Crop(_this);\n            new Draw(_this);\n            new Filter(_this);\n            new FreehandDrawing(_this);\n            new Selection(_this);\n            new Shape(_this);\n            new Transform(_this);\n            new UndoRedo(_this);\n            new Export(_this);\n        }\n        return _this;\n    }\n    ImageEditor_1 = ImageEditor;\n    /**\n     * To provide the array of modules needed for component rendering.\n     *\n     * @returns {ModuleDeclaration[]} - To provide the array of modules needed for component rendering.\n     * @hidden\n     */\n    ImageEditor.prototype.requiredModules = function () {\n        var modules = [];\n        modules.push({ member: 'crop', args: [this] });\n        modules.push({ member: 'draw', args: [this] });\n        modules.push({ member: 'selection', args: [this] });\n        modules.push({ member: 'transform', args: [this] });\n        modules.push({ member: 'export', args: [this] });\n        modules.push({ member: 'toolbar-module', args: [this] });\n        modules.push({ member: 'undo-redo', args: [this] });\n        modules.push({ member: 'filter', args: [this] });\n        modules.push({ member: 'shape', args: [this] });\n        modules.push({ member: 'freehand-draw', args: [this] });\n        return modules;\n    };\n    ImageEditor.prototype.preRender = function () {\n        // pre render code snippets\n        this.element.id = this.element.id || getUniqueID('ej2-image-editor');\n        if (Browser.isDevice) {\n            this.element.classList.add('e-device');\n        }\n        this.initializeThemeColl();\n    };\n    /**\n     *\n     * To Initialize the component rendering\n     *\n     * @private\n     * @returns {void}\n     */\n    ImageEditor.prototype.render = function () {\n        this.initialize();\n    };\n    /**\n     * To get component name.\n     *\n     * @returns {string} - Module Name\n     * @private\n     */\n    ImageEditor.prototype.getModuleName = function () {\n        return 'image-editor';\n    };\n    /**\n     *\n     * To get the properties to be maintained in the persisted state.\n     *\n     * @returns {string} - Persist data\n     * @private\n     */\n    ImageEditor.prototype.getPersistData = function () {\n        return this.addOnPersist([]);\n    };\n    /**\n     *\n     * Called internally if any of the property value changed.\n     *\n     * @param {ImageEditorModel} newProperties - Specifies new properties\n     * @param {ImageEditorModel} oldProperties - Specifies old properties\n     * @returns {void}\n     * @private\n     */\n    ImageEditor.prototype.onPropertyChanged = function (newProperties, oldProperties) {\n        for (var _i = 0, _a = Object.keys(newProperties); _i < _a.length; _i++) {\n            var prop = _a[_i];\n            switch (prop) {\n                case 'cssClass':\n                    if (oldProperties.cssClass) {\n                        removeClass([this.element], oldProperties.cssClass.replace(/\\s+/g, ' ').trim().split(' '));\n                    }\n                    if (newProperties.cssClass) {\n                        addClass([this.element], newProperties.cssClass.replace(/\\s+/g, ' ').trim().split(' '));\n                    }\n                    break;\n                case 'disabled':\n                    if (newProperties.disabled) {\n                        this.element.classList.add('e-disabled');\n                        this.unwireEvent();\n                    }\n                    else {\n                        this.element.classList.remove('e-disabled');\n                        this.wireEvent();\n                    }\n                    break;\n                case 'height':\n                    this.element.style.height = newProperties.height;\n                    break;\n                case 'width':\n                    this.element.style.width = newProperties.width;\n                    break;\n                case 'theme':\n                    if (newProperties.theme) {\n                        if (this.theme && this.theme !== '') {\n                            this.theme = this.toPascalCase(this.theme);\n                        }\n                        else {\n                            this.theme = 'Bootstrap5';\n                        }\n                        this.upperContext.strokeStyle = this.themeColl[this.theme]['primaryColor'];\n                        this.upperContext.fillStyle = this.themeColl[this.theme]['secondaryColor'];\n                    }\n                    break;\n                case 'finetuneSettings':\n                    if (newProperties.finetuneSettings) {\n                        this.finetuneSettings = newProperties.finetuneSettings;\n                        this.notify('filter', { prop: 'update-finetunes' });\n                    }\n                    break;\n                case 'locale':\n                    if (newProperties.locale) {\n                        this.notify('toolbar', { prop: 'setLocale', onPropertyChange: false, value: { locale: newProperties.locale } });\n                        this.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'main',\n                                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                    }\n                    break;\n                case 'allowUndoRedo':\n                    if (newProperties.allowUndoRedo) {\n                        this.allowUndoRedo = true;\n                    }\n                    else {\n                        this.allowUndoRedo = false;\n                    }\n                    this.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'main',\n                            isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                    break;\n                case 'showQuickAccessToolbar':\n                    if (newProperties.showQuickAccessToolbar) {\n                        this.showQuickAccessToolbar = true;\n                        this.notify('toolbar', { prop: 'create-qa-toolbar', onPropertyChange: false });\n                        this.notify('toolbar', { prop: 'renderQAT', onPropertyChange: false, value: { isPenEdit: null } });\n                    }\n                    else {\n                        this.showQuickAccessToolbar = false;\n                        this.notify('toolbar', { prop: 'destroy-qa-toolbar', onPropertyChange: false });\n                    }\n                    break;\n                case 'zoomSettings':\n                    if (newProperties.zoomSettings) {\n                        this.zoomSettings.zoomTrigger = newProperties.zoomSettings.zoomTrigger;\n                    }\n                    if (isNullOrUndefined(this.zoomSettings.zoomTrigger)) {\n                        this.zoomSettings.zoomTrigger = (ZoomTrigger.MouseWheel | ZoomTrigger.Pinch | ZoomTrigger.Toolbar |\n                            ZoomTrigger.Commands);\n                        this.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'main',\n                                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                    }\n                    else if ((newProperties.zoomSettings.zoomTrigger & ZoomTrigger.Toolbar) === ZoomTrigger.Toolbar) {\n                        this.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'main',\n                                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                    }\n                    break;\n                case 'selectionSettings':\n                    if (newProperties.selectionSettings) {\n                        this.selectionSettings = newProperties.selectionSettings;\n                        if (this.activeObj.shape) {\n                            this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n                            this.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: this.activeObj } });\n                        }\n                    }\n                    break;\n            }\n        }\n    };\n    ImageEditor.prototype.destroy = function () {\n        var classList = [];\n        this.element.removeAttribute('tabindex');\n        if (this.cssClass) {\n            classList = classList.concat(this.cssClass.replace(/\\s+/g, ' ').trim().split(' '));\n        }\n        removeClass([this.element], classList);\n        if (!this.element.getAttribute('class')) {\n            this.element.removeAttribute('class');\n        }\n        if (!isBlazor()) {\n            this.notify('toolbar', { prop: 'destroySubComponents', onPropertyChange: false });\n            this.notify('destroyed', null);\n            _super.prototype.destroy.call(this);\n        }\n        else {\n            this.element.classList.remove('e-image-editor');\n        }\n        this.unwireEvent();\n        this.element.innerHTML = '';\n    };\n    ImageEditor.prototype.initialize = function () {\n        if (this.toolbarTemplate) {\n            this.element.appendChild(this.createElement('div', {\n                id: this.element.id + '_toolbarArea', className: 'e-toolbar-area'\n            }));\n            this.toolbarTemplateFn();\n        }\n        else {\n            this.notify('toolbar', { prop: 'create-toolbar', onPropertyChange: false });\n            this.notify('toolbar', { prop: 'create-contextual-toolbar', onPropertyChange: false });\n        }\n        this.createCanvas();\n        if (this.showQuickAccessToolbar) {\n            var canvasWrapper = document.querySelector('#' + this.element.id + '_canvasWrapper');\n            canvasWrapper.appendChild(this.createElement('div', {\n                id: this.element.id + '_quickAccessToolbarArea', className: 'e-quick-access-toolbar-area'\n            }));\n            var quickAccessToolbar = document.getElementById(this.element.id + '_quickAccessToolbarArea');\n            quickAccessToolbar.style.position = 'absolute';\n            quickAccessToolbar.style.display = 'none';\n            if (this.activeObj) {\n                quickAccessToolbar.style.left = this.activeObj.activePoint.startX + 'px';\n                quickAccessToolbar.style.top = this.activeObj.activePoint.startY + 'px';\n            }\n            quickAccessToolbar.style.width = '100%';\n        }\n        if (this.quickAccessToolbarTemplate) {\n            this.quickAccessToolbarTemplateFn();\n        }\n        else {\n            this.notify('toolbar', { prop: 'create-qa-toolbar', onPropertyChange: false });\n        }\n        this.wireEvent();\n        this.lowerContext = this.lowerCanvas.getContext('2d');\n        this.upperContext = this.upperCanvas.getContext('2d');\n        this.inMemoryContext = this.inMemoryCanvas.getContext('2d');\n        this.lowerContext.filter = this.getDefaultFilter();\n        this.notify('filter', { prop: 'setAdjustmentValue', onPropertyChange: false, value: { adjustmentValue: this.lowerContext.filter } });\n        this.canvasFilter = this.lowerContext.filter;\n        this.notify('toolbar', { prop: 'setInitialAdjustmentValue', onPropertyChange: false, value: { value: this.lowerContext.filter } });\n        if (this.cssClass) {\n            addClass([this.element], this.cssClass.replace(/\\s+/g, ' ').trim().split(' '));\n        }\n        if (this.element) {\n            createSpinner({\n                target: this.element\n            });\n        }\n        this.initializeZoomSettings();\n    };\n    /**\n     *\n     * This Method will add events to component (element, event, method, current reference)\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.wireEvent = function () {\n        EventHandler.add(document, 'keydown', this.keyDownEventHandler, this);\n        EventHandler.add(document, 'keypress', this.keyUpEventHandler, this);\n        EventHandler.add(this.upperCanvas, 'mousedown', this.mouseDownEventHandler, this);\n        EventHandler.add(this.upperCanvas, 'mousemove', this.mouseMoveEventHandler, this);\n        EventHandler.add(this.upperCanvas, 'mouseup', this.mouseUpEventHandler, this);\n        EventHandler.add(document, 'mouseup', this.mouseUpEventHandler, this);\n        EventHandler.add(this.lowerCanvas, 'mousedown', this.canvasMouseDownHandler, this);\n        EventHandler.add(this.lowerCanvas, 'mousemove', this.canvasMouseMoveHandler, this);\n        EventHandler.add(this.lowerCanvas, 'mouseup', this.canvasMouseUpHandler, this);\n        EventHandler.add(document, 'mouseup', this.canvasMouseUpHandler, this);\n        EventHandler.add(this.upperCanvas, 'touchstart', this.touchStartHandler, this);\n        EventHandler.add(this.lowerCanvas, 'touchstart', this.touchStartHandler, this);\n        EventHandler.add(this.lowerCanvas, 'mousewheel DOMMouseScroll', this.handleScroll, this);\n        EventHandler.add(this.upperCanvas, 'mousewheel DOMMouseScroll', this.handleScroll, this);\n        window.addEventListener('resize', this.windowResizeHandler.bind(this));\n        if ((!Browser.isIos && Browser.info.name !== 'safari')) {\n            screen.orientation.addEventListener('change', this.screenOrientation.bind(this));\n        }\n        this.notify('shape', { prop: 'wireEvent', onPropertyChange: false });\n    };\n    /**\n     *\n     * This Method will remove events from component\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.unwireEvent = function () {\n        EventHandler.remove(document, 'keydown', this.keyDownEventHandler);\n        EventHandler.remove(document, 'keypress', this.keyUpEventHandler);\n        EventHandler.remove(this.upperCanvas, 'mousedown', this.mouseDownEventHandler);\n        EventHandler.remove(this.upperCanvas, 'mousemove', this.mouseMoveEventHandler);\n        EventHandler.remove(this.upperCanvas, 'mouseup', this.mouseUpEventHandler);\n        EventHandler.remove(document, 'mouseup', this.mouseUpEventHandler);\n        EventHandler.remove(this.lowerCanvas, 'mousedown', this.canvasMouseDownHandler);\n        EventHandler.remove(this.lowerCanvas, 'mousemove', this.canvasMouseMoveHandler);\n        EventHandler.remove(this.lowerCanvas, 'mouseup', this.canvasMouseUpHandler);\n        EventHandler.remove(document, 'mouseup', this.canvasMouseUpHandler);\n        EventHandler.remove(this.upperCanvas, 'touchstart', this.touchStartHandler);\n        EventHandler.remove(this.lowerCanvas, 'touchstart', this.touchStartHandler);\n        EventHandler.remove(this.lowerCanvas, 'mousewheel DOMMouseScroll', this.handleScroll);\n        EventHandler.remove(this.upperCanvas, 'mousewheel DOMMouseScroll', this.handleScroll);\n        window.removeEventListener('resize', this.windowResizeHandler.bind(this));\n        if ((!Browser.isIos && Browser.info.name !== 'safari')) {\n            screen.orientation.removeEventListener('change', this.screenOrientation.bind(this));\n        }\n        this.notify('shape', { prop: 'unWireEvent', onPropertyChange: false });\n        this.notify('selection', { prop: 'unWireEvent', onPropertyChange: false });\n    };\n    ImageEditor.prototype.createCanvas = function () {\n        this.element.style.boxSizing = 'border-box';\n        var obj = { toolbarHeight: 0 };\n        this.notify('toolbar', { prop: 'getToolbarHeight', value: { obj: obj } });\n        var height = obj['toolbarHeight'];\n        this.element.style.width = this.width;\n        this.element.style.height = this.height;\n        var canvasWrapper = this.element.appendChild(this.createElement('div', { id: this.element.id + '_canvasWrapper',\n            className: 'e-canvas-wrapper', attrs: { style: 'height:' + (this.element.offsetHeight - height - 2) + 'px; width:' +\n                    (this.element.offsetWidth - 2)\n                    + 'px; position: relative; overflow: hidden; margin: 0 auto;' }\n        }));\n        this.lowerCanvas = canvasWrapper.appendChild(this.createElement('canvas', {\n            id: this.element.id + '_lowerCanvas', attrs: { name: 'canvasImage' }\n        }));\n        this.upperCanvas = canvasWrapper.appendChild(this.createElement('canvas', {\n            id: this.element.id + '_upperCanvas', attrs: { name: 'canvasImage' }\n        }));\n        this.inMemoryCanvas = this.createElement('canvas', {\n            id: this.element.id + '_inMemoryCanvas', attrs: { name: 'canvasImage' }\n        });\n        this.textArea = canvasWrapper.appendChild(this.createElement('textarea', {\n            id: this.element.id + '_textArea', className: 'e-textarea', attrs: { name: 'textArea' }\n        }));\n        var dialog = this.element.appendChild(this.createElement('div', {\n            id: this.element.id + '_dialog', className: 'e-dialog'\n        }));\n        dialog.style.display = 'none';\n        this.textArea.setAttribute('spellcheck', 'false');\n        this.textArea.style.lineHeight = 'normal';\n        this.lowerCanvas.style.width = this.upperCanvas.style.width = this.inMemoryCanvas.style.width = '100%';\n        this.lowerCanvas.style.height = this.upperCanvas.style.height = this.inMemoryCanvas.style.height = '100%';\n        this.upperCanvas.style.position = this.lowerCanvas.style.position = this.textArea.style.position = 'absolute';\n        this.textArea.style.backgroundColor = 'transparent';\n        this.textArea.style.display = 'none';\n        this.textArea.style.resize = 'none';\n        this.lowerContext = this.lowerCanvas.getContext('2d');\n        this.baseImg = this.createElement('img', {\n            id: this.element.id + '_orgImg', attrs: { name: 'Image', crossorigin: 'anonymous' }\n        });\n        this.upperCanvas.style.cursor = this.cursor = 'default';\n        this.upperCanvas.style.display = 'block';\n        this.upperContext = this.upperCanvas.getContext('2d');\n    };\n    ImageEditor.prototype.touchStartHandler = function (e) {\n        this.notify('selection', { prop: 'touchStartHandler', onPropertyChange: false, value: { e: e } });\n    };\n    ImageEditor.prototype.mouseDownEventHandler = function (e) {\n        this.notify('selection', { prop: 'mouseDownEventHandler', onPropertyChange: false, value: { e: e } });\n    };\n    ImageEditor.prototype.mouseMoveEventHandler = function (e) {\n        this.notify('selection', { prop: 'mouseMoveEventHandler', onPropertyChange: false, value: { e: e } });\n    };\n    ImageEditor.prototype.mouseUpEventHandler = function (e) {\n        this.notify('selection', { prop: 'mouseUpEventHandler', onPropertyChange: false, value: { e: e } });\n    };\n    ImageEditor.prototype.keyDownEventHandler = function (e) {\n        this.notify('selection', { prop: 'keyDownEventHandler', onPropertyChange: false, value: { e: e } });\n    };\n    ImageEditor.prototype.keyUpEventHandler = function (e) {\n        // eslint-disable-next-line\n        if (this.textArea.style.display === 'block' && e.target.id === this.element.id + '_textArea') {\n            this.notify('selection', { prop: 'textKeyDown', value: { e: e } });\n        }\n    };\n    ImageEditor.prototype.canvasMouseDownHandler = function (e) {\n        this.notify('selection', { prop: 'canvasMouseDownHandler', onPropertyChange: false, value: { e: e } });\n    };\n    ImageEditor.prototype.canvasMouseMoveHandler = function (e) {\n        this.notify('selection', { prop: 'canvasMouseMoveHandler', onPropertyChange: false, value: { e: e } });\n    };\n    ImageEditor.prototype.canvasMouseUpHandler = function (e) {\n        this.notify('selection', { prop: 'canvasMouseUpHandler', onPropertyChange: false, value: { e: e } });\n    };\n    ImageEditor.prototype.handleScroll = function (e) {\n        this.notify('selection', { prop: 'handleScroll', onPropertyChange: false, value: { e: e } });\n    };\n    ImageEditor.prototype.adjustToScreen = function () {\n        this.update();\n    };\n    ImageEditor.prototype.screenOrientation = function () {\n        if (Browser.isDevice) {\n            setTimeout(this.adjustToScreen.bind(this), 100);\n        }\n    };\n    ImageEditor.prototype.windowResizeHandler = function () {\n        if (!Browser.isDevice && this.element.classList.contains('e-image-editor')) {\n            this.adjustToScreen();\n        }\n    };\n    ImageEditor.prototype.notifyResetForAllModules = function () {\n        var modules = this.requiredModules();\n        for (var i = 0; i < modules.length; i++) {\n            this.notify(modules[i].member, { prop: 'reset', onPropertyChange: false });\n        }\n    };\n    ImageEditor.prototype.allowShape = function (x, y) {\n        this.isPublicMethod = true;\n        var obj = { inRange: false };\n        this.notify('shape', { prop: 'isPointsInRange', onPropertyChange: false,\n            value: { x: x, y: y, obj: obj } });\n        return obj['inRange'];\n    };\n    /**\n     * Clears the current selection performed in the image editor.\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.clearSelection = function () {\n        this.notify('selection', { prop: 'clearSelection', onPropertyChange: false });\n    };\n    /**\n     * Crops an image based on the selection done in the image editor.\n     *\n     * {% codeBlock src='image-editor/crop/index.md' %}{% endcodeBlock %}\n     *\n     * @remarks\n     * The selection can be done through programmatically using the 'select' method or through UI interactions.\n     *\n     * @returns {boolean}.\n     *\n     */\n    ImageEditor.prototype.crop = function () {\n        var obj = { isCrop: false };\n        this.notify('crop', { prop: 'crop', onPropertyChange: false, value: { obj: obj } });\n        return obj['isCrop'];\n    };\n    /**\n     * Flips an image by horizontally or vertically in the image editor.\n     *\n     * {% codeBlock src='image-editor/zoom/index.md' %}{% endcodeBlock %}\n     *\n     * @param { Direction } direction - Specifies the direction to flip the image.\n     * A horizontal direction for horizontal flipping and vertical direction for vertical flipping.\n     *\n     * @remarks\n     * It flips the shapes including rectangle, circle, line, text, and freehand drawings.\n     *\n     * @returns {void}.\n     *\n     */\n    ImageEditor.prototype.flip = function (direction) {\n        this.notify('transform', { prop: 'flip', value: { direction: direction } });\n        this.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n    };\n    /**\n     * Returns an image as ImageData to load it in to a canvas.\n     *\n     * @remarks\n     * The data returned from this method is directly drawn in a canvas using 'putImageData' method.\n     * And then the user can get the base64 string from the canvas using toDataURL method.\n     *\n     * @returns {ImageData}.\n     */\n    ImageEditor.prototype.getImageData = function () {\n        var obj = { canvas: null };\n        this.notify('export', { prop: 'exportToCanvas', value: { object: obj } });\n        return obj['canvas'].getContext('2d').getImageData(0, 0, obj['canvas'].width, obj['canvas'].height);\n    };\n    /**\n     *  Opens an image as URL or ImageData for editing in an image editor.\n     *\n     * @param {string | ImageData } data - Specifies url of the image or image data.\n     *\n     * @remarks\n     * The supported file types are JPG, JPEG, PNG, and SVG.\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.open = function (data) {\n        this.notify('draw', { prop: 'open', value: { data: data } });\n    };\n    /**\n     * Reset all the changesdone in an image editor and revert to original image.\n     *\n     * @remarks\n     * The undo redo collection also cleared while resetting the image editor.\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.reset = function () {\n        var obj = { isErrorImage: false };\n        this.notify('draw', { prop: 'getErrorImage', value: { obj: obj } });\n        if (!this.disabled && !obj['isErrorImage']) {\n            this.clearContext(this.inMemoryContext);\n            this.clearContext(this.lowerContext);\n            this.clearContext(this.upperContext);\n            this.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            if (!isBlazor()) {\n                this.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'main',\n                        isApplyBtn: false, isCropping: false, isZooming: null, cType: null } });\n                if (Browser.isDevice && document.getElementById(this.element.id + '_bottomToolbar')) {\n                    getComponent(document.getElementById(this.element.id + '_bottomToolbar'), 'toolbar').destroy();\n                    this.notify('toolbar', { prop: 'create-bottom-toolbar', onPropertyChange: false });\n                }\n            }\n            this.currObjType.isUndoAction = this.isUndoRedo = this.togglePan = this.togglePen = this.isImageLoaded = false;\n            this.isCircleCrop = this.isCropTab = false;\n            this.objColl = [];\n            this.transform.degree = 0;\n            this.upperCanvas.style.display = 'block';\n            this.transform.currFlipState = '';\n            this.upperCanvas.style.cursor = this.cursor = this.lowerCanvas.style.cursor = 'default';\n            this.lowerContext.lineWidth = this.upperContext.lineWidth = undefined;\n            this.textArea.value = this.textArea.textContent = '';\n            this.textArea.style.display = 'none';\n            this.lowerContext.filter = this.canvasFilter = this.getDefaultFilter();\n            this.img.destLeft = this.img.destTop = this.img.srcLeft = this.img.srcTop = 0;\n            this.img.destWidth = this.img.destHeight = this.img.srcWidth = this.img.srcHeight = null;\n            this.currSelectionPoint = null;\n            this.panPoint.currentPannedPoint = { x: 0, y: 0 };\n            this.rotateFlipColl = [];\n            this.points = [];\n            this.pointColl = {};\n            this.freehandCounter = 0;\n            this.notify('draw', { prop: 'resetPanPoints' });\n            this.lowerCanvas.style.left = this.upperCanvas.style.left = '';\n            this.fontSizeColl = [];\n            this.lowerCanvas.style.top = this.upperCanvas.style.top = '';\n            this.lowerCanvas.style.maxWidth = this.upperCanvas.style.maxWidth = '';\n            this.lowerCanvas.style.maxHeight = this.upperCanvas.style.maxHeight = '';\n            this.transform.defaultZoomFactor = this.transform.zoomFactor = 0;\n            this.transform.cropZoomFactor = null;\n            this.currObjType = { shape: '', isDragging: false, isActiveObj: false, isText: false, isInitialText: false, isLine: false,\n                isInitialLine: false, isCustomCrop: false, isZoomed: false, isUndoZoom: false,\n                isUndoAction: false, isFiltered: false, isSave: false, isResize: false };\n            this.cropObj = { cropZoom: 0, defaultZoom: 0, totalPannedPoint: { x: 0, y: 0 }, totalPannedClientPoint: { x: 0, y: 0 },\n                totalPannedInternalPoint: { x: 0, y: 0 }, tempFlipPanPoint: { x: 0, y: 0 }, activeObj: {},\n                rotateFlipColl: [], degree: 0, currFlipState: '', zoomFactor: 0, previousZoomValue: 0,\n                destPoints: { startX: 0, startY: 0, width: 0, height: 0 },\n                srcPoints: { startX: 0, startY: 0, width: 0, height: 0 }, filter: '', isBrightAdjust: false };\n            this.afterCropActions = [];\n            this.currentFilter = '';\n            var obj_1 = { initialZoomValue: false };\n            this.notify('draw', { prop: 'getInitialZoomValue', onPropertyChange: false, value: { obj: obj_1 } });\n            if (obj_1['initialZoomValue']) {\n                this.setProperties({ zoomSettings: { zoomFactor: obj_1['initialZoomValue'] } }, true);\n            }\n            if (document.getElementById(this.element.id + '_quickAccessToolbarArea')) {\n                document.getElementById(this.element.id + '_quickAccessToolbarArea').style.display = 'none';\n            }\n            this.notifyResetForAllModules();\n            this.notify('filter', { prop: 'update-finetunes' });\n            this.isImageLoaded = false;\n            this.notify('draw', { prop: 'update-canvas', onPropertyChange: false });\n            this.isImageLoaded = true;\n            if (!isBlazor()) {\n                if (this.element.querySelector('.e-contextual-toolbar-wrapper')) {\n                    this.element.querySelector('.e-contextual-toolbar-wrapper').classList.add('e-hide');\n                }\n                this.notify('toolbar', { prop: 'refresh-dropdown-btn', value: { isDisabled: false } });\n                this.notify('toolbar', { prop: 'enable-disable-btns' });\n            }\n        }\n    };\n    /**\n     * Rotate an image to clockwise and anti-clockwise.\n     *\n     * {% codeBlock src='image-editor/rotate/index.md' %}{% endcodeBlock %}\n     *\n     * @param {number} degree - Specifies a degree to rotate an image.\n     * A positive integer value for clockwise and negative integer value for anti-clockwise rotation.\n     *\n     * @remarks\n     * It rotated the shapes including rectangle, circle, line, text, and freehand drawings.\n     *\n     * @returns {boolean}.\n     *\n     */\n    ImageEditor.prototype.rotate = function (degree) {\n        var obj = { isRotate: false };\n        this.notify('transform', { prop: 'rotate', value: { degree: degree, obj: obj } });\n        this.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n        return obj['isRotate'];\n    };\n    /**\n     * Export an image using the specified file name and the extension.\n     *\n     * @param {string} type - Specifies a format of image to be saved.\n     * @param {string} fileName  Specifies a file name to be saved\n     *\n     * @remarks\n     * The supported file types are JPG, JPEG, PNG, and SVG.\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.export = function (type, fileName) {\n        this.notify('export', { prop: 'export', onPropertyChange: false, value: { type: type, fileName: fileName } });\n    };\n    /**\n     * Perform selection in an image editor. The selection helps to crop an image.\n     *\n     * {% codeBlock src='image-editor/select/index.md' %}{% endcodeBlock %}\n     *\n     * @param {string} type - Specifies the shape - circle / square / custom selection / pre-defined ratios.\n     * @param {number} startX  Specifies the start x-coordinate point of the selection.\n     * @param {number} startY  Specifies the start y-coordinate point of the selection.\n     * @param {number} width - Specifies the width of the selection area.\n     * @param {number} height - Specifies the height of the selection area.\n     *\n     * @remarks\n     * The selection UI is based on the 'theme' property.\n     *\n     * @returns {void}.\n     *\n     */\n    ImageEditor.prototype.select = function (type, startX, startY, width, height) {\n        this.notify('draw', { prop: 'select', onPropertyChange: false,\n            value: { type: type, startX: startX, startY: startY, width: width, height: height } });\n    };\n    /**\n     * Enable or disable a freehand drawing option in an Image Editor.\n     *\n     * @param {boolean} value - Specifies a value whether to enable or disable freehand drawing.\n     *\n     * @returns {void}.\n     * @private\n     */\n    ImageEditor.prototype.freeHandDraw = function (value) {\n        this.notify('freehand-draw', { prop: 'freeHandDraw', onPropertyChange: false, value: { value: value } });\n    };\n    /**\n     * Enable or disable a freehand drawing in an Image Editor.\n     *\n     * @param {boolean} value - Specifies a value whether to enable or disable freehand drawing.\n     *\n     * @remarks\n     * User can directly drawing on a canvas after enabling this option.\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.freehandDraw = function (value) {\n        if (!this.disabled && this.isImageLoaded) {\n            this.freeHandDraw(value);\n        }\n    };\n    /**\n     * Enable or disable a panning on the Image Editor.\n     *\n     * @param {boolean} value - Specifies a value whether enable or disable panning.\n     *\n     * @remarks\n     * This option will take into effect once the image's visibility is hidden when zooming an image or selection has been performed.\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.pan = function (value) {\n        this.notify('transform', { prop: 'pan', onPropertyChange: false, value: { value: value } });\n    };\n    /**\n     * Zoom in or out on a point in the image editor.\n     *\n     * @param {number} zoomFactor - The percentage-based zoom factor to use (e.g. 20 for 2x zoom).\n     * @param {Point} zoomPoint - The point in the image editor to zoom in/out on.\n     *\n     * @remarks\n     * Zooming directly enables the panning option when the image's visibility is hidden.\n     * User can disable it by using 'Pan' method.\n     * @returns {void}\n     *\n     */\n    ImageEditor.prototype.zoom = function (zoomFactor, zoomPoint) {\n        this.notify('transform', { prop: 'zoom', onPropertyChange: false,\n            value: { zoomFactor: zoomFactor, zoomPoint: zoomPoint } });\n    };\n    /**\n     * Draw ellipse on an image.\n     *\n     * {% codeBlock src='image-editor/ellipse/index.md' %}{% endcodeBlock %}\n     *\n     * @param {number} x - Specifies x-coordinate of ellipse.\n     * @param {number} y - Specifies y-coordinate of ellipse.\n     * @param {number} radiusX - Specifies the radius x point for the ellipse.\n     * @param {number} radiusY - Specifies the radius y point for the ellipse.\n     * @param {number} strokeWidth - Specifies the stroke width of ellipse.\n     * @param {string} strokeColor - Specifies the stroke color of ellipse.\n     * @param {string} fillColor - Specifies the fill color of the ellipse.\n     * @returns {boolean}.\n     *\n     */\n    ImageEditor.prototype.drawEllipse = function (x, y, radiusX, radiusY, strokeWidth, strokeColor, fillColor) {\n        var isEllipse = false;\n        var isPointsInRange = this.allowShape(x, y);\n        if (!this.disabled && this.isImageLoaded && (isPointsInRange || (isNullOrUndefined(x) && isNullOrUndefined(y)))) {\n            isEllipse = true;\n            this.notify('shape', { prop: 'drawEllipse', onPropertyChange: false, value: { x: x, y: y, radiusX: radiusX, radiusY: radiusY,\n                    strokeWidth: strokeWidth, strokeColor: strokeColor, fillColor: fillColor } });\n        }\n        return isEllipse;\n    };\n    /**\n     * Draw line on an image.\n     *\n     * @param {number} startX  Specifies start point x-coordinate of line.\n     * @param {number} startY  Specifies start point y-coordinate of line.\n     * @param {number} endX - Specifies end point x-coordinates of line.\n     * @param {number} endY - Specifies end point y-coordinates of the line.\n     * @param {number} strokeWidth - Specifies the stroke width of line.\n     * @param {string} strokeColor - Specifies the stroke color of line.\n     * @returns {boolean}.\n     */\n    ImageEditor.prototype.drawLine = function (startX, startY, endX, endY, strokeWidth, strokeColor) {\n        var isLine = false;\n        var isPointsInRange = this.allowShape(startX, startY);\n        if (!this.disabled && this.isImageLoaded && (isPointsInRange || (isNullOrUndefined(startX) && isNullOrUndefined(startY)))) {\n            isLine = true;\n            this.notify('shape', { prop: 'drawLine', onPropertyChange: false, value: { startX: startX, startY: startY, endX: endX,\n                    endY: endY, strokeWidth: strokeWidth, strokeColor: strokeColor } });\n        }\n        return isLine;\n    };\n    /**\n     * Draw arrow on an image.\n     *\n     * @param {number} startX  Specifies start point x-coordinate of arrow.\n     * @param {number} startY  Specifies start point y-coordinate of arrow.\n     * @param {number} endX - Specifies end point x-coordinates of arrow.\n     * @param {number} endY - Specifies end point y-coordinates of the arrow.\n     * @param {number} strokeWidth - Specifies the stroke width of arrow.\n     * @param {string} strokeColor - Specifies the stroke color of arrow.\n     * @param {ArrowheadType} arrowStart  Specifies the type of arrowhead for start position. The default value is None.\n     * @param {ArrowheadType} arrowEnd  Specifies the type of arrowhead for end position. The default value is SolidArrow.\n     * @returns {boolean}.\n     */\n    ImageEditor.prototype.drawArrow = function (startX, startY, endX, endY, strokeWidth, strokeColor, arrowStart, arrowEnd) {\n        var isArrow = false;\n        var isPointsInRange = this.allowShape(startX, startY);\n        if (!this.disabled && this.isImageLoaded && (isPointsInRange || (isNullOrUndefined(startX) && isNullOrUndefined(startY)))) {\n            isArrow = true;\n            this.notify('shape', { prop: 'drawArrow', onPropertyChange: false, value: { startX: startX, startY: startY, endX: endX,\n                    endY: endY, strokeWidth: strokeWidth, strokeColor: strokeColor, arrowStart: arrowStart, arrowEnd: arrowEnd } });\n        }\n        return isArrow;\n    };\n    /**\n     * Draw path on an image.\n     *\n     * @param {Point[]} pointColl  Specifies collection of start and end x, y-coordinates of path.\n     * @param {number} strokeWidth - Specifies the stroke width of path.\n     * @param {string} strokeColor - Specifies the stroke color of path.\n     * @returns {boolean}.\n     */\n    ImageEditor.prototype.drawPath = function (pointColl, strokeWidth, strokeColor) {\n        this.isPublicMethod = true;\n        var obj = { inRange: false };\n        var isPath = false;\n        if (pointColl && pointColl.length > 0) {\n            for (var i = 0; i < pointColl.length; i++) {\n                if (obj['inRange']) {\n                    break;\n                }\n                this.notify('shape', { prop: 'isPointsInRange', onPropertyChange: false,\n                    value: { x: pointColl[i].x, y: pointColl[i].y, obj: obj } });\n            }\n        }\n        if (!this.disabled && this.isImageLoaded && (obj['inRange'] || isNullOrUndefined(pointColl))) {\n            isPath = true;\n            this.notify('shape', { prop: 'drawPath', onPropertyChange: false, value: { pointColl: pointColl,\n                    strokeWidth: strokeWidth, strokeColor: strokeColor } });\n        }\n        return isPath;\n    };\n    /**\n     * Draw a rectangle on an image.\n     *\n     * @param {number} x - Specifies x-coordinate of rectangle.\n     * @param {number} y - Specifies y-coordinate of rectangle.\n     * @param {number} width - Specifies the width of the rectangle.\n     * @param {number} height - Specifies the height of the rectangle.\n     * @param {number} strokeWidth - Specifies the stroke width of rectangle.\n     * @param {string} strokeColor - Specifies the stroke color of rectangle.\n     * @param {string} fillColor - Specifies the fill color of the rectangle.\n     * @returns {boolean}.\n     */\n    ImageEditor.prototype.drawRectangle = function (x, y, width, height, strokeWidth, strokeColor, fillColor) {\n        var isRectangle = false;\n        var isPointsInRange = this.allowShape(x, y);\n        if (!this.disabled && this.isImageLoaded && (isPointsInRange || (isNullOrUndefined(x) && isNullOrUndefined(y)))) {\n            isRectangle = true;\n            this.notify('shape', { prop: 'drawRectangle', onPropertyChange: false, value: { x: x, y: y, width: width, height: height,\n                    strokeWidth: strokeWidth, strokeColor: strokeColor, fillColor: fillColor } });\n        }\n        return isRectangle;\n    };\n    /**\n     * Draw a text on an image.\n     *\n     * {% codeBlock src='image-editor/text/index.md' %}{% endcodeBlock %}\n     *\n     * @param {number} x - Specifies x-coordinate of text.\n     * @param {number} y - Specifies y-coordinate of text.\n     * @param {string} text - Specifies the text to add on an image.\n     * @param {string} fontFamily - Specifies the font family of the text.\n     * @param {number} fontSize - Specifies the font size of the text.\n     * @param {boolean} bold - Specifies whether the text is bold or not.\n     * @param {boolean} italic - Specifies whether the text is italic or not.\n     * @param {string} color - Specifies font color of the text.\n     * @returns {boolean}.\n     *\n     */\n    ImageEditor.prototype.drawText = function (x, y, text, fontFamily, fontSize, bold, italic, color) {\n        var isText = false;\n        var isPointsInRange = this.allowShape(x, y);\n        if (!this.disabled && this.isImageLoaded && (isPointsInRange || (isNullOrUndefined(x) && isNullOrUndefined(y)))) {\n            isText = true;\n            this.notify('shape', { prop: 'drawText', onPropertyChange: false, value: { x: x, y: y, text: text, fontFamily: fontFamily,\n                    fontSize: fontSize, bold: bold, italic: italic, color: color } });\n        }\n        return isText;\n    };\n    /**\n     * Select a shape based on the given shape id.\n     * Use 'getShapeSettings' method to get the shape id which is then passed to perform selection.\n     *\n     * {% codeBlock src='image-editor/selectShape/index.md' %}{% endcodeBlock %}\n     *\n     * @param {string} id - Specifies the shape id to select a shape on an image.\n     * @returns {boolean}.\n     *\n     */\n    ImageEditor.prototype.selectShape = function (id) {\n        var obj = { isSelected: false };\n        this.notify('shape', { prop: 'selectShape', onPropertyChange: false, value: { id: id, obj: obj } });\n        return obj['isSelected'];\n    };\n    /**\n     * Deletes a shape based on the given shape id.\n     * Use 'getShapeSettings' method to get the shape id which is then passed to perform selection.\n     *\n     * {% codeBlock src='image-editor/deleteShape/index.md' %}{% endcodeBlock %}\n     *\n     * @param {string} id - Specifies the shape id to delete the shape on an image.\n     * @returns {void}.\n     *\n     */\n    ImageEditor.prototype.deleteShape = function (id) {\n        this.notify('shape', { prop: 'deleteShape', onPropertyChange: false, value: { id: id } });\n    };\n    /**\n     * Get particular shapes details based on id of the shape which is drawn on an image editor.\n     *\n     * {% codeBlock src='image-editor/getShapeSetting/index.md' %}{% endcodeBlock %}\n     *\n     * @param {string} id - Specifies the shape id on an image.\n     * @returns {ShapeSettings}.\n     *\n     */\n    ImageEditor.prototype.getShapeSetting = function (id) {\n        var shapeDetails = {};\n        this.notify('shape', { prop: 'getShapeSetting', onPropertyChange: false,\n            value: { id: id, obj: shapeDetails } });\n        return shapeDetails;\n    };\n    /**\n     * Get all the shapes details which is drawn on an image editor.\n     *\n     * @returns {ShapeSettings[]}.\n     */\n    ImageEditor.prototype.getShapeSettings = function () {\n        var obj = { shapeDetailsColl: [] };\n        this.notify('shape', { prop: 'getShapeSettings', onPropertyChange: false, value: { obj: obj } });\n        return obj['shapeDetailsColl'];\n    };\n    /**\n     * To refresh the Canvas Wrapper.\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.update = function () {\n        this.notify('transform', { prop: 'update' });\n    };\n    /**\n     * Finetuning an image with the given type of finetune and its value in the image editor.\n     *\n     * @param {ImageFinetuneOption } finetuneOption - Specifies the finetune options to be performed in the image.\n     * @param {number } value - Specifies the value for finetuning the image.\n     *\n     * @remarks\n     * The finetuning will not affect the shapes background and border color.\n     *\n     * @returns {void}.\n     *\n     */\n    ImageEditor.prototype.finetuneImage = function (finetuneOption, value) {\n        if (!this.disabled && this.isImageLoaded) {\n            this.notify('filter', { prop: 'finetuneImage', value: { value: value, option: finetuneOption } });\n        }\n    };\n    /**\n     * Filtering an image with the given type of filters.\n     *\n     * @param {ImageFilterOption } filterOption - Specifies the filter options to the image.\n     *\n     * @remarks\n     * The filtering will not affect the shape's background and border color.\n     * @returns {void}.\n     */\n    ImageEditor.prototype.applyImageFilter = function (filterOption) {\n        if (!this.disabled && this.isImageLoaded) {\n            this.notify('filter', { prop: 'applyImageFilter', value: { option: filterOption.toString() } });\n            this.canvasFilter = this.lowerContext.filter;\n            this.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n        }\n    };\n    /**\n     * Reverse the last action which performed by the user in the Image Editor.\n     *\n     * @remarks\n     * This method will take into effect once the 'allowUndoRedo' property is enabled.\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.undo = function () {\n        this.notify('undo-redo', { prop: 'undo', onPropertyChange: false });\n    };\n    /**\n     * Redo the last user action that was undone by the user or `undo` method.\n     *\n     * @remarks\n     * This method will take into effect once the 'allowUndoRedo' property is enabled.\n     * @returns {void}.\n     */\n    ImageEditor.prototype.redo = function () {\n        this.notify('undo-redo', { prop: 'redo', onPropertyChange: false });\n    };\n    /**\n     * Get the dimension of an image in the image editor such as x, y, width, and height.\n     * The method helps to get dimension after cropped an image.\n     *\n     * @returns {Dimension}.\n     * A Dimension object containing the x, y, width, and height of an image.\n     */\n    ImageEditor.prototype.getImageDimension = function () {\n        return { x: this.img.destLeft, y: this.img.destTop, width: this.img.destWidth, height: this.img.destHeight };\n    };\n    // Toolbar related codes\n    ImageEditor.prototype.toolbarTemplateFn = function () {\n        var template;\n        var templateID = this.element.id + '_toolbar';\n        var toolbarArea = this.element.querySelector('#' + this.element.id + '_toolbarArea');\n        if (this.toolbarTemplate) {\n            this.toolbarFn = this.templateParser(this.toolbarTemplate);\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            if (this.isReact) {\n                template = this.toolbarFn({ type: 'toolbar' }, this, 'Template', templateID)[0];\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            }\n            else if (this.isAngular) {\n                var templateColl = this.toolbarFn({ type: 'toolbar' }, this, 'Template', templateID);\n                template = (templateColl[0].nodeType === 3) ? templateColl[1] : templateColl[0];\n            }\n            else {\n                template = this.toolbarFn({ type: 'toolbar' }, this, 'Template', templateID)[0];\n            }\n            toolbarArea.appendChild(template);\n            this.toolbarHeight = toolbarArea.clientHeight;\n            this.notify('toolbar', { prop: 'setToolbarHeight', value: { height: this.toolbarHeight } });\n            this['renderReactTemplates']();\n        }\n    };\n    ImageEditor.prototype.quickAccessToolbarTemplateFn = function () {\n        var template;\n        var templateID = this.element.id + '_quickAccessToolbar';\n        var toolbarArea = this.element.querySelector('#' + this.element.id + '_quickAccessToolbarArea');\n        if (this.quickAccessToolbarTemplate) {\n            this.qatFn = this.templateParser(this.quickAccessToolbarTemplate);\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            if (this.isReact) {\n                template = this.qatFn({ type: 'toolbar' }, this, 'Template', templateID)[0];\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            }\n            else if (this.isAngular) {\n                var templateColl = this.qatFn({ type: 'toolbar' }, this, 'Template', templateID);\n                template = (templateColl[0].nodeType === 3) ? templateColl[1] : templateColl[0];\n            }\n            else {\n                template = this.qatFn({ type: 'toolbar' }, this, 'Template', templateID)[0];\n            }\n            toolbarArea.appendChild(template);\n            this['renderReactTemplates']();\n        }\n    };\n    ImageEditor.prototype.templateParser = function (template) {\n        if (template) {\n            try {\n                if (typeof template !== 'function' && document.querySelectorAll(template).length) {\n                    return templateCompiler(document.querySelector(template).innerHTML.trim());\n                }\n                else {\n                    return compile(template);\n                }\n            }\n            catch (error) {\n                return templateCompiler(template);\n            }\n        }\n        return undefined;\n    };\n    // Common codes for EJ2 and Blazor\n    ImageEditor.prototype.getTextFromId = function (id) {\n        var idToValue = { '1': 'none', '2': 'bar', '3': 'arrow', '4': 'arrowSolid',\n            '5': 'circle', '6': 'circleSolid', '7': 'square', '8': 'squareSolid' };\n        return idToValue[\"\" + id];\n    };\n    ImageEditor.prototype.getFinetuneOption = function (type) {\n        var typeToOption = { 'brightness': ImageFinetuneOption.Brightness, 'contrast': ImageFinetuneOption.Contrast,\n            'hue': ImageFinetuneOption.Hue, 'saturation': ImageFinetuneOption.Saturation, 'opacity': ImageFinetuneOption.Opacity,\n            'blur': ImageFinetuneOption.Blur, 'exposure': ImageFinetuneOption.Exposure };\n        return typeToOption[\"\" + type];\n    };\n    ImageEditor.prototype.setPenStroke = function (args) {\n        this.notify('freehand-draw', { prop: 'setPenStrokeWidth', onPropertyChange: false, value: { value: parseInt(args, 10) } });\n    };\n    ImageEditor.prototype.updateFreehandDrawColorChange = function () {\n        var obj = { tempFreeHandDrawEditingStyles: null };\n        this.notify('freehand-draw', { prop: 'getTempFreeHandDrawEditingStyles', value: { obj: obj } });\n        this.notify('freehand-draw', { prop: 'color-change', value: { color: obj['tempFreeHandDrawEditingStyles'].strokeColor } });\n    };\n    ImageEditor.prototype.setInitialZoomState = function () {\n        this.objColl.push(this.activeObj);\n        this.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        var isUndoRedo = this.isUndoRedo;\n        this.isCropTab = false;\n        this.isUndoRedo = true;\n        if (this.transform.cropZoomFactor && this.transform.cropZoomFactor > 0) {\n            this.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                value: { zoomFactor: -this.transform.cropZoomFactor, zoomPoint: null } });\n        }\n        else {\n            this.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                value: { zoomFactor: Math.abs(this.transform.cropZoomFactor), zoomPoint: null } });\n        }\n        this.isUndoRedo = isUndoRedo;\n        this.panPoint.totalPannedPoint = { x: 0, y: 0 };\n        this.transform.cropZoomFactor = 0;\n        this.notify('freehand-draw', { prop: 'updateFHDColl', onPropertyChange: false });\n        this.activeObj = extend({}, this.objColl[this.objColl.length - 1], {}, true);\n        this.objColl.pop();\n        this.isCropTab = true;\n        this.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: this.activeObj } });\n    };\n    /**\n     * Set the old item Transform item state.\n     *\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.updateCropTransformItems = function () {\n        this.prevCurrSelectionPoint = extend({}, this.currSelectionPoint, {}, true);\n        var object = { currObj: {} };\n        this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var currentObj = object['currObj'];\n        currentObj.objColl = extend([], this.objColl, [], true);\n        currentObj.pointColl = extend([], this.pointColl, [], true);\n        currentObj.afterCropActions = extend([], this.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        this.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        currentObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        this.cancelCropSelection = { operation: 'cropTransform', previousObj: currentObj, currentObj: currentObj,\n            previousObjColl: currentObj.objColl, currentObjColl: currentObj.objColl,\n            previousPointColl: currentObj.pointColl, currentPointColl: currentObj.pointColl,\n            previousSelPointColl: currentObj.selPointColl, currentSelPointColl: currentObj.selPointColl,\n            previousCropObj: extend({}, this.cropObj, {}, true),\n            currentCropObj: extend({}, this.cropObj, {}, true),\n            previousText: null, currentText: null, filter: null, isCircleCrop: this.isCircleCrop };\n    };\n    /**\n     * Get the pascal case.\n     *\n     * @param { string } str - Specifies the string to convert to pascal case.\n     * @param { Object } obj - Specifies the string to convert to pascal case.\n     * @hidden\n     * @returns {string}.\n     * A pascal case string.\n     */\n    ImageEditor.prototype.toPascalCase = function (str, obj) {\n        var strArr = [];\n        if (!isNullOrUndefined(str)) {\n            strArr = str.toLowerCase().split('-');\n        }\n        for (var i = 0; i < strArr.length; i++) {\n            strArr[i] = strArr[i].charAt(0).toUpperCase() + strArr[i].slice(1);\n        }\n        if (obj) {\n            obj['maxText'] = strArr.join('');\n        }\n        return strArr.join('');\n    };\n    /**\n     * Get the font sizes.\n     *\n     * @hidden\n     * @returns {DropDownButtonItemModel[]}.\n     * A font size collections.\n     */\n    ImageEditor.prototype.getFontSizes = function () {\n        var items = [];\n        this.fontSizeColl = [];\n        var fontSize;\n        if (this.transform.degree === 0 || this.transform.degree % 180 === 0) {\n            fontSize = this.img.destWidth / 25;\n        }\n        else {\n            fontSize = this.img.destHeight / 25;\n        }\n        for (var i = 1; i <= 10; i++) {\n            this.fontSizeColl.push({ text: (i * (Math.round(fontSize / 2))).toString() });\n            items.push({ text: (i.toString()) });\n        }\n        return items;\n    };\n    /**\n     * Handles the OK button operation\n     *\n     * @param { boolean } isMouseDown - Specifies whether it is a mouse down.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.okBtn = function (isMouseDown) {\n        var isCropSelection = false;\n        var splitWords;\n        if (this.activeObj.shape !== undefined) {\n            splitWords = this.activeObj.shape.split('-');\n        }\n        if (splitWords === undefined && this.currObjType.isCustomCrop) {\n            isCropSelection = true;\n        }\n        else if (splitWords !== undefined && splitWords[0] === 'crop') {\n            isCropSelection = true;\n        }\n        var selElem = this.element.querySelector('.e-contextual-toolbar-wrapper .e-toolbar-item.e-selected');\n        var obj = { bool: false };\n        this.notify('selection', { prop: 'getFreehandDrawEditing', onPropertyChange: false, value: { obj: obj } });\n        if (selElem) {\n            this.currentFilter = selElem.children[0].children[0].id.replace('Canvas', '');\n        }\n        if (isCropSelection) {\n            this.crop();\n        }\n        else if (this.togglePen) {\n            this.freeHandDraw(false);\n            this.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n        }\n        else if (this.textArea.style.display === 'block') {\n            this.notify('shape', { prop: 'redrawActObj', onPropertyChange: false,\n                value: { x: null, y: null, isMouseDown: null } });\n            if (isNullOrUndefined(isMouseDown)) {\n                this.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n            }\n        }\n        else if ((!isBlazor() && document.querySelector('#' + this.element.id + '_sliderWrapper')) || (isBlazor() && !this.element.querySelector('.e-ie-contextual-slider').classList.contains('e-hidden')) ||\n            this.currObjType.isFiltered) {\n            this.initialAdjustmentValue = this.canvasFilter = this.lowerContext.filter;\n            this.currObjType.isFiltered = false;\n            var obj_2 = { value: null };\n            this.notify('draw', { prop: 'getTempAdjustmentValue', value: { obj: obj_2 } });\n            if (obj_2['value'] !== this.lowerContext.filter) {\n                this.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n            }\n        }\n        else if (obj['bool']) {\n            this.notify('freehand-draw', { prop: 'applyFhd', onPropertyChange: false });\n            this.notify('selection', { prop: 'setFreehandDrawCustomized', value: { isFreehandDrawCustomized: false } });\n            if (!isBlazor()) {\n                this.notify('toolbar', { prop: 'destroy-qa-toolbar' });\n            }\n            else {\n                this.updateToolbar(this.element, 'destroyQuickAccessToolbar');\n            }\n            this.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n        }\n        else if ((this.activeObj.activePoint.width !== 0 && this.activeObj.activePoint.height !== 0) ||\n            (this.activeObj.shape === 'path' && this.activeObj.pointColl.length > 0)) {\n            this.notify('shape', { prop: 'applyActObj', onPropertyChange: false, value: { isMouseDown: isMouseDown } });\n        }\n        if (!isBlazor() && !obj['isCropToolbar']) {\n            this.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'main',\n                    isApplyBtn: false, isCropping: null, isZooming: null, cType: null } });\n        }\n        this.notify('draw', { prop: 'setNewPath', value: { bool: false } });\n        this.isCropTab = false;\n        this.transform.zoomFactor = this.transform.defaultZoomFactor;\n        this.notify('selection', { prop: 'setCurrentDrawingShape', onPropertyChange: false, value: { value: '' } });\n    };\n    /**\n     * Set the temporary filter properties.\n     *\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.setTempFilterProperties = function () {\n        this.upperCanvas.style.display = 'block';\n        this.cropSelectedState();\n        var obj = { adjustmentLevel: null };\n        this.notify('filter', { prop: 'getAdjustmentLevel', onPropertyChange: false,\n            value: { obj: obj } });\n        this.lowerContext.filter = this.initialAdjustmentValue;\n        this.notify('draw', { prop: 'setTempAdjustmentValue', value: { tempAdjustmentValue: this.lowerContext.filter } });\n        this.notify('filter', { prop: 'setTempAdjustmentLevel', onPropertyChange: false,\n            value: { tempAdjustmentLevel: extend({}, obj['adjustmentLevel'], {}, true) } });\n        this.notify('draw', { prop: 'setTempFilter', value: { tempFilter: this.currentFilter } });\n        var undoRedoObj = { undoRedoStep: null };\n        this.notify('undo-redo', { prop: 'getUndoRedoStep', value: { obj: undoRedoObj } });\n        this.notify('draw', { prop: 'setTempUndoRedoStep', value: { tempUndoRedoStep: undoRedoObj['undoRedoStep'] } });\n    };\n    /**\n     * To crop the selection.\n     *\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.cropSelectedState = function () {\n        if (this.activeObj.shape && this.activeObj.shape.split('-')[0] === 'crop') {\n            this.okBtn();\n        }\n    };\n    /**\n     * Get the current canvas data.\n     *\n     * @hidden\n     * @returns {ImageData}.\n     * An ImageData returns the current canvas image data object.\n     */\n    ImageEditor.prototype.getCurrentCanvasData = function () {\n        var tempFilter = this.lowerContext.filter;\n        this.lowerContext.filter = this.canvasFilter = 'none';\n        var objColl = extend([], this.objColl, null, true);\n        var pointColl = extend([], this.pointColl, null, true);\n        this.objColl = [];\n        this.pointColl = [];\n        this.freehandCounter = 0;\n        this.notify('draw', { prop: 'render-image', value: { isMouseWheel: false } });\n        var data = this.getImageData();\n        if (!isBlazor()) {\n            if (!Browser.isDevice) {\n                this.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'main',\n                        isApplyBtn: true, isCropping: false } });\n            }\n            this.element.querySelector('#' + this.element.id + '_contextualToolbarArea').classList.remove('e-hide');\n        }\n        this.objColl = objColl;\n        this.pointColl = pointColl;\n        this.freehandCounter = pointColl.length;\n        this.notify('shape', { prop: 'iterateObjColl', onPropertyChange: false });\n        this.lowerContext.filter = this.canvasFilter = tempFilter;\n        return data;\n    };\n    /**\n     * To set current adjustment value\n     *\n     * @param { string } type - Specifies the type of adjustment.\n     * @param { number } value - Specifies the value to adjust.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.setCurrAdjustmentValue = function (type, value) {\n        var _this = this;\n        var finetuneValueChanging = { finetune: this.getFinetuneOption(type),\n            value: value, cancel: false };\n        if (isBlazor() && this.events && this.events.finetuneValueChanging.hasDelegate === true) {\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            this.dotNetRef.invokeMethodAsync('OnFinetuneValueChangeAsync', finetuneValueChanging).then(function (finetuneValueChanging) {\n                if (finetuneValueChanging.cancel) {\n                    return;\n                }\n                _this.notify('filter', { prop: 'setCurrAdjValue', value: { type: type.toLowerCase(), value: value } });\n            });\n        }\n        else {\n            this.trigger('finetuneValueChanging', finetuneValueChanging);\n            if (finetuneValueChanging.cancel) {\n                return;\n            }\n            this.notify('filter', { prop: 'setCurrAdjValue', value: { type: type.toLowerCase(), value: value } });\n        }\n    };\n    /**\n     * Get the square point for path.\n     *\n     * @param { SelectionPoint } obj - Specifies the points of path.\n     * @hidden\n     * @returns {ActivePoint}.\n     * An ActivePoint object which returns the square point.\n     */\n    ImageEditor.prototype.getSquarePointForPath = function (obj) {\n        var point = { startX: 0, startY: 0, endX: 0, endY: 0, width: 0, height: 0 };\n        if (obj.pointColl.length > 0) {\n            point = { startX: obj.pointColl[0].x, startY: obj.pointColl[0].y, endX: obj.pointColl[0].x, endY: obj.pointColl[0].y };\n            for (var i = 1; i < obj.pointColl.length; i++) {\n                if (obj.pointColl[i].x < point.startX) {\n                    point.startX = obj.pointColl[i].x;\n                }\n                if (obj.pointColl[i].y < point.startY) {\n                    point.startY = obj.pointColl[i].y;\n                }\n                if (obj.pointColl[i].x > point.endX) {\n                    point.endX = obj.pointColl[i].x;\n                }\n                if (obj.pointColl[i].y > point.endY) {\n                    point.endY = obj.pointColl[i].y;\n                }\n            }\n            point.width = point.endX - point.startX;\n            point.height = point.endY - point.startY;\n        }\n        return point;\n    };\n    /**\n     * Get the SelectionType.\n     *\n     * @param { string } type - Specifies the SelectionType.\n     * @hidden\n     * @returns {string}.\n     * An string which returns the SelectionType.\n     */\n    ImageEditor.prototype.getSelectionType = function (type) {\n        var typeToSelectionType = { 'CropCustom': 'Custom', 'CropSquare': 'Square', 'CropCircle': 'Circle',\n            'Crop3:2': '3:2', 'Crop4:3': '4:3', 'Crop5:4': '5:4', 'Crop7:5': '7:5', 'Crop16:9': '16:9' };\n        return typeToSelectionType[\"\" + type];\n    };\n    /** Clears the context.\n     *\n     * @param { CanvasRenderingContext2D } ctx - Specifies the canvas context.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.clearContext = function (ctx) {\n        ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);\n        ctx.clearRect(0, 0, ctx.canvas.height, ctx.canvas.width);\n    };\n    /**\n     * Apply Arrow for start and end.\n     *\n     * @param { string } type - Specifies the start arrow or end arrow.\n     * @param { string } id - Specifies the start arrow or end arrow item id.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.updateArrow = function (type, id) {\n        this.notify('shape', { prop: 'pushActItemIntoObj' });\n        var prevCropObj = extend({}, this.cropObj, {}, true);\n        var object = { currObj: {} };\n        this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var prevObj = object['currObj'];\n        prevObj.objColl = extend([], this.objColl, [], true);\n        prevObj.pointColl = extend([], this.pointColl, [], true);\n        prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n        this.objColl.pop();\n        if (type === 'startArrow') {\n            this.activeObj.start = this.getTextFromId(id);\n        }\n        else if (type === 'endArrow') {\n            this.activeObj.end = this.getTextFromId(id);\n        }\n        this.notify('shape', { prop: 'setStrokeSettings', value: { strokeSettings: null, strokeColor: null, fillColor: null,\n                strokeWidth: this.activeObj.strokeSettings.strokeWidth } });\n        this.objColl.push(this.activeObj);\n        this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n            value: { operation: 'shapeTransform', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                previousPointColl: prevObj.pointColl, previousCropObj: prevCropObj, previousText: null,\n                currentText: null, previousFilter: null, isCircleCrop: null } });\n        this.notify('selection', { prop: 'redrawShape', value: { obj: this.objColl[this.objColl.length - 1] } });\n        if (!isBlazor()) {\n            if (Browser.isDevice) {\n                if (document.getElementById(this.element.id + '_bottomToolbar')) {\n                    /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                    var toolbar_1 = getComponent(this.element.id + '_bottomToolbar', 'toolbar');\n                    toolbar_1.refreshOverflow();\n                }\n            }\n            else {\n                if (document.getElementById(this.element.id + '_toolbar')) {\n                    /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                    var toolbar_2 = getComponent(this.element.id + '_toolbar', 'toolbar');\n                    toolbar_2.refreshOverflow();\n                }\n            }\n        }\n    };\n    /**\n     * Apply Font style for text.\n     *\n     * @param { string } id - Specifies the selected item id.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.updateFontFamily = function (id) {\n        this.notify('selection', { prop: 'setInitialTextEdit', value: { bool: false } });\n        this.notify('shape', { prop: 'pushActItemIntoObj' });\n        var objColl = extend([], this.objColl, [], true);\n        var prevCropObj = extend({}, this.cropObj, {}, true);\n        var object = { currObj: {} };\n        this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var prevObj = object['currObj'];\n        prevObj.objColl = extend([], this.objColl, [], true);\n        prevObj.pointColl = extend([], this.pointColl, [], true);\n        prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        this.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        this.objColl.pop();\n        if (this.textArea.style.display === 'block') {\n            this.notify('shape', { prop: 'updateFontRatio', onPropertyChange: false,\n                value: { obj: this.activeObj, isTextArea: true } });\n            var temp = this.activeObj.textSettings.fontFamily;\n            this.activeObj.textSettings.fontFamily = this.toPascalCase(id);\n            this.notify('shape', { prop: 'redraw-text' });\n            this.objColl.push(this.activeObj);\n            this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                value: { operation: 'textAreaCustomization', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                    previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                    previousCropObj: prevCropObj, previousText: null,\n                    currentText: null, previousFilter: null, isCircleCrop: null } });\n            this.objColl.pop();\n            this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n            var width = this.activeObj.activePoint.width +\n                this.activeObj.textSettings.fontSize * 0.25;\n            this.textArea.style.width = width + 'px';\n            this.textArea.style.fontFamily = this.toPascalCase(id);\n            this.activeObj.textSettings.fontFamily = temp;\n            this.notify('shape', { prop: 'updateFontStyles', onPropertyChange: false,\n                value: { isTextBox: null } });\n        }\n        else {\n            this.notify('shape', { prop: 'updateFontRatio', onPropertyChange: false,\n                value: { obj: this.activeObj, isTextArea: null } });\n            var fontFamily = this.activeObj.textSettings.fontFamily = this.toPascalCase(id);\n            this.notify('shape', { prop: 'setTextSettings', onPropertyChange: false,\n                value: { textSettings: null, fontFamily: fontFamily, fontSize: null } });\n            this.notify('shape', { prop: 'redraw-text' });\n            this.objColl.push(this.activeObj);\n            this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                value: { operation: 'shapeTransform', previousObj: prevObj, previousObjColl: objColl,\n                    previousPointColl: extend([], this.pointColl, [], true),\n                    previousSelPointColl: prevObj.selPointColl, previousCropObj: prevCropObj, previousText: null,\n                    currentText: null, previousFilter: null, isCircleCrop: null } });\n            this.notify('selection', { prop: 'redrawShape', value: { obj: this.objColl[this.objColl.length - 1] } });\n        }\n    };\n    /**\n     * Apply Font size for text.\n     *\n     * @param { string } text - Specifies the selected item text.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.updateFontSize = function (text) {\n        var itemText = text;\n        this.notify('selection', { prop: 'setInitialTextEdit', value: { bool: false } });\n        this.notify('shape', { prop: 'pushActItemIntoObj' });\n        var prevCropObj = extend({}, this.cropObj, {}, true);\n        var object = { currObj: {} };\n        this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var prevObj = object['currObj'];\n        prevObj.objColl = extend([], this.objColl, [], true);\n        prevObj.pointColl = extend([], this.pointColl, [], true);\n        prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        this.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        this.objColl.pop();\n        if (this.textArea.style.display === 'block') {\n            this.notify('shape', { prop: 'updateFontRatio', onPropertyChange: false,\n                value: { obj: this.activeObj, isTextArea: true } });\n            var temp = this.activeObj.textSettings.fontSize;\n            this.activeObj.textSettings.fontSize = parseInt(this.fontSizeColl[(parseInt(itemText, 10) - 1)].text, 10);\n            this.objColl.push(this.activeObj);\n            this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                value: { operation: 'textAreaCustomization', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                    previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                    previousCropObj: prevCropObj, previousText: null,\n                    currentText: null, previousFilter: null, isCircleCrop: null } });\n            this.objColl.pop();\n            var textStyle = '';\n            if (this.textArea.style.fontWeight === 'bold') {\n                textStyle = 'bold ';\n            }\n            if (this.textArea.style.fontStyle === 'italic') {\n                textStyle = 'italic ';\n            }\n            if (this.textArea.style.fontWeight === 'bold' && this.textArea.style.fontStyle === 'italic') {\n                textStyle = 'italic bold ';\n            }\n            this.upperContext.font = textStyle + this.activeObj.textSettings.fontSize + 'px' + ' ' + this.textArea.style.fontFamily;\n            var rows = this.textArea.value.split('\\n');\n            var obj = { maxText: '' };\n            this.notify('shape', { prop: 'getMaxText', onPropertyChange: false,\n                value: { isTextBox: true, text: null, obj: obj } });\n            var text_1 = obj['maxText'];\n            var width = this.upperContext.measureText(text_1).width +\n                this.activeObj.textSettings.fontSize * 0.5;\n            this.textArea.style.width = width + 'px';\n            this.textArea.style.height = rows.length * (this.activeObj.textSettings.fontSize + this.activeObj.textSettings.fontSize * 0.25) + 'px';\n            this.activeObj.textSettings.fontSize = temp;\n            this.upperContext.font = this.activeObj.textSettings.fontSize + 'px' + ' ' + this.activeObj.textSettings.fontFamily;\n            this.textArea.style.fontSize = parseInt(this.fontSizeColl[(parseInt(itemText, 10) - 1)].text, 10) + 'px';\n            if (this.textArea.style.fontFamily === 'georgia') {\n                this.textArea.style.width = parseFloat(this.textArea.style.width) + parseFloat(this.textArea.style.fontSize) + 'px';\n            }\n        }\n        else {\n            this.notify('shape', { prop: 'updateFontRatio', onPropertyChange: false,\n                value: { obj: this.activeObj, isTextArea: null } });\n            var fontSize = this.activeObj.textSettings.fontSize = parseInt(this.fontSizeColl[(parseInt(itemText, 10) - 1)].text, 10);\n            this.notify('shape', { prop: 'setTextSettings', onPropertyChange: false,\n                value: { textSettings: null, fontFamily: null, fontSize: fontSize } });\n            this.upperContext.font = this.activeObj.textSettings.fontSize + 'px' + ' ' + this.activeObj.textSettings.fontFamily;\n            var rows = this.activeObj.keyHistory.split('\\n');\n            var obj = { maxText: '' };\n            this.notify('shape', { prop: 'getMaxText', onPropertyChange: false,\n                value: { isTextBox: null, text: null, obj: obj } });\n            var text_2 = obj['maxText'];\n            var width = this.upperContext.measureText(text_2).width +\n                this.activeObj.textSettings.fontSize * 0.5;\n            var height = rows.length * (this.activeObj.textSettings.fontSize +\n                this.activeObj.textSettings.fontSize * 0.25);\n            this.notify('selection', { prop: 'setTextSelection', onPropertyChange: false,\n                value: { width: width, height: height } });\n            this.notify('draw', { prop: 'updateActiveObject', onPropertyChange: false, value: { actPoint: this.activeObj.activePoint, obj: this.activeObj,\n                    isMouseMove: null, x: null, y: null } });\n            this.notify('shape', { prop: 'redraw-text' });\n            this.objColl.push(this.activeObj);\n            this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                value: { operation: 'shapeTransform', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                    previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                    previousCropObj: prevCropObj, previousText: null,\n                    currentText: null, previousFilter: null, isCircleCrop: null } });\n            this.notify('selection', { prop: 'redrawShape', value: { obj: this.objColl[this.objColl.length - 1] } });\n        }\n    };\n    /**\n     * Apply Font color for text.\n     *\n     * @param { string } value - Specifies the selected color item value.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.updateFontColor = function (value) {\n        this.notify('selection', { prop: 'setInitialTextEdit', value: { bool: false } });\n        this.notify('shape', { prop: 'pushActItemIntoObj' });\n        var prevCropObj = extend({}, this.cropObj, {}, true);\n        var object = { currObj: {} };\n        this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var prevObj = object['currObj'];\n        prevObj.objColl = extend([], this.objColl, [], true);\n        prevObj.pointColl = extend([], this.pointColl, [], true);\n        prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        this.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        this.objColl.pop();\n        if (this.textArea.style.display === 'none') {\n            this.activeObj.strokeSettings.strokeColor = value;\n            this.notify('shape', { prop: 'setStrokeSettings', value: { strokeSettings: null,\n                    strokeColor: this.activeObj.strokeSettings.strokeColor, fillColor: null, strokeWidth: null } });\n            if (!this.togglePen) {\n                this.objColl.push(this.activeObj);\n                this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                    value: { operation: 'shapeTransform', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                        previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                        previousCropObj: prevCropObj, previousText: null,\n                        currentText: null, previousFilter: null, isCircleCrop: null } });\n                this.notify('selection', { prop: 'redrawShape', value: { obj: this.objColl[this.objColl.length - 1] } });\n            }\n        }\n        else if (this.textArea.style.display === 'block') {\n            this.textArea.style.color = value;\n            var temp = this.activeObj.strokeSettings.strokeColor;\n            this.activeObj.strokeSettings.strokeColor = value;\n            this.objColl.push(this.activeObj);\n            this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                value: { operation: 'textAreaCustomization', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                    previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                    previousCropObj: prevCropObj, previousText: null,\n                    currentText: null, previousFilter: null, isCircleCrop: null } });\n            this.objColl.pop();\n            this.activeObj.strokeSettings.strokeColor = temp;\n        }\n        else if (!this.togglePen) {\n            this.objColl.push(this.activeObj);\n            this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                value: { operation: 'shapeTransform', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                    previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                    previousCropObj: prevCropObj, previousText: null,\n                    currentText: null, previousFilter: null, isCircleCrop: null } });\n            this.notify('selection', { prop: 'redrawShape', value: { obj: this.objColl[this.objColl.length - 1] } });\n        }\n    };\n    /**\n     * Apply Pen stroke width.\n     *\n     * @param { string } id - Specifies the selected item id.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.updatePenStrokeWidth = function (id) {\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var temp = extend([], this.pointColl, [], true);\n        this.updateFreehandDrawColorChange();\n        var prevCropObj = extend({}, this.cropObj, {}, true);\n        var object = { currObj: {} };\n        this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var prevObj = object['currObj'];\n        prevObj.objColl = extend([], this.objColl, [], true);\n        prevObj.pointColl = extend([], this.pointColl, [], true);\n        prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        this.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        this.pointColl = temp;\n        this.notify('selection', { prop: 'setFreehandDrawCustomized', value: { isFreehandDrawCustomized: true } });\n        this.setPenStroke(id);\n        var obj = { bool: false };\n        this.notify('selection', { prop: 'getFreehandDrawEditing', onPropertyChange: false, value: { obj: obj } });\n        if (obj['bool']) {\n            var obj_3 = { penStrokeWidth: null };\n            this.notify('freehand-draw', { prop: 'getPenStrokeWidth', onPropertyChange: false, value: { obj: obj_3 } });\n            this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n            this.notify('freehand-draw', { prop: 'hoverFhd', onPropertyChange: false,\n                value: { strokeColor: null, strokeWidth: obj_3['penStrokeWidth'] } });\n            var indexObj = { freehandSelectedIndex: null };\n            this.notify('freehand-draw', { prop: 'getFreehandSelectedIndex', onPropertyChange: false, value: { obj: indexObj } });\n            this.pointColl[indexObj['freehandSelectedIndex']].strokeWidth = obj_3['penStrokeWidth'];\n            this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                value: { operation: 'freehanddrawCustomized', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                    previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                    previousCropObj: prevCropObj, previousText: null,\n                    currentText: null, previousFilter: null, isCircleCrop: null } });\n        }\n    };\n    /**\n     * Apply Pen stroke color.\n     *\n     * @param { string } value - Specifies the selected color item value.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.updatePenStrokeColor = function (value) {\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var temp = extend([], this.pointColl, [], true);\n        this.updateFreehandDrawColorChange();\n        var prevCropObj = extend({}, this.cropObj, {}, true);\n        var object = { currObj: {} };\n        this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var prevObj = object['currObj'];\n        prevObj.objColl = extend([], this.objColl, [], true);\n        prevObj.pointColl = extend([], this.pointColl, [], true);\n        prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        this.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        this.pointColl = temp;\n        this.notify('selection', { prop: 'setFreehandDrawCustomized', value: { isFreehandDrawCustomized: true } });\n        this.activeObj.strokeSettings.strokeColor = value;\n        var obj = { bool: false };\n        this.notify('selection', { prop: 'getFreehandDrawEditing', onPropertyChange: false, value: { obj: obj } });\n        if (obj['bool']) {\n            var indexObj = { freehandSelectedIndex: null };\n            this.notify('freehand-draw', { prop: 'getFreehandSelectedIndex', onPropertyChange: false, value: { obj: indexObj } });\n            this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n            this.pointColl[indexObj['freehandSelectedIndex']].strokeColor = value;\n            this.notify('freehand-draw', { prop: 'hoverFhd', onPropertyChange: false,\n                value: { strokeColor: value } });\n            this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                value: { operation: 'freehanddrawCustomized', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                    previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                    previousCropObj: prevCropObj, previousText: null,\n                    currentText: null, previousFilter: null, isCircleCrop: null } });\n        }\n        else if (!this.togglePen) {\n            this.notify('selection', { prop: 'redrawShape', value: { obj: this.activeObj } });\n        }\n    };\n    /**\n     * Apply Shape stroke width.\n     *\n     * @param { string } id - Specifies the selected item id.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.updateStrokeWidth = function (id) {\n        this.notify('shape', { prop: 'pushActItemIntoObj' });\n        var prevCropObj = extend({}, this.cropObj, {}, true);\n        var object = { currObj: {} };\n        this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var prevObj = object['currObj'];\n        prevObj.objColl = extend([], this.objColl, [], true);\n        prevObj.pointColl = extend([], this.pointColl, [], true);\n        prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        this.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        this.objColl.pop();\n        this.activeObj.strokeSettings.strokeWidth = parseInt(id, 10);\n        this.activeObj.strokeSettings.strokeWidth *= 2;\n        this.notify('shape', { prop: 'setStrokeSettings', value: { strokeSettings: null, strokeColor: null, fillColor: null,\n                strokeWidth: this.activeObj.strokeSettings.strokeWidth } });\n        this.objColl.push(this.activeObj);\n        this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n            value: { operation: 'shapeTransform', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                previousCropObj: prevCropObj, previousText: null,\n                currentText: null, previousFilter: null, isCircleCrop: null } });\n        this.notify('selection', { prop: 'redrawShape', value: { obj: this.objColl[this.objColl.length - 1] } });\n    };\n    /**\n     * Apply Shape stroke color.\n     *\n     * @param { string } value - Specifies the selected color item value.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.updateStrokeColor = function (value) {\n        this.notify('shape', { prop: 'pushActItemIntoObj' });\n        var prevCropObj = extend({}, this.cropObj, {}, true);\n        var object = { currObj: {} };\n        this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var prevObj = object['currObj'];\n        prevObj.objColl = extend([], this.objColl, [], true);\n        prevObj.pointColl = extend([], this.pointColl, [], true);\n        prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        this.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        this.objColl.pop();\n        this.activeObj.strokeSettings.strokeColor = value;\n        this.notify('shape', { prop: 'setStrokeSettings', value: { strokeSettings: null, strokeColor: this.activeObj.strokeSettings.strokeColor, fillColor: null, strokeWidth: null } });\n        if (!this.togglePen) {\n            this.objColl.push(this.activeObj);\n            this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n                value: { operation: 'shapeTransform', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                    previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                    previousCropObj: prevCropObj, previousText: null,\n                    currentText: null, previousFilter: null, isCircleCrop: null } });\n            this.notify('selection', { prop: 'redrawShape', value: { obj: this.objColl[this.objColl.length - 1] } });\n        }\n    };\n    /**\n     * Apply Shape fill color.\n     *\n     * @param { string } value - Specifies the selected color item value.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.updateFillColor = function (value) {\n        this.notify('shape', { prop: 'pushActItemIntoObj' });\n        var prevCropObj = extend({}, this.cropObj, {}, true);\n        var object = { currObj: {} };\n        this.notify('filter', { prop: 'getCurrentObj', onPropertyChange: false, value: { object: object } });\n        var prevObj = object['currObj'];\n        prevObj.objColl = extend([], this.objColl, [], true);\n        prevObj.pointColl = extend([], this.pointColl, [], true);\n        prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n        var selPointCollObj = { selPointColl: null };\n        this.notify('freehand-draw', { prop: 'getSelPointColl', onPropertyChange: false,\n            value: { obj: selPointCollObj } });\n        prevObj.selPointColl = extend([], selPointCollObj['selPointColl'], [], true);\n        this.objColl.pop();\n        this.activeObj.strokeSettings.fillColor = value;\n        this.notify('shape', { prop: 'setStrokeSettings',\n            value: { strokeSettings: null, strokeColor: null, fillColor: this.activeObj.strokeSettings.fillColor,\n                strokeWidth: null } });\n        this.objColl.push(this.activeObj);\n        this.notify('undo-redo', { prop: 'updateUndoRedoColl', onPropertyChange: false,\n            value: { operation: 'shapeTransform', previousObj: prevObj, previousObjColl: prevObj.objColl,\n                previousPointColl: prevObj.pointColl, previousSelPointColl: prevObj.selPointColl,\n                previousCropObj: prevCropObj, previousText: null,\n                currentText: null, previousFilter: null, isCircleCrop: null } });\n        this.notify('selection', { prop: 'redrawShape', value: { obj: this.objColl[this.objColl.length - 1] } });\n    };\n    /**\n     * Get pascalToSplitWords from string.\n     *\n     * @param { string } str - Specifies the word.\n     * @hidden\n     * @returns {string}.\n     */\n    ImageEditor.prototype.pascalToSplitWords = function (str) {\n        str = str.charAt(0).toUpperCase() + str.slice(1);\n        var splitStr = str.match(/[A-Z][a-z]+/g);\n        if (isNullOrUndefined(splitStr)) {\n            return str;\n        }\n        else {\n            return splitStr.map(function (word) { return word.charAt(0).toUpperCase() + word.slice(1); }).join(' ');\n        }\n    };\n    /**\n     * Get Slider Value.\n     *\n     * @param { string } type - Finetune type.\n     * @hidden\n     * @returns {number}.\n     */\n    ImageEditor.prototype.getCurrAdjustmentValue = function (type) {\n        var obj = { adjustmentLevel: null };\n        this.notify('filter', { prop: 'getAdjustmentLevel', onPropertyChange: false,\n            value: { obj: obj } });\n        var typeToAdjustmentLevel = { 'brightness': obj['adjustmentLevel'].brightness,\n            'contrast': obj['adjustmentLevel'].contrast, 'hue': obj['adjustmentLevel'].hue,\n            'saturation': obj['adjustmentLevel'].saturation, 'opacity': obj['adjustmentLevel'].opacity,\n            'blur': obj['adjustmentLevel'].blur, 'exposure': obj['adjustmentLevel'].exposure };\n        return typeToAdjustmentLevel[\"\" + type];\n    };\n    /**\n     * Apply transformSelect.\n     *\n     * @param { string } type - Specifies the selected item text.\n     * @hidden\n     * @returns {void}.\n     */\n    ImageEditor.prototype.transformSelect = function (type) {\n        this.isCropToolbar = true;\n        this.setInitialZoomState();\n        var activeObj = extend({}, this.activeObj, {}, true);\n        this.cropSelectedState();\n        this.notify('draw', { prop: 'resetCurrentSelectionPoint' });\n        this.notify('transform', { prop: 'performTransformation', value: { text: type } });\n        this.notify('draw', { prop: 'moveToSelectionRange', value: { type: type, activeObj: activeObj } });\n        this.isCropToolbar = false;\n    };\n    /**\n     * Returns default filter.\n     *\n     * @hidden\n     * @returns {string}.\n     */\n    ImageEditor.prototype.getDefaultFilter = function () {\n        return 'brightness(' + 1 + ') ' + 'contrast(' + 100 + '%) ' + 'hue-rotate(' + 0 + 'deg) ' +\n            'saturate(' + 100 + '%) ' + 'opacity(' + 1 + ') ' + 'blur(' + 0 + 'px) ' + 'sepia(0%) ' +\n            'grayscale(0%) ' + 'invert(0%)';\n    };\n    // Blazor codes\n    /**\n     * To Initialize the component rendering\n     *\n     * @private\n     * @param {HTMLCanvasElement} element - Specifies the canvas element.\n     * @param {BlazorDotnetObject} dotnetRef - Specifies for blazor client to server communication.\n     * @returns {void}\n     */\n    ImageEditor.prototype.initializeImageEditor = function (element, dotnetRef) {\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        this.element = element;\n        var canvasWrapper = this.element.querySelector('.e-canvas-wrapper');\n        if (this.element.querySelector('#' + this.element.id + '_toolbarArea')) {\n            this.toolbarHeight = this.element.querySelector('#' + this.element.id + '_toolbarArea').clientHeight;\n        }\n        else {\n            this.toolbarHeight = 0;\n        }\n        canvasWrapper.style.height = (this.element.offsetHeight - this.toolbarHeight - 2) + 'px';\n        canvasWrapper.style.width = (this.element.offsetWidth - 2) + 'px';\n        this.lowerCanvas = this.element.querySelector('.e-lower-canvas');\n        this.upperCanvas = this.element.querySelector('.e-upper-canvas');\n        this.lowerCanvas.id = this.element.id + '_lowerCanvas';\n        this.upperCanvas.id = this.element.id + '_upperCanvas';\n        this.textArea = this.element.querySelector('.e-textbox');\n        this.inMemoryCanvas = this.createElement('canvas', {\n            id: this.element.id + '_inMemoryCanvas', attrs: { name: 'canvasImage' }\n        });\n        this.upperCanvas.width = this.lowerCanvas.width = this.inMemoryCanvas.width = this.element.offsetWidth;\n        this.upperCanvas.height = this.lowerCanvas.height = this.inMemoryCanvas.height = (this.element.offsetHeight - this.toolbarHeight);\n        this.lowerContext = this.lowerCanvas.getContext('2d');\n        this.baseImg = this.createElement('img', {\n            id: this.element.id + '_orgImg', attrs: { name: 'Image', crossorigin: 'anonymous' }\n        });\n        this.upperContext = this.upperCanvas.getContext('2d');\n        this.inMemoryContext = this.inMemoryCanvas.getContext('2d');\n        if (dotnetRef) {\n            this.dotNetRef = dotnetRef;\n        }\n        this.prerender();\n        this.wireEvent();\n        this.lowerContext.filter = this.getDefaultFilter();\n        this.notify('filter', { prop: 'setAdjustmentValue', onPropertyChange: false, value: { adjustmentValue: this.lowerContext.filter } });\n        this.canvasFilter = this.initialAdjustmentValue = this.lowerContext.filter;\n        if (this.cssClass) {\n            addClass([this.element], this.cssClass.replace(/\\s+/g, ' ').trim().split(' '));\n        }\n        if (this.element) {\n            createSpinner({\n                target: this.element\n            });\n        }\n        this.initializeZoomSettings();\n    };\n    ImageEditor.prototype.prerender = function () {\n        // pre render code snippets\n        this.element.id = this.element.id || getUniqueID('ej2-image-editor');\n        if (Browser.isDevice) {\n            this.element.classList.add('e-device');\n        }\n        this.initializeThemeColl();\n    };\n    ImageEditor.prototype.initializeZoomSettings = function () {\n        if (isNullOrUndefined(this.zoomSettings.zoomTrigger)) {\n            this.zoomSettings.zoomTrigger = (ZoomTrigger.MouseWheel | ZoomTrigger.Pinch | ZoomTrigger.Toolbar | ZoomTrigger.Commands);\n        }\n        if (isNullOrUndefined(this.selectionSettings.strokeColor)) {\n            this.selectionSettings.strokeColor = this.themeColl[this.theme]['primaryColor'];\n        }\n        if (isNullOrUndefined(this.selectionSettings.fillColor)) {\n            this.selectionSettings.fillColor = this.themeColl[this.theme]['secondaryColor'];\n        }\n    };\n    ImageEditor.prototype.initializeThemeColl = function () {\n        this.themeColl = {\n            Bootstrap5: { primaryColor: '#0d6efd', secondaryColor: '#fff' },\n            Bootstrap5Dark: { primaryColor: '#0d6efd', secondaryColor: '#fff' },\n            Tailwind: { primaryColor: '#4f46e5', secondaryColor: '#fff' },\n            TailwindDark: { primaryColor: '#22d3ee', secondaryColor: '#fff' },\n            Fluent: { primaryColor: '#0078d4', secondaryColor: '#fff' },\n            FluentDark: { primaryColor: '#0078d4', secondaryColor: '#fff' },\n            Bootstrap4: { primaryColor: '#007bff', secondaryColor: '#fff' },\n            Bootstrap: { primaryColor: '#317ab9', secondaryColor: '#fff' },\n            BootstrapDark: { primaryColor: '#317ab9', secondaryColor: '#fff' },\n            Material: { primaryColor: '#e3165b', secondaryColor: '#fff' },\n            MaterialDark: { primaryColor: '#00b0ff', secondaryColor: '#fff' },\n            Fabric: { primaryColor: '#0078d6', secondaryColor: '#fff' },\n            FabricDark: { primaryColor: '#0074cc', secondaryColor: '#fff' },\n            Highcontrast: { primaryColor: '#000000', secondaryColor: '#fff' },\n            Material3: { primaryColor: '#6750a4', secondaryColor: '#fff' },\n            Material3Dark: { primaryColor: '#d0bcff', secondaryColor: '#fff' }\n        };\n    };\n    /**\n     * Get the square point for path.\n     *\n     * @param { HTMLDivElement } element - Specifies element.\n     * @param { string } type - Specifies the type.\n     * @param { string } value - Specifies the value.\n     * @hidden\n     * @private\n     * @returns {void}.\n     */\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars, @typescript-eslint/no-empty-function\n    ImageEditor.prototype.updateToolbar = function (element, type, value) {\n    };\n    var ImageEditor_1;\n    __decorate([\n        Property('')\n    ], ImageEditor.prototype, \"cssClass\", void 0);\n    __decorate([\n        Property(false)\n    ], ImageEditor.prototype, \"disabled\", void 0);\n    __decorate([\n        Property('100%')\n    ], ImageEditor.prototype, \"height\", void 0);\n    __decorate([\n        Property('Bootstrap5')\n    ], ImageEditor.prototype, \"theme\", void 0);\n    __decorate([\n        Property()\n    ], ImageEditor.prototype, \"toolbar\", void 0);\n    __decorate([\n        Property()\n    ], ImageEditor.prototype, \"toolbarTemplate\", void 0);\n    __decorate([\n        Property('100%')\n    ], ImageEditor.prototype, \"width\", void 0);\n    __decorate([\n        Property(true)\n    ], ImageEditor.prototype, \"allowUndoRedo\", void 0);\n    __decorate([\n        Property(true)\n    ], ImageEditor.prototype, \"showQuickAccessToolbar\", void 0);\n    __decorate([\n        Property()\n    ], ImageEditor.prototype, \"quickAccessToolbarTemplate\", void 0);\n    __decorate([\n        Property(false)\n    ], ImageEditor.prototype, \"isReadOnly\", void 0);\n    __decorate([\n        Property(false)\n    ], ImageEditor.prototype, \"enableRtl\", void 0);\n    __decorate([\n        Property(false)\n    ], ImageEditor.prototype, \"enablePersistence\", void 0);\n    __decorate([\n        Complex({}, FinetuneSettings)\n    ], ImageEditor.prototype, \"finetuneSettings\", void 0);\n    __decorate([\n        Complex({}, ZoomSettings)\n    ], ImageEditor.prototype, \"zoomSettings\", void 0);\n    __decorate([\n        Complex({}, SelectionSettings)\n    ], ImageEditor.prototype, \"selectionSettings\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"beforeSave\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"created\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"destroyed\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"zooming\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"panning\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"cropping\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"rotating\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"flipping\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"shapeChanging\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"selectionChanging\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"fileOpened\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"saved\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"toolbarCreated\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"toolbarUpdating\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"toolbarItemClicked\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"imageFiltering\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"finetuneValueChanging\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"click\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"quickAccessToolbarOpen\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"quickAccessToolbarItemClick\", void 0);\n    ImageEditor = ImageEditor_1 = __decorate([\n        NotifyPropertyChanges\n    ], ImageEditor);\n    return ImageEditor;\n}(Component));\nexport { ImageEditor };\n","/**\n * An enum representing the file types supported by the image editor.\n *\n * @enum {string}\n */\nexport var FileType;\n(function (FileType) {\n    /** The PNG file type. */\n    FileType[\"Png\"] = \"Png\";\n    /** The JPEG file type. */\n    FileType[\"Jpeg\"] = \"Jpeg\";\n    /** The SVG file type. */\n    FileType[\"Svg\"] = \"Svg\";\n})(FileType || (FileType = {}));\n/**\n * An enumeration representing the direction of an image editor operation.\n *\n * @enum {string}\n */\nexport var Direction;\n(function (Direction) {\n    /** The horizontal direction. */\n    Direction[\"Horizontal\"] = \"Horizontal\";\n    /** The vertical direction. */\n    Direction[\"Vertical\"] = \"Vertical\";\n})(Direction || (Direction = {}));\n/**\n * An enumeration representing the type of shape to be added in the image editor.\n *\n * @enum {string}\n */\nexport var ShapeType;\n(function (ShapeType) {\n    /** A rectangle shape. */\n    ShapeType[\"Rectangle\"] = \"Rectangle\";\n    /** An ellipse shape. */\n    ShapeType[\"Ellipse\"] = \"Ellipse\";\n    /** A line shape. */\n    ShapeType[\"Line\"] = \"Line\";\n    /** An arrow shape. */\n    ShapeType[\"Arrow\"] = \"Arrow\";\n    /** A path shape. */\n    ShapeType[\"Path\"] = \"Path\";\n    /** A text shape. */\n    ShapeType[\"Text\"] = \"Text\";\n    /** A freehand drawing shape. */\n    ShapeType[\"FreehandDraw\"] = \"FreehandDraw\";\n})(ShapeType || (ShapeType = {}));\n/**\n * An enumeration representing the different ways to trigger zooming in the image editor.\n *\n * @aspNumberEnum\n */\nexport var ZoomTrigger;\n(function (ZoomTrigger) {\n    /** Zooming triggered by mouse wheel. */\n    ZoomTrigger[ZoomTrigger[\"MouseWheel\"] = 1] = \"MouseWheel\";\n    /** Zooming triggered by pinch gesture. */\n    ZoomTrigger[ZoomTrigger[\"Pinch\"] = 2] = \"Pinch\";\n    /** Zooming triggered by command keys. */\n    ZoomTrigger[ZoomTrigger[\"Commands\"] = 4] = \"Commands\";\n    /** Zooming triggered by toolbar button click. */\n    ZoomTrigger[ZoomTrigger[\"Toolbar\"] = 8] = \"Toolbar\";\n})(ZoomTrigger || (ZoomTrigger = {}));\n/**\n * * An enum representing the available themes in the image editor.\n */\nexport var Theme;\n(function (Theme) {\n    /** The Bootstrap 5 theme. */\n    Theme[\"Bootstrap5\"] = \"Bootstrap5\";\n    /** The dark variant of the Bootstrap 5 theme. */\n    Theme[\"Bootstrap5Dark\"] = \"Bootstrap5Dark\";\n    /** The Tailwind CSS theme. */\n    Theme[\"Tailwind\"] = \"Tailwind\";\n    /** The dark variant of the Tailwind CSS theme. */\n    Theme[\"TailwindDark\"] = \"TailwindDark\";\n    /** The Fluent UI theme. */\n    Theme[\"Fluent\"] = \"Fluent\";\n    /** The dark variant of the Fluent UI theme. */\n    Theme[\"FluentDark\"] = \"FluentDark\";\n    /** The Bootstrap 4 theme. */\n    Theme[\"Bootstrap4\"] = \"Bootstrap4\";\n    /** The Bootstrap theme. */\n    Theme[\"Bootstrap\"] = \"Bootstrap\";\n    /** The dark variant of the Bootstrap theme. */\n    Theme[\"BootstrapDark\"] = \"BootstrapDark\";\n    /** The Material Design theme. */\n    Theme[\"Material\"] = \"Material\";\n    /** The dark variant of the Material Design theme. */\n    Theme[\"MaterialDark\"] = \"MaterialDark\";\n    /** The Fabric theme. */\n    Theme[\"Fabric\"] = \"Fabric\";\n    /** The dark variant of the Fabric theme. */\n    Theme[\"FabricDark\"] = \"FabricDark\";\n    /** The high contrast theme. */\n    Theme[\"Highcontrast\"] = \"Highcontrast\";\n})(Theme || (Theme = {}));\n/**\n * An enum representing the available toolbar commands in the image editor.\n */\nexport var ImageEditorCommand;\n(function (ImageEditorCommand) {\n    ImageEditorCommand[\"Crop\"] = \"Crop\";\n    ImageEditorCommand[\"Transform\"] = \"Transform\";\n    ImageEditorCommand[\"Annotate\"] = \"Annotate\";\n    ImageEditorCommand[\"ZoomIn\"] = \"ZoomIn\";\n    ImageEditorCommand[\"ZoomOut\"] = \"ZoomOut\";\n    ImageEditorCommand[\"Open\"] = \"Open\";\n    ImageEditorCommand[\"Reset\"] = \"Reset\";\n    ImageEditorCommand[\"Save\"] = \"Save\";\n    ImageEditorCommand[\"Pan\"] = \"Pan\";\n    ImageEditorCommand[\"Move\"] = \"Move\";\n    ImageEditorCommand[\"Pen\"] = \"Pen\";\n    ImageEditorCommand[\"Line\"] = \"Line\";\n    ImageEditorCommand[\"Arrow\"] = \"Arrow\";\n    ImageEditorCommand[\"Path\"] = \"Path\";\n    ImageEditorCommand[\"Rectangle\"] = \"Rectangle\";\n    ImageEditorCommand[\"Ellipse\"] = \"Ellipse\";\n    ImageEditorCommand[\"Text\"] = \"Text\";\n    ImageEditorCommand[\"CustomSelection\"] = \"CustomSelection\";\n    ImageEditorCommand[\"CircleSelection\"] = \"CircleSelection\";\n    ImageEditorCommand[\"SquareSelection\"] = \"SquareSelection\";\n    ImageEditorCommand[\"RatioSelection\"] = \"RatioSelection\";\n    ImageEditorCommand[\"RotateLeft\"] = \"RotateLeft\";\n    ImageEditorCommand[\"RotateRight\"] = \"RotateRight\";\n    ImageEditorCommand[\"FlipHorizontal\"] = \"FlipHorizontal\";\n    ImageEditorCommand[\"FlipVertical\"] = \"FlipVertical\";\n})(ImageEditorCommand || (ImageEditorCommand = {}));\n/**\n * An enumeration of available image filter options.\n *\n * @remarks\n * These options can be used with the `applyImageFilter` method of the image editor control to apply filters to an image.\n */\nexport var ImageFilterOption;\n(function (ImageFilterOption) {\n    /** Default filter */\n    ImageFilterOption[\"Default\"] = \"Default\";\n    /** Chrome filter */\n    ImageFilterOption[\"Chrome\"] = \"Chrome\";\n    /** Cold filter */\n    ImageFilterOption[\"Cold\"] = \"Cold\";\n    /** Warm filter */\n    ImageFilterOption[\"Warm\"] = \"Warm\";\n    /** Grayscale filter */\n    ImageFilterOption[\"Grayscale\"] = \"Grayscale\";\n    /** Sepia filter */\n    ImageFilterOption[\"Sepia\"] = \"Sepia\";\n    /** Invert filter */\n    ImageFilterOption[\"Invert\"] = \"Invert\";\n})(ImageFilterOption || (ImageFilterOption = {}));\n/**\n * An enumeration of available image finetune options.\n *\n * @remarks\n * These options can be used with the `finetuneImage` method of the image editor control to apply finetuning to an image.\n */\nexport var ImageFinetuneOption;\n(function (ImageFinetuneOption) {\n    /** Adjust the brightness of the image */\n    ImageFinetuneOption[\"Brightness\"] = \"Brightness\";\n    /** Adjust the contrast of the image */\n    ImageFinetuneOption[\"Contrast\"] = \"Contrast\";\n    /** Adjust the hue of the image */\n    ImageFinetuneOption[\"Hue\"] = \"Hue\";\n    /** Adjust the saturation of the image */\n    ImageFinetuneOption[\"Saturation\"] = \"Saturation\";\n    /** Adjust the exposure of the image */\n    ImageFinetuneOption[\"Exposure\"] = \"Exposure\";\n    /** Adjust the opacity of the image */\n    ImageFinetuneOption[\"Opacity\"] = \"Opacity\";\n    /** Adjust the blur of the image */\n    ImageFinetuneOption[\"Blur\"] = \"Blur\";\n})(ImageFinetuneOption || (ImageFinetuneOption = {}));\n/**\n * Specifies the type of arrowhead should be drawn.\n *\n */\nexport var ArrowheadType;\n(function (ArrowheadType) {\n    /** Indicates no arrowhead should be drawn. */\n    ArrowheadType[\"None\"] = \"None\";\n    /** Indicates a normal triangle-shaped arrowhead should be drawn. */\n    ArrowheadType[\"Arrow\"] = \"Arrow\";\n    /** Indicates a solid triangle-shaped arrowhead should be drawn. */\n    ArrowheadType[\"SolidArrow\"] = \"SolidArrow\";\n    /** Indicates a circular-shaped arrowhead should be drawn. */\n    ArrowheadType[\"Circle\"] = \"Circle\";\n    /** Indicates a solid circular-shaped arrowhead should be drawn. */\n    ArrowheadType[\"SolidCircle\"] = \"SolidCircle\";\n    /** Indicates a square-shaped arrowhead should be drawn. */\n    ArrowheadType[\"Square\"] = \"Square\";\n    /** Indicates a solid square-shaped arrowhead should be drawn. */\n    ArrowheadType[\"SolidSquare\"] = \"SolidSquare\";\n    /** Indicates a bar shaped arrowhead should be drawn. */\n    ArrowheadType[\"Bar\"] = \"Bar\";\n})(ArrowheadType || (ArrowheadType = {}));\n","import { extend, Browser, detach, select } from '@syncfusion/ej2-base';\nimport { EventHandler, getComponent, isNullOrUndefined, L10n } from '@syncfusion/ej2-base';\nimport { Toolbar } from '@syncfusion/ej2-navigations';\nimport { DropDownButton } from '@syncfusion/ej2-splitbuttons';\nimport { ColorPicker, Uploader, Slider } from '@syncfusion/ej2-inputs';\nimport { ZoomTrigger } from '../index';\nimport { hideSpinner, showSpinner } from '@syncfusion/ej2-popups';\nvar ToolbarModule = /** @class */ (function () {\n    function ToolbarModule(parent) {\n        this.defToolbarItems = [];\n        this.toolbarHeight = 46;\n        this.currToolbar = '';\n        this.preventZoomBtn = false;\n        this.currentToolbar = 'main';\n        this.selFhdColor = '#42a5f5';\n        this.preventEnableDisableUr = false;\n        this.parent = parent;\n        this.addEventListener();\n        this.initLocale();\n    }\n    ToolbarModule.prototype.destroy = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.removeEventListener();\n    };\n    ToolbarModule.prototype.addEventListener = function () {\n        this.parent.on('toolbar', this.toolbar, this);\n        this.parent.on('destroyed', this.destroy, this);\n    };\n    ToolbarModule.prototype.removeEventListener = function () {\n        this.parent.off('toolbar', this.toolbar);\n        this.parent.off('destroyed', this.destroy);\n    };\n    ToolbarModule.prototype.initLocale = function () {\n        this.defaultLocale = {\n            Crop: 'Crop',\n            ZoomIn: 'Zoom In',\n            ZoomOut: 'Zoom Out',\n            Undo: 'Undo',\n            Redo: 'Redo',\n            Transform: 'Transform',\n            Annotation: 'Annotation',\n            Finetune: 'Finetune',\n            Brightness: 'Brightness',\n            Contrast: 'Contrast',\n            Hue: 'Hue',\n            Saturation: 'Saturation',\n            Opacity: 'Opacity',\n            Blur: 'Blur',\n            Sharpen: 'Sharpen',\n            Exposure: 'Exposure',\n            Filter: 'Filter',\n            Default: 'Default',\n            Chrome: 'Chrome',\n            Cold: 'Cold',\n            Warm: 'Warm',\n            Grayscale: 'Grayscale',\n            BlackAndWhite: 'Black and White',\n            Sepia: 'Sepia',\n            Invert: 'Invert',\n            Text: 'Add Text',\n            Pen: 'Pen',\n            Reset: 'Reset',\n            Save: 'Save',\n            Select: 'Select',\n            RotateLeft: 'Rotate Left',\n            RotateRight: 'Rotate Right',\n            HorizontalFlip: 'Horizontal Flip',\n            VerticalFlip: 'Vertical Flip',\n            OK: 'OK',\n            Cancel: 'Cancel',\n            FillColor: 'Fill Color',\n            StrokeColor: 'Stroke Color',\n            StrokeWidth: 'Stroke Width',\n            FontFamily: 'Font Family',\n            FontStyle: 'Font Style',\n            FontSize: 'Font Size',\n            FontColor: 'Font Color',\n            Pan: 'Pan',\n            Move: 'Move',\n            Load: 'Load',\n            Custom: 'Custom',\n            Square: 'Square',\n            Circle: 'Circle',\n            Ellipse: 'Ellipse',\n            Rectangle: 'Rectangle',\n            Line: 'Line',\n            Arrow: 'Arrow',\n            Path: 'Path',\n            Bold: 'Bold',\n            Italic: 'Italic',\n            BoldItalic: 'Bold Italic',\n            XSmall: 'X-Small',\n            Small: 'Small',\n            Medium: 'Medium',\n            Large: 'Large',\n            XLarge: 'X-Large',\n            ABC: 'ABC',\n            Browse: 'Browse',\n            Duplicate: 'Duplicate',\n            Remove: 'Remove',\n            EditText: 'Edit Text',\n            Start: 'Start',\n            End: 'End',\n            Bar: 'Bar',\n            ArrowSolid: 'Arrow Solid',\n            CircleSolid: 'Circle Solid',\n            SquareSolid: 'Square Solid',\n            None: 'None',\n            CropAndTransform: 'Crop and Transform',\n            CropSelection: 'Crop Selection'\n        };\n        this.l10n = new L10n('image-editor', this.defaultLocale, this.parent.locale);\n    };\n    ToolbarModule.prototype.toolbar = function (args) {\n        var parent = this.parent;\n        this.updatePrivateVariables();\n        switch (args.prop) {\n            case 'create-toolbar':\n                this.createToolbar();\n                break;\n            case 'create-contextual-toolbar':\n                this.createContextualToolbar();\n                break;\n            case 'update-toolbar-items':\n                this.updateToolbarItems();\n                break;\n            case 'refresh-toolbar':\n                this.refreshToolbar(args.value['type'], args.value['isApplyBtn'], args.value['isCropping'], args.value['isZooming'], args.value['cType']);\n                break;\n            case 'renderQAT':\n                this.renderQAT(args.value['isPenEdit']);\n                break;\n            case 'enable-disable-btns':\n                this.enableDisableTbrBtn();\n                break;\n            case 'init-main-toolbar':\n                this.initMainToolbar(args.value['isApplyBtn'], args.value['isDevice'], args.value['isOkBtn']);\n                break;\n            case 'create-bottom-toolbar':\n                this.createBottomToolbar();\n                break;\n            case 'refresh-main-toolbar':\n                this.refreshMainToolbar();\n                break;\n            case 'create-qa-toolbar':\n                this.createQuickAccessToolbar();\n                break;\n            case 'destroy-qa-toolbar':\n                this.destroyQuickAccessToolbar();\n                break;\n            case 'zoom-up-handler':\n                this.zoomBtnMouseUpHandler();\n                break;\n            case 'refresh-dropdown-btn':\n                this.refreshDropDownBtn(args.value['isDisabled']);\n                break;\n            case 'close-contextual-toolbar':\n                this.closeContextualToolbar();\n                break;\n            case 'destroy-bottom-toolbar':\n                this.destroyBottomToolbar();\n                break;\n            case 'destroy-top-toolbar':\n                this.destroyTopToolbar();\n                break;\n            case 'destroySubComponents':\n                this.destroySubComponents();\n                break;\n            case 'setLocale':\n                this.l10n.setLocale(args.value['locale']);\n                break;\n            case 'setPreventZoomBtn':\n                this.preventZoomBtn = args.value['isPrevent'];\n                break;\n            case 'getToolbarHeight':\n                args.value['obj']['toolbarHeight'] = this.toolbarHeight;\n                break;\n            case 'setToolbarHeight':\n                this.toolbarHeight = args.value['height'];\n                break;\n            case 'setCurrentToolbar':\n                this.currentToolbar = args.value['type'];\n                break;\n            case 'setSelectedFreehandColor':\n                this.selFhdColor = args.value['color'];\n                break;\n            case 'getCurrentFilter':\n                args.value['obj']['currentFilter'] = parent.currentFilter;\n                break;\n            case 'setCurrentFilter':\n                parent.currentFilter = args.value['filter'];\n                break;\n            case 'setInitialAdjustmentValue':\n                parent.initialAdjustmentValue = args.value['value'];\n                break;\n            case 'getCanvasFilter':\n                args.value['obj']['canvasFilter'] = parent.canvasFilter;\n                break;\n            case 'getDefToolbarItems':\n                args.value['obj']['defToolbarItems'] = this.defToolbarItems;\n                break;\n            case 'getPenStroke':\n                this.getPenStroke(args.value['value']);\n                break;\n            case 'performDefToolbarClickAction':\n                this.performDefTbrClick(args.value['type'], args.value['isContextualToolbar'], args.value['isDisabledAdjustment'], args.value['isDisabledFilter'], args.value['isFilterFinetune']);\n                break;\n            case 'setTempFilterProperties':\n                parent.setTempFilterProperties();\n                break;\n            case 'refreshSlider':\n                this.refreshSlider();\n                break;\n            case 'renderSlider':\n                this.renderSlider(args.value['type']);\n                break;\n            case 'getCurrAdjustmentValue':\n                parent.getCurrAdjustmentValue(args.value['type']);\n                break;\n            case 'setCurrAdjustmentValue':\n                parent.setCurrAdjustmentValue(args.value['type'], args.value['value']);\n                break;\n            case 'refreshShapeDrawing':\n                this.refreshShapeDrawing();\n                break;\n            case 'getCropToolbar':\n                args.value['obj']['isCropToolbar'] = parent.isCropToolbar;\n                break;\n            case 'getPrevCurrSelectionPoint':\n                args.value['obj']['prevCurrSelectionPoint'] = parent.prevCurrSelectionPoint;\n                break;\n            case 'setPrevCurrSelectionPoint':\n                parent.prevCurrSelectionPoint = args.value['point'];\n                break;\n            case 'updateCropTransformItems':\n                parent.updateCropTransformItems();\n                break;\n            case 'setEnableDisableUndoRedo':\n                this.preventEnableDisableUr = args.value['isPrevent'];\n                break;\n            case 'reset':\n                this.reset();\n                break;\n        }\n    };\n    ToolbarModule.prototype.updatePrivateVariables = function () {\n        var parent = this.parent;\n        this.inMemoryCanvas = parent.inMemoryCanvas;\n        if (parent.lowerCanvas) {\n            this.lowerContext = parent.lowerCanvas.getContext('2d');\n        }\n        if (parent.upperCanvas) {\n            this.upperContext = parent.upperCanvas.getContext('2d');\n        }\n        if (this.inMemoryCanvas) {\n            this.inMemoryContext = this.inMemoryCanvas.getContext('2d');\n        }\n    };\n    ToolbarModule.prototype.reset = function () {\n        var parent = this.parent;\n        this.defToolbarItems = [];\n        this.toolbarHeight = 46;\n        parent.prevCurrSelectionPoint = null;\n        this.zoomBtnHold = null;\n        this.currToolbar = '';\n        this.currentToolbar = 'main';\n        this.selFhdColor = '#42a5f5';\n        parent.currentFilter = '';\n        this.preventZoomBtn = parent.isCropToolbar = this.preventEnableDisableUr = false;\n        parent.initialAdjustmentValue = parent.canvasFilter =\n            'brightness(' + 1 + ') ' + 'contrast(' + 100 + '%) ' + 'hue-rotate(' + 0 + 'deg) ' +\n                'saturate(' + 100 + '%) ' + 'opacity(' + 1 + ') ' + 'blur(' + 0 + 'px) ' + 'sepia(0%) ' + 'grayscale(0%) ' + 'invert(0%)';\n    };\n    ToolbarModule.prototype.destroyTopToolbar = function () {\n        var parent = this.parent;\n        var toolbar = document.getElementById(parent.element.id + '_toolbar');\n        if (this.isToolbar() && toolbar && toolbar.classList.contains('e-control')) {\n            getComponent(document.getElementById(parent.element.id + '_toolbar'), 'toolbar').destroy();\n        }\n    };\n    ToolbarModule.prototype.destroyBottomToolbar = function () {\n        var parent = this.parent;\n        var toolbar = document.getElementById(parent.element.id + '_bottomToolbar');\n        if (toolbar && toolbar.classList.contains('e-control')) {\n            getComponent(document.getElementById(parent.element.id + '_bottomToolbar'), 'toolbar').destroy();\n        }\n    };\n    ToolbarModule.prototype.isToolbar = function () {\n        var parent = this.parent;\n        return (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.length > 0)\n            || !isNullOrUndefined(parent.toolbarTemplate));\n    };\n    ToolbarModule.prototype.createToolbar = function () {\n        var _this = this;\n        var parent = this.parent;\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.length > 0)) {\n            parent.element.appendChild(parent.createElement('div', {\n                id: parent.element.id + '_toolbarArea', className: 'e-toolbar-area'\n            }));\n            var toolbarItems = { cssClass: 'e-image-upload', align: 'Left', type: 'Input',\n                tooltipText: this.l10n.getConstant('Browse'), template: new Uploader({ allowedExtensions: '.jpg, .jpeg, .png,.svg' }) };\n            if (isNullOrUndefined(this.defToolbarItems)) {\n                this.defToolbarItems = [];\n            }\n            this.defToolbarItems.push(toolbarItems);\n            var toolbarArea = document.getElementById(parent.element.id + '_toolbarArea');\n            var toolbar_1 = parent.createElement('div', {\n                id: parent.element.id + '_toolbar'\n            });\n            toolbarArea.appendChild(toolbar_1);\n            var uploadItems = [\n                {\n                    cssClass: 'e-image-upload',\n                    align: 'Left', type: 'Input',\n                    tooltipText: this.l10n.getConstant('Browse'),\n                    template: new Uploader({\n                        allowedExtensions: '.jpg, .jpeg, .png,.svg',\n                        selected: function () {\n                            if (!parent.disabled) {\n                                if (Browser.isDevice) {\n                                    if (_this.defToolbarItems.length > 0 &&\n                                        document.getElementById(parent.element.id + '_toolbar')) {\n                                        getComponent(document.getElementById(parent.element.id + '_toolbar'), 'toolbar').destroy();\n                                    }\n                                    if (document.getElementById(parent.element.id + '_bottomToolbar')) {\n                                        getComponent(document.getElementById(parent.element.id + '_bottomToolbar'), 'toolbar').destroy();\n                                    }\n                                    _this.initMainToolbar(false, Browser.isDevice, null);\n                                    _this.createBottomToolbar();\n                                }\n                                else {\n                                    if (_this.defToolbarItems.length > 0 &&\n                                        document.getElementById(parent.element.id + '_toolbar')) {\n                                        getComponent(document.getElementById(parent.element.id + '_toolbar'), 'toolbar').destroy();\n                                    }\n                                    _this.initMainToolbar(false, false, null);\n                                }\n                            }\n                        }\n                    })\n                }\n            ];\n            var toolbarObj = new Toolbar({ items: uploadItems, width: '100%',\n                created: function () {\n                    parent.trigger('toolbarCreated', { toolbarType: 'main' });\n                },\n                clicked: this.defToolbarClicked.bind(this) });\n            toolbarObj.appendTo('#' + parent.element.id + '_toolbar');\n            this.createLeftToolbarControls();\n            if (document.getElementById(parent.element.id + '_toolbar')) {\n                this.toolbarHeight = document.getElementById(parent.element.id + '_toolbar').clientHeight;\n            }\n        }\n        else {\n            this.toolbarHeight = 0;\n        }\n    };\n    ToolbarModule.prototype.createContextualToolbar = function () {\n        var parent = this.parent;\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.length > 0)) {\n            parent.element.appendChild(parent.createElement('div', { id: parent.element.id + '_contextualToolbarArea',\n                className: 'e-contextual-toolbar-wrapper e-hide', attrs: { style: 'position: absolute;' }\n            }));\n            var toolbarArea = document.getElementById(parent.element.id + '_contextualToolbarArea');\n            var toolbar_2 = parent.createElement('div', { id: parent.element.id + '_contextualToolbar' });\n            toolbarArea.appendChild(toolbar_2);\n        }\n    };\n    ToolbarModule.prototype.createBottomToolbar = function () {\n        var parent = this.parent;\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.length > 0)) {\n            parent.element.appendChild(parent.createElement('div', {\n                id: parent.element.id + '_bottomToolbarArea', className: 'e-bottom-toolbar'\n            }));\n            if (!parent.toolbarTemplate) {\n                document.getElementById(parent.element.id + '_canvasWrapper').style.height = (parent.element.offsetHeight\n                    - this.toolbarHeight * 2) - 3 + 'px';\n                var toolbarArea = document.getElementById(parent.element.id + '_bottomToolbarArea');\n                var toolbarElem = parent.createElement('div', {\n                    id: parent.element.id + '_bottomToolbar'\n                });\n                toolbarArea.appendChild(toolbarElem);\n            }\n            this.initBottomToolbar();\n        }\n    };\n    ToolbarModule.prototype.createQuickAccessToolbar = function () {\n        var parent = this.parent;\n        if (parent.showQuickAccessToolbar) {\n            var toolbarItems = { cssClass: 'e-image-upload', align: 'Left', type: 'Input',\n                tooltipText: this.l10n.getConstant('Browse'), template: new Uploader({ allowedExtensions: '.jpg, .jpeg, .png,.svg' }) };\n            if (isNullOrUndefined(this.defToolbarItems)) {\n                this.defToolbarItems = [];\n            }\n            this.defToolbarItems.push(toolbarItems);\n            var toolbarArea = document.getElementById(parent.element.id + '_quickAccessToolbarArea');\n            var toolbar_3 = parent.createElement('div', {\n                id: parent.element.id + '_quickAccessToolbar'\n            });\n            toolbarArea.appendChild(toolbar_3);\n            var toolbarObj = new Toolbar({ clicked: this.defToolbarClicked.bind(this) });\n            toolbarObj.appendTo('#' + parent.element.id + '_quickAccessToolbar');\n        }\n    };\n    ToolbarModule.prototype.initMainToolbar = function (isApplyOption, isDevice, isOkBtn) {\n        var _this = this;\n        var parent = this.parent;\n        if (this.isToolbar()) {\n            var leftItem = this.getLeftToolbarItem(isOkBtn);\n            var rightItem = this.getRightToolbarItem(isOkBtn);\n            var mainItem = this.getMainToolbarItem(isApplyOption);\n            var zoomItem = this.getZoomToolbarItem();\n            if (isDevice) {\n                this.defToolbarItems = leftItem.concat(rightItem);\n            }\n            else {\n                this.defToolbarItems = leftItem.concat(mainItem, rightItem, zoomItem);\n            }\n            var toolbarObj = new Toolbar({\n                width: '100%',\n                items: this.defToolbarItems,\n                clicked: this.defToolbarClicked.bind(this),\n                created: function () {\n                    if (!isDevice) {\n                        _this.renderAnnotationBtn();\n                    }\n                    _this.wireZoomBtnEvents();\n                    _this.renderSaveBtn();\n                    parent.trigger('toolbarCreated', { toolbarType: 'main' });\n                }\n            });\n            toolbarObj.appendTo('#' + parent.element.id + '_toolbar');\n            this.createLeftToolbarControls();\n            this.enableDisableTbrBtn();\n            if (this.isToolbar() && document.getElementById(parent.element.id + '_toolbar')) {\n                /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                var toolbar_4 = getComponent(parent.element.id + '_toolbar', 'toolbar');\n                toolbar_4.refreshOverflow();\n            }\n        }\n    };\n    ToolbarModule.prototype.initBottomToolbar = function () {\n        var _this = this;\n        var parent = this.parent;\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.length > 0)) {\n            var items = this.getMainToolbarItem();\n            var toolbarObj = new Toolbar({ items: items, width: '100%',\n                created: function () {\n                    _this.renderAnnotationBtn();\n                    _this.renderCropBtn();\n                    _this.renderTransformBtn();\n                    parent.trigger('toolbarCreated', { toolbarType: 'main' });\n                },\n                clicked: this.defToolbarClicked.bind(this)\n            });\n            toolbarObj.appendTo('#' + parent.element.id + '_bottomToolbar');\n            if (this.defToolbarItems.length > 0 && document.getElementById(parent.element.id + '_bottomToolbar')) {\n                /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                var toolbar_5 = getComponent(parent.element.id + '_bottomToolbar', 'toolbar');\n                toolbar_5.refreshOverflow();\n            }\n        }\n    };\n    ToolbarModule.prototype.getLeftToolbarItem = function (isOkBtn) {\n        var parent = this.parent;\n        var toolbarItems = [];\n        if (!isOkBtn) {\n            toolbarItems.push({ id: parent.element.id + '_upload', cssClass: 'e-image-upload', align: 'Left', type: 'Input', template: new Uploader({ allowedExtensions: '.jpg, .jpeg, .png,.svg' }) });\n            toolbarItems.push({ visible: false, cssClass: 'e-image-position e-btn e-flat', tooltipText: this.l10n.getConstant('Browse'), align: 'Left' });\n        }\n        if (parent.allowUndoRedo) {\n            if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Undo') > -1)) {\n                toolbarItems.push({ id: parent.element.id + '_undo', prefixIcon: 'e-icons e-undo', cssClass: 'top-icon e-undo',\n                    tooltipText: this.l10n.getConstant('Undo'), align: 'Left' });\n            }\n            if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Redo') > -1)) {\n                toolbarItems.push({ id: parent.element.id + '_redo', prefixIcon: 'e-icons e-redo', cssClass: 'top-icon e-redo',\n                    tooltipText: this.l10n.getConstant('Redo'), align: 'Left' });\n            }\n        }\n        if (!this.preventZoomBtn && (parent.zoomSettings.zoomTrigger & ZoomTrigger.Toolbar) === ZoomTrigger.Toolbar) {\n            if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('ZoomOut') > -1)) {\n                toolbarItems.push({ id: parent.element.id + '_zoomOut', prefixIcon: 'e-icons e-zoom-out', cssClass: 'top-icon e-dec-zoom',\n                    tooltipText: this.l10n.getConstant('ZoomOut'), align: 'Left' });\n            }\n            if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('ZoomIn') > -1)) {\n                toolbarItems.push({ id: parent.element.id + '_zoomIn', prefixIcon: 'e-icons e-zoom-in', cssClass: 'top-icon e-inc-zoom',\n                    tooltipText: this.l10n.getConstant('ZoomIn'), align: 'Left' });\n            }\n        }\n        var tempToolbarItems = this.processToolbar('left');\n        for (var i = 0, len = tempToolbarItems.length; i < len; i++) {\n            toolbarItems.push(tempToolbarItems[i]);\n        }\n        return toolbarItems;\n    };\n    ToolbarModule.prototype.getRightToolbarItem = function (isOkBtn) {\n        var parent = this.parent;\n        var toolbarItems = [];\n        if (isOkBtn) {\n            toolbarItems.push({ id: parent.element.id + '_ok', prefixIcon: 'e-icons e-check', cssClass: 'top-icon e-tick',\n                tooltipText: this.l10n.getConstant('OK'), align: 'Right' });\n            toolbarItems.push({ id: parent.element.id + '_cancel', prefixIcon: 'e-icons e-close', cssClass: 'top-icon e-save',\n                tooltipText: this.l10n.getConstant('Cancel'), align: 'Right' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Reset') > -1)) {\n            toolbarItems.push({ id: parent.element.id + '_reset', prefixIcon: 'e-icons e-btn-reset', cssClass: 'top-icon e-img-reset',\n                tooltipText: this.l10n.getConstant('Reset'), align: 'Right' });\n        }\n        if (!isOkBtn) {\n            if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Save') > -1)) {\n                toolbarItems.push({ id: parent.element.id + '_save', prefixIcon: 'e-icons e-btn-save', cssClass: 'top-icon e-save',\n                    tooltipText: this.l10n.getConstant('Save'), align: 'Right', template: '<button id=\"' + parent.element.id + '_saveBtn\"></button>' });\n            }\n        }\n        var tempToolbarItems = this.processToolbar('right');\n        for (var i = 0, len = tempToolbarItems.length; i < len; i++) {\n            toolbarItems.push(tempToolbarItems[i]);\n        }\n        return toolbarItems;\n    };\n    ToolbarModule.prototype.getMainToolbarItem = function (isApplyOption) {\n        var parent = this.parent;\n        var toolbarItems = [];\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Crop') > -1)) {\n            toolbarItems.push({ id: parent.element.id + '_cropTransform', prefixIcon: 'e-icons e-crop', cssClass: 'top-icon e-crop',\n                tooltipText: this.l10n.getConstant('CropAndTransform'), align: 'Center' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Annotate') > -1)) {\n            toolbarItems.push({ id: parent.element.id + '_annotation', tooltipText: this.l10n.getConstant('Annotation'), align: 'Center',\n                template: '<button id=\"' + parent.element.id + '_annotationBtn\"></button>' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Finetune') > -1)) {\n            toolbarItems.push({ id: parent.element.id + '_adjustment', prefixIcon: 'e-icons e-adjustment', cssClass: 'top-icon e-adjustment',\n                tooltipText: this.l10n.getConstant('Finetune'), align: 'Center' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Filter') > -1)) {\n            toolbarItems.push({ id: parent.element.id + '_filter', prefixIcon: 'e-icons e-filters', cssClass: 'top-icon e-filters',\n                tooltipText: this.l10n.getConstant('Filter'), align: 'Center' });\n        }\n        var tempToolbarItems = this.processToolbar('center');\n        for (var i = 0, len = tempToolbarItems.length; i < len; i++) {\n            toolbarItems.push(tempToolbarItems[i]);\n        }\n        if (isApplyOption) {\n            toolbarItems.push({ id: parent.element.id + '_ok', prefixIcon: 'e-icons e-check', cssClass: 'top-icon e-tick',\n                tooltipText: this.l10n.getConstant('OK'), align: 'Right' });\n            toolbarItems.push({ id: parent.element.id + '_cancel', prefixIcon: 'e-icons e-close', cssClass: 'top-icon e-save',\n                tooltipText: this.l10n.getConstant('Cancel'), align: 'Right' });\n        }\n        return toolbarItems;\n    };\n    ToolbarModule.prototype.getZoomToolbarItem = function () {\n        var toolbarItems = [];\n        return toolbarItems;\n    };\n    ToolbarModule.prototype.updateContextualToolbar = function (type, cType) {\n        var parent = this.parent;\n        var toolbarArea = parent.element.querySelector('#' + parent.element.id + '_toolbarArea');\n        var contextualToolbarArea = parent.element.querySelector('#' + parent.element.id + '_contextualToolbarArea');\n        contextualToolbarArea.classList.remove('e-hide');\n        contextualToolbarArea.style.left = toolbarArea.offsetLeft + 'px';\n        if (type === 'filter') {\n            if (document.getElementById(parent.element.id + '_toolbar') && this.defToolbarItems.length > 0) {\n                getComponent(document.getElementById(parent.element.id + '_toolbar'), 'toolbar').destroy();\n            }\n            if (Browser.isDevice) {\n                this.initMainToolbar(false, true, true);\n            }\n            else {\n                this.initMainToolbar(true, null, null);\n            }\n            this.refreshSlider();\n            this.initFilterToolbarItem();\n        }\n        else {\n            if (document.querySelector('#' + parent.element.id + '_contextualToolbar').classList.contains('e-control')) {\n                getComponent(document.getElementById(parent.element.id + '_contextualToolbar'), 'toolbar').destroy();\n            }\n            this.refreshSlider();\n            this.renderSlider(cType);\n        }\n        if (Browser.isDevice) {\n            var cHt = contextualToolbarArea.offsetHeight;\n            var ht = parent.element.querySelector('#' + parent.element.id + '_canvasWrapper').offsetHeight;\n            contextualToolbarArea.style.top = this.toolbarHeight + ht - cHt + 'px';\n        }\n        else {\n            contextualToolbarArea.style.top = this.toolbarHeight + 'px';\n        }\n    };\n    ToolbarModule.prototype.processToolbar = function (position) {\n        var parent = this.parent;\n        var toolbarItems = [];\n        if (parent.toolbar) {\n            for (var i = 0, len = parent.toolbar.length; i < len; i++) {\n                if (typeof (parent.toolbar[i]) === 'object') {\n                    if (isNullOrUndefined(parent.toolbar[i].align)) {\n                        if (position === 'left') {\n                            toolbarItems.push(parent.toolbar[i]);\n                        }\n                    }\n                    else if (parent.toolbar[i].align.toLowerCase() === position) {\n                        toolbarItems.push(parent.toolbar[i]);\n                    }\n                }\n            }\n        }\n        return toolbarItems;\n    };\n    ToolbarModule.prototype.processSubToolbar = function (items) {\n        var toolbarItems = [];\n        if (items) {\n            for (var i = 0, len = items.length; i < len; i++) {\n                if (typeof (items[i]) === 'object') {\n                    items[i].align = 'Center';\n                    toolbarItems.push(items[i]);\n                }\n            }\n        }\n        return toolbarItems;\n    };\n    ToolbarModule.prototype.wireZoomBtnEvents = function () {\n        var zoomIn = document.querySelector('#' + this.parent.element.id + '_zoomIn');\n        var zoomOut = document.querySelector('#' + this.parent.element.id + '_zoomOut');\n        if (zoomIn) {\n            zoomIn.addEventListener('mousedown', this.zoomInBtnMouseDownHandler.bind(this));\n            zoomIn.addEventListener('mouseup', this.zoomBtnMouseUpHandler.bind(this));\n            zoomIn.addEventListener('click', this.zoomInBtnClickHandler.bind(this));\n            zoomIn.addEventListener('touchstart', this.zoomInBtnClickHandler.bind(this));\n        }\n        if (zoomOut) {\n            zoomOut.addEventListener('mousedown', this.zoomOutBtnMouseDownHandler.bind(this));\n            zoomOut.addEventListener('mouseup', this.zoomBtnMouseUpHandler.bind(this));\n            zoomOut.addEventListener('click', this.zoomOutBtnClickHandler.bind(this));\n            zoomIn.addEventListener('touchstart', this.zoomInBtnClickHandler.bind(this));\n        }\n    };\n    ToolbarModule.prototype.enableDisableTbrBtn = function () {\n        var parent = this.parent;\n        if (!this.preventEnableDisableUr) {\n            var object = { appliedUndoRedoColl: [] };\n            parent.notify('undo-redo', { prop: 'getAppliedUndoRedoColl', value: { obj: object } });\n            var undoRedoObj = { undoRedoStep: null };\n            parent.notify('undo-redo', { prop: 'getUndoRedoStep', value: { obj: undoRedoObj } });\n            var undo = document.querySelector('#' + parent.element.id + '_undo');\n            if (undo && undoRedoObj['undoRedoStep'] === 0) {\n                undo.classList.add('e-disabled');\n                undo.parentElement.classList.add('e-overlay');\n            }\n            else if (undo && undoRedoObj['undoRedoStep'] > 0) {\n                undo.classList.remove('e-disabled');\n                undo.parentElement.classList.remove('e-overlay');\n            }\n            var redo = document.querySelector('#' + parent.element.id + '_redo');\n            if (redo && (undoRedoObj['undoRedoStep'] === object['appliedUndoRedoColl'].length)) {\n                redo.classList.add('e-disabled');\n                redo.parentElement.classList.add('e-overlay');\n            }\n            else if (redo && (undoRedoObj['undoRedoStep'] === 0 && object['appliedUndoRedoColl'].length > 0)) {\n                redo.classList.remove('e-disabled');\n                redo.parentElement.classList.remove('e-overlay');\n            }\n            else if (redo && undoRedoObj['undoRedoStep'] > 0) {\n                redo.classList.remove('e-disabled');\n                redo.parentElement.classList.remove('e-overlay');\n            }\n        }\n        var zoomIn = document.querySelector('#' + parent.element.id + '_zoomIn');\n        if (zoomIn && parent.zoomSettings.zoomFactor >= parent.zoomSettings.maxZoomFactor) {\n            zoomIn.classList.add('e-disabled');\n            zoomIn.parentElement.classList.add('e-overlay');\n        }\n        else if (zoomIn) {\n            zoomIn.classList.remove('e-disabled');\n            zoomIn.parentElement.classList.remove('e-overlay');\n        }\n        var zoomOut = document.querySelector('#' + parent.element.id + '_zoomOut');\n        if (zoomOut && parent.zoomSettings.zoomFactor <= parent.zoomSettings.minZoomFactor) {\n            zoomOut.classList.add('e-disabled');\n            zoomOut.parentElement.classList.add('e-overlay');\n        }\n        else if (zoomOut) {\n            zoomOut.classList.remove('e-disabled');\n            zoomOut.parentElement.classList.remove('e-overlay');\n        }\n        var pan = document.querySelector('#' + parent.element.id + '_pan');\n        if (pan && parent.zoomSettings.zoomFactor <= parent.zoomSettings.minZoomFactor) {\n            pan.style.display = 'none';\n        }\n        else if (pan) {\n            pan.style.display = 'block';\n        }\n    };\n    ToolbarModule.prototype.createLeftToolbarControls = function () {\n        var parent = this.parent;\n        if (this.defToolbarItems !== undefined && this.defToolbarItems.length > 0 &&\n            (document.getElementById(parent.element.id + '_toolbar'))) {\n            var uploadDiv = document.getElementById(parent.element.id + '_toolbar')\n                .querySelector('.e-image-upload');\n            if (uploadDiv) {\n                var uploadElem = uploadDiv.getElementsByTagName('input')[0];\n                var uploadBtnElem = uploadDiv.getElementsByTagName('button')[0];\n                uploadBtnElem.className = 'e-tbar-btn e-tbtn-txt top-icon';\n                uploadBtnElem.innerHTML = '';\n                uploadBtnElem.appendChild(parent.createElement('span', {\n                    className: 'e-btn-icon e-icons e-upload-icon e-icon-left'\n                }));\n                uploadElem.onchange = this.fileSelect.bind(this, uploadElem);\n            }\n        }\n    };\n    ToolbarModule.prototype.fileSelect = function (inputElement, args) {\n        this.parent.notify('draw', { prop: 'fileSelect', value: { inputElement: inputElement, args: args } });\n    };\n    ToolbarModule.prototype.renderAnnotationBtn = function (isContextualToolbar) {\n        var _this = this;\n        var parent = this.parent;\n        var items = [];\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Pen') > -1)) {\n            items.push({ text: this.l10n.getConstant('Pen'), id: 'pen', iconCss: 'e-icons e-free-pen' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Line') > -1)) {\n            items.push({ text: this.l10n.getConstant('Line'), id: 'line', iconCss: 'e-icons e-line' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Rectangle') > -1)) {\n            items.push({ text: this.l10n.getConstant('Rectangle'), id: 'rectangle', iconCss: 'e-icons e-rectangle' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Ellipse') > -1)) {\n            items.push({ text: this.l10n.getConstant('Ellipse'), id: 'ellipse', iconCss: 'e-icons e-circle' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Arrow') > -1)) {\n            items.push({ text: this.l10n.getConstant('Arrow'), id: 'arrow', iconCss: 'e-icons e-arrow-right-up' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Path') > -1)) {\n            items.push({ text: this.l10n.getConstant('Path'), id: 'path', iconCss: 'e-icons e-critical-path' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Text') > -1)) {\n            items.push({ text: this.l10n.getConstant('Text'), id: 'text', iconCss: 'e-icons e-add-text' });\n        }\n        var obj = { freehandDrawSelectedId: null };\n        parent.notify('freehand-draw', { prop: 'getFreehandDrawSelectedId', onPropertyChange: false, value: { obj: obj } });\n        var duplicateElement = document.querySelector('#' + parent.element.id + '_duplicate');\n        var removeElement = document.querySelector('#' + parent.element.id + '_remove');\n        var editTextElement = document.querySelector('#' + parent.element.id + '_editText');\n        if ((parent.activeObj.activePoint.width === 0 && parent.activeObj.activePoint.height === 0) &&\n            (isNullOrUndefined(parent.activeObj.pointColl) || (parent.activeObj.pointColl\n                && parent.activeObj.pointColl.length === 0)) &&\n            isNullOrUndefined(obj['freehandDrawSelectedId'])) {\n            if (duplicateElement) {\n                duplicateElement.classList.add('e-disabled');\n            }\n            if (removeElement) {\n                removeElement.classList.add('e-disabled');\n            }\n            if (editTextElement) {\n                editTextElement.classList.add('e-disabled');\n            }\n        }\n        else {\n            if (duplicateElement) {\n                duplicateElement.classList.remove('e-disabled');\n            }\n            if (removeElement) {\n                removeElement.classList.remove('e-disabled');\n            }\n            if (editTextElement) {\n                editTextElement.classList.remove('e-disabled');\n            }\n        }\n        var iconCss = isContextualToolbar ? this.getCurrentShapeIcon(parent.activeObj.shape) : 'e-annotation';\n        var drpDownBtn = new DropDownButton({ items: items, iconCss: 'e-icons ' + iconCss,\n            cssClass: 'e-image-popup',\n            open: function (args) {\n                if (Browser.isDevice) {\n                    args.element.parentElement.style.top = drpDownBtn.element.getBoundingClientRect().top -\n                        args.element.parentElement.offsetHeight + 'px';\n                }\n                if (parent.activeObj.shape) {\n                    document.getElementById(parent.activeObj.shape).classList.add('e-selected');\n                }\n                else if (parent.togglePen) {\n                    document.getElementById('pen').classList.add('e-selected');\n                }\n            },\n            select: function (args) {\n                parent.okBtn();\n                var isCropSelection = false;\n                var splitWords;\n                if (parent.activeObj.shape !== undefined) {\n                    splitWords = parent.activeObj.shape.split('-');\n                }\n                if (splitWords === undefined && parent.currObjType.isCustomCrop) {\n                    isCropSelection = true;\n                }\n                else if (splitWords !== undefined && splitWords[0] === 'crop') {\n                    isCropSelection = true;\n                }\n                parent.currObjType.isCustomCrop = false;\n                if (isCropSelection || parent.togglePan) {\n                    parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                    _this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                    _this.refreshToolbar('main');\n                }\n                var obj = { currentFreehandDrawIndex: null };\n                parent.notify('freehand-draw', { prop: 'getCurrentFreehandDrawIndex', value: { obj: obj } });\n                drpDownBtn.iconCss = 'e-icons ' + _this.getCurrentShapeIcon(args.item.id);\n                switch (args.item.id) {\n                    case 'pen':\n                        parent.notify('draw', { prop: 'setTempFreehandCounter', value: { tempFreehandCounter: parent.freehandCounter } });\n                        parent.notify('draw', { prop: 'setTempCurrentFreehandDrawIndex', value: { tempCurrentFreehandDrawIndex: obj['currentFreehandDrawIndex'] } });\n                        _this.currentToolbar = 'pen';\n                        parent.freeHandDraw(true);\n                        break;\n                    case 'text':\n                        _this.currentToolbar = 'text';\n                        parent.notify('shape', { prop: 'draw-shape-text' });\n                        // this.setInitialShapeSettings(args);\n                        // parent.activeObj.textFlip = parent.transform.currFlipState;\n                        // parent.notify('selection', {prop: 'annotate', value: {shape: args.item.id }});\n                        // parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: {type: 'text',\n                        //     isApplyBtn: null, isCropping: null, isZooming: null, cType: null}});\n                        break;\n                    default:\n                        _this.currentToolbar = 'shapes';\n                        /// parent.notify('shape', { prop: 'draw-shape', value: {obj: (args.item.id).toLowerCase()}});\n                        _this.setInitialShapeSettings(args);\n                        parent.notify('selection', { prop: 'annotate', value: { shape: args.item.id } });\n                        parent.notify('toolbar', { prop: 'refresh-toolbar', onPropertyChange: false, value: { type: 'shapes',\n                                isApplyBtn: null, isCropping: null, isZooming: null, cType: null } });\n                        break;\n                }\n                _this.updateToolbarItems();\n            }\n        });\n        // Render initialized DropDownButton.\n        drpDownBtn.appendTo('#' + parent.element.id + '_annotationBtn');\n    };\n    ToolbarModule.prototype.renderCropBtn = function () {\n        var _this = this;\n        var parent = this.parent;\n        var items = [];\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('CustomSelection') > -1)) {\n            items.push({ text: this.l10n.getConstant('Custom'), id: 'custom', iconCss: 'e-icons e-custom' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('CircleSelection') > -1)) {\n            items.push({ text: this.l10n.getConstant('Circle'), id: 'circle', iconCss: 'e-icons e-circle' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('SquareSelection') > -1)) {\n            items.push({ text: this.l10n.getConstant('Square'), id: 'square', iconCss: 'e-icons e-square' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('RatioSelection') > -1)) {\n            items.push({ text: '3:2', id: '3:2', iconCss: 'e-icons e-custom-a' });\n            items.push({ text: '4:3', id: '4:3', iconCss: 'e-icons e-custom-b' });\n            items.push({ text: '5:4', id: '5:4', iconCss: 'e-icons e-custom-c' });\n            items.push({ text: '7:5', id: '7:5', iconCss: 'e-icons e-custom-d' });\n            items.push({ text: '16:9', id: '16:9', iconCss: 'e-icons e-custom-e' });\n        }\n        var iconCss;\n        var shape;\n        if (parent.activeObj.shape) {\n            iconCss = this.getCurrentShapeIcon(parent.activeObj.shape);\n            shape = parent.activeObj.shape;\n        }\n        else if (parent.currSelectionPoint) {\n            iconCss = this.getCurrentShapeIcon(parent.currSelectionPoint.shape);\n            shape = parent.currSelectionPoint.shape;\n        }\n        else {\n            iconCss = 'e-custom';\n            shape = 'custom';\n        }\n        var drpDownBtn = new DropDownButton({\n            open: function (args) {\n                if (parent.togglePan) {\n                    _this.cancelPan();\n                }\n                if (Browser.isDevice) {\n                    args.element.parentElement.style.top = drpDownBtn.element.getBoundingClientRect().top -\n                        args.element.parentElement.offsetHeight + 'px';\n                }\n                if (parent.activeObj.shape && parent.activeObj.shape.split('-').length > 1) {\n                    document.getElementById(parent.activeObj.shape.split('-')[1]).classList.add('e-selected');\n                }\n                parent.notify('transform', { prop: 'disableZoomOutBtn', value: { isZoomOut: true } });\n            },\n            items: items,\n            select: function (args) {\n                _this.cropSelect(args);\n                drpDownBtn.iconCss = 'e-icons ' + _this.getCurrentShapeIcon('crop-' + args.item.id);\n                drpDownBtn.content = parent.toPascalCase(args.item.id);\n            },\n            iconCss: 'e-icons ' + iconCss, cssClass: 'e-image-popup',\n            content: parent.toPascalCase(shape.replace('crop-', ''))\n        });\n        drpDownBtn.appendTo('#' + parent.element.id + '_cropBtn');\n    };\n    ToolbarModule.prototype.renderTransformBtn = function () {\n        var parent = this.parent;\n        var items = [];\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('RotateLeft') > -1)) {\n            items.push({ text: this.l10n.getConstant('RotateLeft'), id: 'rotateleft', iconCss: 'e-icons e-anti-clock-wise' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('RotateRight') > -1)) {\n            items.push({ text: this.l10n.getConstant('RotateRight'), id: 'rotateright', iconCss: 'e-icons e-clock-wise' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('FlipHorizontal') > -1)) {\n            items.push({ text: this.l10n.getConstant('HorizontalFlip'), id: 'horizontalflip', iconCss: 'e-icons e-horizontal-flip' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('FlipVertical') > -1)) {\n            items.push({ text: this.l10n.getConstant('VerticalFlip'), id: 'verticalflip', iconCss: 'e-icons e-vertical-flip' });\n        }\n        var drpDownBtn = new DropDownButton({\n            open: function (args) {\n                if (Browser.isDevice) {\n                    var ht = args.element.parentElement.offsetHeight;\n                    args.element.parentElement.style.display = 'none';\n                    args.element.parentElement.style.top = drpDownBtn.element.getBoundingClientRect().top -\n                        ht + 'px';\n                    args.element.parentElement.style.display = 'block';\n                }\n            },\n            items: items, select: parent.transformSelect.bind(this),\n            iconCss: 'e-icons e-transform', cssClass: 'e-image-popup'\n        });\n        drpDownBtn.appendTo('#' + parent.element.id + '_transformBtn');\n    };\n    ToolbarModule.prototype.renderSaveBtn = function () {\n        var parent = this.parent;\n        var saveItems = [\n            { text: 'JPEG', id: 'jpeg' },\n            { text: 'PNG', id: 'png' },\n            { text: 'SVG', id: 'svg' }\n        ];\n        var ddbElem = document.getElementById(parent.element.id + '_saveBtn');\n        if (ddbElem) {\n            // Initialize the DropDownButton component.\n            var saveDrpDownBtn = new DropDownButton({ items: saveItems, cssClass: 'e-caret-hide e-image-popup', iconCss: 'e-icons e-save',\n                select: function (args) {\n                    parent.export(args.item.text);\n                }\n            });\n            saveDrpDownBtn.appendTo('#' + parent.element.id + '_saveBtn');\n        }\n    };\n    ToolbarModule.prototype.getCropTransformToolbarItem = function () {\n        var parent = this.parent;\n        var toolbarItems = [];\n        toolbarItems.push({ id: parent.element.id + '_crop', tooltipText: this.l10n.getConstant('CropSelection'), align: 'Center',\n            template: '<button id=\"' + parent.element.id + '_cropBtn\"></button>'\n        });\n        toolbarItems.push({ align: 'Center', type: 'Separator' });\n        toolbarItems.push({ id: parent.element.id + '_rotateLeft', prefixIcon: 'e-icons e-anti-clock-wise',\n            tooltipText: this.l10n.getConstant('RotateLeft'), align: 'Center' });\n        toolbarItems.push({ id: parent.element.id + '_rotateRight', prefixIcon: 'e-icons e-clock-wise',\n            tooltipText: this.l10n.getConstant('RotateRight'), align: 'Center' });\n        toolbarItems.push({ align: 'Center', type: 'Separator' });\n        toolbarItems.push({ id: parent.element.id + '_horizontalFlip', prefixIcon: 'e-icons e-horizontal-flip',\n            tooltipText: this.l10n.getConstant('HorizontalFlip'), align: 'Center' });\n        toolbarItems.push({ id: parent.element.id + '_verticalFlip', prefixIcon: 'e-icons e-vertical-flip',\n            tooltipText: this.l10n.getConstant('VerticalFlip'), align: 'Center' });\n        if (!Browser.isDevice) {\n            toolbarItems.push({ id: parent.element.id + '_ok', prefixIcon: 'e-icons e-check', cssClass: 'top-icon e-tick',\n                tooltipText: this.l10n.getConstant('OK'), align: 'Right' });\n            toolbarItems.push({ id: parent.element.id + '_cancel', prefixIcon: 'e-icons e-close', cssClass: 'top-icon e-save',\n                tooltipText: this.l10n.getConstant('Cancel'), align: 'Right' });\n        }\n        return toolbarItems;\n    };\n    ToolbarModule.prototype.getShapesToolbarItem = function (items) {\n        var parent = this.parent;\n        var toolbarItems = [];\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar)) {\n            toolbarItems.push({ id: parent.element.id + '_annotation', tooltipText: this.l10n.getConstant('Annotation'), align: 'Center',\n                template: '<button id=\"' + parent.element.id + '_annotationBtn\"></button>' });\n        }\n        if (items.indexOf('fillColor') > -1) {\n            toolbarItems.push({ prefixIcon: 'e-icons e-copy', id: parent.element.id + '_fillcolor',\n                cssClass: 'top-icon e-fill', tooltipText: this.l10n.getConstant('FillColor'), align: 'Center', type: 'Input',\n                template: '<button id=\"' + parent.element.id + '_fillColorBtn\"></button>' });\n        }\n        if (items.indexOf('strokeColor') > -1) {\n            toolbarItems.push({ prefixIcon: 'e-icons e-copy', id: parent.element.id + '_strokecolor',\n                cssClass: 'top-icon e-stroke', tooltipText: this.l10n.getConstant('StrokeColor'), align: 'Center', type: 'Input',\n                template: '<button id=\"' + parent.element.id + '_borderColorBtn\"></button>' });\n        }\n        if (items.indexOf('strokeWidth') > -1) {\n            toolbarItems.push({ id: parent.element.id + '_strokeWidth', cssClass: 'top-icon e-size', tooltipText: 'Stroke Width', align: 'Center',\n                type: 'Input', template: '<button id=\"' + parent.element.id + '_borderWidthBtn\"></button>' });\n        }\n        if (items.indexOf('start') > -1) {\n            toolbarItems.push({ id: parent.element.id + '_start', cssClass: 'top-icon e-size', tooltipText: 'Start', align: 'Center',\n                type: 'Input', template: '<button id=\"' + parent.element.id + '_startBtn\"></button>' });\n        }\n        if (items.indexOf('end') > -1) {\n            toolbarItems.push({ id: parent.element.id + '_end', cssClass: 'top-icon e-size', tooltipText: 'End', align: 'Center',\n                type: 'Input', template: '<button id=\"' + parent.element.id + '_endBtn\"></button>' });\n        }\n        toolbarItems.push({ align: 'Center', type: 'Separator' });\n        if (items.indexOf('duplicate') > -1) {\n            toolbarItems.push({ id: parent.element.id + '_duplicate', prefixIcon: 'e-icons e-order', cssClass: 'top-icon e-order',\n                tooltipText: this.l10n.getConstant('Duplicate'), align: 'Center' });\n        }\n        if (items.indexOf('remove') > -1) {\n            toolbarItems.push({ id: parent.element.id + '_remove', prefixIcon: 'e-icons e-trash', cssClass: 'top-icon e-trash',\n                tooltipText: this.l10n.getConstant('Remove'), align: 'Center' });\n        }\n        if (items.indexOf('text') > -1) {\n            toolbarItems.push({ id: parent.element.id + '_editText', prefixIcon: 'e-icons e-annotation-edit', cssClass: 'top-icon e-annotation-edit',\n                tooltipText: this.l10n.getConstant('EditText'), align: 'Center' });\n        }\n        var tempToolbarItems = this.processSubToolbar(items);\n        for (var i = 0, len = tempToolbarItems.length; i < len; i++) {\n            toolbarItems.push(tempToolbarItems[i]);\n        }\n        if (!Browser.isDevice) {\n            var obj = { shape: null };\n            parent.notify('selection', { prop: 'getCurrentDrawingShape', value: { obj: obj } });\n            if (obj['shape'] !== 'path') {\n                toolbarItems.push({ id: parent.element.id + '_ok', prefixIcon: 'e-icons e-check', cssClass: 'top-icon e-tick',\n                    tooltipText: this.l10n.getConstant('OK'), align: 'Right' });\n                toolbarItems.push({ id: parent.element.id + '_cancel', prefixIcon: 'e-icons e-close', cssClass: 'top-icon e-save',\n                    tooltipText: this.l10n.getConstant('Cancel'), align: 'Right' });\n            }\n        }\n        return toolbarItems;\n    };\n    ToolbarModule.prototype.initCropTransformToolbar = function () {\n        var _this = this;\n        var parent = this.parent;\n        var leftItem = this.getLeftToolbarItem();\n        var rightItem = this.getRightToolbarItem();\n        var mainItem = this.getCropTransformToolbarItem();\n        var zoomItem = this.getZoomToolbarItem();\n        if (Browser.isDevice) {\n            this.defToolbarItems = mainItem;\n        }\n        else {\n            this.defToolbarItems = leftItem.concat(zoomItem, mainItem, rightItem);\n        }\n        var toolbar = new Toolbar({\n            width: '100%',\n            items: this.defToolbarItems,\n            clicked: this.defToolbarClicked.bind(this),\n            created: function () {\n                _this.renderCropBtn();\n                _this.wireZoomBtnEvents();\n                if (!Browser.isDevice) {\n                    _this.renderSaveBtn();\n                }\n                parent.trigger('toolbarCreated', { toolbarType: 'shapes' });\n                if (Browser.isDevice) {\n                    if (_this.defToolbarItems.length > 0 && document.getElementById(parent.element.id + '_bottomToolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                        toolbar.refreshOverflow();\n                        toolbar.refreshOverflow();\n                    }\n                }\n                else {\n                    _this.createLeftToolbarControls();\n                    if (_this.defToolbarItems.length > 0 && document.getElementById(parent.element.id + '_toolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                    }\n                }\n                parent.select('custom');\n            }\n        });\n        if (Browser.isDevice) {\n            toolbar.appendTo('#' + parent.element.id + '_bottomToolbar');\n        }\n        else {\n            toolbar.appendTo('#' + parent.element.id + '_toolbar');\n        }\n        this.enableDisableTbrBtn();\n        parent.notify('transform', { prop: 'disableZoomOutBtn', value: { isZoomOut: true } });\n    };\n    ToolbarModule.prototype.getCurrentShapeIcon = function (shape) {\n        var icon = '';\n        switch (shape) {\n            case 'rectangle':\n                icon = 'e-rectangle';\n                break;\n            case 'ellipse':\n                icon = 'e-circle';\n                break;\n            case 'line':\n                icon = 'e-line';\n                break;\n            case 'arrow':\n                icon = 'e-arrow-right-up';\n                break;\n            case 'path':\n                icon = 'e-critical-path';\n                break;\n            case 'text':\n                icon = 'e-add-text';\n                break;\n            case 'pen':\n                icon = 'e-free-pen';\n                break;\n            case 'crop-custom':\n                icon = 'e-custom';\n                break;\n            case 'crop-circle':\n                icon = 'e-circle';\n                break;\n            case 'crop-square':\n                icon = 'e-square';\n                break;\n            case 'crop-3:2':\n                icon = 'e-custom-a';\n                break;\n            case 'crop-4:3':\n                icon = 'e-custom-b';\n                break;\n            case 'crop-5:4':\n                icon = 'e-custom-c';\n                break;\n            case 'crop-7:5':\n                icon = 'e-custom-d';\n                break;\n            case 'crop-16:9':\n                icon = 'e-custom-e';\n                break;\n            default:\n                icon = 'e-free-pen';\n                break;\n        }\n        return icon;\n    };\n    ToolbarModule.prototype.initShapesToolbarItem = function (items) {\n        var _this = this;\n        var parent = this.parent;\n        var leftItem = this.getLeftToolbarItem();\n        var rightItem = this.getRightToolbarItem();\n        var mainItem = this.getShapesToolbarItem(items);\n        var zoomItem = this.getZoomToolbarItem();\n        if (Browser.isDevice) {\n            this.defToolbarItems = mainItem;\n        }\n        else {\n            this.defToolbarItems = leftItem.concat(zoomItem, mainItem, rightItem);\n        }\n        var toolbar = new Toolbar({\n            width: '100%',\n            items: this.defToolbarItems,\n            clicked: this.defToolbarClicked.bind(this),\n            created: function () {\n                _this.renderAnnotationBtn(true);\n                _this.createShapeColor(items);\n                _this.createShapeBtn(items);\n                if (parent.activeObj.shape === 'arrow') {\n                    _this.createStartBtn();\n                    _this.createEndBtn();\n                }\n                _this.wireZoomBtnEvents();\n                if (!Browser.isDevice) {\n                    _this.renderSaveBtn();\n                }\n                parent.trigger('toolbarCreated', { toolbarType: 'shapes' });\n                if (Browser.isDevice) {\n                    if (_this.defToolbarItems.length > 0 && document.getElementById(parent.element.id + '_bottomToolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                        toolbar.refreshOverflow();\n                        toolbar.refreshOverflow();\n                    }\n                }\n                else {\n                    _this.createLeftToolbarControls();\n                    if (_this.defToolbarItems.length > 0 && document.getElementById(parent.element.id + '_toolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                    }\n                }\n            }\n        });\n        if (Browser.isDevice) {\n            toolbar.appendTo('#' + parent.element.id + '_bottomToolbar');\n        }\n        else {\n            toolbar.appendTo('#' + parent.element.id + '_toolbar');\n        }\n        this.enableDisableTbrBtn();\n    };\n    ToolbarModule.prototype.createShapeColor = function (items) {\n        var parent = this.parent;\n        if (items.indexOf('fillColor') > -1) {\n            parent.element.querySelector('.e-template.e-fill').appendChild(parent.createElement('input', {\n                id: parent.element.id + '_shape_fill'\n            }));\n            var fillColor = new ColorPicker({\n                modeSwitcher: false, noColor: true, value: '',\n                showButtons: false, mode: 'Palette', cssClass: 'e-shape-fill-color',\n                change: function (args) {\n                    parent.updateFillColor(args.currentValue.hex);\n                    if (args.currentValue.rgba === '') {\n                        fillDDB_1.element.children[0].classList.add('e-nocolor-item');\n                    }\n                    else {\n                        fillDDB_1.element.children[0].classList.remove('e-nocolor-item');\n                        fillDDB_1.element.children[0].style.backgroundColor = args.currentValue.rgba;\n                    }\n                    fillDDB_1.toggle();\n                }\n            }, '#' + parent.element.id + '_shape_fill');\n            var fillDDB_1 = new DropDownButton({\n                open: function (args) {\n                    if (Browser.isDevice) {\n                        args.element.parentElement.style.top = fillDDB_1.element.getBoundingClientRect().top -\n                            args.element.parentElement.offsetHeight + 'px';\n                        args.element.parentElement.style.left = parent.element.offsetLeft + 'px';\n                    }\n                },\n                target: '.e-shape-fill-color',\n                iconCss: 'e-dropdownbtn-preview'\n            }, '#' + parent.element.id + '_fillColorBtn');\n            fillColor.inline = true;\n            parent.element.querySelector('.e-fill.e-template .e-dropdownbtn-preview').classList.add('e-nocolor-item');\n        }\n        if (items.indexOf('strokeColor') > -1) {\n            parent.element.querySelector('.e-template.e-stroke').appendChild(parent.createElement('input', {\n                id: parent.element.id + '_shape_stroke'\n            }));\n            var strokeColor = new ColorPicker({\n                modeSwitcher: false, noColor: false, value: '#fff',\n                showButtons: false, mode: 'Palette', cssClass: 'e-shape-stroke-color',\n                change: function (args) {\n                    parent.updateStrokeColor(args.currentValue.hex);\n                    strokeDDB_1.element.children[0].style.backgroundColor = args.currentValue.rgba;\n                    strokeDDB_1.toggle();\n                }\n            }, '#' + parent.element.id + '_shape_stroke');\n            var strokeDDB_1 = new DropDownButton({\n                open: function (args) {\n                    if (Browser.isDevice) {\n                        args.element.parentElement.style.top = strokeDDB_1.element.getBoundingClientRect().top -\n                            args.element.parentElement.offsetHeight + 'px';\n                        args.element.parentElement.style.left = parent.element.offsetLeft + 'px';\n                    }\n                },\n                target: '.e-shape-stroke-color',\n                iconCss: 'e-dropdownbtn-preview'\n            }, '#' + parent.element.id + '_borderColorBtn');\n            strokeColor.inline = true;\n            parent.element.querySelector('.e-stroke.e-template .e-dropdownbtn-preview').style.background = '#fff';\n        }\n    };\n    ToolbarModule.prototype.createShapeBtn = function (items) {\n        var parent = this.parent;\n        var strokeWidthItems = [\n            { id: '1', text: this.l10n.getConstant('XSmall') },\n            { id: '2', text: this.l10n.getConstant('Small') },\n            { id: '3', text: this.l10n.getConstant('Medium') },\n            { id: '4', text: this.l10n.getConstant('Large') },\n            { id: '5', text: this.l10n.getConstant('XLarge') }\n        ];\n        if (items.indexOf('strokeWidth') > -1) {\n            var strokeWidthBtn = document.getElementById(parent.element.id + '_borderWidthBtn');\n            var spanElem_1 = document.createElement('span');\n            spanElem_1.innerHTML = this.l10n.getConstant('XSmall');\n            spanElem_1.className = 'e-shape-stroke-width';\n            strokeWidthBtn.appendChild(spanElem_1);\n            // Initialize the DropDownButton component.\n            var drpDownBtn_1 = new DropDownButton({ items: strokeWidthItems,\n                open: function (args) {\n                    if (Browser.isDevice) {\n                        args.element.parentElement.style.top = drpDownBtn_1.element.getBoundingClientRect().top -\n                            args.element.parentElement.offsetHeight + 'px';\n                    }\n                    var activeBtn = spanElem_1.innerHTML;\n                    if (activeBtn !== '') {\n                        args.element.querySelector('[aria-label = ' + '\"' + activeBtn + '\"' + ']').classList.add('e-selected-btn');\n                    }\n                },\n                select: function (args) {\n                    spanElem_1.textContent = args.item.text;\n                    parent.updateStrokeWidth(args.item.id);\n                    if (Browser.isDevice) {\n                        if (document.getElementById(parent.element.id + '_bottomToolbar')) {\n                            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                            var toolbar_6 = getComponent(parent.element.id + '_bottomToolbar', 'toolbar');\n                            toolbar_6.refreshOverflow();\n                        }\n                    }\n                    else {\n                        if (document.getElementById(parent.element.id + '_toolbar')) {\n                            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                            var toolbar_7 = getComponent(parent.element.id + '_toolbar', 'toolbar');\n                            toolbar_7.refreshOverflow();\n                        }\n                    }\n                }\n            });\n            // Render initialized DropDownButton.\n            drpDownBtn_1.appendTo('#' + parent.element.id + '_borderWidthBtn');\n        }\n    };\n    ToolbarModule.prototype.createStartBtn = function () {\n        var parent = this.parent;\n        var strokeWidthItems = [\n            { id: '1', text: this.l10n.getConstant('None') },\n            { id: '2', text: this.l10n.getConstant('Bar') },\n            { id: '3', text: this.l10n.getConstant('Arrow') },\n            { id: '4', text: this.l10n.getConstant('ArrowSolid') },\n            { id: '5', text: this.l10n.getConstant('Circle') },\n            { id: '6', text: this.l10n.getConstant('CircleSolid') },\n            { id: '7', text: this.l10n.getConstant('Square') },\n            { id: '8', text: this.l10n.getConstant('SquareSolid') }\n        ];\n        var strokeWidthBtn = document.getElementById(parent.element.id + '_startBtn');\n        var spanElem = document.createElement('span');\n        if (isNullOrUndefined(parent.activeObj.start)) {\n            parent.activeObj.start = 'none';\n        }\n        spanElem.innerHTML = parent.pascalToSplitWords(parent.activeObj.start);\n        spanElem.className = 'e-shape-start';\n        strokeWidthBtn.appendChild(spanElem);\n        // Initialize the DropDownButton component.\n        var drpDownBtn = new DropDownButton({ items: strokeWidthItems,\n            open: function (args) {\n                if (Browser.isDevice) {\n                    args.element.parentElement.style.top = drpDownBtn.element.getBoundingClientRect().top -\n                        args.element.parentElement.offsetHeight + 'px';\n                }\n                var activeBtn = spanElem.innerHTML;\n                if (activeBtn !== '') {\n                    args.element.querySelector('[aria-label = ' + '\"' + activeBtn + '\"' + ']').classList.add('e-selected-btn');\n                }\n            },\n            select: function (args) {\n                spanElem.textContent = args.item.text;\n                parent.updateArrow('startArrow', args.item.id);\n            }\n        });\n        // Render initialized DropDownButton.\n        drpDownBtn.appendTo('#' + parent.element.id + '_startBtn');\n    };\n    ToolbarModule.prototype.createEndBtn = function () {\n        var parent = this.parent;\n        var strokeWidthItems = [\n            { id: '1', text: this.l10n.getConstant('None') },\n            { id: '2', text: this.l10n.getConstant('Bar') },\n            { id: '3', text: this.l10n.getConstant('Arrow') },\n            { id: '4', text: this.l10n.getConstant('ArrowSolid') },\n            { id: '5', text: this.l10n.getConstant('Circle') },\n            { id: '6', text: this.l10n.getConstant('CircleSolid') },\n            { id: '7', text: this.l10n.getConstant('Square') },\n            { id: '8', text: this.l10n.getConstant('SquareSolid') }\n        ];\n        var strokeEndBtn = document.getElementById(parent.element.id + '_endBtn');\n        var spanElem = document.createElement('span');\n        if (isNullOrUndefined(parent.activeObj.end)) {\n            parent.activeObj.end = 'arrowSolid';\n        }\n        spanElem.innerHTML = parent.pascalToSplitWords(parent.activeObj.end);\n        spanElem.className = 'e-shape-end';\n        strokeEndBtn.appendChild(spanElem);\n        // Initialize the DropDownButton component.\n        var drpDownBtn = new DropDownButton({ items: strokeWidthItems,\n            open: function (args) {\n                if (Browser.isDevice) {\n                    args.element.parentElement.style.top = drpDownBtn.element.getBoundingClientRect().top -\n                        args.element.parentElement.offsetHeight + 'px';\n                }\n                var activeBtn = spanElem.innerHTML;\n                if (activeBtn !== '') {\n                    args.element.querySelector('[aria-label = ' + '\"' + activeBtn + '\"' + ']').classList.add('e-selected-btn');\n                }\n            },\n            select: function (args) {\n                spanElem.textContent = args.item.text;\n                parent.updateArrow('endArrow', args.item.id);\n            }\n        });\n        // Render initialized DropDownButton.\n        drpDownBtn.appendTo('#' + parent.element.id + '_endBtn');\n    };\n    ToolbarModule.prototype.getTextToolbarItem = function (items) {\n        var parent = this.parent;\n        var toolbarItems = [];\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar)) {\n            toolbarItems.push({ id: parent.element.id + '_annotation', tooltipText: this.l10n.getConstant('Annotation'), align: 'Center',\n                template: '<button id=\"' + parent.element.id + '_annotationBtn\"></button>' });\n        }\n        if (items.indexOf('fontFamily') > -1) {\n            toolbarItems.push({ id: parent.element.id + '_fontFamily', cssClass: 'top-icon e-img-font-family',\n                tooltipText: this.l10n.getConstant('FontFamily'), align: 'Center',\n                template: '<button id=\"' + parent.element.id + '_fontFamilyBtn\"></button>' });\n        }\n        if (items.indexOf('fontSize') > -1) {\n            toolbarItems.push({ id: parent.element.id + '_fontSize', cssClass: 'top-icon e-img-font-size',\n                tooltipText: this.l10n.getConstant('FontSize'), align: 'Center',\n                template: '<button id=\"' + parent.element.id + '_fontSizeBtn\"></button>' });\n        }\n        if (items.indexOf('fontColor') > -1) {\n            toolbarItems.push({ cssClass: 'top-icon e-text-font-color', id: parent.element.id + '_text_strokecolor',\n                tooltipText: this.l10n.getConstant('FontColor'), align: 'Center',\n                type: 'Input', template: '<button id=\"' + parent.element.id + '_fontColorBtn\"></button>' });\n        }\n        if (items.indexOf('bold') > -1) {\n            toolbarItems.push({ id: parent.element.id + '_bold', prefixIcon: 'e-icons e-bold', cssClass: 'top-icon e-bold',\n                tooltipText: this.l10n.getConstant('Bold'), align: 'Center' });\n        }\n        if (items.indexOf('italic') > -1) {\n            toolbarItems.push({ id: parent.element.id + '_italic', prefixIcon: 'e-icons e-italic', cssClass: 'top-icon e-italic',\n                tooltipText: this.l10n.getConstant('Italic'), align: 'Center' });\n        }\n        toolbarItems.push({ align: 'Center', type: 'Separator' });\n        if (items.indexOf('duplicate') > -1) {\n            toolbarItems.push({ id: parent.element.id + '_duplicate', prefixIcon: 'e-icons e-order', cssClass: 'top-icon e-order',\n                tooltipText: this.l10n.getConstant('Duplicate'), align: 'Center' });\n        }\n        if (items.indexOf('remove') > -1) {\n            toolbarItems.push({ id: parent.element.id + '_remove', prefixIcon: 'e-icons e-trash', cssClass: 'top-icon e-trash',\n                tooltipText: this.l10n.getConstant('Remove'), align: 'Center' });\n        }\n        if (items.indexOf('text') > -1) {\n            toolbarItems.push({ id: parent.element.id + '_editText', prefixIcon: 'e-icons e-annotation-edit', cssClass: 'top-icon e-annotation-edit',\n                tooltipText: this.l10n.getConstant('EditText'), align: 'Center' });\n        }\n        var tempToolbarItems = this.processSubToolbar(items);\n        for (var i = 0, len = tempToolbarItems.length; i < len; i++) {\n            toolbarItems.push(tempToolbarItems[i]);\n        }\n        if (!Browser.isDevice) {\n            toolbarItems.push({ id: parent.element.id + '_ok', prefixIcon: 'e-icons e-check', cssClass: 'top-icon e-tick',\n                tooltipText: this.l10n.getConstant('OK'), align: 'Right' });\n            toolbarItems.push({ id: parent.element.id + '_cancel', prefixIcon: 'e-icons e-close', cssClass: 'top-icon e-save',\n                tooltipText: this.l10n.getConstant('Cancel'), align: 'Right' });\n        }\n        return toolbarItems;\n    };\n    ToolbarModule.prototype.getFontFamilyItems = function () {\n        if (Browser.isDevice) {\n            return [{ id: 'arial', text: 'ABC' }, { id: 'calibri', text: 'ABC' }, { id: 'georgia', text: 'ABC' },\n                { id: 'roboto', text: 'ABC' }, { id: 'tahoma', text: 'ABC' }];\n        }\n        return [{ id: 'arial', text: 'Arial' }, { id: 'calibri', text: 'Calibri' }, { id: 'georgia', text: 'Georgia' },\n            { id: 'roboto', text: 'Roboto' }, { id: 'tahoma', text: 'Tahoma' }];\n    };\n    ToolbarModule.prototype.initTextToolbarItem = function (items) {\n        var _this = this;\n        var parent = this.parent;\n        var leftItem = this.getLeftToolbarItem();\n        var rightItem = this.getRightToolbarItem();\n        var mainItem = this.getTextToolbarItem(items);\n        var zoomItem = this.getZoomToolbarItem();\n        if (Browser.isDevice) {\n            this.defToolbarItems = mainItem;\n        }\n        else {\n            this.defToolbarItems = leftItem.concat(zoomItem, mainItem, rightItem);\n        }\n        var toolbar = new Toolbar({\n            width: '100%',\n            items: this.defToolbarItems,\n            clicked: this.defToolbarClicked.bind(this),\n            created: function () {\n                _this.renderAnnotationBtn(true);\n                _this.createTextColor(items);\n                _this.createTextBtn(items);\n                _this.wireZoomBtnEvents();\n                if (!Browser.isDevice) {\n                    _this.renderSaveBtn();\n                }\n                parent.trigger('toolbarCreated', { toolbarType: 'text' });\n                if (Browser.isDevice) {\n                    if (_this.defToolbarItems.length > 0 && document.getElementById(parent.element.id + '_bottomToolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                        toolbar.refreshOverflow();\n                        toolbar.refreshOverflow();\n                    }\n                }\n                else {\n                    _this.createLeftToolbarControls();\n                    if (_this.defToolbarItems.length > 0 && document.getElementById(parent.element.id + '_toolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                    }\n                }\n            }\n        });\n        if (Browser.isDevice) {\n            toolbar.appendTo('#' + parent.element.id + '_bottomToolbar');\n        }\n        else {\n            toolbar.appendTo('#' + parent.element.id + '_toolbar');\n        }\n        this.enableDisableTbrBtn();\n    };\n    ToolbarModule.prototype.createTextColor = function (items) {\n        var parent = this.parent;\n        if (items.indexOf('fontColor') > -1 && parent.element.querySelector('.e-template.e-text-font-color')) {\n            parent.element.querySelector('.e-template.e-text-font-color').appendChild(parent.createElement('input', {\n                id: parent.element.id + '_text_font'\n            }));\n            var fontColor = new ColorPicker({\n                modeSwitcher: false, value: '#fff',\n                showButtons: false, mode: 'Palette', cssClass: 'e-text-fontt-color',\n                change: function (args) {\n                    parent.updateFontColor(args.currentValue.hex);\n                    strokeDDB_2.element.children[0].style.backgroundColor = args.currentValue.rgba;\n                    strokeDDB_2.toggle();\n                }\n            }, '#' + parent.element.id + '_text_font');\n            var strokeDDB_2 = new DropDownButton({\n                open: function (args) {\n                    if (Browser.isDevice) {\n                        args.element.parentElement.style.top = strokeDDB_2.element.getBoundingClientRect().top -\n                            args.element.parentElement.offsetHeight + 'px';\n                        args.element.parentElement.style.left = parent.element.offsetLeft + 'px';\n                    }\n                },\n                target: '.e-text-fontt-color',\n                iconCss: 'e-dropdownbtn-preview'\n            }, '#' + parent.element.id + '_fontColorBtn');\n            fontColor.inline = true;\n            parent.element.querySelector('.e-text-font-color.e-template .e-dropdownbtn-preview').style.background\n                = '#fff';\n        }\n    };\n    ToolbarModule.prototype.createTextBtn = function (items) {\n        var parent = this.parent;\n        if (items.indexOf('fontFamily') > -1) {\n            var fontNameBtn = document.getElementById(parent.element.id + '_fontFamilyBtn');\n            var spanElem_2 = document.createElement('span');\n            if (Browser.isDevice) {\n                spanElem_2.innerHTML = 'ABC';\n                spanElem_2.setAttribute('style', 'font-family: arial');\n            }\n            else {\n                spanElem_2.innerHTML = 'Arial';\n            }\n            spanElem_2.className = 'e-text-font-family';\n            if (fontNameBtn) {\n                fontNameBtn.appendChild(spanElem_2);\n            }\n            var fontFamilyBtn_1 = new DropDownButton({ items: this.getFontFamilyItems(),\n                cssClass: 'e-font-family',\n                createPopupOnClick: true,\n                beforeItemRender: function (args) {\n                    args.element.setAttribute('style', 'font-family:' + args.element.id);\n                },\n                open: function (args) {\n                    if (Browser.isDevice) {\n                        args.element.parentElement.style.top = fontFamilyBtn_1.element.getBoundingClientRect().top -\n                            args.element.parentElement.offsetHeight + 'px';\n                    }\n                    var fontFamily;\n                    if (parent.textArea.style.display === 'block') {\n                        fontFamily = parent.textArea.style.fontFamily;\n                    }\n                    else {\n                        fontFamily = parent.activeObj.textSettings.fontFamily;\n                    }\n                    args.element.querySelector('[id *= ' + '\"' + fontFamily.toLowerCase()\n                        + '\"' + ']').classList.add('e-selected-btn');\n                },\n                select: function (args) {\n                    spanElem_2.textContent = args.item.text;\n                    if (Browser.isDevice) {\n                        spanElem_2.setAttribute('style', 'font-family:' + args.item.id);\n                    }\n                    parent.updateFontFamily(args.item.id);\n                }\n            });\n            fontFamilyBtn_1.appendTo('#' + parent.element.id + '_fontFamilyBtn');\n        }\n        if (items.indexOf('fontSize') > -1) {\n            var fontSizeBtnElem = document.getElementById(parent.element.id + '_fontSizeBtn');\n            var fontSizeSpanElem_1 = document.createElement('span');\n            var fontSizes = parent.getFontSizes();\n            fontSizeSpanElem_1.innerHTML = fontSizes[0].text;\n            fontSizeSpanElem_1.className = 'e-text-font-size';\n            fontSizeBtnElem.appendChild(fontSizeSpanElem_1);\n            var fontSizeBtn_1 = new DropDownButton({\n                cssClass: 'e-font-size',\n                items: fontSizes,\n                open: function (args) {\n                    if (Browser.isDevice) {\n                        args.element.parentElement.style.top = fontSizeBtn_1.element.getBoundingClientRect().top -\n                            args.element.parentElement.offsetHeight + 'px';\n                    }\n                    var activeBtn = fontSizeSpanElem_1.innerHTML;\n                    args.element.querySelector('[aria-label *= ' + '\"' + activeBtn + '\"' + ']').classList.add('e-selected-btn');\n                },\n                select: function (args) {\n                    fontSizeSpanElem_1.textContent = args.item.text;\n                    parent.updateFontSize(args.item.text);\n                }\n            });\n            fontSizeBtn_1.appendTo('#' + parent.element.id + '_fontSizeBtn');\n        }\n    };\n    ToolbarModule.prototype.refreshToolbar = function (type, isApplyBtn, isCropping, isZooming, cType) {\n        var parent = this.parent;\n        if (!parent.isImageLoaded || parent.isCropToolbar) {\n            return;\n        }\n        var item = type === 'shapes' && parent.activeObj.shape ? parent.activeObj.shape : type;\n        var args = { toolbarType: item };\n        if (type !== 'filter' && type !== 'color') {\n            if (document.getElementById(parent.element.id + '_toolbar') && this.defToolbarItems.length > 0) {\n                getComponent(document.getElementById(parent.element.id + '_toolbar'), 'toolbar').destroy();\n                document.getElementById(parent.element.id + '_toolbar').innerHTML = '';\n            }\n            if (document.getElementById(parent.element.id + '_bottomToolbar') && this.defToolbarItems.length > 0) {\n                if (document.getElementById(parent.element.id + '_bottomToolbar').className.indexOf('e-control') > -1) {\n                    getComponent(document.getElementById(parent.element.id + '_bottomToolbar'), 'toolbar').destroy();\n                    document.getElementById(parent.element.id + '_bottomToolbar').innerHTML = '';\n                }\n            }\n        }\n        this.refreshSlider();\n        parent.isCropTab = false;\n        switch (type) {\n            case 'main':\n                if (Browser.isDevice) {\n                    if (isCropping) {\n                        this.initMainToolbar(false, true, true);\n                    }\n                    else {\n                        this.initMainToolbar(false, true, null);\n                    }\n                }\n                else if (!Browser.isDevice || isZooming) {\n                    if (isZooming) {\n                        this.initMainToolbar(isApplyBtn, Browser.isDevice, null);\n                    }\n                    else {\n                        this.initMainToolbar(isApplyBtn, Browser.isDevice, null);\n                    }\n                }\n                if (Browser.isDevice) {\n                    this.initBottomToolbar();\n                }\n                break;\n            case 'shapes':\n                if (Browser.isDevice) {\n                    this.initMainToolbar(false, true, true);\n                }\n                if (parent.activeObj.shape === 'line' || parent.activeObj.shape === 'path') {\n                    args.toolbarItems = ['strokeColor', 'strokeWidth', 'duplicate', 'remove'];\n                }\n                else if (parent.activeObj.shape === 'arrow') {\n                    args.toolbarItems = ['strokeColor', 'strokeWidth', 'start', 'end', 'duplicate', 'remove'];\n                }\n                else {\n                    args.toolbarItems = ['fillColor', 'strokeColor', 'strokeWidth', 'duplicate', 'remove'];\n                }\n                parent.trigger('toolbarUpdating', args);\n                this.initShapesToolbarItem(args.toolbarItems);\n                break;\n            case 'text':\n                if (Browser.isDevice) {\n                    this.initMainToolbar(false, true, true);\n                }\n                args.toolbarItems = ['fontFamily', 'fontSize', 'fontColor', 'bold', 'italic', 'duplicate', 'remove', 'text'];\n                parent.trigger('toolbarUpdating', args);\n                this.initTextToolbarItem(args.toolbarItems);\n                break;\n            case 'pen':\n                if (Browser.isDevice) {\n                    this.initMainToolbar(false, true, true);\n                }\n                args.toolbarItems = ['strokeColor', 'strokeWidth', 'remove'];\n                parent.trigger('toolbarUpdating', args);\n                this.initPenToolbarItem(args.toolbarItems);\n                break;\n            case 'adjustment':\n                if (Browser.isDevice) {\n                    this.initMainToolbar(false, true, true);\n                }\n                this.initAdjustmentToolbarItem();\n                break;\n            case 'filter':\n                this.updateContextualToolbar(type);\n                break;\n            case 'color':\n                this.updateContextualToolbar(type, cType);\n                break;\n            case 'croptransform':\n                parent.isCropTab = true;\n                if (Browser.isDevice) {\n                    this.initMainToolbar(false, true, true);\n                }\n                parent.updateCropTransformItems();\n                this.initCropTransformToolbar();\n                break;\n        }\n        this.currToolbar = type;\n        this.refreshDropDownBtn(isCropping);\n    };\n    ToolbarModule.prototype.getAdjustmentToolbarItem = function () {\n        var toolbarItems = [];\n        var parent = this.parent;\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Brightness') > -1)) {\n            toolbarItems.push({ id: parent.element.id + '_brightness', prefixIcon: 'e-icons e-brightness', cssClass: 'top-icon e-brightness',\n                tooltipText: this.l10n.getConstant('Brightness'), align: 'Center' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Contrast') > -1)) {\n            toolbarItems.push({ id: parent.element.id + '_contrast', prefixIcon: 'e-icons e-contrast', cssClass: 'top-icon e-contrast',\n                tooltipText: this.l10n.getConstant('Contrast'), align: 'Center' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Hue') > -1)) {\n            toolbarItems.push({ id: parent.element.id + '_hue', prefixIcon: 'e-icons e-fade', cssClass: 'top-icon e-fade',\n                tooltipText: this.l10n.getConstant('Hue'), align: 'Center' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Saturation') > -1)) {\n            toolbarItems.push({ id: parent.element.id + '_saturation', prefixIcon: 'e-icons e-saturation', cssClass: 'top-icon e-saturation',\n                tooltipText: this.l10n.getConstant('Saturation'), align: 'Center' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Exposure') > -1)) {\n            toolbarItems.push({ id: parent.element.id + '_exposure', prefixIcon: 'e-icons e-grain', cssClass: 'top-icon e-grain',\n                tooltipText: this.l10n.getConstant('Exposure'), align: 'Center' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Opacity') > -1)) {\n            toolbarItems.push({ id: parent.element.id + '_opacity', prefixIcon: 'e-icons e-opacity', cssClass: 'top-icon e-opacity',\n                tooltipText: this.l10n.getConstant('Opacity'), align: 'Center' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Blur') > -1)) {\n            toolbarItems.push({ id: parent.element.id + '_blur', prefixIcon: 'e-icons e-tint', cssClass: 'top-icon e-tint',\n                tooltipText: this.l10n.getConstant('Blur'), align: 'Center' });\n        }\n        var tempToolbarItems = this.processToolbar('center');\n        for (var i = 0, len = tempToolbarItems.length; i < len; i++) {\n            toolbarItems.push(tempToolbarItems[i]);\n        }\n        if (!Browser.isDevice) {\n            toolbarItems.push({ id: parent.element.id + '_ok', prefixIcon: 'e-icons e-check', cssClass: 'top-icon e-tick',\n                tooltipText: this.l10n.getConstant('OK'), align: 'Right' });\n            toolbarItems.push({ id: parent.element.id + '_cancel', prefixIcon: 'e-icons e-close', cssClass: 'top-icon e-save',\n                tooltipText: this.l10n.getConstant('Cancel'), align: 'Right' });\n        }\n        return toolbarItems;\n    };\n    ToolbarModule.prototype.getFilterToolbarItem = function () {\n        var toolbarItems = [];\n        var parent = this.parent;\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Default') > -1)) {\n            toolbarItems.push({ id: parent.element.id + '_default', prefixIcon: 'e-icons e-none', cssClass: 'top-icon e-none',\n                tooltipText: this.l10n.getConstant('Default'), align: 'Center',\n                template: '<div class=\"filter-wrapper\" style=\"box-sizing: content-box;\"><canvas id=' + parent.element.id + '_defaultCanvas' + '></canvas><div style=\"text-align:center;\"><span>' + this.l10n.getConstant('Default') + '</span></div></div>' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Chrome') > -1)) {\n            toolbarItems.push({ id: parent.element.id + '_chrome', prefixIcon: 'e-icons e-none', cssClass: 'top-icon e-none',\n                tooltipText: this.l10n.getConstant('Chrome'), align: 'Center',\n                template: '<div class=\"filter-wrapper\" style=\"box-sizing: content-box;\"><canvas id=' + parent.element.id + '_chromeCanvas' + '></canvas><div style=\"text-align:center;\"><span>' + this.l10n.getConstant('Chrome') + '</span></div></div>' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Cold') > -1)) {\n            toolbarItems.push({ id: parent.element.id + '_cold', prefixIcon: 'e-icons e-none', cssClass: 'top-icon e-none',\n                tooltipText: this.l10n.getConstant('Cold'), align: 'Center',\n                template: '<div class=\"filter-wrapper\" style=\"box-sizing: content-box;\"><canvas id=' + parent.element.id + '_coldCanvas' + '></canvas><div style=\"text-align:center;\"><span>' + this.l10n.getConstant('Cold') + '</span></div></div>' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Warm') > -1)) {\n            toolbarItems.push({ id: parent.element.id + '_warm', prefixIcon: 'e-icons e-none', cssClass: 'top-icon e-none',\n                tooltipText: this.l10n.getConstant('Warm'), align: 'Center',\n                template: '<div class=\"filter-wrapper\" style=\"box-sizing: content-box;\"><canvas id=' + parent.element.id + '_warmCanvas' + '></canvas><div style=\"text-align:center;\"><span>' + this.l10n.getConstant('Warm') + '</span></div></div>' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Grayscale') > -1)) {\n            toolbarItems.push({ id: parent.element.id + '_grayscale', prefixIcon: 'e-icons e-none', cssClass: 'top-icon e-none',\n                tooltipText: this.l10n.getConstant('Grayscale'), align: 'Center',\n                template: '<div class=\"filter-wrapper\" style=\"box-sizing: content-box;\"><canvas id=' + parent.element.id + '_grayscaleCanvas' + '></canvas><div style=\"text-align:center;\"><span>' + this.l10n.getConstant('Grayscale') + '</span></div></div>' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Sepia') > -1)) {\n            toolbarItems.push({ id: parent.element.id + '_sepia', prefixIcon: 'e-icons e-none', cssClass: 'top-icon e-none',\n                tooltipText: this.l10n.getConstant('Sepia'), align: 'Center',\n                template: '<div class=\"filter-wrapper\" style=\"box-sizing: content-box;\"><canvas id=' + parent.element.id + '_sepiaCanvas' + '></canvas><div style=\"text-align:center;\"><span>' + this.l10n.getConstant('Sepia') + '</span></div></div>' });\n        }\n        if (isNullOrUndefined(parent.toolbar) || (parent.toolbar && parent.toolbar.indexOf('Invert') > -1)) {\n            toolbarItems.push({ id: parent.element.id + '_invert', prefixIcon: 'e-icons e-none', cssClass: 'top-icon e-none',\n                tooltipText: this.l10n.getConstant('Invert'), align: 'Center',\n                template: '<div class=\"filter-wrapper\" style=\"box-sizing: content-box;\"><canvas id=' + parent.element.id + '_invertCanvas' + '></canvas><div style=\"text-align:center;\"><span>' + this.l10n.getConstant('Invert') + '</span></div></div>' });\n        }\n        var tempToolbarItems = this.processToolbar('center');\n        for (var i = 0, len = tempToolbarItems.length; i < len; i++) {\n            toolbarItems.push(tempToolbarItems[i]);\n        }\n        return toolbarItems;\n    };\n    ToolbarModule.prototype.getPenToolbarItem = function (items) {\n        var parent = this.parent;\n        var toolbarItems = [];\n        if (isNullOrUndefined(parent.toolbar) || parent.toolbar) {\n            toolbarItems.push({ id: parent.element.id + '_annotation', tooltipText: this.l10n.getConstant('Annotation'), align: 'Center',\n                template: '<button id=\"' + parent.element.id + '_annotationBtn\"></button>' });\n        }\n        if (items.indexOf('strokeColor') > -1) {\n            toolbarItems.push({ prefixIcon: 'e-icons e-copy', id: parent.element.id + '_pen_strokecolor',\n                cssClass: 'top-icon e-pen-stroke-color',\n                tooltipText: this.l10n.getConstant('StrokeColor'), align: 'Center', type: 'Input',\n                template: '<button id=\"' + parent.element.id + '_penColorBtn\"></button>' });\n        }\n        if (items.indexOf('strokeWidth') > -1) {\n            toolbarItems.push({ prefixIcon: 'e-icons e-copy', cssClass: 'top-icon e-size',\n                tooltipText: this.l10n.getConstant('StrokeWidth'),\n                align: 'Center', type: 'Input', template: '<button id=\"' + parent.element.id + '_penStrokeWidth\"></button>' });\n        }\n        toolbarItems.push({ align: 'Center', type: 'Separator' });\n        if (items.indexOf('remove') > -1) {\n            toolbarItems.push({ id: parent.element.id + '_remove', prefixIcon: 'e-icons e-trash', cssClass: 'top-icon e-trash',\n                tooltipText: this.l10n.getConstant('Remove'), align: 'Center' });\n        }\n        var tempToolbarItems = this.processSubToolbar(items);\n        for (var i = 0, len = tempToolbarItems.length; i < len; i++) {\n            toolbarItems.push(tempToolbarItems[i]);\n        }\n        if (!Browser.isDevice) {\n            toolbarItems.push({ id: parent.element.id + '_ok', prefixIcon: 'e-icons e-check', cssClass: 'top-icon e-tick',\n                tooltipText: this.l10n.getConstant('OK'), align: 'Right' });\n            toolbarItems.push({ id: parent.element.id + '_cancel', prefixIcon: 'e-icons e-close', cssClass: 'top-icon e-save',\n                tooltipText: this.l10n.getConstant('Cancel'), align: 'Right' });\n        }\n        return toolbarItems;\n    };\n    ToolbarModule.prototype.initPenToolbarItem = function (items) {\n        var _this = this;\n        var parent = this.parent;\n        var leftItem = this.getLeftToolbarItem();\n        var rightItem = this.getRightToolbarItem();\n        var mainItem = this.getPenToolbarItem(items);\n        var zoomItem = this.getZoomToolbarItem();\n        if (Browser.isDevice) {\n            this.defToolbarItems = mainItem;\n        }\n        else {\n            this.defToolbarItems = leftItem.concat(zoomItem, mainItem, rightItem);\n        }\n        var toolbar = new Toolbar({\n            width: '100%',\n            items: this.defToolbarItems,\n            clicked: this.defToolbarClicked.bind(this),\n            created: function () {\n                _this.renderAnnotationBtn(true);\n                _this.createPenColor(items);\n                _this.createPenBtn(items);\n                _this.wireZoomBtnEvents();\n                if (!Browser.isDevice) {\n                    _this.renderSaveBtn();\n                }\n                parent.trigger('toolbarCreated', { toolbarType: 'pen' });\n                if (Browser.isDevice) {\n                    if (_this.defToolbarItems.length > 0 && document.getElementById(parent.element.id + '_toolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                        toolbar.refreshOverflow();\n                    }\n                }\n                else {\n                    _this.createLeftToolbarControls();\n                    if (_this.defToolbarItems.length > 0 && document.getElementById(parent.element.id + '_toolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                    }\n                }\n            }\n        });\n        if (Browser.isDevice) {\n            toolbar.appendTo('#' + parent.element.id + '_bottomToolbar');\n        }\n        else {\n            toolbar.appendTo('#' + parent.element.id + '_toolbar');\n        }\n        this.enableDisableTbrBtn();\n    };\n    ToolbarModule.prototype.createPenColor = function (items) {\n        var _this = this;\n        var parent = this.parent;\n        if (items.indexOf('strokeColor') > -1) {\n            parent.element.querySelector('.e-template.e-pen-stroke-color').appendChild(parent.createElement('input', {\n                id: parent.element.id + '_pen_stroke'\n            }));\n            var penColor = new ColorPicker({\n                modeSwitcher: false, value: '#fff',\n                showButtons: false, mode: 'Palette', cssClass: 'e-pen-color',\n                change: function (args) {\n                    parent.updatePenStrokeColor(args.currentValue.hex);\n                    _this.selFhdColor = args.currentValue.hex;\n                    strokeDDB_3.element.children[0].style.backgroundColor = args.currentValue.rgba;\n                    strokeDDB_3.toggle();\n                }\n            }, '#' + parent.element.id + '_pen_stroke');\n            var strokeDDB_3 = new DropDownButton({\n                open: function (args) {\n                    if (Browser.isDevice) {\n                        args.element.parentElement.style.top = strokeDDB_3.element.getBoundingClientRect().top -\n                            args.element.parentElement.offsetHeight + 'px';\n                        args.element.parentElement.style.left = parent.element.offsetLeft + 'px';\n                    }\n                },\n                target: '.e-pen-color',\n                iconCss: 'e-dropdownbtn-preview'\n            }, '#' + parent.element.id + '_penColorBtn');\n            penColor.inline = true;\n            var obj = { tempFreeHandDrawEditingStyles: null };\n            parent.notify('freehand-draw', { prop: 'getTempFreeHandDrawEditingStyles', value: { obj: obj } });\n            var indexObj = { freehandSelectedIndex: null };\n            parent.notify('freehand-draw', { prop: 'getFreehandSelectedIndex', onPropertyChange: false, value: { obj: indexObj } });\n            if (!isNullOrUndefined(indexObj['freehandSelectedIndex']) && indexObj['freehandSelectedIndex'] > -1) {\n                parent.element.querySelector('.e-pen-stroke-color.e-template .e-dropdownbtn-preview').style.background\n                    = this.selFhdColor === '#42a5f5' ? obj['tempFreeHandDrawEditingStyles'].strokeColor :\n                        parent.pointColl[indexObj['freehandSelectedIndex']].strokeColor;\n            }\n            else {\n                parent.element.querySelector('.e-pen-stroke-color.e-template .e-dropdownbtn-preview').style.background\n                    = '#fff';\n            }\n        }\n    };\n    ToolbarModule.prototype.createPenBtn = function (items) {\n        var parent = this.parent;\n        var strokeWidthItems = [\n            { id: '1', text: this.l10n.getConstant('XSmall') },\n            { id: '2', text: this.l10n.getConstant('Small') },\n            { id: '3', text: this.l10n.getConstant('Medium') },\n            { id: '4', text: this.l10n.getConstant('Large') },\n            { id: '5', text: this.l10n.getConstant('XLarge') }\n        ];\n        if (items.indexOf('strokeWidth') > -1) {\n            var strokeWidthBtn = document.getElementById(parent.element.id + '_penStrokeWidth');\n            var spanElem_3 = document.createElement('span');\n            var indexObj = { freehandSelectedIndex: null };\n            parent.notify('freehand-draw', { prop: 'getFreehandSelectedIndex', onPropertyChange: false, value: { obj: indexObj } });\n            if (!isNullOrUndefined(indexObj['freehandSelectedIndex']) && indexObj['freehandSelectedIndex'] > -1) {\n                spanElem_3.innerHTML = this.getPenStroke(parent.pointColl[indexObj['freehandSelectedIndex']].strokeWidth);\n            }\n            else {\n                spanElem_3.innerHTML = this.l10n.getConstant('Small');\n            }\n            spanElem_3.className = 'e-pen-stroke-width';\n            strokeWidthBtn.appendChild(spanElem_3);\n            var drpDownBtn_2 = new DropDownButton({ items: strokeWidthItems,\n                open: function (args) {\n                    if (Browser.isDevice) {\n                        args.element.parentElement.style.top = drpDownBtn_2.element.getBoundingClientRect().top -\n                            args.element.parentElement.offsetHeight + 'px';\n                    }\n                    var activeBtn = spanElem_3.innerHTML;\n                    args.element.querySelector('[aria-label = ' + '\"' + activeBtn + '\"' + ']').classList.add('e-selected-btn');\n                },\n                select: function (args) {\n                    spanElem_3.textContent = args.item.text;\n                    parent.updatePenStrokeWidth(args.item.id);\n                    if (Browser.isDevice) {\n                        if (document.getElementById(parent.element.id + '_bottomToolbar')) {\n                            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                            var toolbar_8 = getComponent(parent.element.id + '_bottomToolbar', 'toolbar');\n                            toolbar_8.refreshOverflow();\n                        }\n                    }\n                    else {\n                        if (document.getElementById(parent.element.id + '_toolbar')) {\n                            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                            var toolbar_9 = getComponent(parent.element.id + '_toolbar', 'toolbar');\n                            toolbar_9.refreshOverflow();\n                        }\n                    }\n                }\n            });\n            // Render initialized DropDownButton.\n            drpDownBtn_2.appendTo('#' + parent.element.id + '_penStrokeWidth');\n        }\n    };\n    ToolbarModule.prototype.getPenStroke = function (value) {\n        var textContent = '';\n        var valueToTextContent = {\n            1: this.l10n.getConstant('XSmall'),\n            2: this.l10n.getConstant('Small'),\n            3: this.l10n.getConstant('Medium'),\n            4: this.l10n.getConstant('Large'),\n            5: this.l10n.getConstant('XLarge')\n        };\n        if (value >= 1 && value <= 5) {\n            textContent = valueToTextContent[value];\n        }\n        return textContent;\n    };\n    ToolbarModule.prototype.initAdjustmentToolbarItem = function () {\n        var _this = this;\n        var parent = this.parent;\n        var leftItem = this.getLeftToolbarItem(null);\n        var rightItem = this.getRightToolbarItem();\n        var mainItem = this.getAdjustmentToolbarItem();\n        var zoomItem = this.getZoomToolbarItem();\n        if (Browser.isDevice) {\n            this.defToolbarItems = mainItem;\n        }\n        else {\n            this.defToolbarItems = leftItem.concat(zoomItem, mainItem, rightItem);\n        }\n        var toolbar = new Toolbar({\n            width: '100%',\n            items: this.defToolbarItems,\n            clicked: this.defToolbarClicked.bind(this),\n            created: function () {\n                _this.wireZoomBtnEvents();\n                if (!Browser.isDevice) {\n                    _this.renderSaveBtn();\n                }\n                if (Browser.isDevice) {\n                    if (_this.defToolbarItems.length > 0 && document.getElementById(parent.element.id + '_toolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                    }\n                }\n                else {\n                    _this.createLeftToolbarControls();\n                    if (_this.defToolbarItems.length > 0 && document.getElementById(parent.element.id + '_toolbar')) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                    }\n                }\n            }\n        });\n        if (Browser.isDevice) {\n            toolbar.appendTo('#' + parent.element.id + '_bottomToolbar');\n        }\n        else {\n            toolbar.appendTo('#' + parent.element.id + '_toolbar');\n        }\n        this.enableDisableTbrBtn();\n    };\n    ToolbarModule.prototype.initFilterToolbarItem = function () {\n        var _this = this;\n        var parent = this.parent;\n        var mainItem = this.getFilterToolbarItem();\n        if (document.querySelector('#' + parent.element.id + '_contextualToolbar').classList.contains('e-control')) {\n            getComponent(document.getElementById(parent.element.id + '_contextualToolbar'), 'toolbar').destroy();\n        }\n        var toolbar = new Toolbar({\n            width: '100%',\n            items: mainItem,\n            clicked: this.contextualToolbarClicked.bind(this),\n            created: function () {\n                _this.updatePrivateVariables();\n                _this.createCanvasFilter();\n                if (parent.currentFilter === '') {\n                    parent.currentFilter = parent.element.id + '_default';\n                }\n                var hdrWrapper = document.querySelector('#' + parent.element.id + '_headWrapper');\n                if (hdrWrapper) {\n                    hdrWrapper.style.display = 'none';\n                }\n                document.getElementById(parent.currentFilter + 'Canvas').parentElement.parentElement.classList.add('e-selected');\n                _this.enableDisableTbrBtn();\n                toolbar.refreshOverflow();\n            }\n        });\n        toolbar.appendTo('#' + parent.element.id + '_contextualToolbar');\n    };\n    ToolbarModule.prototype.createCanvasFilter = function () {\n        var parent = this.parent;\n        showSpinner(parent.element);\n        parent.element.style.opacity = '0.5';\n        var imageData = parent.getCurrentCanvasData();\n        this.inMemoryCanvas.width = imageData.width;\n        this.inMemoryCanvas.height = imageData.height;\n        this.inMemoryContext.putImageData(imageData, 0, 0);\n        this.updateFilterCanvas('_defaultCanvas', 'default');\n        this.updateFilterCanvas('_chromeCanvas', 'chrome');\n        this.updateFilterCanvas('_coldCanvas', 'cold');\n        this.updateFilterCanvas('_warmCanvas', 'warm');\n        this.updateFilterCanvas('_grayscaleCanvas', 'grayscale');\n        this.updateFilterCanvas('_sepiaCanvas', 'sepia');\n        this.updateFilterCanvas('_invertCanvas', 'invert');\n        hideSpinner(parent.element);\n        parent.element.style.opacity = '1';\n        parent.initialAdjustmentValue = this.lowerContext.filter;\n    };\n    ToolbarModule.prototype.updateFilterCanvas = function (selector, type) {\n        var parent = this.parent;\n        var filter = parent.element.querySelector('#' + parent.element.id + selector);\n        if (filter) {\n            var ctx = filter.getContext('2d');\n            ctx = filter.getContext('2d');\n            filter.style.width = '100px';\n            filter.style.height = '100px';\n            parent.notify('filter', { prop: 'updateAdj', value: { type: type, value: null, isPreview: true, ctx: ctx } });\n            ctx.drawImage(this.inMemoryCanvas, 0, 0, 300, 150);\n        }\n    };\n    ToolbarModule.prototype.getQuickAccessToolbarItem = function (isPenEdit) {\n        var parent = this.parent;\n        var args = { cancel: false, toolbarItems: [] };\n        var toolbarItems = [];\n        if (isNullOrUndefined(isPenEdit)) {\n            toolbarItems.push('Clone');\n            toolbarItems.push('Delete');\n            if (parent.activeObj.shape === 'text') {\n                toolbarItems.push('EditText');\n            }\n            args.shape = parent.toPascalCase(parent.activeObj.shape);\n        }\n        else if (isPenEdit) {\n            toolbarItems.push('Delete');\n            args.shape = 'Freehand draw';\n        }\n        args.toolbarItems = extend([], toolbarItems, null, true);\n        parent.trigger('quickAccessToolbarOpen', args);\n        var orgToolbarItems = [];\n        if (args.cancel) {\n            orgToolbarItems = [];\n        }\n        else {\n            for (var i = 0; i < args.toolbarItems.length; i++) {\n                switch (args.toolbarItems[i]) {\n                    case 'Clone':\n                        orgToolbarItems.push({ id: parent.element.id + '_duplicate', prefixIcon: 'e-icons e-order', cssClass: 'top-icon e-order',\n                            tooltipText: this.l10n.getConstant('Duplicate'), align: 'Left' });\n                        break;\n                    case 'Delete':\n                        orgToolbarItems.push({ id: parent.element.id + '_remove', prefixIcon: 'e-icons e-trash', cssClass: 'top-icon e-trash',\n                            tooltipText: this.l10n.getConstant('Remove'), align: 'Left' });\n                        break;\n                    case 'EditText':\n                        orgToolbarItems.push({ id: parent.element.id + '_editText', prefixIcon: 'e-icons e-annotation-edit', cssClass: 'top-icon e-annotation-edit',\n                            tooltipText: this.l10n.getConstant('EditText'), align: 'Left' });\n                        break;\n                    default:\n                        orgToolbarItems.push(args.toolbarItems[i]);\n                        break;\n                }\n            }\n        }\n        return orgToolbarItems;\n    };\n    ToolbarModule.prototype.renderQAT = function (isPenEdit) {\n        var parent = this.parent;\n        if (parent.activeObj && parent.showQuickAccessToolbar) {\n            var qtArea = document.getElementById(parent.element.id + '_quickAccessToolbarArea');\n            if (qtArea) {\n                this.destroyQuickAccessToolbar();\n                qtArea.style.display = 'block';\n            }\n            var items = this.getQuickAccessToolbarItem(isPenEdit);\n            if (items.length === 0) {\n                return;\n            }\n            if (isNullOrUndefined(parent.quickAccessToolbarTemplate)) {\n                var toolbarObj = new Toolbar({\n                    items: items,\n                    clicked: this.quickAccessToolbarClicked.bind(this)\n                });\n                toolbarObj.appendTo('#' + parent.element.id + '_quickAccessToolbar');\n            }\n            if (isNullOrUndefined(isPenEdit)) {\n                qtArea.style.width = 'auto';\n                parent.activeObj.activePoint.width = Math.abs(parent.activeObj.activePoint.width);\n                parent.activeObj.activePoint.height = Math.abs(parent.activeObj.activePoint.height);\n                var x = parent.activeObj.activePoint.startX < parent.activeObj.activePoint.endX ?\n                    parent.activeObj.activePoint.startX : parent.activeObj.activePoint.endX;\n                var y = parent.activeObj.activePoint.startY < parent.activeObj.activePoint.endY ?\n                    parent.activeObj.activePoint.startY : parent.activeObj.activePoint.endY;\n                var width = parent.activeObj.activePoint.width;\n                if (parent.activeObj.rotatedAngle !== 0 && parent.activeObj.shape !== 'arrow') {\n                    var object = { activePoint: null };\n                    parent.notify('shape', { prop: 'getSquarePointForRotatedShape', onPropertyChange: false,\n                        value: { obj: parent.activeObj, object: object } });\n                    var point = object['activePoint'];\n                    x = point.startX;\n                    y = point.startY;\n                    width = point.width;\n                }\n                else if (parent.activeObj.shape === 'path') {\n                    var path = parent.getSquarePointForPath(parent.activeObj);\n                    x = path.startX;\n                    y = path.startY;\n                    width = path.width;\n                }\n                qtArea.style.left = (x + (width / 2)) - (items.length * 25) + 'px';\n                if (y - 60 < parent.img.destTop) {\n                    qtArea.style.top = parent.img.destTop + 'px';\n                }\n                else {\n                    qtArea.style.top = y - 60 + 'px';\n                }\n            }\n            else if (isPenEdit) {\n                var obj = { activePoint: null };\n                var indexObj = { freehandSelectedIndex: null };\n                parent.notify('freehand-draw', { prop: 'getFreehandSelectedIndex', onPropertyChange: false, value: { obj: indexObj } });\n                parent.notify('freehand-draw', { prop: 'getSqPtFD',\n                    value: { idx: indexObj['freehandSelectedIndex'], obj: obj } });\n                var point = obj['activePoint'];\n                qtArea.style.width = 'auto';\n                qtArea.style.left = (point.startX + (point.width / 2)) - (items.length * 27) + 'px';\n                if (point.startY - 60 < parent.img.destTop) {\n                    qtArea.style.top = parent.img.destTop + 'px';\n                }\n                else {\n                    qtArea.style.top = point.startY - 60 + 'px';\n                }\n            }\n        }\n    };\n    ToolbarModule.prototype.refreshDropDownBtn = function (isDisabled) {\n        if (isNullOrUndefined(isDisabled)) {\n            return;\n        }\n        var parent = this.parent;\n        var annotation = document.querySelector('#' + parent.element.id + '_annotationBtn');\n        if (annotation) {\n            if (isDisabled) {\n                annotation.classList.add('e-disabled');\n                annotation.parentElement.classList.add('e-overlay');\n            }\n            else {\n                annotation.classList.remove('e-disabled');\n                annotation.parentElement.classList.remove('e-overlay');\n            }\n            getComponent(annotation, 'dropdown-btn').disabled = isDisabled;\n        }\n        var transform = document.querySelector('#' + parent.element.id + '_transformBtn');\n        if (transform) {\n            if (isDisabled) {\n                transform.classList.add('e-disabled');\n                transform.parentElement.classList.add('e-overlay');\n            }\n            else {\n                transform.classList.remove('e-disabled');\n                transform.parentElement.classList.remove('e-overlay');\n            }\n            getComponent(transform, 'dropdown-btn').disabled = isDisabled;\n        }\n        var adjustment = document.querySelector('#' + parent.element.id + '_adjustment');\n        if (adjustment) {\n            if (isDisabled) {\n                adjustment.classList.add('e-disabled');\n                adjustment.parentElement.classList.add('e-overlay');\n            }\n            else {\n                adjustment.classList.remove('e-disabled');\n                adjustment.parentElement.classList.remove('e-overlay');\n            }\n            getComponent(adjustment, 'btn').disabled = isDisabled;\n        }\n        var filter = document.querySelector('#' + parent.element.id + '_filter');\n        if (filter) {\n            if (isDisabled) {\n                filter.classList.add('e-disabled');\n                filter.parentElement.classList.add('e-overlay');\n            }\n            else {\n                filter.classList.remove('e-disabled');\n                filter.parentElement.classList.remove('e-overlay');\n            }\n            getComponent(filter, 'btn').disabled = isDisabled;\n        }\n    };\n    ToolbarModule.prototype.cropSelect = function (args) {\n        var parent = this.parent;\n        parent.isCropTab = true;\n        if (isNullOrUndefined(parent.transform.cropZoomFactor)) {\n            parent.transform.cropZoomFactor = parent.transform.zoomFactor;\n            parent.notify('draw', { prop: 'setTempZoomFactor', onPropertyChange: false, value: { tempZoomFactor: parent.transform.zoomFactor } });\n        }\n        parent.transform.zoomFactor = parent.transform.cropZoomFactor;\n        var text = args.item.id;\n        this.currentToolbar = 'crop';\n        parent.currSelectionPoint = null;\n        parent.select(text);\n        this.enableDisableTbrBtn();\n        parent.notify('transform', { prop: 'disableZoomOutBtn', value: { isZoomOut: true } });\n    };\n    ToolbarModule.prototype.quickAccessToolbarClicked = function (args, isContextualToolbar) {\n        var parent = this.parent;\n        var points = { x: parent.activeObj.activePoint.startX, y: parent.activeObj.activePoint.startY };\n        if (args.item) {\n            var duplicateObj = void 0;\n            var objColl = void 0;\n            var isPreventUndoRedo = null;\n            var obj = { prevActObj: null };\n            var object = { tempObj: null };\n            parent.notify('draw', { prop: 'getPrevActObj', onPropertyChange: false, value: { obj: obj } });\n            parent.notify('selection', { prop: 'getTempActObj', onPropertyChange: false, value: { obj: object } });\n            object['tempObj']['activePoint']['height'] = Math.abs(object['tempObj']['activePoint']['height']);\n            var pathObject = { isNewPath: null };\n            parent.notify('draw', { prop: 'getNewPath', value: { obj: pathObject } });\n            switch (args.item.id.replace(parent.element.id + '_', '').toLowerCase()) {\n                case 'duplicate':\n                    if (!parent.element.querySelector('#' + parent.element.id + '_duplicate').classList.contains('e-disabled')) {\n                        if (!pathObject['isNewPath'] && JSON.stringify(object['tempObj']) === JSON.stringify(parent.activeObj)) {\n                            isPreventUndoRedo = true;\n                        }\n                        duplicateObj = extend({}, parent.activeObj, {}, true);\n                        if (isNullOrUndefined(parent.activeObj.currIndex)) {\n                            parent.notify('shape', { prop: 'applyActObj', onPropertyChange: false, value: { isMouseDown: isPreventUndoRedo } });\n                        }\n                        else if (obj['prevActObj']) {\n                            parent.activeObj.currIndex = null;\n                            duplicateObj.currIndex = null;\n                            parent.notify('shape', { prop: 'applyActObj', onPropertyChange: false, value: { isMouseDown: isPreventUndoRedo } });\n                        }\n                        else {\n                            parent.notify('shape', { prop: 'applyActObj', onPropertyChange: false, value: { isMouseDown: true } });\n                        }\n                        if (pathObject['isNewPath']) {\n                            parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n                        }\n                        objColl = extend([], parent.objColl, [], true);\n                        duplicateObj.activePoint.startX += 10;\n                        duplicateObj.activePoint.startY -= 10;\n                        duplicateObj.activePoint.endX += 10;\n                        duplicateObj.activePoint.endY -= 10;\n                        if (duplicateObj.shape === 'path') {\n                            for (var i = 0; i < duplicateObj.pointColl.length; i++) {\n                                duplicateObj.pointColl[i].x += 10;\n                                duplicateObj.pointColl[i].y -= 10;\n                            }\n                        }\n                        parent.activeObj = duplicateObj;\n                        if (parent.activeObj.shape === 'line' || parent.activeObj.shape === 'arrow') {\n                            parent.notify('shape', { prop: 'setPointCollForLineArrow', onPropertyChange: false,\n                                value: { obj: parent.activeObj } });\n                        }\n                        // parent.updateTrianglePoints(parent.activeObj); Invoke\n                        parent.notify('draw', { prop: 'drawObject', onPropertyChange: false, value: { canvas: 'duplicate', obj: parent.activeObj } });\n                        parent.notify('undo-redo', { prop: 'updateUrObj', onPropertyChange: false, value: { objColl: objColl } });\n                        this.renderQAT();\n                    }\n                    break;\n                case 'remove':\n                    if (!parent.element.querySelector('#' + parent.element.id + '_remove').classList.contains('e-disabled')) {\n                        parent.notify('selection', { prop: 'deleteItem', onPropertyChange: false });\n                    }\n                    break;\n                case 'edittext':\n                    if (!parent.element.querySelector('#' + parent.element.id + '_editText').classList.contains('e-disabled')) {\n                        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                        parent.notify('selection', { prop: 'setTempActObj', onPropertyChange: false,\n                            value: { obj: extend({}, parent.activeObj, {}, true) } });\n                        parent.notify('selection', { prop: 'setInitialTextEdit', onPropertyChange: false,\n                            value: { bool: true } });\n                        parent.notify('draw', { prop: 'setPrevActObj', onPropertyChange: false,\n                            value: { prevActObj: extend({}, parent.activeObj, {}, true) } });\n                        if (parent.activeObj.rotatedAngle !== 0) {\n                            points.x = parent.activeObj.horTopLinePointColl[0].x;\n                            points.y = parent.activeObj.horTopLinePointColl[0].y;\n                        }\n                        parent.notify('shape', { prop: 'renderTextArea', onPropertyChange: false,\n                            value: { x: points.x, y: points.y, actObj: parent.activeObj } });\n                        if (isNullOrUndefined(parent.activeObj.currIndex)) {\n                            parent.notify('draw', { prop: 'setShapeTextInsert', onPropertyChange: false, value: { bool: true } });\n                        }\n                        else if (obj['prevActObj']) {\n                            parent.notify('draw', { prop: 'setShapeTextInsert', onPropertyChange: false, value: { bool: true } });\n                        }\n                        if (document.getElementById(parent.element.id + '_quickAccessToolbarArea')) {\n                            document.getElementById(parent.element.id + '_quickAccessToolbarArea').style.display = 'none';\n                        }\n                    }\n                    break;\n            }\n        }\n        if (isNullOrUndefined(isContextualToolbar)) {\n            parent.trigger('quickAccessToolbarItemClick', args);\n        }\n    };\n    ToolbarModule.prototype.defToolbarClicked = function (args) {\n        var parent = this.parent;\n        var isContextualToolbar = false;\n        var isFilterFinetune = false;\n        if (parent.element.querySelector('.e-contextual-toolbar-wrapper')) {\n            if (!parent.element.querySelector('.e-contextual-toolbar-wrapper').classList.contains('e-hide')) {\n                isContextualToolbar = isFilterFinetune = true;\n            }\n            parent.element.querySelector('.e-contextual-toolbar-wrapper').classList.add('e-hide');\n        }\n        if (args.item) {\n            var type = args.item.id.replace(parent.element.id + '_', '').toLowerCase();\n            if (type === 'duplicate' || type === 'remove' || type === 'edittext') {\n                this.quickAccessToolbarClicked(args, true);\n                parent.trigger('toolbarItemClicked', args);\n            }\n            else {\n                var isDisabledFilter = false;\n                var isDisabledAdjustment = false;\n                var adjustment = document.querySelector('#' + parent.element.id + '_adjustment');\n                if (adjustment && adjustment.classList.contains('e-disabled')) {\n                    isDisabledAdjustment = true;\n                }\n                var filter = document.querySelector('#' + parent.element.id + '_filter');\n                if (filter && filter.classList.contains('e-disabled')) {\n                    isDisabledFilter = true;\n                }\n                this.enableDisableTbrBtn();\n                this.performDefTbrClick(type, isContextualToolbar, isDisabledAdjustment, isDisabledFilter, isFilterFinetune);\n                parent.trigger('toolbarItemClicked', args);\n            }\n        }\n    };\n    ToolbarModule.prototype.performDefTbrClick = function (type, isContextualToolbar, isDisabledAdjustment, isDisabledFilter, isFilterFinetune) {\n        var parent = this.parent;\n        var zoomIn = parent.element.querySelector('#' + parent.element.id + '_zoomIn');\n        var isCropSelection = false;\n        var panBtn;\n        var splitWords;\n        if (parent.activeObj.shape !== undefined) {\n            splitWords = parent.activeObj.shape.split('-');\n        }\n        if (splitWords === undefined && parent.currObjType.isCustomCrop) {\n            isCropSelection = true;\n        }\n        else if (splitWords !== undefined && splitWords[0] === 'crop') {\n            isCropSelection = true;\n        }\n        if (!parent.disabled) {\n            switch (type) {\n                case 'pan':\n                    parent.currObjType.isCustomCrop = parent.currObjType.isFiltered = false;\n                    if (parent.currObjType.isUndoAction) {\n                        parent.notify('undo-redo', { prop: 'refreshUrc', value: { bool: null } });\n                    }\n                    if (isCropSelection) {\n                        parent.currObjType.isCustomCrop = false;\n                        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n                        this.upperContext.clearRect(0, 0, parent.upperCanvas.width, parent.upperCanvas.height);\n                        this.refreshToolbar('main');\n                    }\n                    if (parent.togglePan) {\n                        this.cancelPan();\n                        parent.notify('transform', { prop: 'setDisablePan', onPropertyChange: false, value: { bool: true } });\n                        if (this.currentToolbar === 'pen') {\n                            parent.freehandDraw(true);\n                        }\n                    }\n                    else {\n                        panBtn = parent.element.querySelector('.e-img-pan .e-btn');\n                        if (panBtn) {\n                            panBtn.classList.add('e-selected-btn');\n                        }\n                        parent.pan(true);\n                        parent.notify('transform', { prop: 'setDisablePan', onPropertyChange: false, value: { bool: false } });\n                    }\n                    if (zoomIn && parent.zoomSettings.zoomFactor >= parent.zoomSettings.maxZoomFactor) {\n                        zoomIn.classList.add('e-disabled');\n                        zoomIn.parentElement.classList.add('e-overlay');\n                    }\n                    else if (zoomIn) {\n                        zoomIn.classList.remove('e-disabled');\n                        zoomIn.parentElement.classList.remove('e-overlay');\n                    }\n                    this.refreshToolbar('main');\n                    break;\n                case 'cancel':\n                    parent.notify('draw', { prop: 'performCancel', value: { isContextualToolbar: isContextualToolbar } });\n                    break;\n                case 'ok':\n                    parent.okBtn();\n                    this.refreshDropDownBtn(false);\n                    this.currentToolbar = 'main';\n                    break;\n                case 'crop':\n                    parent.notify('transform', { prop: 'disableZoomOutBtn', value: { isZoomOut: true } });\n                    break;\n                case 'reset':\n                    parent.reset();\n                    this.currentToolbar = 'main';\n                    break;\n                case 'undo':\n                    parent.notify('undo-redo', { prop: 'call-undo' });\n                    break;\n                case 'redo':\n                    parent.notify('undo-redo', { prop: 'call-redo' });\n                    break;\n                case 'adjustment':\n                    if (!isDisabledAdjustment) {\n                        if (parent.currObjType.isFiltered) {\n                            parent.okBtn();\n                        }\n                        this.refreshToolbar('adjustment');\n                        parent.setTempFilterProperties();\n                        this.openSlider('brightness');\n                    }\n                    break;\n                case 'brightness':\n                case 'contrast':\n                case 'hue':\n                case 'saturation':\n                case 'opacity':\n                case 'blur':\n                case 'exposure':\n                    this.openSlider(type);\n                    break;\n                case 'filter':\n                    if (!isDisabledFilter) {\n                        showSpinner(parent.element);\n                        this.refreshToolbar('filter');\n                        parent.setTempFilterProperties();\n                        hideSpinner(parent.element);\n                    }\n                    break;\n                case 'default':\n                case 'chrome':\n                case 'cold':\n                case 'warm':\n                case 'grayscale':\n                case 'blackandwhite':\n                case 'sepia':\n                case 'invert':\n                case 'sharpen':\n                    parent.currObjType.isFiltered = true;\n                    parent.notify('filter', { prop: 'applyImageFilter', value: { option: type } });\n                    break;\n                case 'upload':\n                    if (isFilterFinetune) {\n                        parent.element.querySelector('.e-contextual-toolbar-wrapper').classList.remove('e-hide');\n                    }\n                    break;\n                case 'bold':\n                    parent.notify('selection', { prop: 'setInitialTextEdit', value: { bool: false } });\n                    if (parent.activeObj.textSettings.bold && parent.activeObj.textSettings.italic) {\n                        parent.notify('shape', { prop: 'applyFontStyle', onPropertyChange: false,\n                            value: { item: 'italic' } });\n                    }\n                    else if (parent.activeObj.textSettings.bold && !parent.activeObj.textSettings.italic) {\n                        parent.notify('shape', { prop: 'applyFontStyle', onPropertyChange: false,\n                            value: { item: 'default' } });\n                    }\n                    else if (!parent.activeObj.textSettings.bold && parent.activeObj.textSettings.italic) {\n                        parent.notify('shape', { prop: 'applyFontStyle', onPropertyChange: false,\n                            value: { item: 'bolditalic' } });\n                    }\n                    else if (!parent.activeObj.textSettings.bold && !parent.activeObj.textSettings.italic) {\n                        parent.notify('shape', { prop: 'applyFontStyle', onPropertyChange: false,\n                            value: { item: 'bold' } });\n                    }\n                    if (parent.element.querySelector('#' + parent.element.id + '_bold').classList.contains('e-selected-btn')) {\n                        parent.element.querySelector('#' + parent.element.id + '_bold').classList.remove('e-selected-btn');\n                    }\n                    else {\n                        parent.element.querySelector('#' + parent.element.id + '_bold').classList.add('e-selected-btn');\n                    }\n                    break;\n                case 'italic':\n                    parent.notify('selection', { prop: 'setInitialTextEdit', value: { bool: false } });\n                    if (parent.activeObj.textSettings.bold && parent.activeObj.textSettings.italic) {\n                        parent.notify('shape', { prop: 'applyFontStyle', onPropertyChange: false,\n                            value: { item: 'bold' } });\n                    }\n                    else if (parent.activeObj.textSettings.bold && !parent.activeObj.textSettings.italic) {\n                        parent.notify('shape', { prop: 'applyFontStyle', onPropertyChange: false,\n                            value: { item: 'bolditalic' } });\n                    }\n                    else if (!parent.activeObj.textSettings.bold && parent.activeObj.textSettings.italic) {\n                        parent.notify('shape', { prop: 'applyFontStyle', onPropertyChange: false,\n                            value: { item: 'default' } });\n                    }\n                    else if (!parent.activeObj.textSettings.bold && !parent.activeObj.textSettings.italic) {\n                        parent.notify('shape', { prop: 'applyFontStyle', onPropertyChange: false,\n                            value: { item: 'italic' } });\n                    }\n                    if (parent.element.querySelector('#' + parent.element.id + '_italic').classList.contains('e-selected-btn')) {\n                        parent.element.querySelector('#' + parent.element.id + '_italic').classList.remove('e-selected-btn');\n                    }\n                    else {\n                        parent.element.querySelector('#' + parent.element.id + '_italic').classList.add('e-selected-btn');\n                    }\n                    break;\n                case 'croptransform':\n                    this.refreshToolbar('croptransform');\n                    break;\n                case 'rotateleft':\n                case 'rotateright':\n                case 'horizontalflip':\n                case 'verticalflip':\n                    parent.transformSelect(type);\n                    parent.notify('transform', { prop: 'disableZoomOutBtn', value: { isZoomOut: true } });\n                    break;\n                case 'save':\n                    if (parent.element.querySelector('#' + parent.element.id + '_saveBtn').classList.contains('e-hide')) {\n                        parent.element.querySelector('#' + parent.element.id + '_saveBtn').classList.remove('e-hide');\n                        break;\n                    }\n                    else {\n                        parent.okBtn();\n                    }\n                    parent.element.querySelector('#' + parent.element.id + '_saveBtn').classList.add('e-hide');\n                    parent.element.querySelector('#' + parent.element.id + '_saveBtn').click();\n                    break;\n            }\n        }\n    };\n    ToolbarModule.prototype.contextualToolbarClicked = function (args) {\n        var parent = this.parent;\n        var selEle = parent.element.querySelector('.e-contextual-toolbar-wrapper .e-toolbar-item.e-selected');\n        if (selEle) {\n            selEle.classList.remove('e-selected');\n        }\n        var type = args.item.id.replace(parent.element.id, '').split('_')[1];\n        var imageFiltering = { filter: parent.toPascalCase(type), cancel: false };\n        parent.trigger('imageFiltering', imageFiltering);\n        if (imageFiltering.cancel) {\n            return;\n        }\n        document.getElementById(args.item.id + 'Canvas').parentElement.parentElement.classList.add('e-selected');\n        parent.currObjType.isFiltered = true;\n        parent.notify('filter', { prop: 'applyImageFilter', value: { option: type.toLowerCase() } });\n        parent.currentFilter = args.item.id;\n        this.enableDisableTbrBtn();\n    };\n    ToolbarModule.prototype.refreshShapeDrawing = function () {\n        var parent = this.parent;\n        var object = { shape: '' };\n        parent.notify('selection', { prop: 'getCurrentDrawingShape', onPropertyChange: false, value: { obj: object } });\n        if (object['shape'] !== '') {\n            parent.notify('selection', { prop: 'setCurrentDrawingShape', onPropertyChange: false, value: { value: '' } });\n            parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n            this.refreshToolbar('main', false);\n        }\n    };\n    ToolbarModule.prototype.zoomInBtnClickHandler = function (e) {\n        var parent = this.parent;\n        if ((parent.zoomSettings.zoomTrigger & ZoomTrigger.Toolbar) === ZoomTrigger.Toolbar) {\n            this.refreshShapeDrawing();\n            if (Browser.isDevice && e.type === 'touchstart') {\n                if (!e.returnValue) {\n                    return;\n                }\n                e.preventDefault();\n            }\n            var zoomIn = document.querySelector('#' + parent.element.id + '_zoomIn');\n            EventHandler.trigger(zoomIn, 'click');\n            var obj = { bool: false };\n            parent.notify('selection', { prop: 'getFreehandDrawEditing', onPropertyChange: false, value: { obj: obj } });\n            if (obj['bool']) {\n                parent.notify('freehand-draw', { prop: 'applyFhd', onPropertyChange: false });\n                this.destroyQuickAccessToolbar();\n            }\n            this.applyPreviewFilter();\n            parent.currObjType.isFiltered = false;\n            if (parent.togglePen) {\n                parent.currObjType.isZoomed = true;\n                parent.freeHandDraw(false);\n                parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n            }\n            parent.notify('draw', { prop: 'resetCurrentSelectionPoint' });\n            parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                value: { zoomFactor: .1, zoomPoint: null } });\n        }\n    };\n    ToolbarModule.prototype.zoomOutBtnClickHandler = function (e) {\n        var parent = this.parent;\n        if ((parent.zoomSettings.zoomTrigger & ZoomTrigger.Toolbar) === ZoomTrigger.Toolbar) {\n            this.refreshShapeDrawing();\n            if (Browser.isDevice && e.type === 'touchstart') {\n                if (!e.returnValue) {\n                    return;\n                }\n                e.preventDefault();\n            }\n            var zoomOut = document.querySelector('#' + parent.element.id + '_zoomOut');\n            EventHandler.trigger(zoomOut, 'click');\n            var obj = { bool: false };\n            parent.notify('selection', { prop: 'getFreehandDrawEditing', onPropertyChange: false, value: { obj: obj } });\n            if (obj['bool']) {\n                parent.notify('freehand-draw', { prop: 'applyFhd', onPropertyChange: false });\n                this.destroyQuickAccessToolbar();\n            }\n            this.applyPreviewFilter();\n            parent.currObjType.isFiltered = false;\n            if (parent.togglePen) {\n                parent.currObjType.isZoomed = true;\n                parent.freeHandDraw(false);\n                parent.notify('undo-redo', { prop: 'updateCurrUrc', value: { type: 'ok' } });\n            }\n            parent.notify('draw', { prop: 'resetCurrentSelectionPoint' });\n            parent.notify('transform', { prop: 'zoomAction', onPropertyChange: false,\n                value: { zoomFactor: -.1, zoomPoint: null } });\n        }\n    };\n    ToolbarModule.prototype.zoomInBtnMouseDownHandler = function (e) {\n        e.preventDefault();\n        this.zoomBtnHold = setInterval(this.zoomInBtnClickHandler.bind(this), 250);\n    };\n    ToolbarModule.prototype.zoomOutBtnMouseDownHandler = function (e) {\n        e.preventDefault();\n        this.zoomBtnHold = setInterval(this.zoomOutBtnClickHandler.bind(this), 250);\n    };\n    ToolbarModule.prototype.zoomBtnMouseUpHandler = function () {\n        clearInterval(this.zoomBtnHold);\n        this.zoomBtnHold = 0;\n    };\n    ToolbarModule.prototype.closeContextualToolbar = function () {\n        var parent = this.parent;\n        var isContextualToolbar = false;\n        if ((parent.element.querySelector('#' + parent.element.id + '_contextualToolbar') &&\n            !parent.element.querySelector('#' + parent.element.id + '_contextualToolbar').parentElement.classList.contains('e-hide')) ||\n            (parent.element.querySelector('#' + parent.element.id + '_headWrapper')\n                && !parent.element.querySelector('#' + parent.element.id + '_headWrapper').parentElement.classList.contains('e-hide'))) {\n            parent.element.querySelector('.e-contextual-toolbar-wrapper').classList.add('e-hide');\n            parent.okBtn();\n            this.refreshMainToolbar();\n            isContextualToolbar = true;\n        }\n        return isContextualToolbar;\n    };\n    ToolbarModule.prototype.destroyQuickAccessToolbar = function () {\n        var parent = this.parent;\n        var quickToolbar = document.getElementById(parent.element.id + '_quickAccessToolbar');\n        if (quickToolbar && quickToolbar.classList.contains('e-control')) {\n            getComponent(quickToolbar, 'toolbar').destroy();\n        }\n        var qatArea = document.getElementById(parent.element.id + '_quickAccessToolbarArea');\n        if (qatArea) {\n            qatArea.style.display = 'none';\n        }\n    };\n    ToolbarModule.prototype.renderSlider = function (type) {\n        var parent = this.parent;\n        var canvasWrapper = document.querySelector('#' + parent.element.id + '_contextualToolbarArea');\n        var hdrWrapper = document.querySelector('#' + parent.element.id + '_headWrapper');\n        var labelWrapper = document.querySelector('#' + parent.element.id + '_labelWrapper');\n        if (!hdrWrapper) {\n            hdrWrapper = canvasWrapper.appendChild(parent.createElement('div', {\n                id: parent.element.id + '_headWrapper',\n                styles: 'position: relative'\n            }));\n            labelWrapper = hdrWrapper.appendChild(parent.createElement('label', {\n                id: parent.element.id + '_labelWrapper',\n                styles: Browser.isDevice ? 'position: absolute; top: 25%; left: calc(50% - 150px); font-size: 15px; text-transform: capitalize; font-weight: 400;'\n                    : 'position: absolute; top: 25%; left: calc(50% - 226px); font-size: 15px; text-transform: capitalize; font-weight: 400;'\n            }));\n        }\n        else {\n            hdrWrapper.style.display = 'block';\n        }\n        labelWrapper.textContent = this.l10n.getConstant(parent.toPascalCase(type));\n        var sliderWrapper = hdrWrapper.appendChild(parent.createElement('div', {\n            id: parent.element.id + '_sliderWrapper',\n            styles: 'position: absolute'\n        }));\n        var value = parent.getCurrAdjustmentValue(type);\n        var min;\n        var max;\n        var slider;\n        if (type === 'brightness' || type === 'contrast' || type === 'saturation' || type === 'exposure') {\n            if (parent.finetuneSettings) {\n                if (type === 'brightness' && parent.finetuneSettings.brightness) {\n                    min = parent.finetuneSettings.brightness.min;\n                    max = parent.finetuneSettings.brightness.max;\n                }\n                else if (type === 'contrast' && parent.finetuneSettings.contrast) {\n                    min = parent.finetuneSettings.contrast.min;\n                    max = parent.finetuneSettings.contrast.max;\n                }\n                else if (type === 'saturation' && parent.finetuneSettings.saturation) {\n                    min = parent.finetuneSettings.saturation.min;\n                    max = parent.finetuneSettings.saturation.max;\n                }\n                else if (type === 'exposure' && parent.finetuneSettings.exposure) {\n                    min = parent.finetuneSettings.exposure.min;\n                    max = parent.finetuneSettings.exposure.max;\n                }\n                else {\n                    min = -100;\n                    max = 100;\n                }\n            }\n            else {\n                min = -100;\n                max = 100;\n            }\n            slider = this.createSlider(min, max, value, type);\n        }\n        else if (type === 'hue' || type === 'blur' || type === 'opacity') {\n            if (parent.finetuneSettings) {\n                if (type === 'hue' && parent.finetuneSettings.hue) {\n                    min = parent.finetuneSettings.hue.min;\n                    max = parent.finetuneSettings.hue.max;\n                }\n                else if (type === 'blur' && parent.finetuneSettings.blur) {\n                    min = parent.finetuneSettings.blur.min;\n                    max = parent.finetuneSettings.blur.max;\n                }\n                else if (type === 'opacity' && parent.finetuneSettings.opacity) {\n                    min = parent.finetuneSettings.opacity.min;\n                    max = parent.finetuneSettings.opacity.max;\n                }\n                else {\n                    min = 0;\n                    max = 100;\n                }\n            }\n            else {\n                min = 0;\n                max = 100;\n            }\n            slider = this.createSlider(min, max, value, type);\n        }\n        slider.appendTo('#' + parent.element.id + '_sliderWrapper');\n        sliderWrapper.style.left = (parseFloat(canvasWrapper.style.width) - parseFloat(slider.width)) / 2 + 'px';\n    };\n    ToolbarModule.prototype.createSlider = function (min, max, value, type) {\n        var _this = this;\n        var parent = this.parent;\n        return new Slider({\n            value: value,\n            tooltip: { isVisible: true, placement: 'Before', showOn: 'Always' },\n            type: 'MinRange',\n            min: min,\n            max: max,\n            step: 10,\n            width: Browser.isDevice ? '200px' : '300px',\n            cssClass: 'e-slider',\n            change: function (args) {\n                parent.setCurrAdjustmentValue(type, args.value);\n                _this.enableDisableTbrBtn();\n            }\n        });\n    };\n    ToolbarModule.prototype.applyPreviewFilter = function () {\n        var parent = this.parent;\n        if (document.querySelector('#' + parent.element.id + '_sliderWrapper') ||\n            parent.currObjType.isFiltered) {\n            parent.initialAdjustmentValue = this.lowerContext.filter;\n            parent.canvasFilter = this.lowerContext.filter;\n            parent.currObjType.isFiltered = false;\n        }\n    };\n    ToolbarModule.prototype.unselectBtn = function () {\n        var parent = this.parent;\n        var selectors = [\n            '#' + parent.element.id + '_brightness',\n            '#' + parent.element.id + '_contrast',\n            '#' + parent.element.id + '_hue',\n            '#' + parent.element.id + '_saturation',\n            '#' + parent.element.id + '_opacity',\n            '#' + parent.element.id + '_blur',\n            '#' + parent.element.id + '_exposure'\n        ];\n        for (var _i = 0, selectors_1 = selectors; _i < selectors_1.length; _i++) {\n            var selector = selectors_1[_i];\n            var element = document.querySelector(selector);\n            if (element.classList.contains('e-selected-btn')) {\n                element.classList.remove('e-selected-btn');\n                break;\n            }\n        }\n    };\n    ToolbarModule.prototype.openSlider = function (type) {\n        this.unselectBtn();\n        this.parent.currObjType.isFiltered = true;\n        this.refreshToolbar('color', null, null, null, type);\n        document.getElementById(this.parent.element.id + '_' + type).classList.add('e-selected-btn');\n    };\n    ToolbarModule.prototype.refreshSlider = function () {\n        var sliderWrapper = document.querySelector('#' + this.parent.element.id + '_sliderWrapper');\n        // eslint-disable-next-line\n        var slider = document.querySelector('.e-slider');\n        var hdrWrapper = document.querySelector('#' + this.parent.element.id + '_headWrapper');\n        if (hdrWrapper) {\n            hdrWrapper.style.display = 'none';\n        }\n        if (sliderWrapper && slider) {\n            slider.ej2_instances[0].destroy();\n            sliderWrapper.remove();\n        }\n    };\n    ToolbarModule.prototype.updateToolbarItems = function () {\n        var parent = this.parent;\n        if (!parent.isImageLoaded) {\n            return;\n        }\n        var selFillElem = parent.element.querySelector('.e-fill.e-template .e-dropdownbtn-preview');\n        var selStrokeElem = parent.element.querySelector('.e-stroke.e-template .e-dropdownbtn-preview');\n        var selTextStrokeElem = parent.element.querySelector('.e-text-font-color.e-template .e-dropdownbtn-preview');\n        var selPenStrokeElem = parent.element.querySelector('.e-pen-stroke-color.e-template .e-dropdownbtn-preview');\n        var strokeWidthElem = parent.element.querySelector('.e-shape-stroke-width');\n        var fontFamilyElem = parent.element.querySelector('.e-text-font-family');\n        var fontSizeElem = parent.element.querySelector('.e-text-font-size');\n        var boldBtn = parent.element.querySelector('#' + parent.element.id + '_bold');\n        var italicBtn = parent.element.querySelector('#' + parent.element.id + '_italic');\n        if (isNullOrUndefined(parent.activeObj.strokeSettings.strokeWidth)) {\n            parent.activeObj.strokeSettings.strokeWidth = 2;\n        }\n        if (selFillElem) {\n            if (parent.activeObj.strokeSettings.fillColor === '') {\n                selFillElem.classList.add('e-nocolor-item');\n            }\n            else {\n                selFillElem.classList.remove('e-nocolor-item');\n                selFillElem.style.background = parent.activeObj.strokeSettings.fillColor;\n            }\n            getComponent(parent.element.id + '_shape_fill', 'colorpicker').value\n                = parent.activeObj.strokeSettings.fillColor + 'ff';\n        }\n        if (selStrokeElem) {\n            selStrokeElem.style.background = parent.activeObj.strokeSettings.strokeColor;\n            getComponent(parent.element.id + '_shape_stroke', 'colorpicker').value\n                = parent.activeObj.strokeSettings.strokeColor + 'ff';\n        }\n        if (selTextStrokeElem) {\n            selTextStrokeElem.style.background = parent.activeObj.strokeSettings.strokeColor;\n            getComponent(parent.element.id + '_text_font', 'colorpicker').value\n                = parent.activeObj.strokeSettings.strokeColor + 'ff';\n        }\n        if (selPenStrokeElem) {\n            selPenStrokeElem.style.background = parent.activeObj.strokeSettings.strokeColor;\n            getComponent(parent.element.id + '_pen_stroke', 'colorpicker').value\n                = parent.activeObj.strokeSettings.strokeColor + 'ff';\n        }\n        if (fontFamilyElem) {\n            if (Browser.isDevice) {\n                fontFamilyElem.setAttribute('style', 'font-family:' + parent.activeObj.textSettings.fontFamily.toLowerCase());\n            }\n            else {\n                fontFamilyElem.textContent = parent.activeObj.textSettings.fontFamily;\n            }\n        }\n        if (fontSizeElem) {\n            for (var i = 0; i < parent.fontSizeColl.length; i++) {\n                if (parseInt(parent.fontSizeColl[i].text, 10) >= Math.round(parent.activeObj.textSettings.fontSize)) {\n                    fontSizeElem.textContent = (i + 1).toString();\n                    break;\n                }\n            }\n        }\n        if (boldBtn) {\n            if (parent.activeObj.textSettings.bold) {\n                boldBtn.classList.add('e-selected-btn');\n            }\n            else {\n                boldBtn.classList.remove('e-selected-btn');\n            }\n        }\n        if (italicBtn) {\n            if (parent.activeObj.textSettings.italic) {\n                italicBtn.classList.add('e-selected-btn');\n            }\n            else {\n                italicBtn.classList.remove('e-selected-btn');\n            }\n        }\n        if (strokeWidthElem) {\n            var strokeWidth = Math.round((parent.activeObj.strokeSettings.strokeWidth)).toString();\n            strokeWidthElem.textContent = this.getStrokeWidth(strokeWidth);\n        }\n    };\n    ToolbarModule.prototype.getStrokeWidth = function (text) {\n        var strokeWidth;\n        var currentWidth = parseInt(text, 10) / 2;\n        switch (currentWidth) {\n            case 1:\n                strokeWidth = this.l10n.getConstant('XSmall');\n                break;\n            case 2:\n                strokeWidth = this.l10n.getConstant('Small');\n                break;\n            case 3:\n                strokeWidth = this.l10n.getConstant('Medium');\n                break;\n            case 4:\n                strokeWidth = this.l10n.getConstant('Large');\n                break;\n            case 5:\n                strokeWidth = this.l10n.getConstant('XLarge');\n                break;\n        }\n        return strokeWidth;\n    };\n    ToolbarModule.prototype.cancelPan = function () {\n        var parent = this.parent;\n        parent.notify('shape', { prop: 'applyActObj', onPropertyChange: false, value: { isMouseDown: true } });\n        var panBtn = parent.element.querySelector('.e-img-pan .e-btn');\n        if (panBtn) {\n            panBtn.classList.remove('e-selected-btn');\n        }\n        parent.pan(false);\n    };\n    ToolbarModule.prototype.refreshMainToolbar = function () {\n        if (this.currToolbar !== 'main') {\n            this.refreshToolbar('main');\n        }\n    };\n    ToolbarModule.prototype.destroySubComponents = function () {\n        var parent = this.parent;\n        var inputElement = parent.element.querySelectorAll('input.e-control');\n        var btnElement = parent.element.querySelectorAll('button.e-control');\n        for (var i = 0, len = inputElement.length; i < len; i++) {\n            if (inputElement[i].classList.contains('e-color-picker')) {\n                getComponent(inputElement[i], 'color-picker').destroy();\n                detach(select('input#' + inputElement[i].id, parent.element));\n            }\n        }\n        for (var i = 0, len = btnElement.length; i < len; i++) {\n            if (btnElement[i].classList.contains('e-dropdown-btn')) {\n                getComponent(btnElement[i], 'dropdown-btn').destroy();\n                detach(select('button#' + btnElement[i].id, parent.element));\n            }\n            else if (btnElement[i].classList.contains('e-btn')) {\n                getComponent(btnElement[i], 'btn').destroy();\n                detach(select('button#' + btnElement[i].id, parent.element));\n            }\n        }\n    };\n    ToolbarModule.prototype.setInitialShapeSettings = function (args) {\n        var parent = this.parent;\n        parent.notify('shape', { prop: 'refreshActiveObj', onPropertyChange: false });\n        parent.currObjType.shape = args.item.id;\n        parent.activeObj.shape = parent.currObjType.shape.toLowerCase();\n        parent.currObjType.isDragging = parent.currObjType.isCustomCrop = false;\n        parent.activeObj.shapeDegree = parent.transform.degree;\n        parent.activeObj.shapeFlip = parent.transform.currFlipState;\n        parent.activeObj.textFlip = parent.transform.currFlipState;\n        parent.activeObj.flipObjColl = [];\n    };\n    ToolbarModule.prototype.getModuleName = function () {\n        return 'toolbar-module';\n    };\n    return ToolbarModule;\n}());\nexport { ToolbarModule };\n"],"names":["Crop","parent","this","croppedDegree","cropDestPoints","startX","startY","width","height","tempFlipPanPoint","x","y","isPreventScaling","isInitCrop","addEventListener","prototype","destroy","isDestroyed","removeEventListener","on","cropping","off","args","updateCropPvtVar","prop","cropImg","value","cropCircle","setCurrSelPoints","updateRotatePan","crop","calcRatio","isObjInImage","getCurrFlipState","prevCropCurrObj","isNullOrUndefined","reset","getModuleName","lowerCanvas","lowerContext","getContext","upperCanvas","upperContext","isRotateCrop","isNullCrop","actPoint","activeObj","activePoint","notify","onPropertyChange","transform","degree","updateCropObj","point","img","destLeft","destTop","destWidth","destHeight","rotateCrop","currFlipState","flipCrop","tempZoomFactor","zoomFactor","ratio","currSelectionPoint","extend","obj","maxDimension","clearRect","srcLeft","srcTop","srcWidth","srcHeight","clientWidth","clientHeight","temp","filter","drawImage","baseImg","cropObjColl","isPreventApply","i","len","objColl","length","shape","canvas","cropFreehandDrawColl","context","isCircleCrop","currObjType","isCustomCrop","pan","defaultZoomFactor","afterCropActions","object","currObj","cropObj","push","tempCurrSelObj","preventSelObj","bool","coll","rotateFlipColl","panToSelRangle","resetZoom","revertTransform","pop","type","isRotate","direction","toPascalCase","shapeFlip","freehandCounter","pointColl","isUndoRedo","zoomPoint","isReverseFlip","panPoint","totalPannedPoint","tempCurrFlipState","flipColl","tempFlipColl","setTransform","isPreventDestination","isPreventCircleCrop","isRotateZoom","imageRatio","endX","endY","size","shapeDegree","Math","abs","textSettings","fontRatio","fontSize","cropPointCollection","selPoint","n","ratioX","ratioY","points","l","isSetDimension","destPoint","totalPannedInternalPoint","cropPointColl","destPoints","selPointColl","cropSelPointColl","actObj","cropZoom","isContextualToolbar","isApplyBtn","isCropping","isZooming","cType","isReverse","panX","totalPannedClientPoint","panY","currentPannedPoint","xDiff","yDiff","isSave","isFlip","globalCompositeOperation","beginPath","centerX","centerY","radius","arc","PI","closePath","fill","restore","isActiveObj","getCurrCropState","isAllowInvert","flipState","state","isInitialRotate","panRegion","_this","disabled","isImageLoaded","object_1","isCropToolbar","isUndoAction","transitionArgs","cancel","startPoint","endPoint","preventScaling","isBlazor","events","hasDelegate","dotNetRef","invokeMethodAsync","then","cropEvent","trigger","splitWords","split","horTopLine","isCrop","prevCropObj","prevObj","setProperties","zoomSettings","previousZoomValue","currSelPtObj","prevCurrSelectionPoint","operation","previousObj","previousObjColl","previousPointColl","previousSelPointColl","previousCropObj","previousText","currentText","previousFilter","updateToolbar","element","dimension","widthRatio","heightRatio","dummyObj","isInside","panObj","collection","isRotateFlipCollection","region","Draw","isInitialLoading","fileName","isErrorImage","isShapeTextInserted","tempStrokeSettings","strokeColor","fillColor","strokeWidth","tempTextSettings","text","fontFamily","bold","italic","underline","tempAdjValue","tempFilter","tempUndoRedoStep","tempFreehandCounter","tempCurrFhdIndex","isCancelAction","rotatedFlipCropSel","zoomCrop","isImageEdited","isFileChanged","isNewPath","arrowDimension","bar","arrow","arrowSolid","circle","square","draw","updatePrivateVariables","drawObject","updateActiveObject","clearOuterCanvas","setDestPoints","updateCurrTransState","currTransState","renderImage","drawImgToCanvas","updateCanvas","performCancel","updateFlipPan","select","callUpdateCurrTransState","resetPanPoints","setClientTransDim","redrawImgWithObj","setCurrentObj","performPointZoom","open","getInitialLoaded","fileSelect","fileType","initZoomValue","currSelPoint","prevActObj","dlgBtnClick","dlgCloseBtnClick","moveToSelectionRange","isCropRatio","isPreventDrag","saveContext","isPreventSelection","canvasDraw","toLowerCase","setDragLimit","drawCropRatio","strokeSettings","obj_1","isText","obj_2","keyHistory","fillStyle","fillRect","rotateContext","drawOuterSelection","drawShapeObj","undefined","ctx","rotationAngle","rotatedAngle","translate","rotate","updateWidthHeight","drawCustomSelection","imgWidth","imgHeight","updatePoints","diff","adjToCenter","diffX","diffY","isMouseMove","horCircleWidth","verCircleHeight","horBottomLine","verLeftLine","verRightLine","topLeftCircle","topCenterCircle","topRightCircle","centerLeftCircle","centerRightCircle","bottomLeftCircle","bottomCenterCircle","bottomRightCircle","rotationCirclePoint","isCropCircle","lineWidth","tempObj","strokeStyle","themeColl","theme","moveTo","lineTo","stroke","rect","selectionSettings","showCircle","drawCenterCircles","rotationCircleLine","drawArrowHead","isStartHead","start","end","arrowCircleSolid","arrowCircle","arrowBar","arrowSquareStart","arrowSquareEnd","currentShape","horLineWidth","verLineHeight","selectionWidth","selectionHeight","tempFillStyle","drawSquareLines","ellipse","shapeCircle","shapeLine","triangleDirection","nextPoint","shapeText","drawSelection","drawRotationArcLine","isHorizontalflip","isVerticalflip","flipObjColl","horTopInnerLine","horBottomInnerLine","verLeftInnerLine","verRightInnerLine","tempWidth","save","clip","x1","y1","x2","y2","tempLineWidth","manipulateSaveCtx","dx","dy","angle","atan2","strokeRect","squareStartIntersectX1","cos","squareStartIntersectY1","sin","endCircleIntersectX1","endCircleIntersectY1","squareEndIntersectX1","squareEndIntersectY1","startCircleIntersectX1","startCircleIntersectY1","circleRadius","a","intersect","b","c","t2","sqrt","intersectionX1","intersectionY1","rows","lineHeight","yPoint","textStyle","font","j","scale","updateActPoint","rotateText","fillText","k","textFlipDegree","left","top_1","isRotatePan","isPreventDimension","setTransformColl","isMouseWheel","isMouseDown","imageOnLoad","src","proxy","onload","hideSpinner","style","opacity","isUndoZoom","display","Browser","isDevice","querySelector","offsetHeight","toolbarHeight","eventargs","isOkBtn","onerror","errorLoading","fileOpened","isValidImage","setAttribute","zoom","textArea","document","id","classList","contains","isFiltered","canvasFilter","adjustmentValue","initialAdjustmentValue","isBrightnessAdjusted","currentFilter","obj_3","tempAdjustmentLevel","adjustmentLevel","step","cursor","add","cancelItems","togglePan","isDisabled","isCropSelection","shapes","isCropTab","togglePen","cancelPen","cancelText","indexOf","cancelShape","cancelSelection","tempPointsColl","isFreehandDrawCustomized","currIndex","appliedUndoRedoColl","currentObjColl","clearSelection","isDragging","cancelCropSelection","tempSelectionObj","selPointCollObj","isPrevent","cropZoomFactor","drawNewSelection","cropShape","updateSelectionInsert","shapeSettingsObj","getSelectionType","selectionChangingArgs","action","previousSelectionSettings","currentSelectionSettings","onSelectionResizeStart","imgLeft_1","imgTop_1","imgWidth_1","imgHeight_1","lowerCanvasWidth_1","lowerCanvasHeight_1","activePoint_1","imgLeft_2","imgTop_2","imgWidth_2","imgHeight_2","lowerCanvasWidth_2","lowerCanvasHeight_2","activePoint_2","max","min","imgLeft","imgTop","lowerCanvasWidth","lowerCanvasHeight","tempObjColl","tempActiveObj","tempTogglePen","getDefaultFilter","isObj","defaultZoom","srcPoints","isBrightAdjust","drawCropSelectionImage","isDefaultZoom","isAfterCropAction","clearContext","drawZoomPanImage","adjustPanning","openNewImage","inMemoryContext","inMemoryCanvas","showSpinner","toolbar","defToolbarItems","getElementById","update","openURL","getFileExtensionFromURL","putImageData","toDataURL","export","checkToolbarTemplate","inputElem","getComponent","baseImgSrc","showDialogPopup","Dialog","header","closeOnEscape","content","target","isModal","animationSettings","effect","close","bind","buttons","click","buttonModel","iconCss","isPrimary","appendTo","restoreOldImage","data","url","lastDotIndex","lastIndexOf","slice","inputElement","filesData","files","fileData","fileExtension","name","window","URL","createObjectURL","toolbarTemplate","toString","isRotated","maxZoomFactor","isSelectionBiggerThanCanvas","isSelectionOutsideCanvas","isBigger","isOutside","Export","updatePvtVar","exportImg","exportToCanvas","imageName","isZoomed","beforeSave","saving","beforeSaveEvent","observableSaveArgs","lowerCaseType","toSVGImg","toBlobFn","saved","top","maxWidth","maxHeight","tempCanvas","dataUrl","svg","createElementNS","setAttributeNS","appendChild","innerHTML","svgDataUrl","btoa","downloadImg","toBlob","blob","blobUrl","tempContextFilter","parseFloat","join","createElement","attrs","tempContext","dimObj","updateSaveContext","exportTransformedImage","temp_1","tempPointColl","href","download","body","documentElement","parentNode","removeChild","flip","exportRotate","exportFlip","setMaxDim","flipHorizontal","flipVertical","imageData","getImageData","newWidth","newHeight","Filter","brightness","contrast","hue","saturation","blur","exposure","sharpen","bw","appliedFilter","finetuneImage","setFilter","updateFinetunes","updateBrightFilter","setAdjustment","updateFilter","initFilter","setCurrAdjValue","updateAdj","getCurrentObj","opacityValue","fs","finetuneSettings","defaultValue","setFilterAdj","isPreview","brightnessValue","values","getFilterValue","saturate","bright","saturatePercent","saturatePercentage","getSaturationFilterValue","getDefaultCurrentFilter","setTempFilterValue","tempSplitWords","prevFilter","valueArr","setFilterValue","setSaturationFilterValue","round","selEle","remove","filterCanvas","parentElement","finetuneOption","tempFlipPanPointObj","zoomObj","FreehandDrawing","fhdObj","lastWidth","lastVelocity","time","pointX","pointY","isFreehandDrawing","freehandDownPoint","isFreehandPointMoved","pointCounter","currFHDIdx","selPoints","dummyPoints","tempFHDStyles","updateFhdPvtVar","hoverFhd","freehandDownHandler","freehandUpHandler","parseInt","isFHDIdx","deleteFhd","freehandRedraw","selectFhd","applyFhd","cancelFhd","updateFHDCurPts","rotateFhdColl","flipFHDColl","panFHDColl","updateFHDColl","zoomFHDColl","applyPenDraw","freeHandDraw","getSqPtFD","fhdHovIdx","penStrokeWidth","updateCropPtsForSel","fhdSelID","fhdSelIdx","idx","controlPoint1","controlPoint2","minStrokeWidth","maxStrokeWidth","startDraw","calcCurveCP","e","Date","getTime","clientX","clientY","touches","EventHandler","freehandMoveHandler","getBoundingClientRect","processPoint","fhCnt","mouseDown","lastPoint","isLastPointTooClose","distanceTo","unshift","p0","p1","p2","p3","shift","dx1","dy1","dx2","dy2","m1","m2","l1","l2","dxm","dym","cm","tx","ty","tempVelocity","pointVelocity","drawCurve","pow","startWidth","endWidth","t1","t3","u1","u2","u3","widthValue","bezierLength","drawSteps","ceil","drawArc","t","pointX1","pointY1","pointX2","pointY2","pointX3","pointY3","bezierPoint","cp1","cp2","sPoints","selectedPoint","color","isSelected","index","shapeSettings","ShapeType","FreehandDraw","shapeChangingArgs","previousShapeSettings","currentShapeSettings","shapeChanging","okBtn","isId","tempSelPointColl","count","zoomX","zoomY","lowercaseValue","pointsHorizontalFlip","pointsVerticalFlip","isIndex","Selection","diffPoint","oldPoint","isTouch","isObjSelected","isFhdPoint","dragPoint","isShapeInserted","triangle","triangleRatio","isFirstMove","startTouches","tempTouches","currMousePoint","cursorTargetId","isPreventDragging","dragElement","textRow","mouseDownPoint","previousPoint","zoomType","isInitialTextEdited","dragCanvas","isFhdCustomized","touchEndPoint","isFhdEditing","currentDrawingShape","initialPrevObj","touchTime","resizedElement","selection","selMouseUpEvent","setCursor","updateActivePoint","updateCursorStyles","setTextSelection","setActivePoint","calcShapeRatio","applyCurrShape","performTabAction","setDragDirection","setTimeout","redrawShape","setTextBoxStylesToActObj","mouseDownEventHandler","mouseMoveEventHandler","mouseUpEventHandler","canvasMouseDownHandler","canvasMouseMoveHandler","canvasMouseUpHandler","touchStartHandler","keyDownEventHandler","handleScroll","textKeyDown","deleteItem","updatePrevShapeSettings","panDown","adjustActObjForLineArrow","findTarget","getCurrentFlipState","setDragWidth","setDragHeight","getTransRotationPoint","adjustNEPoints","adjustRotationPoints","getResizeDirection","unwireEvent","updPtCollForShpRot","timer","pathAdjustedIndex","allowUndoRedoPush","getMouseCursor","isApply","setCursorForLineArrow","setCursorForPath","setCursorForRotatedObject","setCursorFromObj","isResize","setCursorForFreehandDrawing","isMove","horTopLinePointColl","verLeftLinePointColl","verRightLinePointColl","horBottomLinePointColl","rotationCirclePointColl","getRectanglePoints","adjustCursorStylesForRotatedState","floor","cursorMap","nw-resize","n-resize","ne-resize","w-resize","e-resize","sw-resize","s-resize","se-resize","getResizeElement","resizeMappings","positiveDegree","_i","resizeMappings_1","_a","startDegree","endDegree","resizeElement","isEntered","z1","z2","z3","z4","shapeResizingArgs","shapeMovingArgs","isTextArea","updateNWPoints","rotatedDegree","triggerShapeChange","updateNPoints","updateNEPoints","updateWPoints","updateEPoints","updateSWPoints","updateSPoints","updateSEPoints","eventType","onShapeResizeStart","selectionResizingArgs","onShapeDragStart","tempHeight","limitDrag","isStart","preventDraggingInvertly","preventTextDraggingInvertly","isLimiting","preventInverseResize","getScaleRatio","newScale","percentage","prevDiffX","prevDiffY","adjustNWPoints","top_2","adjustSWPoints","adjustSEPoints","rectangle","cx","cy","rotatedC","rotatePoints","newCenter","newBottomRight","newTopLeft","rotatedD","newBottomLeft","newTopRight","rotatedB","rotatedA","setResizedValue","getResizedElement","resizeMappings_2","isLine","updateCursorStylesForLineArrow","updateCursorStylesForPath","textWidth","textHeight","selectInfo","currentTarget","isPan","imageEditorClickEventArgs","setXYPoints","clicked","clickEvent","getImagePoints","isShape","isShapeTouch","isFreehandDraw","isFreehandDrawTouch","isShapeClick","applyObj","isLineArrow","x_1","y_1","indexObj","freehandSelectedIndex","tempHoveredIndex","isPenEdit","canvasCursor","preventDefault","bbox","targetTouches","pageX","offsetLeft","pageY","offsetTop","firstFingerX","firstFingerY","secondFingerX","secondFingerY","center","zoomTrigger","ZoomTrigger","Pinch","calculateScale","isZoomOut","stopImmediatePropagation","onPanEnd","panEventArgs","onShapeResizeEnd","onSelectionResizeEnd","onShapeDragEnd","prevCropObj_1","JSON","stringify","applyCurrActObj","splitWords_1","isCropSelection_1","isInitialLine","isAdjusted","getCurrentIndex","findTargetObj","splice","setTimer","rgbToHex","offsetX","offsetY","tempPanMoveObj","tempPanMove","panMove","panMoveObj","ctrlKey","key","allowUndoRedo","Commands","isKeyBoardCrop","isInsideCanvas","stopPropagation","MouseWheel","wheelDelta","String","fromCharCode","which","scrollHeight","originalWidth","originalHeight","presetRatio","standardSize","scaleWidth","getScale","snippetArray","scaleHeight","snippetArray1","originalValue","cursor_1","cursor_2","shapeChangingArgs_1","shapeEvent","endTouches","startDistance","getDistance","isMouseUp","clearTimeout","smallPoint","largePoint","fontWeight","fontStyle","r","g","componentToHex","rgb","hex","updateFreehandDrawColorChange","freehandDrawSelectedId","object_2","tempFreeHandDrawEditingStyles","rectX","rectY","rectWidth","rectHeight","rectAngle","angleRad","cosAngle","sinAngle","localX","localY","rotatedX","rotatedY","halfWidth","halfHeight","Shape","initShapePvtProps","drawEllipse","drawLine","drawArrow","drawPath","drawRectangle","drawText","redrawActObj","apply","updateShapeChangeEventArgs","updSelChangeEventArgs","iterateObjColl","updImgRatioForActObj","zoomObjColl","redrawObj","rotateObjColl","drawShapeText","redrawText","drawShape","renderTextArea","setTextBoxWidth","findTextTarget","panObjColl","updateFontStyles","applyFontStyle","updateFontRatio","updateFontSize","updateObjColl","pushActItemIntoObj","clearActObj","refreshActiveObj","applyActObj","getShapeSetting","getShapeSettings","isPointsInRange","alignRotateFlipColl","selectShape","deleteShape","getMaxText","getLinePoints","setPointCollForShapeRotation","setTextBoxPos","setTextBoxPoints","alignTextAreaIntoCanvas","initializeTextShape","stopPathDrawing","updateArrowRatio","getSquarePointForRotatedShape","radiusX","radiusY","initializeShape","lineDraw","arrowStart","arrowEnd","setDimension","getArrowType","arrowType","None","Arrow","SolidArrow","Circle","SolidCircle","Square","SolidSquare","Bar","objColl_1","setCenterPoints","setPointCollForLineAndArrow","initShapeProps","isPublicMethod","textFlip","prevObjColl","isInitialText","measureText","drawShapeTextEvent","addLetter","updateTextFromTextArea","renderWidth","renderHeight","letter","widthColl","updatePathRatio","preventApply","len_1","updateArrowSize","len_2","updateCurrentActiveObjPoint","currActObjIndex","flipLineArrowObj","rotateLineArrowObj","prevPoint","lineArrowHorizontalFlip","lineArrowVerticalFlip","currPoint","getRotDegOfShape","transformTextArea","border","overflow","focus","setTextBoxHeight","textAreaWidth","letterWidth","textAreaLeft","textAreaTop","selectedText","selectionStart","finish","selectionEnd","substring","len_3","len_4","len_5","isTextBox","item","updateFontStyle","getTextAreaWidth","dimensions_1","dimensions_2","tempBold","tempItalic","isActObj","letters","transformOrigin","getObjDetails","shapeDetails","getFreehandDrawDetails","shapeDetailsColl","inRange","popForDefaultTransformedState","popForDefaultFlipState","popForDefaultRotateState","rotateRight","rotateleft","horizontal","vertical","maxi","maxStr","maxText","m","getSlope","getIntercept","lesserY","i_1","prev","lesserX","i_2","isSameAxis","slope","p4","reverse","Transform","disablePan","isReverseRotate","prevZoomValue","cropDimension","isPreventSelect","initTransformPvtVar","rotateImage","flipImage","setDestPointsForFlipState","zoomAction","disableZoomOutBtn","rotatedFlip","drawPannedImage","drawPannImage","performTransformation","updateTransform","rotatePan","drawRotatedImage","limitPan","updateFlipActiveObj","setCurrPanRegion","calcMaxDimension","updatePanPoints","currDestPoint","zoomBtnHold","transCurrObj","previousDegree","currentDegree","rotating","rotateEvent","activeObjShape","rotateDegree","updateCurrSelectionPoint","previousDirection","flipping","flipEvent","lowercaseDirection","updateFlipState","selObj","updateFlipColl","toLocaleLowerCase","verticalFlip","horizontalFlip","lastFourItems","minZoomFactor","powerOften","zoomEventArgs","previousZoomFactor","currentZoomFactor","zooming","zoomEvent","drawZoomImgToCanvas","panObj_1","isAdd","rotateZoom","panObj_2","clearInterval","zoomOut","autoEnablePan","panBtn","setZoomDimension","selectionObj","maxDestLeft","maxDestTop","onPanStart","panEvent","isObjCreated","tempFlipState","Direction","Horizontal","Vertical","rotatePanActiveObj","tempDegree","initialDestLeft","initialDestTop","getCurrentZoomFactor","freehandObj","canvasWrapper","offsetWidth","obj1","refreshOverflow","canvasMaxWidth","canvasMaxHeight","widthScale","heightScale","cssMaxWidth","cssMaxHeight","tempActObj","tempDestLeft","tempDestTop","UndoRedo","undoRedoStep","undoRedoColl","tempUndoRedoColl","undoRedo","initializeUrPvtProp","updateUrc","refreshUrc","updateCurrUrc","callUndo","callRedo","undo","redo","updateUrObj","updateUndoRedo","undoDefault","tempCurrSelPoint","refreshToolbar","currentCropObj","currentObj","currentPointColl","getZeroZoomObjPointValue","refreshToolbarActions","applyCurrentChanges","shapeTransform","updateFreehandDraw","updateFreehandDrawCustomized","updateDelete","updateTextAreaCustomization","updateText","updateCropTransformItems","endUndoRedo","currentSelPointColl","updateTextBox","allowActiveObj","isUndo","isInitialLoaded","cropDimensionObj","getZeroZoomObjColl","getZeroZoomPointColl","arrowObj","tempArrowObj","__extends","extendStatics","d","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","create","__decorate","decorators","desc","arguments","getOwnPropertyDescriptor","Reflect","decorate","defineProperty","FinetuneSettings","_super","Property","ChildProperty","ZoomSettings","SelectionSettings","ImageEditor","options","call","fontSizeColl","ImageEditor_1","Inject","ToolbarModule","requiredModules","modules","member","preRender","getUniqueID","initializeThemeColl","render","initialize","getPersistData","addOnPersist","onPropertyChanged","newProperties","oldProperties","keys","cssClass","removeClass","replace","trim","addClass","wireEvent","locale","showQuickAccessToolbar","Toolbar","removeAttribute","concat","getAttribute","className","toolbarTemplateFn","createCanvas","quickAccessToolbar","position","quickAccessToolbarTemplate","quickAccessToolbarTemplateFn","createSpinner","initializeZoomSettings","keyUpEventHandler","windowResizeHandler","isIos","info","screen","orientation","screenOrientation","boxSizing","backgroundColor","resize","crossorigin","adjustToScreen","notifyResetForAllModules","allowShape","textContent","initialZoomValue","freehandDraw","isEllipse","isArrow","isPath","isRectangle","option","applyImageFilter","filterOption","getImageDimension","template","templateID","toolbarArea","toolbarFn","templateParser","isReact","isAngular","templateColl","nodeType","qatFn","querySelectorAll","templateCompiler","compile","error","getTextFromId","1","2","3","4","5","6","7","8","getFinetuneOption","ImageFinetuneOption","Brightness","Contrast","Hue","Saturation","Opacity","Blur","Exposure","setPenStroke","setInitialZoomState","str","strArr","charAt","toUpperCase","getFontSizes","items","selElem","children","setTempFilterProperties","cropSelectedState","tempAdjustmentValue","undoRedoObj","getCurrentCanvasData","setCurrAdjustmentValue","finetuneValueChanging","finetune","getSquarePointForPath","CropCustom","CropSquare","CropCircle","Crop3:2","Crop4:3","Crop5:4","Crop7:5","Crop16:9","updateArrow","updateFontFamily","itemText","text_1","text_2","updateFontColor","updatePenStrokeWidth","updatePenStrokeColor","updateStrokeWidth","updateStrokeColor","updateFillColor","pascalToSplitWords","splitStr","match","map","word","getCurrAdjustmentValue","transformSelect","initializeImageEditor","dotnetRef","prerender","Bootstrap5","primaryColor","secondaryColor","Bootstrap5Dark","Tailwind","TailwindDark","Fluent","FluentDark","Bootstrap4","Bootstrap","BootstrapDark","Material","MaterialDark","Fabric","FabricDark","Highcontrast","Material3","Material3Dark","Complex","Event","NotifyPropertyChanges","Component","FileType","Theme","ImageEditorCommand","ImageFilterOption","ArrowheadType","currToolbar","preventZoomBtn","currentToolbar","selFhdColor","preventEnableDisableUr","initLocale","defaultLocale","ZoomIn","ZoomOut","Undo","Redo","Annotation","Finetune","Sharpen","Default","Chrome","Cold","Warm","Grayscale","BlackAndWhite","Sepia","Invert","Text","Pen","Reset","Save","Select","RotateLeft","RotateRight","HorizontalFlip","VerticalFlip","OK","Cancel","FillColor","StrokeColor","StrokeWidth","FontFamily","FontStyle","FontSize","FontColor","Pan","Move","Load","Custom","Ellipse","Rectangle","Line","Path","Bold","Italic","BoldItalic","XSmall","Small","Medium","Large","XLarge","ABC","Browse","Duplicate","Remove","EditText","Start","End","ArrowSolid","CircleSolid","SquareSolid","CropAndTransform","CropSelection","l10n","L10n","createToolbar","createContextualToolbar","updateToolbarItems","renderQAT","enableDisableTbrBtn","initMainToolbar","createBottomToolbar","refreshMainToolbar","createQuickAccessToolbar","destroyQuickAccessToolbar","zoomBtnMouseUpHandler","refreshDropDownBtn","closeContextualToolbar","destroyBottomToolbar","destroyTopToolbar","destroySubComponents","setLocale","getPenStroke","performDefTbrClick","refreshSlider","renderSlider","refreshShapeDrawing","isToolbar","toolbarItems","align","tooltipText","getConstant","Uploader","allowedExtensions","toolbar_1","uploadItems","selected","created","toolbarType","defToolbarClicked","createLeftToolbarControls","toolbar_2","toolbarElem","initBottomToolbar","toolbar_3","isApplyOption","leftItem","getLeftToolbarItem","rightItem","getRightToolbarItem","mainItem","getMainToolbarItem","zoomItem","getZoomToolbarItem","renderAnnotationBtn","wireZoomBtnEvents","renderSaveBtn","renderCropBtn","renderTransformBtn","visible","prefixIcon","tempToolbarItems","processToolbar","updateContextualToolbar","contextualToolbarArea","initFilterToolbarItem","cHt","ht","processSubToolbar","zoomIn","zoomInBtnMouseDownHandler","zoomInBtnClickHandler","zoomOutBtnMouseDownHandler","zoomOutBtnClickHandler","uploadDiv","uploadElem","getElementsByTagName","uploadBtnElem","onchange","duplicateElement","removeElement","editTextElement","getCurrentShapeIcon","drpDownBtn","DropDownButton","currentFreehandDrawIndex","tempCurrentFreehandDrawIndex","setInitialShapeSettings","cancelPan","cropSelect","saveItems","getCropTransformToolbarItem","getShapesToolbarItem","initCropTransformToolbar","icon","initShapesToolbarItem","createShapeColor","createShapeBtn","createStartBtn","createEndBtn","ColorPicker","modeSwitcher","noColor","showButtons","mode","change","currentValue","rgba","fillDDB_1","toggle","inline","strokeDDB_1","background","strokeWidthItems","strokeWidthBtn","spanElem_1","drpDownBtn_1","activeBtn","spanElem","strokeEndBtn","getTextToolbarItem","getFontFamilyItems","initTextToolbarItem","createTextColor","createTextBtn","fontColor","strokeDDB_2","fontNameBtn","spanElem_2","fontFamilyBtn_1","createPopupOnClick","beforeItemRender","fontSizeBtnElem","fontSizeSpanElem_1","fontSizes","fontSizeBtn_1","initPenToolbarItem","initAdjustmentToolbarItem","getAdjustmentToolbarItem","getFilterToolbarItem","getPenToolbarItem","createPenColor","createPenBtn","penColor","strokeDDB_3","spanElem_3","drpDownBtn_2","valueToTextContent","contextualToolbarClicked","createCanvasFilter","hdrWrapper","updateFilterCanvas","selector","getQuickAccessToolbarItem","orgToolbarItems","qtArea","quickAccessToolbarClicked","path","annotation","adjustment","duplicateObj","isPreventUndoRedo","pathObject","isFilterFinetune","isDisabledFilter","isDisabledAdjustment","openSlider","imageFiltering","returnValue","applyPreviewFilter","setInterval","quickToolbar","qatArea","labelWrapper","styles","slider","sliderWrapper","createSlider","Slider","tooltip","isVisible","placement","showOn","unselectBtn","selectors_1","ej2_instances","selFillElem","selStrokeElem","selTextStrokeElem","selPenStrokeElem","strokeWidthElem","fontFamilyElem","fontSizeElem","boldBtn","italicBtn","getStrokeWidth","btnElement","detach"],"mappings":"0EACA,IAAIA,GAAsB,WACtB,QAASA,GAAKC,GACVC,KAAKC,cAAgB,EACrBD,KAAKE,gBAAmBC,OAAQ,EAAGC,OAAQ,EAAGC,MAAO,EAAGC,OAAQ,GAChEN,KAAKO,kBAAqBC,EAAG,EAAGC,EAAG,GACnCT,KAAKU,kBAAmB,EACxBV,KAAKW,YAAa,EAClBX,KAAKD,OAASA,EACdC,KAAKY,mBA0zBT,MAxzBAd,GAAKe,UAAUC,QAAU,WACjBd,KAAKD,OAAOgB,aAGhBf,KAAKgB,uBAETlB,EAAKe,UAAUD,iBAAmB,WAC9BZ,KAAKD,OAAOkB,GAAG,OAAQjB,KAAKkB,SAAUlB,MACtCA,KAAKD,OAAOkB,GAAG,YAAajB,KAAKc,QAASd,OAE9CF,EAAKe,UAAUG,oBAAsB,WACjChB,KAAKD,OAAOoB,IAAI,OAAQnB,KAAKkB,UAC7BlB,KAAKD,OAAOoB,IAAI,YAAanB,KAAKc,UAEtChB,EAAKe,UAAUK,SAAW,SAAUE,GAEhC,OADApB,KAAKqB,mBACGD,EAAKE,MACT,IAAK,UACDtB,KAAKuB,QAAQH,EAAKI,MAAoB,aACtC,MACJ,KAAK,aACDxB,KAAKyB,WAAWL,EAAKI,MAAe,QAAGJ,EAAKI,MAAc,OAAGJ,EAAKI,MAAc,OAChF,MACJ,KAAK,mBACDxB,KAAK0B,iBAAiBN,EAAKI,MAAsB,eACjD,MACJ,KAAK,kBACDxB,KAAK2B,iBACL,MACJ,KAAK,OACD3B,KAAK4B,KAAKR,EAAKI,MAAW,IAC1B,MACJ,KAAK,YACDxB,KAAK6B,UAAUT,EAAKI,MAAW,IAAGJ,EAAKI,MAAiB,UACxD,MACJ,KAAK,eACDxB,KAAK8B,aAAaV,EAAKI,MAAW,IAAGJ,EAAKI,MAAc,OACxD,MACJ,KAAK,mBACDxB,KAAK+B,iBAAiBX,EAAKI,MAAc,OACzC,MACJ,KAAK,4BACDxB,KAAKgC,gBAAkBZ,EAAKI,MAAW,GACvC,MACJ,KAAK,oBACDxB,KAAKE,eAAiBkB,EAAKI,MAAa,KACxC,MACJ,KAAK,sBACDJ,EAAKI,MAAW,IAAS,MAAIxB,KAAKO,gBAClC,MACJ,KAAK,sBACG0B,oBAAkBb,EAAKI,MAAa,OACpCxB,KAAKO,iBAAmBa,EAAKI,MAAa,OAG1CxB,KAAKO,iBAAiBC,GAAKY,EAAKI,MAAa,MAAEhB,EAC/CR,KAAKO,iBAAiBE,GAAKW,EAAKI,MAAa,MAAEf,EAEnD,MACJ,KAAK,oBACDW,EAAKI,MAAW,IAAQ,KAAIxB,KAAKU,gBACjC,MACJ,KAAK,QACDV,KAAKkC,UAIjBpC,EAAKe,UAAUsB,cAAgB,WAC3B,MAAO,QAEXrC,EAAKe,UAAUQ,iBAAmB,WAC9B,GAAItB,GAASC,KAAKD,MACdA,GAAOqC,cACPpC,KAAKqC,aAAetC,EAAOqC,YAAYE,WAAW,OAElDvC,EAAOwC,cACPvC,KAAKwC,aAAezC,EAAOwC,YAAYD,WAAW,QAG1DxC,EAAKe,UAAUqB,MAAQ,WACnBlC,KAAKgC,gBAAkB,KACvBhC,KAAKC,cAAgB,EACrBD,KAAKE,gBAAmBC,OAAQ,EAAGC,OAAQ,EAAGC,MAAO,EAAGC,OAAQ,GAChEN,KAAKO,kBAAqBC,EAAG,EAAGC,EAAG,GACnCT,KAAKU,kBAAmB,EACxBV,KAAKW,YAAa,GAEtBb,EAAKe,UAAUU,QAAU,SAAUkB,GAC/B,GAAI1C,GAASC,KAAKD,OACd2C,EAAaT,oBAAkBQ,GAC/BE,EAAW5C,EAAO6C,UAAUC,WAKhC,IAJA9C,EAAO+C,OAAO,QAAUxB,KAAM,iBAAkByB,kBAAkB,IAC9DL,IACA1C,KAAKC,cAAgBF,EAAOiD,UAAUC,QAEtCP,GAA0C,IAA5B3C,EAAOiD,UAAUC,OAAc,CAC7CjD,KAAKkD,eACDC,IAAUhD,OAAQJ,EAAOqD,IAAIC,SAAUjD,OAAQL,EAAOqD,IAAIE,QAASjD,MAAON,EAAOqD,IAAIG,UACrFjD,OAAQP,EAAOqD,IAAII,WACvBzD,GAAO+C,OAAO,aAAexB,KAAM,0BAA2ByB,kBAAkB,EAAOvB,OAAS2B,MAAOA,KACvGnD,KAAKyD,iBAEJ,IAAIf,GAAiD,KAAnC3C,EAAOiD,UAAUU,cAAsB,CAC1D1D,KAAKkD,eACDC,IAAUhD,OAAQJ,EAAOqD,IAAIC,SAAUjD,OAAQL,EAAOqD,IAAIE,QAASjD,MAAON,EAAOqD,IAAIG,UACrFjD,OAAQP,EAAOqD,IAAII,WACvBzD,GAAO+C,OAAO,aAAexB,KAAM,0BAA2ByB,kBAAkB,EAAOvB,OAAS2B,MAAOA,KACvGnD,KAAK2D,eAEJ,CACD5D,EAAO+C,OAAO,QAAUxB,KAAM,oBAAqByB,kBAAkB,EAAOvB,OAASoC,eAAgB7D,EAAOiD,UAAUa,aACtH,IAAIC,GAAQ9D,KAAK6B,WACjB,IAAIa,IAAeD,EAAc,CAC7BzC,KAAKkD,gBACLnD,EAAO+C,OAAO,QAAUxB,KAAM,iBAAkByB,kBAAkB,IAClEhD,EAAO+C,OAAO,SAAWxB,KAAM,uBAAwByB,kBAAkB,GACzE,IAAII,IAAUhD,OAAQJ,EAAOqD,IAAIC,SAAUjD,OAAQL,EAAOqD,IAAIE,QAASjD,MAAON,EAAOqD,IAAIG,UACrFjD,OAAQP,EAAOqD,IAAII,WACvBzD,GAAO+C,OAAO,aAAexB,KAAM,0BAA2ByB,kBAAkB,EAAOvB,OAAS2B,MAAOA,KACvGpD,EAAOgE,mBAAqBC,YAAWjE,EAAO6C,cAAe,GAC7D5C,KAAKE,gBAAmBC,OAAQJ,EAAOqD,IAAIC,SAAUjD,OAAQL,EAAOqD,IAAIE,QAASjD,MAAON,EAAOqD,IAAIG,UAC/FjD,OAAQP,EAAOqD,IAAII,YAE3B,GAAIS,IAAQ5D,MAAO,EAAGC,OAAQ,EAC9BP,GAAO+C,OAAO,aAAexB,KAAM,mBAAoByB,kBAAkB,EACrEvB,OAASnB,MAAOsC,EAAStC,MAAQyD,EAAMzD,MACnCC,OAAQqC,EAASrC,OAASwD,EAAMxD,OAAQ2D,IAAKA,IACrD,IAAIC,GAAeD,CACnBjE,MAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOwC,YAAYlC,MAAON,EAAOwC,YAAYjC,QAC/EN,KAAKqC,aAAa8B,UAAU,EAAG,EAAGpE,EAAOqC,YAAY/B,MAAON,EAAOqC,YAAY9B,QAC/EP,EAAOqD,IAAIgB,QAAWzB,EAASxC,OAAS2D,EAAMzD,MAAUN,EAAOqD,IAAIC,SAAWS,EAAMzD,MACpFN,EAAOqD,IAAIiB,OAAU1B,EAASvC,OAAS0D,EAAMxD,OAAWP,EAAOqD,IAAIE,QAAUQ,EAAMxD,OACnFP,EAAOqD,IAAIkB,SAAY3B,EAAStC,MAAQyD,EAAMzD,MAC9CN,EAAOqD,IAAImB,UAAa5B,EAASrC,OAASwD,EAAMxD,OAChDP,EAAOqD,IAAIC,UAAYtD,EAAOqC,YAAYoC,YAAcN,EAAa7D,OAAS,EAC9EN,EAAOqD,IAAIE,SAAWvD,EAAOqC,YAAYqC,aAAeP,EAAa5D,QAAU,EAC/EP,EAAOqD,IAAIG,UAAYW,EAAa7D,MACpCN,EAAOqD,IAAII,WAAaU,EAAa5D,MACrC,IAAIoE,GAAO1E,KAAKqC,aAAasC,MAC7B5E,GAAO+C,OAAO,UAAYxB,KAAM,qBAAsByB,kBAAkB,IACxE/C,KAAKqC,aAAauC,UAAU7E,EAAO8E,QAAS9E,EAAOqD,IAAIgB,QAASrE,EAAOqD,IAAIiB,OAAQtE,EAAOqD,IAAIkB,SAAUvE,EAAOqD,IAAImB,UAAWxE,EAAOqD,IAAIC,SAAUtD,EAAOqD,IAAIE,QAASvD,EAAOqD,IAAIG,UAAWxD,EAAOqD,IAAII,YACxMxD,KAAKqC,aAAasC,OAAS,MAC3B,IAAI/B,GAAYoB,YAAWjE,EAAO6C,cAAe,EACjD5C,MAAK8E,cACL/E,EAAO+C,OAAO,SAAWxB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAASuD,eAAgB,OAChG,KAAK,GAAIC,GAAI,EAAGC,EAAMlF,EAAOmF,QAAQC,OAAQH,EAAIC,EAAKD,IAC9ChF,KAAK8B,aAAa/B,EAAOmF,QAAQF,MACjCjF,EAAO+C,OAAO,SAAWxB,KAAM,QAASyB,kBAAkB,EACtDvB,OAAS4D,MAAOrF,EAAOmF,QAAQF,GAAGI,MAAOnB,IAAKlE,EAAOmF,QAAQF,GAAIK,OAAQ,QAC7EtF,EAAO+C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,IAG7EhD,GAAO6C,UAAYA,EACnB5C,KAAKsF,uBACLvF,EAAO+C,OAAO,iBAAmBxB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAASuD,eAAgB,QACxGhF,EAAO+C,OAAO,QAAUxB,KAAM,mBAAoByB,kBAAkB,EAAOvB,OAAS+D,QAASvF,KAAKqC,gBAClGtC,EAAO+C,OAAO,QAAUxB,KAAM,mBAAoByB,kBAAkB,EAAOvB,OAAS+D,QAASvF,KAAKwC,gBAC1D,gBAApCzC,EAAOgE,mBAAmBqB,MAC1BpF,KAAKyB,WAAWzB,KAAKqC,cAGrBtC,EAAOyF,cAAe,EAE1BxF,KAAKqC,aAAasC,OAASD,EAC3B3E,EAAO+C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,IACrEhD,EAAO0F,YAAYC,cAAe,EAClC3F,EAAO4F,KAAI,GACX5F,EAAOiD,UAAU4C,kBAAoB,IAG7C9F,EAAKe,UAAUqC,cAAgB,WAC3BlD,KAAKD,OAAO8F,mBACZ,IAAIC,IAAWC,WACf/F,MAAKD,OAAO+C,OAAO,UAAYxB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAASsE,OAAQA,IAChG,IAAI7B,GAAM6B,EAAgB,OAC1B9F,MAAKD,OAAOiG,QAAUhC,YAAWC,MAAS,IAE9CnE,EAAKe,UAAU4C,WAAa,WACxB,GAAI1D,GAASC,KAAKD,OACdqF,EAAQrF,EAAO6C,UAAUwC,OAAS,EACtCrF,GAAO+C,OAAO,SAAWxB,KAAM,uBAAwByB,kBAAkB,IACzEhD,EAAOgE,mBAAqBC,YAAWjE,EAAO6C,cAAe,GAC7D7C,EAAOmF,QAAQe,KAAKlG,EAAO6C,WAC3B7C,EAAO6C,UAAYoB,YAAWjE,EAAOmF,QAAQnF,EAAOmF,QAAQC,OAAS,OAAQ,EAC7E,IAAIvC,GAAYoB,YAAWjE,EAAOmF,QAAQnF,EAAOmF,QAAQC,OAAS,OAAQ,GACtEe,EAAiBlC,YAAWjE,EAAOgE,uBAAwB,GAC3DoC,GAAkBC,KAAM,KAC5BrG,GAAO+C,OAAO,aAAexB,KAAM,mBAAoByB,kBAAkB,EAAOvB,OAASyC,IAAKkC,KAC9FpG,EAAO+C,OAAO,aAAexB,KAAM,mBAAoByB,kBAAkB,EAAOvB,OAAS4E,MAAM,IAC/F,IAAIC,GAAOrC,YAAWjE,EAAOuG,mBAAoB,EACjDtG,MAAKuG,gBAAe,GACpBvG,KAAKwG,WACL,IAAIX,GAAmB7B,YAAWjE,EAAO8F,qBAAsB,EAC/D7F,MAAKyG,gBAAgB,UAAWJ,GAChCzD,EAAYoB,YAAWjE,EAAOmF,QAAQnF,EAAOmF,QAAQC,OAAS,OAAQ,GACtEnF,KAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOwC,YAAYlC,MAAON,EAAOwC,YAAYjC,QAC/EP,EAAO+C,OAAO,QAAUxB,KAAM,aAAcyB,kBAAkB,EAAOvB,OAAS6D,OAAQ,YAAapB,IAAKrB,KACxG7C,EAAOmF,QAAQwB,MACf3G,EAAOiD,UAAUC,OAAS,EAC1BjD,KAAKuB,SAAQ,GACbvB,KAAKyG,gBAAgB,UAAWJ,GAChCtG,EAAO8F,iBAAmBA,EAC1B9F,EAAOgE,mBAAqBmC,EAC5BnG,EAAO+C,OAAO,aAAexB,KAAM,mBAAoByB,kBAAkB,EAAOvB,OAAS4E,KAAMD,EAAoB,QACnHpG,EAAO+C,OAAO,QAAUxB,KAAM,mBAAoByB,kBAAkB,EAAOvB,OAAS+D,QAASvF,KAAKqC,gBAClGtC,EAAO+C,OAAO,QAAUxB,KAAM,mBAAoByB,kBAAkB,EAAOvB,OAAS+D,QAASvF,KAAKwC,gBACpF,gBAAV4C,GACApF,KAAKyB,WAAWzB,KAAKqC,cAEzBrC,KAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOwC,YAAYlC,MAAON,EAAOwC,YAAYjC,QAC/EP,EAAO+C,OAAO,QAAUxB,KAAM,iBAAkByB,kBAAkB,KAEtEjD,EAAKe,UAAU4F,gBAAkB,SAAUE,EAAMN,GAC7C,GAAItG,GAASC,KAAKD,OACdkE,GAAQ2C,UAAU,EACtB,IAAa,YAATD,EACA,IAAS3B,EAAIqB,EAAKlB,OAAS,EAAGH,GAAK,EAAGA,IAClC,OAAQqB,EAAKrB,IACT,IAAK,IACDjF,EAAO+C,OAAO,aAAexB,KAAM,SAAUE,OAASyB,QAAS,GAAIgB,IAAKA,IACxE,MACJ,MAAM,GACFlE,EAAO+C,OAAO,aAAexB,KAAM,SAAUE,OAASyB,OAAQ,GAAIgB,IAAKA,IACvE,MACJ,SACIlE,EAAO+C,OAAO,aAAexB,KAAM,YAAaE,OAASqF,UAAW9G,EAAO+G,aAAaT,EAAKrB,WAKxG,CACD,IAAK,GAAIA,GAAI,EAAGC,EAAMlF,EAAOmF,QAAQC,OAAQH,EAAIC,EAAKD,IAClDjF,EAAOmF,QAAQF,GAAG+B,UAAY,EAElC,KAAS/B,EAAI,EAAGA,EAAIjF,EAAOiH,gBAAiBhC,IACxCjF,EAAOkH,UAAUjC,GAAG+B,UAAY,EAEpC,KAAK,GAAI/B,GAAI,EAAGC,EAAMoB,EAAKlB,OAAQH,EAAIC,EAAKD,IACxC,OAAQqB,EAAKrB,IACT,IAAK,IACDjF,EAAO+C,OAAO,aAAexB,KAAM,SAAUE,OAASyB,OAAQ,GAAIgB,IAAKA,IACvE,MACJ,MAAM,GACFlE,EAAO+C,OAAO,aAAexB,KAAM,SAAUE,OAASyB,QAAS,GAAIgB,IAAKA,IACxE,MACJ,SACIlE,EAAO+C,OAAO,aAAexB,KAAM,YAAaE,OAASqF,UAAW9G,EAAO+G,aAAaT,EAAKrB,UAMjHlF,EAAKe,UAAU2F,UAAY,WACvB,GAAIzG,GAASC,KAAKD,MAClB,IAAIA,EAAOiD,UAAUa,WAAa,EAAG,CAGjC,IAAK,GAFDA,GAAa9D,EAAOiD,UAAUa,WAC9BqD,EAAanH,EAAOmH,WACflC,EAAI,EAAGA,EAAkB,GAAbnB,EAAkBmB,IACnCjF,EAAOmH,YAAa,EACpBnH,EAAO+C,OAAO,aAAexB,KAAM,aAAcyB,kBAAkB,EAC/DvB,OAASqC,YAAa,GAAKsD,UAAW,OAE9CpH,GAAOmH,WAAaA,EACpBnH,EAAO+C,OAAO,QAAUxB,KAAM,iBAAkByB,kBAAkB,MAG1EjD,EAAKe,UAAU8C,SAAW,WACtB,GAAI5D,GAASC,KAAKD,MAClBA,GAAO+C,OAAO,aAAexB,KAAM,iBAAkByB,kBAAkB,EAAOvB,OAAS4F,eAAe,KACtGrH,EAAOsH,SAASC,iBAAiB9G,GAAKR,KAAKO,iBAAiBC,EAC5DT,EAAOsH,SAASC,iBAAiB7G,GAAKT,KAAKO,iBAAiBE,CAC5D,IAAI8G,GAAoBxH,EAAOiD,UAAUU,cACrCO,GAAQuD,SAAU,KACtBzH,GAAO+C,OAAO,aAAexB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAASyC,IAAKA,IACzF,IAAIwD,GAAexD,EAAc,QACjClE,GAAO+C,OAAO,aAAexB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAASgG,eACpFzH,EAAO+C,OAAO,SAAWxB,KAAM,uBAAwByB,kBAAkB,IACzEhD,EAAOmF,QAAQe,KAAKlG,EAAO6C,WAC3B5C,KAAKwG,YACLzG,EAAOgE,mBAAqBC,YAAWjE,EAAOmF,QAAQnF,EAAOmF,QAAQC,OAAS,OAAQ,GACtFnF,KAAKqC,aAAa8B,UAAU,EAAG,EAAGpE,EAAOqC,YAAY/B,MAAON,EAAOqC,YAAY9B,QAC/EN,KAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOwC,YAAYlC,MAAON,EAAOwC,YAAYjC,OAC/E,IAAIoE,GAAO1E,KAAKqC,aAAasC,MAC7B5E,GAAO+C,OAAO,UAAYxB,KAAM,qBAAsByB,kBAAkB,IACxE/C,KAAKqC,aAAauC,UAAU7E,EAAO8E,QAAS9E,EAAOqD,IAAIgB,QAASrE,EAAOqD,IAAIiB,OAAQtE,EAAOqD,IAAIkB,SAAUvE,EAAOqD,IAAImB,UAAWxE,EAAOqD,IAAIC,SAAUtD,EAAOqD,IAAIE,QAASvD,EAAOqD,IAAIG,UAAWxD,EAAOqD,IAAII,WACxM,KAAK,GAAIwB,GAAI,EAAGC,EAAMlF,EAAOmF,QAAQC,OAAQH,EAAIC,EAAKD,IAClDjF,EAAOmF,QAAQF,GAAG+B,UAAY,EAElC,KAAS/B,EAAI,EAAGA,EAAIjF,EAAOiH,gBAAiBhC,IACxCjF,EAAOkH,UAAUjC,GAAG+B,UAAY,EAEpChH,GAAO+C,OAAO,SAAWxB,KAAM,YAAayB,kBAAkB,EAAOvB,OAASyB,OAAQjD,KAAK+B,sBAC3FhC,EAAO+C,OAAO,iBAAmBxB,KAAM,cAAeyB,kBAAkB,EACpEvB,OAASA,MAAOxB,KAAK+B,sBACzBhC,EAAO6C,UAAYoB,YAAWjE,EAAOmF,QAAQnF,EAAOmF,QAAQC,OAAS,OAAQ,GAC7EpF,EAAOmF,QAAQwB,MACf1G,KAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOwC,YAAYlC,MAAON,EAAOwC,YAAYjC,QAC/EP,EAAO+C,OAAO,QAAUxB,KAAM,aAAcyB,kBAAkB,EAAOvB,OAAS6D,OAAQ,eACtFrF,KAAKuB,SAAQ,GACbxB,EAAO+C,OAAO,aAAexB,KAAM,mBAAoByB,kBAAkB,EAAOvB,OAAS4E,MAAM,KAC/FpG,KAAKqC,aAAaqF,aAAa,EAAG,EAAG,EAAG,EAAG,EAAG,GAC9C3H,EAAO+C,OAAO,QAAUxB,KAAM,gBAAiByB,kBAAkB,IACjEhD,EAAO+C,OAAO,QAAUxB,KAAM,iBAAkByB,kBAAkB,EAC9DvB,OAASmF,KAAM,UAAWgB,qBAAsB,KAAMpC,QAAS,KAAMqC,oBAAqB,QAC9F7H,EAAO+C,OAAO,UAAYxB,KAAM,qBAAsByB,kBAAkB,IACxE/C,KAAKqC,aAAauC,UAAU7E,EAAO8E,QAAS9E,EAAOqD,IAAIgB,QAASrE,EAAOqD,IAAIiB,OAAQtE,EAAOqD,IAAIkB,SAAUvE,EAAOqD,IAAImB,UAAWxE,EAAOqD,IAAIC,SAAUtD,EAAOqD,IAAIE,QAASvD,EAAOqD,IAAIG,UAAWxD,EAAOqD,IAAII,YACxMxD,KAAKqC,aAAasC,OAASD,EAC3B3E,EAAO+C,OAAO,QAAUxB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAASqG,cAAc,KAC/F9H,EAAO+C,OAAO,QAAUxB,KAAM,iBAAkByB,kBAAkB,EAC9DvB,OAASmF,KAAM,UAAWgB,qBAAsB,KAAMpC,QAAS,KAAMqC,oBAAqB,QAC9F7H,EAAOiD,UAAUU,cAAgB6D,EACjCxH,EAAO+C,OAAO,aAAexB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAASgG,SAAUC,KAC9FzH,KAAKqC,aAAasC,OAAS,MAC3B,KAAK,GAAIK,GAAI,EAAGC,EAAMlF,EAAOmF,QAAQC,OAAQH,EAAIC,EAAKD,IAClDjF,EAAOmF,QAAQF,GAAG+B,UAAY,EAElC,KAAS/B,EAAI,EAAGA,EAAIjF,EAAOiH,gBAAiBhC,IACxCjF,EAAOkH,UAAUjC,GAAG+B,UAAY,EAEpChH,GAAO+C,OAAO,SAAWxB,KAAM,YAAayB,kBAAkB,EAAOvB,OAASyB,OAAQjD,KAAK+B,sBAC3FhC,EAAO+C,OAAO,iBAAmBxB,KAAM,cAAeyB,kBAAkB,EACpEvB,OAASA,MAAOxB,KAAK+B,sBACzBhC,EAAO+C,OAAO,SAAWxB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAASuD,eAAgB,QAChGhF,EAAO+C,OAAO,iBAAmBxB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAASuD,eAAgB,QACxG/E,KAAKqC,aAAasC,OAASD,GACtB3E,EAAOgE,oBAA0D,gBAApChE,EAAOgE,mBAAmBqB,OAA4BrF,EAAOyF,eAC3FxF,KAAKyB,WAAWzB,KAAKqC,cAEzBtC,EAAO+C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,IACrEhD,EAAO+C,OAAO,QAAUxB,KAAM,mBAAoByB,kBAAkB,EAAOvB,OAAS+D,QAASvF,KAAKqC,gBAClGtC,EAAO+C,OAAO,QAAUxB,KAAM,mBAAoByB,kBAAkB,EAAOvB,OAAS+D,QAASvF,KAAKwC,gBAClGxC,KAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOwC,YAAYlC,MAAON,EAAOwC,YAAYjC,QAC/EP,EAAO+C,OAAO,aAAexB,KAAM,iBAAkByB,kBAAkB,EAAOvB,OAAS4F,eAAe,KACtGrH,EAAO+C,OAAO,QAAUxB,KAAM,iBAAkByB,kBAAkB,IAClE/C,KAAKO,kBAAqBC,EAAG,EAAGC,EAAG,IAEvCX,EAAKe,UAAUiE,YAAc,WACzB,GACI3B,GACAN,EACAuC,EAHArF,EAASC,KAAKD,MAIlB,IAAIA,EAAOmF,QAAQC,OAAS,EACxB,IAAK,GAAIH,GAAI,EAAGC,EAAMlF,EAAOmF,QAAQC,OAAQH,EAAIC,EAAKD,IAAK,CACvD7B,EAAQpD,EAAOmF,QAAQF,GAAGnC,YAC1BA,EAAc9C,EAAO6C,UAAUC,YAC/BuC,EAAQrF,EAAOmF,QAAQF,GAAGI,MAC1BrF,EAAOmF,QAAQF,GAAG8C,YAAe3H,QAAUgD,EAAMhD,OAAS0C,EAAY1C,QAAU0C,EAAYxC,MACxFD,QAAU+C,EAAM/C,OAASyC,EAAYzC,QAAUyC,EAAYvC,OAC3DyH,MAAQ5E,EAAM4E,KAAOlF,EAAY1C,QAAU0C,EAAYxC,MACvD2H,MAAQ7E,EAAM6E,KAAOnF,EAAYzC,QAAUyC,EAAYvC,OACvDD,MAAOwC,EAAYxC,MAAQ8C,EAAM9C,MACjCC,OAAQuC,EAAYvC,OAAS6C,EAAM7C,OACvC,IAAI2C,OAAS,GACTgF,MAAO,EACX,QAAQ7C,GACJ,IAAK,OAOD6C,EAAmB,KALfhF,EADkC,IAAlClD,EAAOmF,QAAQF,GAAGkD,YACTlI,KAAKD,OAAOiD,UAAUC,OAGtBjD,KAAKD,OAAOiD,UAAUC,OAASlD,EAAOmF,QAAQF,GAAGkD,cAEjB,MAArBC,KAAKC,IAAInF,GAAmBE,EAAM9C,MAAQ8C,EAAM7C,OACxEP,EAAOmF,QAAQF,GAAGqD,aAAaC,UAAYL,EAAOlI,EAAOmF,QAAQF,GAAGqD,aAAaE,QACjF,MACJ,KAAK,OACL,IAAK,QACDvI,KAAKwI,oBAAoBxD,GACX,UAAVI,GACArF,EAAO+C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,EAAOvB,OAASyC,IAAKlE,EAAOmF,QAAQF,KAE7G,MACJ,KAAK,OACDhF,KAAKwI,oBAAoBxD,MAM7ClF,EAAKe,UAAU2H,oBAAsB,SAAUxD,GAC3C,GAEIxE,GACAC,EACAJ,EACAC,EALAP,EAASC,KAAKD,OACdqF,EAAQrF,EAAOmF,QAAQF,GAAGI,MAK1BjC,EAAQpD,EAAO6C,UAAUC,WACf,UAAVuC,GACA5E,EAAI2C,EAAMhD,OACVM,EAAI0C,EAAM/C,OACVC,EAAQ8C,EAAM9C,MACdC,EAAS6C,EAAM7C,SAGfE,EAAIT,EAAOqD,IAAIC,SACf5C,EAAIV,EAAOqD,IAAIE,QACfjD,EAAQN,EAAOqD,IAAIG,UACnBjD,EAASP,EAAOqD,IAAII,WAGxB,KAAK,GADDiF,GAAW1I,EAAOmF,QAAQF,GACrB0D,EAAI,EAAGzD,EAAMwD,EAASxB,UAAU9B,OAAQuD,EAAIzD,EAAKyD,IACtDD,EAASxB,UAAUyB,GAAGC,QACjBF,EAASxB,UAAUyB,GAAGlI,EAAIA,GAAKH,EACpCoI,EAASxB,UAAUyB,GAAGE,QACjBH,EAASxB,UAAUyB,GAAGjI,EAAIA,GAAKH,GAG5CR,EAAKe,UAAUyE,qBAAuB,WAGlC,IAAK,GAFDvF,GAASC,KAAKD,OAET2I,EAAI,EAAGA,EAAI3I,EAAOiH,gBAAiB0B,IAAK,CAC7C3I,EAAO8I,OAAS7E,YAAWjE,EAAOkH,UAAUyB,GAAGG,WAC/C9I,EAAO+C,OAAO,iBAAmBxB,KAAM,kBAAmByB,kBAAkB,EAAOvB,OAASA,MAAO,IAEnG,KAAK,GADDyD,GAAMlF,EAAO8I,OAAO1D,OACf2D,EAAI,EAAGA,EAAI7D,EAAK6D,IACrB/I,EAAO8I,OAAOC,GAAGH,QAAU5I,EAAO8I,OAAOC,GAAGtI,EACxCT,EAAO6C,UAAUC,YAAY1C,QAAUJ,EAAO6C,UAAUC,YAAYxC,MACxEN,EAAO8I,OAAOC,GAAGF,QAAU7I,EAAO8I,OAAOC,GAAGrI,EACxCV,EAAO6C,UAAUC,YAAYzC,QAAUL,EAAO6C,UAAUC,YAAYvC,OAGhFP,EAAO+C,OAAO,iBAAmBxB,KAAM,sBAAuByB,kBAAkB,KAEpFjD,EAAKe,UAAUa,iBAAmB,SAAUqH,GACxC,GAAIhJ,GAASC,KAAKD,OACdiJ,EAAYhJ,KAAKE,eACjByE,EAAS3E,KAAKqC,aAAasC,MAC/B5E,GAAOqD,IAAIgB,QAAU,EACrBrE,EAAOqD,IAAIiB,OAAS,EACpBtE,EAAOqD,IAAIkB,SAAWvE,EAAO8E,QAAQxE,MACrCN,EAAOqD,IAAImB,UAAYxE,EAAO8E,QAAQvE,OACtCP,EAAOqD,IAAIC,SAAW2F,EAAU7I,OAChCJ,EAAOqD,IAAIE,QAAU0F,EAAU5I,OAC/BL,EAAOqD,IAAIG,UAAYyF,EAAU3I,MACjCN,EAAOqD,IAAII,WAAawF,EAAU1I,OAClCN,KAAKqC,aAAa8B,UAAU,EAAG,EAAGpE,EAAOqC,YAAY/B,MAAON,EAAOqC,YAAY9B,QAC3EyI,GACAhJ,EAAO+C,OAAO,QAAUxB,KAAM,gBAAiByB,kBAAkB,IAErEhD,EAAO+C,OAAO,QAAUxB,KAAM,iBAAkByB,kBAAkB,EAC9DvB,OAASmF,KAAM,UAAWgB,qBAAsB,KAAMpC,QAAS,KAAMqC,oBAAqB,QACnE,IAAvB5H,KAAKC,eAAmD,IAA5BF,EAAOiD,UAAUC,QAAgBlD,EAAOgE,oBAC7B,gBAApChE,EAAOgE,mBAAmBqB,OAA+D,gBAApCrF,EAAOgE,mBAAmBqB,QAClFrF,EAAOqD,IAAIC,SAAW2F,EAAU7I,OAChCJ,EAAOqD,IAAIE,QAAU0F,EAAU5I,OAC/BL,EAAOqD,IAAIG,UAAYyF,EAAU3I,MACjCN,EAAOqD,IAAII,WAAawF,EAAU1I,QAEN,IAA5BP,EAAOiD,UAAUC,SACjBlD,EAAOqD,IAAIC,UAAYtD,EAAOsH,SAAS4B,yBAAyBzI,EAChET,EAAOqD,IAAIE,SAAWvD,EAAOsH,SAAS4B,yBAAyBxI,GAEnEV,EAAO+C,OAAO,UAAYxB,KAAM,qBAAsByB,kBAAkB,IACxE/C,KAAKqC,aAAauC,UAAU7E,EAAO8E,QAAS9E,EAAOqD,IAAIgB,QAASrE,EAAOqD,IAAIiB,OAAQtE,EAAOqD,IAAIkB,SAAUvE,EAAOqD,IAAImB,UAAWxE,EAAOqD,IAAIC,SAAUtD,EAAOqD,IAAIE,QAASvD,EAAOqD,IAAIG,UAAWxD,EAAOqD,IAAII,YACxMxD,KAAKqC,aAAasC,OAASA,EAC3B5E,EAAO+C,OAAO,QAAUxB,KAAM,iBAAkByB,kBAAkB,EAC9DvB,OAASmF,KAAM,UAAWgB,qBAAsB,KAAMpC,QAAS,KAAMqC,qBAAqB,IAC9F,IAAI9C,GAAcd,YAAWjE,EAAOmF,QAAS,MAAM,GAC/CgE,EAAgBlF,YAAWjE,EAAOkH,UAAW,MAAM,EAQvD,IAPAlH,EAAOmF,WACPnF,EAAOkH,aACPlH,EAAOiH,gBAAkB,EACzBhH,KAAKuG,iBACLxG,EAAOmF,QAAUJ,EACjB/E,EAAOkH,UAAYiC,EACnBnJ,EAAOiH,gBAAkBjH,EAAOkH,UAAU9B,OACtCpF,EAAOiG,QAAQpD,UAAUwC,MAAO,CAChC,GAAI+D,IAAehJ,OAAQJ,EAAOqD,IAAIC,SAAUjD,OAAQL,EAAOqD,IAAIE,QAASjD,MAAON,EAAOqD,IAAIG,UAC1FjD,OAAQP,EAAOqD,IAAII,WACnBzD,GAAOgE,oBAAsBhE,EAAOgE,mBAAmBlB,cACvD9C,EAAOqD,IAAIC,SAAWtD,EAAOgE,mBAAmBlB,YAAY1C,OAC5DJ,EAAOqD,IAAIE,QAAUvD,EAAOgE,mBAAmBlB,YAAYzC,OAC3DL,EAAOqD,IAAIG,UAAYxD,EAAOgE,mBAAmBlB,YAAYxC,MAC7DN,EAAOqD,IAAII,WAAazD,EAAOgE,mBAAmBlB,YAAYvC,QAElEP,EAAO+C,OAAO,SAAWxB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAASuD,eAAgB,QAChGhF,EAAO+C,OAAO,iBAAmBxB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAASuD,eAAgB,QACxGhF,EAAOqD,IAAIC,SAAW8F,EAAWhJ,OACjCJ,EAAOqD,IAAIE,QAAU6F,EAAW/I,OAChCL,EAAOqD,IAAIG,UAAY4F,EAAW9I,MAClCN,EAAOqD,IAAII,WAAa2F,EAAW7I,OACnCP,EAAO+C,OAAO,iBAAmBxB,KAAM,gBAAiByB,kBAAkB,IAC1E+B,EAAcd,YAAWjE,EAAOmF,QAAS,MAAM,GAC/CgE,EAAgBlF,YAAWjE,EAAOkH,UAAW,MAAM,GACnDlH,EAAOmF,WACPnF,EAAOkH,aACPlH,EAAOiH,gBAAkB,CACzB,IAAIlB,IAAWsD,aAAc,KAC7BrJ,GAAO+C,OAAO,iBAAmBxB,KAAM,kBAAmByB,kBAAkB,EACxEvB,OAASyC,IAAK6B,IAClB,IAAIuD,GAAmBvD,EAAqB,YAC5C/F,GAAO+C,OAAO,iBAAmBxB,KAAM,kBAAmByB,kBAAkB,EACxEvB,OAASyC,KAAOmF,oBACpBrJ,EAAOiG,QAAQrB,OAAS3E,KAAKqC,aAAasC,MAC1C,IAAI2E,GAAStF,YAAWjE,EAAOgE,mBAAoB,MAAM,EACzDhE,GAAO+C,OAAO,QAAUxB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAASyC,IAAK,QACtFlE,EAAO6C,UAAYoB,YAAWsF,EAAQ,MAAM,EAC5C,IAAI1G,GAAYoB,YAAWjE,EAAO6C,UAAW,MAAM,EACnD7C,GAAO+C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,IACrE/C,KAAKuG,iBACLxG,EAAOmF,QAAUJ,EACjB/E,EAAOkH,UAAYiC,EACnBnJ,EAAOiH,gBAAkBjH,EAAOkH,UAAU9B,OAC1CpF,EAAO+C,OAAO,iBAAmBxB,KAAM,kBAAmByB,kBAAkB,EACxEvB,OAASyC,KAAOmF,aAAcC,MAClCtJ,EAAO+C,OAAO,SAAWxB,KAAM,iBAAkByB,kBAAkB,IACnEhD,EAAO+C,OAAO,iBAAmBxB,KAAM,iBAAkByB,kBAAkB,EACvEvB,OAAS+D,QAASvF,KAAKqC,aAAcwG,OAAQ,QACjD9I,EAAO+C,OAAO,iBAAmBxB,KAAM,gBAAiByB,kBAAkB,IAC1EhD,EAAO+C,OAAO,SAAWxB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAASuD,eAAgB,QAChGhF,EAAO+C,OAAO,iBAAmBxB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAASuD,eAAgB,QACxGhF,EAAOgE,mBAAqB,KACI,IAA5BhE,EAAOiD,UAAUC,QACjBlD,EAAO+C,OAAO,aAAexB,KAAM,gBAAiByB,kBAAkB,EAClEvB,OAAS2B,OAAS3C,EAAG,EAAGC,EAAG,MAEnCV,EAAO6C,UAAYA,EACnB7C,EAAO+C,OAAO,QAAUxB,KAAM,aAAcyB,kBAAkB,EAAOvB,OAAS6D,OAAQ,eACtFtF,EAAO+C,OAAO,aAAexB,KAAM,iBAAkByB,kBAAkB,EACnEvB,OAAS2B,MAAO,QACfnD,KAAKW,YAA0C,IAA5BZ,EAAOiD,UAAUC,QAAiD,KAAjClD,EAAOiG,QAAQtC,eACxC,IAA5B3D,EAAOiG,QAAQuD,SAOfvJ,KAAKW,YAAa,GANlBX,KAAKW,YAAa,EAClBZ,EAAO+C,OAAO,QAAUxB,KAAM,gBAAiBE,OAASgI,oBAAqB,QAC7EzJ,EAAO+C,OAAO,WAAaxB,KAAM,kBAAmByB,kBAAkB,EAAOvB,OAASmF,KAAM,gBACpF8C,YAAY,EAAOC,WAAY,KAAMC,UAAW,KAAMC,MAAO,aAMxE,CACD,GAAIlF,GAAO1E,KAAKqC,aAAasC,MAC7B3E,MAAKqC,aAAasC,OAAS,OAC3B5E,EAAO+C,OAAO,SAAWxB,KAAM,iBAAkByB,kBAAkB,IACnEhD,EAAO+C,OAAO,iBAAmBxB,KAAM,iBAAkByB,kBAAkB,EACvEvB,OAAS+D,QAASvF,KAAKqC,aAAcwG,OAAQ,QACjD7I,KAAKqC,aAAasC,OAASD,EAC3B3E,EAAOgE,mBAAqB,OAGpCjE,EAAKe,UAAU0F,eAAiB,SAAUsD,GACtC,GAAI9J,GAASC,KAAKD,OACdkE,EAAMD,YAAWjE,EAAOgE,mBAAoB,MAAM,EACtDhE,GAAOgE,mBAAqB,IAC5B,IAAI+F,GAAmC,IAA5B/J,EAAOiD,UAAUC,OACxB4G,GAAa9J,EAAOiG,QAAQ+D,uBAAuBvJ,EAAIT,EAAOiG,QAAQ+D,uBAAuBvJ,EAAI,EACjGwJ,EAAmC,IAA5BjK,EAAOiD,UAAUC,OACxB4G,GAAa9J,EAAOiG,QAAQ+D,uBAAuBtJ,EAAIV,EAAOiG,QAAQ+D,uBAAuBtJ,EAAI,CACrE,KAA5BV,EAAOiD,UAAUC,SACjBlD,EAAOsH,SAAS4C,oBAAuBzJ,EAAGsJ,EAAMrJ,EAAGuJ,GACnDjK,EAAO+C,OAAO,aAAexB,KAAM,kBAAmBE,OAAS0I,MAAOJ,EAAMK,MAAOH,KACnFjK,EAAOsH,SAAS4C,oBAAuBzJ,EAAG,EAAGC,EAAG,IAEpDV,EAAOgE,mBAAqBE,GAEhCnE,EAAKe,UAAUY,WAAa,SAAU8D,EAAS6E,EAAQC,GACnD,GAAItK,GAASC,KAAKD,MACdsK,IAA6C,KAAnCtK,EAAOiD,UAAUU,eAC3B3D,EAAO+C,OAAO,QAAUxB,KAAM,eAAgByB,kBAAkB,EAC5DvB,OAAS+D,QAASA,EAAS/D,MAAOzB,EAAOiD,UAAUU,cAAemG,UAAW,QAErFtE,EAAQ+E,yBAA2B,iBACnC/E,EAAQgF,WACR,IAAIC,GAAUvI,oBAAkBmI,GAAUrK,EAAOqD,IAAIC,SAAYtD,EAAOqD,IAAIG,UAAY,EAAKgC,EAAQF,OAAOhF,MAAQ,EAChHoK,EAAUxI,oBAAkBmI,GAAUrK,EAAOqD,IAAIE,QAAWvD,EAAOqD,IAAII,WAAa,EAAK+B,EAAQF,OAAO/E,OAAS,EACjHoK,EAASN,EAAS7E,EAAQF,OAAOhF,MAAQ,EAAIN,EAAOqD,IAAIG,UAAY,CACxEgC,GAAQoF,IAAIH,EAASC,EAASC,EAAQ,EAAa,EAAVvC,KAAKyC,IAC9CrF,EAAQsF,YACRtF,EAAQuF,OACRvF,EAAQwF,UACRxF,EAAQ+E,yBAA2B,cACnCvK,EAAO0F,YAAYuF,YAAcjL,EAAOyF,cAAe,EACnD6E,GAA6C,KAAnCtK,EAAOiD,UAAUU,eAC3B3D,EAAO+C,OAAO,QAAUxB,KAAM,eAAgByB,kBAAkB,EAC5DvB,OAAS+D,QAASA,EAAS/D,MAAOzB,EAAOiD,UAAUU,cAAemG,UAAW,SAGzF/J,EAAKe,UAAUoK,iBAAmB,SAAUtE,EAAMuE,GAC9C,GAAInL,GAASC,KAAKD,OACdoL,EAAY,GACZC,KACAnH,GAAQuD,SAAU,KAEtB,IADAzH,EAAO+C,OAAO,aAAexB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAASyC,IAAKA,KAC5E,YAAT0C,EACA,GAA0C,MAAtCwB,KAAKC,IAAIrI,EAAOiD,UAAUC,QAC1BkI,EAAYlH,EAAc,SAAEkB,OAAS,EAAInF,KAAK+B,mBAAqBhC,EAAOiD,UAAUU,kBAEnF,CACD,IAAK,GAAIsB,GAAI,EAAGC,EAAMlF,EAAOuG,eAAenB,OAAQH,EAAIC,EAAKD,IACf,gBAA9BjF,GAAOuG,eAAetB,GAC9BoG,EAAMnF,KAAK,UAEgC,gBAA9BlG,GAAOuG,eAAetB,IACnCoG,EAAMnF,KAAK,SAGfmF,GAAMjG,OAAS,GAAiC,WAA5BiG,EAAMA,EAAMjG,OAAS,IAA+C,WAA5BiG,EAAMA,EAAMjG,OAAS,GAC1C,eAAnCpF,EAAOiD,UAAUU,cACjByH,EAAY,WAE4B,aAAnCpL,EAAOiD,UAAUU,gBACtByH,EAAY,cAGXC,EAAMjG,OAAS,GAAiC,WAA5BiG,EAAMA,EAAMjG,OAAS,IAA+C,WAA5BiG,EAAMA,EAAMjG,OAAS,KACtFgG,EAAYlH,EAAc,SAAEkB,OAAS,EAAInF,KAAK+B,mBAAqBhC,EAAOiD,UAAUU,mBAK5FyH,GAAYnL,KAAK+B,oBACbmJ,GAAkBlL,KAAKqL,oBACU,KAA7BtL,EAAOiD,UAAUC,SAA+C,MAA7BlD,EAAOiD,UAAUC,SAClC,eAAdkI,EACAA,EAAY,WAEO,aAAdA,IACLA,EAAY,cAQ5B,OAHkB,KAAdA,IACAA,EAAYlH,EAAc,SAAEkB,OAAS,EAAInF,KAAK+B,mBAAqBhC,EAAOiD,UAAUU,eAEjFyH,GAEXrL,EAAKe,UAAUwK,gBAAkB,WAC7B,GAAIzE,IAAW,CAIf,OAHI5G,MAAKD,OAAOuG,eAAenB,OAAS,GAAgD,gBAAnCnF,MAAKD,OAAOuG,eAAe,KAC5EM,GAAW,GAERA,GAEX9G,EAAKe,UAAUc,gBAAkB,WAC7B,GAAI5B,GAASC,KAAKD,MAClB,KAAIkC,oBAAkBlC,EAAOsH,SAAS4C,oBAAtC,CAGA,GAAIqB,GAAY,EAGZA,GAFAvL,EAAOuG,eAAenB,OAAS,GAA2C,gBAA9BpF,GAAOuG,eAAe,IAC/DvG,EAAOiD,UAAUC,OAAS,EACjBjD,KAAKiL,iBAAiB,WAAW,GAGjCjL,KAAK+B,mBAEjBhC,EAAOiD,UAAUC,OAAS,IAAO,GAAKlD,EAAOiD,UAAUC,OAAS,KAAQ,EACxC,KAA5BlD,EAAOiD,UAAUC,SAA+C,KAA7BlD,EAAOiD,UAAUC,SACrC,eAAdqI,GAA4C,aAAdA,KACE,MAA7BvL,EAAOiD,UAAUC,SAAkC,KAAdqI,GAAkC,uBAAdA,GACxC,uBAAdA,IACW,eAAdA,GAA4C,KAAdA,EAC9BvL,EAAOqD,IAAIC,UAAYtD,EAAOsH,SAAS4C,mBAAmBxJ,EAG1DV,EAAOqD,IAAIC,UAAYtD,EAAOsH,SAAS4C,mBAAmBxJ,EAE5C,KAAd6K,GAAkC,aAAdA,EACpBvL,EAAOqD,IAAIE,SAAWvD,EAAOsH,SAAS4C,mBAAmBzJ,EAGzDT,EAAOqD,IAAIE,SAAWvD,EAAOsH,SAAS4C,mBAAmBzJ,GAG5B,MAA5BT,EAAOiD,UAAUC,UAAgD,MAA7BlD,EAAOiD,UAAUC,QAC3C,eAAdqI,GAA4C,aAAdA,MACE,KAA7BvL,EAAOiD,UAAUC,QAAiC,KAAdqI,GAAkC,uBAAdA,GACvC,uBAAdA,KACW,KAAdA,GAAkC,eAAdA,EACpBvL,EAAOqD,IAAIC,UAAYtD,EAAOsH,SAAS4C,mBAAmBxJ,EAG1DV,EAAOqD,IAAIC,UAAYtD,EAAOsH,SAAS4C,mBAAmBxJ,EAE5C,KAAd6K,GAAkC,aAAdA,EACpBvL,EAAOqD,IAAIE,SAAWvD,EAAOsH,SAAS4C,mBAAmBzJ,EAGzDT,EAAOqD,IAAIE,SAAWvD,EAAOsH,SAAS4C,mBAAmBzJ,GAKjC,MAA5BT,EAAOiD,UAAUC,SAA+C,MAA7BlD,EAAOiD,UAAUC,SAClC,KAAdqI,GAAkC,aAAdA,EACpBvL,EAAOqD,IAAIC,UAAYtD,EAAOsH,SAAS4C,mBAAmBzJ,EAG1DT,EAAOqD,IAAIC,UAAYtD,EAAOsH,SAAS4C,mBAAmBzJ,EAE5C,KAAd8K,GAAkC,eAAdA,EACpBvL,EAAOqD,IAAIE,SAAWvD,EAAOsH,SAAS4C,mBAAmBxJ,EAGzDV,EAAOqD,IAAIE,SAAWvD,EAAOsH,SAAS4C,mBAAmBxJ,KAKzEX,EAAKe,UAAUe,KAAO,SAAUqC,GAC5B,GAAIsH,GAAQvL,KACRD,EAASC,KAAKD,MAClB,KAAKA,EAAOyL,UAAYzL,EAAO0L,cAAe,CAC1C,GAAIC,IAAaC,cAAe5L,EAAO4L,cACnC5L,GAAO0F,YAAYmG,eAAiBF,EAAwB,eAC5D3L,EAAO+C,OAAO,aAAexB,KAAM,aAAcE,OAAS4E,KAAM,OAEpE,IAAIyF,IAAmBC,QAAQ,EAAOC,YAAcvL,EAAGT,EAAO6C,UAAUC,YAAY1C,OAC5EM,EAAGV,EAAO6C,UAAUC,YAAYzC,QAAU4L,UAAYxL,EAAGT,EAAO6C,UAAUC,YAAYkF,KACtFtH,EAAGV,EAAO6C,UAAUC,YAAYmF,MAAQiE,gBAAgB,IAC3DP,EAAwB,eAAKQ,cAAcnM,EAAOoM,SAAiD,IAAvCpM,EAAOoM,OAAOjL,SAASkL,YAEpFrM,EAAOsM,UAAUC,kBAAkB,iBAAkB,SAAUT,GAAgBU,KAAK,SAAUnL,GAC1FmK,EAAMiB,UAAUpL,EAAM6C,EAAKyH,MAI1BA,EAAwB,eACzB3L,EAAO0M,QAAQ,WAAYZ,GAE/B7L,KAAKwM,UAAUX,EAAgB5H,EAAKyH,MAIhD5L,EAAKe,UAAU2L,UAAY,SAAUX,EAAgB5H,EAAK6B,GACtD,GACI4G,GADA3M,EAASC,KAAKD,MAElB,KAAK8L,EAAeC,SAChBY,EAAa3M,EAAO6C,UAAUwC,MAAQrF,EAAO6C,UAAUwC,MAAMuH,MAAM,SAC9D5M,EAAOyL,UAAYzL,EAAO6C,UAAUgK,aAAe7M,EAAO0F,YAAYC,cAAiBgH,EAAWvH,OAAS,GAC1F,SAAlBuH,EAAW,KAAiB,CAE5BzI,EAAI4I,QAAS,CACb,IAAIC,GAAc9I,YAAWjE,EAAOiG,YAAa,GAC7C+G,EAAU/I,YAAWhE,KAAKgC,oBAAqB,EAC/C6J,GAAeI,eACfjM,KAAKU,kBAAmB,EAGxBV,KAAKU,kBAAmB,EAE5BV,KAAKuB,UACLxB,EAAOiD,UAAUa,WAAa,EAC9B9D,EAAOiN,eAAgBC,cAAgBpJ,WAAY,KAAO,GAC1D9D,EAAO+C,OAAO,aAAexB,KAAM,uBAAwByB,kBAAkB,EACzEvB,OAAS0L,kBAAmBnN,EAAOkN,aAAapJ,aACpD,IAAIsJ,IAAiBC,uBAAwBpN,KAAKD,OAAOqN,uBACzDL,GAAQhJ,mBAAqBC,YAAWmJ,EAAqC,2BAAO,GACpFpN,EAAO+C,OAAO,aAAexB,KAAM,qBAAsByB,kBAAkB,EACvEvB,OAAS6L,UAAW,OAAQC,YAAaP,EAASQ,gBAAiBR,EAAQ7H,QACvEsI,kBAAmBT,EAAQ9F,UAAWwG,qBAAsBV,EAAQ3D,aACpEsE,gBAAiBZ,EAAaa,aAAc,KAC5CC,YAAa,KAAMC,eAAgB,KAAMrI,aAAczF,EAAOyF,gBACjEM,EAAsB,eACvB/F,EAAO+C,OAAO,aAAexB,KAAM,gBAAiBE,OAASmF,KAAM,QAEvE5G,EAAO+C,OAAO,aAAexB,KAAM,mBAAoByB,kBAAkB,EACrEvB,OAASnB,MAAON,EAAOiG,QAAQmD,WAAW9I,MAAOC,OAAQP,EAAOiG,QAAQmD,WAAW7I,UAClF4L,cAAepG,EAAsB,cAIhCA,EAAsB,eAC5B9F,KAAKD,OAAO+N,cAAc9N,KAAKD,OAAOgO,QAAS,eAJ/ChO,EAAO+C,OAAO,WAAaxB,KAAM,kBAAmByB,kBAAkB,EAAOvB,OAASmF,KAAM,OACpF8C,YAAY,EAAOC,YAAY,EAAOC,UAAW,KAAMC,MAAO,UAQtF9J,EAAKe,UAAUgB,UAAY,SAAUoC,EAAK+J,GACtC,GACIC,GACAC,EAFAnO,EAASC,KAAKD,MAelB,OAZgC,KAA5BA,EAAOiD,UAAUC,QAAgBlD,EAAOiD,UAAUC,OAAS,KAAQ,GACnEgL,GAAcD,EAAYA,EAAU3N,MAAQN,EAAO8E,QAAQxE,OAASN,EAAOqD,IAAIG,UAC/E2K,GAAeF,EAAYA,EAAU1N,OAASP,EAAO8E,QAAQvE,QAAUP,EAAOqD,IAAII,aAGlFyK,GAAcD,EAAYA,EAAU1N,OAASP,EAAO8E,QAAQvE,QAAUP,EAAOqD,IAAIG,UACjF2K,GAAeF,EAAYA,EAAU3N,MAAQN,EAAO8E,QAAQxE,OAASN,EAAOqD,IAAII,YAEhFS,IACAA,EAAW,MAAIgK,EACfhK,EAAY,OAAIiK,IAEX7N,MAAO4N,EAAY3N,OAAQ4N,IAExCpO,EAAKe,UAAUiB,aAAe,SAAUmC,EAAKkK,GACzC,GAAIpO,GAASC,KAAKD,OACdqO,GAAW,EACXjO,EAAS8D,EAAIpB,YAAY1C,OACzB4H,EAAO9D,EAAIpB,YAAYkF,KACvB3H,EAAS6D,EAAIpB,YAAYzC,OACzB4H,EAAO/D,EAAIpB,YAAYmF,IAY3B,QAXK7H,GAAUJ,EAAOqD,IAAIC,UAAY0E,GAAShI,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,WAC3EpD,GAAUJ,EAAOqD,IAAIC,UAAY0E,GAAQhI,EAAOqD,IAAIC,UACpDlD,GAAWJ,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,WAAcwE,GAAShI,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,WACpGnD,GAAUL,EAAOqD,IAAIE,SAAW0E,GAASjI,EAAOqD,IAAIE,QAAUvD,EAAOqD,IAAII,YACzEpD,GAAUL,EAAOqD,IAAIE,SAAW0E,GAAQjI,EAAOqD,IAAIE,SACnDlD,GAAWL,EAAOqD,IAAIE,QAAUvD,EAAOqD,IAAII,YAAewE,GAASjI,EAAOqD,IAAIE,QAAUvD,EAAOqD,IAAII,cACpG4K,GAAW,GAEXD,IACAA,EAAmB,SAAIC,GAEpBA,GAEXtO,EAAKe,UAAUkB,iBAAmB,SAAUsM,GACxC,GAAItO,GAASC,KAAKD,OACdkE,GAAQqH,UAAW,IACnBxF,GAAWwI,WAAYvO,EAAOuG,eAClCvG,GAAO+C,OAAO,SAAWxB,KAAM,sBAAuByB,kBAAkB,EACpEvB,OAAS8M,WAAYvO,EAAOuG,eAAgBiI,wBAAwB,EAAMtK,IAAK6B,KACnF/F,EAAOuG,eAAiBR,EAAmB,UAC3C,KAAK,GAAId,GAAI,EAAGC,EAAMlF,EAAOuG,eAAenB,OAAQH,EAAIC,EAAKD,IACzDjF,EAAO+C,OAAO,aAAexB,KAAM,mBAAoByB,kBAAkB,EACrEvB,OAASgN,OAAQvK,EAAe,UAAG0C,KAAM5G,EAAOuG,eAAetB,GAAIf,IAAKA,IAKhF,OAHIoK,KACAA,EAAkB,UAAIpK,EAAe,WAElCA,EAAe,WAEnBnE,KCj0BP2O,EAAsB,WACtB,QAASA,GAAK1O,GACVC,KAAK0O,kBAAmB,EACxB1O,KAAK2O,SAAW,GAChB3O,KAAK4O,cAAe,EACpB5O,KAAK6O,qBAAsB,EAC3B7O,KAAK6H,cAAe,EACpB7H,KAAK8O,oBAAuBC,YAAa,OAAQC,UAAW,GAAIC,YAAa,MAC7EjP,KAAKkP,kBAAqBC,KAAM,aAAcC,WAAY,QAAS7G,SAAU,KAAMD,UAAW,KAAM+G,MAAM,EAAOC,QAAQ,EAAOC,WAAW,GAC3IvP,KAAKwP,aAAe,GACpBxP,KAAKyP,WAAa,GAClBzP,KAAK0P,iBAAmB,EACxB1P,KAAK2P,oBAAsB,EAC3B3P,KAAK4P,iBAAmB,EACxB5P,KAAK4D,eAAiB,KACtB5D,KAAK6P,gBAAiB,EACtB7P,KAAK8P,oBAAqB,EAC1B9P,KAAK+P,UAAa1P,MAAO,EAAGC,OAAQ,GACpCN,KAAKgQ,eAAgB,EACrBhQ,KAAKiQ,eAAgB,EACrBjQ,KAAKkQ,WAAY,EACjBlQ,KAAKmQ,gBAAmBC,KAAO/P,MAAO,GAAIC,OAAQ,GAAIqI,OAAQ,KAAMC,OAAQ,MACxEyH,OAAShQ,MAAO,GAAIC,OAAQ,GAAIqI,OAAQ,KAAMC,OAAQ,MAAQ0H,YAAcjQ,MAAO,GAAIC,OAAQ,GAAIqI,OAAQ,KAAMC,OAAQ,MACzH2H,QAAUlQ,MAAO,GAAIC,OAAQ,GAAIqI,OAAQ,KAAMC,OAAQ,MAAQ4H,QAAUnQ,MAAO,GAAIC,OAAQ,GAAIqI,OAAQ,KAAMC,OAAQ,OAC1H5I,KAAKD,OAASA,EACdC,KAAKY,mBAutGT,MArtGA6N,GAAK5N,UAAUC,QAAU,WACjBd,KAAKD,OAAOgB,aAGhBf,KAAKgB,uBAETyN,EAAK5N,UAAUD,iBAAmB,WAC9BZ,KAAKD,OAAOkB,GAAG,OAAQjB,KAAKyQ,KAAMzQ,MAClCA,KAAKD,OAAOkB,GAAG,YAAajB,KAAKc,QAASd,OAE9CyO,EAAK5N,UAAUG,oBAAsB,WACjChB,KAAKD,OAAOoB,IAAI,OAAQnB,KAAKyQ,MAC7BzQ,KAAKD,OAAOoB,IAAI,YAAanB,KAAKc,UAEtC2N,EAAK5N,UAAU4P,KAAO,SAAUrP,GAE5B,OADApB,KAAK0Q,yBACGtP,EAAKE,MACT,IAAK,aACDtB,KAAK2Q,WAAWvP,EAAKI,MAAc,OAAGJ,EAAKI,MAAW,IAAGJ,EAAKI,MAAmB,YAAGJ,EAAKI,MAAc,OAAGJ,EAAKI,MAAqB,cAAGJ,EAAKI,MAAmB,YAAGJ,EAAKI,MAA0B,mBACjM,MACJ,KAAK,qBACDxB,KAAK4Q,mBAAmBxP,EAAKI,MAAgB,SAAGJ,EAAKI,MAAW,IAAGJ,EAAKI,MAAmB,YAAGJ,EAAKI,MAAS,EAAGJ,EAAKI,MAAS,EAC7H,MACJ,KAAK,mBACDxB,KAAK6Q,iBAAiBzP,EAAKI,MAAe,QAC1C,MACJ,KAAK,gBACDxB,KAAK8Q,eACL,MACJ,KAAK,uBACD9Q,KAAK+Q,qBAAqB3P,EAAKI,MAAY,KAAGJ,EAAKI,MAA4B,qBAAGJ,EAAKI,MAAmB,YAC1G,MACJ,KAAK,iBACDxB,KAAKgR,eAAe5P,EAAKI,MAAY,KAAGJ,EAAKI,MAA4B,qBAAGJ,EAAKI,MAAe,QAAGJ,EAAKI,MAA2B,oBACnI,MACJ,KAAK,eACDxB,KAAK0H,aAAatG,EAAKI,MAAe,QAAGJ,EAAKI,MAAa,MAAGJ,EAAKI,MAAiB,UACpF,MACJ,KAAK,eACDxB,KAAKiR,YAAY7P,EAAKI,MAAoB,aAC1C,MACJ,KAAK,uBACDxB,KAAKkR,gBAAgB9P,EAAKI,MAAiB,UAC3C,MACJ,KAAK,gBACDxB,KAAKmR,cACL,MACJ,KAAK,gBACDnR,KAAKoR,cAAchQ,EAAKI,MAA2B,oBACnD,MACJ,KAAK,gBACDxB,KAAKqR,cAAcjQ,EAAKI,MAAwB,iBAChD,MACJ,KAAK,SACDxB,KAAKsR,OAAOlQ,EAAKI,MAAY,KAAGJ,EAAKI,MAAc,OAAGJ,EAAKI,MAAc,OAAGJ,EAAKI,MAAa,MAAGJ,EAAKI,MAAc,OACpH,MACJ,KAAK,2BACDxB,KAAKuR,0BACL,MACJ,KAAK,iBACDvR,KAAKwR,gBACL,MACJ,KAAK,oBACDxR,KAAKyR,kBAAkBrQ,EAAKI,MAA0B,mBACtD,MACJ,KAAK,mBACDxB,KAAK0R,kBACL,MACJ,KAAK,gBACD1R,KAAK2R,cAAcvQ,EAAKI,MAAW,IACnC,MACJ,KAAK,mBACDxB,KAAK4R,iBAAiBxQ,EAAKI,MAAS,EAAGJ,EAAKI,MAAS,EAAGJ,EAAKI,MAAY,KACzE,MACJ,KAAK,OACDxB,KAAK6R,KAAKzQ,EAAKI,MAAY,KAC3B,MACJ,KAAK,mBACDxB,KAAK0O,iBAAmBtN,EAAKI,MAAwB,gBACrD,MACJ,KAAK,kBACDxB,KAAK8R,iBAAiB1Q,EAAKI,MAAc,OACzC,MACJ,KAAK,aACDxB,KAAK+R,WAAW3Q,EAAKI,MAAoB,aAAGJ,EAAKI,MAAY,KAC7D,MACJ,KAAK,cACDJ,EAAKI,MAAW,IAAY,SAAIxB,KAAK2O,SACrCvN,EAAKI,MAAW,IAAY,SAAIxB,KAAKgS,QACrC,MACJ,KAAK,gBACD5Q,EAAKI,MAAW,IAAgB,aAAIxB,KAAK4O,YACzC,MACJ,KAAK,sBACDxN,EAAKI,MAAW,IAAoB,iBAAIxB,KAAKiS,aAC7C,MACJ,KAAK,qBACDjS,KAAK6O,oBAAsBzN,EAAKI,MAAY,IAC5C,MACJ,KAAK,6BACDxB,KAAKkS,aAAe,IACpB,MACJ,KAAK,gBACDlS,KAAK6H,aAAezG,EAAKI,MAAoB,YAC7C,MACJ,KAAK,wBACDxB,KAAK8O,mBAAqB1N,EAAKI,MAA0B,kBACzD,MACJ,KAAK,sBACDxB,KAAKkP,iBAAmB9N,EAAKI,MAAwB,gBACrD,MACJ,KAAK,yBACDxB,KAAKwP,aAAepO,EAAKI,MAA2B,mBACpD,MACJ,KAAK,yBACDJ,EAAKI,MAAW,IAAS,MAAIxB,KAAKwP,YAClC,MACJ,KAAK,gBACDxP,KAAKyP,WAAarO,EAAKI,MAAkB,UACzC,MACJ,KAAK,sBACDxB,KAAK0P,iBAAmBtO,EAAKI,MAAwB,gBACrD,MACJ,KAAK,yBACDxB,KAAK2P,oBAAsBvO,EAAKI,MAA2B,mBAC3D,MACJ,KAAK,kCACDxB,KAAK4P,iBAAmBxO,EAAKI,MAAoC,4BACjE,MACJ,KAAK,oBACDxB,KAAK4D,eAAiBxC,EAAKI,MAAsB,cACjD,MACJ,KAAK,kBACDxB,KAAK6P,eAAiBzO,EAAKI,MAAY,IACvC,MACJ,KAAK,8BACDJ,EAAKI,MAAY,KAAc,WAAIxB,KAAK8P,kBACxC,MACJ,KAAK,gBACD1O,EAAKI,MAAW,IAAc,WAAIxB,KAAKmS,UACvC,MACJ,KAAK,gBACDnS,KAAKmS,WAAa/Q,EAAKI,MAAkB,UACzC,MACJ,KAAK,mBACDxB,KAAK+P,SAAS1P,MAAQe,EAAKI,MAAa,MACxCxB,KAAK+P,SAASzP,OAASc,EAAKI,MAAc,MAC1C,MACJ,KAAK,iBACDxB,KAAKgQ,eAAgB,CACrB,MACJ,KAAK,QACDhQ,KAAKkC,OACL,MACJ,KAAK,cACDlC,KAAKoS,aACL,MACJ,KAAK,mBACDpS,KAAKqS,kBACL,MACJ,KAAK,aACDrS,KAAKkQ,UAAY9O,EAAKI,MAAY,IAClC,MACJ,KAAK,aACDJ,EAAKI,MAAW,IAAa,UAAIxB,KAAKkQ,SACtC,MACJ,KAAK,oBACD9O,EAAKI,MAAW,IAAkB,eAAIxB,KAAKmQ,cAC3C,MACJ,KAAK,oBACDnQ,KAAKmQ,eAAiB/O,EAAKI,MAAsB,cACjD,MACJ,KAAK,uBACDxB,KAAKsS,qBAAqBlR,EAAKI,MAAY,KAAGJ,EAAKI,MAAiB,aAIhFiN,EAAK5N,UAAUsB,cAAgB,WAC3B,MAAO,QAEXsM,EAAK5N,UAAU6P,uBAAyB,WACpC,GAAI3Q,GAASC,KAAKD,MACdA,GAAOqC,cACPpC,KAAKqC,aAAetC,EAAOqC,YAAYE,WAAW,OAElDvC,EAAOwC,cACPvC,KAAKwC,aAAezC,EAAOwC,YAAYD,WAAW,OAElDL,oBAAkBjC,KAAK4D,kBACvB5D,KAAK4D,eAAiB7D,EAAOiD,UAAUa,aAG/C4K,EAAK5N,UAAUqB,MAAQ,WACnBlC,KAAK0O,iBAAmB1O,KAAK4O,aAAe5O,KAAKkQ,WAAY,EAC7DlQ,KAAK6O,qBAAsB,EAC3B7O,KAAKiS,cAAgB,KACrBjS,KAAKyP,WAAa,GAClBzP,KAAKkS,aAAe,KACpBlS,KAAK6H,cAAe,EACpB7H,KAAKwP,aAAe,GACpBxP,KAAK8O,oBAAuBC,YAAa,OAAQC,UAAW,GAAIC,YAAa,MAC7EjP,KAAKkP,kBACCC,KAAM,aAAcC,WAAY,QAAS7G,SAAU,KAAMD,UAAW,KAAM+G,MAAM,EAAOC,QAAQ,EAAOC,WAAW,GACvHvP,KAAK0P,iBAAmB1P,KAAK2P,oBAAsB3P,KAAK4P,iBAAmB,EAC3E5P,KAAK4D,eAAiB,KACtB5D,KAAK6P,gBAAiB,EACtB7P,KAAK8P,oBAAqB,EAC1B9P,KAAKmS,WAAa,KAClBnS,KAAKmQ,gBAAmBC,KAAO/P,MAAO,GAAIC,OAAQ,GAAIqI,OAAQ,KAAMC,OAAQ,MACxEyH,OAAShQ,MAAO,GAAIC,OAAQ,GAAIqI,OAAQ,KAAMC,OAAQ,MAAQ0H,YAAcjQ,MAAO,GAAIC,OAAQ,GAAIqI,OAAQ,KAAMC,OAAQ,MACzH2H,QAAUlQ,MAAO,GAAIC,OAAQ,GAAIqI,OAAQ,KAAMC,OAAQ,MAAQ4H,QAAUnQ,MAAO,GAAIC,OAAQ,GAAIqI,OAAQ,KAAMC,OAAQ,QAE9H6F,EAAK5N,UAAU8P,WAAa,SAAUtL,EAAQpB,EAAKsO,EAAa1J,EAAQ2J,EAAeC,EAAaC,GAChG,GAAI3S,GAASC,KAAKD,OACd4C,EAAW5C,EAAO6C,UAAUC,WAChC7C,MAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOwC,YAAYlC,MAAON,EAAOwC,YAAYjC,OAC/E,IAAIqS,EA2BJ,IA1B6B,aAAzBtN,EAAOuN,cACPD,EAAa3S,KAAKqC,aAEY,cAAzBgD,EAAOuN,cACZD,EAAa3S,KAAKwC,aAEbiQ,IACLE,EAAaF,IAEZD,GAAiBzS,EAAO6C,UAAUwC,OACnCpF,KAAK6S,eAEL9S,EAAO0F,YAAYL,OAEiB,SADnBrF,EAAO0F,YAAYL,MAAMuH,MAAM,KACjC,GAAGiG,eAA4BL,GAC1CvS,KAAK8S,gBAGTjK,IACAlG,EAASxC,OAAS0I,EAAO1I,OACzBwC,EAASvC,OAASyI,EAAOzI,OACzBuC,EAASoF,KAAOc,EAAOd,KACvBpF,EAASqF,KAAOa,EAAOb,KACvBrF,EAAStC,MAAQwI,EAAOxI,MACxBsC,EAASrC,OAASuI,EAAOvI,QAEzB2B,oBAAkBlC,EAAO6C,UAAUmQ,gBAAiB,CACpD,GAAIC,IAAUD,kBACdhT,GAAO+C,OAAO,SAAWxB,KAAM,oBAAqByB,kBAAkB,EAClEvB,OAASyC,IAAK+O,KAClBjT,EAAO6C,UAAUmQ,eAAiBC,EAAsB,eAS5D,GAPI/Q,oBAAkBlC,EAAO6C,UAAUmQ,eAAe9D,eAClDlP,EAAO6C,UAAUmQ,eAAe9D,YAAc,GAE9ChL,IACAlE,EAAO6C,UAAYoB,YAAWC,MAAS,IAE3CjE,KAAK4Q,sBACD3O,oBAAkBlC,EAAO6C,UAAUC,YAAY1C,UAC/C8B,oBAAkBlC,EAAO6C,UAAUC,YAAYzC,QADnD,CAIA,GAAIL,EAAO0F,YAAYwN,OAAQ,CAC3B,GAAIC,IAAUC,WAAY,GAC1BpT,GAAO+C,OAAO,SAAWxB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAASyC,IAAKiP,KACvFnT,EAAO6C,UAAUuQ,WAAaD,EAAkB,WAEpD,GAA6B,aAAzB7N,EAAOuN,cAA8B,CACrC,GACI/F,IAAS,CACT9M,GAAO6C,UAAUwC,OAEK,SADTrF,EAAO6C,UAAUwC,MAAMuH,MAAM,KAC3B,KACXE,GAAS,GAGbA,IACA7M,KAAKwC,aAAa4Q,UAAY,qBAC9BpT,KAAKwC,aAAa6Q,SAAS,EAAG,EAAGtT,EAAOqC,YAAY/B,MAAON,EAAOqC,YAAY9B,QAC9EN,KAAKwC,aAAa2B,UAAUxB,EAASxC,OAAQwC,EAASvC,OAAQuC,EAAStC,MAAOsC,EAASrC,UAEvF2B,oBAAkByQ,IAAwBC,IAAe3S,KAAKqC,cAAgBsQ,IAAe3S,KAAKwC,eAClGxC,KAAKsT,cAAc,UAAWX,GAC9B3S,KAAKuT,mBAAmBZ,GACxB3S,KAAKsT,cAAc,UAAWX,IAGtC5S,EAAO0F,YAAYuF,aAAc,CACjC,IAAIlF,IAAWqN,WAAY,GAC3BpT,GAAO+C,OAAO,SAAWxB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAASyC,IAAK6B,KACnF7B,EACAjE,KAAKwT,aAAanO,EAAQpB,EAAImB,MAAOqN,EAAaC,GAEpB,KAAzB5M,EAAmB,YAAY/F,EAAO0F,YAAYwN,OACvDjT,KAAKwT,aAAanO,EAAQ,OAAQoN,EAAaC,GAE1C3S,EAAO6C,UAAUwC,MACtBpF,KAAKwT,aAAanO,EAAQtF,EAAO6C,UAAUwC,MAAOqN,EAAaC,GAG/D1S,KAAKwT,aAAanO,MAAQoO,GAAWhB,EAAaC,KAG1DjE,EAAK5N,UAAUyS,cAAgB,SAAU3M,EAAM+M,GAC3C,GAAI3T,GAASC,KAAKD,OACd8C,EAAcmB,YAAWjE,EAAO6C,UAAUC,gBAAiB,EAC/D,IAA+B,SAA3B9C,EAAO6C,UAAUwC,OAA+C,UAA3BrF,EAAO6C,UAAUwC,MAA1D,CAGA,GAAIuO,GAA0B,YAAThN,EAAsB5G,EAAO6C,UAAUgR,cAAgB7T,EAAO6C,UAAUgR,YAC7FF,GAAIG,UAAUhR,EAAY1C,OAAU0C,EAAYxC,MAAQ,EAAIwC,EAAYzC,OAAUyC,EAAYvC,OAAS,GACvGoT,EAAII,OAAOH,GACXD,EAAIG,YAAYhR,EAAY1C,OAAU0C,EAAYxC,MAAQ,KAAOwC,EAAYzC,OAAUyC,EAAYvC,OAAS,MAEhHmO,EAAK5N,UAAUgS,aAAe,WAC1B,GAAI9S,GAASC,KAAKD,OACd4C,EAAW5C,EAAO6C,UAAUC,WAC5BF,IAA8C,IAAlC5C,EAAO6C,UAAUgR,eACzBjR,EAASxC,OAASJ,EAAOqD,IAAIC,UAC7BV,EAASxC,OAASJ,EAAOqD,IAAIC,SAC7BV,EAASoF,KAAOpF,EAASxC,OAASwC,EAAStC,OAEtCsC,EAASoF,KAAOhI,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,YACtDZ,EAASoF,KAAOhI,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,UACjDZ,EAASxC,OAASwC,EAASoF,KAAOpF,EAAStC,OAE3CsC,EAASvC,OAASL,EAAOqD,IAAIE,QAC7BX,EAASvC,OAASL,EAAOqD,IAAIE,QAExBX,EAASqF,KAAOjI,EAAOqD,IAAIE,QAAUvD,EAAOqD,IAAII,aACrDb,EAASqF,KAAOjI,EAAOqD,IAAIE,QAAUvD,EAAOqD,IAAII,WAChDb,EAASvC,OAASuC,EAASqF,KAAOrF,EAASrC,QAE/CP,EAAO6C,UAAY5C,KAAK+T,kBAAkBhU,EAAO6C,aAGzD6L,EAAK5N,UAAUiS,cAAgB,WAC3B,GAEItS,GACAC,EACAJ,EACAC,EALAP,EAASC,KAAKD,OACd4C,EAAW5C,EAAO6C,UAAUC,WAKhC,IAAI9C,EAAOiD,UAAUa,WAAa,GAAK7D,KAAKkS,aAAc,CACtD,GAAItP,GAAYoB,YAAWjE,EAAO6C,cAAe,EACjD5C,MAAKgU,oBAAoB,cAAe,KAAM,KAAM,KAAM,MACtDjU,EAAOiD,UAAUC,OAAS,IAAO,GAAKlD,EAAOiD,UAAUC,OAAS,KAAQ,EAGxE3C,EAFAD,EAAQN,EAAO6C,UAAUC,YAAYxC,MAAQN,EAAO6C,UAAUC,YAAYvC,OACtEP,EAAO6C,UAAUC,YAAYxC,MAAQN,EAAO6C,UAAUC,YAAYvC,QAKlED,EADAN,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,WAAaxD,EAAOqC,YAAYoC,YAC/E7B,EAAStC,MAGTN,EAAOqC,YAAYoC,YAAczE,EAAOqD,IAAIC,SAGpD/C,EADAP,EAAOqD,IAAIE,QAAUvD,EAAOqD,IAAIE,QAAUvD,EAAOqD,IAAII,YAAczD,EAAOqC,YAAYqC,aAC7E9B,EAASrC,OAGTP,EAAOqC,YAAYqC,aAAe1E,EAAOqD,IAAIE,SAG9DvD,EAAO+C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,IACrEhD,EAAO6C,UAAYA,EACnB7C,EAAO0F,YAAYL,MAAQxC,EAAUwC,MACrCpF,KAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOwC,YAAYlC,MAAON,EAAOwC,YAAYjC,QAC/EP,EAAO0F,YAAYC,cAAe,MAGlCrF,GAAQN,EAAOqD,IAAIG,UACnBjD,EAASP,EAAOqD,IAAII,WAChBzD,EAAOqD,IAAIC,SAAW,IACtBhD,GAASN,EAAOqD,IAAIC,UAEpBtD,EAAOqD,IAAIE,QAAU,IACrBhD,GAAUP,EAAOqD,IAAIE,SAEsB,gBAA3CvD,EAAO0F,YAAYL,MAAMwN,eAA8E,gBAA3C7S,EAAO0F,YAAYL,MAAMwN,gBACjF7S,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,UAAYxD,EAAOqC,YAAY/B,QAChEA,GAAUN,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,UAAYxD,EAAOqC,YAAY/B,OAE1EN,EAAOqD,IAAIE,QAAUvD,EAAOqD,IAAII,WAAazD,EAAOqC,YAAY9B,SAChEA,GAAWP,EAAOqD,IAAIE,QAAUvD,EAAOqD,IAAII,WAAazD,EAAOqC,YAAY9B,QAIvF,QAAQP,EAAO0F,YAAYL,MAAMwN,eAC7B,IAAK,cACL,IAAK,cACD7S,EAAO+C,OAAO,aAAexB,KAAM,mBAAoByB,kBAAkB,EAAOvB,OAASnB,MAAOA,EAAOC,OAAQA,KAC/GqC,EAAW5C,EAAO6C,UAAUC,YACxB9C,EAAOqC,YAAY/B,MAASsC,EAASoF,KAAOpF,EAASxC,SACrDwC,EAASxC,OAAS,IAClBwC,EAASoF,KAAOhI,EAAOqC,YAAY/B,MAAQ,KAE3CN,EAAOqC,YAAY9B,OAAUqC,EAASqF,KAAOrF,EAASvC,SACtDuC,EAASvC,OAAS,IAClBuC,EAASqF,KAAOjI,EAAOqC,YAAY9B,OAAS,KAE5CD,IAAUN,EAAOqD,IAAIG,WAAajD,IAAWP,EAAOqD,IAAII,aACxDb,EAASxC,QAAUJ,EAAOqD,IAAIC,SAC9BV,EAASvC,QACLL,EAAOqD,IAAIE,QACfX,EAASoF,MAAQhI,EAAOqD,IAAIC,SAC5BV,EAASqF,MACLjI,EAAOqD,IAAIE,SAEfvD,EAAOqC,YAAY/B,MAAQN,EAAOqC,YAAY9B,QAC9CqC,EAASrC,OAASqC,EAASqF,KAAOrF,EAASvC,OAC3CuC,EAAStC,MAAQsC,EAASrC,OAC1BqC,EAASoF,KAAOpF,EAASxC,OACrBwC,EAAStC,QAGbsC,EAAStC,MAAQsC,EAASoF,KAAOpF,EAASxC,OAC1CwC,EAASrC,OAASqC,EAAStC,MAC3BsC,EAASqF,KAAOrF,EAASvC,OACrBuC,EAASrC,OAEjB,MACJ,KAAK,WACDE,EAAI,EACJC,EAAI,CACJ,MACJ,KAAK,WACDD,EAAI,EACJC,EAAI,CACJ,MACJ,KAAK,WACDD,EAAI,EACJC,EAAI,CACJ,MACJ,KAAK,WACDD,EAAI,EACJC,EAAI,CACJ,MACJ,KAAK,YACDD,EAAI,GACJC,EAAI,EAWZ,OARUgT,KAANjT,OAAyBiT,KAANhT,IACnBV,EAAO+C,OAAO,aAAexB,KAAM,iBAAkByB,kBAAkB,EACnEvB,OAAShB,EAAGA,EAAGC,EAAGA,EAAGwT,SAAU5T,EAAO6T,UAAW5T,KACjDD,IAAUN,EAAOqD,IAAIG,WAAajD,IAAWP,EAAOqD,IAAII,YACxDxD,KAAKmU,eAETxR,EAAW5C,EAAO6C,UAAUC,aAE5BF,EAASxC,OAASJ,EAAOqD,IAAIC,SAAU,CACnC+Q,EAAQrU,EAAOqD,IAAIC,SAAWV,EAASxC,OAAU,GACrDwC,GAASxC,QAAUiU,EACnBzR,EAASoF,MAAQqM,EAErB,GAAIzR,EAASvC,OAASL,EAAOqD,IAAIE,QAAS,CACtC,GAAI8Q,GAAQrU,EAAOqD,IAAIE,QAAUX,EAASvC,OAAU,GACpDuC,GAASvC,QAAUgU,EACnBzR,EAASqF,MAAQoM,EAErBrU,EAAO6C,UAAY5C,KAAK+T,kBAAkBhU,EAAO6C,WACjD5C,KAAKqU,eAET5F,EAAK5N,UAAUwT,YAAc,WACzB,GAAItU,GAASC,KAAKD,OACduU,EAAUvU,EAAOqC,kBAAqB,GAAMrC,EAAO6C,UAAUC,YAAYkF,KACzEhI,EAAO6C,UAAUC,YAAYxC,MAAQ,GACrCkU,EAAUxU,EAAOqC,mBAAsB,GAAMrC,EAAO6C,UAAUC,YAAYmF,KAC1EjI,EAAO6C,UAAUC,YAAYvC,OAAS,EAK1C,IAJAP,EAAO6C,UAAUC,YAAY1C,QAAUmU,EACvCvU,EAAO6C,UAAUC,YAAYkF,MAAQuM,EACrCvU,EAAO6C,UAAUC,YAAYzC,QAAUmU,EACvCxU,EAAO6C,UAAUC,YAAYmF,MAAQuM,EACjCxU,EAAO6C,UAAUC,YAAY1C,QAAUJ,EAAOqD,IAAIC,UAAY,IAAMtD,EAAOqD,IAAIC,SAAW,KAAM,CAC5F+Q,GAASrU,EAAOqD,IAAIC,UAAY,IAAMtD,EAAOqD,IAAIC,SAAW,GAAKtD,EAAO6C,UAAUC,YAAY1C,OAAU,GAC5GJ,GAAO6C,UAAUC,YAAY1C,QAAUiU,EACvCrU,EAAO6C,UAAUC,YAAYkF,MAAQqM,MAEpC,IAAIrU,EAAO6C,UAAUC,YAAYkF,KAAOhI,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,UAAW,CACjF6Q,EAAQrU,EAAO6C,UAAUC,YAAYkF,MAAQhI,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,WAAc,GAChGxD,GAAO6C,UAAUC,YAAY1C,QAAUiU,EACvCrU,EAAO6C,UAAUC,YAAYkF,MAAQqM,EAEzC,GAAIrU,EAAO6C,UAAUC,YAAYzC,QAAUL,EAAOqD,IAAIE,QAAU,IAAMvD,EAAOqD,IAAIE,QAAU,KAAM,CACzF8Q,GAASrU,EAAOqD,IAAIE,QAAU,IAAMvD,EAAOqD,IAAIE,QAAU,GAAKvD,EAAO6C,UAAUC,YAAYzC,OAAU,GACzGL,GAAO6C,UAAUC,YAAYzC,QAAUgU,EACvCrU,EAAO6C,UAAUC,YAAYmF,MAAQoM,MAEpC,IAAIrU,EAAO6C,UAAUC,YAAYmF,KAAOjI,EAAOqD,IAAIE,QAAUvD,EAAOqD,IAAII,WAAY,CACrF,GAAI4Q,GAAQrU,EAAO6C,UAAUC,YAAYmF,MAAQjI,EAAOqD,IAAIE,QAAUvD,EAAOqD,IAAII,YAAe,GAChGzD,GAAO6C,UAAUC,YAAYzC,QAAUgU,EACvCrU,EAAO6C,UAAUC,YAAYmF,MAAQoM,IAG7C3F,EAAK5N,UAAU+P,mBAAqB,SAAUjO,EAAUsB,EAAKuQ,EAAahU,EAAGC,GACzEkC,EAAWA,GAAsBqB,YAAWhE,KAAKD,OAAO6C,UAAUC,gBAAiB,GACnFoB,EAAMA,GAAYD,YAAWhE,KAAKD,OAAO6C,cAAe,GACxDD,EAAStC,MAAQsC,EAASoF,KAAOpF,EAASxC,OAC1CwC,EAASrC,OAASqC,EAASqF,KAAOrF,EAASvC,OAC3CI,EAAIA,GAAQ,EACZC,EAAIA,GAAQ,CACZ,IAAIgU,GAAiB9R,EAAStC,MAAQ,EAClCqU,EAAkB/R,EAASrC,OAAS,CAExC2D,GAAI2I,YAAezM,OAAQwC,EAASxC,OAASK,EAAGJ,OAAQuC,EAASvC,OAASK,EACtEsH,KAAMpF,EAASoF,KAAOvH,EAAGwH,KAAMrF,EAASqF,KAAOvH,GACnDwD,EAAI0Q,eAAkBxU,OAAQwC,EAASxC,OAASK,EAAGJ,OAAQuC,EAASqF,KAAOvH,EACvEsH,KAAMpF,EAASoF,KAAOvH,EAAGwH,KAAMrF,EAASqF,KAAOvH,GACnDwD,EAAI2Q,aAAgBzU,OAAQwC,EAASxC,OAASK,EAAGJ,OAAQuC,EAASvC,OAASK,EACvEsH,KAAMpF,EAASxC,OAASM,EAAGuH,KAAMrF,EAASqF,KAAOvH,GACrDwD,EAAI4Q,cAAiB1U,OAAQwC,EAASoF,KAAOvH,EAAGJ,OAAQuC,EAASvC,OAASK,EACtEsH,KAAMpF,EAASoF,KAAOvH,EAAGwH,KAAMrF,EAASqF,KAAOvH,GACnDwD,EAAI6Q,eAAkB3U,OAAQwC,EAASxC,OAAQC,OAAQuC,EAASvC,OAC5DsK,OAAQzG,EAAI2I,WAAW7E,KAVd,IAUgC,GAC7C9D,EAAI8Q,iBAAoB5U,OAAQwC,EAASxC,OAASsU,EAAgBrU,OAAQuC,EAASvC,OAC/EsK,OAAQzG,EAAI2I,WAAW7E,KAZd,IAYgC,GAC7C9D,EAAI+Q,gBAAmB7U,OAAQwC,EAASoF,KAAM3H,OAAQuC,EAASvC,OAC3DsK,OAAQzG,EAAI2I,WAAW7E,KAdd,IAcgC,GAC7C9D,EAAIgR,kBAAqB9U,OAAQwC,EAASxC,OAAQC,OAAQuC,EAASvC,OAASsU,EACxEhK,OAAQzG,EAAI2I,WAAW7E,KAhBd,IAgBgC,GAC7C9D,EAAIiR,mBAAsB/U,OAAQwC,EAASoF,KAAM3H,OAAQuC,EAASvC,OAASsU,EACvEhK,OAAQzG,EAAI2I,WAAW7E,KAlBd,IAkBgC,GAC7C9D,EAAIkR,kBAAqBhV,OAAQwC,EAASxC,OAAQC,OAAQuC,EAASqF,KAC/D0C,OAAQzG,EAAI2I,WAAW7E,KApBd,IAoBgC,GAC7C9D,EAAImR,oBAAuBjV,OAAQwC,EAASxC,OAASsU,EAAgBrU,OAAQuC,EAASqF,KAClF0C,OAAQzG,EAAI2I,WAAW7E,KAtBd,IAsBgC,GAC7C9D,EAAIoR,mBAAsBlV,OAAQwC,EAASoF,KAAM3H,OAAQuC,EAASqF,KAC9D0C,OAAQzG,EAAI2I,WAAW7E,KAxBd,IAwBgC,GACpB,IAArB9D,EAAI2P,eACJ3P,EAAIqR,qBAAwB9U,EAAGyD,EAAImR,mBAAmBjV,OAClDM,EAAGwD,EAAImR,mBAAmBhV,OAAS,IACvC6D,EAAIqR,oBAAoB3M,QAAU1E,EAAIqR,oBAAoB9U,EAAIR,KAAKD,OAAOqD,IAAIC,UAAYrD,KAAKD,OAAOqD,IAAIG,UAC1GU,EAAIqR,oBAAoB1M,QAAU3E,EAAIqR,oBAAoB7U,EAAIT,KAAKD,OAAOqD,IAAIE,SAAWtD,KAAKD,OAAOqD,IAAII,YAE7GS,EAAIpB,YAAcF,EACdV,oBAAkBuS,KAClBxU,KAAKD,OAAO6C,UAAYoB,YAAWC,MAAS,KAGpDwK,EAAK5N,UAAU0S,mBAAqB,SAAUZ,EAAY4C,GACtD,GAAI7I,GACA3M,EAASC,KAAKD,OACd4C,EAAW5C,EAAO6C,UAAUC,WAChC8P,GAAW6C,iBACoB/B,KAA3B1T,EAAO6C,UAAUwC,QACjBsH,EAAa3M,EAAO6C,UAAUwC,MAAMuH,MAAM,KAE9C,IAAI8I,GAAUzR,YAAWjE,EAAO6C,cAAe,OAChB6Q,KAA3B1T,EAAO6C,UAAUwC,QACjBsH,EAAa3M,EAAO6C,UAAUwC,MAAMuH,MAAM,WAEzB8G,KAAf/G,GAA8C,SAAlBA,EAAW,SAA6C+G,KAA3B1T,EAAO6C,UAAUwC,OAAyBmQ,IACrGvV,KAAKwC,aAAa4Q,UAAY,qBAC9BpT,KAAKwC,aAAa6Q,SAAS,EAAG,EAAGtT,EAAOqC,YAAY/B,MAAON,EAAOqC,YAAY9B,QAC9EN,KAAKwC,aAAa2B,UAAUxB,EAASxC,OAAQwC,EAASvC,OAAQuC,EAAStC,MAAOsC,EAASrC,SAE3FqS,EAAW+C,YAAc3V,EAAO4V,UAAU5V,EAAO6V,OAAqB,aACtEjD,EAAWS,UAAYrT,EAAO4V,UAAU5V,EAAO6V,OAAuB,cACtE,IAAI3S,EAUJ,KARIA,EADwB,IAAxBwS,EAAQvN,YACCnI,EAAOiD,UAAUC,OAGjBlD,EAAOiD,UAAUC,OAASwS,EAAQvN,aAElC,IACTjF,EAAS,IAAMA,GAEY,UAA3BlD,EAAO6C,UAAUwC,OAAgD,SAA3BrF,EAAO6C,UAAUwC,MACvDuN,EAAWpI,YACXoI,EAAWkD,OAAOlT,EAASxC,OAAQwC,EAASvC,QAC5CuS,EAAWmD,OAAOnT,EAASoF,KAAMpF,EAASqF,MAC1C2K,EAAWoD,aAEV,IAA+B,SAA3BhW,EAAO6C,UAAUwC,MAAkB,CACxCuN,EAAWpI,WACX,IAAI3H,GAAYoB,YAAWjE,EAAO6C,cAAe,EAEjD,IADA+P,EAAWkD,OAAOjT,EAAUqE,UAAU,GAAGzG,EAAGoC,EAAUqE,UAAU,GAAGxG,GAC/DmC,EAAUqE,UAAU9B,OAAS,EAC7B,IAAK,GAAIH,GAAI,EAAGC,EAAMrC,EAAUqE,UAAU9B,OAAQH,EAAIC,EAAKD,IACvDrC,EAASoF,KAAOnF,EAAUqE,UAAUjC,GAAGxE,EACvCmC,EAASqF,KAAOpF,EAAUqE,UAAUjC,GAAGvE,EACvCkS,EAAWmD,OAAOnT,EAASoF,KAAMpF,EAASqF,KAGlD,IAAI/D,IAAQmB,MAAO,KACnBrF,GAAO+C,OAAO,aAAexB,KAAM,yBAA0BE,OAASyC,IAAKA,KACtD,SAAjBA,EAAW,QACXlE,EAAO6C,UAAYA,GAEvB+P,EAAWmD,OAAOnT,EAASoF,KAAMpF,EAASqF,MAC1C2K,EAAWoD,aAOX,IAJApD,EAAWpI,YACXoI,EAAWqD,KAAKP,EAAQ5S,YAAY1C,OAAQsV,EAAQ5S,YAAYzC,OAAQqV,EAAQ5S,YAAYxC,MAAOoV,EAAQ5S,YAAYvC,QACvHqS,EAAWoD,SACXpD,EAAW9H,YACP9K,EAAOkW,kBAAkBC,WAAY,CACrC,GAAInH,GAAc4D,EAAW+C,YACzB1G,EAAY2D,EAAWS,SAC3BT,GAAW+C,YAAc3V,EAAOkW,kBAAkBlH,YAClD4D,EAAWS,UAAYrT,EAAOkW,kBAAkBjH,UAChD2D,EAAW6C,WAAa,EACxB7C,EAAWpI,YACXoI,EAAWkD,OAAOJ,EAAQX,cAAc3U,OAAQsV,EAAQX,cAAc1U,QACtEuS,EAAWhI,IAAI8K,EAAQX,cAAc3U,OAAQsV,EAAQX,cAAc1U,OAAQqV,EAAQX,cAAcpK,OAAQ,EAAG,EAAIvC,KAAKyC,IACrH+H,EAAWkD,OAAOJ,EAAQT,eAAe7U,OAAQsV,EAAQT,eAAe5U,QACxEuS,EAAWhI,IAAI8K,EAAQT,eAAe7U,OAAQsV,EAAQT,eAAe5U,OAAQqV,EAAQT,eAAetK,OAAQ,EAAG,EAAIvC,KAAKyC,IACxH+H,EAAWkD,OAAOJ,EAAQN,iBAAiBhV,OAAQsV,EAAQN,iBAAiB/U,QAC5EuS,EAAWhI,IAAI8K,EAAQN,iBAAiBhV,OAAQsV,EAAQN,iBAAiB/U,OAAQqV,EAAQN,iBAAiBzK,OAAQ,EAAG,EAAIvC,KAAKyC,IAC9H+H,EAAWkD,OAAOJ,EAAQJ,kBAAkBlV,OAAQsV,EAAQJ,kBAAkBjV,QAC9EuS,EAAWhI,IAAI8K,EAAQJ,kBAAkBlV,OAAQsV,EAAQJ,kBAAkBjV,OAAQqV,EAAQJ,kBAAkB3K,OAAQ,EAAG,EAAIvC,KAAKyC,IACjI+H,EAAWoD,SACXpD,EAAW7H,OACX6H,EAAW9H,YACX8H,EAAW6C,WAAa,EACxB7C,EAAW+C,YAAc3G,EACzB4D,EAAWS,UAAYpE,EAG/B,GAAIjP,EAAOkW,kBAAkBC,iBAA8BzC,KAAf/G,GAA8C,SAAlBA,EAAW,IAAgB,CAC/F,GAAIqC,GAAc4D,EAAW+C,YACzB1G,EAAY2D,EAAWS,SAC3BT,GAAW+C,YAAc3V,EAAOkW,kBAAkBlH,YAClD4D,EAAWS,UAAYrT,EAAOkW,kBAAkBjH,UACjB,SAA3BjP,EAAO6C,UAAUwC,OAiBjBpF,KAAKmW,kBAAkBxD,GAE3BA,EAAW+C,YAAc3G,EACzB4D,EAAWS,UAAYpE,EAE3ByG,EAAQW,mBAAqBrW,EAAO6C,UAAUwT,mBAC9CrW,EAAO6C,UAAYoB,YAAWyR,MAAa,IAE/ChH,EAAK5N,UAAUwV,cAAgB,SAAU1D,EAAY2D,GAEjD,OADeA,EAActW,KAAKD,OAAO6C,UAAU2T,MAAQvW,KAAKD,OAAO6C,UAAU4T,KAE7E,IAAK,aAEDF,EAActW,KAAKsQ,WAAWqC,GAAY,GAAQ3S,KAAKsQ,WAAWqC,GAAY,EAC9E,MACJ,KAAK,QAED2D,EAActW,KAAKqQ,MAAMsC,GAAY,GAAQ3S,KAAKqQ,MAAMsC,GAAY,EACpE,MACJ,KAAK,cAED2D,EAActW,KAAKyW,iBAAiB9D,GAAY,GAAQ3S,KAAKyW,iBAAiB9D,GAAY,EAC1F,MACJ,KAAK,SAED2D,EAActW,KAAK0W,YAAY/D,GAAY,GAAQ3S,KAAK0W,YAAY/D,GAAY,EAChF,MACJ,KAAK,MAED2D,EAActW,KAAK2W,SAAShE,GAAY,GAAQ3S,KAAK2W,SAAShE,GAAY,EAC1E,MACJ,KAAK,SACL,IAAK,cAED2D,EAActW,KAAK4W,iBAAiBjE,GAAc3S,KAAK6W,eAAelE,KAIlFlE,EAAK5N,UAAU2S,aAAe,SAAUnO,EAAQD,EAAOqN,EAAaC,GAChE,GAAI3S,GAASC,KAAKD,OACd4C,EAAW5C,EAAO6C,UAAUC,YAC5BiU,MAAyBrD,KAAVrO,EAAsBA,EAAQrF,EAAO0F,YAAYL,KACpErF,GAAO0F,YAAYL,MAAQ0R,CAC3B,IAAInE,EACyB,cAAzBtN,EAAOuN,cACPD,EAAa3S,KAAKqC,aAEY,cAAzBgD,EAAOuN,cACZD,EAAa3S,KAAKwC,aAEbiQ,IACLE,EAAaF,GAE8B,cAA3C1S,EAAO0F,YAAYL,MAAMwN,eAA4E,YAA3C7S,EAAO0F,YAAYL,MAAMwN,eACrC,SAA3C7S,EAAO0F,YAAYL,MAAMwN,eAAuD,UAA3B7S,EAAO6C,UAAUwC,OAC9C,SAA3BrF,EAAO6C,UAAUwC,QACjBrF,EAAO6C,UAAUwC,MAAQrF,EAAO0F,YAAYL,OAEhDuN,EAAW+C,YAAc3V,EAAO6C,UAAUmQ,eAAehE,YAErD4D,EAAWS,UADD,SAAVhO,GAA8B,iBAAVA,EACGrF,EAAO6C,UAAUmQ,eAAehE,YAGhChP,EAAO6C,UAAUmQ,eAAe/D,SAE3D,IAAI+H,GAAepU,EAAStC,MAAQ,EAChC2W,EAAgBrU,EAASrC,OAAS,EAClC2W,EAAiBtU,EAASoF,KAAOpF,EAASxC,OAC1C+W,EAAkBvU,EAASqF,KAAOrF,EAASvC,MAC/CJ,MAAKsT,cAAc,UAAWX,EAC9B,IAAI1P,GAEAL,EADAuU,EAAgBxE,EAAWS,SAE/B,QAAQrT,EAAO0F,YAAYL,MAAMwN,eAC7B,IAAK,YACD5S,KAAKoX,gBAAgBzE,GACjB1Q,oBAAkByQ,IAAuBC,IAAe3S,KAAKwC,cAC7DxC,KAAKuT,mBAAmBZ,EAE5B,MACJ,KAAK,UACDsE,EAAiB9O,KAAKC,IAAI6O,GAC1BC,EAAkB/O,KAAKC,IAAI8O,GAC3BvE,EAAWpI,YACXoI,EAAW0E,QAAQ1U,EAASxC,OAAU8W,EAAiB,EAAItU,EAASvC,OAAU8W,EAAkB,EAAID,EAAiB,EAAGC,EAAkB,EAAG,EAAG,EAAG,EAAI/O,KAAKyC,IAAI,GAC9G,KAA9C7K,EAAO6C,UAAUmQ,eAAe/D,YAChC2D,EAAWS,UAAYrT,EAAO6C,UAAUmQ,eAAe/D,UACvD2D,EAAW7H,QAEf6H,EAAW0E,QAAQ1U,EAASxC,OAAU8W,EAAiB,EAAItU,EAASvC,OAAU8W,EAAkB,EAAI/O,KAAKC,IAAK6O,EAAiB,EAAMlX,EAAO6C,UAAUmQ,eAA2B,aAAG5K,KAAKC,IAAK8O,EAAkB,EAAMnX,EAAO6C,UAAUmQ,eAA2B,aAAG,EAAG,EAAG,EAAI5K,KAAKyC,IAAI,GACxR+H,EAAWS,UAAYrT,EAAO6C,UAAUmQ,eAAehE,YACvD4D,EAAW7H,KAAK,WAChB6H,EAAW9H,YACP5I,oBAAkByQ,IAAuBC,IAAe3S,KAAKwC,cAC7DxC,KAAKuT,mBAAmBZ,EAE5B,MACJ,KAAK,cACGA,IAAe3S,KAAKqC,eACpBsQ,EAAa3S,KAAKwC,cAEtBxC,KAAKsX,YAAY3E,EAAYsE,EAAgBC,EAC7C,MACJ,KAAK,OACDlX,KAAKuX,UAAU5E,EAAYhQ,EAASxC,OAAQwC,EAASvC,OAAQuC,EAASoF,KAAMpF,EAASqF,MACjF/F,oBAAkByQ,IAAuBC,IAAe3S,KAAKwC,cAC7DxC,KAAKuT,mBAAmBZ,EAE5B,MACJ,KAAK,SAEG1P,EADiC,IAAjClD,EAAO6C,UAAUsF,YACRnI,EAAOiD,UAAUC,OAGjBlD,EAAOiD,UAAUC,OAASlD,EAAO6C,UAAUsF,aAE3C,IACTjF,EAAS,IAAMA,GAEnB0P,EAAWS,UAAYT,EAAW+C,YAC9BzT,oBAAkBlC,EAAO6C,UAAU4U,qBACnCzX,EAAO6C,UAAU4U,kBAAoB,SAErCvV,oBAAkBlC,EAAO6C,UAAU2T,SACnCxW,EAAO6C,UAAU2T,MAAQ,QAEzBtU,oBAAkBlC,EAAO6C,UAAU4T,OACnCzW,EAAO6C,UAAU4T,IAAM,cAE3BxW,KAAKqW,cAAc1D,GAAY,GAC/B3S,KAAKqW,cAAc1D,GAAY,GACF,SAAzB5S,EAAO6C,UAAU4T,KACjBxW,KAAKuX,UAAU5E,EAAYhQ,EAASxC,OAAQwC,EAASvC,OAAQuC,EAASoF,KAAMpF,EAASqF,MAEzF2K,EAAWS,UAAY+D,EACnBlV,oBAAkByQ,IAAuBC,IAAe3S,KAAKwC,cAC7DxC,KAAKuT,mBAAmBZ,EAE5B,MACJ,KAAK,OAED,IADA/P,EAAYoB,YAAWjE,EAAO6C,cAAe,IAC/BqE,UAAU9B,OAAS,EAAG,CAChC,GAAIlB,IAAQmB,MAAO,KAEnB,IADArF,EAAO+C,OAAO,aAAexB,KAAM,yBAA0BE,OAASyC,IAAKA,KACtD,SAAjBA,EAAW,MAEX,IAAK,GADDwT,IAAcjX,EAAG,EAAGC,EAAG,GAClBuE,EAAI,EAAGC,EAAMrC,EAAUqE,UAAU9B,OAAQH,EAAIC,EAAKD,IACnD/C,oBAAkBW,EAAUqE,UAAUjC,EAAI,KAC1CyS,EAAUjX,EAAIoC,EAAUC,YAAYkF,KACpC0P,EAAUhX,EAAImC,EAAUC,YAAYmF,OAGpCyP,EAAUjX,EAAIoC,EAAUqE,UAAUjC,EAAI,GAAGxE,EACzCiX,EAAUhX,EAAImC,EAAUqE,UAAUjC,EAAI,GAAGvE,GAE7CkC,EAASxC,OAASyC,EAAUqE,UAAUjC,GAAGxE,EACzCmC,EAASvC,OAASwC,EAAUqE,UAAUjC,GAAGvE,EACzCkC,EAASoF,KAAO0P,EAAUjX,EAC1BmC,EAASqF,KAAOyP,EAAUhX,EAC1BV,EAAO6C,UAAY5C,KAAK+T,kBAAkBhU,EAAO6C,WACjD5C,KAAKuX,UAAU5E,EAAYhQ,EAASxC,OAAQwC,EAASvC,OAAQuC,EAASoF,KAAMpF,EAASqF,UAIzF,KAAK,GAAIhD,GAAI,EAAGC,EAAMrC,EAAUqE,UAAU9B,OAAQH,EAAIC,EAAKD,IACvDrC,EAASxC,OAASyC,EAAUqE,UAAUjC,EAAI,GAAGxE,EAC7CmC,EAASvC,OAASwC,EAAUqE,UAAUjC,EAAI,GAAGvE,EAC7CkC,EAASoF,KAAOnF,EAAUqE,UAAUjC,GAAGxE,EACvCmC,EAASqF,KAAOpF,EAAUqE,UAAUjC,GAAGvE,EACvCV,EAAO6C,UAAY5C,KAAK+T,kBAAkBhU,EAAO6C,WACjD5C,KAAKuX,UAAU5E,EAAYhQ,EAASxC,OAAQwC,EAASvC,OAAQuC,EAASoF,KAAMpF,EAASqF,KAG7FjI,GAAO6C,UAAYA,MAGnB5C,MAAKuX,UAAU5E,EAAYhQ,EAASxC,OAAQwC,EAASvC,OAAQuC,EAASoF,KAAMpF,EAASqF,KAErF2K,KAAe3S,KAAKwC,cACpBxC,KAAKuT,mBAAmBZ,EAE5B,MACJ,KAAK,OACD3S,KAAK0X,UAAU/E,EACf,MACJ,KAAK,cACL,IAAK,WACL,IAAK,WACL,IAAK,WACL,IAAK,WACL,IAAK,YACL,IAAK,YACGA,IAAe3S,KAAKqC,eACpBsQ,EAAa3S,KAAKwC,cAEtBxC,KAAK2X,cAAcZ,EAAcC,GACjCjX,EAAO0F,YAAYL,MAAQ,EAC3B,MACJ,SACIpF,KAAK2X,cAAcZ,EAAcC,GAGzChX,KAAKsT,cAAc,UAAWX,IAElClE,EAAK5N,UAAUsT,aAAe,WAC1B,GAAIpU,GAASC,KAAKD,MAClBA,GAAO6C,UAAUC,YAAY1C,QAAUJ,EAAOqD,IAAIC,SAClDtD,EAAO6C,UAAUC,YAAYzC,QAAUL,EAAOqD,IAAIE,QAClDvD,EAAO6C,UAAUC,YAAYkF,MAAQhI,EAAOqD,IAAIC,SAChDtD,EAAO6C,UAAUC,YAAYmF,MAAQjI,EAAOqD,IAAIE,QAChDvD,EAAO6C,UAAY5C,KAAK+T,kBAAkBhU,EAAO6C,YAErD6L,EAAK5N,UAAUkT,kBAAoB,SAAU9P,GAGzC,MAFAA,GAAIpB,YAAYxC,MAAQ4D,EAAIpB,YAAYkF,KAAO9D,EAAIpB,YAAY1C,OAC/D8D,EAAIpB,YAAYvC,OAAS2D,EAAIpB,YAAYmF,KAAO/D,EAAIpB,YAAYzC,OACzD6D,GAEXwK,EAAK5N,UAAUsV,kBAAoB,SAAUxD,GACzC,GAAI5S,GAASC,KAAKD,OACd4C,EAAW5C,EAAO6C,UAAUC,WAGhC,IAFA8P,EAAW6C,WAAa,EACxB7C,EAAWpI,YACoB,UAA3BxK,EAAO6C,UAAUwC,OAAgD,SAA3BrF,EAAO6C,UAAUwC,MACvDuN,EAAWkD,OAAOlT,EAASxC,OAAQwC,EAASvC,QAC5CuS,EAAWhI,IAAIhI,EAASxC,OAAQwC,EAASvC,OAAQL,EAAO6C,UAAUmS,gBAAgBrK,OAAQ,EAAG,EAAIvC,KAAKyC,IACtG+H,EAAWkD,OAAOlT,EAASoF,KAAMpF,EAASqF,MAC1C2K,EAAWhI,IAAIhI,EAASoF,KAAMpF,EAASqF,KAAMjI,EAAO6C,UAAUwS,mBAAmB1K,OAAQ,EAAG,EAAIvC,KAAKyC,QAEpG,IAA+B,SAA3B7K,EAAO6C,UAAUwC,MAAkB,CACxC,GAAIxC,GAAYoB,YAAWjE,EAAO6C,cAAe,EACjD,IAAIA,EAAUqE,UAAU9B,OAAS,EAC7B,IAAK,GAAIH,GAAI,EAAGC,EAAMrC,EAAUqE,UAAU9B,OAAQH,EAAIC,EAAKD,IACvDrC,EAASxC,OAASyC,EAAUqE,UAAUjC,EAAI,GAAGxE,EAC7CmC,EAASvC,OAASwC,EAAUqE,UAAUjC,EAAI,GAAGvE,EAC7CkC,EAASoF,KAAOnF,EAAUqE,UAAUjC,GAAGxE,EACvCmC,EAASqF,KAAOpF,EAAUqE,UAAUjC,GAAGvE,EACvCkS,EAAWkD,OAAOlT,EAASxC,OAAQwC,EAASvC,QAC5CuS,EAAWhI,IAAIhI,EAASxC,OAAQwC,EAASvC,OAAQL,EAAO6C,UAAUmS,gBAAgBrK,OAAQ,EAAG,EAAIvC,KAAKyC,IACtG+H,EAAWkD,OAAOlT,EAASoF,KAAMpF,EAASqF,MAC1C2K,EAAWhI,IAAIhI,EAASoF,KAAMpF,EAASqF,KAAMjI,EAAO6C,UAAUwS,mBAAmB1K,OAAQ,EAAG,EAAIvC,KAAKyC,GAG7G,IAAI3G,IAAQmB,MAAO,KACnBrF,GAAO+C,OAAO,aAAexB,KAAM,yBAA0BE,OAASyC,IAAKA,KACtD,SAAjBA,EAAW,QACXlE,EAAO6C,UAAYA,GAEvB+P,EAAWkD,OAAOlT,EAASxC,OAAQwC,EAASvC,QAC5CuS,EAAWhI,IAAIhI,EAASxC,OAAQwC,EAASvC,OAAQL,EAAO6C,UAAUmS,gBAAgBrK,OAAQ,EAAG,EAAIvC,KAAKyC,IACtG+H,EAAWkD,OAAOlT,EAASoF,KAAMpF,EAASqF,MAC1C2K,EAAWhI,IAAIhI,EAASoF,KAAMpF,EAASqF,KAAMjI,EAAO6C,UAAUwS,mBAAmB1K,OAAQ,EAAG,EAAIvC,KAAKyC,QAGrG5K,MAAK4X,oBAAoBjF,GACzBA,EAAWmD,OAAO/V,EAAO6C,UAAU0S,oBAAoB9U,EAAGT,EAAO6C,UAAU0S,oBAAoB7U,EAEnGkS,GAAWoD,SACXpD,EAAW7H,OACX6H,EAAW9H,YACoB,UAA3B9K,EAAO6C,UAAUwC,OAAgD,SAA3BrF,EAAO6C,UAAUwC,OAC5B,SAA3BrF,EAAO6C,UAAUwC,QACjBuN,EAAWpI,YACXoI,EAAWkD,OAAO9V,EAAO6C,UAAU0S,oBAAoB9U,EAAGT,EAAO6C,UAAU0S,oBAAoB7U,GAC/FkS,EAAWhI,IAAI5K,EAAO6C,UAAU0S,oBAAoB9U,EAAGT,EAAO6C,UAAU0S,oBAAoB7U,EAAGV,EAAO6C,UAAUwS,mBAAmB1K,OAAQ,EAAG,EAAIvC,KAAKyC,IACvJ+H,EAAWoD,SACXpD,EAAW7H,OACX6H,EAAW9H,aAEf8H,EAAW6C,WAAa,GAE5B/G,EAAK5N,UAAU+W,oBAAsB,SAAUjF,GAC3C,GAAI5S,GAASC,KAAKD,MACdkC,qBAAkBlC,EAAO6C,UAAUwT,sBACnCrW,EAAO6C,UAAUwT,mBAAqB,KAE1C,IAAInT,GACA4U,GAAmB,EACnBC,GAAiB,CAUrB,KARI7U,EADiC,IAAjClD,EAAO6C,UAAUsF,YACRnI,EAAOiD,UAAUC,OAGjBlD,EAAOiD,UAAUC,OAASlD,EAAO6C,UAAUsF,aAE3C,IACTjF,EAAS,IAAMA,GAEflD,EAAO6C,UAAUmV,YACjB,IAAK,GAAI/S,GAAI,EAAGC,EAAMlF,EAAO6C,UAAUmV,YAAY5S,OAAQH,EAAIC,EAAKD,IACV,eAAlDjF,EAAO6C,UAAUmV,YAAY/S,GAAG4N,cAChCiF,GAAmB,EAEoC,aAAlD9X,EAAO6C,UAAUmV,YAAY/S,GAAG4N,gBACrCkF,GAAiB,EAI7B,QAAQ7U,GACJ,IAAK,GACL,IAAK,KACG6U,GACA/X,EAAO6C,UAAU0S,qBAAwB9U,EAAGT,EAAO6C,UAAUmS,gBAAgB5U,OACzEM,EAAGV,EAAO6C,UAAUmS,gBAAgB3U,OAASL,EAAO6C,UAAUwT,oBAClEzD,EAAWkD,OAAO9V,EAAO6C,UAAU0S,oBAAoB9U,EAAGT,EAAO6C,UAAU0S,oBAAoB7U,EAAIV,EAAO6C,UAAUwT,sBAGpHrW,EAAO6C,UAAU0S,qBAAwB9U,EAAGT,EAAO6C,UAAUwS,mBAAmBjV,OAC5EM,EAAGV,EAAO6C,UAAUwS,mBAAmBhV,OAASL,EAAO6C,UAAUwT,oBACrEzD,EAAWkD,OAAO9V,EAAO6C,UAAU0S,oBAAoB9U,EAAGT,EAAO6C,UAAU0S,oBAAoB7U,EAAIV,EAAO6C,UAAUwT,oBAExH,MACJ,KAAK,IACL,KAAM,IACEyB,GACA9X,EAAO6C,UAAU0S,qBAAwB9U,EAAGT,EAAO6C,UAAUsS,kBAAkB/U,OACvEJ,EAAO6C,UAAUwT,mBAAoB3V,EAAGV,EAAO6C,UAAUqS,iBAAiB7U,QAClFuS,EAAWkD,OAAO9V,EAAO6C,UAAU0S,oBAAoB9U,EAAIT,EAAO6C,UAAUwT,mBAAoBrW,EAAO6C,UAAU0S,oBAAoB7U,KAGrIV,EAAO6C,UAAU0S,qBAAwB9U,EAAGT,EAAO6C,UAAUqS,iBAAiB9U,OACtEJ,EAAO6C,UAAUwT,mBAAoB3V,EAAGV,EAAO6C,UAAUqS,iBAAiB7U,QAClFuS,EAAWkD,OAAO9V,EAAO6C,UAAU0S,oBAAoB9U,EAAIT,EAAO6C,UAAUwT,mBAAoBrW,EAAO6C,UAAU0S,oBAAoB7U,GAEzI,MACJ,KAAK,KACL,KAAM,IACEqX,GACA/X,EAAO6C,UAAU0S,qBAAwB9U,EAAGT,EAAO6C,UAAUwS,mBAAmBjV,OAC5EM,EAAGV,EAAO6C,UAAUwS,mBAAmBhV,OAASL,EAAO6C,UAAUwT,oBACrEzD,EAAWkD,OAAO9V,EAAO6C,UAAU0S,oBAAoB9U,EAAGT,EAAO6C,UAAU0S,oBAAoB7U,EAAIV,EAAO6C,UAAUwT,sBAGpHrW,EAAO6C,UAAU0S,qBAAwB9U,EAAGT,EAAO6C,UAAUmS,gBAAgB5U,OACzEM,EAAGV,EAAO6C,UAAUmS,gBAAgB3U,OAASL,EAAO6C,UAAUwT,oBAClEzD,EAAWkD,OAAO9V,EAAO6C,UAAU0S,oBAAoB9U,EAAGT,EAAO6C,UAAU0S,oBAAoB7U,EAAIV,EAAO6C,UAAUwT,oBAExH,MACJ,KAAK,KACL,KAAM,GACEyB,GACA9X,EAAO6C,UAAU0S,qBAAwB9U,EAAGT,EAAO6C,UAAUqS,iBAAiB9U,OACtEJ,EAAO6C,UAAUwT,mBAAoB3V,EAAGV,EAAO6C,UAAUqS,iBAAiB7U,QAClFuS,EAAWkD,OAAO9V,EAAO6C,UAAU0S,oBAAoB9U,EAAIT,EAAO6C,UAAUwT,mBAAoBrW,EAAO6C,UAAU0S,oBAAoB7U,KAGrIV,EAAO6C,UAAU0S,qBAAwB9U,EAAGT,EAAO6C,UAAUsS,kBAAkB/U,OACvEJ,EAAO6C,UAAUwT,mBAAoB3V,EAAGV,EAAO6C,UAAUqS,iBAAiB7U,QAClFuS,EAAWkD,OAAO9V,EAAO6C,UAAU0S,oBAAoB9U,EAAIT,EAAO6C,UAAUwT,mBAAoBrW,EAAO6C,UAAU0S,oBAAoB7U,MAKrJgO,EAAK5N,UAAUuW,gBAAkB,SAAUzE,GACvC,GAAIjG,GACA3M,EAASC,KAAKD,OACd4C,EAAW5C,EAAO6C,UAAUC,gBACD4Q,KAA3B1T,EAAO6C,UAAUwC,QACjBsH,EAAa3M,EAAO6C,UAAUwC,MAAMuH,MAAM,MAExB,SAAlBD,EAAW,GACXiG,EAAW+C,YAAc,OAGzB/C,EAAW+C,YAAc3V,EAAO6C,UAAUmQ,eAAehE,YAE7D4D,EAAWpI,YACXoI,EAAWqD,KAAKrT,EAASxC,OAAQwC,EAASvC,OAAQuC,EAAStC,MAAOsC,EAASrC,QACzB,KAA9CP,EAAO6C,UAAUmQ,eAAe/D,YAChC2D,EAAWS,UAAYrT,EAAO6C,UAAUmQ,eAAe/D,UACvD2D,EAAW7H,QAEf6H,EAAWqD,KAAKrT,EAASxC,OAASJ,EAAO6C,UAAUmQ,eAAe9D,YAAatM,EAASvC,OAASL,EAAO6C,UAAUmQ,eAAe9D,YAAatM,EAAStC,MAAS,EAAIN,EAAO6C,UAAUmQ,eAAe9D,YAActM,EAASrC,OAAU,EAAIP,EAAO6C,UAAUmQ,eAAe9D,aACzQ0D,EAAWS,UAAYrT,EAAO6C,UAAUmQ,eAAehE,YACvD4D,EAAW7H,KAAK,WAChB6H,EAAW9H,aAEf4D,EAAK5N,UAAU8W,cAAgB,SAAUZ,EAAcC,GACnD,GAAIjX,GAASC,KAAKD,OACd4C,EAAW5C,EAAO6C,UAAUC,WAChC7C,MAAKwC,aAAakT,YAAc3V,EAAO4V,UAAU5V,EAAO6V,OAAqB,aAC7E5V,KAAKwC,aAAa+H,YAClBxK,EAAO6C,UAAUoV,iBAAoB7X,OAAQwC,EAASxC,OAAQC,OAAQuC,EAASvC,OACvE4W,EAAejP,KAAMpF,EAASoF,KAAMC,KAAMrF,EAASqF,KAAOgP,GAClEjX,EAAO6C,UAAUqV,oBAAuB9X,OAAQwC,EAASxC,OAAQC,OAAQuC,EAASvC,OAAU,EAAI4W,EAAgBjP,KAAMpF,EAASoF,KAAMC,KAAMrF,EAASqF,KAAQ,EAAIgP,GAChKjX,EAAO6C,UAAUsV,kBAAqB/X,OAAQwC,EAASxC,OAAS4W,EAC5D3W,OAAQuC,EAASvC,OAAQ2H,KAAMpF,EAASxC,OAAS4W,EACjD/O,KAAMrF,EAASqF,MACnBjI,EAAO6C,UAAUuV,mBAAsBhY,OAAQwC,EAASxC,OAAU,EAAI4W,EAClE3W,OAAQuC,EAASvC,OAAQ2H,KAAMpF,EAASxC,OAAU,EAAI4W,EACtD/O,KAAMrF,EAASqF,MACnBhI,KAAKwC,aAAaqT,OAAO9V,EAAO6C,UAAUoV,gBAAgB7X,OAAQJ,EAAO6C,UAAUoV,gBAAgB5X,QACnGJ,KAAKwC,aAAasT,OAAO/V,EAAO6C,UAAUoV,gBAAgBjQ,KAAMhI,EAAO6C,UAAUoV,gBAAgB5X,QACjGJ,KAAKwC,aAAaqT,OAAO9V,EAAO6C,UAAUqV,mBAAmB9X,OAAQJ,EAAO6C,UAAUqV,mBAAmB7X,QACzGJ,KAAKwC,aAAasT,OAAO/V,EAAO6C,UAAUqV,mBAAmBlQ,KAAMhI,EAAO6C,UAAUqV,mBAAmB7X,QACvGJ,KAAKwC,aAAaqT,OAAO9V,EAAO6C,UAAUsV,iBAAiB/X,OAAQJ,EAAO6C,UAAUsV,iBAAiB9X,QACrGJ,KAAKwC,aAAasT,OAAO/V,EAAO6C,UAAUsV,iBAAiBnQ,KAAMhI,EAAO6C,UAAUsV,iBAAiBlQ,MACnGhI,KAAKwC,aAAaqT,OAAO9V,EAAO6C,UAAUuV,kBAAkBhY,OAAQJ,EAAO6C,UAAUuV,kBAAkB/X,QACvGJ,KAAKwC,aAAasT,OAAO/V,EAAO6C,UAAUuV,kBAAkBpQ,KAAMhI,EAAO6C,UAAUuV,kBAAkBnQ,MACrGhI,KAAKwC,aAAauT,SAClB/V,KAAKwC,aAAaqI,aAEtB4D,EAAK5N,UAAUyW,YAAc,SAAU3E,EAAYsE,EAAgBC,GAC/D,GAAInX,GAASC,KAAKD,OACd4C,EAAW5C,EAAO6C,UAAUC,WAChC8P,GAAW+C,YAAc3V,EAAO4V,UAAU5V,EAAO6V,OAAqB,aACtEjD,EAAWxO,UAAU,EAAG,EAAGpE,EAAOqC,YAAY/B,MAAON,EAAOqC,YAAY9B,QACxEqS,EAAWS,UAAY,qBACvBT,EAAWU,SAAS,EAAG,EAAGtT,EAAOqC,YAAY/B,MAAON,EAAOqC,YAAY9B,OACvE,IAAI8X,GAAYzF,EAAW6C,SAC3B7C,GAAW6C,YACX7C,EAAWpI,YACXoI,EAAW0E,QAAQtX,EAAO6C,UAAUgK,WAAWzM,OAAU8W,EAAiB,EAAIlX,EAAO6C,UAAUgK,WAAWxM,OACnG8W,EAAkB,EAAID,EAAiB,EAAGC,EAAkB,EAAG,EAAG,EAAG,EAAI/O,KAAKyC,IAAI,GACzF+H,EAAWoD,SACXpD,EAAW9H,YACX8H,EAAW0F,OACX1F,EAAWpI,YACXoI,EAAWhI,KAAMhI,EAASoF,KAAOpF,EAASxC,QAAU,EAAKwC,EAASxC,QAAUwC,EAASqF,KAAOrF,EAASvC,QAAU,EAAKuC,EAASvC,OAASuC,EAAStC,MAAQ,EAAI,EAAa,EAAV8H,KAAKyC,IACnK+H,EAAW9H,YACX8H,EAAW2F,OACX3F,EAAWxO,UAAU,EAAG,EAAGpE,EAAOqC,YAAY/B,MAAON,EAAOqC,YAAY9B,QACxEqS,EAAW5H,UACX4H,EAAW6C,UAAY4C,EACvBpY,KAAKuT,mBAAmBZ,GAAY,GACpC5S,EAAO0F,YAAYL,MAAQ,IAE/BqJ,EAAK5N,UAAU0W,UAAY,SAAU5E,EAAY4F,EAAIC,EAAIC,EAAIC,GACzD,GAAIC,GAAgBhG,EAAW6C,SAC/B7C,GAAW6C,UAAaxV,KAAKD,OAAO6C,UAAUmQ,eAA2B,YACzEJ,EAAWpI,YACXoI,EAAWkD,OAAO0C,EAAIC,GACtB7F,EAAWmD,OAAO2C,EAAIC,GACtB/F,EAAWoD,SACXpD,EAAW6C,UAAYmD,GAE3BlK,EAAK5N,UAAU+X,kBAAoB,SAAUjG,EAAYnS,EAAGC,GACxD,GAAIkS,IAAe3S,KAAKqC,cAAgBsQ,IAAe3S,KAAKwC,aAAc,CACtE,GAAIyB,IAAQ5D,MAAO,EAAGC,OAAQ,EAC9BN,MAAKD,OAAO+C,OAAO,QAAUxB,KAAM,YAAayB,kBAAkB,EAC9DvB,OAASyC,IAAKA,EAAK+J,WAAa3N,MAAOsS,EAAWtN,OAAOhF,MAAOC,OAAQqS,EAAWtN,OAAO/E,UAC9F,IAAIwD,GAAQG,CACRzD,KACAA,GAAMsD,EAAY,OAElBrD,IACAA,GAAMqD,EAAa,QAG3B,OAAStD,EAAGA,EAAGC,EAAGA,IAEtBgO,EAAK5N,UAAUwP,MAAQ,SAAUsC,EAAY4D,GACzC,GAAIxW,GAASC,KAAKD,OACd4C,EAAW5C,EAAO6C,UAAUC,WAChC8P,GAAW6C,UAAazV,EAAO6C,UAAUmQ,eAA2B,WACpE,IAAIvS,GAAIR,KAAKmQ,eAAsB,MAAS,MACxC1P,EAAIT,KAAKmQ,eAAsB,MAAU,OACzChN,EAAQnD,KAAK4Y,kBAAkBjG,EAAYnS,EAAGC,EAClDD,GAAI2C,EAAM3C,EAAIT,EAAO6C,UAAUmQ,eAAe9D,YAC9CxO,EAAI0C,EAAM1C,EAAIV,EAAO6C,UAAUmQ,eAAe9D,YAC9CjP,KAAK6Y,GAAKlW,EAASoF,KAAOpF,EAASxC,OACnCH,KAAK8Y,GAAKnW,EAASqF,KAAOrF,EAASvC,OACnCuS,EAAWS,UAAYrT,EAAO6C,UAAUmQ,eAAehE,WACvD,IAAIgK,GAAQ5Q,KAAK6Q,MAAMhZ,KAAK8Y,GAAI9Y,KAAK6Y,KAChCtC,IAAiD,SAAvCxW,EAAO6C,UAAU4U,mBAAuE,UAAvCzX,EAAO6C,UAAU4U,oBAC9C,UAA3BzX,EAAO6C,UAAU2T,OAA8C,SAAzBxW,EAAO6C,UAAU4T,KAC5B,UAA3BzW,EAAO6C,UAAU2T,OAA8C,WAAzBxW,EAAO6C,UAAU4T,KAC3B,WAAzBzW,EAAO6C,UAAU4T,MACtBD,IAAmC,UAAzBxW,EAAO6C,UAAU4T,KAA8C,SAA3BzW,EAAO6C,UAAU2T,OAC/B,WAA3BxW,EAAO6C,UAAU2T,OAAiD,WAA3BxW,EAAO6C,UAAU2T,SAC/DvW,KAAKuX,UAAU5E,EAAYhQ,EAASxC,OAAQwC,EAASvC,OAAQuC,EAASoF,KAAMpF,EAASqF,MAEpFuO,GAAgD,SAAvCxW,EAAO6C,UAAU4U,oBACzBjB,GAAgD,UAAvCxW,EAAO6C,UAAU4U,mBAC5B7E,EAAWkB,UAAUlR,EAASoF,KAAMpF,EAASqF,MAC7C2K,EAAWmB,OAAOiF,GAClB/Y,KAAKuX,UAAU5E,EAAY,EAAG,GAAInS,EAAGC,EAAI,GACzCT,KAAKuX,UAAU5E,EAAY,EAAG,GAAInS,GAAIC,EAAI,GAC1CkS,EAAWmB,QAAQiF,GACnBpG,EAAWkB,WAAWlR,EAASoF,MAAOpF,EAASqF,QAEzCuO,GAAgD,UAAvCxW,EAAO6C,UAAU4U,oBAC9BjB,GAAgD,SAAvCxW,EAAO6C,UAAU4U,qBAC5B7E,EAAWkB,UAAUlR,EAASxC,OAAQwC,EAASvC,QAC/CuS,EAAWmB,OAAOiF,GAClB/Y,KAAKuX,UAAU5E,EAAY,EAAG,EAAGnS,EAAGC,EAAI,GACxCT,KAAKuX,UAAU5E,EAAY,EAAG,EAAGnS,GAAIC,EAAI,GACzCkS,EAAWmB,QAAQiF,GACnBpG,EAAWkB,WAAWlR,EAASxC,QAASwC,EAASvC,UAGzDqO,EAAK5N,UAAUyP,WAAa,SAAUqC,EAAY4D,GAC9C,GAAIxW,GAASC,KAAKD,OACd4C,EAAW5C,EAAO6C,UAAUC,YAC5BrC,EAAIR,KAAKmQ,eAA2B,WAAS,MAC7C1P,EAAIT,KAAKmQ,eAA2B,WAAU,OAC9ChN,EAAQnD,KAAK4Y,kBAAkBjG,EAAYnS,EAAGC,EAClDD,GAAI2C,EAAM3C,EAAIT,EAAO6C,UAAUmQ,eAAe9D,YAC9CxO,EAAI0C,EAAM1C,EAAIV,EAAO6C,UAAUmQ,eAAe9D,YAC9CjP,KAAK6Y,GAAKlW,EAASoF,KAAOpF,EAASxC,OACnCH,KAAK8Y,GAAKnW,EAASqF,KAAOrF,EAASvC,MACnC,IAAI2Y,GAAQ5Q,KAAK6Q,MAAMhZ,KAAK8Y,GAAI9Y,KAAK6Y,KAChCtC,GAAqC,eAA3BxW,EAAO6C,UAAU2T,OAAmD,SAAzBxW,EAAO6C,UAAU4T,KACxC,eAA3BzW,EAAO6C,UAAU2T,OAAmD,WAAzBxW,EAAO6C,UAAU4T,KAA6C,WAAzBzW,EAAO6C,UAAU4T,MACnGD,IAAmC,eAAzBxW,EAAO6C,UAAU4T,KAAmD,SAA3BzW,EAAO6C,UAAU2T,OACpC,WAA3BxW,EAAO6C,UAAU2T,OAAiD,WAA3BxW,EAAO6C,UAAU2T,SAC/DvW,KAAKuX,UAAU5E,EAAYhQ,EAASxC,OAAQwC,EAASvC,OAAQuC,EAASoF,KAAMpF,EAASqF,MAEpFuO,GAAgD,SAAvCxW,EAAO6C,UAAU4U,oBACzBjB,GAAgD,UAAvCxW,EAAO6C,UAAU4U,mBAC5B7E,EAAWkB,UAAUlR,EAASoF,KAAMpF,EAASqF,MAC7C2K,EAAWmB,OAAOiF,GAClBpG,EAAWpI,YACXoI,EAAWkD,OAAO9V,EAAO6C,UAAUmQ,eAAe9D,YAAa,GAC/D0D,EAAWmD,OAAYrV,EAAI,EAARD,EAAWC,EAAI,GAClCkS,EAAWmD,OAAYrV,EAAI,EAARD,GAAYC,EAAI,GACnCkS,EAAW9H,YACX8H,EAAW7H,OACX6H,EAAWmB,QAAQiF,GACnBpG,EAAWkB,WAAWlR,EAASoF,MAAOpF,EAASqF,MAC/CjI,EAAO6C,UAAUgR,aAAemF,IAE1BxC,GAAgD,UAAvCxW,EAAO6C,UAAU4U,oBAC9BjB,GAAgD,SAAvCxW,EAAO6C,UAAU4U,qBAC5B7E,EAAWkB,UAAUlR,EAASxC,OAAQwC,EAASvC,QAC/CuS,EAAWmB,OAAOiF,GAClBpG,EAAWpI,YACXoI,EAAWkD,OAAO,EAAI9V,EAAO6C,UAAUmQ,eAAe9D,YAAa,GACnE0D,EAAWmD,OAAOtV,EAAIC,EAAI,EAAGA,EAAI,GACjCkS,EAAWmD,OAAOtV,EAAIC,EAAI,GAAIA,EAAI,GAClCkS,EAAW9H,YACX8H,EAAW7H,OACX6H,EAAWmB,QAAQiF,GACnBpG,EAAWkB,WAAWlR,EAASxC,QAASwC,EAASvC,QACjDL,EAAO6C,UAAUgR,aAAemF,IAGxCtK,EAAK5N,UAAU+V,iBAAmB,SAAUjE,GACxC,GAAI5S,GAASC,KAAKD,OACd4C,EAAW5C,EAAO6C,UAAUC,aACA,WAA3B9C,EAAO6C,UAAU2T,OAA+C,SAAzBxW,EAAO6C,UAAU4T,KAC1B,WAA3BzW,EAAO6C,UAAU2T,OAA+C,WAAzBxW,EAAO6C,UAAU4T,KAC1B,WAA3BzW,EAAO6C,UAAU2T,OAAmD,gBAA3BxW,EAAO6C,UAAU2T,OAAoD,gBAAzBxW,EAAO6C,UAAU4T,MAC7GxW,KAAKuX,UAAU5E,EAAYhQ,EAASxC,OAAQwC,EAASvC,OAAQuC,EAASoF,KAAMpF,EAASqF,MAEzF2K,EAAW6C,UAAazV,EAAO6C,UAAUmQ,eAA2B,YACpEJ,EAAWpI,YACXoI,EAAWS,UAAYrT,EAAO6C,UAAUmQ,eAAehE,WACvD,IAAIvO,GAAIR,KAAKmQ,eAAuB,OAAS,MACzC1P,EAAIT,KAAKmQ,eAAuB,OAAU,OAC1ChN,EAAQnD,KAAK4Y,kBAAkBjG,EAAYnS,EAAGC,EAClDD,GAAI2C,EAAM3C,EAAIT,EAAO6C,UAAUmQ,eAAe9D,YAC9CxO,EAAI0C,EAAM1C,EAAIV,EAAO6C,UAAUmQ,eAAe9D,YAC9CjP,KAAK6Y,GAAKlW,EAASoF,KAAOpF,EAASxC,OACnCH,KAAK8Y,GAAKnW,EAASqF,KAAOrF,EAASvC,MACnC,IAAI2Y,GAAQ5Q,KAAK6Q,MAAMhZ,KAAK8Y,GAAI9Y,KAAK6Y,GACM,UAAvC9Y,EAAO6C,UAAU4U,mBACjB7E,EAAWkB,UAAUlR,EAASoF,KAAMpF,EAASqF,MAC7C2K,EAAWmB,OAAOiF,GACa,gBAA3BhZ,EAAO6C,UAAU2T,OACjB5D,EAAWU,SAAc5S,EAAI,EAARD,GAAYC,EAAI,EAAGD,EAAGC,GAE/CkS,EAAWsG,WAAgBxY,EAAI,EAARD,GAAYC,EAAI,EAAGD,EAAGC,GAC7CkS,EAAWmB,QAAQiF,GACnBpG,EAAWkB,WAAWlR,EAASoF,MAAOpF,EAASqF,MAC/ChI,KAAKkZ,uBAAyBvW,EAASoF,KAAQtH,EAAI,EAAK0H,KAAKgR,IAAIJ,GACjE/Y,KAAKoZ,uBAAyBzW,EAASqF,KAAQvH,EAAI,EAAK0H,KAAKkR,IAAIN,GAClC,WAA3BhZ,EAAO6C,UAAU2T,OAA+C,WAAzBxW,EAAO6C,UAAU4T,KAC5B,WAAzBzW,EAAO6C,UAAU4T,KAA6C,WAAzBzW,EAAO6C,UAAU4T,KACzDxW,KAAKuX,UAAU5E,EAAYhQ,EAASxC,OAAQwC,EAASvC,OAAQJ,KAAKkZ,uBAAwBlZ,KAAKoZ,wBAEpE,WAA3BrZ,EAAO6C,UAAU2T,OAA+C,WAAzBxW,EAAO6C,UAAU4T,KACxDxW,KAAKuX,UAAU5E,EAAY3S,KAAKsZ,qBAAsBtZ,KAAKuZ,qBAAsBvZ,KAAKkZ,uBAAwBlZ,KAAKoZ,wBAExF,gBAA3BrZ,EAAO6C,UAAU2T,OAAoD,gBAAzBxW,EAAO6C,UAAU4T,KAC7DxW,KAAKuX,UAAU5E,EAAYhQ,EAASxC,OAAQwC,EAASvC,OAAQuC,EAASoF,KAAMpF,EAASqF,OAG7C,UAAvCjI,EAAO6C,UAAU4U,oBACtB7E,EAAW6C,UAAazV,EAAO6C,UAAUmQ,eAA2B,YACpEJ,EAAWS,UAAYrT,EAAO6C,UAAUmQ,eAAehE,YACxB,gBAA3BhP,EAAO6C,UAAU2T,OAAoD,gBAAzBxW,EAAO6C,UAAU4T,KAC7DxW,KAAKuX,UAAU5E,EAAYhQ,EAASxC,OAAQwC,EAASvC,OAAQuC,EAASoF,KAAMpF,EAASqF,MAEzF2K,EAAWkB,UAAUlR,EAASxC,OAAQwC,EAASvC,QAC/CuS,EAAWmB,OAAOiF,GACa,gBAA3BhZ,EAAO6C,UAAU2T,OACjB5D,EAAWU,SAAS5S,EAAI,EAAID,GAAIC,EAAI,EAAGD,EAAGC,GAE9CkS,EAAWsG,WAAWxY,EAAI,EAAID,GAAIC,EAAI,EAAGD,EAAGC,GAC5CkS,EAAWmB,QAAQiF,GACnBpG,EAAWkB,WAAWlR,EAASxC,QAASwC,EAASvC,QACjDL,EAAO6C,UAAUgR,aAAemF,EAChC/Y,KAAKkZ,uBAAyBvW,EAASxC,OAAUM,EAAI,EAAK0H,KAAKgR,IAAIJ,GACnE/Y,KAAKoZ,uBAAyBzW,EAASvC,OAAUK,EAAI,EAAK0H,KAAKkR,IAAIN,GACpC,WAA3BhZ,EAAO6C,UAAU2T,OAA+C,WAAzBxW,EAAO6C,UAAU4T,KAC5B,WAAzBzW,EAAO6C,UAAU4T,KAA6C,WAAzBzW,EAAO6C,UAAU4T,KACzDxW,KAAKuX,UAAU5E,EAAYhQ,EAASoF,KAAMpF,EAASqF,KAAMhI,KAAKkZ,uBAAwBlZ,KAAKoZ,wBAEhE,WAA3BrZ,EAAO6C,UAAU2T,OAA+C,WAAzBxW,EAAO6C,UAAU4T,KACxDxW,KAAKuX,UAAU5E,EAAY3S,KAAKsZ,qBAAsBtZ,KAAKuZ,qBAAsBvZ,KAAKkZ,uBAAwBlZ,KAAKoZ,0BAI/H3K,EAAK5N,UAAUgW,eAAiB,SAAUlE,GACtC,GAAI5S,GAASC,KAAKD,OACd4C,EAAW5C,EAAO6C,UAAUC,YAC5BrC,EAAIR,KAAKmQ,eAAuB,OAAS,MACzC1P,EAAIT,KAAKmQ,eAAuB,OAAU,OAC1ChN,EAAQnD,KAAK4Y,kBAAkBjG,EAAYnS,EAAGC,EAClDD,GAAI2C,EAAM3C,EAAIT,EAAO6C,UAAUmQ,eAAe9D,YAC9CxO,EAAI0C,EAAM1C,EAAIV,EAAO6C,UAAUmQ,eAAe9D,YAC9CjP,KAAK6Y,GAAKlW,EAASoF,KAAOpF,EAASxC,OACnCH,KAAK8Y,GAAKnW,EAASqF,KAAOrF,EAASvC,MACnC,IAAI2Y,GAAQ5Q,KAAK6Q,MAAMhZ,KAAK8Y,GAAI9Y,KAAK6Y,GACrClG,GAAW6C,UAAazV,EAAO6C,UAAUmQ,eAA2B,YACzB,UAAvChT,EAAO6C,UAAU4U,mBACjB7E,EAAWS,UAAYrT,EAAO6C,UAAUmQ,eAAehE,YAC1B,gBAAzBhP,EAAO6C,UAAU4T,KAAoD,SAA3BzW,EAAO6C,UAAU2T,OAC3DvW,KAAKuX,UAAU5E,EAAYhQ,EAASxC,OAAQwC,EAASvC,OAAQuC,EAASoF,KAAMpF,EAASqF,MAEzF2K,EAAWkB,UAAUlR,EAASoF,KAAMpF,EAASqF,MAC7C2K,EAAWmB,OAAOiF,GACW,gBAAzBhZ,EAAO6C,UAAU4T,KACjB7D,EAAWU,SAAc5S,EAAI,EAARD,GAAYC,EAAI,EAAGD,EAAGC,GAE/CkS,EAAWsG,WAAgBxY,EAAI,EAARD,GAAYC,EAAI,EAAGD,EAAGC,GAC7CkS,EAAWmB,QAAQiF,GACnBpG,EAAWkB,WAAWlR,EAASoF,MAAOpF,EAASqF,MAC/CjI,EAAO6C,UAAUgR,aAAemF,EAChC/Y,KAAKwZ,qBAAuB7W,EAASoF,KAAQtH,EAAI,EAAK0H,KAAKgR,IAAIJ,GAC/D/Y,KAAKyZ,qBAAuB9W,EAASqF,KAAQvH,EAAI,EAAK0H,KAAKkR,IAAIN,GAClC,WAAzBhZ,EAAO6C,UAAU4T,KAA+C,WAA3BzW,EAAO6C,UAAU2T,OAAiD,WAA3BxW,EAAO6C,UAAU2T,OACjE,WAAzBxW,EAAO6C,UAAU4T,IACpBxW,KAAKuX,UAAU5E,EAAYhQ,EAASxC,OAAQwC,EAASvC,OAAQJ,KAAKwZ,qBAAsBxZ,KAAKyZ,sBAE5D,WAA3B1Z,EAAO6C,UAAU2T,OAAgD,WAAzBxW,EAAO6C,UAAU4T,IAC/DxW,KAAKuX,UAAU5E,EAAY3S,KAAKwZ,qBAAsBxZ,KAAKyZ,qBAAsBzZ,KAAK0Z,uBAAwB1Z,KAAK2Z,wBAElF,WAA3B5Z,EAAO6C,UAAU2T,OAAgD,WAAzBxW,EAAO6C,UAAU4T,KAC/DxW,KAAKuX,UAAU5E,EAAY3S,KAAKwZ,qBAAsBxZ,KAAKyZ,qBAAsBzZ,KAAKkZ,uBAAwBlZ,KAAKoZ,yBAG3E,SAAvCrZ,EAAO6C,UAAU4U,oBACtB7E,EAAWkB,UAAUlR,EAASxC,OAAQwC,EAASvC,QAC/CuS,EAAWmB,OAAOiF,GACW,gBAAzBhZ,EAAO6C,UAAU4T,KACjB7D,EAAWU,SAAS5S,EAAI,EAAID,GAAIC,EAAI,EAAGD,EAAGC,GAE9CkS,EAAWsG,WAAWxY,EAAI,EAAID,GAAIC,EAAI,EAAGD,EAAGC,GAC5CkS,EAAWmB,QAAQiF,GACnBpG,EAAWkB,WAAWlR,EAASxC,QAASwC,EAASvC,QACjDL,EAAO6C,UAAUgR,aAAemF,EAChC/Y,KAAKwZ,qBAAuB7W,EAASxC,OAAUM,EAAI,EAAK0H,KAAKgR,IAAIJ,GACjE/Y,KAAKyZ,qBAAuB9W,EAASvC,OAAUK,EAAI,EAAK0H,KAAKkR,IAAIN,GACpC,WAAzBhZ,EAAO6C,UAAU4T,KAA+C,WAA3BzW,EAAO6C,UAAU2T,OAC3B,WAA3BxW,EAAO6C,UAAU2T,OAA+C,WAAzBxW,EAAO6C,UAAU4T,IACxDxW,KAAKuX,UAAU5E,EAAYhQ,EAASoF,KAAMpF,EAASqF,KAAMhI,KAAKwZ,qBAAsBxZ,KAAKyZ,sBAExD,WAA3B1Z,EAAO6C,UAAU2T,OAAgD,WAAzBxW,EAAO6C,UAAU4T,IAC/DxW,KAAKuX,UAAU5E,EAAY3S,KAAKwZ,qBAAsBxZ,KAAKyZ,qBAAsBzZ,KAAK0Z,uBAAwB1Z,KAAK2Z,wBAElF,WAA3B5Z,EAAO6C,UAAU2T,OAAgD,WAAzBxW,EAAO6C,UAAU4T,KAC/DxW,KAAKuX,UAAU5E,EAAY3S,KAAKwZ,qBAAsBxZ,KAAKyZ,qBAAsBzZ,KAAKkZ,uBAAwBlZ,KAAKoZ,0BAI/H3K,EAAK5N,UAAU6V,YAAc,SAAU/D,EAAY4D,GAC/C,GAAIxW,GAASC,KAAKD,OACd4C,EAAW5C,EAAO6C,UAAUC,WAChC,IAAK0T,GAAgD,SAAvCxW,EAAO6C,UAAU4U,oBACzBjB,GAAgD,UAAvCxW,EAAO6C,UAAU4U,kBAAgC,CAC5D7E,EAAW6C,UAAazV,EAAO6C,UAAUmQ,eAA2B,WAChE6G,GAAe5Z,KAAKmQ,eAAuB,OAAS,KAExDyJ,IADIzW,EAAQnD,KAAK4Y,kBAAkBjG,EAAYiH,EAAc,OACxCpZ,EAAIT,EAAO6C,UAAUmQ,eAAe9D,YACzD0D,EAAWpI,YACXoI,EAAWhI,IAAIhI,EAASoF,KAAMpF,EAASqF,KAAM4R,EAAc,EAAG,EAAIzR,KAAKyC,IACvE+H,EAAWoD,SACXpD,EAAW9H,YACX7K,KAAK6Y,GAAKlW,EAASoF,KAAOpF,EAASxC,OACnCH,KAAK8Y,GAAKnW,EAASqF,KAAOrF,EAASvC,MAC/ByZ,GAAI7Z,KAAK6Y,GAAK7Y,KAAK6Y,GAAK7Y,KAAK8Y,GAAK9Y,KAAK8Y,EAO3C,KADIgB,GALAC,EAAI,GAAK/Z,KAAK6Y,IAAMlW,EAASxC,OAASwC,EAASoF,MAAQ/H,KAAK8Y,IAAMnW,EAASvC,OAASuC,EAASqF,QAK7E+R,EAAI,EAAIF,GAJxBG,GAAKrX,EAASxC,OAASwC,EAASoF,OAC/BpF,EAASxC,OAASwC,EAASoF,OAC3BpF,EAASvC,OAASuC,EAASqF,OACvBrF,EAASvC,OAASuC,EAASqF,MAAQ4R,EAAeA,KAE1C,EAAG,CAChBjH,EAAWS,UAAYrT,EAAO6C,UAAUmQ,eAAehE,WACvD,IAAIkL,KAAOF,EAAI5R,KAAK+R,KAAKJ,KAAe,EAAID,GACxCM,EAAiBxX,EAASxC,OAASH,KAAK6Y,GAAKoB,EAC7CG,EAAiBzX,EAASvC,OAASJ,KAAK8Y,GAAKmB,CAC7C1D,IACAvW,KAAK0Z,uBAAyBS,EAC9Bna,KAAK2Z,uBAAyBS,EAC9BzH,EAAWpI,YACXoI,EAAW7H,OACX6H,EAAWpI,YACoB,WAA3BxK,EAAO6C,UAAU2T,OAA+C,WAAzBxW,EAAO6C,UAAU4T,IACxDxW,KAAKuX,UAAU5E,EAAY3S,KAAK0Z,uBAAwB1Z,KAAK2Z,uBAAwB3Z,KAAKsZ,qBAAsBtZ,KAAKuZ,sBAErF,WAA3BxZ,EAAO6C,UAAU2T,OAA+C,WAAzBxW,EAAO6C,UAAU4T,KAA6C,WAAzBzW,EAAO6C,UAAU4T,KAClGxW,KAAKuX,UAAU5E,EAAYhQ,EAASxC,OAAQwC,EAASvC,OAAQJ,KAAK0Z,uBAAwB1Z,KAAK2Z,wBAEnGhH,EAAWoD,SACXpD,EAAW9H,cAGX7K,KAAKsZ,qBAAuBa,EAC5Bna,KAAKuZ,qBAAuBa,EACC,WAAzBra,EAAO6C,UAAU4T,KAAgD,WAA3BzW,EAAO6C,UAAU2T,OAAiD,WAA3BxW,EAAO6C,UAAU2T,OAC9FvW,KAAKuX,UAAU5E,EAAYhQ,EAASxC,OAAQwC,EAASvC,OAAQJ,KAAKsZ,qBAAsBtZ,KAAKuZ,uBAIrGR,EAAQ5Q,KAAK6Q,MAAMhZ,KAAK8Y,GAAI9Y,KAAK6Y,GACrC9Y,GAAO6C,UAAUgR,aAAemF,MAE/B,IAAKxC,GAAgD,UAAvCxW,EAAO6C,UAAU4U,oBAC9BjB,GAAgD,SAAvCxW,EAAO6C,UAAU4U,kBAA+B,CAC3D7E,EAAW6C,UAAazV,EAAO6C,UAAUmQ,eAA2B,WACpE,IAAI6G,GAAe5Z,KAAKmQ,eAAuB,OAAS,MACpDhN,EAAQnD,KAAK4Y,kBAAkBjG,EAAYiH,EAAc,KAC7DA,GAAezW,EAAM3C,EAAIT,EAAO6C,UAAUmQ,eAAe9D,YACzD0D,EAAWpI,YACXoI,EAAWhI,IAAIhI,EAASxC,OAAQwC,EAASvC,OAAQwZ,EAAc,EAAG,EAAIzR,KAAKyC,IAC3E+H,EAAWoD,SACXpD,EAAW9H,YACX7K,KAAK6Y,GAAKlW,EAASxC,OAASwC,EAASoF,KACrC/H,KAAK8Y,GAAKnW,EAASvC,OAASuC,EAASqF,IACrC,IAAI6R,GAAI7Z,KAAK6Y,GAAK7Y,KAAK6Y,GAAK7Y,KAAK8Y,GAAK9Y,KAAK8Y,GACvCiB,EAAI,GAAK/Z,KAAK6Y,IAAMlW,EAASoF,KAAOpF,EAASxC,QAC7CH,KAAK8Y,IAAMnW,EAASqF,KAAOrF,EAASvC,SACpC4Z,GAAKrX,EAASoF,KAAOpF,EAASxC,SAC7BwC,EAASoF,KAAOpF,EAASxC,SACzBwC,EAASqF,KAAOrF,EAASvC,SACrBuC,EAASqF,KAAOrF,EAASvC,QAAUwZ,EAAeA,EACvDE,EAAYC,EAAIA,EAAI,EAAIF,EAAIG,CAChC,IAAIF,GAAa,EAAG,CAChBnH,EAAWS,UAAYrT,EAAO6C,UAAUmQ,eAAehE,WACvD,IAAIkL,KAAOF,EAAI5R,KAAK+R,KAAKJ,KAAe,EAAID,GACxCM,EAAiBxX,EAASoF,KAAO/H,KAAK6Y,GAAKoB,EAC3CG,EAAiBzX,EAASqF,KAAOhI,KAAK8Y,GAAKmB,CAC3C1D,IACAvW,KAAK0Z,uBAAyBS,EAC9Bna,KAAK2Z,uBAAyBS,EACC,WAA3Bra,EAAO6C,UAAU2T,OAA+C,WAAzBxW,EAAO6C,UAAU4T,IACxDxW,KAAKuX,UAAU5E,EAAY3S,KAAKsZ,qBAAsBtZ,KAAKuZ,qBAAsBvZ,KAAK0Z,uBAAwB1Z,KAAK2Z,wBAEnF,WAA3B5Z,EAAO6C,UAAU2T,OAA+C,WAAzBxW,EAAO6C,UAAU4T,KAA6C,WAAzBzW,EAAO6C,UAAU4T,KAClGxW,KAAKuX,UAAU5E,EAAYhQ,EAASoF,KAAMpF,EAASqF,KAAMhI,KAAK0Z,uBAAwB1Z,KAAK2Z,0BAI/F3Z,KAAKsZ,qBAAuBa,EAC5Bna,KAAKuZ,qBAAuBa,EAC5BzH,EAAWpI,YACXoI,EAAW7H,OACX6H,EAAWpI,YACkB,WAAzBxK,EAAO6C,UAAU4T,KAAgD,WAA3BzW,EAAO6C,UAAU2T,OAAiD,WAA3BxW,EAAO6C,UAAU2T,OAC9FvW,KAAKuX,UAAU5E,EAAYhQ,EAASoF,KAAMpF,EAASqF,KAAMhI,KAAKsZ,qBAAsBtZ,KAAKuZ,uBAIrG,GAAIR,GAAQ5Q,KAAK6Q,MAAMhZ,KAAK8Y,GAAI9Y,KAAK6Y,GACrC9Y,GAAO6C,UAAUgR,aAAemF,IAGxCtK,EAAK5N,UAAU4V,iBAAmB,SAAU9D,EAAY4D,GACpD,GAAIxW,GAASC,KAAKD,OACd4C,EAAW5C,EAAO6C,UAAUC,WAChC,IAAK0T,GAAgD,SAAvCxW,EAAO6C,UAAU4U,oBACzBjB,GAAgD,UAAvCxW,EAAO6C,UAAU4U,kBAAgC,CAC5D7E,EAAW6C,UAAazV,EAAO6C,UAAUmQ,eAA2B,YACpEJ,EAAWpI,YACXoI,EAAWS,UAAYrT,EAAO6C,UAAUmQ,eAAehE,aAClDwH,GAAqC,gBAA3BxW,EAAO6C,UAAU2T,OAAoD,SAAzBxW,EAAO6C,UAAU4T,KAC5C,gBAA3BzW,EAAO6C,UAAU2T,OAAoD,WAAzBxW,EAAO6C,UAAU4T,KAA6C,WAAzBzW,EAAO6C,UAAU4T,MACjGD,GAAmC,gBAAzBxW,EAAO6C,UAAU4T,KAAoD,SAA3BzW,EAAO6C,UAAU2T,QACvEvW,KAAKuX,UAAU5E,EAAYhQ,EAASxC,OAAQwC,EAASvC,OAAQuC,EAASoF,KAAMpF,EAASqF,KAErF4R,GAAe5Z,KAAKmQ,eAAuB,OAAS,KAExDyJ,IADIzW,EAAQnD,KAAK4Y,kBAAkBjG,EAAYiH,EAAc,OACxCpZ,EAAIT,EAAO6C,UAAUmQ,eAAe9D,YACzDjP,KAAK6Y,GAAKlW,EAASoF,KAAOpF,EAASxC,OACnCH,KAAK8Y,GAAKnW,EAASqF,KAAOrF,EAASvC,OACnCuS,EAAW0F,OACX1F,EAAWpI,YACXoI,EAAWhI,IAAIhI,EAASoF,KAAMpF,EAASqF,KAAM4R,EAAc,EAAG,EAAIzR,KAAKyC,IACvE+H,EAAWoD,SACXpD,EAAW7H,OACX6H,EAAW9H,YACX9K,EAAO6C,UAAUgR,aAAezL,KAAK6Q,MAAMhZ,KAAK8Y,GAAI9Y,KAAK6Y,QAExD,IAAKtC,GAAgD,UAAvCxW,EAAO6C,UAAU4U,oBAC9BjB,GAAgD,SAAvCxW,EAAO6C,UAAU4U,kBAA+B,CAC3D7E,EAAW6C,UAAazV,EAAO6C,UAAUmQ,eAA2B,YACpEJ,EAAWpI,YACXoI,EAAWS,UAAYrT,EAAO6C,UAAUmQ,eAAehE,aAClDwH,GAAqC,gBAA3BxW,EAAO6C,UAAU2T,OAAoD,SAAzBxW,EAAO6C,UAAU4T,KAC5C,gBAA3BzW,EAAO6C,UAAU2T,OAAoD,WAAzBxW,EAAO6C,UAAU4T,KAA6C,WAAzBzW,EAAO6C,UAAU4T,MAClGD,GAAmC,gBAAzBxW,EAAO6C,UAAU4T,KAAoD,SAA3BzW,EAAO6C,UAAU2T,QACtEvW,KAAKuX,UAAU5E,EAAYhQ,EAASxC,OAAQwC,EAASvC,OAAQuC,EAASoF,KAAMpF,EAASqF,KAEzF,IAAI4R,GAAe5Z,KAAKmQ,eAAuB,OAAS,MACpDhN,EAAQnD,KAAK4Y,kBAAkBjG,EAAYiH,EAAc,KAC7DA,GAAezW,EAAM3C,EAAIT,EAAO6C,UAAUmQ,eAAe9D,YACzDjP,KAAK6Y,GAAKlW,EAASoF,KAAOpF,EAASxC,OACnCH,KAAK8Y,GAAKnW,EAASqF,KAAOrF,EAASvC,OACnCuS,EAAW0F,OACX1F,EAAWpI,YACXoI,EAAWhI,IAAIhI,EAASxC,OAAQwC,EAASvC,OAAQwZ,EAAc,EAAG,EAAIzR,KAAKyC,IAC3E+H,EAAWoD,SACXpD,EAAW7H,OACX6H,EAAW9H,YACX9K,EAAO6C,UAAUgR,aAAezL,KAAK6Q,MAAMhZ,KAAK8Y,GAAI9Y,KAAK6Y,MAGjEpK,EAAK5N,UAAU8V,SAAW,SAAUhE,EAAY4D,GAC5C,GAAIxW,GAASC,KAAKD,OACd4C,EAAW5C,EAAO6C,UAAUC,WAChC,IAAK0T,GAAgD,SAAvCxW,EAAO6C,UAAU4U,oBACzBjB,GAAgD,UAAvCxW,EAAO6C,UAAU4U,kBAAgC,CAC5D7E,EAAW6C,UAAazV,EAAO6C,UAAUmQ,eAA2B,YACpEJ,EAAWpI,YACXoI,EAAWS,UAAYrT,EAAO6C,UAAUmQ,eAAehE,aAClDwH,GAAqC,QAA3BxW,EAAO6C,UAAU2T,OAA4C,SAAzBxW,EAAO6C,UAAU4T,KACpC,QAA3BzW,EAAO6C,UAAU2T,OAA6C,WAAzBxW,EAAO6C,UAAU4T,KAA6C,WAAzBzW,EAAO6C,UAAU4T,MAC1FD,IAAoC,QAAzBxW,EAAO6C,UAAU4T,KAA4C,SAA3BzW,EAAO6C,UAAU2T,OAClC,QAAzBxW,EAAO6C,UAAU4T,KAA6C,WAA3BzW,EAAO6C,UAAU2T,OAAiD,WAA3BxW,EAAO6C,UAAU2T,SAChGvW,KAAKuX,UAAU5E,EAAYhQ,EAASxC,OAAQwC,EAASvC,OAAQuC,EAASoF,KAAMpF,EAASqF,KAEzF,IAAIxH,GAAIR,KAAKmQ,eAAoB,IAAS,MACtC1P,EAAIT,KAAKmQ,eAAoB,IAAU,MAE3C3P,IADI2C,EAAQnD,KAAK4Y,kBAAkBjG,EAAYnS,EAAGC,IACxCD,EAAIT,EAAO6C,UAAUmQ,eAAe9D,YAC9CxO,EAAI0C,EAAM1C,EAAIV,EAAO6C,UAAUmQ,eAAe9D,YAC9CjP,KAAK6Y,GAAKlW,EAASoF,KAAOpF,EAASxC,OACnCH,KAAK8Y,GAAKnW,EAASqF,KAAOrF,EAASvC,MAC/B2Y,GAAQ5Q,KAAK6Q,MAAMhZ,KAAK8Y,GAAI9Y,KAAK6Y,GACrClG,GAAWkB,UAAUlR,EAASoF,KAAMpF,EAASqF,MAC7C2K,EAAWmB,OAAOiF,GAClBpG,EAAWU,SAAc5S,EAAI,EAARD,GAAYC,EAAI,EAAGD,EAAGC,GAC3CkS,EAAWmB,QAAQiF,GACnBpG,EAAWkB,WAAWlR,EAASoF,MAAOpF,EAASqF,MAC/CjI,EAAO6C,UAAUgR,aAAemF,MAE/B,IAAKxC,GAAgD,UAAvCxW,EAAO6C,UAAU4U,oBAC9BjB,GAAgD,SAAvCxW,EAAO6C,UAAU4U,kBAA+B,CAC3D7E,EAAW6C,UAAazV,EAAO6C,UAAUmQ,eAA2B,YACpEJ,EAAWpI,YACXoI,EAAWS,UAAYrT,EAAO6C,UAAUmQ,eAAehE,aAClDwH,GAAqC,QAA3BxW,EAAO6C,UAAU2T,OAA4C,SAAzBxW,EAAO6C,UAAU4T,KACjC,QAA3BzW,EAAO6C,UAAU2T,OAA6C,WAAzBxW,EAAO6C,UAAU4T,KAA6C,WAAzBzW,EAAO6C,UAAU4T,MAC7FD,GAAmC,QAAzBxW,EAAO6C,UAAU4T,KAA4C,SAA3BzW,EAAO6C,UAAU2T,QAC/DvW,KAAKuX,UAAU5E,EAAYhQ,EAASxC,OAAQwC,EAASvC,OAAQuC,EAASoF,KAAMpF,EAASqF,KAEzF,IAAIxH,GAAIR,KAAKmQ,eAAoB,IAAS,MACtC1P,EAAIT,KAAKmQ,eAAoB,IAAU,OACvChN,EAAQnD,KAAK4Y,kBAAkBjG,EAAYnS,EAAGC,EAClDD,GAAI2C,EAAM3C,EAAIT,EAAO6C,UAAUmQ,eAAe9D,YAC9CxO,EAAI0C,EAAM1C,EAAIV,EAAO6C,UAAUmQ,eAAe9D,YAC9CjP,KAAK6Y,GAAKlW,EAASoF,KAAOpF,EAASxC,OACnCH,KAAK8Y,GAAKnW,EAASqF,KAAOrF,EAASvC,MACnC,IAAI2Y,GAAQ5Q,KAAK6Q,MAAMhZ,KAAK8Y,GAAI9Y,KAAK6Y,GACrClG,GAAWkB,UAAUlR,EAASxC,OAAQwC,EAASvC,QAC/CuS,EAAWmB,OAAOiF,GAClBpG,EAAWU,SAAS5S,EAAI,EAAID,GAAIC,EAAI,EAAGD,EAAGC,GAC1CkS,EAAWmB,QAAQiF,GACnBpG,EAAWkB,WAAWlR,EAASxC,QAASwC,EAASvC,QACjDL,EAAO6C,UAAUgR,aAAemF,IAGxCtK,EAAK5N,UAAU6W,UAAY,SAAU/E,GAMjC,IAAK,GALD5S,GAASC,KAAKD,OACd4C,EAAW5C,EAAO6C,UAAUC,YAC5BwX,EAAOta,EAAO6C,UAAUuQ,WAAWxG,MAAM,MAEzC2N,IADSva,EAAO6C,UAAUyF,aAAaE,SAAoD,IAAzCxI,EAAO6C,UAAUyF,aAAaE,UACxD8R,EAAKlV,OAAWpF,EAAO6C,UAAUyF,aAAaE,SAAW8R,EAAKlV,QAAWkV,EAAKlV,OACjGH,EAAI,EAAGA,EAAIqV,EAAKlV,OAAQH,IAAK,CAClC,GAAImK,GAAOkL,EAAKrV,GACZuV,GAAWvV,EAAI,GAAKjF,EAAO6C,UAAUyF,aAAaE,SAAW,IAASvD,EAAIsV,GAC7C,MAA7Bva,EAAOiD,UAAUC,SACjBlD,EAAOiD,UAAUC,OAAS,GAEE,IAA5BlD,EAAOiD,UAAUC,QAA4C,MAA5BlD,EAAOiD,UAAUC,OAC9ClD,EAAO6C,UAAUyF,aAAaE,SAAW5F,EAASrC,SAClDP,EAAO6C,UAAUyF,aAAaE,SAAW5F,EAASrC,OAC3B,GAAlBqC,EAASrC,QAIdP,EAAO6C,UAAUyF,aAAaE,SAAW5F,EAAStC,QAClDN,EAAO6C,UAAUyF,aAAaE,SAAW5F,EAAStC,MAC5B,GAAjBsC,EAAStC,OAGtBsS,EAAW+C,YAAc3V,EAAO6C,UAAUmQ,eAAehE,YACzD4D,EAAWS,UAAYrT,EAAO6C,UAAUmQ,eAAehE,WACvD,IAAIyL,GAAY,EACZza,GAAO6C,UAAUyF,aAAagH,OAC9BmL,EAAY,SAEZza,EAAO6C,UAAUyF,aAAaiH,SAC9BkL,EAAY,WAEZza,EAAO6C,UAAUyF,aAAagH,MAAQtP,EAAO6C,UAAUyF,aAAaiH,SACpEkL,EAAY,gBAEhB7H,EAAW8H,KAAOD,EAAYza,EAAO6C,UAAUyF,aAAaE,SAAW,MACnExI,EAAO6C,UAAUyF,aAAa+G,WACU,IAAxCrP,EAAO6C,UAAUmV,YAAY5S,SAC7BpF,EAAO6C,UAAUmV,eACjBhY,EAAO6C,UAAUmE,UAAY,GAEjC,KAAK,GAAI2T,GAAI,EAAGzV,EAAMlF,EAAO6C,UAAUmV,YAAY5S,OAAQuV,EAAIzV,EAAKyV,IACV,eAAlD3a,EAAO6C,UAAUmV,YAAY2C,GAAG9H,eAChCD,EAAWkB,UAAUlB,EAAWtN,OAAOhF,MAAO,GAC9CsS,EAAWgI,OAAO,EAAG,GACrBhY,EAAW3C,KAAK4a,eAAe,aAAcjI,IAEU,aAAlD5S,EAAO6C,UAAUmV,YAAY2C,GAAG9H,gBACrCD,EAAWkB,UAAU,EAAGlB,EAAWtN,OAAO/E,QAC1CqS,EAAWgI,MAAM,GAAI,GACrBhY,EAAW3C,KAAK4a,eAAe,WAAYjI,GAG/C5S,GAAO6C,UAAUsF,cAAgBnI,EAAOiD,UAAUC,OAClDjD,KAAK6a,WAAWlI,GAGhBA,EAAWmI,SAAS3L,EAAMxM,EAASxC,OAAkD,GAAzCJ,EAAO6C,UAAUyF,aAAaE,SAAgB5F,EAASvC,OAASma,EAEhH,KAAK,GAAIQ,GAAI,EAAG9V,EAAMlF,EAAO6C,UAAUmV,YAAY5S,OAAQ4V,EAAI9V,EAAK8V,IACV,eAAlDhb,EAAO6C,UAAUmV,YAAYgD,GAAGnI,eAChCD,EAAWkB,UAAUlB,EAAWtN,OAAOhF,MAAO,GAC9CsS,EAAWgI,OAAO,EAAG,GACrBhY,EAAW3C,KAAK4a,eAAe,aAAcjI,IAEU,aAAlD5S,EAAO6C,UAAUmV,YAAYgD,GAAGnI,gBACrCD,EAAWkB,UAAU,EAAGlB,EAAWtN,OAAO/E,QAC1CqS,EAAWgI,MAAM,GAAI,GACrBhY,EAAW3C,KAAK4a,eAAe,WAAYjI,IAIvD5S,EAAO0F,YAAYwN,QAAS,GAEhCxE,EAAK5N,UAAU+Z,eAAiB,SAAU3X,EAAQ0P,GAC9C,GAAI5S,GAASC,KAAKD,OACd4C,EAAW5C,EAAO6C,UAAUC,WA4BhC,OA3B6B,eAAzBI,EAAO2P,cACHjQ,EAASxC,QAAUwS,EAAWtN,OAAOhF,MAAQ,GAC7CsC,EAASxC,OAASwS,EAAWtN,OAAOhF,MAAQ,GAAMsS,EAAWtN,OAAOhF,MAAQ,EACxEsC,EAASoF,MACbpF,EAASoF,KAAOpF,EAASxC,OACrBwC,EAAStC,MACbL,KAAK4Q,mBAAmBjO,EAAU5C,EAAO6C,YAEpCD,EAASxC,QAAUwS,EAAWtN,OAAOhF,MAAQ,IAClDsC,EAASxC,OAASwS,EAAWtN,OAAOhF,MAAQsC,EAASoF,KACrDpF,EAASoF,KAAOpF,EAASxC,OACrBwC,EAAStC,MACbL,KAAK4Q,mBAAmBjO,EAAU5C,EAAO6C,YAGf,aAAzBK,EAAO2P,gBACRjQ,EAASvC,QAAUuS,EAAWtN,OAAO/E,OAAS,GAC9CqC,EAASvC,OAASuS,EAAWtN,OAAO/E,OAAS,GAAMqS,EAAWtN,OAAO/E,OAAS,EAAKqC,EAASqF,MAC5FrF,EAASqF,KAAOrF,EAASvC,OAASuC,EAASrC,OAC3CN,KAAK4Q,mBAAmBjO,EAAU5C,EAAO6C,YAEpCD,EAASvC,QAAUuS,EAAWtN,OAAO/E,OAAS,IACnDqC,EAASvC,OAASuS,EAAWtN,OAAO/E,OAASqC,EAASqF,KACtDrF,EAASqF,KAAOrF,EAASvC,OAASuC,EAASrC,OAC3CN,KAAK4Q,mBAAmBjO,EAAU5C,EAAO6C,aAG1CD,GAEX8L,EAAK5N,UAAUga,WAAa,SAAUlI,GAClC,GAGI1P,GAHAlD,EAASC,KAAKD,OACdI,EAASJ,EAAO6C,UAAUC,YAAY1C,OACtCC,EAASL,EAAO6C,UAAUC,YAAYzC,OAEtCuC,EAAW5C,EAAO6C,UAAUC,WAahC,KANgB,OALZI,EADiC,IAAjClD,EAAO6C,UAAUsF,YACRnI,EAAOiD,UAAUC,OAGjBlD,EAAOiD,UAAUC,OAASlD,EAAO6C,UAAUsF,eAGpDjF,GAAU,IAEVA,EAAS,IACTA,EAAS,IAAMA,GAEfA,EAAS,KAAQ,IAAmC,MAA7BlD,EAAOiD,UAAUC,QAAsD,KAAnClD,EAAOiD,UAAUU,cASvET,EAAS,IAAO,GAAKA,EAAS,KAAQ,GAC3C0P,EAAWkB,UAAU9T,EAAOqC,YAAY/B,MAAQ,EAAGN,EAAOqC,YAAY9B,OAAS,GAC/EqS,EAAWmB,OAAO3L,KAAKyC,GAAK,IAAM3H,GAClC0P,EAAWkB,WAAW9T,EAAOqC,YAAY9B,OAAS,GAAIP,EAAOqC,YAAY/B,MAAQ,GAC7E4C,EAAS,IAAO,GAAKA,EAAS,KAAQ,GACtC7C,EAAUL,EAAOqC,YAAY/B,MAAQsC,EAASoF,KACD,GAAzChI,EAAO6C,UAAUyF,aAAaE,SAClCpI,EAASwC,EAASvC,QAEb6C,EAAS,KAAQ,IACtB9C,EAASJ,EAAOqC,YAAY9B,OAASqC,EAASqF,KAC9C5H,EAASuC,EAASxC,OAAkD,GAAzCJ,EAAO6C,UAAUyF,aAAaE,UAE7DvI,KAAKgb,eAAerI,EAAYxS,EAAQC,GACxCuS,EAAWkB,UAAU9T,EAAOqC,YAAY9B,OAAS,EAAGP,EAAOqC,YAAY/B,MAAQ,GAC/EsS,EAAWmB,OAAO3L,KAAKyC,GAAK,KAAO3H,GACnC0P,EAAWkB,WAAW9T,EAAOqC,YAAY/B,MAAQ,GAAIN,EAAOqC,YAAY9B,OAAS,KAGjFqS,EAAWkB,UAAU9T,EAAOqC,YAAY/B,MAAQ,EAAGN,EAAOqC,YAAY9B,OAAS,GAC/EqS,EAAWmB,OAAO3L,KAAKyC,GAAK,IAAM3H,GAClC9C,EAASJ,EAAOqC,YAAY/B,MAAQsC,EAASoF,KAC7C3H,EAAUL,EAAOqC,YAAY9B,OAASqC,EAASqF,KACF,GAAzCjI,EAAO6C,UAAUyF,aAAaE,SAClCoK,EAAWkB,WAAW9T,EAAOqC,YAAY/B,MAAQ,GAAIN,EAAOqC,YAAY9B,OAAS,GACjFN,KAAKgb,eAAerI,EAAYxS,EAAQC,GACxCuS,EAAWkB,UAAU9T,EAAOqC,YAAY/B,MAAQ,EAAGN,EAAOqC,YAAY9B,OAAS,GAC/EqS,EAAWmB,OAAO3L,KAAKyC,GAAK,KAAO3H,GACnC0P,EAAWkB,WAAW9T,EAAOqC,YAAY/B,MAAQ,GAAIN,EAAOqC,YAAY9B,OAAS,QArCkB,CACnGH,EAASwC,EAASxC,OAAkD,IAAzCJ,EAAO6C,UAAUyF,aAAaE,SACzDnI,EAASuC,EAASvC,QAAUuC,EAASqF,KAAOrF,EAASvC,OAErD,KAAK,GADDia,GAAOta,EAAO6C,UAAUuQ,WAAWxG,MAAM,MACpC3H,EAAI,EAAGA,EAAIqV,EAAKlV,OAAQH,IAC7B5E,EAASuC,EAASvC,QAAU4E,EAAIjF,EAAO6C,UAAUyF,aAAaE,SAAoD,IAAzCxI,EAAO6C,UAAUyF,aAAaE,UACvGoK,EAAWmI,SAAST,EAAKrV,GAAI7E,EAAQC,GAiCb,MAA5BL,EAAOiD,UAAUC,SAA+C,MAA7BlD,EAAOiD,UAAUC,SACpDlD,EAAOiD,UAAUC,OAAS,IAGlCwL,EAAK5N,UAAUma,eAAiB,SAAUrI,EAAYxS,EAAQC,GAM1D,IAAK,GALDL,GAASC,KAAKD,OACdsa,EAAOta,EAAO6C,UAAUuQ,WAAWxG,MAAM,MAEzC2N,GADSva,EAAO6C,UAAUyF,aAAaE,SACf8R,EAAKlV,OAAWpF,EAAO6C,UAAUyF,aAAaE,SAAW8R,EAAKlV,QAAWkV,EAAKlV,OACtGoV,EAAmD,IAAzCxa,EAAO6C,UAAUyF,aAAaE,SAAmB+R,EACtDtV,EAAI,EAAGA,EAAIqV,EAAKlV,OAAQH,IAAK,CAClC,GAAImK,GAAOkL,EAAKrV,EACZA,GAAI,IACM,IAANA,IACAuV,GAAoD,IAAzCxa,EAAO6C,UAAUyF,aAAaE,UAE7CgS,GAAUxa,EAAO6C,UAAUyF,aAAaE,SAAoD,IAAzCxI,EAAO6C,UAAUyF,aAAaE,UAErFoK,EAAWmI,SAAS3L,EAAMhP,EAAkD,IAAzCJ,EAAO6C,UAAUyF,aAAaE,SAAiBnI,EAC9Ema,GAAUvV,EAAI,EAA6C,IAAzCjF,EAAO6C,UAAUyF,aAAaE,SAA4D,KAAzCxI,EAAO6C,UAAUyF,aAAaE,aAG7GkG,EAAK5N,UAAUgQ,iBAAmB,SAAUtL,GACxC,GAAIxF,GAASC,KAAKD,OACdsD,EAAWtD,EAAOqD,IAAIC,SACtBC,EAAUvD,EAAOqD,IAAIE,OACzB,IAAIvD,EAAOqD,IAAIG,UAAYxD,EAAOqC,YAAY/B,MAAO,CACjD,GAAI4a,GAAOlb,EAAOqD,IAAIC,SAAW,EAAItD,EAAOqD,IAAIC,SAAW,CAC3DkC,GAAQpB,UAAU,EAAG,EAAG8W,EAAMlb,EAAOqC,YAAY9B,QACjDiF,EAAQpB,UAAUpE,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,UAAW,EAAG0X,EAAMlb,EAAOqC,YAAY9B,QAE9F,GAAIP,EAAOqD,IAAII,WAAazD,EAAOqC,YAAY9B,OAAQ,CACnD,GAAI4a,GAAQnb,EAAOqD,IAAIE,QAAU,EAAIvD,EAAOqD,IAAIE,QAAU,CAC1DiC,GAAQpB,UAAU,EAAG,EAAGpE,EAAOqC,YAAY/B,MAAO6a,GAClD3V,EAAQpB,UAAU,EAAGpE,EAAOqD,IAAIE,QAAUvD,EAAOqD,IAAII,WAAYzD,EAAOqC,YAAY/B,MAAO6a,GAExD,KAAnCnb,EAAOiD,UAAUU,gBACjB3D,EAAOqD,IAAIC,SAAWA,EACtBtD,EAAOqD,IAAIE,QAAUA,IAG7BmL,EAAK5N,UAAUiQ,cAAgB,WAC3B,GAAI5M,GACAnE,EAASC,KAAKD,MAClB,IAAIA,EAAOiD,UAAUC,OAAS,IAAO,GAAKlD,EAAOiD,UAAUC,OAAS,KAAQ,EAAG,CACvEgB,GAAQ5D,MAAO,EAAGC,OAAQ,EAC9BP,GAAO+C,OAAO,aAAexB,KAAM,mBAAoByB,kBAAkB,EACrEvB,OAASnB,MAAON,EAAOqD,IAAImB,UAAWjE,OAAQP,EAAOqD,IAAIkB,SAAUL,IAAKA,KAC5EC,EAAeD,EACXjE,KAAK6H,eACL3D,EAAa7D,OAAU6D,EAAa7D,MAAQN,EAAOiD,UAAUa,WAC7DK,EAAa5D,QAAW4D,EAAa5D,OAASP,EAAOiD,UAAUa,WAC/D9D,EAAOqD,IAAIG,UAAYW,EAAa5D,OACpCP,EAAOqD,IAAII,WAAaU,EAAa7D,OAEzCN,EAAOqD,IAAIC,UAAYtD,EAAOqC,YAAYoC,YAAcN,EAAa5D,QAAU,EAC/EP,EAAOqD,IAAIE,SAAWvD,EAAOqC,YAAYqC,aAAeP,EAAa7D,OAAS,EAC9EN,EAAOqD,IAAIG,UAAYW,EAAa5D,OACpCP,EAAOqD,IAAII,WAAaU,EAAa7D,UAEpC,CACD,GAAI4D,IAAQ5D,MAAO,EAAGC,OAAQ,EAC9BP,GAAO+C,OAAO,aAAexB,KAAM,mBAAoByB,kBAAkB,EACrEvB,OAASnB,MAAON,EAAOqD,IAAIkB,SAAUhE,OAAQP,EAAOqD,IAAImB,UAAWN,IAAKA,KAC5EC,EAAeD,EACXjE,KAAK6H,eACL3D,EAAa7D,OAAU6D,EAAa7D,MAAQN,EAAOiD,UAAUa,WAC7DK,EAAa5D,QAAW4D,EAAa5D,OAASP,EAAOiD,UAAUa,WAC/D9D,EAAOqD,IAAIG,UAAYW,EAAa7D,MACpCN,EAAOqD,IAAII,WAAaU,EAAa5D,QAEzCP,EAAOqD,IAAIC,UAAYtD,EAAOqC,YAAYoC,YAAcN,EAAa7D,OAAS,EAC9EN,EAAOqD,IAAIE,SAAWvD,EAAOqC,YAAYqC,aAAeP,EAAa5D,QAAU,EAC/EP,EAAOqD,IAAIG,UAAYW,EAAa7D,MACpCN,EAAOqD,IAAII,WAAaU,EAAa5D,SAG7CmO,EAAK5N,UAAUkQ,qBAAuB,SAAUpK,EAAMgB,EAAsBwT,GACxE,GAAIpb,GAASC,KAAKD,OACdsD,EAAWtD,EAAOqD,IAAIC,SACtBC,EAAUvD,EAAOqD,IAAIE,OACZ,aAATqD,IACA3G,KAAKqC,aAAaqF,aAAa,EAAG,EAAG,EAAG,EAAG,EAAG,GAC1CzF,oBAAkB0F,IAClB3H,KAAK8Q,iBAGb9Q,KAAKgR,eAAerK,EAAM,KAAM,KAAMwU,GACN,IAA5Bpb,EAAOiD,UAAUC,QAAmD,KAAnClD,EAAOiD,UAAUU,gBAClD3D,EAAOqD,IAAIC,SAAWA,EACtBtD,EAAOqD,IAAIE,QAAUA,IAErBvD,EAAOyF,cAAiBzF,EAAOgE,oBAA0D,gBAApChE,EAAOgE,mBAAmBqB,SAC3E+V,IACApb,EAAOqD,IAAIC,UAAYtD,EAAOsH,SAAS0C,uBAAuBvJ,EAC9DT,EAAOqD,IAAIE,SACPvD,EAAOsH,SAAS0C,uBAAuBtJ,GAE/CV,EAAO+C,OAAO,QAAUxB,KAAM,aAAcyB,kBAAkB,EAC1DvB,OAAS+D,QAASvF,KAAKqC,aAAc+H,OAAQ,KAAMC,OAAQ,QAC3D8Q,IACApb,EAAOqD,IAAIC,UAAYtD,EAAOsH,SAAS0C,uBAAuBvJ,EAC9DT,EAAOqD,IAAIE,SACPvD,EAAOsH,SAAS0C,uBAAuBtJ,KAIvDgO,EAAK5N,UAAUmQ,eAAiB,SAAUrK,EAAMyU,EAAoB7V,EAASqC,GACzE,GAAI7H,GAASC,KAAKD,MAClBwF,GAAUA,GAAoBvF,KAAKqC,aACtB,YAATsE,EACA3G,KAAKqb,iBAAiB9V,EAASoB,GAEjB,YAATA,IACL3G,KAAKqb,iBAAiB9V,EAASoB,GAC/B3G,KAAKyR,kBAAkB2J,IACnBrb,EAAOyF,cAAiBzF,EAAOgE,oBAA0D,gBAApChE,EAAOgE,mBAAmBqB,OAC5EnD,oBAAkB2F,MACjBA,IACA7H,EAAOqD,IAAIC,UAAYtD,EAAOsH,SAAS0C,uBAAuBvJ,EAC9DT,EAAOqD,IAAIE,SAAWvD,EAAOsH,SAAS0C,uBAAuBtJ,GAEjEV,EAAO+C,OAAO,QAAUxB,KAAM,aAAcyB,kBAAkB,EAC1DvB,OAAS+D,QAASvF,KAAKqC,aAAc+H,OAAQ,KAAMC,OAAQ,QAC3DzC,IACA7H,EAAOqD,IAAIC,UAAYtD,EAAOsH,SAAS0C,uBAAuBvJ,EAC9DT,EAAOqD,IAAIE,SAAWvD,EAAOsH,SAAS0C,uBAAuBtJ,MAK7EgO,EAAK5N,UAAUwa,iBAAmB,SAAU9V,EAASoB,GACjD,GAAI5G,GAASC,KAAKD,MAClB,IAAa,YAAT4G,EACA,IAAK,GAAI3B,GAAI,EAAGC,EAAMlF,EAAOuG,eAAenB,OAAQH,EAAIC,EAAKD,IACzDhF,KAAK0H,aAAanC,EAASxF,EAAOuG,eAAetB,QAGpD,IAAa,YAAT2B,EACL,IAAS3B,EAAIjF,EAAOuG,eAAenB,OAAS,EAAGH,GAAK,EAAGA,IACnDhF,KAAK0H,aAAanC,EAASxF,EAAOuG,eAAetB,IAAI,IAIjEyJ,EAAK5N,UAAU6G,aAAe,SAAUnC,EAAS/D,EAAOqI,GACpD,GAAI9J,GAASC,KAAKD,MAkBlB,QAjBI8J,GAAuB,KAAVrI,EACbA,GAAS,GAEJqI,IAAwB,KAAXrI,IAClBA,EAAQ,IAEE,eAAVA,GAA0BzB,EAAOiD,UAAUC,OAAS,IAAO,GAAKlD,EAAOiD,UAAUC,OAAS,KAAQ,EAClGzB,EAAQ,WAEO,aAAVA,GAAwBzB,EAAOiD,UAAUC,OAAS,IAAO,GAAKlD,EAAOiD,UAAUC,OAAS,KAAQ,IACrGzB,EAAQ,cAEZzB,EAAO+C,OAAO,aAAexB,KAAM,mBAAoByB,kBAAkB,EAAOvB,OAAS4E,MAAM,KAC/FrG,EAAO+C,OAAO,aAAexB,KAAM,iBAAkByB,kBAAkB,EAAOvB,OAAS4F,eAAe,KAClGnF,oBAAkB4H,IAClBtE,EAAQpB,UAAU,EAAG,EAAGoB,EAAQF,OAAOhF,MAAOkF,EAAQF,OAAO/E,QAEzDkB,GACJ,IAAK,IACL,KAAM,GACF+D,EAAQsO,UAAUtO,EAAQF,OAAOhF,MAAQ,EAAGkF,EAAQF,OAAO/E,OAAS,GACpEiF,EAAQuO,OAAO3L,KAAKyC,GAAK,IAAMpJ,GAC/B+D,EAAQsO,WAAWtO,EAAQF,OAAOhF,MAAQ,GAAIkF,EAAQF,OAAO/E,OAAS,EACtE,MACJ,KAAK,aACDiF,EAAQsO,UAAUtO,EAAQF,OAAOhF,MAAO,GACxCkF,EAAQoV,OAAO,EAAG,EAClB,MACJ,KAAK,WACDpV,EAAQsO,UAAU,EAAGtO,EAAQF,OAAO/E,QACpCiF,EAAQoV,MAAM,GAAI,GAG1B5a,EAAO+C,OAAO,aAAexB,KAAM,mBAAoByB,kBAAkB,EAAOvB,OAAS4E,MAAM,KAC/FrG,EAAO+C,OAAO,aAAexB,KAAM,iBAAkByB,kBAAkB,EAAOvB,OAAS4F,eAAe,MAE1GqH,EAAK5N,UAAUqQ,gBAAkB,SAAUhN,GACvC,GAAInE,GAASC,KAAKD,MAClBC,MAAKqC,aAAa8B,UAAU,EAAG,EAAGpE,EAAOqC,YAAY/B,MAAON,EAAOqC,YAAY9B,QAC/EP,EAAOqD,IAAIG,UAAYW,EAAa7D,MACpCN,EAAOqD,IAAII,WAAaU,EAAa5D,OACjCN,KAAK0O,mBACL3O,EAAO+C,OAAO,UAAYxB,KAAM,aAAcyB,kBAAkB,IAChE/C,KAAK0O,kBAAmB,EAE5B,IAAIhK,GAAO1E,KAAKqC,aAAasC,MAC7B5E,GAAO+C,OAAO,UAAYxB,KAAM,qBAAsByB,kBAAkB,IACxE/C,KAAKqC,aAAa8B,UAAU,EAAG,EAAGpE,EAAOqC,YAAY/B,MAAON,EAAOqC,YAAY9B,QAC/EN,KAAKqC,aAAauC,UAAU7E,EAAO8E,QAAS9E,EAAOqD,IAAIgB,QAASrE,EAAOqD,IAAIiB,OAAQtE,EAAOqD,IAAIkB,SAAUvE,EAAOqD,IAAImB,UAAWxE,EAAOqD,IAAIC,SAAUtD,EAAOqD,IAAIE,QAASvD,EAAOqD,IAAIG,UAAWxD,EAAOqD,IAAII,aACnMzD,EAAOgE,oBAA0D,gBAApChE,EAAOgE,mBAAmBqB,OAA4BrF,EAAOyF,eAC3FzF,EAAO+C,OAAO,QAAUxB,KAAM,aAAcyB,kBAAkB,EAC1DvB,OAAS+D,QAASvF,KAAKqC,aAAc+H,OAAQ,KAAMC,OAAQ,QAEnErK,KAAKqC,aAAasC,OAASD,GAE/B+J,EAAK5N,UAAUoQ,YAAc,SAAUqK,GACnC,GAAIvb,GAASC,KAAKD,OACd2E,EAAO1E,KAAKqC,aAAasC,MAC7B5E,GAAO+C,OAAO,SAAWxB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAAS+Z,YAAa,QAC7Fvb,KAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOqC,YAAY/B,MAAON,EAAOqC,YAAY9B,QAC/EN,KAAKqC,aAAa8B,UAAU,EAAG,EAAGpE,EAAOqC,YAAY/B,MAAON,EAAOqC,YAAY9B,QAC3Egb,EACAtb,KAAKqb,iBAAiBrb,KAAKqC,aAAc,YAGrCtC,EAAOiD,UAAUa,WAAa,IAC9B7D,KAAK6H,cAAe,GAExB7H,KAAK+Q,qBAAqB,YAE9BhR,EAAO+C,OAAO,UAAYxB,KAAM,qBAAsByB,kBAAkB,IACxEhD,EAAO+C,OAAO,aAAexB,KAAM,4BAA6ByB,kBAAkB,IAClF/C,KAAKqC,aAAauC,UAAU7E,EAAO8E,QAAS9E,EAAOqD,IAAIgB,QAASrE,EAAOqD,IAAIiB,OAAQtE,EAAOqD,IAAIkB,SAAUvE,EAAOqD,IAAImB,UAAWxE,EAAOqD,IAAIC,SAAUtD,EAAOqD,IAAIE,QAASvD,EAAOqD,IAAIG,UAAWxD,EAAOqD,IAAII,YACxMzD,EAAO+C,OAAO,aAAexB,KAAM,4BAA6ByB,kBAAkB,IAC9EuY,EACAtb,KAAKqb,iBAAiBrb,KAAKqC,aAAc,YAGzCrC,KAAK+Q,qBAAqB,WAC1B/Q,KAAK6H,cAAe,GAExB7H,KAAKqC,aAAasC,OAAS,OAC3B5E,EAAO+C,OAAO,SAAWxB,KAAM,iBAAkByB,kBAAkB,IACnEhD,EAAO+C,OAAO,iBAAmBxB,KAAM,iBAAkByB,kBAAkB,EACvEvB,OAAS+D,QAASvF,KAAKqC,aAAcwG,OAAQ,QACjD7I,KAAKqC,aAAasC,OAASD,GACvB3E,EAAOyF,cAAiBzF,EAAOgE,oBAA0D,gBAApChE,EAAOgE,mBAAmBqB,QAC/ErF,EAAO+C,OAAO,QAAUxB,KAAM,aAAcyB,kBAAkB,EAC1DvB,OAAS+D,QAASvF,KAAKqC,aAAc+H,OAAQ,KAAMC,OAAQ,SAGvEoE,EAAK5N,UAAU2a,YAAc,SAAUC,GACnC,GAAIlQ,GAAQvL,KACRD,EAASC,KAAKD,OAEd2b,EAAQ1b,IACZD,GAAO8E,QAAQ4W,IAAMA,EACrB1b,EAAO8E,QAAQ8W,OAAS,WAWpB,GAVA5b,EAAO+C,OAAO,UAAYxB,KAAM,mBAAoByB,kBAAkB,IACtE2Y,EAAMrZ,aAAauC,UAAU7E,EAAO8E,QAAS,EAAG,EAAG6W,EAAM3b,OAAOqC,YAAY/B,MAAOqb,EAAM3b,OAAOqC,YAAY9B,QAC5Gsb,cAAY7b,EAAOgO,SACnBhO,EAAOgO,QAAQ8N,MAAMC,QAAU,IAC/BJ,EAAMvK,eACFpR,EAAO0F,YAAYsW,aACnBhc,EAAO0F,YAAYsW,YAAa,EAChCL,EAAM3b,OAAOqC,YAAYyZ,MAAMG,QAAU,SAE7Cjc,EAAOmH,WAAaqE,EAAMqD,cAAe,EACpC1C,aAeDnM,EAAO+N,cAAc/N,EAAOgO,QAAS,cAAe,WAChDkO,UAAQC,WACRnc,EAAOgO,QAAQoO,cAAc,0BAA0BN,MAAMG,QAAU,QACvEjc,EAAOgO,QAAQoO,cAAc,qBAAqBN,MAAMvb,OAAUP,EAAOgO,QAAQqO,aACpD,EAAvBrc,EAAOsc,cAAqB,EAAI,UAlB1C,IAAIJ,UAAQC,SAAU,CAClBnc,EAAO+C,OAAO,WAAaxB,KAAM,sBAAuByB,kBAAkB,IAC1EhD,EAAO+C,OAAO,WAAaxB,KAAM,yBAA0ByB,kBAAkB,GACzEuZ,IAAc7S,YAAY,EAAOyS,SAAUD,UAAQC,SAAUK,QAAS,KAC1Exc,GAAO+C,OAAO,WAAaxB,KAAM,oBAAqByB,kBAAkB,EAAOvB,MAAO8a,IACtFvc,EAAO+C,OAAO,WAAaxB,KAAM,wBAAyByB,kBAAkB,QAE3E,CACDhD,EAAO+C,OAAO,WAAaxB,KAAM,sBAAuByB,kBAAkB,GAC1E,IAAIuZ,IAAc7S,YAAY,EAAOyS,UAAU,EAAOK,QAAS,KAC/Dxc,GAAO+C,OAAO,WAAaxB,KAAM,oBAAqByB,kBAAkB,EAAOvB,MAAO8a,MAYlGvc,EAAO8E,QAAQ2X,QAAU,WACrBZ,cAAY7b,EAAOgO,SAGnB2N,EAAM9M,cAAe,EACrB8M,EAAMe,iBAGdhO,EAAK5N,UAAU4b,aAAe,WAC1B,GAAI1c,GAASC,KAAKD,OACd2c,GAAe/N,SAAU,KAAMqD,SAAU,KAAM2K,cAAc,EAC7DzQ,eAAcnM,EAAOoM,SAAmD,IAAzCpM,EAAOoM,OAAOuQ,WAAWtQ,YACxDrM,EAAOsM,UAAUC,kBAAkB,qBAAsB,aAAcoQ,GAGvE3c,EAAO0M,QAAQ,aAAciQ,IAGrCjO,EAAK5N,UAAUsQ,aAAe,WAC1B,GAAIpR,GAASC,KAAKD,OACd2c,GAAe/N,SAAU3O,KAAK2O,SAAUqD,SAAUhS,KAAKgS,SAAU2K,cAAc,EACnF5c,GAAOqD,IAAIkB,SAAWvE,EAAO8E,QAAQxE,MACrCN,EAAOqD,IAAImB,UAAYxE,EAAO8E,QAAQvE,MACtC,IAAI2D,IAAQ5D,MAAO,EAAGC,OAAQ,EAC9BP,GAAO+C,OAAO,aAAexB,KAAM,mBAAoByB,kBAAkB,EACrEvB,OAASnB,MAAON,EAAOqD,IAAIkB,SAAUhE,OAAQP,EAAOqD,IAAImB,UAAWN,IAAKA,IAC5E,IAAIC,GAAeD,CACnBlE,GAAOqD,IAAIC,UAAYtD,EAAOqC,YAAYoC,YAAcN,EAAa7D,OAAS,EAC9EN,EAAOqD,IAAIE,SAAWvD,EAAOqC,YAAYqC,aAAeP,EAAa5D,QAAU,EAC/EN,KAAKkR,gBAAgBhN,GACrBlE,KAAK+P,SAAS1P,MAAQN,EAAOqD,IAAIG,UACjCvD,KAAK+P,SAASzP,OAASP,EAAOqD,IAAII,WAClCzD,EAAO+C,OAAO,aAAexB,KAAM,mBAAoByB,kBAAkB,EACrEvB,OAASnB,MAAON,EAAOqD,IAAIG,UAAWjD,OAAQP,EAAOqD,IAAII,aAC7D,IAAIL,IAAUhD,OAAQJ,EAAOqD,IAAIC,SAAUjD,OAAQL,EAAOqD,IAAIE,QAASjD,MAAON,EAAOqD,IAAIG,UACrFjD,OAAQP,EAAOqD,IAAII,WACvBzD,GAAO+C,OAAO,QAAUxB,KAAM,oBAAqByB,kBAAkB,EAAOvB,OAAS2B,MAAOA,IAC5F,IAAIuB,GAAO1E,KAAKqC,aAAasC,MAC7B3E,MAAKqC,aAAasC,OAAS,OAC3B5E,EAAO+C,OAAO,SAAWxB,KAAM,iBAAkByB,kBAAkB,IACnEhD,EAAO+C,OAAO,iBAAmBxB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAASuD,eAAgB,QACxG/E,KAAKqC,aAAasC,OAASD,EACvB3E,EAAOqD,IAAIG,UAAY,GAAKxD,EAAOqD,IAAII,WAAa,IACpDzD,EAAO0L,eAAgB,GAEvB1L,EAAOmH,YACgC,KAAnCnH,EAAOiD,UAAUU,eACjB3D,EAAO+C,OAAO,aAAexB,KAAM,YAAayB,kBAAkB,EAC9DvB,OAASqF,UAAW9G,EAAO+G,aAAa/G,EAAOiD,UAAUU,kBAGjE3D,EAAOyL,UACPzL,EAAOgO,QAAQ6O,aAAa,QAAS,cAErC7c,EAAO0L,eAAkD,QAAjC1L,EAAOgO,QAAQ8N,MAAMC,UACzC5P,cAAcnM,EAAOoM,SAAmD,IAAzCpM,EAAOoM,OAAOuQ,WAAWtQ,YACxDrM,EAAOsM,UAAUC,kBAAkB,qBAAsB,aAAcoQ,GAGvE3c,EAAO0M,QAAQ,aAAciQ,KAGE,IAAnC3c,EAAOkN,aAAapJ,YAAoB9D,EAAOkN,aAAa9F,YAC5DpH,EAAO8c,KAAK9c,EAAOkN,aAAapJ,WAAY9D,EAAOkN,aAAa9F,WAEhElF,oBAAkBjC,KAAKiS,iBACvBjS,KAAKiS,cAAgBlS,EAAOkN,aAAapJ,YAE7C7D,KAAKgQ,eAAgB,GAEzBvB,EAAK5N,UAAUuQ,cAAgB,SAAU5H,GACrC,GAAIzJ,GAASC,KAAKD,MAClByJ,GAAsBA,IAA4C,CAClE,IAAIvF,IAAQmC,MAAM,EAElB,IADArG,EAAO+C,OAAO,aAAexB,KAAM,yBAA0ByB,kBAAkB,EAAOvB,OAASyC,IAAKA,KAChGA,EAAU,KACVlE,EAAO+C,OAAO,iBAAmBxB,KAAM,YAAayB,kBAAkB,IACjEmJ,aAIDnM,EAAO+N,cAAc/N,EAAOgO,QAAS,6BAHrChO,EAAO+C,OAAO,WAAaxB,KAAM,qBAAsByB,kBAAkB,IAK7EhD,EAAO+C,OAAO,aAAexB,KAAM,gBAAiBE,OAASmF,KAAM,gBAElE,IAAsC,UAAlC5G,EAAO+c,SAASjB,MAAMG,QAC3Bjc,EAAO+c,SAASjB,MAAMG,QAAU,OAChCjc,EAAO+c,SAAStb,MAAQ,GACxBzB,EAAO+c,SAASjB,MAAM7Y,UAAY,GAC9BhD,KAAKmS,YACLpS,EAAO6C,UAAY5C,KAAKmS,WACxBnS,KAAKmS,WAAa,OAGlBpS,EAAO6C,UAAUmQ,eAAiB/S,KAAK8O,mBACvC/O,EAAO6C,UAAUyF,aAAerI,KAAKkP,kBAEzCnP,EAAO+C,OAAO,aAAexB,KAAM,gBAAiBE,OAASmF,KAAM,YAC/D3G,KAAK6O,qBACL9O,EAAO+C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,IAEzEhD,EAAO+C,OAAO,SAAWxB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAAS+Z,aAAa,KACxFrP,aAIDnM,EAAO+N,cAAc/N,EAAOgO,QAAS,eAHrChO,EAAO+C,OAAO,WAAaxB,KAAM,uBAAwByB,kBAAkB,QAM9E,KAAMmJ,cAAc6Q,SAASZ,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,mBAAuB9Q,eAAenM,EAAOgO,QAAQoO,cAAc,2BAA2Bc,UAAUC,SAAS,aACvLnd,EAAO0F,YAAY0X,WAAY,CAC/Bnd,KAAKqC,aAAasC,OAAS3E,KAAKwP,aAChCzP,EAAOqd,aAAepd,KAAKwP,aAC3BzP,EAAO+C,OAAO,UAAYxB,KAAM,qBAAsByB,kBAAkB,EAAOvB,OAAS6b,gBAAiBrd,KAAKwP,gBAC9GzP,EAAOud,uBAAyBtd,KAAKwP,aACjCxP,KAAKqC,aAAasC,OAAOgI,MAAM,KAAKxH,OAAS,GAC0B,MAAvEnF,KAAKqC,aAAasC,OAAOgI,MAAM,KAAK,GAAGA,MAAM,KAAK,GAAGA,MAAM,KAAK,IAChE5M,EAAO+C,OAAO,UAAYxB,KAAM,wBAAyByB,kBAAkB,EAAOvB,OAAS+b,sBAAsB,KAErHxd,EAAOyd,cAAgBxd,KAAKyP,WAC5BzP,KAAKqC,aAAa8B,UAAU,EAAG,EAAGpE,EAAOqC,YAAY/B,MAAON,EAAOqC,YAAY9B,QAC/EN,KAAK0R,mBACL3R,EAAO0F,YAAY0X,YAAa,CAChC,IAAIM,IAAUC,oBAAqB,KACnC3d,GAAO+C,OAAO,UAAYxB,KAAM,yBAA0ByB,kBAAkB,EAAOvB,OAASyC,IAAKwZ,KACjG1d,EAAO+C,OAAO,UAAYxB,KAAM,qBAAsByB,kBAAkB,EACpEvB,OAASmc,gBAAiB3Z,YAAWyZ,EAA2B,wBAAO,MAC3E1d,EAAO+C,OAAO,aAAexB,KAAM,kBAAmByB,kBAAkB,EAAOvB,OAASoc,KAAM5d,KAAK0P,oBACnG3P,EAAOwC,YAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS,UAClD9d,EAAO0F,YAAYC,cAAe,EAClC1F,KAAK8O,oBAAuBC,YAAa,OAAQC,UAAW,GAAIC,YAAa,MAC7EjP,KAAK6Q,iBAAiB7Q,KAAKqC,eACtBtC,EAAOgE,oBAA0D,gBAApChE,EAAOgE,mBAAmBqB,OAA4BrF,EAAOyF,eAC3FzF,EAAO+C,OAAO,QAAUxB,KAAM,aAAcyB,kBAAkB,EAC1DvB,OAAS+D,QAASvF,KAAKqC,aAAc+H,OAAQ,KAAMC,OAAQ,OAE/DiS,IAAc3V,KAAM,OAAQ8C,WAAY,KAAMC,WAAY,KAAMC,UAAW,KAC1EuC,cAKDnM,EAAO+N,cAAc/N,EAAOgO,QAAS,gBAJrChO,EAAOgO,QAAQoO,cAAc,iCAAiCc,UAAUa,IAAI,UAC5E/d,EAAO+C,OAAO,WAAaxB,KAAM,kBAAmByB,kBAAkB,EAAOvB,MAAO8a,KAKxFvc,EAAO+C,OAAO,aAAexB,KAAM,gBAAiBE,OAASmF,KAAM,gBAGnE,IAAI6C,EAAqB,CACrB,GAAI8S,IAAc3V,KAAM,OAAQ8C,WAAY,KAAMC,WAAY,KAAMC,UAAW,KAC1EuC,cAIDnM,EAAO+N,cAAc/N,EAAOgO,QAAS,eAHrChO,EAAO+C,OAAO,WAAaxB,KAAM,kBAAmByB,kBAAkB,EAAOvB,MAAO8a,QAOxFtc,MAAK+d,cACLhe,EAAOie,WAAY,EACnBje,EAAO+C,OAAO,aAAexB,KAAM,gBAAiBE,OAAS4E,MAAM,IAG3EpG,MAAK6O,qBAAsB,EAC3B7O,KAAKkQ,WAAY,EACZhE,eACDnM,EAAO+C,OAAO,WAAaxB,KAAM,uBAAwBE,OAASyc,YAAY,KAC9Ele,EAAO+C,OAAO,WAAaxB,KAAM,oBAAqBE,OAASmF,KAAM,YAG7E8H,EAAK5N,UAAUkd,YAAc,WACzB,GAEIrR,GAFA3M,EAASC,KAAKD,OACdme,GAAkB,EAElBC,GAAU,YAAa,UAAW,OAAQ,QAAS,YACxB1K,KAA3B1T,EAAO6C,UAAUwC,QACjBsH,EAAa3M,EAAO6C,UAAUwC,MAAMuH,MAAM,UAE3B8G,KAAf/G,GAA4B3M,EAAO0F,YAAYC,aAC/CwY,GAAkB,MAEEzK,KAAf/G,GAA8C,SAAlBA,EAAW,KAC5CwR,GAAkB,GAElBA,GAAmBne,EAAOqe,YAC1Bre,EAAOqe,WAAY,EACnBre,EAAOiD,UAAUa,WAAa9D,EAAOiD,UAAU4C,mBAE/C7F,EAAOse,UACPre,KAAKse,YAE2B,SAA3Bve,EAAO6C,UAAUwC,MACtBpF,KAAKue,WAAWL,IAEiC,IAA5CC,EAAOK,QAAQze,EAAO6C,UAAUwC,OACrCpF,KAAKye,cAEAP,EACLle,KAAK0e,mBAGL3e,EAAO+C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,IACrE/C,KAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOwC,YAAYlC,MAAON,EAAOwC,YAAYjC,QAC/EP,EAAO+C,OAAO,aAAexB,KAAM,gBAAiBE,OAASmF,KAAM,aAEvE5G,EAAO+C,OAAO,aAAexB,KAAM,yBAA0ByB,kBAAkB,EAAOvB,OAASA,MAAO,MACtGzB,EAAOwC,YAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS,UAClD9d,EAAO0F,YAAYC,cAAe,EAClC1F,KAAK8O,oBAAuBC,YAAa,OAAQC,UAAW,GAAIC,YAAa,KAC7E,IAAIqN,IAAc3V,KAAM,OAAQ8C,WAAY,KAAMC,YAAY,EAAOC,UAAW,KAC3EuC,cAIDnM,EAAO+N,cAAc/N,EAAOgO,QAAS,eAHrChO,EAAO+C,OAAO,WAAaxB,KAAM,kBAAmByB,kBAAkB,EAAOvB,MAAO8a,KAM5F7N,EAAK5N,UAAUyd,UAAY,WACvB,GAAIve,GAASC,KAAKD,MAClBC,MAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOwC,YAAYlC,MAAON,EAAOwC,YAAYjC,QAC/EP,EAAOse,WAAY,EACnBte,EAAOwC,YAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS,SAElD,IAAIc,GAAiB3a,YAAWjE,EAAOkH,cAAe,EACtDlH,GAAOkH,YACP,KAAK,GAAIjC,GAAI,EAAGA,EAAIhF,KAAK2P,oBAAqB3K,IAC1CjF,EAAOkH,UAAUjC,GAAK2Z,EAAe3Z,EAEzCjF,GAAOiH,gBAAkBhH,KAAK2P,oBAC9B5P,EAAO+C,OAAO,iBAAmBxB,KAAM,8BAA+BE,OAASA,MAAOxB,KAAK4P,oBAC3F7P,EAAO6C,UAAUmQ,eAAiB/S,KAAK8O,mBACvC/O,EAAO+C,OAAO,SAAWxB,KAAM,oBAC3BE,OAASuR,eAAgBhT,EAAO6C,UAAUmQ,eAAgBhE,YAAa,KAAMC,UAAW,KAAMC,YAAa,QAC/GlP,EAAO+C,OAAO,aAAexB,KAAM,gBAAiBE,OAASmF,KAAM,YACnE5G,EAAO+C,OAAO,aAAexB,KAAM,4BAA6BE,OAASod,0BAA0B,MAEvGnQ,EAAK5N,UAAU0d,WAAa,SAAUL,GAClC,GAAIne,GAASC,KAAKD,MAKlB,IAJAA,EAAO+C,OAAO,SAAWxB,KAAM,kBAAmByB,kBAAkB,EAChEvB,OAAS6G,aAAcrI,KAAKkP,iBAAkBE,WAAY,KAAM7G,SAAU,QAC9ExI,EAAO+C,OAAO,SAAWxB,KAAM,oBAC3BE,OAASuR,eAAgB/S,KAAK8O,mBAAoBC,YAAa,KAAMC,UAAW,KAAMC,YAAa,QACnGhN,oBAAkBlC,EAAO6C,UAAUic,WACnC9e,EAAO+C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,IACrE/C,KAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOwC,YAAYlC,MAAON,EAAOwC,YAAYjC,YAE9E,CACD,GAAIwF,IAAWgZ,uBACf/e,GAAO+C,OAAO,aAAexB,KAAM,yBAA0BE,OAASyC,IAAK6B,IAC3E,IAAIb,GAAMa,EAA4B,oBAAEX,MACpCnF,MAAKmS,YAAcrM,EAA4B,oBAAEb,EAAM,IACvDa,EAA4B,oBAAEb,EAAM,GAAG8Z,eAAejZ,EAA4B,oBAAEb,EAAM,GAAG8Z,eAAe5Z,OAAS,GAAG0Z,YAChH7e,KAAKmS,WAAW0M,WACxB9e,EAAO6C,UAAY5C,KAAKmS,WACxBnS,KAAKmS,WAAa,OAGlBpS,EAAO+C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,IACrE/C,KAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOwC,YAAYlC,MAAON,EAAOwC,YAAYjC,SAE/EP,EAAO6C,UAAUwC,OAAyC,eAAhCrF,EAAO6C,UAAUuQ,YAC3CpT,EAAO+C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,IACrE/C,KAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOwC,YAAYlC,MAAON,EAAOwC,YAAYjC,QAC/EP,EAAO+C,OAAO,SAAWxB,KAAM,oBAC/BvB,EAAO+C,OAAO,aAAexB,KAAM,gBAAiBE,OAASmF,KAAM,YACnE5G,EAAO+C,OAAO,SAAWxB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAAS+Z,aAAa,MAExFxb,EAAO6C,UAAUwC,QACtBrF,EAAO+C,OAAO,SAAWxB,KAAM,gBAC/BvB,EAAO+C,OAAO,aAAexB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAASyC,IAAKlE,EAAO6C,aAC3Fsb,OAAsDzK,KAAnC1T,EAAO6C,UAAUkS,eACrC/U,EAAO+C,OAAO,SAAWxB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAAS+Z,aAAa,KAEjGxb,EAAOif,kBAGV9S,aAIDnM,EAAO+N,cAAc/N,EAAOgO,QAAS,6BAHrChO,EAAO+C,OAAO,WAAaxB,KAAM,qBAAsByB,kBAAkB,IAK7E/C,KAAKkP,kBAAqBC,KAAM,aAAcC,WAAY,QAAS7G,SAAU,KAAMD,UAAW,KAAM+G,MAAM,EACtGC,QAAQ,EAAOC,WAAW,IAElCd,EAAK5N,UAAU4d,YAAc,WACzB,GAAI1e,GAASC,KAAKD,MAGlB,IAFAA,EAAO+C,OAAO,SAAWxB,KAAM,oBAC3BE,OAASuR,eAAgB/S,KAAK8O,mBAAoBC,YAAa,KAAMC,UAAW,KAAMC,YAAa,QACnGhN,oBAAkBlC,EAAO6C,UAAUic,WACnC9e,EAAO+C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,IACrE/C,KAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOwC,YAAYlC,MAAON,EAAOwC,YAAYjC,YAE9E,IAAIN,KAAKkQ,UACVnQ,EAAO+C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,IACrE/C,KAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOwC,YAAYlC,MAAON,EAAOwC,YAAYjC,QAC/EN,KAAKiR,kBAEJ,CACD,GAAInL,IAAWgZ,uBACf/e,GAAO+C,OAAO,aAAexB,KAAM,yBAA0BE,OAASyC,IAAK6B,IAC3E,IAAIb,GAAMa,EAA4B,oBAAEX,MACpCnF,MAAKmS,YAAcrM,EAA4B,oBAAEb,EAAM,IACvDa,EAA4B,oBAAEb,EAAM,GAAG8Z,eAAejZ,EAA4B,oBAAEb,EAAM,GAAG8Z,eAAe5Z,OAAS,GAAG0Z,YAChH7e,KAAKmS,WAAW0M,WACxB9e,EAAO6C,UAAY5C,KAAKmS,WACxBnS,KAAKmS,WAAa,KAClBpS,EAAO+C,OAAO,aAAexB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAASyC,IAAKlE,EAAO6C,aAChG7C,EAAO+C,OAAO,aAAexB,KAAM,gBAAiBE,OAASmF,KAAM,YACnE5G,EAAO+C,OAAO,SAAWxB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAAS+Z,aAAa,OAG7Fxb,EAAO+C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,IACrE/C,KAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOwC,YAAYlC,MAAON,EAAOwC,YAAYjC,SAGvFP,EAAO0F,YAAYwZ,YAAa,EAC3B/S,aAIDnM,EAAO+N,cAAc/N,EAAOgO,QAAS,6BAHrChO,EAAO+C,OAAO,WAAaxB,KAAM,qBAAsByB,kBAAkB,KAMjF0L,EAAK5N,UAAU6d,gBAAkB,WAC7B,GAAI3e,GAASC,KAAKD,MACdA,GAAOmf,sBACPnf,EAAOiG,QAAUhC,YAAWjE,EAAOmf,oBAAoBxR,oBAAqB,GAC5E3N,EAAO8F,iBAAmB9F,EAAOmf,oBAAoB5R,YAAYzH,iBACjE9F,EAAO+C,OAAO,aAAexB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAASyC,IAAKlE,EAAOmf,uBAChGnf,EAAOgE,mBAAqBC,YAAWjE,EAAOmf,oBAAoBxR,gBAAgB9K,WAAW,GACzF7C,EAAOgE,oBAAsB9B,oBAAkBlC,EAAOgE,mBAAmBqB,SACzErF,EAAOgE,mBAAqB,MAEhC/D,KAAK6Q,iBAAiB7Q,KAAKqC,eACvBtC,EAAOyF,cAAiBzF,EAAOgE,oBAA0D,gBAApChE,EAAOgE,mBAAmBqB,QAC/ErF,EAAO+C,OAAO,QAAUxB,KAAM,aAAcyB,kBAAkB,EAC1DvB,OAAS+D,QAASvF,KAAKqC,aAAc+H,OAAQ,KAAMC,OAAQ,UAI3EoE,EAAK5N,UAAUwQ,cAAgB,SAAU8N,GACrC,GAAIpf,GAASC,KAAKD,MAClB,IAAuC,KAAnCA,EAAOiD,UAAUU,cAAsB,CACvC,GAAIgB,GAAO1E,KAAKqC,aAAasC,MAC7B5E,GAAO+C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,IACrEhD,EAAO+C,OAAO,aAAexB,KAAM,cAAeyB,kBAAkB,IACpE/C,KAAKqC,aAAasC,OAAS,OAC3B5E,EAAO+C,OAAO,iBAAmBxB,KAAM,iBAAkByB,kBAAkB,EACvEvB,OAAS+D,QAASvF,KAAKqC,aAAcwG,OAAQ,QACjD7I,KAAKqC,aAAasC,OAASD,EAC3B1E,KAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOwC,YAAYlC,MAAON,EAAOwC,YAAYjC,QAC3E6e,GACAnf,KAAK2Q,WAAW,YAAawO,KAIzC1Q,EAAK5N,UAAUyQ,OAAS,SAAU3K,EAAMxG,EAAQC,EAAQC,EAAOC,GAC3D,GAAIP,GAASC,KAAKD,MAClB,KAAKA,EAAOyL,UAAYzL,EAAO0L,cAAe,CAC1C,GAAI3F,IAAWC,WACfhG,GAAO+C,OAAO,UAAYxB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAASsE,OAAQA,IAC3F,IAAIwH,GAAcxH,EAAgB,OAClCwH,GAAYpI,QAAUlB,YAAWjE,EAAOmF,YAAa,GACrDoI,EAAYrG,UAAYjD,YAAWjE,EAAOkH,cAAe,GACzDqG,EAAYzH,iBAAmB9F,EAAO8F,gBACtC,IAAIuZ,IAAoBhW,aAAc,KACtCrJ,GAAO+C,OAAO,iBAAmBxB,KAAM,kBAAmByB,kBAAkB,EACxEvB,OAASyC,IAAKmb,KAClB9R,EAAYlE,aAAepF,YAAWob,EAA8B,iBAAO,GAC3Erf,EAAO+C,OAAO,QAAUxB,KAAM,4BAA6ByB,kBAAkB,EAAOvB,OAASyC,IAAKqJ,KAC9FvN,EAAOiD,UAAUa,WAAa,GAAK9D,EAAO6C,UAAUwC,OAAkD,SAAzCrF,EAAO6C,UAAUwC,MAAMuH,MAAM,KAAK,IAAiB1K,oBAAkBjC,KAAKkS,gBACvIlS,KAAKkS,aAAelO,YAAWjE,EAAO6C,cAAe,GAEzD,IAAIyc,IAAY,EACZ3S,MAAa,OACc+G,KAA3B1T,EAAO6C,UAAUwC,QACjBsH,EAAa3M,EAAO6C,UAAUwC,MAAMuH,MAAM,UAE3B8G,KAAf/G,GAA4B3M,EAAO0F,YAAYC,aAC/C2Z,GAAY,MAEQ5L,KAAf/G,GAA8C,SAAlBA,EAAW,KAC5C2S,GAAY,EAEhB,IAAIpb,IAAQ8B,WACZhG,GAAO+C,OAAO,UAAYxB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAASsE,OAAQ7B,IAC3F,IAAI8I,GAAU9I,EAAa,OAU3B,IATA8I,EAAQ7H,QAAUlB,YAAWjE,EAAOmF,YAAa,GACjD6H,EAAQ9F,UAAYjD,YAAWjE,EAAOkH,cAAe,GACrD8F,EAAQlH,iBAAmB7B,YAAWjE,EAAO8F,qBAAsB,GACnE9F,EAAO+C,OAAO,SAAWxB,KAAM,eAAgByB,kBAAkB,EAC7DvB,OAAShB,EAAG,KAAMC,EAAG,KAAM8a,YAAa,QAC5Cxb,EAAO+C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,IACrEhD,EAAO+C,OAAO,SAAWxB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAAS2R,WAAY,MAC9FnT,KAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOwC,YAAYlC,MAAON,EAAOwC,YAAYjC,QAC/EP,EAAOwC,YAAYsZ,MAAMG,QAAU,QAC/Bjc,EAAOgE,oBAA6D,IAAvChE,EAAOiD,UAAU4C,mBACjB,IAA5B7F,EAAOiD,UAAUC,QAA+D,IAA/ClD,EAAOsH,SAAS4B,yBAAyBzI,GACxB,IAA/CT,EAAOsH,SAAS4B,yBAAyBxI,IAAY4e,EAAY,CAErE,GADAtf,EAAOyF,cAAe,EACqB,IAAvCzF,EAAOiD,UAAU4C,kBAAyB,CAC1C,GAAIwY,GAAYre,EAAOqe,SACvBre,GAAOqe,WAAY,EACnBre,EAAO+C,OAAO,aAAexB,KAAM,YAAayB,kBAAkB,IAClEhD,EAAOqe,UAAYA,EACnBpe,KAAKwR,iBAETzR,EAAO+C,OAAO,iBAAmBxB,KAAM,gBAAiByB,kBAAkB,IAC1EhD,EAAOqe,WAAY,EACnBre,EAAOyF,cAAe,EACtBzF,EAAO+C,OAAO,QAAUxB,KAAM,mBAAoByB,kBAAkB,EAAOvB,OAASuH,gBAAgB,KACpGhJ,EAAOiD,UAAUa,WAAa9D,EAAOiD,UAAUsc,eAC3Crd,oBAAkBlC,EAAOiG,QAAQpD,UAAUwC,SAC3CrF,EAAO0F,YAAYL,MAAQ,QAAUuB,EAAKiM,cAC1C5S,KAAKuf,iBAAiB5Y,EAAMxG,EAAQC,EAAQC,EAAOC,QAI1C,WAATqG,IACA5G,EAAO0F,YAAYL,MAAQ,IAE/BpF,KAAKuf,iBAAiB5Y,EAAMxG,EAAQC,EAAQC,EAAOC,KAI/DmO,EAAK5N,UAAU0e,iBAAmB,SAAU5Y,EAAMxG,EAAQC,EAAQC,EAAOC,GACrE,GACIuI,GADA9I,EAASC,KAAKD,OAEdyf,EAAY,QAAU7Y,CACM,iBAA5B6Y,EAAU5M,cACuB,KAA7B7S,EAAO0F,YAAYL,OAA6C,gBAA7BrF,EAAO0F,YAAYL,OACtDpF,KAAKgU,oBAAoB,cAAe7T,EAAQC,EAAQC,EAAOC,GAGlC,gBAA5Bkf,EAAU5M,eACf7S,EAAOwC,YAAYsZ,MAAMG,QAAU,QACnCjc,EAAO+C,OAAO,aAAexB,KAAM,gBAAiBE,OAAS4E,MAAM,OAGnErG,EAAO0F,YAAYC,cAAe,EAClC3F,EAAO0F,YAAYL,MAAQoa,EAAU5M,cACjCvS,GAASC,EACTuI,GAAW1I,OAAQA,EAAQC,OAAQA,EAAQ2H,KAAM5H,EAASE,EAAO2H,KAAM5H,EAASE,EAC5ED,MAAOA,EAAOC,OAAQA,GAErBD,GAAuB,gBAAdmf,IACd3W,GAAW1I,OAAQA,EAAQC,OAAQA,EAAQ2H,KAAM5H,EAASE,EAAO2H,KAAM5H,EAASC,EAC5EA,MAAOA,EAAOC,OAAQD,IAE9BN,EAAO6C,UAAUwC,MAAQoa,EAAU5M,cACnC5S,KAAKyf,sBAAsB5W,KAGnC4F,EAAK5N,UAAU4e,sBAAwB,SAAU5W,GAC7C,GAAI0C,GAAQvL,KACRD,EAASC,KAAKD,OACd4C,EAAW5C,EAAO6C,UAAUC,YAC5BoB,GAAQyb,oBACZ3f,GAAO+C,OAAO,aAAexB,KAAM,0BAA2ByB,kBAAkB,EAAOvB,OAASyC,IAAKA,IACrG,IAAIgS,IAAsBtP,KAAM5G,EAAO4f,iBAAiB1b,EAAsB,iBAAQ,MAAI9D,OAAQ8D,EAAsB,iBAAU,OAC9H7D,OAAQ6D,EAAsB,iBAAU,OAAG5D,MAAO4D,EAAsB,iBAAS,MAAG3D,OAAQ2D,EAAsB,iBAAU,QAC5H2b,GAA0BC,OAAQ,SAAUC,0BAA2B7J,EACvE8J,yBAA0B9J,EAC1B/J,eAAcnM,EAAOoM,SAA+D,IAArDpM,EAAOoM,OAAO6T,uBAAuB5T,YAEpErM,EAAOsM,UAAUC,kBAAkB,sBAAuB,yBAA0BsT,GAAuBrT,KAAK,SAAUqT,GACtH7f,EAAO+C,OAAO,SAAWxB,KAAM,wBAAyByB,kBAAkB,EACtEvB,OAASyU,kBAAmB2J,EAAsBG,4BACM,WAAxDH,EAAsBG,yBAAyBpZ,KAC/C4E,EAAMoF,WAAW,YAAa5Q,EAAO6C,UAAW,KAAM,MAAM,IAGpC,IAApBD,EAASxC,QAAoC,IAApBwC,EAASvC,QACf,IAAnBuC,EAAStC,OAAmC,IAApBsC,EAASrC,SACjCuI,GAAW1I,OAAQwC,EAASxC,OAAQC,OAAQuC,EAASvC,OACjD2H,KAAMpF,EAASoF,KAAMC,KAAMrF,EAASqF,KACpC3H,MAAOsC,EAAStC,MAAOC,OAAQqC,EAASrC,SAEhDiL,EAAMoF,WAAW,YAAa,MAAM,EAAM9H,OAKlD9I,EAAO0M,QAAQ,oBAAqBmT,GACpC7f,EAAO+C,OAAO,SAAWxB,KAAM,wBAAyByB,kBAAkB,EACtEvB,OAASyU,kBAAmB2J,EAAsBG,4BACM,WAAxDH,EAAsBG,yBAAyBpZ,KAC/C3G,KAAK2Q,WAAW,YAAa5Q,EAAO6C,UAAW,KAAM,MAAM,IAGnC,IAApBD,EAASxC,QAAoC,IAApBwC,EAASvC,QACf,IAAnBuC,EAAStC,OAAmC,IAApBsC,EAASrC,SACjCuI,GAAW1I,OAAQwC,EAASxC,OAAQC,OAAQuC,EAASvC,OACjD2H,KAAMpF,EAASoF,KAAMC,KAAMrF,EAASqF,KACpC3H,MAAOsC,EAAStC,MAAOC,OAAQqC,EAASrC,SAEhDN,KAAK2Q,WAAW,YAAa,MAAM,EAAM9H,MAIrD4F,EAAK5N,UAAUmT,oBAAsB,SAAUwL,EAAWrf,EAAQC,EAAQC,EAAOC,GAC7E,GAAIP,GAASC,KAAKD,OACd4C,EAAW5C,EAAO6C,UAAUC,WAIhC,IAHA9C,EAAO0F,YAAYC,cAAe,EAClC1F,KAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOwC,YAAYlC,MAAON,EAAOwC,YAAYjC,QAC/EP,EAAO0F,YAAYL,MAAQrF,EAAO6C,UAAUwC,MAAQoa,EAAU5M,cACzD3Q,oBAAkB9B,IAAY8B,oBAAkB7B,IAAY6B,oBAAkB5B,IAAW4B,oBAAkB3B,GAQ3G,CACD,GAAI2B,oBAAkBlC,EAAOiD,UAAUa,aAA+C,IAAhC9D,EAAOiD,UAAUa,WAAkB,CACrF,GAAIoc,GAAYlgB,EAAOqD,IAAIC,SACvB6c,EAAWngB,EAAOqD,IAAIE,QACtB6c,EAAapgB,EAAOqD,IAAIG,UACxB6c,EAAcrgB,EAAOqD,IAAII,WACzB6c,EAAqBtgB,EAAOqC,YAAY/B,MACxCigB,EAAsBvgB,EAAOqC,YAAY9B,OACzCigB,EAAgB5d,CAChBsd,IAAa,GAAKC,GAAY,GAC9BK,EAAcpgB,OAAS8f,EACvBM,EAAcngB,OAAS8f,EACvBK,EAAcxY,KAAOkY,EAAYE,EACjCI,EAAcvY,KAAOkY,EAAWE,GAE3BH,GAAa,GAClBM,EAAcpgB,OAAS8f,EACvBM,EAAcngB,OAAS,IACvBmgB,EAAcxY,KAAOkY,EAAYE,EACjCI,EAAcvY,KAAOsY,EAAsB,IAEtCJ,GAAY,GACjBK,EAAcpgB,OAAS,IACvBogB,EAAcngB,OAAS8f,EACvBK,EAAcxY,KAAOsY,EAAqB,GAC1CE,EAAcvY,KAAOkY,EAAWE,IAGhCG,EAAcpgB,OAAS,IACvBogB,EAAcngB,OAAS,IACvBmgB,EAAcxY,KAAOsY,EAAqB,GAC1CE,EAAcvY,KAAOsY,EAAsB,QAG9C,CACD,GAAIE,GAAYzgB,EAAOqD,IAAIC,SACvBod,EAAW1gB,EAAOqD,IAAIE,QACtBod,EAAa3gB,EAAOqD,IAAIG,UACxBod,EAAc5gB,EAAOqD,IAAII,WACzBod,EAAqB7gB,EAAOqC,YAAY/B,MACxCwgB,EAAsB9gB,EAAOqC,YAAY9B,OACzCwgB,EAAgBne,CACpBme,GAAc3gB,OAASgI,KAAK4Y,IAAIP,EAAY,EAAIA,EAAY,IAAKA,GACjEM,EAAc1gB,OAAS+H,KAAK4Y,IAAIN,EAAW,EAAIA,EAAW,IAAKA,GAC/DK,EAAc/Y,KAAOI,KAAK6Y,IAAIR,EAAYE,EAAa,GAAKE,EAAqBJ,EAAYE,EAAa,GACtGE,EAAqB,GAAIJ,EAAYE,GACzCI,EAAc9Y,KAAOG,KAAK6Y,IAAIP,EAAWE,EAAc,GAAKE,EAAsBJ,EAAWE,EAAc,GACvGE,EAAsB,GAAIJ,EAAWE,GAE7C,GAAIM,GAAUlhB,EAAOqD,IAAIC,SACrB6d,EAASnhB,EAAOqD,IAAIE,QACpB2Q,EAAWlU,EAAOqD,IAAIG,UACtB2Q,EAAYnU,EAAOqD,IAAII,WACvB2d,EAAmBphB,EAAOqC,YAAYoC,YACtC4c,EAAoBrhB,EAAOqC,YAAYqC,aACvC5B,EAAcF,CAClBE,GAAY1C,OAASgI,KAAK4Y,IAAIle,EAAY1C,OAAQ8gB,GAClDpe,EAAYzC,OAAS+H,KAAK4Y,IAAIle,EAAYzC,OAAQ8gB,GAClDre,EAAYkF,KAAOI,KAAK6Y,IAAIne,EAAYkF,KAAMkZ,EAAUhN,GACxDpR,EAAYmF,KAAOG,KAAK6Y,IAAIne,EAAYmF,KAAMkZ,EAAShN,GACnDrR,EAAY1C,SAAW8gB,GAAWA,EAAUhN,EAAWkN,IACvDte,EAAYkF,KAAOoZ,EAAmB,IAEtCte,EAAYzC,SAAW8gB,GAAUA,EAAShN,EAAYkN,IACtDve,EAAYmF,KAAOoZ,EAAoB,IAE3CrhB,EAAO6C,UAAY5C,KAAK+T,kBAAkBhU,EAAO6C,WACjD5C,KAAK4Q,mBAAmBjO,EAAU5C,EAAO6C,eA1EzCD,GAASxC,OAASA,EAClBwC,EAASvC,OAASA,EAClBuC,EAASoF,KAAO5H,EAASE,EACzBsC,EAASqF,KAAO5H,EAASE,EACzBqC,EAAStC,MAAQA,EACjBsC,EAASrC,OAASA,CAuEtBN,MAAKyf,yBAEThR,EAAK5N,UAAU0Q,yBAA2B,WACtC,GAAIxR,GAASC,KAAKD,OACdshB,EAAcrd,YAAWjE,EAAOmF,YAAa,GAC7Coc,EAAgBtd,YAAWjE,EAAO6C,cAAe,EACrD7C,GAAOmF,WACPnF,EAAO+C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,IACrE/C,KAAK6H,cAAe,EACpB7H,KAAK+Q,qBAAqB,WAC1B/Q,KAAKqC,aAAa8B,UAAU,EAAG,EAAGpE,EAAOqC,YAAY/B,MAAON,EAAOqC,YAAY9B,QAC/C,IAA5BP,EAAOiD,UAAUC,QAAgBlD,EAAOuG,eAAenB,OAAS,IAChEpF,EAAOqD,IAAIC,UAAYtD,EAAOsH,SAASC,iBAAiB9G,EACxDT,EAAOqD,IAAIE,SAAWvD,EAAOsH,SAASC,iBAAiB7G,GAE3DV,EAAOqD,IAAIC,UAAYtD,EAAOsH,SAAS4B,yBAAyBzI,EAChET,EAAOqD,IAAIE,SAAWvD,EAAOsH,SAAS4B,yBAAyBxI,CAC/D,IAAIiE,GAAO1E,KAAKqC,aAAasC,MACG,KAA5B5E,EAAOiD,UAAUC,QACjBlD,EAAO+C,OAAO,aAAexB,KAAM,4BAA6ByB,kBAAkB,IAEtFhD,EAAO+C,OAAO,UAAYxB,KAAM,qBAAsByB,kBAAkB,IACxE/C,KAAKqC,aAAauC,UAAU7E,EAAO8E,QAAS9E,EAAOqD,IAAIgB,QAASrE,EAAOqD,IAAIiB,OAAQtE,EAAOqD,IAAIkB,SAAUvE,EAAOqD,IAAImB,UAAWxE,EAAOqD,IAAIC,SAAUtD,EAAOqD,IAAIE,QAASvD,EAAOqD,IAAIG,UAAWxD,EAAOqD,IAAII,YACxMxD,KAAK+Q,qBAAqB,WACM,IAA5BhR,EAAOiD,UAAUC,QAAgBlD,EAAOuG,eAAenB,OAAS,IAChEpF,EAAOqD,IAAIC,UAAYtD,EAAOsH,SAASC,iBAAiB9G,EACxDT,EAAOqD,IAAIE,SAAWvD,EAAOsH,SAASC,iBAAiB7G,GAE3DT,KAAK6H,cAAe,EACpB9H,EAAOmF,QAAUmc,CACjB,IAAIE,GAAgBxhB,EAAOse,SAC3Bte,GAAOse,WAAY,EACnBre,KAAKqC,aAAasC,OAAS,OAC3B5E,EAAO+C,OAAO,SAAWxB,KAAM,iBAAkByB,kBAAkB,IACnEhD,EAAOqD,IAAIC,UAAYtD,EAAOsH,SAAS4B,yBAAyBzI,EAChET,EAAOqD,IAAIE,SAAWvD,EAAOsH,SAAS4B,yBAAyBxI,EAC/DV,EAAO+C,OAAO,iBAAmBxB,KAAM,iBAAkByB,kBAAkB,EACvEvB,OAAS+D,QAASvF,KAAKqC,aAAcwG,OAAQ,QACjD9I,EAAOqD,IAAIC,UAAYtD,EAAOsH,SAAS4B,yBAAyBzI,EAChET,EAAOqD,IAAIE,SAAWvD,EAAOsH,SAAS4B,yBAAyBxI,EAC/DV,EAAOse,UAAYkD,EACnBvhB,KAAKqC,aAAasC,OAASD,EAC3B3E,EAAO6C,UAAY0e,GAEvB7S,EAAK5N,UAAU2Q,eAAiB,WAC5BxR,KAAKD,OAAOsH,SAASC,kBAAqB9G,EAAG,EAAGC,EAAG,GACnDT,KAAKD,OAAOsH,SAAS0C,wBAA2BvJ,EAAG,EAAGC,EAAG,GACzDT,KAAKD,OAAOsH,SAAS4B,0BAA6BzI,EAAG,EAAGC,EAAG,IAE/DgO,EAAK5N,UAAU4Q,kBAAoB,SAAU2J,GACzC,GAAIrb,GAASC,KAAKD,MAClB,IAAIA,EAAOiD,UAAUC,OAAS,IAAO,GAAKlD,EAAOiD,UAAUC,OAAS,KAAQ,EAAG,CAC3ElD,EAAOqD,IAAIC,UAAYtD,EAAOqC,YAAY/B,MAAQN,EAAOqD,IAAII,YAAc,EAC3EzD,EAAOqD,IAAIE,SAAWvD,EAAOqC,YAAY9B,OAASP,EAAOqD,IAAIG,WAAa,CAC1E,IAAImB,GAAO3E,EAAOqD,IAAIG,SACtBxD,GAAOqD,IAAIG,UAAYxD,EAAOqD,IAAII,WAClCzD,EAAOqD,IAAII,WAAakB,MAGpBzC,qBAAkBmZ,KAClBrb,EAAOqD,IAAIC,UAAYtD,EAAOqC,YAAY/B,MAAQN,EAAOqD,IAAIG,WAAa,EAC1ExD,EAAOqD,IAAIE,SAAWvD,EAAOqC,YAAY9B,OAASP,EAAOqD,IAAII,YAAc,IAIvFiL,EAAK5N,UAAU6Q,iBAAmB,WAC9B,GAAI3R,GAASC,KAAKD,OACdkE,GAAQmZ,aAAcrd,EAAOqd,aAEjC,IADApd,KAAKqC,aAAasC,OAASV,EAAkB,aACR,IAAjClE,EAAOuG,eAAenB,OAAc,CACpC,GAAI8D,GAA2BjF,YAAWjE,EAAOsH,SAAS4B,6BAA8B,GACpFE,GAAehJ,OAAQJ,EAAOqD,IAAIC,SAAUjD,OAAQL,EAAOqD,IAAIE,QAASjD,MAAON,EAAOqD,IAAIG,UAC1FjD,OAAQP,EAAOqD,IAAII,WACvBxD,MAAKuR,2BACLxR,EAAOsH,SAAS4B,yBAA2BA,EAC3ClJ,EAAOqD,IAAIC,SAAW8F,EAAWhJ,OACjCJ,EAAOqD,IAAIE,QAAU6F,EAAW/I,OAChCL,EAAOqD,IAAIG,UAAY4F,EAAW9I,MAClCN,EAAOqD,IAAII,WAAa2F,EAAW7I,WAGnCN,MAAKuR,0BAELxR,GAAOyF,cACPzF,EAAO+C,OAAO,QAAUxB,KAAM,aAAcyB,kBAAkB,EAC1DvB,OAAS+D,QAASvF,KAAKqC,aAAc+H,OAAQ,KAAMC,OAAQ,OAEnE,IAAIoF,GAAazP,KAAKqC,aAAasC,MACnC3E,MAAKqC,aAAasC,OAAS5E,EAAOyhB,mBAClCzhB,EAAO+C,OAAO,SAAWxB,KAAM,iBAAkByB,kBAAkB,IACnEhD,EAAO+C,OAAO,iBAAmBxB,KAAM,iBAAkByB,kBAAkB,EACvEvB,OAAS+D,QAASvF,KAAKqC,aAAcwG,OAAQ,QACjD7I,KAAKqC,aAAasC,OAAS8K,GAE/BhB,EAAK5N,UAAU8Q,cAAgB,SAAU1N,GACrC,GAAIlE,GAASC,KAAKD,OACd0hB,IAAQxd,CACZA,GAAMA,GAAYlE,EAAOiG,QACzBjG,EAAOiD,UAAUsc,eAAiBrb,EAAIsF,SACtCxJ,EAAOiD,UAAU4C,kBAAoB3B,EAAIyd,YACpCD,EAIGxd,EAAIrB,UAAUwC,OAA+C,SAAtCnB,EAAIrB,UAAUwC,MAAMuH,MAAM,KAAK,GACtD5M,EAAOiD,UAAUa,WAAaI,EAAIsF,SAGlCxJ,EAAOiD,UAAUa,WAAaI,EAAIyd,YAPtC3hB,EAAOiD,UAAUa,WAAaI,EAAIsF,SAUtCxJ,EAAOiN,eAAgBC,cAAgBpJ,WAAYI,EAAIJ,cAAgB,GACvE9D,EAAO+C,OAAO,aAAexB,KAAM,uBAAwByB,kBAAkB,EAAOvB,OAAS0L,kBAAmBjJ,EAAIiJ,qBACpHnN,EAAOsH,SAASC,iBAAmBtD,YAAWC,EAAIqD,qBAAsB,GACxEvH,EAAOsH,SAAS0C,uBAAyB/F,YAAWC,EAAI8F,2BAA4B,GACpFhK,EAAOsH,SAAS4B,yBAA2BjF,YAAWC,EAAIgF,6BAA8B,EACxF,IAAI9F,GAAQa,YAAWC,EAAI1D,qBAAsB,EACjDR,GAAO+C,OAAO,QAAUxB,KAAM,sBAAuByB,kBAAkB,EAAOvB,OAAS2B,MAAOA,KAC9FpD,EAAOuG,eAAiBtC,YAAWC,EAAIqC,mBAAoB,GAC3DvG,EAAOiD,UAAUC,OAASgB,EAAIhB,OAC9BlD,EAAOiD,UAAUU,cAAgBO,EAAIP,cACrC3D,EAAOqD,IAAIC,SAAWY,EAAIkF,WAAWhJ,OACrCJ,EAAOqD,IAAIE,QAAUW,EAAIkF,WAAW/I,OACpCL,EAAOqD,IAAIG,UAAYU,EAAIkF,WAAW9I,MACtCN,EAAOqD,IAAII,WAAaS,EAAIkF,WAAW7I,OACvCP,EAAOqD,IAAIgB,QAAUH,EAAI0d,UAAUxhB,OACnCJ,EAAOqD,IAAIiB,OAASJ,EAAI0d,UAAUvhB,OAClCL,EAAOqD,IAAIkB,SAAWL,EAAI0d,UAAUthB,MACpCN,EAAOqD,IAAImB,UAAYN,EAAI0d,UAAUrhB,OACjC2D,EAAI4B,mBACJ9F,EAAO8F,iBAAmB5B,EAAI4B,kBAElC7F,KAAKqC,aAAasC,OAASV,EAAIU,OAC/B5E,EAAO+C,OAAO,UAAYxB,KAAM,wBAAyByB,kBAAkB,EAAOvB,OAAS+b,qBAAsBtZ,EAAI2d,iBACrH,IACI7d,GADAyB,EAAezF,EAAOyF,YAEtBvD,qBAAkBlC,EAAOgE,oBACzBA,EAAqB,MAGrBA,EAAqBC,YAAWjE,EAAOgE,uBAAwB,GAC/DhE,EAAOgE,mBAAqB,MAEhChE,EAAOyF,cAAe,EACtBxF,KAAK6hB,uBAAuB5d,GAAK,GACD,IAA5BlE,EAAOiD,UAAUC,SACsB,KAAnClD,EAAOiD,UAAUU,cACjB3D,EAAO+C,OAAO,aAAexB,KAAM,YAAayB,kBAAkB,EAC9DvB,OAAS0c,gBAAiB,KAAM4D,cAAe,QAGnD/hB,EAAO+C,OAAO,aAAexB,KAAM,kBAAmBE,OAAS0I,MAAO,EAAGC,MAAO,KAEpFpK,EAAOqD,IAAIC,SAAWY,EAAIkF,WAAWhJ,OACrCJ,EAAOqD,IAAIE,QAAUW,EAAIkF,WAAW/I,OACpCL,EAAOsH,SAAS0C,uBAAyB/F,YAAWC,EAAI8F,2BAA4B,GACpFhK,EAAOsH,SAAS4B,yBAA2BjF,YAAWC,EAAIgF,6BAA8B,IAE5FlJ,EAAO6C,UAAYoB,YAAWC,EAAIrB,cAAe,GACjD5C,KAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOwC,YAAYlC,MAAON,EAAOwC,YAAYjC,QACpC,IAAvCP,EAAO6C,UAAUC,YAAYxC,OAAuD,IAAxCN,EAAO6C,UAAUC,YAAYvC,QACzEN,KAAK2Q,WAAW,YAAa,KAAM,KAAM,MAAM,EAEnD,IAAI/N,GAAYoB,YAAWC,EAAIrB,cAAe,GAC1Cmf,GAAoB,CACxB,IAAIhiB,EAAO8F,iBAAiBV,OAAS,EAAG,CACpC,GAAIW,IAAWwI,WAAYvO,EAAO8F,iBAClC9F,GAAO+C,OAAO,SAAWxB,KAAM,sBAAuByB,kBAAkB,EACpEvB,OAAS8M,WAAYvO,EAAO8F,iBAAkB0I,uBAAwB,KAAMtK,IAAK6B,KACrF/F,EAAO8F,iBAAmBC,EAAmB,WAEjD,GAAID,GAAmB7B,YAAWjE,EAAO8F,qBAAsB,EAC/D,KAAK4b,GAAS5b,EAAiBV,OAAS,EAAG,CACvC4c,GAAoB,CACpB,KAAK,GAAI/c,GAAI,EAAGA,EAAIa,EAAiBV,OAAQH,IACb,mBAAxBa,EAAiBb,IAAmD,iBAAxBa,EAAiBb,KAC7DjF,EAAO6C,UAAYoB,YAAWD,MAAwB,GACtD/D,KAAK8P,oBAAqB,GAE9B/P,EAAO+C,OAAO,aAAexB,KAAM,kBAAmByB,kBAAkB,EAAOvB,OAAS2N,KAAMtJ,EAAiBb,KAEnHpC,GAAYoB,YAAWjE,EAAO6C,cAAe,GAC7C5C,KAAKwR,iBACLzR,EAAO6C,UAAYA,EACnB5C,KAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOwC,YAAYlC,MAAON,EAAOwC,YAAYjC,QACpC,IAAvCP,EAAO6C,UAAUC,YAAYxC,OAAuD,IAAxCN,EAAO6C,UAAUC,YAAYvC,QACzEN,KAAK2Q,WAAW,YAAa,KAAM,KAAM,MAAM,GAE/C1M,EAAIhB,SAAWlD,EAAOiD,UAAUC,SAChClD,EAAOiD,UAAUsc,eAAiB,KAClCvf,EAAOiD,UAAUa,WAAa,GAElC9D,EAAO+C,OAAO,iBAAmBxB,KAAM,gBAAiByB,kBAAkB,IACtE/C,KAAK8P,qBACL9P,KAAK8P,oBAAqB,GAGlC/P,EAAO8F,iBAAmBA,EACrB7F,KAAK6P,gBAAmBkS,IACzBhiB,EAAO+C,OAAO,iBAAmBxB,KAAM,gBAAiByB,kBAAkB,IAC1EhD,EAAO+C,OAAO,iBAAmBxB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAASuD,eAAgB,QACxGhF,EAAOqD,IAAIC,SAAWY,EAAIkF,WAAWhJ,OACrCJ,EAAOqD,IAAIE,QAAUW,EAAIkF,WAAW/I,QAExCL,EAAO6C,UAAYA,EACnB7C,EAAOyF,aAAeA,EAClBvD,oBAAkB8B,GAClBhE,EAAOgE,mBAAqB,MAG5BhE,EAAOgE,mBAAqBC,YAAWD,MAAwB,GAC3DhE,EAAOgE,oBAAsB9B,oBAAkBlC,EAAOgE,mBAAmBqB,SACzErF,EAAOgE,mBAAqB,QAIxC0K,EAAK5N,UAAUghB,uBAAyB,SAAU5d,EAAKwd,GACnD,GAAI1hB,GAASC,KAAKD,OACd2E,EAAO1E,KAAKqC,aAAasC,MAC7B5E,GAAOiiB,aAAahiB,KAAKqC,cACzBtC,EAAOiiB,aAAahiB,KAAKwC,cACzBxC,KAAKqC,aAAaqF,aAAa,EAAG,EAAG,EAAG,EAAG,EAAG,GAC1C+Z,EACAzhB,KAAK+Q,qBAAqB,WAG1B/Q,KAAKqb,iBAAiBrb,KAAKqC,aAAc,WAE7CtC,EAAO+C,OAAO,aAAexB,KAAM,4BAA6ByB,kBAAkB,IAClFhD,EAAO+C,OAAO,UAAYxB,KAAM,qBAAsByB,kBAAkB,IACxE/C,KAAKqC,aAAauC,UAAU7E,EAAO8E,QAAS9E,EAAOqD,IAAIgB,QAASrE,EAAOqD,IAAIiB,OAAQtE,EAAOqD,IAAIkB,SAAUvE,EAAOqD,IAAImB,UAAWxE,EAAOqD,IAAIC,SAAUtD,EAAOqD,IAAIE,QAASvD,EAAOqD,IAAIG,UAAWxD,EAAOqD,IAAII,YACpMie,EACAzhB,KAAK+Q,qBAAqB,WAG1B/Q,KAAKqb,iBAAiBrb,KAAKqC,aAAc,WAE7CtC,EAAOqD,IAAIC,SAAWtD,EAAOiG,QAAQmD,WAAWhJ,OAChDJ,EAAOqD,IAAIE,QAAUvD,EAAOiG,QAAQmD,WAAW/I,MAC/C,IAAIwC,GAAYoB,YAAWC,EAAIrB,cAAe,EAE9C,IADA5C,KAAKqC,aAAasC,OAAS,OACvB3E,KAAK6P,eACL9P,EAAO+C,OAAO,SAAWxB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAASuD,eAAgB,QAChGhF,EAAO+C,OAAO,iBAAmBxB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAASuD,eAAgB,YAEvG,CACDhF,EAAOqD,IAAIC,SAAWY,EAAIkF,WAAWhJ,OACrCJ,EAAOqD,IAAIE,QAAUW,EAAIkF,WAAW/I,OACpCL,EAAOqD,IAAIG,UAAYU,EAAIkF,WAAW9I,MACtCN,EAAOqD,IAAII,WAAaS,EAAIkF,WAAW7I,OACvCP,EAAOqD,IAAIgB,QAAUH,EAAI0d,UAAUxhB,OACnCJ,EAAOqD,IAAIiB,OAASJ,EAAI0d,UAAUvhB,OAClCL,EAAOqD,IAAIkB,SAAWL,EAAI0d,UAAUthB,MACpCN,EAAOqD,IAAImB,UAAYN,EAAI0d,UAAUrhB,MACrC,IAAI6I,IAAehJ,OAAQJ,EAAOqD,IAAIC,SAAUjD,OAAQL,EAAOqD,IAAIE,QAASjD,MAAON,EAAOqD,IAAIG,UAC1FjD,OAAQP,EAAOqD,IAAII,WACvBzD,GAAOqD,IAAIC,SAAWY,EAAIrB,UAAUC,YAAY1C,OAChDJ,EAAOqD,IAAIE,QAAUW,EAAIrB,UAAUC,YAAYzC,OAC/CL,EAAOqD,IAAIG,UAAYU,EAAIrB,UAAUC,YAAYxC,MACjDN,EAAOqD,IAAII,WAAaS,EAAIrB,UAAUC,YAAYvC,OAClDP,EAAO+C,OAAO,SAAWxB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAASuD,eAAgB,QAChGhF,EAAO+C,OAAO,iBAAmBxB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAASuD,eAAgB,QACxGhF,EAAOqD,IAAIC,SAAW8F,EAAWhJ,OACjCJ,EAAOqD,IAAIE,QAAU6F,EAAW/I,OAChCL,EAAOqD,IAAIG,UAAY4F,EAAW9I,MAClCN,EAAOqD,IAAII,WAAa2F,EAAW7I,OAEvCP,EAAO6C,UAAYA,EACnB5C,KAAKqC,aAAasC,OAASD,GAE/B+J,EAAK5N,UAAU+Q,iBAAmB,SAAUpR,EAAGC,EAAGkG,GAC9C,GAAI5G,GAASC,KAAKD,OACd4I,GAAUnI,EAAIT,EAAOqD,IAAIC,UAAYtD,EAAOqD,IAAIG,UAChDqF,GAAUnI,EAAIV,EAAOqD,IAAIE,SAAWvD,EAAOqD,IAAII,WAC/C0D,EAAanH,EAAOmH,UAYxB,IAXAnH,EAAOmH,YAAa,EACpBnH,EAAOiN,eAAgBC,cAAgB9F,WAAa3G,EAAGA,EAAGC,EAAGA,MAAS,GACzD,WAATkG,EACA5G,EAAO+C,OAAO,aAAexB,KAAM,aAAcyB,kBAAkB,EAC/DvB,OAASqC,WAAY,GAAIsD,UAAW,QAE1B,YAATR,GACL5G,EAAO+C,OAAO,aAAexB,KAAM,aAAcyB,kBAAkB,EAC/DvB,OAASqC,YAAa,GAAIsD,UAAW,QAE7CpH,EAAOmH,WAAaA,EAChBnH,EAAOiD,UAAUa,WAAa,EAAG,CACjC,GAAIR,GAAWtD,EAAOqD,IAAIC,SACtBC,EAAUvD,EAAOqD,IAAIE,QACrBV,EAAYoB,YAAWjE,EAAO6C,cAAe,EACjD,IAAgC,IAA5B7C,EAAOiD,UAAUC,OACjBlD,EAAOqD,IAAIC,SAAW7C,EAAKmI,EAAS5I,EAAOqD,IAAIG,UAC/CxD,EAAOqD,IAAIE,QAAU7C,EAAKmI,EAAS7I,EAAOqD,IAAII,WAC9CxD,KAAKiiB,iBAAiBliB,EAAOqD,IAAIC,SAAWA,EAAUtD,EAAOqD,IAAIE,QAAUA,OAE1E,CACD,GAAI8a,GAAYre,EAAOqe,SACvBre,GAAOqe,WAAY,CACnB,IAAIlZ,GAAUlB,YAAWjE,EAAOmF,YAAa,GACzC+B,EAAYjD,YAAWjE,EAAOkH,cAAe,EACjDlH,GAAOmF,WACPnF,EAAOkH,aACPlH,EAAOiH,gBAAkB,CACzB,IAAIlB,IAAWsD,aAAc,KAC7BrJ,GAAO+C,OAAO,iBAAmBxB,KAAM,kBAAmByB,kBAAkB,EACxEvB,OAASyC,IAAK6B,IAClB,IAAIuD,GAAmBvD,EAAqB,YAC5C/F,GAAO+C,OAAO,iBAAmBxB,KAAM,kBAAmByB,kBAAkB,EACxEvB,OAASyC,KAAOmF,oBACpBrJ,EAAOsH,SAAS4C,oBAAuBzJ,EAAIA,EAAKmI,EAAS5I,EAAOqD,IAAIG,UAAcF,EAC9E5C,EAAIA,EAAKmI,EAAS7I,EAAOqD,IAAII,WAAeF,GAChDvD,EAAO+C,OAAO,aAAexB,KAAM,YAAayB,kBAAkB,EAC9DvB,OAAS0c,gBAAiB,KAAM4D,cAAe,QACnD/hB,EAAOqe,UAAYA,EACnBre,EAAOmF,QAAUA,EACjBnF,EAAOkH,UAAYA,EACnBlH,EAAOiH,gBAAkBjH,EAAOkH,UAAU9B,OAC1CpF,EAAO+C,OAAO,iBAAmBxB,KAAM,kBAAmByB,kBAAkB,EACxEvB,OAASyC,KAAOmF,aAAcC,MAClCtJ,EAAO+C,OAAO,SAAWxB,KAAM,aAAcyB,kBAAkB,EAC3DvB,OAAS0I,MAAOnK,EAAOsH,SAAS4C,mBAAmBzJ,EAAG2J,MAAOpK,EAAOsH,SAAS4C,mBAAmBxJ,EAAG6K,UAAW,MAClHvL,EAAO+C,OAAO,iBAAmBxB,KAAM,aAAcyB,kBAAkB,EACnEvB,OAAS0I,MAAOnK,EAAOsH,SAAS4C,mBAAmBzJ,EAAG2J,MAAOpK,EAAOsH,SAAS4C,mBAAmBxJ,EAAG6K,UAAW,MAEtHtL,KAAKkiB,cAActf,GACnB7C,EAAO6C,UAAYA,EACwB,IAAvC7C,EAAO6C,UAAUC,YAAYxC,OAAuD,IAAxCN,EAAO6C,UAAUC,YAAYvC,QACzEN,KAAK2Q,WAAW,YAAa,KAAM,KAAM,MAAM,KAI3DlC,EAAK5N,UAAUqhB,cAAgB,SAAUtf,GACrC,GAAI7C,GAASC,KAAKD,MAClB,IAAoC,IAAhC6C,EAAUC,YAAYxC,OAAgD,IAAjCuC,EAAUC,YAAYvC,OAAc,CACzE,GAAI+C,GAAWtD,EAAOqD,IAAIC,SACtBC,EAAUvD,EAAOqD,IAAIE,QACrBH,GAAU3C,EAAG,EAAGC,EAAG,EAavB,IAZIV,EAAOqD,IAAIC,SAAWT,EAAUC,YAAY1C,OAC5CgD,EAAM3C,EAAIT,EAAOqD,IAAIC,SAAWT,EAAUC,YAAY1C,OAEjDJ,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,UAAYX,EAAUC,YAAY1C,OAASyC,EAAUC,YAAYxC,QACvG8C,EAAM3C,EAAKT,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,WAAcX,EAAUC,YAAY1C,OAASyC,EAAUC,YAAYxC,QAE/GN,EAAOqD,IAAIE,QAAUV,EAAUC,YAAYzC,OAC3C+C,EAAM1C,EAAIV,EAAOqD,IAAIE,QAAUV,EAAUC,YAAYzC,OAEhDL,EAAOqD,IAAIE,QAAUvD,EAAOqD,IAAII,WAAaZ,EAAUC,YAAYzC,OAASwC,EAAUC,YAAYvC,SACvG6C,EAAM1C,EAAKV,EAAOqD,IAAIE,QAAUvD,EAAOqD,IAAII,YAAeZ,EAAUC,YAAYzC,OAASwC,EAAUC,YAAYvC,SAEnF,IAA5BP,EAAOiD,UAAUC,OACjBlD,EAAOqD,IAAIC,UAAYF,EAAM3C,EAC7BT,EAAOqD,IAAIE,SAAWH,EAAM1C,EAC5BT,KAAKiiB,iBAAiBliB,EAAOqD,IAAIC,SAAWA,EAAUtD,EAAOqD,IAAIE,QAAUA,OAE1E,CACD,GAAI8a,GAAYre,EAAOqe,SACvBre,GAAOqe,WAAY,CACnB,IAAIlZ,GAAUlB,YAAWjE,EAAOmF,YAAa,GACzC+B,EAAYjD,YAAWjE,EAAOkH,cAAe,EACjDlH,GAAOmF,WACPnF,EAAOkH,aACPlH,EAAOiH,gBAAkB,CACzB,IAAIlB,IAAWsD,aAAc,KAC7BrJ,GAAO+C,OAAO,iBAAmBxB,KAAM,kBAAmByB,kBAAkB,EACxEvB,OAASyC,IAAK6B,IAClB,IAAIuD,GAAmBvD,EAAqB,YAC5C/F,GAAO+C,OAAO,iBAAmBxB,KAAM,kBAAmByB,kBAAkB,EACxEvB,OAASyC,KAAOmF,oBACpBrJ,EAAOqD,IAAIC,UAAYF,EAAM3C,EAC7BT,EAAOqD,IAAIE,SAAWH,EAAM1C,EAC5BV,EAAOsH,SAAS4C,oBAAuBzJ,EAAGT,EAAOqD,IAAIC,SAAWA,EAAU5C,EAAGV,EAAOqD,IAAIE,QAAUA,GAClGvD,EAAO+C,OAAO,aAAexB,KAAM,YAAayB,kBAAkB,EAC9DvB,OAAS0c,gBAAiB,KAAM4D,cAAe,QACnD/hB,EAAOqe,UAAYA,EACnBre,EAAOmF,QAAUA,EACjBnF,EAAOkH,UAAYA,EACnBlH,EAAOiH,gBAAkBjH,EAAOkH,UAAU9B,OAC1CpF,EAAO+C,OAAO,iBAAmBxB,KAAM,kBAAmByB,kBAAkB,EACxEvB,OAASyC,KAAOmF,aAAcC,MAClCtJ,EAAO+C,OAAO,SAAWxB,KAAM,aAAcyB,kBAAkB,EAC3DvB,OAAS0I,MAAOnK,EAAOsH,SAAS4C,mBAAmBzJ,EAAG2J,MAAOpK,EAAOsH,SAAS4C,mBAAmBxJ,EAAG6K,UAAW,MAClHvL,EAAO+C,OAAO,iBAAmBxB,KAAM,aAAcyB,kBAAkB,EACnEvB,OAAS0I,MAAOnK,EAAOsH,SAAS4C,mBAAmBzJ,EAAG2J,MAAOpK,EAAOsH,SAAS4C,mBAAmBxJ,EAAG6K,UAAW,SAI9HmD,EAAK5N,UAAUohB,iBAAmB,SAAUzhB,EAAGC,GAC3C,GAAIV,GAASC,KAAKD,MAClBA,GAAO+C,OAAO,SAAWxB,KAAM,aAAcyB,kBAAkB,EAC3DvB,OAAS0I,MAAO1J,EAAG2J,MAAO1J,EAAG6K,UAAW,MAC5CvL,EAAO+C,OAAO,iBAAmBxB,KAAM,aAAcyB,kBAAkB,EACnEvB,OAAS0I,MAAO1J,EAAG2J,MAAO1J,EAAG6K,UAAW,MAC5CtL,KAAKiR,aAAY,EACjB,IAAIhN,IAAQ5D,MAAO,EAAGC,OAAQ,EAC9BP,GAAO+C,OAAO,aAAexB,KAAM,mBAAoByB,kBAAkB,EACrEvB,OAASnB,MAAON,EAAOqD,IAAIkB,SAAUhE,OAAQP,EAAOqD,IAAImB,UAAWN,IAAKA,IAC5E,IAAIC,GAAeD,CACnBC,GAAa7D,OAAU6D,EAAa7D,MAAQN,EAAOiD,UAAUa,WAC7DK,EAAa5D,QAAW4D,EAAa5D,OAASP,EAAOiD,UAAUa,WAC/D9D,EAAOsH,SAASC,iBAAiB9G,GAAKA,EACtCT,EAAOsH,SAASC,iBAAiB7G,GAAKA,EACtCV,EAAO+C,OAAO,QAAUxB,KAAM,sBAAuByB,kBAAkB,EAAOvB,OAAS2B,OAAS3C,EAAG,EAAGC,EAAG,OAE7GgO,EAAK5N,UAAUshB,aAAe,WAC1B,GAAIpiB,GAASC,KAAKD,OACdqiB,EAAkBriB,EAAOsiB,eAAe/f,WAAW,KACvDggB,eAAYviB,EAAOgO,SACnBhO,EAAOgO,QAAQ8N,MAAMC,QAAU,KAC/B,IAAIyG,GAAUxF,SAASZ,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,WAC3DuF,KACAA,EAAQ1G,MAAMG,QAAU,OAE5B,IAAI/X,IAAQue,gBAAiB,KAC7B,IAAKtW,aASGnM,EAAOgO,QAAQoO,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,kBACvDjd,EAAOsc,cAAgBtc,EAAOgO,QAAQoO,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,gBAAgBvY,kBARlG,IADA1E,EAAO+C,OAAO,WAAaxB,KAAM,qBAAsBE,OAASyC,IAAKA,KAC/B,IAAlCA,EAAqB,gBAAEkB,QACtBlD,oBAAkB8a,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,aAAe,CAC9E,GAAI1c,GAASP,EAAOgO,QAAQoO,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,gBAAgBvY,YACpF1E,GAAO+C,OAAO,WAAaxB,KAAM,mBAAoBE,OAASlB,OAAQA,KAe9E,GAPAP,EAAOmC,QACPnC,EAAO2iB,SACP3iB,EAAOiD,UAAUC,OAAS,EAC1BlD,EAAOiD,UAAUa,WAAa,EAC9B9D,EAAO0L,eAAgB,EACvB1L,EAAOgE,mBAAqB,KAEf,iBADM/D,MAAa,QACT,CACnB,GAAI2O,GAAW3O,KAAK2iB,QAAQhW,MAAM,IASlC,IARIgC,EAASxJ,OAAS,GAClBwJ,EAAWA,EAASA,EAASxJ,OAAS,GAAGwH,MAAM,KAC/C3M,KAAK2O,SAAWA,EAASA,EAASxJ,OAAS,IAG3CnF,KAAK2O,SAAW,cAEpB3O,KAAKgS,SAAWhS,KAAK4iB,wBAAwB5iB,KAAK2iB,SAC9C3iB,KAAKgS,SAAU,CACfhS,KAAKgS,SAAWjS,EAAO+G,aAAa9G,KAAKgS,SACzC,IAAIA,GAAWhS,KAAKgS,SAASY,aACZ,SAAbZ,GAAmC,SAAbA,IACtBhS,KAAKgS,SAAW,OAChBA,EAAW,QAEE,SAAbA,GAAoC,QAAbA,GAAmC,QAAbA,IAC7ChS,KAAKgS,SAAW,MAGxBhS,KAAKwb,YAAYxb,KAAK2iB,aAGtB3iB,MAAK2O,SAAW,cAChB3O,KAAKgS,SAAW,KAChBjS,EAAOqC,YAAc2a,SAASZ,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,gBACtEjd,EAAOwC,YAAcwa,SAASZ,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,gBACtEhd,KAAKqC,aAAetC,EAAOqC,YAAYE,WAAW,MAClDtC,KAAKwC,aAAezC,EAAOwC,YAAYD,WAAW,MAClDvC,EAAOiiB,aAAahiB,KAAKqC,cACzBtC,EAAOiiB,aAAahiB,KAAKwC,cACzBzC,EAAOiiB,aAAaI,GACpBriB,EAAOsiB,eAAehiB,MAAQL,KAAK2iB,QAAQtiB,MAC3CN,EAAOsiB,eAAe/hB,OAASN,KAAK2iB,QAAQriB,OAC5C8hB,EAAgBS,aAAa7iB,KAAK2iB,QAAS,EAAG,GAC9C5iB,EAAO8E,QAAQ4W,IAAM1b,EAAOsiB,eAAeS,aAGnDrU,EAAK5N,UAAUuR,YAAc,WACzB,GAAIrS,GAASC,KAAKD,MAClBA,GAAOgjB,SACH/iB,KAAKiQ,eACLlQ,EAAO0L,cAAgBzL,KAAKiQ,eAAgB,EAC5ClQ,EAAOmC,QACPlC,KAAKgjB,qBAAqBhjB,KAAKijB,UAAWjjB,KAAK2iB,WAG/C3iB,KAAKkC,QACLlC,KAAKmiB,gBAEJjW,cACDgX,eAAanG,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,WAAY,UAAUlc,UAEnFd,KAAKgQ,eAAgB,GAEzBvB,EAAK5N,UAAUwR,iBAAmB,WAC9B,GAAItS,GAASC,KAAKD,MAClBC,MAAKmjB,WAAapjB,EAAO8E,QAAQ4W,IAC7Bzb,KAAKiQ,eACLlQ,EAAO0L,cAAgBzL,KAAKiQ,eAAgB,EAC5ClQ,EAAOmC,QACPlC,KAAKgjB,qBAAqBhjB,KAAKijB,UAAWjjB,KAAK2iB,WAG/C3iB,KAAKkC,QACLlC,KAAKmiB,gBAEJjW,cACDgX,eAAanG,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,WAAY,UAAUlc,UAEnFd,KAAKgQ,eAAgB,GAEzBvB,EAAK5N,UAAUuiB,gBAAkB,WAC7BpjB,KAAKD,OAAOgO,QAAQoO,cAAc,IAAMnc,KAAKD,OAAOgO,QAAQiP,GAAK,WAAWnB,MAAMG,QAAU,QAC/E,GAAIqH,WACbC,OAAQ,uBACRC,eAAe,EACfC,QAAS,sEACTC,OAAQ1G,SAAS0F,eAAe,UAChCpiB,MAAO,QACPqjB,SAAS,EACTC,mBAAqBC,OAAQ,QAC7BC,MAAO7jB,KAAKqS,iBAAiByR,KAAK9jB,MAClC+jB,UACMC,MAAOhkB,KAAKqS,iBAAiByR,KAAK9jB,MAChCikB,aAAeT,QAAS,KAAMU,QAAS,qBAEzCF,MAAOhkB,KAAKoS,YAAY0R,KAAK9jB,MAC3BikB,aAAeT,QAAS,MAAOW,WAAW,EAAMD,QAAS,uBAG9DE,SAAS,IAAMpkB,KAAKD,OAAOgO,QAAQiP,GAAK,YAEnDvO,EAAK5N,UAAUwjB,gBAAkB,WACzBrkB,KAAKD,OAAO0L,eAYZzL,KAAKkC,QACLlC,KAAKmiB,gBAGLniB,KAAKmiB,gBAGb1T,EAAK5N,UAAUgR,KAAO,SAAUyS,GACvBtkB,KAAKD,OAAOyL,WACbxL,KAAK2iB,QAAU2B,EACftkB,KAAKqkB,oBAGb5V,EAAK5N,UAAUiR,iBAAmB,SAAUhM,GACxCA,EAAwB,gBAAI9F,KAAK0O,kBAErCD,EAAK5N,UAAU+hB,wBAA0B,SAAU2B,GAC/C,GAAIC,GAAeD,EAAIE,YAAY,IACnC,QAAsB,IAAlBD,EACOD,EAAIG,MAAMF,EAAe,GAAG5R,cAEhC,MAEXnE,EAAK5N,UAAUkR,WAAa,SAAU4S,EAAcvjB,GAChD,GAAIrB,GAASC,KAAKD,MAClB,KAAKA,EAAOyL,SAAU,CAElB,GAAIoZ,GAAYxjB,EAAKqiB,OAAOoB,MAAM,GAE9BC,EAAWF,EACXG,EAAgBD,EAASE,MAAQF,EAASE,KAAKrY,MAAM,KAAK,GAAGiG,aACjE,IAAImS,IAA2E,KAAzD,MAAO,OAAQ,MAAO,OAAOvG,QAAQuG,GAEvD,WADA/kB,MAAKyc,cAOT,IAJA6F,cAAYviB,EAAOgO,SACnBhO,EAAOgO,QAAQ8N,MAAMC,QAAU,MAC/B9b,KAAKijB,UAAY0B,EACjBI,EAAgBD,EAASE,MAAQF,EAASE,KAAKrY,MAAM,KAAK,GACvC,CACf,GAAIqF,GAAWjS,EAAO+G,aAAaie,EAE/B/kB,MAAKgS,SADQ,QAAbA,GAAmC,QAAbA,EACN,OAGAA,MAIpBhS,MAAKgS,SAAW,IAGpB,IACIuS,GADQU,OAAOC,IACHC,gBAAgBP,EAChC5kB,MAAK2iB,QAAU4B,EACXxkB,EAAO0L,gBAAkBzL,KAAKgQ,eAAiBjQ,EAAOkH,UAAU9B,OAAS,GAAKpF,EAAOmF,QAAQC,OAAS,IACtGnF,KAAKiQ,eAAgB,EAChB/D,aAIDnM,EAAOsM,UAAUC,kBAAkB,gBAHnCtM,KAAKojB,mBAOTpjB,KAAKgjB,qBAAqB2B,EAAcJ,KAIpD9V,EAAK5N,UAAUmiB,qBAAuB,SAAU2B,EAAcJ,GAC1D,GAAIxkB,GAASC,KAAKD,MACdkC,qBAAkBlC,EAAOqlB,mBACzBrlB,EAAOmC,QACPnC,EAAO2iB,UAEX1iB,KAAK2O,SAAWgW,EAAanjB,MAAMmL,MAAM,MAAMgY,EAAanjB,MAAMmL,MAAM,MAAMxH,OAAS,GACvFnF,KAAK2O,SAAW3O,KAAK2O,SAAShC,MAAM,KAAK,GACzC3M,KAAKwb,YAAY+I,EAAIc,YACrBV,EAAanjB,MAAQ,IAEzBiN,EAAK5N,UAAUyR,qBAAuB,SAAU3L,EAAM/D,GAClD,GAAI7C,GAASC,KAAKD,MAClB,IAAIA,EAAO6C,UAAUwC,MAAO,CAExB,IAAK,GADDkgB,IAAY,EACPtgB,EAAI,EAAGA,EAAIjF,EAAOuG,eAAenB,OAAQH,IAC9C,GAAiC,KAA7BjF,EAAOuG,eAAetB,KAA2C,KAA9BjF,EAAOuG,eAAetB,GAAY,CACrEsgB,GAAY,CACZ,OAGR,GAAIA,EAAW,CACX,GAAIzhB,GAAa9D,EAAOiD,UAAUa,UAGlC,IAFA9D,EAAOmF,QAAQe,KAAKlG,EAAO6C,WAC3B7C,EAAO+C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,IACxD,eAAT4D,GAAkC,gBAATA,EACzB,GAAI5G,EAAOiD,UAAUC,OAAS,IAAO,GAAKlD,EAAOiD,UAAUC,OAAS,KAAQ,EACxE,GAAIlD,EAAOmF,QAAQnF,EAAOmF,QAAQC,OAAS,GAAGtC,YAAYxC,MAAQuC,EAAUC,YAAYvC,OACpF,IAAS0E,EAAI,EAAGA,EAAIjF,EAAOkN,aAAasY,cAAevgB,IAAK,CACxD,GAAIjF,EAAOmF,QAAQnF,EAAOmF,QAAQC,OAAS,GAAGtC,YAAYxC,OAASuC,EAAUC,YAAYvC,QACrFN,KAAKwlB,4BAA4BzlB,EAAOmF,QAAQnF,EAAOmF,QAAQC,OAAS,KACxEnF,KAAKylB,yBAAyB1lB,EAAOmF,QAAQnF,EAAOmF,QAAQC,OAAS,IAAK,CACrElD,oBAAkB4B,IACnB9D,EAAO+C,OAAO,aAAexB,KAAM,aAAcyB,kBAAkB,EAC/DvB,OAASqC,YAAa,GAAKsD,UAAW,OAE9C,OAEJtD,GAAc,GACd9D,EAAO+C,OAAO,aAAexB,KAAM,aAAcyB,kBAAkB,EAC/DvB,OAASqC,WAAYA,EAAYsD,UAAW,YAIpD,KAASnC,EAAI,EAAGA,EAAIjF,EAAOkN,aAAasY,cAAevgB,IAAK,CACxD,GAAIjF,EAAOmF,QAAQnF,EAAOmF,QAAQC,OAAS,GAAGtC,YAAYxC,OAASuC,EAAUC,YAAYvC,QACrFN,KAAKwlB,4BAA4BzlB,EAAOmF,QAAQnF,EAAOmF,QAAQC,OAAS,KACxEnF,KAAKylB,yBAAyB1lB,EAAOmF,QAAQnF,EAAOmF,QAAQC,OAAS,IAAK,CACrElD,oBAAkB4B,IACnB9D,EAAO+C,OAAO,aAAexB,KAAM,aAAcyB,kBAAkB,EAC/DvB,OAASqC,WAAY,GAAKsD,UAAW,OAE7C,OAEJtD,GAAc,GACd9D,EAAO+C,OAAO,aAAexB,KAAM,aAAcyB,kBAAkB,EAC/DvB,OAASqC,WAAYA,EAAYsD,UAAW,YAKxD,IAAIpH,EAAOmF,QAAQnF,EAAOmF,QAAQC,OAAS,GAAGtC,YAAYvC,OAASsC,EAAUC,YAAYxC,MACrF,IAAS2E,EAAI,EAAGA,EAAIjF,EAAOkN,aAAasY,cAAevgB,IAAK,CACxD,GAAIjF,EAAOmF,QAAQnF,EAAOmF,QAAQC,OAAS,GAAGtC,YAAYvC,QAAUsC,EAAUC,YAAYxC,OACtFL,KAAKwlB,4BAA4BzlB,EAAOmF,QAAQnF,EAAOmF,QAAQC,OAAS,KACxEnF,KAAKylB,yBAAyB1lB,EAAOmF,QAAQnF,EAAOmF,QAAQC,OAAS,IAAK,CACrElD,oBAAkB4B,IACnB9D,EAAO+C,OAAO,aAAexB,KAAM,aAAcyB,kBAAkB,EAC/DvB,OAASqC,YAAa,GAAKsD,UAAW,OAE9C,OAEJtD,GAAc,GACd9D,EAAO+C,OAAO,aAAexB,KAAM,aAAcyB,kBAAkB,EAC/DvB,OAASqC,WAAYA,EAAYsD,UAAW,YAIpD,KAASnC,EAAI,EAAGA,EAAIjF,EAAOkN,aAAasY,cAAevgB,IAAK,CACxD,GAAIjF,EAAOmF,QAAQnF,EAAOmF,QAAQC,OAAS,GAAGtC,YAAYvC,QAAUsC,EAAUC,YAAYxC,OACtFL,KAAKwlB,4BAA4BzlB,EAAOmF,QAAQnF,EAAOmF,QAAQC,OAAS,KACxEnF,KAAKylB,yBAAyB1lB,EAAOmF,QAAQnF,EAAOmF,QAAQC,OAAS,IAAK,CACrElD,oBAAkB4B,IACnB9D,EAAO+C,OAAO,aAAexB,KAAM,aAAcyB,kBAAkB,EAC/DvB,OAASqC,WAAY,GAAKsD,UAAW,OAE7C,OAEJtD,GAAc,GACd9D,EAAO+C,OAAO,aAAexB,KAAM,aAAcyB,kBAAkB,EAC/DvB,OAASqC,WAAYA,EAAYsD,UAAW,QAKhE,GAAI2C,GAAQ/J,EAAOqC,YAAYoC,YAAc,GAAMzE,EAAOmF,QAAQnF,EAAOmF,QAAQC,OAAS,GAAGtC,YAAY1C,OACpGJ,EAAOmF,QAAQnF,EAAOmF,QAAQC,OAAS,GAAGtC,YAAYxC,MAAQ,GAC/D2J,EAAQjK,EAAOqC,YAAYqC,aAAe,GAAM1E,EAAOmF,QAAQnF,EAAOmF,QAAQC,OAAS,GAAGtC,YAAYzC,OACrGL,EAAOmF,QAAQnF,EAAOmF,QAAQC,OAAS,GAAGtC,YAAYvC,OAAS,EACpC,KAA5BP,EAAOiD,UAAUC,QACjBlD,EAAOqD,IAAIC,UAAYyG,EACvB/J,EAAOqD,IAAIE,SAAW0G,EACtBjK,EAAO+C,OAAO,aAAexB,KAAM,gBAAiBE,OAAS2B,OAAS3C,EAAGsJ,EAAMrJ,EAAGuJ,QAGlFjK,EAAOsH,SAAS4C,oBAAuBzJ,EAAGsJ,EAAMrJ,EAAGuJ,GACnDjK,EAAO+C,OAAO,aAAexB,KAAM,kBAAmBE,OAAS0I,MAAOJ,EAAMK,MAAOH,KACnFjK,EAAOsH,SAAS4C,oBAAuBzJ,EAAG,EAAGC,EAAG,IAEpDV,EAAO+C,OAAO,aAAexB,KAAM,iBAAkByB,kBAAkB,EACnEvB,OAAS2B,MAAO,QACpBpD,EAAO6C,UAAYoB,YAAWjE,EAAOmF,QAAQnF,EAAOmF,QAAQC,OAAS,IACrEpF,EAAOmF,QAAQwB,MACf3G,EAAO+C,OAAO,QAAUxB,KAAM,aAAcyB,kBAAkB,EAAOvB,OAAS6D,OAAQ,YAAapB,IAAKlE,EAAO6C,gBAI3H6L,EAAK5N,UAAU2kB,4BAA8B,SAAUvhB,GACnD,GAAIyhB,IAAW,CAOf,QANIzhB,EAAIpB,YAAY1C,QAAUH,KAAKD,OAAOqD,IAAIC,UAC1CY,EAAIpB,YAAYzC,QAAUJ,KAAKD,OAAOqD,IAAIE,SAC1CW,EAAIpB,YAAYkF,MAAQ/H,KAAKD,OAAOqD,IAAIC,SAAWrD,KAAKD,OAAOqD,IAAIG,WACnEU,EAAIpB,YAAYmF,MAAQhI,KAAKD,OAAOqD,IAAIE,QAAUtD,KAAKD,OAAOqD,IAAII,cAClEkiB,GAAW,GAERA,GAEXjX,EAAK5N,UAAU4kB,yBAA2B,SAAUxhB,GAChD,GAAI0hB,IAAY,CAKhB,QAJK1hB,EAAIpB,YAAYvC,OAASN,KAAKD,OAAOqC,YAAY9B,OAASN,KAAKD,OAAOsc,eACtEpY,EAAIpB,YAAYxC,MAAQL,KAAKD,OAAOqC,YAAY/B,SACjDslB,GAAY,GAETA,GAEJlX,KChvGPmX,EAAwB,WACxB,QAASA,GAAO7lB,GACZC,KAAKD,OAASA,EACdC,KAAKY,mBA0VT,MAxVAglB,GAAO/kB,UAAUC,QAAU,WACnBd,KAAKD,OAAOgB,aAGhBf,KAAKgB,uBAET4kB,EAAO/kB,UAAUD,iBAAmB,WAChCZ,KAAKD,OAAOkB,GAAG,SAAUjB,KAAK+iB,OAAQ/iB,MACtCA,KAAKD,OAAOkB,GAAG,YAAajB,KAAKc,QAASd,OAE9C4lB,EAAO/kB,UAAUG,oBAAsB,WACnChB,KAAKD,OAAOoB,IAAI,SAAUnB,KAAK+iB,QAC/B/iB,KAAKD,OAAOoB,IAAI,YAAanB,KAAKc,UAEtC8kB,EAAO/kB,UAAUkiB,OAAS,SAAU3hB,GAChC,GAAI8K,aAAY,CACZ,GAAIjI,IAAQmB,MAAO,GACnBpF,MAAKD,OAAO+C,OAAO,aAAexB,KAAM,yBAA0ByB,kBAAkB,EAAOvB,OAASyC,IAAKA,KACpF,KAAjBA,EAAW,QACXjE,KAAKD,OAAO+C,OAAO,aAAexB,KAAM,yBAA0ByB,kBAAkB,EAAOvB,OAASA,MAAO,MAC3GxB,KAAKD,OAAO+C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,SAI9E/C,MAAKD,OAAO+C,OAAO,WAAaxB,KAAM,sBAAuByB,kBAAkB,GAGnF,QADA/C,KAAK6lB,eACGzkB,EAAKE,MACT,IAAK,SACDtB,KAAK8lB,UAAU1kB,EAAKI,MAAY,KAAGJ,EAAKI,MAAgB,SACxD,MACJ,KAAK,iBACDxB,KAAK+lB,eAAe3kB,EAAKI,MAAc,UAInDokB,EAAO/kB,UAAUsB,cAAgB,WAC7B,MAAO,UAEXyjB,EAAO/kB,UAAUglB,aAAe,WAC5B,GAAI9lB,GAASC,KAAKD,MACdA,GAAOqC,cACPpC,KAAKqC,aAAetC,EAAOqC,YAAYE,WAAW,QAG1DsjB,EAAO/kB,UAAUilB,UAAY,SAAUnf,EAAMgI,GACzC,GAAIpD,GAAQvL,KACRD,EAASC,KAAKD,OACdkE,GAAQ0K,SAAU,GACtB5O,GAAO+C,OAAO,QAAUxB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAASyC,IAAKA,IACpF,IAAI+hB,GAAY/hB,EAAc,QAC9B,KAAKlE,EAAOyL,UAAYzL,EAAO0L,cAAe,CAC1C,GAAI0C,IAAa/H,MAAM,EACvBrG,GAAO+C,OAAO,aAAexB,KAAM,yBAA0ByB,kBAAkB,EAAOvB,OAASyC,IAAKkK,KAChGA,EAAe,MACfpO,EAAO+C,OAAO,iBAAmBxB,KAAM,WAAYyB,kBAAkB,IAErEhD,EAAOse,YACPte,EAAO0F,YAAYwgB,UAAW,EAC9BlmB,EAAO+C,OAAO,SAAWxB,KAAM,QAASyB,kBAAkB,EAAOvB,OAAS4D,MAAO,KAAMnB,IAAK,KAAMoB,OAAQ,SAExE,UAAlCtF,EAAO+c,SAASjB,MAAMG,SACtBjc,EAAO+C,OAAO,SAAWxB,KAAM,eAAgByB,kBAAkB,EAC7DvB,OAAShB,EAAG,KAAMC,EAAG,KAAM8a,YAAa,QAEhDxb,EAAO+C,OAAO,SAAWxB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAAS+Z,YAAa,OAC7F,IAAIvI,IAAUoK,aAAcpd,KAAKD,OAAOqd,aACxCpd,MAAKqC,aAAasC,OAASqO,EAAoB,aAC/CrM,EAAOA,GAAc,MACrB5G,EAAO+C,OAAO,SAAWxB,KAAM,eAAgByB,kBAAkB,EAC7DvB,OAAShB,EAAG,KAAMC,EAAG,KAAM8a,YAAa,OAC5C,IAAI2K,IAAepa,QAAQ,EAAO6C,SAAUA,GAAsBqX,EAC9DhU,SAAUrL,EACVuF,eAAcnM,EAAOoM,SAA+C,IAArCpM,EAAOoM,OAAOga,OAAO/Z,YAEpDrM,EAAOsM,UAAUC,kBAAkB,uBAAwB,aAAc4Z,GAAY3Z,KAAK,SAAU2Z,GAChG3a,EAAM6a,gBAAgBF,EAAYvf,EAAMgI,EAAUqX,MAItDjmB,EAAO0M,QAAQ,aAAcyZ,GAC7BlmB,KAAKomB,gBAAgBF,EAAYvf,EAAMgI,EAAUqX,MAI7DJ,EAAO/kB,UAAUulB,gBAAkB,SAAUC,EAAoB1f,EAAMgI,EAAUqX,GAC7E,GAAIjmB,GAASC,KAAKD,MAClB,KAAKsmB,EAAmBva,OAAQ,CAC5B/L,EAAO0F,YAAY2E,QAAS,EAC5BuE,EAAW0X,EAAmB1X,SAAW0X,EAAmB1X,SAAWA,CACvE,IAAI2X,GAAgB3f,EAAKiM,aACzBjE,GAAWA,GAAYqX,EACD,QAAlBM,EACAtmB,KAAKumB,SAAS5X,GAGd3O,KAAKwmB,SAAS7X,EAAU2X,EAE5B,IAAIG,IAAU9X,SAAUA,GAAsBqX,EAAWhU,SAAUrL,EACnE5G,GAAO0M,QAAQ,QAASga,GACnBva,cACDnM,EAAO+C,OAAO,WAAaxB,KAAM,uBAAwByB,kBAAkB,IAE/EhD,EAAOqC,YAAYyZ,MAAMZ,KAAOlb,EAAOwC,YAAYsZ,MAAMZ,KAAO,GAChElb,EAAOqC,YAAYyZ,MAAM6K,IAAM3mB,EAAOwC,YAAYsZ,MAAM6K,IAAM,GAC9D3mB,EAAOqC,YAAYyZ,MAAM8K,SAAW5mB,EAAOwC,YAAYsZ,MAAM8K,SAAW,GACxE5mB,EAAOqC,YAAYyZ,MAAM+K,UAAY7mB,EAAOwC,YAAYsZ,MAAM+K,UAAY,KAGlFhB,EAAO/kB,UAAU0lB,SAAW,SAAU5X,GAClC,GAAI5O,GAASC,KAAKD,MAClBuiB,eAAYviB,EAAOgO,SACnBhO,EAAOgO,QAAQ8N,MAAMC,QAAU,KAC/B,IAAI+K,GAAa7mB,KAAK+lB,iBAClBe,EAAUD,EAAW/D,WACzBlH,eAAY7b,EAAOgO,SACnBhO,EAAOgO,QAAQ8N,MAAMC,QAAU,GAC/B,IAAIiL,GAAMhK,SAASiK,gBAAgB,6BAA8B,MACjED,GAAInK,aAAa,QAASiK,EAAWhL,MAAM8K,UAC3CI,EAAInK,aAAa,SAAUiK,EAAWhL,MAAM+K,UAC5C,IACIxjB,GAAM2Z,SAASiK,gBAAgB,6BAA8B,QACjE5jB,GAAI6jB,eAAe,KAAM,SAAUJ,EAAWvmB,OAAO+kB,YACrDjiB,EAAI6jB,eAAe,KAAM,QAASJ,EAAWxmB,MAAMglB,YACnDjiB,EAAI6jB,eAJU,+BAIc,aAAcH,GAC1CC,EAAIG,YAAY9jB,EAChB,IAKIkhB,GAJS,6FACQuC,EAAWxmB,MAAQ,aAAwBwmB,EAAWvmB,OAAS,KAEzEymB,EAAII,UADF,SAGTC,EANS,6BAMaC,KAAK/C,EAC/B,OAAiB,QAAb3V,EACOyY,GAGPpnB,KAAKsnB,YAAYF,EAAYzY,EAAW,QACjC,OAGfiX,EAAO/kB,UAAU2lB,SAAW,SAAU7X,EAAUhI,GAE5C,GAAI+U,GAAQ1b,KACRD,EAASC,KAAKD,MAClBuiB,eAAYviB,EAAOgO,SACnBhO,EAAOgO,QAAQ8N,MAAMC,QAAU,MACd9b,KAAK+lB,iBAEXwB,OAAO,SAAUC,GACxB,GAAIC,GAAUvC,IAAIC,gBAAgBqC,EAClC9L,GAAM4L,YAAYG,EAAS9Y,EAAW,IAAMhI,GAC5CiV,cAAY7b,EAAOgO,SACnBhO,EAAOgO,QAAQ8N,MAAMC,QAAU,KAChC,cAEP8J,EAAO/kB,UAAUklB,eAAiB,SAAUjgB,GACxC,GACIzF,GACAC,EAFAP,EAASC,KAAKD,MAGdA,GAAOgE,oBACP1D,EAAQN,EAAOqD,IAAIkB,SACnBhE,EAASP,EAAOqD,IAAImB,YAGpBlE,EAAQN,EAAO8E,QAAQxE,MACvBC,EAASP,EAAO8E,QAAQvE,OAE5B,IAAI2D,IAAQ5D,MAAO,EAAGC,OAAQ,EAC9BP,GAAO+C,OAAO,QAAUxB,KAAM,YAAayB,kBAAkB,EACzDvB,OAASyC,IAAKA,EAAK+J,WAAa3N,MAAOA,EAAOC,OAAQA,KAC1D,IAAIwD,GAAQG,EACRyjB,EAAoB1nB,KAAKqC,aAAasC,MAE1C,IAAiC,SAA7B3E,KAAKqC,aAAasC,OAAmB,CACrC,GAAI+H,GAAa1M,KAAKqC,aAAasC,OAAOgI,MAAM,KAC5CnL,EAAQmmB,WAAWjb,EAAW,GAAGC,MAAM,KAAK,GAChDnL,KAAWsC,EAAMzD,MAAQyD,EAAMxD,QAAU,EACzCoM,EAAW,GAAK,QAAUlL,EAAQ,MAClCxB,KAAKqC,aAAasC,OAAS+H,EAAWkb,KAAK,KAE/C,GAAIf,GAAa9mB,EAAO8nB,cAAc,UAClC7K,GAAIjd,EAAOgO,QAAQiP,GAAK,cAAe8K,OAAS9C,KAAM,iBAEtD+C,EAAclB,EAAWvkB,WAAW,KACxCukB,GAAWxmB,MAAQA,EACnBwmB,EAAWvmB,OAASA,CACpB,IAAI0nB,IAAW3nB,MAAO,EAAGC,OAAQ,EACjCP,GAAO+C,OAAO,aAAexB,KAAM,mBAAoByB,kBAAkB,EACrEvB,OAASnB,MAAOA,EAAOC,OAAQA,EAAQ2D,IAAK+jB,IAChD,IAAI9jB,GAAe8jB,CACnBnB,GAAWhL,MAAM8K,SAAWziB,EAAa7D,MAAQ,KACjDwmB,EAAWhL,MAAM+K,UAAY1iB,EAAa5D,OAAS,IACnD,IAAIoE,GAAO1E,KAAKqC,aAAasC,MAS7B,IARA5E,EAAO+C,OAAO,UAAYxB,KAAM,qBAAsByB,kBAAkB,IACxEglB,EAAYpjB,OAAS3E,KAAKqC,aAAasC,OACvCojB,EAAYnjB,UAAU7E,EAAO8E,QAAS9E,EAAOqD,IAAIgB,QAASrE,EAAOqD,IAAIiB,OAAQtE,EAAOqD,IAAIkB,SAAUvE,EAAOqD,IAAImB,UAAW,EAAG,EAAGlE,EAAOC,GACrIN,KAAKqC,aAAasC,OAASD,EACK,IAA5B3E,EAAOiD,UAAUC,QAAmD,KAAnClD,EAAOiD,UAAUU,gBAClD1D,KAAKioB,kBAAkBF,GACvB/nB,KAAKkoB,uBAAuBH,IAE5BhoB,EAAOmF,QAAQC,OAAS,EAAG,CAC3B,GAAIgjB,GAASJ,EAAYpjB,MACzBojB,GAAYpjB,OAAS,MAErB,KAAK,GADD0c,GAAcrd,YAAWjE,EAAOmF,YAAa,GACxCF,EAAI,EAAGC,EAAMlF,EAAOmF,QAAQC,OAAQH,EAAIC,EAAKD,IAAK,CACvD,GAAInC,GAAc9C,EAAOmF,QAAQF,GAAGnC,WAgBpC,IAdAA,EAAY1C,QAAUJ,EAAOqD,IAAIC,SACjCR,EAAYzC,QAAUL,EAAOqD,IAAIE,QACjCT,EAAYkF,MAAQhI,EAAOqD,IAAIC,SAC/BR,EAAYmF,MAAQjI,EAAOqD,IAAIE,QAC/BT,EAAYxC,MAAQwC,EAAYkF,KAAOlF,EAAY1C,OACnD0C,EAAYvC,OAASuC,EAAYmF,KAAOnF,EAAYzC,OAEpDyC,EAAY1C,QAAU2D,EAAMzD,MAC5BwC,EAAYzC,QAAU0D,EAAMxD,OAC5BuC,EAAYkF,MAAQjE,EAAMzD,MAC1BwC,EAAYmF,MAAQlE,EAAMxD,OAC1BuC,EAAYxC,MAAQwC,EAAYkF,KAAOlF,EAAY1C,OACnD0C,EAAYvC,OAASuC,EAAYmF,KAAOnF,EAAYzC,OACpDL,EAAOmF,QAAQF,GAAG+N,eAAe9D,cAAiBnL,EAAMzD,MAAQyD,EAAMxD,QAAU,EAChD,SAA5BP,EAAOmF,QAAQF,GAAGI,MAClBrF,EAAOmF,QAAQF,GAAGqD,aAAaE,WAAczE,EAAMzD,MAAQyD,EAAMxD,QAAU,MAE1E,IAAgC,SAA5BP,EAAOmF,QAAQF,GAAGI,MACvB,IAAS0D,EAAI,EAAGA,EAAI/I,EAAOmF,QAAQF,GAAGiC,UAAU9B,OAAQ2D,IACpD/I,EAAOmF,QAAQF,GAAGiC,UAAU6B,GAAGtI,GAC1BT,EAAOmF,QAAQF,GAAGiC,UAAU6B,GAAGtI,EAAIT,EAAOqD,IAAIC,UAAYS,EAAMzD,MACrEN,EAAOmF,QAAQF,GAAGiC,UAAU6B,GAAGrI,GAC1BV,EAAOmF,QAAQF,GAAGiC,UAAU6B,GAAGrI,EAAIV,EAAOqD,IAAIE,SAAWQ,EAAMxD,MAG5EP,GAAO+C,OAAO,QAAUxB,KAAM,aAAcyB,kBAAkB,EAAOvB,OAAS6D,OAAQ,cAAepB,IAAKlE,EAAOmF,QAAQF,GAAIuN,YAAa,KAClI1J,OAAQ,KAAM2J,eAAe,EAAMC,YAAasV,EAAarV,mBAAoB,QAE7FqV,EAAYpjB,OAASwjB,EACrBpoB,EAAO+C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,IACrEhD,EAAOmF,QAAUmc,EAErB,GAAIthB,EAAOiH,gBAAkB,EAAG,CAG5B,IAAK,GADDohB,GAAgBpkB,YAAWjE,EAAOkH,cAAe,GAC5CyB,EAAI,EAAGA,EAAI3I,EAAOiH,gBAAiB0B,IAAK,CAC7C3I,EAAO8I,OAAS7E,YAAWjE,EAAOkH,UAAUyB,GAAGG,WAC/C9I,EAAO+C,OAAO,iBAAmBxB,KAAM,kBAAmByB,kBAAkB,EAAOvB,OAASA,MAAO,IAC/FyD,GAAMlF,EAAO8I,OAAO1D,MACxBpF,GAAOkH,UAAUyB,GAAGuG,cAAiBnL,EAAMzD,MAAQyD,EAAMxD,QAAU,CACnE,KAAK,GAAIwI,GAAI,EAAGA,EAAI7D,EAAK6D,IACrB/I,EAAO8I,OAAOC,GAAGtI,GAAKT,EAAO8I,OAAOC,GAAGtI,EAAIT,EAAOqD,IAAIC,UAAYS,EAAMzD,MACxEN,EAAO8I,OAAOC,GAAGrI,GAAKV,EAAO8I,OAAOC,GAAGrI,EAAIV,EAAOqD,IAAIE,SAAWQ,EAAMxD,OAG/EP,EAAO+C,OAAO,iBAAmBxB,KAAM,iBAAkByB,kBAAkB,EACvEvB,OAAS+D,QAASwiB,EAAalf,OAAQ,QAC3C9I,EAAOkH,UAAYmhB,EAWvB,MATIroB,GAAOyF,cACPzF,EAAO+C,OAAO,QAAUxB,KAAM,aAAcyB,kBAAkB,EAC1DvB,OAAS+D,QAASwiB,EAAa3d,QAAQ,EAAMC,OAAQ,QAE7DrK,KAAKqC,aAAasC,OAAS+iB,EAC3B3nB,EAAOqd,aAAesK,EAClB5hB,IACAA,EAAe,OAAI+gB,GAEhBA,GAEXjB,EAAO/kB,UAAUymB,YAAc,SAAUE,EAAM7Y,GAC3C,GAAIkL,GAAIkD,SAAS8K,cAAc,IAC/BhO,GAAEwO,KAAOb,EACT3N,EAAE4J,OAAS,UACX5J,EAAEyO,SAAW3Z,GACZoO,SAASwL,MAAQxL,SAASyL,iBAAiBtB,YAAYrN,GACxDA,EAAEmK,QACFnK,EAAE4O,WAAWC,YAAY7O,IAE7B+L,EAAO/kB,UAAUqnB,uBAAyB,SAAUH,GAGhD,IAAK,GAFDhoB,GAASC,KAAKD,OACdkD,EAASlD,EAAOiD,UAAUC,OACrB+B,EAAI,EAAGC,EAAMlF,EAAOuG,eAAenB,OAAQH,EAAIC,EAAKD,IAAK,CAE9D,GAAI2jB,GAAO5oB,EAAOuG,eAAetB,EACb,iBAAT2jB,GACP3oB,KAAK4oB,aAAab,EAAaY,GAEjB,eAATA,EACL3oB,KAAK6oB,WAAWd,GAAa,GAAM,GAErB,aAATY,GACL3oB,KAAK6oB,WAAWd,GAAa,GAAO,GAG5ChoB,EAAOiD,UAAUC,OAASA,GAE9B2iB,EAAO/kB,UAAU+nB,aAAe,SAAUb,EAAa9kB,GACnD,GAAIlD,GAASC,KAAKD,MAClBC,MAAK8oB,UAAU/oB,EAAOiD,UAAUC,OAAQ8kB,EAAY1iB,QACpD0iB,EAAYlU,UAAUkU,EAAY1iB,OAAOhF,MAAQ,EAAG0nB,EAAY1iB,OAAO/E,OAAS,GAChFynB,EAAYjU,OAAO3L,KAAKyC,GAAK,IAAM3H,GACnC8kB,EAAYnjB,UAAU7E,EAAOsiB,gBAAiB0F,EAAY1iB,OAAO/E,OAAS,GAAIynB,EAAY1iB,OAAOhF,MAAQ,EAAG0nB,EAAY1iB,OAAO/E,OAAQynB,EAAY1iB,OAAOhF,OAC1JL,KAAKioB,kBAAkBF,IAE3BnC,EAAO/kB,UAAUgoB,WAAa,SAAUd,EAAagB,EAAgBC,GAC7DD,IACAhB,EAAYlU,UAAUkU,EAAY1iB,OAAOhF,MAAO,GAChD0nB,EAAYpN,OAAO,EAAG,IAEtBqO,IACAjB,EAAYlU,UAAU,EAAGkU,EAAY1iB,OAAO/E,QAC5CynB,EAAYpN,MAAM,GAAI,IAE1BoN,EAAYnjB,UAAU5E,KAAKD,OAAOsiB,eAAgB,EAAG,GACrDriB,KAAKioB,kBAAkBF,IAE3BnC,EAAO/kB,UAAUonB,kBAAoB,SAAUF,GAC3C,GAAI3F,GAAkBpiB,KAAKD,OAAOsiB,eAAe/f,WAAW,KAC5DylB,GAAYrgB,aAAa,EAAG,EAAG,EAAG,EAAG,EAAG,EACxC,IAAIuhB,GAAYlB,EAAYmB,aAAa,EAAG,EAAGnB,EAAY1iB,OAAOhF,MAAO0nB,EAAY1iB,OAAO/E,OAC5FN,MAAKD,OAAOsiB,eAAehiB,MAAQ4oB,EAAU5oB,MAC7CL,KAAKD,OAAOsiB,eAAe/hB,OAAS2oB,EAAU3oB,OAC9C8hB,EAAgBS,aAAaoG,EAAW,EAAG,IAE/CrD,EAAO/kB,UAAUioB,UAAY,SAAU7lB,EAAQ4jB,GAC3C,GAAIsC,GACAC,CACAnmB,GAAS,IAAO,GAAKA,EAAS,KAAQ,GACtCkmB,EAAWlnB,oBAAkBjC,KAAKD,OAAOgE,oBAAsB/D,KAAKD,OAAO8E,QAAQvE,OAASN,KAAKD,OAAOqD,IAAImB,UAC5G6kB,EAAYnnB,oBAAkBjC,KAAKD,OAAOgE,oBAAsB/D,KAAKD,OAAO8E,QAAQxE,MAAQL,KAAKD,OAAOqD,IAAIkB,UAEvGrB,EAAS,KAAQ,GAAgB,IAAXA,IAC3BkmB,EAAWlnB,oBAAkBjC,KAAKD,OAAOgE,oBAAsB/D,KAAKD,OAAO8E,QAAQxE,MAAQL,KAAKD,OAAOqD,IAAIkB,SAC3G8kB,EAAYnnB,oBAAkBjC,KAAKD,OAAOgE,oBAAsB/D,KAAKD,OAAO8E,QAAQvE,OAASN,KAAKD,OAAOqD,IAAImB,WAEjHsiB,EAAWxmB,MAAQ8oB,EACnBtC,EAAWvmB,OAAS8oB,CACpB,IAAInlB,IAAQ5D,MAAO,EAAGC,OAAQ,EAC9BN,MAAKD,OAAO+C,OAAO,aAAexB,KAAM,mBAAoByB,kBAAkB,EAC1EvB,OAASnB,MAAO8oB,EAAU7oB,OAAQ8oB,EAAWnlB,IAAKA,IACtD,IAAIC,GAAeD,CACnB4iB,GAAWhL,MAAM8K,SAAWziB,EAAa7D,MAAQ,KACjDwmB,EAAWhL,MAAM+K,UAAY1iB,EAAa5D,OAAS,MAEhDslB,KC9VPyD,EAAwB,WACxB,QAASA,GAAOtpB,GACZC,KAAK2d,iBAAoB2L,WAAY,EAAGC,SAAU,EAAGC,IAAK,EAAG1N,QAAS,IAAK2N,WAAY,EAAGC,KAAM,EAC5FC,SAAU,EAAGC,SAAS,EAAOC,IAAI,GACrC7pB,KAAK0d,qBAAwB4L,WAAY,EAAGC,SAAU,EAAGC,IAAK,EAAG1N,QAAS,IAAK2N,WAAY,EAAGC,KAAM,EAChGC,SAAU,EAAGC,SAAS,EAAOC,IAAI,GACrC7pB,KAAKqd,gBAAkB,GACvBrd,KAAKud,sBAAuB,EAC5Bvd,KAAK8pB,cAAgB,GACrB9pB,KAAKD,OAASA,EACdC,KAAKY,mBAsqBT,MApqBAyoB,GAAOxoB,UAAUC,QAAU,WACnBd,KAAKD,OAAOgB,aAGhBf,KAAKgB,uBAETqoB,EAAOxoB,UAAUD,iBAAmB,WAChCZ,KAAKD,OAAOkB,GAAG,SAAUjB,KAAK2E,OAAQ3E,MACtCA,KAAKD,OAAOkB,GAAG,YAAajB,KAAKc,QAASd,OAE9CqpB,EAAOxoB,UAAUG,oBAAsB,WACnChB,KAAKD,OAAOoB,IAAI,SAAUnB,KAAK2E,QAC/B3E,KAAKD,OAAOoB,IAAI,YAAanB,KAAKc,UAEtCuoB,EAAOxoB,UAAU8D,OAAS,SAAUvD,GAEhC,OADApB,KAAK0Q,yBACGtP,EAAKE,MACT,IAAK,gBACDtB,KAAK+pB,cAAc3oB,EAAKI,MAAc,OAAGJ,EAAKI,MAAa,MAC3D,MACJ,KAAK,mBACDxB,KAAKgqB,UAAU5oB,EAAKI,MAAc,OAClC,MACJ,KAAK,mBACDxB,KAAKiqB,iBACL,MACJ,KAAK,qBACDjqB,KAAKkqB,oBACL,MACJ,KAAK,iBACDlqB,KAAKmqB,cAAc/oB,EAAKI,MAAiB,UACzC,MACJ,KAAK,gBACDxB,KAAKoqB,aAAahpB,EAAKI,MAAiB,UAAGJ,EAAKI,MAAc,OAC9D,MACJ,KAAK,aACDxB,KAAKqqB,YACL,MACJ,KAAK,kBACDrqB,KAAKsqB,gBAAgBlpB,EAAKI,MAAY,KAAGJ,EAAKI,MAAa,MAC3D,MACJ,KAAK,YACDxB,KAAKuqB,UAAUnpB,EAAKI,MAAY,KAAGJ,EAAKI,MAAa,MAAGJ,EAAKI,MAAiB,UAAGJ,EAAKI,MAAW,IACjG,MACJ,KAAK,gBACDxB,KAAKwqB,cAAcppB,EAAKI,MAAc,OACtC,MACJ,KAAK,qBACDJ,EAAKI,MAAW,IAAmB,gBAAIxB,KAAK2d,eAC5C,MACJ,KAAK,qBACD3d,KAAK2d,gBAAkBvc,EAAKI,MAAuB,eACnD,MACJ,KAAK,yBACDJ,EAAKI,MAAW,IAAuB,oBAAIxB,KAAK0d,mBAChD,MACJ,KAAK,yBACD1d,KAAK0d,oBAAsBtc,EAAKI,MAA2B,mBAC3D,MACJ,KAAK,qBACDxB,KAAKqd,gBAAkBjc,EAAKI,MAAuB,eACnD,MACJ,KAAK,wBACDJ,EAAKI,MAAW,IAAwB,qBAAIxB,KAAKud,oBACjD,MACJ,KAAK,wBACDvd,KAAKud,qBAAuBnc,EAAKI,MAA4B,qBACzDxB,KAAKD,OAAOyd,cAAc7Q,MAAM,MAAoD,SAA5C3M,KAAKD,OAAOyd,cAAc7Q,MAAM,KAAK,KAC7E3M,KAAKud,sBAAuB,EAEhC,MACJ,KAAK,QACDvd,KAAKkC,UAIjBmnB,EAAOxoB,UAAU6P,uBAAyB,WACtC,GAAI3Q,GAASC,KAAKD,MACdA,GAAOqC,cACPpC,KAAKqC,aAAetC,EAAOqC,YAAYE,WAAW,QAG1D+mB,EAAOxoB,UAAUsB,cAAgB,WAC7B,MAAO,UAEXknB,EAAOxoB,UAAUqpB,mBAAqB,WAClC,GAAIxd,GAAa1M,KAAKqC,aAAasC,OAAOgI,MAAM,IAChD,IAAI3M,KAAKud,sBAAwB7Q,EAAWvH,OAAS,IAAMlD,oBAAkByK,EAAW,IAAK,CACzF,GAAI+d,GAAe9C,WAAWjb,EAAW,GAAGC,MAAM,KAAK,GACvDD,GAAW,GAAK,YAAc+d,EAAe,IAAO,IACpDzqB,KAAKqC,aAAasC,OAAS+H,EAAWkb,KAAK,OAGnDyB,EAAOxoB,UAAUqB,MAAQ,WACrBlC,KAAK2d,iBAAoB2L,WAAY,EAAGC,SAAU,EAAGC,IAAK,EAAG1N,QAAS,IAAK2N,WAAY,EACnFC,KAAM,EAAGC,SAAU,EAAGC,SAAS,EAAOC,IAAI,GAC9C7pB,KAAK0d,qBAAwB4L,WAAY,EAAGC,SAAU,EAAGC,IAAK,EAAG1N,QAAS,IAAK2N,WAAY,EACvFC,KAAM,EAAGC,SAAU,EAAGC,SAAS,EAAOC,IAAI,GAC9C7pB,KAAKqd,gBAAkBrd,KAAKD,OAAOyhB,mBACnCxhB,KAAKud,sBAAuB,EAC5Bvd,KAAK8pB,cAAgB,IAEzBT,EAAOxoB,UAAUopB,gBAAkB,WAC/B,GAAIlqB,GAASC,KAAKD,OACd2qB,EAAK3qB,EAAO4qB,gBACZD,KACIA,EAAGpB,aACHtpB,KAAK2d,gBAAgB2L,WAAaoB,EAAGpB,WAAWsB,aAChD5qB,KAAK0d,oBAAoB4L,WAAaoB,EAAGpB,WAAWsB,cAEpDF,EAAGnB,WACHvpB,KAAK2d,gBAAgB4L,SAAWmB,EAAGnB,SAASqB,aAC5C5qB,KAAK0d,oBAAoB6L,SAAWmB,EAAGnB,SAASqB,cAEhDF,EAAGlB,MACHxpB,KAAK2d,gBAAgB6L,IAAMkB,EAAGlB,IAAIoB,aAClC5qB,KAAK0d,oBAAoB8L,IAAMkB,EAAGlB,IAAIoB,cAEtCF,EAAGjB,aACHzpB,KAAK2d,gBAAgB8L,WAAaiB,EAAGjB,WAAWmB,aAChD5qB,KAAK0d,oBAAoB+L,WAAaiB,EAAGjB,WAAWmB,cAEpDF,EAAGf,WACH3pB,KAAK2d,gBAAgBgM,SAAWe,EAAGf,SAASiB,aAC5C5qB,KAAK0d,oBAAoBiM,SAAWe,EAAGf,SAASiB,cAEhDF,EAAG5O,UACH9b,KAAK2d,gBAAgB7B,QAAU4O,EAAG5O,QAAQ8O,aAC1C5qB,KAAK0d,oBAAoB5B,QAAU4O,EAAG5O,QAAQ8O,cAE9CF,EAAGhB,OACH1pB,KAAK2d,gBAAgB+L,KAAOgB,EAAGhB,KAAKkB,aACpC5qB,KAAK0d,oBAAoBgM,KAAOgB,EAAGhB,KAAKkB,cAE5C7qB,EAAO+C,OAAO,QAAUxB,KAAM,mBAAoByB,kBAAkB,EAAOvB,OAASkN,kBAAkB,OAG9G2a,EAAOxoB,UAAUwpB,WAAa,WAC1BrqB,KAAK6qB,aAAa,aAAc7qB,KAAK2d,gBAAgB2L,YACrDtpB,KAAK6qB,aAAa,WAAY7qB,KAAK2d,gBAAgB4L,UACnDvpB,KAAK6qB,aAAa,MAAO7qB,KAAK2d,gBAAgB6L,KAC9CxpB,KAAK6qB,aAAa,aAAc7qB,KAAK2d,gBAAgB8L,YACrDzpB,KAAK6qB,aAAa,WAAY7qB,KAAK2d,gBAAgBgM,UACnD3pB,KAAK6qB,aAAa,UAAW7qB,KAAK2d,gBAAgB7B,SAClD9b,KAAK6qB,aAAa,OAAQ7qB,KAAK2d,gBAAgB+L,OAEnDL,EAAOxoB,UAAU0pB,UAAY,SAAU5jB,EAAMnF,EAAOspB,EAAWpX,GAC3D,GAAI3T,GAASC,KAAKD,MAClBC,MAAKqC,aAAa8B,UAAU,EAAG,EAAGpE,EAAOqC,YAAY/B,MAAON,EAAOqC,YAAY9B,OAC/E,IAEImqB,GACAM,EAHAre,EAAa1M,KAAKqC,aAAasC,OAAOgI,MAAM,KAC5Cqe,IAGAte,GAAW,KACX+d,EAAe9C,WAAWjb,EAAW,GAAGC,MAAM,KAAK,KAEnDD,EAAW,KACXqe,EAAkBpD,WAAWjb,EAAW,GAAGC,MAAM,KAAK,IAE1D,IAAI2c,GAAatpB,KAAKirB,eAAejrB,KAAK2d,gBAAgB2L,YACtDG,EAAazpB,KAAKirB,eAAejrB,KAAK2d,gBAAgB8L,WAE1D,KAAqC,KADhB,aAAc,WAAY,MAAO,aAAc,WAAY,UAAW,QACzEjL,QAAQ7X,IAClB1E,oBAAkB6oB,KAAe9qB,KAAK2d,gBAAgBiM,SAAW5pB,KAAK2d,gBAAgBkM,IAAK,CAC3F9pB,EAAOmH,YAAa,CACpB,IAAIxC,GAAO1E,KAAKqC,aAAasC,MAC7B3E,MAAKqC,aAAasC,OAAS,OAC3B5E,EAAO+C,OAAO,SAAWxB,KAAM,iBAAkByB,kBAAkB,IACnEhD,EAAO+C,OAAO,iBAAmBxB,KAAM,iBAAkByB,kBAAkB,EACvEvB,OAAS+D,QAASvF,KAAKqC,aAAcwG,OAAQ,QACjD7I,KAAKqC,aAAasC,OAASD,EAC3B3E,EAAOmH,YAAa,EAGT,IAAfoiB,IACA5c,EAAW,GAAK,YAAc+d,EAAe,IAAO,IAExD,IAAIS,GACAC,EACAC,EACA7B,EACA8B,CACJ,QAAQ1kB,GACJ,IAAK,aAC+C,MAA5CghB,WAAWjb,EAAW,GAAGC,MAAM,KAAK,MACpCnL,GAAS,IAEbkL,EAAW,GAAK,cAAgBlL,EAAQ,IACxCxB,KAAKqd,gBAAkB3Q,EAAWkb,KAAK,IACvC,MACJ,KAAK,WACDlb,EAAW,GAAK,YAAclL,EAAQ,KACtCxB,KAAKqd,gBAAkB3Q,EAAWkb,KAAK,IACvC,MACJ,KAAK,MACDlb,EAAW,GAAK,cAAgBlL,EAAQ,OACxCxB,KAAKqd,gBAAkB3Q,EAAWkb,KAAK,IACvC,MACJ,KAAK,aACDlb,EAAW,GAAK,YAAclL,EAAQ,KACnB,IAAfioB,IACA/c,EAAW,GAAK,eAAiBqe,EAAkB,KAAQ,KAE/D/qB,KAAKqd,gBAAkB3Q,EAAWkb,KAAK,IACvC,MACJ,KAAK,UAC+C,IAA5CD,WAAWjb,EAAW,GAAGC,MAAM,KAAK,MACpCnL,GAAS,IAEbkL,EAAW,GAAK,WAAalL,EAAQ,IACrCxB,KAAKqd,gBAAkB3Q,EAAWkb,KAAK,IACvC,MACJ,KAAK,OACDlb,EAAW,GAAK,QAAUlL,EAAQ,MAClCxB,KAAKqd,gBAAkB3Q,EAAWkb,KAAK,IACvC,MACJ,KAAK,WACkB,IAAf0B,IACA5c,EAAW,GAAK,YAAc+d,EAAe,IAAO,KAEpDjpB,EAAQ,GACRA,GAAS,EACTA,GAAS8nB,GAEJ9nB,EAAQ,IAEbA,EAAQ8nB,GADR9nB,EAAQ,EAAIA,IAGhBkL,EAAW,GAAK,cAAgBlL,EAAQ,IACxCxB,KAAKqd,gBAAkB3Q,EAAWkb,KAAK,IACvC,MACJ,KAAK,SACDsD,EAAWlrB,KAAKsrB,yBAAyBtrB,KAAK2d,gBAAgB8L,YAE9DjoB,GADA0pB,GAAY,KACmB,GAAXA,EACpBxe,EAAW,GAAK,YAAclL,EAAQ,KACtCwpB,EAAShrB,KAAKqd,gBAAgB1Q,MAAM,KACpCD,EAAW,GAAKse,EAAO,GACvBte,EAAW,GAAKse,EAAO,GACvBte,EAAW,GAAKse,EAAO,GACvBte,EAAW,GAAKse,EAAO,GACvBte,EAAW,GAAKse,EAAO,GACvBte,EAAW,GAAK,YAChBA,EAAW,GAAK,gBAChBA,EAAW,GAAK,YAChB,MACJ,KAAK,OAEDye,EAASnrB,KAAKirB,eAAejrB,KAAK2d,gBAAgB2L,YAElD9nB,EAAiB,IADjB2pB,GAAU,KAEV3pB,GAAS,IACTkL,EAAW,GAAK,cAAgBlL,EAAQ,IAExC+nB,EAAWvpB,KAAKirB,eAAejrB,KAAK2d,gBAAgB4L,UAEpD/nB,GADA+nB,GAAY,KACmB,GAAXA,EACpB7c,EAAW,GAAK,YAAclL,EAAQ,KAEtC6pB,EAAqBrrB,KAAKsrB,yBAAyBtrB,KAAK2d,gBAAgB8L,YAExEjoB,EADA6pB,GAAsB,IAEtB3e,EAAW,GAAK,YAAclL,EAAQ,KACtCwpB,EAAShrB,KAAKqd,gBAAgB1Q,MAAM,KACpCD,EAAW,GAAKse,EAAO,GACvBte,EAAW,GAAKse,EAAO,GACvBte,EAAW,GAAKse,EAAO,GACvBte,EAAW,GAAK,YAChBA,EAAW,GAAK,gBAChBA,EAAW,GAAK,YAChB,MACJ,KAAK,OACD0e,EAAkBprB,KAAKsrB,yBAAyBtrB,KAAK2d,gBAAgB8L,YAErEjoB,GADA4pB,GAAmB,KAC0B,GAAlBA,EAC3B1e,EAAW,GAAK,YAAclL,EAAQ,KACtCkL,EAAW,GAAK,aAChBse,EAAShrB,KAAKqd,gBAAgB1Q,MAAM,KACpCD,EAAW,GAAKse,EAAO,GACvBte,EAAW,GAAKse,EAAO,GACvBte,EAAW,GAAKse,EAAO,GACvBte,EAAW,GAAKse,EAAO,GACvBte,EAAW,GAAKse,EAAO,GACvBte,EAAW,GAAK,gBAChBA,EAAW,GAAK,YAChB,MACJ,KAAK,YACDA,EAAW,GAAK,kBAChBse,EAAShrB,KAAKqd,gBAAgB1Q,MAAM,KACpCD,EAAW,GAAKse,EAAO,GACvBte,EAAW,GAAKse,EAAO,GACvBte,EAAW,GAAKse,EAAO,GACvBte,EAAW,GAAKse,EAAO,GACvBte,EAAW,GAAKse,EAAO,GACvBte,EAAW,GAAKse,EAAO,GACvBte,EAAW,GAAK,YAChBA,EAAW,GAAK,YAChB,MACJ,KAAK,QACDA,EAAW,GAAK,cAChBse,EAAShrB,KAAKqd,gBAAgB1Q,MAAM,KACpCD,EAAW,GAAKse,EAAO,GACvBte,EAAW,GAAKse,EAAO,GACvBte,EAAW,GAAKse,EAAO,GACvBte,EAAW,GAAKse,EAAO,GACvBte,EAAW,GAAKse,EAAO,GACvBte,EAAW,GAAKse,EAAO,GACvBte,EAAW,GAAK,gBAChBA,EAAW,GAAK,YAChB,MACJ,KAAK,SACDA,EAAW,GAAK,eAChBse,EAAShrB,KAAKqd,gBAAgB1Q,MAAM,KACpCD,EAAW,GAAKse,EAAO,GACvBte,EAAW,GAAKse,EAAO,GACvBte,EAAW,GAAKse,EAAO,GACvBte,EAAW,GAAKse,EAAO,GACvBte,EAAW,GAAKse,EAAO,GACvBte,EAAW,GAAKse,EAAO,GACvBte,EAAW,GAAK,YAChBA,EAAW,GAAK,gBAGxB,GAAa,YAAT/F,GAA+B,kBAATA,EAA0B,CAC5C1E,oBAAkB6oB,KACL,YAATnkB,IACA+F,EAAa1M,KAAKurB,wBAAwB7e,IAE9C1M,KAAKqC,aAAasC,OAAS+H,EAAWkb,KAAK,MAE/Clb,EAAa1M,KAAKwrB,mBAAmBlC,EAAYwB,EAAWpe,EAAY/F,GACxE5G,EAAO+C,OAAO,QAAUxB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAASqG,cAAc,KAC/F9H,EAAO+C,OAAO,QAAUxB,KAAM,uBAAwByB,kBAAkB,EACpEvB,OAASmF,KAAM,UAAWgB,qBAAsB,KAAMwT,YAAa,QACvEnb,KAAK8pB,cAAgB9pB,KAAKqC,aAAasC,OACvC3E,KAAKqC,aAAauC,UAAU7E,EAAO8E,QAAS9E,EAAOqD,IAAIgB,QAASrE,EAAOqD,IAAIiB,OAAQtE,EAAOqD,IAAIkB,SAAUvE,EAAOqD,IAAImB,UAAWxE,EAAOqD,IAAIC,SAAUtD,EAAOqD,IAAIE,QAASvD,EAAOqD,IAAIG,UAAWxD,EAAOqD,IAAII,YACxMzD,EAAO+C,OAAO,QAAUxB,KAAM,uBAAwByB,kBAAkB,EACpEvB,OAASmF,KAAM,UAAWgB,qBAAsB,KAAMwT,YAAa,QACvEpb,EAAO+C,OAAO,QAAUxB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAASqG,cAAc,KAC5E,IAAfyhB,EACA5c,EAAW,GAAK,WAAa+d,EAAe,IAExB,IAAfhB,IACL/c,EAAW,GAAK,cAAgBqe,EAAkB,MAExC,aAATpkB,GAAsC,IAAf2iB,GAA+B,eAAT3iB,GAAwC,IAAf8iB,KACvE/c,EAAW,GAAK,cAAgBqe,EAAkB,KAEtDre,EAAa1M,KAAKwrB,mBAAmBlC,EAAYwB,EAAWpe,EAAY/F,GACpE1E,oBAAkB6oB,KAClB9qB,KAAKqC,aAAasC,OAAS+H,EAAWkb,KAAK,MAE/C7nB,EAAOud,uBAAyB5Q,EAAWkb,KAAK,IAChD,IAAInY,GAAazP,KAAKqC,aAAasC,MACnC3E,MAAKqC,aAAasC,OAAS,uHAE3B5E,EAAO+C,OAAO,SAAWxB,KAAM,iBAAkByB,kBAAkB,IACnEhD,EAAO+C,OAAO,iBAAmBxB,KAAM,iBAAkByB,kBAAkB,EACvEvB,OAAS+D,QAASvF,KAAKqC,aAAcwG,OAAQ,QACjD7I,KAAKqC,aAAasC,OAAS8K,EAC3B1P,EAAO+C,OAAO,QAAUxB,KAAM,mBAAoByB,kBAAkB,EAAOvB,OAAS+D,QAASvF,KAAKqC,iBAC7FtC,EAAOgE,oBAA0D,gBAApChE,EAAOgE,mBAAmBqB,OAA4BrF,EAAOyF,eAC3FzF,EAAO+C,OAAO,QAAUxB,KAAM,aAAcyB,kBAAkB,EAC1DvB,OAAS+D,QAASvF,KAAKqC,aAAc+H,OAAQ,KAAMC,OAAQ,QAEnErK,KAAKud,qBAAsC,IAAf+L,EAEhC,GAAI3kB,GAAS+H,EAAWkb,KAAK,IACzBlU,KACAA,EAAI/O,OAASA,IAGrB0kB,EAAOxoB,UAAU2qB,mBAAqB,SAAUlC,EAAYwB,EAAWpe,EAAY/F,GAC/E,GAAImkB,EACA,GAAa,YAATnkB,EACA+F,EAAa1M,KAAKurB,wBAAwB7e,OAEzC,IAAmB,IAAf4c,EAAkB,CACvB,GAAImC,GAAiBzrB,KAAKqC,aAAasC,OAAOgI,MAAM,IACpD8e,GAAe,GAAK/e,EAAW,GAC/B1M,KAAKqC,aAAasC,OAAS8mB,EAAe7D,KAAK,KAGvD,MAAOlb,IAEX2c,EAAOxoB,UAAU0qB,wBAA0B,SAAU7e,GACjD,GAAIse,GAAShrB,KAAKqd,gBAAgB1Q,MAAM,IAYxC,QAVIqe,EAAO,GACPA,EAAO,GACPA,EAAO,GACPA,EAAO,GACPA,EAAO,GACPA,EAAO,GACP,YACA,gBACA,eAIR3B,EAAOxoB,UAAUoqB,eAAiB,SAAUzpB,GACxC,MAAkB,KAAVA,EAAe,EAAI,EAAc,GAARA,EAAe,KAEpD6nB,EAAOxoB,UAAUyqB,yBAA2B,SAAU9pB,GAClD,MAAiB,KAAVA,EAAc,EAAI,EAAKA,EAAQ,KAE1C6nB,EAAOxoB,UAAUgqB,aAAe,SAAUlkB,EAAMnF,GAC5C,GAAIzB,GAASC,KAAKD,MAGlB,QAFAA,EAAO+C,OAAO,iBAAmBxB,KAAM,iBAAkByB,kBAAkB,IAC3E/C,KAAK2d,gBAAgB,GAAKhX,GAAQnF,EAC1BmF,GACJ,IAAK,aACL,IAAK,WACL,IAAK,WACDnF,EAAQxB,KAAKirB,eAAezpB,GACf,aAATmF,IACAnF,GAAS,IAEb,MACJ,KAAK,MACDA,GAAS,CACT,MACJ,KAAK,aACDA,EAA+C,IAAvCxB,KAAKsrB,yBAAyB9pB,EACtC,MACJ,KAAK,UACGA,GAAS,GACTA,GAAS,IAEM,KAAVA,EACLA,EAAQ,IAEO,KAAVA,EACLA,EAAQ,GAEO,KAAVA,EACLA,EAAQ,IAEO,KAAVA,EACLA,EAAQ,GAEO,IAAVA,IACLA,EAAQ,IAEZ,MACJ,KAAK,OACa,IAAVA,IACAA,GAAS,GAETA,GAAS,IAIrB,GAAIsL,GAAc9I,YAAWjE,EAAOiG,YAAa,GAC7C+G,EAAU/M,KAAKwqB,eACnBzd,GAAQ7H,QAAUlB,YAAWjE,EAAOmF,YAAa,GACjD6H,EAAQ9F,UAAYjD,YAAWjE,EAAOkH,cAAe,GACrD8F,EAAQlH,iBAAmB7B,YAAWjE,EAAO8F,qBAAsB,EACnE,IAAIuZ,IAAoBhW,aAAc,KACtCrJ,GAAO+C,OAAO,iBAAmBxB,KAAM,kBAAmByB,kBAAkB,EAAOvB,OAASyC,IAAKmb,KACjGrS,EAAQ3D,aAAepF,YAAWob,EAA8B,iBAAO,GACvEpf,KAAKuqB,UAAU5jB,EAAMnF,GACrBzB,EAAO+C,OAAO,aACVxB,KAAM,qBACNyB,kBAAkB,EAClBvB,OACI6L,UAAW1G,EACX2G,YAAaP,EACbQ,gBAAiBR,EAAQ7H,QACzBsI,kBAAmBT,EAAQ9F,UAC3BwG,qBAAsBV,EAAQ3D,aAC9BsE,gBAAiBZ,EACjBa,aAAc,KACdC,YAAa,KACbC,eAAgB,KAChBrI,aAAc,SAI1B6jB,EAAOxoB,UAAUmpB,UAAY,SAAUrjB,GACnC,GAAI5G,GAASC,KAAKD,MAClB4G,GAAOA,EAAKiM,cACZ7S,EAAO+C,OAAO,iBAAmBxB,KAAM,iBAAkByB,kBAAkB,GAC3E,IACI2oB,IADQlO,cAAexd,KAAKD,OAAOyd,eACH,cAChC1Q,EAAc9I,YAAWjE,EAAOiG,YAAa,GAC7C+G,EAAU/M,KAAKwqB,eACnBzd,GAAQ7H,QAAUlB,YAAWjE,EAAOmF,YAAa,GACjD6H,EAAQ9F,UAAYjD,YAAWjE,EAAOkH,cAAe,GACrD8F,EAAQlH,iBAAmB7B,YAAWjE,EAAO8F,qBAAsB,EACnE,IAAIuZ,IAAoBhW,aAAc,KACtCrJ,GAAO+C,OAAO,iBAAmBxB,KAAM,kBAAmByB,kBAAkB,EACxEvB,OAASyC,IAAKmb,KAClBrS,EAAQ3D,aAAepF,YAAWob,EAA8B,iBAAO,GACvEpf,KAAKuqB,UAAU5jB,EAAM,MACrB5G,EAAO+C,OAAO,QAAUxB,KAAM,iBAAkByB,kBAAkB,IAClEhD,EAAO+C,OAAO,aAAexB,KAAM,qBAAsByB,kBAAkB,EACvEvB,OAAS6L,UAAW1G,EAAM2G,YAAaP,EAASQ,gBAAiBR,EAAQ7H,QACrEsI,kBAAmBT,EAAQ9F,UAAWwG,qBAAsBV,EAAQ3D,aACpEsE,gBAAiBZ,EAAaa,aAAc,KAC5CC,YAAa,KAAMC,eAAgB6d,EAAYlmB,aAAc,SAEzE6jB,EAAOxoB,UAAUspB,cAAgB,SAAUxjB,GACvC,GACInF,GACAmqB,EAFAjf,EAAa1M,KAAKqC,aAAasC,OAAOgI,MAAM,IAGhD,QAAQhG,GACJ,IAAK,aACDglB,EAAWjf,EAAW,GAAGC,MAAM,KAC/BnL,EAAQmmB,WAAWgE,EAAS,GAAGhf,MAAM,KAAK,IAC1C3M,KAAK2d,gBAAgB2L,WAAatpB,KAAK4rB,eAAepqB,EACtD,MACJ,KAAK,WACDmqB,EAAWjf,EAAW,GAAGC,MAAM,KAC/BnL,EAAQmmB,WAAWgE,EAAS,GAAGhf,MAAM,KAAK,IAC1CnL,GAAS,IACTxB,KAAK2d,gBAAgB4L,SAAWvpB,KAAK4rB,eAAepqB,EACpD,MACJ,KAAK,MACDmqB,EAAWjf,EAAW,GAAGC,MAAM,KAC/BnL,EAAQmmB,WAAWgE,EAAS,GAAGhf,MAAM,KAAK,IAC1CnL,GAAS,EACTxB,KAAK2d,gBAAgB6L,IAAMhoB,CAC3B,MACJ,KAAK,aACDmqB,EAAWjf,EAAW,GAAGC,MAAM,KAC/BnL,EAAQmmB,WAAWgE,EAAS,GAAGhf,MAAM,KAAK,IAC1CnL,GAAS,IACTxB,KAAK2d,gBAAgB8L,WAAazpB,KAAK6rB,yBAAyBrqB,EAChE,MACJ,KAAK,UACDmqB,EAAWjf,EAAW,GAAGC,MAAM,KAEjB,OADdnL,EAAQmmB,WAAWgE,EAAS,GAAGhf,MAAM,KAAK,KAEtCnL,EAAQ,GAEO,KAAVA,EACLA,EAAQ,GAEO,MAAVA,EACLA,EAAQ,GAEO,KAAVA,EACLA,EAAQ,GAEO,MAAVA,EACLA,EAAQ,EAGRA,GAAS,IAEbxB,KAAK2d,gBAAgB7B,QAAUta,CAC/B,MACJ,KAAK,OACDmqB,EAAWjf,EAAW,GAAGC,MAAM,KAC/BnL,EAAQmmB,WAAWgE,EAAS,GAAGhf,MAAM,KAAK,IAC1CnL,GAAS,GACTxB,KAAK2d,gBAAgB+L,KAAOloB,CAC5B,MACJ,KAAK,WACDmqB,EAAWjf,EAAW,GAAGC,MAAM,KAC/BnL,EAAQmmB,WAAWgE,EAAS,GAAGhf,MAAM,KAAK,IAC1C3M,KAAK2d,gBAAgBgM,SAAW3pB,KAAK4rB,eAAepqB,KAIhE6nB,EAAOxoB,UAAU+qB,eAAiB,SAAUpqB,GACxC,MAAO2G,MAAK2jB,MAAiB,IAAVtqB,EAAe,EAAmB,KAAbA,EAAQ,GAAY,KAEhE6nB,EAAOxoB,UAAUgrB,yBAA2B,SAAUrqB,GAClD,MAAO2G,MAAK2jB,MAAiB,IAAVtqB,EAAe,EAAkB,KAAbA,EAAQ,KAEnD6nB,EAAOxoB,UAAUupB,aAAe,SAAUzjB,EAAMkH,GAC5C,GAAI9N,GAASC,KAAKD,MAElB,KAAkC,KADhB,UAAW,SAAU,OAAQ,OAAQ,YAAa,gBAAiB,QAAS,SAAU,WACzFye,QAAQ7X,GAAc,CACjC,GAAIolB,GAAShsB,EAAOgO,QAAQoO,cAAc,2DACtC4P,IACAA,EAAO9O,UAAU+O,OAAO,aAE5B,IAAIC,GAAelP,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,IAAMrW,EAAO,SACxEslB,IACAA,EAAaC,cAAcjP,UAAUa,IAAI,cAE7C9d,KAAKD,OAAOyd,cAAgB3P,GAAkC9N,EAAOgO,QAAQiP,GAAK,IAAMrW,IAGhG0iB,EAAOxoB,UAAUkpB,cAAgB,SAAUoC,EAAgB3qB,GACvD,GAAIzB,GAASC,KAAKD,MAClB,KAAKA,EAAOyL,UAAYzL,EAAO0L,cAAe,CAC1C,OAAQ0gB,EAAevZ,eACnB,IAAK,aACD5S,KAAK6qB,aAAa,aAAcrpB,EAChC,MACJ,KAAK,WACDxB,KAAK6qB,aAAa,WAAYrpB,EAC9B,MACJ,KAAK,MACDxB,KAAK6qB,aAAa,MAAOrpB,EACzB,MACJ,KAAK,aACDxB,KAAK6qB,aAAa,aAAcrpB,EAChC,MACJ,KAAK,UACDxB,KAAK6qB,aAAa,UAAWrpB,EAC7B,MACJ,KAAK,OACDxB,KAAK6qB,aAAa,OAAQrpB,EAC1B,MACJ,KAAK,WACDxB,KAAK6qB,aAAa,WAAYrpB,GAGtCxB,KAAKD,OAAOqd,aAAepd,KAAKqC,aAAasC,OAC7C5E,EAAO+C,OAAO,aAAexB,KAAM,gBAAiBE,OAASmF,KAAM,UAG3E0iB,EAAOxoB,UAAUypB,gBAAkB,SAAU3jB,EAAMnF,GAE/C,OADAxB,KAAKD,OAAO+C,OAAO,QAAUxB,KAAM,iBAAkByB,kBAAkB,IAC/D4D,GACJ,IAAK,aACD3G,KAAK6qB,aAAa,aAAcrpB,EAChC,MACJ,KAAK,WACDxB,KAAK6qB,aAAa,WAAYrpB,EAC9B,MACJ,KAAK,MACDxB,KAAK6qB,aAAa,MAAOrpB,EACzB,MACJ,KAAK,aACDxB,KAAK6qB,aAAa,aAAcrpB,EAChC,MACJ,KAAK,UACDxB,KAAK6qB,aAAa,UAAWrpB,EAC7B,MACJ,KAAK,OACDxB,KAAK6qB,aAAa,OAAQrpB,EAC1B,MACJ,KAAK,WACDxB,KAAK6qB,aAAa,WAAYrpB,KAI1C6nB,EAAOxoB,UAAU2pB,cAAgB,SAAUrc,GACvC,GAAIpO,GAASC,KAAKD,OACdqsB,GAAwBjpB,MAAO,KACnCpD,GAAO+C,OAAO,QAAUxB,KAAM,sBAAuBE,OAASyC,IAAKmoB,IACnE,IAAIC,IAAYnf,kBAAmB,KACnCnN,GAAO+C,OAAO,aAAexB,KAAM,uBAAwBE,OAASyC,IAAKooB,IACzE,IAAIpoB,IAAQsF,SAAU,EAAGmY,YAAa,EAAGpa,kBAAoB9G,EAAG,EAAGC,EAAG,GAAKsJ,wBAA0BvJ,EAAG,EAAGC,EAAG,GAC1GwI,0BAA4BzI,EAAG,EAAGC,EAAG,GAAKF,kBAAoBC,EAAG,EAAGC,EAAG,GAAKmC,aAC5E0D,kBAAoBrD,OAAQ,EAAGS,cAAe,GAAIG,WAAY,EAAGqJ,kBAAmB,EACpF/D,YAAchJ,OAAQ,EAAGC,OAAQ,EAAGC,MAAO,EAAGC,OAAQ,GACtDqhB,WAAaxhB,OAAQ,EAAGC,OAAQ,EAAGC,MAAO,EAAGC,OAAQ,GAAKqE,OAAQ,GAAIid,eAAgB5hB,KAAKud,qBAqB/F,OApBAtZ,GAAIsF,SAAWxJ,EAAOiD,UAAUsc,eAChCrb,EAAIyd,YAAc3hB,EAAOiD,UAAU4C,kBACnC3B,EAAIJ,WAAa9D,EAAOkN,aAAapJ,WACrCI,EAAIiJ,kBAAoBmf,EAA2B,kBACnDpoB,EAAIqD,iBAAmBtD,YAAWjE,EAAOsH,SAASC,qBAAsB,GACxErD,EAAI8F,uBAAyB/F,YAAWjE,EAAOsH,SAAS0C,2BAA4B,GACpF9F,EAAIgF,yBAA2BjF,YAAWjE,EAAOsH,SAAS4B,6BAA8B,GACxFhF,EAAI1D,iBAAmByD,YAAWooB,EAA2B,UAAO,GACpEnoB,EAAIrB,UAAYoB,YAAWjE,EAAO6C,cAAe,GACjDqB,EAAIqC,eAAiBtC,YAAWjE,EAAOuG,mBAAoB,GAC3DrC,EAAIhB,OAASlD,EAAOiD,UAAUC,OAC9BgB,EAAIP,cAAgB3D,EAAOiD,UAAUU,cACrCO,EAAIkF,YAAehJ,OAAQJ,EAAOqD,IAAIC,SAAUjD,OAAQL,EAAOqD,IAAIE,QAASyE,KAAM,EAAGC,KAAM,EACvF3H,MAAON,EAAOqD,IAAIG,UAAWjD,OAAQP,EAAOqD,IAAII,YACpDS,EAAI0d,WAAcxhB,OAAQJ,EAAOqD,IAAIgB,QAAShE,OAAQL,EAAOqD,IAAIiB,OAAQ0D,KAAM,EAAGC,KAAM,EACpF3H,MAAON,EAAOqD,IAAIkB,SAAUhE,OAAQP,EAAOqD,IAAImB,WACnDN,EAAIU,OAAS3E,KAAKqC,aAAasC,OAC3BwJ,IACAA,EAAkB,QAAIlK,GAEnBA,GAEJolB,KC/qBPiD,EAAiC,WACjC,QAASA,GAAgBvsB,GACrBC,KAAKusB,QAAWC,UAAW,EAAGC,aAAc,EAAGC,KAAM,EAAGC,OAAQ,EAAGC,OAAQ,GAC3E5sB,KAAK6sB,mBAAoB,EACzB7sB,KAAK8sB,mBAAsBtsB,EAAG,EAAGC,EAAG,GACpCT,KAAK+sB,sBAAuB,EAC5B/sB,KAAKgtB,aAAe,EAEpBhtB,KAAKoJ,gBACLpJ,KAAKitB,WAAa,EAClBjtB,KAAKktB,aACLltB,KAAKmtB,eACLntB,KAAKotB,eAAkBre,YAAa,KAAMC,UAAW,KAAMC,YAAa,MACxEjP,KAAKD,OAASA,EACdC,KAAKY,mBAohCT,MAlhCA0rB,GAAgBzrB,UAAUC,QAAU,WAC5Bd,KAAKD,OAAOgB,aAGhBf,KAAKgB,uBAETsrB,EAAgBzrB,UAAUD,iBAAmB,WACzCZ,KAAKD,OAAOkB,GAAG,gBAAiBjB,KAAKyQ,KAAMzQ,MAC3CA,KAAKD,OAAOkB,GAAG,YAAajB,KAAKc,QAASd,OAE9CssB,EAAgBzrB,UAAUG,oBAAsB,WAC5ChB,KAAKD,OAAOoB,IAAI,gBAAiBnB,KAAKyQ,MACtCzQ,KAAKD,OAAOoB,IAAI,YAAanB,KAAKc,UAEtCwrB,EAAgBzrB,UAAU4P,KAAO,SAAUrP,GAEvC,OADApB,KAAKqtB,kBACGjsB,EAAKE,MACT,IAAK,WACDtB,KAAKstB,SAASlsB,EAAKI,MAAmB,YAAGJ,EAAKI,MAAmB,YACjE,MAEJ,KAAK,sBACDxB,KAAKutB,oBAAoBnsB,EAAKI,MAAS,EAAGJ,EAAKI,MAAc,OAC7D,MACJ,KAAK,oBACDxB,KAAKwtB,kBAAkBpsB,EAAKI,MAAS,EAAGJ,EAAKI,MAAc,OAAGJ,EAAKI,MAAe,QAClF,MACJ,KAAK,uBACGwb,EAAKyQ,SAASrsB,EAAKI,MAAU,GAAEmL,MAAM,KAAK,GAAI,IAAM,CACpD3M,MAAK0tB,SAAS1Q,IACdhd,KAAK2tB,UAAU3Q,GAAI,EAEvB,MAEJ,KAAK,iBACDhd,KAAK4tB,eAAexsB,EAAKI,MAAe,QAAGJ,EAAKI,MAAc,OAC9D,MACJ,KAAK,YACGwb,EAAKyQ,SAASrsB,EAAKI,MAAU,GAAEmL,MAAM,KAAK,GAAI,IAAM,CACxD3M,MAAK2tB,UAAU3Q,GAAI,EACnB,MAEJ,KAAK,YACD,GAAIA,GAAK,IACL5b,GAAKI,MAAU,KACfwb,EAAKyQ,SAASrsB,EAAKI,MAAU,GAAEmL,MAAM,KAAK,GAAI,IAAM,GAExD3M,KAAK6tB,UAAU7Q,EACf,MAEJ,KAAK,WACDhd,KAAK8tB,UACL,MACJ,KAAK,YACD9tB,KAAK+tB,WACL,MACJ,KAAK,kBACD/tB,KAAKguB,iBACL,MACJ,KAAK,gBACDhuB,KAAKiuB,eACL,MACJ,KAAK,cACDjuB,KAAKkuB,YAAY9sB,EAAKI,MAAa,MACnC,MACJ,KAAK,aACDxB,KAAKmuB,WAAW/sB,EAAKI,MAAa,MAAGJ,EAAKI,MAAa,MAAGJ,EAAKI,MAAiB,UAChF,MACJ,KAAK,gBACDxB,KAAKouB,eACL,MACJ,KAAK,cACDpuB,KAAKquB,YAAYjtB,EAAKI,MAAsB,eAC5C,MACJ,KAAK,iBACDxB,KAAKsuB,cACL,MACJ,KAAK,eACDtuB,KAAKuuB,aAAantB,EAAKI,MAAa,MACpC,MACJ,KAAK,WACDxB,KAAK0tB,SAAStsB,EAAKI,MAAa,MAAGJ,EAAKI,MAAW,IACnD,MACJ,KAAK,YACDxB,KAAKwuB,UAAUptB,EAAKI,MAAW,IAAGJ,EAAKI,MAAW,IAClD,MACJ,KAAK,kBACDJ,EAAKI,MAAW,IAAgB,aAAIwC,YAAWhE,KAAKoJ,aACpD,MACJ,KAAK,kBACDpJ,KAAKoJ,aAAepF,YAAW5C,EAAKI,MAAW,IAAgB,aAC/D,MACJ,KAAK,8BACDxB,KAAKyuB,UAAYrtB,EAAKI,MAAa,KACnC,MACJ,KAAK,8BACDJ,EAAKI,MAAW,IAAS,MAAIxB,KAAKyuB,SAClC,MACJ,KAAK,kBACDzuB,KAAKgtB,aAAe5rB,EAAKI,MAAa,KACtC,MACJ,KAAK,oBACDJ,EAAKI,MAAW,IAAkB,eAAIxB,KAAK0uB,cAC3C,MACJ,KAAK,oBACD1uB,KAAK0uB,eAAiBttB,EAAKI,MAAa,KACxC,MACJ,KAAK,8BACDJ,EAAKI,MAAW,IAA4B,yBAAIxB,KAAKitB,UACrD,MACJ,KAAK,8BACDjtB,KAAKitB,WAAa7rB,EAAKI,MAAa,KACpC,MACJ,KAAK,sBACDxB,KAAK2uB,qBACL,MACJ,KAAK,4BACDvtB,EAAKI,MAAW,IAA0B,uBAAIxB,KAAK4uB,QACnD,MACJ,KAAK,8BACD5uB,KAAK4uB,SAAW,IAChB,MACJ,KAAK,mCACDxtB,EAAKI,MAAW,IAAiC,8BAAIxB,KAAKotB,aAC1D,MACJ,KAAK,2BACDptB,KAAK6uB,UAAYztB,EAAKI,MAAa,KACnC,MACJ,KAAK,2BACDJ,EAAKI,MAAW,IAAyB,sBAAIxB,KAAK6uB,SAClD,MACJ,KAAK,QACD7uB,KAAKkC,UAIjBoqB,EAAgBzrB,UAAUwsB,gBAAkB,WACxC,GAAIttB,GAASC,KAAKD,MACdA,GAAOqC,cACPpC,KAAKqC,aAAetC,EAAOqC,YAAYE,WAAW,OAElDvC,EAAOwC,cACPvC,KAAKwC,aAAezC,EAAOwC,YAAYD,WAAW,QAG1DgqB,EAAgBzrB,UAAUqB,MAAQ,WAC9BlC,KAAKusB,QAAWC,UAAW,EAAGC,aAAc,EAAGC,KAAM,EAAGC,OAAQ,EAAGC,OAAQ,GAC3E5sB,KAAK6sB,kBAAoB7sB,KAAK+sB,sBAAuB,EACrD/sB,KAAKktB,aACLltB,KAAKmtB,eACLntB,KAAK8sB,mBAAsBtsB,EAAG,EAAGC,EAAG,GACpCT,KAAKoJ,gBACLpJ,KAAKyuB,UAAY,KACjBzuB,KAAKgtB,aAAe,EACpBhtB,KAAK4uB,SAAW,KAChB5uB,KAAK0uB,mBAAiBjb,GACtBzT,KAAKitB,WAAa,EAClBjtB,KAAK6uB,UAAY,KACjB7uB,KAAKotB,eAAkBre,YAAa,KAAMC,UAAW,KAAMC,YAAa,OAE5Eqd,EAAgBzrB,UAAUsB,cAAgB,WACtC,MAAO,iBAEXmqB,EAAgBzrB,UAAUysB,SAAW,SAAUla,EAAWnE,GACtD,GAAIlP,GAASC,KAAKD,MAClBA,GAAOqC,YAAc2a,SAASZ,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,gBACtEhd,KAAKqC,aAAetC,EAAOqC,YAAYE,WAAW,MAClDvC,EAAOwC,YAAcwa,SAASZ,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,gBACtEhd,KAAKwC,aAAezC,EAAOwC,YAAYD,WAAW,KAClD,IAAIiD,GAAUvF,KAAKwC,aACfssB,GAAO,CAEPA,GADA9uB,KAAKyuB,WAAa,EACZzuB,KAAKyuB,UAGLzuB,KAAK6uB,UAEf9uB,EAAO8I,OAAS7E,YAAWjE,EAAOkH,UAAU6nB,GAAKjmB,QACjD7I,KAAKgtB,aAAe,CACpB,IACI+B,GACAC,EACAjjB,EACAC,EAJA/G,EAAMlF,EAAO8I,OAAO1D,OAKpB8pB,EAAiB,EACjBC,EAAiB,CACrB3pB,GAAQ6N,UAAYA,GAAwBrT,EAAOkH,UAAU6nB,GAAK/f,YAClExJ,EAAQmQ,YAAcnQ,EAAQ6N,UAC9B6b,EAAiBC,EAAiBlvB,KAAK0uB,eAAiBzf,GACtClP,EAAOkH,UAAU6nB,GAAK7f,YAC5B,IAARhK,IACA8pB,EAAgBC,EAAgBjjB,EAAaC,EAAWjM,EAAO8I,OAAO,GACtE7I,KAAKmvB,UAAU5pB,EAASwpB,EAAeC,EAAejjB,EAAYC,EAAUijB,EAAgBC,GAEhG,KAAK,GAAIpmB,GAAI,EAAGA,EAAI7D,EAAM,EAAG6D,IACrB/I,EAAO8I,OAAOC,EAAI,IAAM/I,EAAO8I,OAAOC,EAAI,IAAM/I,EAAO8I,OAAOC,EAAI,KAClEimB,EAAiB/uB,KAAKovB,YAAYrvB,EAAO8I,OAAOC,EAAI,GAAI/I,EAAO8I,OAAOC,EAAI,GAAI/I,EAAO8I,OAAOC,EAAI,IAAKkmB,cACrGA,EAAiBhvB,KAAKovB,YAAYrvB,EAAO8I,OAAOC,EAAI,GAAI/I,EAAO8I,OAAOC,EAAI,GAAI/I,EAAO8I,OAAOC,EAAI,IAAKimB,cAEjGhjB,EADM,IAANjD,EACa/I,EAAO8I,OAAOC,GAGd/I,EAAO8I,OAAOC,EAAI,GAEnCkD,EAAWjM,EAAO8I,OAAOC,EAAI,GAC7B9I,KAAKmvB,UAAU5pB,EAASwpB,EAAeC,EAAejjB,EAAYC,EAAUijB,EAAgBC,GAGpG3pB,GAAQsF,WAER,IAAI1H,GAAQnD,KAAKwuB,UAAUM,GACvBnW,EAAgBpT,EAAQiQ,SAC5BjQ,GAAQiQ,UAAY,EACpBjQ,EAAQmQ,YAAc3V,EAAO4V,UAAU5V,EAAO6V,OAAqB,aACnErQ,EAAQgF,YACRhF,EAAQyQ,KAAK7S,EAAMhD,OAAQgD,EAAM/C,OAAQ+C,EAAM9C,MAAO8C,EAAM7C,QAC5DiF,EAAQwQ,SACRxQ,EAAQsF,YACRtF,EAAQiQ,UAAYmD,GAExB2T,EAAgBzrB,UAAU0sB,oBAAsB,SAAU8B,EAAGhqB,GACzDrF,KAAKD,OAAOqC,YAAc2a,SAASZ,cAAc,IAAMnc,KAAKD,OAAOgO,QAAQiP,GAAK,gBAChFhd,KAAKqC,aAAerC,KAAKD,OAAOqC,YAAYE,WAAW,MACvDtC,KAAKD,OAAOwC,YAAcwa,SAASZ,cAAc,IAAMnc,KAAKD,OAAOgO,QAAQiP,GAAK,gBAChFhd,KAAKwC,aAAexC,KAAKD,OAAOwC,YAAYD,WAAW,MACvDtC,KAAKusB,OAAOG,MAAO,GAAI4C,OAAOC,UAC9BvvB,KAAK6sB,mBAAoB,EACV,cAAXwC,EAAE1oB,KACF3G,KAAK8sB,mBAAsBtsB,EAAG6uB,EAAEG,QAAS/uB,EAAG4uB,EAAEI,SAG9CzvB,KAAK8sB,mBAAsBtsB,EAAG6uB,EAAEK,QAAQ,GAAGF,QAAS/uB,EAAG4uB,EAAEK,QAAQ,GAAGD,SAExEzvB,KAAK+sB,sBAAuB,EAC5B4C,eAAa7R,IAAIzY,EAAQ,sBAAuBrF,KAAK4vB,oBAAqB5vB,OAE9EssB,EAAgBzrB,UAAU2sB,kBAAoB,SAAU6B,EAAGhqB,EAAQE,GAC/D,GAAIyQ,GAAO3Q,EAAOwqB,wBACd9vB,EAASC,KAAKD,MAClB4vB,gBAAa3D,OAAO3mB,EAAQ,sBAAuBrF,KAAK4vB,qBAC3B,IAAzB7vB,EAAO8I,OAAO1D,SACC,YAAXkqB,EAAE1oB,KACF3G,KAAK8vB,aAAaT,EAAEG,QAAUxZ,EAAKiF,KAAMoU,EAAEI,QAAUzZ,EAAK0Q,KAAK,EAAMnhB,GAGhEvF,KAAK+sB,sBACN/sB,KAAK8vB,aAAa9vB,KAAK8sB,kBAAkBtsB,EAAIwV,EAAKiF,KAAMjb,KAAK8sB,kBAAkBrsB,EAAIuV,EAAK0Q,KAAK,EAAMnhB,IAI/GA,EAAQsF,WACR,IAAIiC,GAAc9I,YAAWjE,EAAOiG,YAAa,GAC7CF,GAAWC,WACfhG,GAAO+C,OAAO,UAAYxB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAASsE,OAAQA,IAC3F,IAAIiH,GAAUjH,EAAgB,OAC9BiH,GAAQ7H,QAAUlB,YAAWjE,EAAOmF,YAAa,GACjD6H,EAAQ9F,UAAYjD,YAAWjE,EAAOkH,cAAe,GACrD8F,EAAQlH,iBAAmB7B,YAAWjE,EAAO8F,qBAAsB,EACnE,IAAIuZ,IAAoBhW,aAAc,KACtCrJ,GAAO+C,OAAO,iBAAmBxB,KAAM,kBAAmByB,kBAAkB,EACxEvB,OAASyC,IAAKmb,KAClBrS,EAAQ3D,aAAepF,YAAWob,EAA8B,iBAAO,EACvE,IAAI2Q,GAAQhwB,EAAOiH,eACnBjH,GAAOkH,UAAU8oB,MACjBhwB,EAAOkH,UAAU8oB,GAAOlnB,OAAS7E,YAAWjE,EAAO8I,QACnD9I,EAAOkH,UAAU8oB,GAAOhhB,YAAchP,EAAO6C,UAAUmQ,eAAehE,YACtEhP,EAAOkH,UAAU8oB,GAAO9gB,YAAcjP,KAAK0uB,eAC3C3uB,EAAOkH,UAAU8oB,GAAO5kB,UAAYpL,EAAOiD,UAAUU,cACrD3D,EAAOkH,UAAU8oB,GAAO/S,GAAK,QAAUhd,KAAKitB,WAAa,GACzDltB,EAAO8I,UACP7I,KAAKmtB,eACLntB,KAAKoJ,aAAa2mB,MAClB/vB,KAAKoJ,aAAa2mB,GAAOlnB,OAAS7E,YAAWhE,KAAKktB,WAClDltB,KAAKktB,aACLltB,KAAKgtB,aAAe,EACpBjtB,EAAOiH,kBACPhH,KAAKitB,aACLjtB,KAAK6sB,mBAAoB,EACzB9sB,EAAO+C,OAAO,aAAexB,KAAM,qBAAsByB,kBAAkB,EACvEvB,OAAS6L,UAAW,gBAAiBC,YAAaP,EAASQ,gBAAiBR,EAAQ7H,QAChFsI,kBAAmBT,EAAQ9F,UAAWwG,qBAAsBV,EAAQ3D,aACpEsE,gBAAiBZ,EAAaa,aAAc,KAC5CC,YAAa,KAAMC,eAAgB,KAAMrI,aAAc,SAEnE8mB,EAAgBzrB,UAAU+uB,oBAAsB,SAAUP,GACtDrvB,KAAK+sB,sBAAuB,CAC5B,IACIvsB,GACAC,EAFAuV,EAAOhW,KAAKD,OAAOwC,YAAYstB,uBAGpB,eAAXR,EAAE1oB,MACFnG,EAAI6uB,EAAEG,QAAUxZ,EAAKiF,KACrBxa,EAAI4uB,EAAEI,QAAUzZ,EAAK0Q,MAGrBlmB,EAAI6uB,EAAEK,QAAQ,GAAGF,QAAUxZ,EAAKiF,KAChCxa,EAAI4uB,EAAEK,QAAQ,GAAGD,QAAUzZ,EAAK0Q,KAEhC1mB,KAAK6sB,mBACL7sB,KAAK8vB,aAAatvB,EAAGC,GAAG,EAAOT,KAAKwC,eAG5C8pB,EAAgBzrB,UAAUivB,aAAe,SAAUtvB,EAAGC,EAAGuvB,EAAWzqB,GAChE,GAIIwpB,GACAC,EACAjjB,EACAC,EAPAjM,EAASC,KAAKD,OACdkwB,EAAYjwB,KAAKmD,MAAM3C,EAAGC,GAAG,GAAI6uB,OAAOC,WAExCW,KADJD,EAAYlwB,EAAO8I,OAAO1D,OAAS,GAAKpF,EAAO8I,OAAO9I,EAAO8I,OAAO1D,OAAS,KACvCnF,KAAKmwB,WAAWF,IAAc,CAQpE,IAHAjwB,KAAKktB,UAAUjnB,MAAOzF,EAAGA,EAAGC,EAAGA,EAAGkI,QAASnI,EAAIT,EAAOqD,IAAIC,UAAYtD,EAAOqD,IAAIG,UAC7EqF,QAASnI,EAAIV,EAAOqD,IAAIE,SAAWvD,EAAOqD,IAAII,WAC9CkpB,KAAM1sB,KAAKusB,OAAOG,QACjBuD,IAAeA,IAAaC,GAAwBF,EAAW,CAQhE,GAPAhwB,KAAKusB,OAAOG,MAAO,GAAI4C,OAAOC,UAC9BxvB,EAAO8I,OAAO5C,MAAOzF,EAAGA,EAAGC,EAAGA,EAAGkI,QAASnI,EAAIT,EAAOqD,IAAIC,UAAYtD,EAAOqD,IAAIG,UAC5EqF,QAASnI,EAAIV,EAAOqD,IAAIE,SAAWvD,EAAOqD,IAAII,WAC9CkpB,KAAM1sB,KAAKusB,OAAOG,OACtB1sB,KAAKmtB,YAAYlnB,MAAOzF,EAAGA,EAAGC,EAAGA,EAAGkI,QAASnI,EAAIT,EAAOqD,IAAIC,UAAYtD,EAAOqD,IAAIG,UAC/EqF,QAASnI,EAAIV,EAAOqD,IAAIE,SAAWvD,EAAOqD,IAAII,WAC9CkpB,KAAM1sB,KAAKusB,OAAOG,OAClB1sB,KAAKmtB,YAAYhoB,OAAS,EAAG,CACG,IAA5BnF,KAAKmtB,YAAYhoB,QACjBnF,KAAKmtB,YAAYiD,QAAQpwB,KAAKmtB,YAAY,GAE9C,IAAIkD,GAAKrwB,KAAKmtB,YAAY,GACtBmD,EAAKtwB,KAAKmtB,YAAY,GACtBoD,EAAKvwB,KAAKmtB,YAAY,GACtBqD,EAAKxwB,KAAKmtB,YAAY,EAC1B4B,GAAgB/uB,KAAKovB,YAAYiB,EAAIC,EAAIC,GAAIvB,cAC7CA,EAAgBhvB,KAAKovB,YAAYkB,EAAIC,EAAIC,GAAIzB,cAC7ChjB,EAAa/L,KAAKmtB,YAAY,GAC9BnhB,EAAWhM,KAAKmtB,YAAY,EAC5B,IAAI8B,GAAiB,GACjBC,EAAiB,CAChBjtB,qBAAkBjC,KAAK0uB,kBACxBO,EAAiBC,EAAiBlvB,KAAK0uB,gBAE3C1uB,KAAKmvB,UAAU5pB,EAASwpB,EAAeC,EAAejjB,EAAYC,EAAUijB,EAAgBC,GAC5FlvB,KAAKgtB,eACLhtB,KAAKmtB,YAAYsD,QAErB,GAAIT,EAAW,CACXjB,EAAgBC,EAAgBjjB,EAAaC,GAAaxL,EAAGA,EAAGC,EAAGA,EAAGisB,MAAM,GAAI4C,OAAOC,UACvF,IAAIN,GAAiB,GACjBC,EAAiB,CAChBjtB,qBAAkBjC,KAAK0uB,kBACxBO,EAAiBC,EAAiBlvB,KAAK0uB,gBAE3C1uB,KAAKmvB,UAAU5pB,EAASwpB,EAAeC,EAAejjB,EAAYC,EAAUijB,EAAgBC,MAIxG5C,EAAgBzrB,UAAUuuB,YAAc,SAAUkB,EAAIC,EAAIC,GACjDD,IACDA,EAAKD,GAEJE,IACDA,EAAKD,EAET,IAAIG,GAAMJ,EAAG9vB,EAAI+vB,EAAG/vB,EAChBmwB,EAAML,EAAG7vB,EAAI8vB,EAAG9vB,EAChBmwB,EAAML,EAAG/vB,EAAIgwB,EAAGhwB,EAChBqwB,EAAMN,EAAG9vB,EAAI+vB,EAAG/vB,EAChBqwB,GAAOtwB,GAAI8vB,EAAG9vB,EAAI+vB,EAAG/vB,GAAK,EAAKC,GAAI6vB,EAAG7vB,EAAI8vB,EAAG9vB,GAAK,GAClDswB,GAAOvwB,GAAI+vB,EAAG/vB,EAAIgwB,EAAGhwB,GAAK,EAAKC,GAAI8vB,EAAG9vB,EAAI+vB,EAAG/vB,GAAK,GAClDuwB,EAAK7oB,KAAK+R,KAAKwW,EAAMA,EAAMC,EAAMA,GACjCM,EAAK9oB,KAAK+R,KAAK0W,EAAMA,EAAMC,EAAMA,GACjCK,EAAOJ,EAAGtwB,EAAIuwB,EAAGvwB,EACjB2wB,EAAOL,EAAGrwB,EAAIswB,EAAGtwB,EACjBsa,EAAIkW,GAAMD,EAAKC,GACfG,GAAO5wB,EAAGuwB,EAAGvwB,EAAI0wB,EAAMnW,EAAGta,EAAGswB,EAAGtwB,EAAI0wB,EAAMpW,GAC1CsW,EAAKd,EAAG/vB,EAAI4wB,EAAG5wB,EACf8wB,EAAKf,EAAG9vB,EAAI2wB,EAAG3wB,CACnB,QACIsuB,cAAe/uB,KAAKmD,MAAM2tB,EAAGtwB,EAAI6wB,EAAIP,EAAGrwB,EAAI6wB,EAAI,GAChDtC,cAAehvB,KAAKmD,MAAM4tB,EAAGvwB,EAAI6wB,EAAIN,EAAGtwB,EAAI6wB,EAAI,KAGxDhF,EAAgBzrB,UAAUsC,MAAQ,SAAU3C,EAAGC,EAAGisB,GAG9C,MAFA1sB,MAAKusB,OAAOI,OAASnsB,EACrBR,KAAKusB,OAAOK,OAASnsB,GACZD,EAAGR,KAAKusB,OAAOI,OAAQlsB,EAAGT,KAAKusB,OAAOK,OAAQF,KAAMA,IAEjEJ,EAAgBzrB,UAAUsuB,UAAY,SAAU5pB,EAASwpB,EAAeC,EAAejjB,EAAYC,EAAUijB,EAAgBC,GACzH,GAAIqC,EAEJA,GAAe,IADfA,EAAevxB,KAAKwxB,cAAczlB,KACG,EAAI,IAAO/L,KAAKusB,OAAOE,YAC5D,IAAItD,GAAWhhB,KAAK4Y,IAAImO,MAA4BD,EACpDjvB,MAAKyxB,UAAUzxB,KAAKusB,OAAOG,KAAMvD,EAAU5jB,EAASwpB,EAAeC,EAAejjB,EAAYC,EAAUkjB,GACxGlvB,KAAKusB,OAAOE,aAAe8E,EAC3BvxB,KAAKusB,OAAOG,KAAOvD,GAEvBmD,EAAgBzrB,UAAU2wB,cAAgB,SAAUzlB,GAChD,MAAQ/L,MAAKusB,OAAOG,OAAS3gB,EAAW2gB,KAAQ1sB,KAAKmwB,WAAWpkB,IAC3D/L,KAAKusB,OAAOG,KAAO3gB,EAAW2gB,MAAQ,GAE/CJ,EAAgBzrB,UAAUsvB,WAAa,SAAU5Z,GAC7C,MAAOpO,MAAK+R,KAAK/R,KAAKupB,IAAI1xB,KAAKusB,OAAOI,OAASpW,EAAM/V,EAAG,GAAK2H,KAAKupB,IAAI1xB,KAAKusB,OAAOK,OAASrW,EAAM9V,EAAG,KAExG6rB,EAAgBzrB,UAAU4wB,UAAY,SAAUE,EAAYC,EAAUrsB,EAASwpB,EAAeC,EAAejjB,EAAYC,EAAUkjB,GAC/H,GAAI7uB,GACA2E,EACA6sB,EACA5X,EACA6X,EACAC,EACAC,EACAC,EACAzxB,EACAC,EACAyxB,EAAaN,EAAWD,EACxBQ,EAAenyB,KAAKmyB,aAAapD,EAAeC,EAAejjB,EAAYC,GAC3EomB,EAAsC,EAA1BjqB,KAAKkqB,KAAKF,EAE1B,KADA5sB,EAAQgF,YACHvF,EAAI,EAAGA,EAAIotB,EAAWptB,IAGvB8sB,GADA7X,GADA4X,EAAK7sB,EAAIotB,GACCP,GACAA,EAIVrxB,GADAyxB,GADAD,GADAD,EAAK,EAAIF,GACCE,GACAA,GACDhmB,EAAWvL,EACpBA,GAAK,EAAIwxB,EAAKH,EAAK9C,EAAcvuB,EACjCA,GAAK,EAAIuxB,EAAK9X,EAAK+U,EAAcxuB,EACjCA,GAAKsxB,EAAK9lB,EAASxL,EACnBC,EAAIwxB,EAAKlmB,EAAWtL,EACpBA,GAAK,EAAIuxB,EAAKH,EAAK9C,EAActuB,EACjCA,GAAK,EAAIsxB,EAAK9X,EAAK+U,EAAcvuB,EACjCA,GAAKqxB,EAAK9lB,EAASvL,EACnBJ,EAAQ8H,KAAK6Y,IAAI2Q,EAAaG,EAAKI,EAAYhD,GAC/ClvB,KAAKsyB,QAAQ9xB,EAAGC,EAAGJ,EAAOkF,EAE9BA,GAAQsF,YACRtF,EAAQuF,QAEZwhB,EAAgBzrB,UAAUsxB,aAAe,SAAUpD,EAAeC,EAAejjB,EAAYC,GACzF,GAEIhH,GACAutB,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EARA1tB,EAAS,CASb,KAAKH,EAAI,EAAGA,GAVA,GAUYA,IACpButB,EAAIvtB,EAXI,GAYRwtB,EAAUxyB,KAAK8yB,YAAYP,EAAGxmB,EAAWvL,EAAGuuB,EAAcvuB,EAAGwuB,EAAcxuB,EAAGwL,EAASxL,GACvFiyB,EAAUzyB,KAAK8yB,YAAYP,EAAGxmB,EAAWtL,EAAGsuB,EAActuB,EAAGuuB,EAAcvuB,EAAGuL,EAASvL,GACnFuE,EAAI,IACJ4tB,EAAUJ,EAAUE,EACpBG,EAAUJ,EAAUE,EACpBxtB,GAAUgD,KAAK+R,KAAK0Y,EAAUA,EAAUC,EAAUA,IAEtDH,EAAUF,EACVG,EAAUF,CAEd,OAAOttB,IAEXmnB,EAAgBzrB,UAAUiyB,YAAc,SAAUP,EAAGxmB,EAAYgnB,EAAKC,EAAKhnB,GACvE,MAAOD,IAAc,EAAMwmB,IAAM,EAAMA,IAAM,EAAMA,GAAK,EAAMQ,GAAO,EAAMR,IAAM,EAAMA,GAAKA,EAAI,EAC5FS,GAAO,EAAMT,GAAKA,EAAIA,EAAIvmB,EAAWumB,EAAIA,EAAIA,GAErDjG,EAAgBzrB,UAAUyxB,QAAU,SAAU9xB,EAAGC,EAAGwH,EAAM1C,IACjD/E,EAAIR,KAAKD,OAAOqD,IAAIC,UAAY5C,EAAIT,KAAKD,OAAOqD,IAAIE,SAAW9C,EAAKR,KAAKD,OAAOqD,IAAIC,SAAWrD,KAAKD,OAAOqD,IAAIG,WAChH9C,EAAKT,KAAKD,OAAOqD,IAAIE,QAAUtD,KAAKD,OAAOqD,IAAII,YAC9C+B,IAAYvF,KAAKqC,cAAgBkD,IAAYvF,KAAKwC,gBACnD+C,EAAQsQ,OAAOrV,EAAGC,GAClB8E,EAAQoF,IAAInK,EAAGC,EAAGwH,EAAM,EAAG,EAAIE,KAAKyC,IAAI,KAGhD0hB,EAAgBzrB,UAAU+sB,eAAiB,SAAUroB,EAASsD,GAC1D,GAAI9I,GAASC,KAAKD,MAClBA,GAAOqC,YAAc2a,SAASZ,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,gBACtEhd,KAAKqC,aAAetC,EAAOqC,YAAYE,WAAW,MAClDvC,EAAOwC,YAAcwa,SAASZ,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,gBACtEhd,KAAKwC,aAAezC,EAAOwC,YAAYD,WAAW,KAClD,IAAIoC,GAAOa,EAAQZ,MACnBY,GAAQZ,OAAS,OACbkE,IACA9I,EAAOkH,UAAUlH,EAAOiH,oBACxBjH,EAAOkH,UAAUlH,EAAOiH,iBAAiB6B,OAASA,EAClD9I,EAAOkH,UAAUlH,EAAOiH,iBAAiB+H,YAAchP,EAAO6C,UAAUmQ,eAAehE,YACvFhP,EAAOkH,UAAUlH,EAAOiH,iBAAiBiI,YAAcjP,KAAK0uB,eAC5D3uB,EAAOkH,UAAUlH,EAAOiH,iBAAiBmE,UAAYpL,EAAOiD,UAAUU,cACtE3D,EAAOiH,kBAEX,KAAK,GAAI0B,GAAI,EAAGA,EAAI3I,EAAOiH,gBAAiB0B,IAAK,CAC7C3I,EAAO8I,OAAS7E,YAAWjE,EAAOkH,UAAUyB,GAAGG,QAC/C7I,KAAKgtB,aAAe,CACpB,IAAI/nB,GAAMlF,EAAO8I,OAAO1D,OACpB4pB,MAAgB,GAChBC,MAAgB,GAChBjjB,MAAa,GACbC,MAAW,GACXijB,MAAiB,GACjBC,MAAiB,EACjBjqB,GAAM,IACNM,EAAQ6N,UAAYrT,EAAOkH,UAAUyB,GAAGqG,YACxCkgB,EAAiBC,EAAiBlvB,KAAK0uB,eAAiB3uB,EAAOkH,UAAUyB,GAAGuG,aAEpE,IAARhK,IACA8pB,EAAgBC,EAAgBjjB,EAAaC,EAAWjM,EAAO8I,OAAO,GACtE7I,KAAKmvB,UAAU5pB,EAASwpB,EAAeC,EAAejjB,EAAYC,EAAUijB,EAAgBC,GAEhG,KAAK,GAAIpmB,GAAI,EAAGA,EAAI7D,EAAM,EAAG6D,IACrB/I,EAAO8I,OAAOC,EAAI,IAAM/I,EAAO8I,OAAOC,EAAI,IAAM/I,EAAO8I,OAAOC,EAAI,KAClEimB,EAAiB/uB,KAAKovB,YAAYrvB,EAAO8I,OAAOC,EAAI,GAAI/I,EAAO8I,OAAOC,EAAI,GAAI/I,EAAO8I,OAAOC,EAAI,IAAKkmB,cACrGA,EAAiBhvB,KAAKovB,YAAYrvB,EAAO8I,OAAOC,EAAI,GAAI/I,EAAO8I,OAAOC,EAAI,GAAI/I,EAAO8I,OAAOC,EAAI,IAAKimB,cAEjGhjB,EADM,IAANjD,EACa/I,EAAO8I,OAAOC,GAGd/I,EAAO8I,OAAOC,EAAI,GAEnCkD,EAAWjM,EAAO8I,OAAOC,EAAI,GAC7B9I,KAAKmvB,UAAU5pB,EAASwpB,EAAeC,EAAejjB,EAAYC,EAAUijB,EAAgBC,GAGpG3pB,GAAQsF,YAEZtF,EAAQZ,OAASD,GAErB4nB,EAAgBzrB,UAAU2tB,UAAY,SAAUM,EAAK7qB,GACjD,GAAIpB,IAAgB1C,OAAQ,EAAGC,OAAQ,EAAG2H,KAAM,EAAGC,KAAM,EAAG3H,MAAO,EAAGC,OAAQ,GAC1E2yB,EAAUjvB,YAAWhE,KAAKoJ,aAAa0lB,GAAKjmB,UAChD7I,MAAKD,OAAO8I,OAAS7E,YAAWhE,KAAKD,OAAOkH,UAAU6nB,GAAKjmB,QAC3D7I,KAAKgtB,aAAe,CAEpB,KAAK,GADD/nB,GAAMguB,EAAQ9tB,OACT2D,EAAI,EAAGA,EAAI7D,EAAK6D,IACM,IAAvBjG,EAAY1C,QAAuC,IAAvB0C,EAAYzC,QAAqC,IAArByC,EAAYkF,MAAmC,IAArBlF,EAAYmF,MAC9FnF,EAAY1C,OAAS8yB,EAAQnqB,GAAGtI,EAChCqC,EAAYzC,OAAS6yB,EAAQnqB,GAAGrI,EAChCoC,EAAYkF,KAAOkrB,EAAQnqB,GAAGtI,EAC9BqC,EAAYmF,KAAOirB,EAAQnqB,GAAGrI,IAG9BoC,EAAY1C,OAASgI,KAAK6Y,IAAIne,EAAY1C,OAAQ8yB,EAAQnqB,GAAGtI,GAC7DqC,EAAYzC,OAAS+H,KAAK6Y,IAAIne,EAAYzC,OAAQ6yB,EAAQnqB,GAAGrI,GAC7DoC,EAAYkF,KAAOI,KAAK4Y,IAAIle,EAAYkF,KAAMkrB,EAAQnqB,GAAGtI,GACzDqC,EAAYmF,KAAOG,KAAK4Y,IAAIle,EAAYmF,KAAMirB,EAAQnqB,GAAGrI,GAYjE,OATAoC,GAAY1C,QAAUH,KAAK0uB,eAC3B7rB,EAAYzC,QAAUJ,KAAK0uB,eAC3B7rB,EAAYkF,MAAQ/H,KAAK0uB,eACzB7rB,EAAYmF,MAAQhI,KAAK0uB,eACzB7rB,EAAYxC,MAAQwC,EAAYkF,KAAOlF,EAAY1C,OACnD0C,EAAYvC,OAASuC,EAAYmF,KAAOnF,EAAYzC,OAChD6D,IACAA,EAAiB,YAAIpB,GAElBA,GAEXypB,EAAgBzrB,UAAUytB,aAAe,WACrC,GAAIvuB,GAASC,KAAKD,MACe,kBAA7BA,EAAO0F,YAAYL,QACnBrF,EAAO+C,OAAO,SAAWxB,KAAM,QAASyB,kBAAkB,EAAOvB,OAAS4D,MAAO,KAAMnB,IAAK,KAAMoB,OAAQ,QAC1GtF,EAAOwC,YAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS,UAClD9d,EAAO0F,YAAYL,MAAQ,IAE/BrF,EAAO+C,OAAO,SAAWxB,KAAM,iBAEnCgrB,EAAgBzrB,UAAUitB,SAAW,WACjC,GAAI/tB,GAASC,KAAKD,OAEdmzB,EAAgBnzB,EAAOkH,UAAUjH,KAAK6uB,UACR,aAA9BqE,EAAcnkB,cACdmkB,EAAcnkB,YAAc/O,KAAKotB,cAAcre,aAE9C7C,cACDnM,EAAO+C,OAAO,WAAaxB,KAAM,2BAA4BE,OAAS2xB,MAAO,aAEjFnzB,KAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOwC,YAAYlC,MAAON,EAAOwC,YAAYjC,QAC/EN,KAAKqC,aAAa8B,UAAU,EAAG,EAAGpE,EAAOqC,YAAY/B,MAAON,EAAOqC,YAAY9B,QAC/EP,EAAO+C,OAAO,QAAUxB,KAAM,eAAgBE,OAAS8Z,aAAc,QAChEpP,cACDnM,EAAO+C,OAAO,WAAaxB,KAAM,uBAAwByB,kBAAkB,IAE3EmwB,IACAA,EAAcE,YAAa,GAE/BrzB,EAAO+C,OAAO,aAAexB,KAAM,+BACnCtB,KAAKyuB,UAAYzuB,KAAK6uB,UAAY,MAEtCvC,EAAgBzrB,UAAUktB,UAAY,WAClC,GAAIhuB,GAASC,KAAKD,MACbmM,eACDnM,EAAO+C,OAAO,WAAaxB,KAAM,2BAA4BE,OAAS2xB,MAAO,aAEjFnzB,KAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOwC,YAAYlC,MAAON,EAAOwC,YAAYjC,QAC/EN,KAAKgtB,aAAe,EAChBjtB,EAAOkH,UAAUjH,KAAK6uB,aACtB9uB,EAAOkH,UAAUjH,KAAK6uB,WAAW9f,YAAc/O,KAAKotB,cAAcre,YAClEhP,EAAOkH,UAAUjH,KAAK6uB,WAAW5f,YAAcjP,KAAKotB,cAAcne,YAClElP,EAAOkH,UAAUjH,KAAK6uB,WAAWuE,YAAa,GAElDpzB,KAAKyuB,UAAYzuB,KAAK6uB,UAAY7uB,KAAK4uB,SAAW,KAClD7uB,EAAO+C,OAAO,aAAexB,KAAM,+BACnCvB,EAAO6C,UAAUmQ,eAAehE,YAAc/O,KAAKotB,cAAcre,YACjEhP,EAAO6C,UAAUmQ,eAAe9D,YAAcjP,KAAK0uB,eAAiB1uB,KAAKotB,cAAcne,YACvFjP,KAAKotB,eAAkBre,YAAa,KAAME,YAAa,KAAMD,UAAW,MACnE9C,cACDnM,EAAO+C,OAAO,WAAaxB,KAAM,uBAAwByB,kBAAkB,KAGnFupB,EAAgBzrB,UAAUgtB,UAAY,SAAUwF,GAC5C,GAAI9nB,GAAQvL,KACRD,EAASC,KAAKD,MAElB,IADAA,EAAO+C,OAAO,aAAexB,KAAM,yBAA0ByB,kBAAkB,EAAOvB,OAAS4E,MAAM,KACjGitB,GAAmB,IAAVA,EAAa,CACtB,IAAIrzB,KAAK0tB,SAAS2F,GAMd,MALArzB,MAAK6uB,UAAY7uB,KAAKyuB,UAAY4E,EAClCrzB,KAAKstB,WACLvtB,EAAOwC,YAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS,UAM1D7d,KAAK6uB,UAAY7uB,KAAKyuB,UACtB1uB,EAAOkH,UAAUjH,KAAK6uB,WAAWuE,YAAa,EAC9CpzB,KAAK4uB,SAAW7uB,EAAOkH,UAAUjH,KAAK6uB,WAAW7R,GACI,YAAjDjd,EAAOkH,UAAUjH,KAAKyuB,WAAW1f,cACjChP,EAAO6C,UAAUmQ,eAAehE,YAAc/O,KAAKotB,cAAcre,YAC7DhP,EAAOkH,UAAUjH,KAAKyuB,WAAW1f,aAEzChP,EAAO6C,UAAUmQ,eAAe9D,YAAcjP,KAAKotB,cAAcne,YAC7DlP,EAAOkH,UAAUjH,KAAKyuB,WAAWxf,WACrC,IAAIhL,IAAQmC,MAAM,EAElB,IADArG,EAAO+C,OAAO,aAAexB,KAAM,yBAA0ByB,kBAAkB,EAAOvB,OAASyC,IAAKA,KAChGA,EAAU,KAAG,CACb,GAAIqvB,IAAkBtW,GAAI,QAAUhd,KAAK6uB,UAAY,GAAIloB,KAAM4sB,YAAUC,aACrErzB,OAAQJ,EAAOkH,UAAUjH,KAAK6uB,WAAWhmB,OAAO,GAAGrI,EAAGJ,OAAQL,EAAOkH,UAAUjH,KAAK6uB,WAAWhmB,OAAO,GAAGpI,EACzGsO,YAAahP,EAAOkH,UAAUjH,KAAK6uB,WAAW9f,YAAaE,YAAalP,EAAOkH,UAAUjH,KAAK6uB,WAAW5f,YACzGpG,OAAQ9I,EAAOkH,UAAUjH,KAAK6uB,WAAWhmB,QACzC4qB,GAAsB5T,OAAQ,SAAU6T,sBAAuBJ,EAC/DK,qBAAsBL,EACtBpnB,eAAcnM,EAAOoM,SAAsD,IAA5CpM,EAAOoM,OAAOynB,cAAcxnB,YAE3DrM,EAAOsM,UAAUC,kBAAkB,kBAAmB,UAAWmnB,GAAmBlnB,KAAK,SAAUknB,GAC/F1zB,EAAO6C,UAAUmQ,eAAehE,YAAchP,EAAOkH,UAAUsE,EAAMsjB,WAAW9f,YAC5E0kB,EAAkBE,qBAAqB5kB,YAC3ChP,EAAO6C,UAAUmQ,eAAe9D,YAAclP,EAAOkH,UAAUsE,EAAMsjB,WAAW5f,YAC5EwkB,EAAkBE,qBAAqB1kB,YAC3ClP,EAAOkH,UAAUsE,EAAMsjB,WAAWhmB,OAAS4qB,EAAkBE,qBAAqB9qB,OAClF0C,EAAMqiB,eAAeriB,EAAM/I,cAC3BzC,EAAO+N,cAAc/N,EAAOgO,QAAS,mBAIzChO,EAAO0M,QAAQ,gBAAiBgnB,GAChC1zB,EAAO6C,UAAUmQ,eAAehE,YAAchP,EAAOkH,UAAUjH,KAAK6uB,WAAW9f,YAC3E0kB,EAAkBE,qBAAqB5kB,YAC3ChP,EAAO6C,UAAUmQ,eAAe9D,YAAclP,EAAOkH,UAAUjH,KAAK6uB,WAAW5f,YAC3EwkB,EAAkBE,qBAAqB1kB,YAC3ClP,EAAOkH,UAAUjH,KAAK6uB,WAAWhmB,OAAS4qB,EAAkBE,qBAAqB9qB,OACjF7I,KAAK4tB,eAAe5tB,KAAKwC,cACzBzC,EAAO+C,OAAO,WAAaxB,KAAM,kBAAmByB,kBAAkB,EAAOvB,OAASmF,KAAM,MACpF8C,WAAY,KAAMC,WAAY,KAAMC,UAAW,KAAMC,MAAO,aAIxE7J,GAAO8zB,SAGfvH,EAAgBzrB,UAAU8sB,UAAY,SAAU0F,EAAOS,GACnD,GAAI/zB,GAASC,KAAKD,MAClB,IAAIC,KAAK0tB,SAAS2F,GAAQ,CACtBrzB,KAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOwC,YAAYlC,MAAON,EAAOwC,YAAYjC,OAE/E,IAAI8nB,GAAgBpkB,YAAWjE,EAAOkH,cAAe,GAEjD8sB,EAAmB/vB,YAAWhE,KAAKoJ,iBAAkB,EACzDrJ,GAAOkH,aACPjH,KAAKoJ,eACL,IAAI4qB,GAAQ,CACZ,IAAI/xB,oBAAkB6xB,GAClB,IAAS9uB,EAAI,EAAGA,EAAIjF,EAAOiH,gBAAiBhC,IACpCA,IAAMquB,IACNtzB,EAAOkH,UAAU+sB,GAAS5L,EAAcpjB,GACxChF,KAAKoJ,aAAa4qB,GAASD,EAAiB/uB,GAC5CgvB,SAKR,KAAK,GAAIhvB,GAAI,EAAGA,EAAIjF,EAAOiH,gBAAiBhC,IACpCyoB,SAASrF,EAAcpjB,GAAGgY,GAAGrQ,MAAM,KAAK,GAAI,IAAM,IAAM0mB,IACxDtzB,EAAOkH,UAAU+sB,GAAS5L,EAAcpjB,GACxChF,KAAKoJ,aAAa4qB,GAASD,EAAiB/uB,GAC5CgvB,IAIZj0B,GAAOiH,iBAAmB,EAC1BhH,KAAKyuB,UAAYzuB,KAAK6uB,UAAY,KAClC9uB,EAAO+C,OAAO,aAAexB,KAAM,+BACnCvB,EAAO+C,OAAO,QAAUxB,KAAM,eAAgBE,OAAS8Z,cAAc,KAChEpP,cACDnM,EAAO+C,OAAO,WAAaxB,KAAM,uBAAwByB,kBAAkB,MAIvFupB,EAAgBzrB,UAAUozB,MAAQ,SAAUzzB,GACxC,MAAQA,GAAIR,KAAKD,OAAOqD,IAAIG,UAAavD,KAAKD,OAAOqD,IAAIC,UAE7DipB,EAAgBzrB,UAAUqzB,MAAQ,SAAUzzB,GACxC,MAAQA,GAAIT,KAAKD,OAAOqD,IAAII,WAAcxD,KAAKD,OAAOqD,IAAIE,SAE9DgpB,EAAgBzrB,UAAUwtB,YAAc,SAAUtpB,GAG9C,IAAK,GAFDhF,GAASC,KAAKD,OAET2I,EAAI,EAAGA,EAAI3I,EAAOiH,gBAAiB0B,IAAK,CAC7C3I,EAAO8I,OAAS7E,YAAWjE,EAAOkH,UAAUyB,GAAGG,WAC/C7I,KAAKgtB,aAAe,CAEpB,KAAK,GADD/nB,GAAMlF,EAAO8I,OAAO1D,OACf2D,EAAI,EAAGA,EAAI7D,EAAK6D,IACrB/I,EAAO8I,OAAOC,GAAGtI,EAAIR,KAAKi0B,MAAMl0B,EAAO8I,OAAOC,GAAGH,QACjD5I,EAAO8I,OAAOC,GAAGrI,EAAIT,KAAKk0B,MAAMn0B,EAAO8I,OAAOC,GAAGF,QAIzD5I,KAAKguB,kBACD/rB,oBAAkB8C,IAClB/E,KAAK4tB,eAAe5tB,KAAKqC,aAAc,OAG/CiqB,EAAgBzrB,UAAUmtB,gBAAkB,WAExC,IAAK,GADDjuB,GAASC,KAAKD,OACT2I,EAAI,EAAGA,EAAI3I,EAAOiH,gBAAiB0B,IACxC,GAAI1I,KAAKoJ,aAAaV,GAAI,CACtB1I,KAAKktB,UAAYlpB,YAAWhE,KAAKoJ,aAAaV,GAAGG,WACjD7I,KAAKgtB,aAAe,CAEpB,KAAK,GADD/nB,GAAMjF,KAAKktB,UAAU/nB,OAChB2D,EAAI,EAAGA,EAAI7D,EAAK6D,IACrB9I,KAAKktB,UAAUpkB,GAAGtI,EAAIR,KAAKi0B,MAAMj0B,KAAKktB,UAAUpkB,GAAGH,QACnD3I,KAAKktB,UAAUpkB,GAAGrI,EAAIT,KAAKk0B,MAAMl0B,KAAKktB,UAAUpkB,GAAGF,UAKnE0jB,EAAgBzrB,UAAUotB,cAAgB,WAGtC,IAAK,GAFDluB,GAASC,KAAKD,OAET2I,EAAI,EAAGA,EAAI3I,EAAOiH,gBAAiB0B,IAAK,CAC7C3I,EAAO8I,OAAS7E,YAAWjE,EAAOkH,UAAUyB,GAAGG,WAC/C7I,KAAKgtB,aAAe,CAEpB,KAAK,GADD/nB,GAAMlF,EAAO8I,OAAO1D,OACf2D,EAAI,EAAGA,EAAI7D,EAAK6D,IACrB/I,EAAO8I,OAAOC,GAAGrI,EAAIV,EAAOqD,IAAIE,QAAWvD,EAAOqD,IAAII,WAAazD,EAAO8I,OAAOC,GAAGH,OACpF5I,EAAO8I,OAAOC,GAAGtI,EAAKT,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,UAAcxD,EAAOqD,IAAIG,UAC5ExD,EAAO8I,OAAOC,GAAGF,OACrB7I,EAAO8I,OAAOC,GAAGH,QAAU5I,EAAO8I,OAAOC,GAAGtI,EAAIT,EAAOqD,IAAIC,UAAYtD,EAAOqD,IAAIG,UAClFxD,EAAO8I,OAAOC,GAAGF,QAAU7I,EAAO8I,OAAOC,GAAGrI,EAAIV,EAAOqD,IAAIE,SAAWvD,EAAOqD,IAAII,WAIzF,IAASkF,EAAI,EAAGA,EAAI3I,EAAOiH,gBAAiB0B,IACxC,GAAI1I,KAAKoJ,aAAaV,GAAI,CACtB1I,KAAKktB,UAAYlpB,YAAWhE,KAAKoJ,aAAaV,GAAGG,WACjD7I,KAAKgtB,aAAe,CAEpB,KAAK,GADD/nB,GAAMjF,KAAKktB,UAAU/nB,OAChB2D,EAAI,EAAGA,EAAI7D,EAAK6D,IACrB9I,KAAKktB,UAAUpkB,GAAGrI,EAAIV,EAAOqD,IAAIE,QAAWvD,EAAOqD,IAAII,WAAaxD,KAAKktB,UAAUpkB,GAAGH,OACtF3I,KAAKktB,UAAUpkB,GAAGtI,EAAKT,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,UAAcxD,EAAOqD,IAAIG,UAC7EvD,KAAKktB,UAAUpkB,GAAGF,OACtB5I,KAAKktB,UAAUpkB,GAAGH,QAAU3I,KAAKktB,UAAUpkB,GAAGtI,EAAIT,EAAOqD,IAAIC,UAAYtD,EAAOqD,IAAIG,UACpFvD,KAAKktB,UAAUpkB,GAAGF,QAAU5I,KAAKktB,UAAUpkB,GAAGrI,EAAIV,EAAOqD,IAAIE,SAAWvD,EAAOqD,IAAII,WAI/FxD,KAAKguB,mBAET1B,EAAgBzrB,UAAUqtB,YAAc,SAAU1sB,GAC9C,GAAI2yB,GAAiB3yB,EAAMoR,aAC3B,IAAuB,eAAnBuhB,EACAn0B,KAAKo0B,2BAEJ,IAAuB,aAAnBD,EACLn0B,KAAKq0B,yBAEJ,CACDr0B,KAAKo0B,sBACL,KAAK,GAAIpvB,GAAI,EAAGA,EAAIhF,KAAKD,OAAOiH,gBAAiBhC,IAC7ChF,KAAKD,OAAOkH,UAAUjC,GAAG+B,UAAY,EAEzC/G,MAAKq0B,uBAGb/H,EAAgBzrB,UAAUuzB,qBAAuB,WAG7C,IAAK,GAFDr0B,GAASC,KAAKD,OAET2I,EAAI,EAAGA,EAAI3I,EAAOiH,gBAAiB0B,IACxC,GAAI3I,EAAOkH,UAAUyB,GAAG3B,YAAchH,EAAOiD,UAAUU,cAAe,CAClE3D,EAAO8I,OAAS7E,YAAWjE,EAAOkH,UAAUyB,GAAGG,WAC/C7I,KAAKgtB,aAAe,CAEpB,KAAK,GADD/nB,GAAMlF,EAAO8I,OAAO1D,OACf2D,EAAI,EAAGA,EAAI7D,EAAK6D,IACjB/I,EAAO8I,OAAOC,GAAGtI,GAAKT,EAAOqD,IAAIC,SAAYtD,EAAOqD,IAAIG,UAAY,EACpExD,EAAO8I,OAAOC,GAAGtI,EAAKT,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,WAAcxD,EAAO8I,OAAOC,GAAGtI,EAChFT,EAAOqD,IAAIC,UAEZtD,EAAO8I,OAAOC,GAAGtI,GAAKT,EAAOqD,IAAIC,SAAYtD,EAAOqD,IAAIG,UAAY,IACzExD,EAAO8I,OAAOC,GAAGtI,EAAIT,EAAOqD,IAAIC,UAAYtD,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,UACzExD,EAAO8I,OAAOC,GAAGtI,IAEzBT,EAAO8I,OAAOC,GAAGH,QAAU5I,EAAO8I,OAAOC,GAAGtI,EAAIT,EAAOqD,IAAIC,UAAYtD,EAAOqD,IAAIG,UAClFxD,EAAO8I,OAAOC,GAAGF,QAAU7I,EAAO8I,OAAOC,GAAGrI,EAAIV,EAAOqD,IAAIE,SAAWvD,EAAOqD,IAAII,UAErFzD,GAAOkH,UAAUyB,GAAG3B,UAAYhH,EAAOiD,UAAUU,cAIzD,IAASgF,EAAI,EAAGA,EAAI3I,EAAOiH,gBAAiB0B,IACxC,GAAI1I,KAAKoJ,aAAaV,IACd1I,KAAKoJ,aAAaV,GAAG3B,YAAchH,EAAOiD,UAAUU,cAAe,CACnE1D,KAAKktB,UAAYlpB,YAAWhE,KAAKoJ,aAAaV,GAAGG,WACjD7I,KAAKgtB,aAAe,CAEpB,KAAK,GADD/nB,GAAMjF,KAAKktB,UAAU/nB,OAChB2D,EAAI,EAAGA,EAAI7D,EAAK6D,IACjB9I,KAAKktB,UAAUpkB,GAAGtI,GAAKT,EAAOqD,IAAIC,SAAYtD,EAAOqD,IAAIG,UAAY,EACrEvD,KAAKktB,UAAUpkB,GAAGtI,EAAKT,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,WAAcvD,KAAKktB,UAAUpkB,GAAGtI,EACpFT,EAAOqD,IAAIC,UAEVrD,KAAKktB,UAAUpkB,GAAGtI,GAAKT,EAAOqD,IAAIC,SAAYtD,EAAOqD,IAAIG,UAAY,IAC1EvD,KAAKktB,UAAUpkB,GAAGtI,EAAIT,EAAOqD,IAAIC,UAAYtD,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,UAC1EvD,KAAKktB,UAAUpkB,GAAGtI,IAE1BR,KAAKktB,UAAUpkB,GAAGH,QAAU3I,KAAKktB,UAAUpkB,GAAGtI,EAAIT,EAAOqD,IAAIC,UAAYtD,EAAOqD,IAAIG,UACpFvD,KAAKktB,UAAUpkB,GAAGF,QAAU5I,KAAKktB,UAAUpkB,GAAGrI,EAAIV,EAAOqD,IAAIE,SAAWvD,EAAOqD,IAAII,WAKnGxD,KAAKguB,mBAET1B,EAAgBzrB,UAAUwzB,mBAAqB,WAG3C,IAAK,GAFDt0B,GAASC,KAAKD,OAET2I,EAAI,EAAGA,EAAI3I,EAAOiH,gBAAiB0B,IACxC,GAAI3I,EAAOkH,UAAUyB,GAAG3B,YAAchH,EAAOiD,UAAUU,cAAe,CAClE3D,EAAO8I,OAAS7E,YAAWjE,EAAOkH,UAAUyB,GAAGG,WAC/C7I,KAAKgtB,aAAe,CAEpB,KAAK,GADD/nB,GAAMlF,EAAO8I,OAAO1D,OACf2D,EAAI,EAAGA,EAAI7D,EAAK6D,IACjB/I,EAAO8I,OAAOC,GAAGrI,GAAKV,EAAOqD,IAAIE,QAAWvD,EAAOqD,IAAII,WAAa,EACpEzD,EAAO8I,OAAOC,GAAGrI,EAAKV,EAAOqD,IAAIE,QAAUvD,EAAOqD,IAAII,YACjDzD,EAAO8I,OAAOC,GAAGrI,EAAIV,EAAOqD,IAAIE,SAEhCvD,EAAO8I,OAAOC,GAAGrI,GAAKV,EAAOqD,IAAIE,QAAWvD,EAAOqD,IAAII,WAAa,IACzEzD,EAAO8I,OAAOC,GAAGrI,EAAIV,EAAOqD,IAAIE,SAAWvD,EAAOqD,IAAIE,QAAUvD,EAAOqD,IAAII,WACvEzD,EAAO8I,OAAOC,GAAGrI,IAEzBV,EAAO8I,OAAOC,GAAGH,QAAU5I,EAAO8I,OAAOC,GAAGtI,EAAIT,EAAOqD,IAAIC,UAAYtD,EAAOqD,IAAIG,UAClFxD,EAAO8I,OAAOC,GAAGF,QAAU7I,EAAO8I,OAAOC,GAAGrI,EAAIV,EAAOqD,IAAIE,SAAWvD,EAAOqD,IAAII,UAErFzD,GAAOkH,UAAUyB,GAAG3B,UAAYhH,EAAOiD,UAAUU,cAIzD,IAASgF,EAAI,EAAGA,EAAI3I,EAAOiH,gBAAiB0B,IACxC,GAAI1I,KAAKoJ,aAAaV,IACd1I,KAAKoJ,aAAaV,GAAG3B,YAAchH,EAAOiD,UAAUU,cAAe,CACnE1D,KAAKktB,UAAYlpB,YAAWhE,KAAKoJ,aAAaV,GAAGG,WACjD7I,KAAKgtB,aAAe,CAEpB,KAAK,GADD/nB,GAAMjF,KAAKktB,UAAU/nB,OAChB2D,EAAI,EAAGA,EAAI7D,EAAK6D,IACjB9I,KAAKktB,UAAUpkB,GAAGrI,GAAKV,EAAOqD,IAAIE,QAAWvD,EAAOqD,IAAII,WAAa,EACrExD,KAAKktB,UAAUpkB,GAAGrI,EAAKV,EAAOqD,IAAIE,QAAUvD,EAAOqD,IAAII,YAAexD,KAAKktB,UAAUpkB,GAAGrI,EACpFV,EAAOqD,IAAIE,SAEVtD,KAAKktB,UAAUpkB,GAAGrI,GAAKV,EAAOqD,IAAIE,QAAWvD,EAAOqD,IAAII,WAAa,IAC1ExD,KAAKktB,UAAUpkB,GAAGrI,EAAIV,EAAOqD,IAAIE,SAAWvD,EAAOqD,IAAIE,QAAUvD,EAAOqD,IAAII,WACxExD,KAAKktB,UAAUpkB,GAAGrI,IAE1BT,KAAKktB,UAAUpkB,GAAGH,QAAU3I,KAAKktB,UAAUpkB,GAAGtI,EAAIT,EAAOqD,IAAIC,UAAYtD,EAAOqD,IAAIG,UACpFvD,KAAKktB,UAAUpkB,GAAGF,QAAU5I,KAAKktB,UAAUpkB,GAAGrI,EAAIV,EAAOqD,IAAIE,SAAWvD,EAAOqD,IAAII,WAKnGxD,KAAKguB,mBAET1B,EAAgBzrB,UAAUutB,cAAgB,WAEtC,IAAK,GADDruB,GAASC,KAAKD,OACTiF,EAAI,EAAGA,EAAIjF,EAAOmF,QAAQC,OAAQH,IAAK,CAO5C,GANAjF,EAAOmF,QAAQF,GAAG8C,YAAe3H,QAAUJ,EAAOmF,QAAQF,GAAGnC,YAAY1C,OAASJ,EAAOqD,IAAIC,UACrFtD,EAAOqD,IAAIG,UAAYnD,QAAUL,EAAOmF,QAAQF,GAAGnC,YAAYzC,OAASL,EAAOqD,IAAIE,SAAWvD,EAAOqD,IAAII,WAC7GuE,MAAQhI,EAAOmF,QAAQF,GAAGnC,YAAYkF,KAAOhI,EAAOqD,IAAIC,UAAYtD,EAAOqD,IAAIG,UAC/EyE,MAAQjI,EAAOmF,QAAQF,GAAGnC,YAAYmF,KAAOjI,EAAOqD,IAAIE,SAAWvD,EAAOqD,IAAII,WAC9EnD,MAAON,EAAOqD,IAAIG,UAAYxD,EAAOmF,QAAQF,GAAGnC,YAAYxC,MAAOC,OAAQP,EAAOqD,IAAII,WAClFzD,EAAOmF,QAAQF,GAAGnC,YAAYvC,QACN,SAA5BP,EAAOmF,QAAQF,GAAGI,MAClB,IAAK,GAAIsV,GAAI,EAAGA,EAAI3a,EAAOmF,QAAQF,GAAGiC,UAAU9B,OAAQuV,IACpD3a,EAAOmF,QAAQF,GAAGiC,UAAUyT,GAAG/R,QAC1B5I,EAAOmF,QAAQF,GAAGiC,UAAUyT,GAAGla,EAAIT,EAAOqD,IAAIC,UAAYtD,EAAOqD,IAAIG,UAC1ExD,EAAOmF,QAAQF,GAAGiC,UAAUyT,GAAG9R,QAC1B7I,EAAOmF,QAAQF,GAAGiC,UAAUyT,GAAGja,EAAIV,EAAOqD,IAAIE,SAAWvD,EAAOqD,IAAII,UAGjFzD,GAAO+C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,IAEzE,IAAS2F,EAAI,EAAGA,EAAI3I,EAAOiH,gBAAiB0B,IAAK,CAC7C3I,EAAO8I,OAAS7E,YAAWjE,EAAOkH,UAAUyB,GAAGG,WAC/C7I,KAAKgtB,aAAe,CAEpB,KAAK,GADD/nB,GAAMlF,EAAO8I,OAAO1D,OACf2D,EAAI,EAAGA,EAAI7D,EAAK6D,IACrB/I,EAAO8I,OAAOC,GAAGH,QAAU5I,EAAO8I,OAAOC,GAAGtI,EAAIT,EAAOqD,IAAIC,UAAYtD,EAAOqD,IAAIG,UAClFxD,EAAO8I,OAAOC,GAAGF,QAAU7I,EAAO8I,OAAOC,GAAGrI,EAAIV,EAAOqD,IAAIE,SAAWvD,EAAOqD,IAAII,WAGzF,IAAK,GAAIkF,GAAI,EAAGA,EAAI3I,EAAOiH,gBAAiB0B,IACxC,GAAI1I,KAAKoJ,aAAaV,GAAI,CACtB1I,KAAKktB,UAAYlpB,YAAWhE,KAAKoJ,aAAaV,GAAGG,WACjD7I,KAAKgtB,aAAe,CAEpB,KAAK,GADD/nB,GAAMjF,KAAKktB,UAAU/nB,OAChB2D,EAAI,EAAGA,EAAI7D,EAAK6D,IACrB9I,KAAKktB,UAAUpkB,GAAGH,QAAU3I,KAAKktB,UAAUpkB,GAAGtI,EAAIT,EAAOqD,IAAIC,UAAYtD,EAAOqD,IAAIG,UACpFvD,KAAKktB,UAAUpkB,GAAGF,QAAU5I,KAAKktB,UAAUpkB,GAAGrI,EAAIV,EAAOqD,IAAIE,SAAWvD,EAAOqD,IAAII,aAKnG8oB,EAAgBzrB,UAAUstB,WAAa,SAAUjkB,EAAOC,EAAOmB,GAG3D,IAAK,GAFDvL,GAASC,KAAKD,OAET2I,EAAI,EAAGA,EAAI3I,EAAOiH,gBAAiB0B,IAAK,CAC7C3I,EAAO8I,OAAS7E,YAAWjE,EAAOkH,UAAUyB,GAAGG,WAC/C7I,KAAKgtB,aAAe,CAEpB,KAAK,GADD/nB,GAAMlF,EAAO8I,OAAO1D,OACf2D,EAAI,EAAGA,EAAI7D,EAAK6D,IACH,KAAdwC,GAAkC,aAAdA,EACpBvL,EAAO8I,OAAOC,GAAGtI,GAAK0J,EAGtBnK,EAAO8I,OAAOC,GAAGtI,GAAK0J,EAER,KAAdoB,GAAkC,eAAdA,EACpBvL,EAAO8I,OAAOC,GAAGrI,GAAK0J,EAGtBpK,EAAO8I,OAAOC,GAAGrI,GAAK0J,EAKlC,IAASzB,EAAI,EAAGA,EAAI3I,EAAOiH,gBAAiB0B,IACxC,GAAI1I,KAAKoJ,aAAaV,GAAI,CACtB1I,KAAKktB,UAAYlpB,YAAWhE,KAAKoJ,aAAaV,GAAGG,WACjD7I,KAAKgtB,aAAe,CAEpB,KAAK,GADD/nB,GAAMjF,KAAKktB,UAAU/nB,OAChB2D,EAAI,EAAGA,EAAI7D,EAAK6D,IACH,KAAdwC,GAAkC,aAAdA,EACpBtL,KAAKktB,UAAUpkB,GAAGtI,GAAK0J,EAGvBlK,KAAKktB,UAAUpkB,GAAGtI,GAAK0J,EAET,KAAdoB,GAAkC,eAAdA,EACpBtL,KAAKktB,UAAUpkB,GAAGrI,GAAK0J,EAGvBnK,KAAKktB,UAAUpkB,GAAGrI,GAAK0J,EAKvCnK,KAAK4tB,eAAe5tB,KAAKqC,aAAc,OAE3CiqB,EAAgBzrB,UAAU0tB,aAAe,SAAU/sB,GAC/C,GAAIzB,GAASC,KAAKD,MAClB,IAAIyB,EAAO,CAOP,GANAzB,EAAO8I,UACP7I,KAAKmtB,eACLptB,EAAO+C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,IACrEhD,EAAOse,WAAY,EACnBte,EAAOwC,YAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS,YAClD9d,EAAOwC,YAAYsZ,MAAMG,QAAU,QAC/B/Z,oBAAkBlC,EAAO6C,UAAUmQ,gBAAiB,CACpD,GAAI9O,IAAQ8O,kBACZhT,GAAO+C,OAAO,SAAWxB,KAAM,oBAAqByB,kBAAkB,EAClEvB,OAASyC,IAAKA,KAClBlE,EAAO6C,UAAUmQ,eAAiB9O,EAAoB,eAEtDhC,oBAAkBlC,EAAO6C,UAAUmQ,eAAe9D,eAClDlP,EAAO6C,UAAUmQ,eAAe9D,YAAc,GAE7C/C,aAKDnM,EAAO+N,cAAc/N,EAAOgO,QAAS,OAJrChO,EAAO+C,OAAO,WAAaxB,KAAM,kBAAmByB,kBAAkB,EAAOvB,OAASmF,KAAM,MACpF8C,WAAY,KAAMC,WAAY,KAAMC,UAAW,KAAMC,MAAO,YAOxE7J,GAAOwC,YAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS,UAClD9d,EAAO+C,OAAO,SAAWxB,KAAM,QAASyB,kBAAkB,EAAOvB,OAAS4D,MAAO,KAAMnB,IAAK,KAAMoB,OAAQ,QACrG6G,aAKDnM,EAAO+N,cAAc/N,EAAOgO,QAAS,gBAJrChO,EAAO+C,OAAO,WAAaxB,KAAM,uBAAwByB,kBAAkB,IAC3EhD,EAAO+C,OAAO,WAAaxB,KAAM,oBAAqBE,OAASmF,KAAM,WAKzE5G,EAAO+C,OAAO,aAAexB,KAAM,4BAA6BE,OAASod,0BAA0B,MAG3G0N,EAAgBzrB,UAAU6sB,SAAW,SAAU2F,EAAOpvB,GAElD,IAAK,GADDqwB,IAAU,EACLtvB,EAAI,EAAGA,EAAIhF,KAAKD,OAAOiH,gBAAiBhC,IAC7C,GAAIhF,KAAKD,OAAOkH,UAAUjC,GAAGgY,IACzByQ,SAASztB,KAAKD,OAAOkH,UAAUjC,GAAGgY,GAAGrQ,MAAM,KAAK,GAAI,IAAM,IAAM0mB,EAAO,CACvEiB,GAAU,CACV,OAMR,MAHIrwB,KACAA,EAAa,QAAIqwB,GAEdA,GAEXhI,EAAgBzrB,UAAU8tB,oBAAsB,WAE5C,IAAK,GADD5uB,GAASC,KAAKD,OACT2I,EAAI,EAAGA,EAAI3I,EAAOiH,gBAAiB0B,IAAK,CAC7C,GAAIzE,IAAQmF,aAAcpF,YAAWhE,KAAKoJ,cAC1C,IAAInF,EAAkB,aAAEyE,GAAI,CACxB1I,KAAKktB,UAAYlpB,YAAWC,EAAkB,aAAEyE,GAAGG,WACnD7I,KAAKgtB,aAAe,CAEpB,KAAK,GADD/nB,GAAMjF,KAAKktB,UAAU/nB,OAChB2D,EAAI,EAAGA,EAAI7D,EAAK6D,IACrB9I,KAAKktB,UAAUpkB,GAAGH,QAAU3I,KAAKktB,UAAUpkB,GAAGtI,EAC1CT,EAAO6C,UAAUC,YAAY1C,QAAUJ,EAAO6C,UAAUC,YAAYxC,MACxEL,KAAKktB,UAAUpkB,GAAGF,QAAU5I,KAAKktB,UAAUpkB,GAAGrI,EAC1CV,EAAO6C,UAAUC,YAAYzC,QAAUL,EAAO6C,UAAUC,YAAYvC,UAKjFgsB,KCliCPiI,EAA2B,WAC3B,QAASA,GAAUx0B,GACfC,KAAKw0B,WAAch0B,EAAG,EAAGC,EAAG,GAC5BT,KAAKy0B,YACLz0B,KAAK00B,SAAU,EACf10B,KAAK20B,eAAgB,EACrB30B,KAAK40B,YAAa,EAClB50B,KAAK60B,WAAc10B,OAAQ,EAAGC,OAAQ,EAAG2H,KAAM,EAAGC,KAAM,GACxDhI,KAAK80B,iBAAkB,EACvB90B,KAAKshB,eAAkBze,aAAe1C,OAAQ,EAAGC,OAAQ,EAAG2H,KAAM,EAAGC,KAAM,EAAG3H,MAAO,EAAGC,OAAQ,GAC5FyX,eAAiBgd,YAAcC,kBACnCh1B,KAAKi1B,aAAc,EACnBj1B,KAAKk1B,gBACLl1B,KAAKm1B,eACLn1B,KAAKo1B,gBAAmB50B,EAAG,EAAGC,EAAG,GACjCT,KAAKq1B,eAAiB,GACtBr1B,KAAKs1B,mBAAoB,EACzBt1B,KAAKu1B,YAAc,GACnBv1B,KAAKw1B,QAAU,EACfx1B,KAAKy1B,gBAAmBj1B,EAAG,EAAGC,EAAG,GACjCT,KAAK01B,eAAkBl1B,EAAG,EAAGC,EAAG,GAChCT,KAAK21B,SAAW,UAChB31B,KAAK41B,qBAAsB,EAC3B51B,KAAK61B,YAAa,EAClB71B,KAAK81B,iBAAkB,EACvB91B,KAAK+1B,iBACL/1B,KAAKg2B,cAAe,EACpBh2B,KAAKi2B,oBAAsB,GAC3Bj2B,KAAKk2B,kBACLl2B,KAAKm2B,UAAY,EACjBn2B,KAAKo2B,eAAiB,GACtBp2B,KAAKD,OAASA,EACdC,KAAKY,mBAg6IT,MA95IA2zB,GAAU1zB,UAAUC,QAAU,WACtBd,KAAKD,OAAOgB,aAGhBf,KAAKgB,uBAETuzB,EAAU1zB,UAAUD,iBAAmB,WACnCZ,KAAKD,OAAOkB,GAAG,YAAajB,KAAKq2B,UAAWr2B,MAC5CA,KAAKD,OAAOkB,GAAG,YAAajB,KAAKc,QAASd,OAE9Cu0B,EAAU1zB,UAAUG,oBAAsB,WACtChB,KAAKD,OAAOoB,IAAI,YAAanB,KAAKq2B,WAClCr2B,KAAKD,OAAOoB,IAAI,YAAanB,KAAKc,UAEtCyzB,EAAU1zB,UAAUw1B,UAAY,SAAUj1B,GACtC,GAAImK,GAAQvL,IAEZ,QADAA,KAAK0Q,yBACGtP,EAAKE,MACT,IAAK,WACDtB,KAAKs2B,iBACL,MACJ,KAAK,YACDt2B,KAAKu2B,UAAUn1B,EAAKI,MAAS,EAAGJ,EAAKI,MAAS,EAC9C,MACJ,KAAK,oBACDxB,KAAKw2B,kBAAkBp1B,EAAKI,MAAS,EAAGJ,EAAKI,MAAS,EAAGJ,EAAKI,MAAuB,gBACrF,MACJ,KAAK,qBACDxB,KAAKy2B,mBAAmBr1B,EAAKI,MAAS,EAAGJ,EAAKI,MAAS,EAAGJ,EAAKI,MAAY,KAC3E,MACJ,KAAK,mBACDxB,KAAK02B,iBAAiBt1B,EAAKI,MAAa,MAAGJ,EAAKI,MAAc,OAC9D,MACJ,KAAK,iBACDxB,KAAK22B,eAAev1B,EAAKI,MAAc,OAAGJ,EAAKI,MAAc,OAC7D,MACJ,KAAK,iBACDxB,KAAKgf,gBACL,MACJ,KAAK,iBACDhf,KAAK42B,eAAex1B,EAAKI,MAAS,EAAGJ,EAAKI,MAAS,EAAGJ,EAAKI,MAAgB,SAAGJ,EAAKI,MAAiB,UACpG,MACJ,KAAK,iBACDxB,KAAK62B,eAAez1B,EAAKI,MAAoB,aAC7C,MACJ,KAAK,MACDxB,KAAK82B,kBACL,MACJ,KAAK,mBACD92B,KAAK+2B,iBAAiB31B,EAAKI,MAAa,MAAGJ,EAAKI,MAAc,OAC9D,MACJ,KAAK,mBACGxB,KAAK00B,SACLsC,WAAW,WACPzrB,EAAMxL,OAAOwC,YAAYD,WAAW,MAAM6B,UAAU,EAAG,EAAGoH,EAAMxL,OAAOwC,YAAYlC,MAAOkL,EAAMxL,OAAOwC,YAAYjC,SACpH,IAEP,MACJ,KAAK,6BACDN,KAAKg2B,aAAeh2B,KAAK40B,YAAa,CACtC,MACJ,KAAK,kBACD50B,KAAK80B,gBAAkB1zB,EAAKI,MAAY,IACxC,MACJ,KAAK,cACDxB,KAAKi3B,YAAY71B,EAAKI,MAAW,IACjC,MACJ,KAAK,2BACDxB,KAAKk3B,0BACL,MACJ,KAAK,wBACDl3B,KAAKm3B,sBAAsB/1B,EAAKI,MAAS,EACzC,MACJ,KAAK,wBACDxB,KAAKo3B,sBAAsBh2B,EAAKI,MAAS,EACzC,MACJ,KAAK,sBACDxB,KAAKq3B,oBAAoBj2B,EAAKI,MAAS,EACvC,MACJ,KAAK,yBACDxB,KAAKs3B,uBAAuBl2B,EAAKI,MAAS,EAC1C,MACJ,KAAK,yBACDxB,KAAKu3B,uBAAuBn2B,EAAKI,MAAS,EAC1C,MACJ,KAAK,uBACDxB,KAAKw3B,qBAAqBp2B,EAAKI,MAAS,EACxC,MACJ,KAAK,oBACDxB,KAAKy3B,kBAAkBr2B,EAAKI,MAAS,EACrC,MACJ,KAAK,sBACDxB,KAAK03B,oBAAoBt2B,EAAKI,MAAS,EACvC,MACJ,KAAK,eACDxB,KAAK23B,aAAav2B,EAAKI,MAAS,EAChC,MACJ,KAAK,cACDw1B,WAAWh3B,KAAK43B,YAAY9T,KAAK9jB,MAAO,EAAGoB,EAAKI,MAAS,EACzD,MACJ,KAAK,aACDxB,KAAK63B,YACL,MACJ,KAAK,0BACD73B,KAAK83B,wBAAwB12B,EAAKI,MAAW,IAC7C,MACJ,KAAK,cACDJ,EAAKI,MAAW,IAAY,SAAIxB,KAAK21B,QACrC,MACJ,KAAK,cACD31B,KAAK21B,SAAWv0B,EAAKI,MAAgB,QACrC,MACJ,KAAK,qBACDxB,KAAK41B,oBAAsBx0B,EAAKI,MAAY,IAC5C,MACJ,KAAK,gBACDxB,KAAK61B,WAAaz0B,EAAKI,MAAY,IACnC,MACJ,KAAK,4BACDxB,KAAK81B,gBAAkB10B,EAAKI,MAAgC,wBAC5D,MACJ,KAAK,mBACDxB,KAAK+1B,cAAcv1B,EAAIY,EAAKI,MAAS,EACrCxB,KAAK+1B,cAAct1B,EAAIW,EAAKI,MAAS,CACrC,MACJ,KAAK,aACDJ,EAAKI,MAAW,IAAW,QAAIxB,KAAK+3B,OACpC,MACJ,KAAK,aACD/3B,KAAK+3B,QAAU32B,EAAKI,MAAe,OACnC,MACJ,KAAK,yBACDJ,EAAKI,MAAW,IAAQ,KAAIxB,KAAKg2B,YACjC,MACJ,KAAK,yBACDh2B,KAAKg2B,aAAe50B,EAAKI,MAAY,IACrC,MACJ,KAAK,gBACDJ,EAAKI,MAAW,IAAW,QAAIxB,KAAKshB,aACpC,MACJ,KAAK,gBACDthB,KAAKshB,cAAgBlgB,EAAKI,MAAW,GACrC,MACJ,KAAK,WACDxB,KAAKoO,SAAShN,EAAKI,MAAS,EAAGJ,EAAKI,MAAS,EAAGJ,EAAKI,MAAU,GAAGJ,EAAKI,MAAU,GAAGJ,EAAKI,MAAU,GAAGJ,EAAKI,MAAU,GACrH,MACJ,KAAK,iBACDxB,KAAKu1B,YAAcn0B,EAAKI,MAAa,KACrC,MACJ,KAAK,iBACDxB,KAAK20B,cAAgBvzB,EAAKI,MAAY,IACtC,MACJ,KAAK,2BACDxB,KAAKg4B,yBAAyB52B,EAAKI,MAAW,IAC9C,MACJ,KAAK,aACDxB,KAAKi4B,WAAW72B,EAAKI,MAAS,EAAGJ,EAAKI,MAAS,EAAGJ,EAAKI,MAAY,KACnE,MACJ,KAAK,sBACDxB,KAAKk4B,qBACL,MACJ,KAAK,eACDl4B,KAAKm4B,aAAa/2B,EAAKI,MAAa,MACpC,MACJ,KAAK,gBACDxB,KAAKo4B,cAAch3B,EAAKI,MAAqB,cAC7C,MACJ,KAAK,WACDxB,KAAKi2B,oBAAsB70B,EAAKI,MAAa,MACjB,SAAxBJ,EAAKI,MAAa,OAClBxB,KAAKD,OAAO6C,UAAUyF,aAAaE,SAAW,IAC9CvI,KAAKD,OAAO6C,UAAUuQ,WAAa,aACnCnT,KAAKD,OAAO+C,OAAO,SAAWxB,KAAM,sBAAuByB,kBAAkB,EACzEvB,OAAS2N,KAAM,KAAMC,WAAY,KAAM7G,SAAU,KAAM8G,KAAM,KAAMC,OAAQ,KAAMP,YAAa,SAErE,SAAxB3N,EAAKI,MAAa,QACvBxB,KAAKD,OAAO6C,UAAUqE,aAE1B,MACJ,KAAK,yBACD7F,EAAKI,MAAW,IAAS,MAAIxB,KAAKi2B,mBAClC,MACJ,KAAK,yBACDj2B,KAAKi2B,oBAAsB70B,EAAKI,MAAa,KAC7C,MACJ,KAAK,wBACDxB,KAAKq4B,sBAAsBj3B,EAAKI,MAAW,IAAGJ,EAAKI,MAAc,OACjE,MACJ,KAAK,iBACDxB,KAAKs4B,eAAel3B,EAAKI,MAAiB,UAAGJ,EAAKI,MAAS,EAAGJ,EAAKI,MAAS,EAAGJ,EAAKI,MAAa,MACjG,MACJ,KAAK,uBACDxB,KAAKu4B,qBAAqBn3B,EAAKI,MAAiB,UAAGJ,EAAKI,MAAS,EAAGJ,EAAKI,MAAS,EAAGJ,EAAKI,MAAa,MACvG,MACJ,KAAK,qBACDxB,KAAKw4B,mBAAmBp3B,EAAKI,MAAiB,UAAGJ,EAAKI,MAAS,EAAGJ,EAAKI,MAAS,EAAGJ,EAAKI,MAAa,MACrG,MACJ,KAAK,oBACDxB,KAAKo2B,eAAiBh1B,EAAKI,MAAa,KACxC,MACJ,KAAK,QACDxB,KAAKkC,OACL,MACJ,KAAK,cACDlC,KAAKy4B,aACL,MACJ,KAAK,qBACDz4B,KAAK04B,mBAAmBt3B,EAAKI,MAAW,OAIpD+yB,EAAU1zB,UAAUsB,cAAgB,WAChC,MAAO,aAEXoyB,EAAU1zB,UAAU6P,uBAAyB,WACzC,GAAI3Q,GAASC,KAAKD,MACdA,GAAOqC,cACPpC,KAAKqC,aAAetC,EAAOqC,YAAYE,WAAW,OAElDvC,EAAOwC,cACPvC,KAAKwC,aAAezC,EAAOwC,YAAYD,WAAW,QAG1DiyB,EAAU1zB,UAAUqB,MAAQ,WACxBlC,KAAKw0B,WAAch0B,EAAG,EAAGC,EAAG,GAC5BT,KAAKy0B,YACLz0B,KAAK00B,QAAU10B,KAAK20B,cAAgB30B,KAAK40B,WAAa50B,KAAK80B,iBAAkB,EAC7E90B,KAAK60B,WAAc10B,OAAQ,EAAGC,OAAQ,EAAG2H,KAAM,EAAGC,KAAM,GACxDhI,KAAKshB,eAAkBze,aAAe1C,OAAQ,EAAGC,OAAQ,EAAG2H,KAAM,EAAGC,KAAM,EAAG3H,MAAO,EAAGC,OAAQ,GAC5FyX,eAAiBgd,YAAcC,kBACnCh1B,KAAKi1B,aAAc,EACnBj1B,KAAKq1B,eAAiBr1B,KAAKu1B,YAAc,GACzCv1B,KAAKk1B,gBACLl1B,KAAKm1B,eACLn1B,KAAKo1B,gBAAmB50B,EAAG,EAAGC,EAAG,GACjCT,KAAKs1B,mBAAoB,EACzBt1B,KAAK24B,UAAQllB,GACbzT,KAAKqhB,gBAAc5N,GACnBzT,KAAKw1B,QAAU,EACfx1B,KAAKy1B,gBAAmBj1B,EAAG,EAAGC,EAAG,GACjCT,KAAK01B,eAAkBl1B,EAAG,EAAGC,EAAG,GAChCT,KAAK21B,SAAW,UAChB31B,KAAK41B,qBAAsB,EAC3B51B,KAAK61B,YAAa,EAClB71B,KAAK81B,iBAAkB,EACvB91B,KAAK+1B,iBACL/1B,KAAK+3B,QAAU,KACf/3B,KAAKg2B,cAAe,EACpBh2B,KAAK44B,kBAAoB,KACzB54B,KAAKm2B,UAAY,EACjBn2B,KAAKi2B,oBAAsB,GAC3Bj2B,KAAKk2B,kBACLl2B,KAAKo2B,eAAiB,IAE1B7B,EAAU1zB,UAAUi2B,iBAAmB,WACnC,GAA2C,UAAvC92B,KAAKD,OAAO+c,SAASjB,MAAMG,QAAqB,CAChD,GAAI6c,GAAoB74B,KAAK62B,gBAAe,EAC5C72B,MAAKD,OAAO+C,OAAO,SAAWxB,KAAM,eAAgByB,kBAAkB,EAClEvB,OAAShB,EAAG,KAAMC,EAAG,KAAM8a,YAAa,QACxCsd,GACA74B,KAAKD,OAAO+C,OAAO,aAAexB,KAAM,gBAAiBE,OAASmF,KAAM,UAIpF4tB,EAAU1zB,UAAUy1B,gBAAkB,WAClCt2B,KAAKy0B,SAASj0B,MAAIiT,GAClBzT,KAAKy0B,SAASh0B,MAAIgT,IAEtB8gB,EAAU1zB,UAAUi4B,eAAiB,SAAUxvB,EAAQ9I,EAAGC,EAAGyd,EAAiB6a,GAC1E,GAAIzjB,GAAsBtV,KAAKq4B,sBAAsB/uB,GAEjDxF,EAAQi1B,EAAU,EAAoC,EAA9BzvB,EAAOwL,cAAcpK,MAqEjD,OApEIlK,IAAM8I,EAAOwL,cAAc3U,OAAS2D,GACpCtD,GAAM8I,EAAOwL,cAAc3U,OAAS2D,GACpCrD,GAAM6I,EAAOwL,cAAc1U,OAAS0D,GACpCrD,GAAM6I,EAAOwL,cAAc1U,OAAS0D,EAC3B,YAEJtD,GAAM8I,EAAOwL,cAAc3U,OAAS2D,GACzCtD,GAAM8I,EAAO0L,eAAe7U,OAAS2D,GACrCrD,GAAM6I,EAAOyL,gBAAgB3U,OAAS0D,GACtCrD,GAAM6I,EAAOyL,gBAAgB3U,OAAS0D,EAC7B,WAEJtD,GAAM8I,EAAO0L,eAAe7U,OAAS2D,GAC1CtD,GAAM8I,EAAO0L,eAAe7U,OAAS2D,GACrCrD,GAAM6I,EAAO0L,eAAe5U,OAAS0D,GACrCrD,GAAM6I,EAAO0L,eAAe5U,OAAS0D,EAC5B,YAEJtD,GAAM8I,EAAO2L,iBAAiB9U,OAAS2D,GAC5CtD,GAAM8I,EAAO2L,iBAAiB9U,OAAS2D,GACvCrD,GAAM6I,EAAOwL,cAAc1U,OAAS0D,GACpCrD,GAAM6I,EAAO6L,iBAAiB/U,OAAS0D,EAC9B,WAEJtD,GAAM8I,EAAO4L,kBAAkB/U,OAAS2D,GAC7CtD,GAAM8I,EAAO4L,kBAAkB/U,OAAS2D,GACxCrD,GAAM6I,EAAO0L,eAAe5U,OAAS0D,GACrCrD,GAAM6I,EAAO+L,kBAAkBjV,OAAS0D,EAC/B,WAEJtD,GAAM8I,EAAO6L,iBAAiBhV,OAAS2D,GAC5CtD,GAAM8I,EAAO6L,iBAAiBhV,OAAS2D,GACvCrD,GAAM6I,EAAO6L,iBAAiB/U,OAAS0D,GACvCrD,GAAM6I,EAAO6L,iBAAiB/U,OAAS0D,EAC9B,YAEJtD,GAAM8I,EAAO6L,iBAAiBhV,OAAS2D,GAC5CtD,GAAM8I,EAAO+L,kBAAkBlV,OAAS2D,GACxCrD,GAAM6I,EAAO8L,mBAAmBhV,OAAS0D,GACzCrD,GAAM6I,EAAO8L,mBAAmBhV,OAAS0D,EAChC,WAEJtD,GAAM8I,EAAO+L,kBAAkBlV,OAAS2D,GAC7CtD,GAAM8I,EAAO+L,kBAAkBlV,OAAS2D,GACxCrD,GAAM6I,EAAO+L,kBAAkBjV,OAAS0D,GACxCrD,GAAM6I,EAAO+L,kBAAkBjV,OAAS0D,EAC/B,YAEHtD,GAAK8I,EAAOzG,YAAY1C,QAC9BK,GAAK8I,EAAOzG,YAAYkF,MAAUtH,GAAK6I,EAAOzG,YAAYzC,QAC1DK,GAAK6I,EAAOzG,YAAYmF,KACpBkW,EACS,OAGA,OAGR5I,IAAwByjB,GAC7Bv4B,GAAM8U,EAAoB9U,GAAK8I,EAAO8L,mBAAmB1K,OAAS,IAClElK,GAAK8U,EAAoB9U,GAAK8I,EAAO8L,mBAAmB1K,OAAS,IACjEjK,GAAK6U,EAAoB7U,GAAK6I,EAAO8L,mBAAmB1K,OAAS,IACjEjK,GAAK6U,EAAoB7U,GAAK6I,EAAO8L,mBAAmB1K,OAAS,GACxD,WAGA,WAIjB6pB,EAAU1zB,UAAU01B,UAAY,SAAU/1B,EAAGC,GACzC,GAIIiM,GAJA3M,EAASC,KAAKD,OACdqC,EAAc2a,SAASZ,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,gBAC/Dza,EAAcwa,SAASZ,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,gBAC/DkB,GAAkB,CAEtB,IAAiC,KAA7Ble,KAAKi2B,oBAEL,YADA1zB,EAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS,YAG/C,IAAI9d,EAAO0F,YAAYwZ,WAOnB,YANyB,KAArBjf,KAAKu1B,YACLhzB,EAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS,OAG3Ctb,EAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS7d,KAAKu1B,YAIxD,QAAoC9hB,KAAhC1T,EAAO6C,UAAUgK,WAA0B,KACZ6G,KAA3B1T,EAAO6C,UAAUwC,QACjBsH,EAAa3M,EAAO6C,UAAUwC,MAAMuH,MAAM,UAE3B8G,KAAf/G,GAA4B3M,EAAO0F,YAAYC,aAC/CwY,GAAkB,MAEEzK,KAAf/G,GAA8C,SAAlBA,EAAW,KAC5CwR,GAAkB,IAEjBA,GAAmBne,EAAOie,YAC3B5b,EAAYyZ,MAAMgC,OAAStb,EAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS,OAE1E,IAAIA,GAAStb,EAAYsZ,MAAMgC,OAC3BvU,EAAStF,YAAWjE,EAAO6C,cAAe,EAC9C5C,MAAKq1B,eAAiB/rB,EAAOuV,SAC7B,IAAI5b,OAAS,IAETA,EADuB,IAAvBqG,EAAOpB,YACEnI,EAAOiD,UAAUC,OAGjBlD,EAAOiD,UAAUC,OAASqG,EAAOpB,aAEjC,IACTjF,EAAS,IAAMA,GAEE,SAAjBqG,EAAOlE,OAAqC,UAAjBkE,EAAOlE,MAClCpF,KAAKg5B,sBAAsB1vB,EAAQ9I,EAAGC,EAAG8B,GAEnB,SAAjB+G,EAAOlE,MACZpF,KAAKi5B,iBAAiB3vB,EAAQ9I,EAAGC,EAAG8B,GAE9BN,oBAAkBqH,EAAOsK,eAAyC,IAAxBtK,EAAOsK,cAIvDrR,EAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS7d,KAAK84B,eAAexvB,EAAQ9I,EAAGC,EAAGyd,GAAiB,GACxE,SAAjB5U,EAAOlE,OAAwC,aAAlBrF,EAAO8d,QACnB,aAAlB9d,EAAO8d,QAA2C,aAAlB9d,EAAO8d,QACrB,aAAlB9d,EAAO8d,SACPtb,EAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS,SAP/C7d,KAAKk5B,0BAA0B5vB,EAAQ9I,EAAGC,EAAG8B,GAUlC,YAAXsb,GAA0C,YAAlB9d,EAAO8d,QAAwBK,IACvD3b,EAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS,QAEhC,SAAXA,GAAuC,YAAlB9d,EAAO8d,SAC5Btb,EAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS,YAG1C9d,GAAOie,YAAcje,EAAOse,UACjCjc,EAAYyZ,MAAMgC,OAAStb,EAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS,OAGlE9d,EAAO0F,YAAYC,cAAgB3F,EAAOse,UAC1C9b,EAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS,YAG3Ctb,EAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS,SAGnD,IAAsB,YAAlB9d,EAAO8d,QAA0C,SAAlB9d,EAAO8d,OAAmB,CACrDA,EAAStb,EAAYsZ,MAAMgC,MAC3B9d,GAAOmF,QAAQC,OAAS,IAAwB,SAAlBpF,EAAO8d,SAAsBK,IAC3Dle,KAAKm5B,iBAAiB34B,EAAGC,EAAGV,EAAOmF,QAAS3C,EAAa2b,GAE9C,SAAXL,GAAuC,YAAlB9d,EAAO8d,SAC5Btb,EAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS,QAG5B,YAAlB9d,EAAO8d,QAA0C,SAAlB9d,EAAO8d,SACpC9d,EAAOkH,UAAU,IAAyB,SAAlBlH,EAAO8d,QAAsBK,GACpDne,EAAO0F,YAAYwZ,YAAelf,EAAO0F,YAAY2zB,UACzDp5B,KAAKq5B,4BAA4B74B,EAAGC,EAAG8B,IAG/CgyB,EAAU1zB,UAAUo4B,iBAAmB,SAAU3vB,EAAQ9I,EAAGC,EAAG8B,GAC3DvC,KAAKg5B,sBAAsB1vB,EAAQ9I,EAAGC,EAAG8B,EACzC,IAAIxC,GAASC,KAAKD,MAClB,IAAsB,YAAlBA,EAAO8d,OAGP,IAAK,GAFD5Z,GAAMD,YAAWsF,EAAQ,MAAM,GAC/BgwB,GAAS,EACJt0B,EAAI,EAAGA,EAAIsE,EAAOrC,UAAU9B,SAC7Bm0B,EADqCt0B,IAAK,CAI9Cf,EAAIpB,YAAY1C,OAASmJ,EAAOrC,UAAUjC,EAAI,GAAGxE,EACjDyD,EAAIpB,YAAYzC,OAASkJ,EAAOrC,UAAUjC,EAAI,GAAGvE,EACjDwD,EAAIpB,YAAYkF,KAAOuB,EAAOrC,UAAUjC,GAAGxE,EAC3CyD,EAAIpB,YAAYmF,KAAOsB,EAAOrC,UAAUjC,GAAGvE,EAC3CV,EAAO+C,OAAO,SAAWxB,KAAM,2BAA4ByB,kBAAkB,EACzEvB,OAASyC,IAAKA,IAClB,KAAK,GAAIyW,GAAI,EAAGA,EAAIzW,EAAIgD,UAAU9B,OAAQuV,IAAK,CAC3C,GAAIvX,GAAQc,EAAIgD,UAAUyT,EAC1B,KAAKzY,oBAAkBkB,EAAM3C,EAAmC,EAA9B8I,EAAOwL,cAAcpK,UAClDzI,oBAAkBkB,EAAM3C,EAAmC,EAA9B8I,EAAOwL,cAAcpK,UAClDzI,oBAAkBkB,EAAM1C,EAAmC,EAA9B6I,EAAOwL,cAAcpK,UAClDzI,oBAAkBkB,EAAM1C,EAAmC,EAA9B6I,EAAOwL,cAAcpK,SACnDlK,GAAM2C,EAAM3C,EAAmC,EAA9B8I,EAAOwL,cAAcpK,QACtClK,GAAM2C,EAAM3C,EAAmC,EAA9B8I,EAAOwL,cAAcpK,QACtCjK,GAAM0C,EAAM1C,EAAmC,EAA9B6I,EAAOwL,cAAcpK,QACtCjK,GAAM0C,EAAM1C,EAAmC,EAA9B6I,EAAOwL,cAAcpK,OAAc,CACpDnI,EAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS,OAC3Cyb,GAAS,CACT,OAGA/2B,EAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS,WAK3D,MAAO9d,GAAO8d,QAElB0W,EAAU1zB,UAAUm4B,sBAAwB,SAAU1vB,EAAQ9I,EAAGC,EAAG8B,GAEhE,IAAK,GADD8wB,GACKruB,EAAI,EAAGA,EAAIsE,EAAOrC,UAAU9B,OAAQH,IAAK,CAC9C,GAAI7B,GAAQmG,EAAOrC,UAAUjC,EAC7B,IAAIxE,GAAM2C,EAAM3C,EAAmC,EAA9B8I,EAAOwL,cAAcpK,QAAgBlK,GAAM2C,EAAM3C,EAAmC,EAA9B8I,EAAOwL,cAAcpK,QAC5FjK,GAAM0C,EAAM1C,EAAmC,EAA9B6I,EAAOwL,cAAcpK,QAAgBjK,GAAM0C,EAAM1C,EAAmC,EAA9B6I,EAAOwL,cAAcpK,OAAc,CAC1GnI,EAAYsZ,MAAMgC,OAAS7d,KAAKD,OAAO8d,OAAS,OAChDwV,EAAQruB,CACR,OAGAzC,EAAYsZ,MAAMgC,OAAS7d,KAAKD,OAAO8d,OAAS,UAGxD,MAAOwV,IAEXkB,EAAU1zB,UAAUq4B,0BAA4B,SAAU5vB,EAAQ9I,EAAGC,EAAG8B,GACpEvC,KAAKo2B,eAAiB,EACtB,IAAIr2B,GAASC,KAAKD,MAuElB,IAtEIS,GAAM8I,EAAOiwB,oBAAoB,GAAG/4B,GAAK8I,EAAO8L,mBAAmB1K,OAAS,IAC5ElK,GAAM8I,EAAOiwB,oBAAoB,GAAG/4B,GAAK8I,EAAO8L,mBAAmB1K,OAAS,IAC5EjK,GAAM6I,EAAOiwB,oBAAoB,GAAG94B,GAAK6I,EAAO8L,mBAAmB1K,OAAS,IAC5EjK,GAAM6I,EAAOiwB,oBAAoB,GAAG94B,GAAK6I,EAAO8L,mBAAmB1K,OAAS,GAC5EnI,EAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS,YAEtCrd,GAAM8I,EAAOiwB,oBAAoBpxB,KAAK2jB,MAAMxiB,EAAOiwB,oBAAoBp0B,OAAS,IAAI3E,EAAI,GAC7FA,GAAM8I,EAAOiwB,oBAAoBpxB,KAAK2jB,MAAMxiB,EAAOiwB,oBAAoBp0B,OAAS,IAAI3E,EAAI,GACxFC,GAAM6I,EAAOiwB,oBAAoBpxB,KAAK2jB,MAAMxiB,EAAOiwB,oBAAoBp0B,OAAS,IAAI1E,EAAI,GACxFA,GAAM6I,EAAOiwB,oBAAoBpxB,KAAK2jB,MAAMxiB,EAAOiwB,oBAAoBp0B,OAAS,IAAI1E,EAAI,EACxF8B,EAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS7d,KAAKo2B,eAAiB,WAE5D51B,GAAM8I,EAAOiwB,oBAAoBpxB,KAAK2jB,MAAMxiB,EAAOiwB,oBAAoBp0B,OAAS,IAAI3E,GACxF8I,EAAO8L,mBAAmB1K,OAAS,IACpClK,GAAM8I,EAAOiwB,oBAAoBpxB,KAAK2jB,MAAMxiB,EAAOiwB,oBAAoBp0B,OAAS,IAAI3E,GAC/E8I,EAAO8L,mBAAmB1K,OAAS,IACxCjK,GAAM6I,EAAOiwB,oBAAoBpxB,KAAK2jB,MAAMxiB,EAAOiwB,oBAAoBp0B,OAAS,IAAI1E,GAC/E6I,EAAO8L,mBAAmB1K,OAAS,IACxCjK,GAAM6I,EAAOiwB,oBAAoBpxB,KAAK2jB,MAAMxiB,EAAOiwB,oBAAoBp0B,OAAS,IAAI1E,GAC/E6I,EAAO8L,mBAAmB1K,OAAS,GACxCnI,EAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS,YAEtCrd,GAAM8I,EAAOkwB,qBAAqBrxB,KAAK2jB,MAAMxiB,EAAOkwB,qBAAqBr0B,OAAS,IAAI3E,EAAI,GAC/FA,GAAM8I,EAAOkwB,qBAAqBrxB,KAAK2jB,MAAMxiB,EAAOkwB,qBAAqBr0B,OAAS,IAAI3E,EAAI,GAC1FC,GAAM6I,EAAOkwB,qBAAqBrxB,KAAK2jB,MAAMxiB,EAAOkwB,qBAAqBr0B,OAAS,IAAI1E,EAAI,GACvFA,GAAM6I,EAAOkwB,qBAAqBrxB,KAAK2jB,MAAMxiB,EAAOkwB,qBAAqBr0B,OAAS,IAAI1E,EAAI,EAC7F8B,EAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS7d,KAAKo2B,eAAiB,WAE5D51B,GAAM8I,EAAOmwB,sBAAsBtxB,KAAK2jB,MAAMxiB,EAAOmwB,sBAAsBt0B,OAAS,IAAI3E,EAAI,GACjGA,GAAM8I,EAAOmwB,sBAAsBtxB,KAAK2jB,MAAMxiB,EAAOmwB,sBAAsBt0B,OAAS,IAAI3E,EAAI,GACzFC,GAAM6I,EAAOmwB,sBAAsBtxB,KAAK2jB,MAAMxiB,EAAOmwB,sBAAsBt0B,OAAS,IAAI1E,EAAI,GAC/FA,GAAM6I,EAAOmwB,sBAAsBtxB,KAAK2jB,MAAMxiB,EAAOmwB,sBAAsBt0B,OAAS,IAAI1E,EAAI,EAC5F8B,EAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS7d,KAAKo2B,eAAiB,WAE5D51B,GAAM8I,EAAOowB,uBAAuB,GAAGl5B,GAAK8I,EAAO8L,mBAAmB1K,OAAS,IACpFlK,GAAM8I,EAAOowB,uBAAuB,GAAGl5B,GAAK8I,EAAO8L,mBAAmB1K,OAAS,IAC/EjK,GAAM6I,EAAOowB,uBAAuB,GAAGj5B,GAAK6I,EAAO8L,mBAAmB1K,OAAS,IAC/EjK,GAAM6I,EAAOowB,uBAAuB,GAAGj5B,GAAK6I,EAAO8L,mBAAmB1K,OAAS,GAC/EnI,EAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS,YAEtCrd,GAAM8I,EAAOowB,uBAAuBvxB,KAAK2jB,MAAMxiB,EAAOowB,uBAAuBv0B,OAAS,IAAI3E,EAAI,GACnGA,GAAM8I,EAAOowB,uBAAuBvxB,KAAK2jB,MAAMxiB,EAAOowB,uBAAuBv0B,OAAS,IAAI3E,EAAI,GAC9FC,GAAM6I,EAAOowB,uBAAuBvxB,KAAK2jB,MAAMxiB,EAAOowB,uBAAuBv0B,OAAS,IAAI1E,EAAI,GAC9FA,GAAM6I,EAAOowB,uBAAuBvxB,KAAK2jB,MAAMxiB,EAAOowB,uBAAuBv0B,OAAS,IAAI1E,EAAI,EAC9F8B,EAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS7d,KAAKo2B,eAAiB,WAE5D51B,GAAM8I,EAAOowB,uBAAuBvxB,KAAK2jB,MAAMxiB,EAAOowB,uBAAuBv0B,OAAS,IAAI3E,GAC9F8I,EAAO8L,mBAAmB1K,OAAS,IACpClK,GAAM8I,EAAOowB,uBAAuBvxB,KAAK2jB,MAAMxiB,EAAOowB,uBAAuBv0B,OAAS,IAAI3E,GACrF8I,EAAO8L,mBAAmB1K,OAAS,IACxCjK,GAAM6I,EAAOowB,uBAAuBvxB,KAAK2jB,MAAMxiB,EAAOowB,uBAAuBv0B,OAAS,IAAI1E,GACrF6I,EAAO8L,mBAAmB1K,OAAS,IACxCjK,GAAM6I,EAAOowB,uBAAuBvxB,KAAK2jB,MAAMxiB,EAAOowB,uBAAuBv0B,OAAS,IAAI1E,GACrF6I,EAAO8L,mBAAmB1K,OAAS,GACxCnI,EAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS,YAEtCvU,EAAOqwB,yBACZn5B,GAAM8I,EAAOqwB,wBAAwBn5B,GAAK8I,EAAO8L,mBAAmB1K,OAAS,IAC7ElK,GAAK8I,EAAOqwB,wBAAwBn5B,GAAK8I,EAAO8L,mBAAmB1K,OAAS,IAC5EjK,GAAK6I,EAAOqwB,wBAAwBl5B,GAAK6I,EAAO8L,mBAAmB1K,OAAS,IAC5EjK,GAAK6I,EAAOqwB,wBAAwBl5B,GAAK6I,EAAO8L,mBAAmB1K,OAAS,GAC5EnI,EAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS,YAG3Ctb,EAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS,UACb7d,KAAK45B,mBAAmBtwB,EAAOzG,YAAY1C,OAAQmJ,EAAOzG,YAAYzC,OAAQkJ,EAAOzG,YAAYxC,MAAOiJ,EAAOzG,YAAYvC,OAAQgJ,EAAOsK,cAAgB,IAAMzL,KAAKyC,IAAKpK,EAAGC,KAEvM8B,EAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS,SAG7B,YAAlB9d,EAAO8d,OACP,IAAK,GAAI7Y,GAAI,EAAGC,EAAMqE,EAAOiwB,oBAAoBp0B,OAAQH,EAAIC,EAAKD,IAC9D,GAAIxE,GAAM8I,EAAOiwB,oBAAoBv0B,GAAGxE,EAAI,GACxCA,GAAM8I,EAAOiwB,oBAAoBv0B,GAAGxE,EAAI,GACxCC,GAAM6I,EAAOiwB,oBAAoBv0B,GAAGvE,EAAI,GACxCA,GAAM6I,EAAOiwB,oBAAoBv0B,GAAGvE,EAAI,EAAI,CAC5C8B,EAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS7d,KAAKo2B,eAAiB,UACjE,OAIZ,GAAsB,YAAlBr2B,EAAO8d,OACP,IAAK,GAAI7Y,GAAI,EAAGC,EAAMqE,EAAOowB,uBAAuBv0B,OAAQH,EAAIC,EAAKD,IACjE,GAAIxE,GAAM8I,EAAOowB,uBAAuB10B,GAAGxE,EAAI,GAC3CA,GAAM8I,EAAOowB,uBAAuB10B,GAAGxE,EAAI,GAC3CC,GAAM6I,EAAOowB,uBAAuB10B,GAAGvE,EAAI,GAC3CA,GAAM6I,EAAOowB,uBAAuB10B,GAAGvE,EAAI,EAAI,CAC/C8B,EAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS7d,KAAKo2B,eAAiB,UACjE,OAIZ,GAAsB,YAAlBr2B,EAAO8d,OACP,IAAK,GAAI7Y,GAAI,EAAGC,EAAMqE,EAAOkwB,qBAAqBr0B,OAAQH,EAAIC,EAAKD,IAC/D,GAAIxE,GAAM8I,EAAOkwB,qBAAqBx0B,GAAGxE,EAAI,GACzCA,GAAM8I,EAAOkwB,qBAAqBx0B,GAAGxE,EAAI,GACzCC,GAAM6I,EAAOkwB,qBAAqBx0B,GAAGvE,EAAI,GACzCA,GAAM6I,EAAOkwB,qBAAqBx0B,GAAGvE,EAAI,EAAI,CAC7C8B,EAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS7d,KAAKo2B,eAAiB,UACjE,OAIZ,GAAsB,YAAlBr2B,EAAO8d,OACP,IAAK,GAAI7Y,GAAI,EAAGC,EAAMqE,EAAOmwB,sBAAsBt0B,OAAQH,EAAIC,EAAKD,IAChE,GAAIxE,GAAM8I,EAAOmwB,sBAAsBz0B,GAAGxE,EAAI,GAC1CA,GAAM8I,EAAOmwB,sBAAsBz0B,GAAGxE,EAAI,GAC1CC,GAAM6I,EAAOmwB,sBAAsBz0B,GAAGvE,EAAI,GAC1CA,GAAM6I,EAAOmwB,sBAAsBz0B,GAAGvE,EAAI,EAAI,CAC9C8B,EAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS7d,KAAKo2B,eAAiB,UACjE,OAKZ,MADAp2B,MAAK65B,kCAAkCvwB,GAChCvJ,EAAO8d,QAElB0W,EAAU1zB,UAAUg5B,kCAAoC,SAAUvwB,GAC9D,GAAIvJ,GAASC,KAAKD,OACdoF,EAASmE,EAAOsK,cAAgB,IAAMzL,KAAKyC,GAE/C,KADAzF,EAASA,EAAS,EAAIgD,KAAK2xB,MAAM30B,GAAUgD,KAAKkqB,KAAKltB,KACtC,IAAMA,GAAU,KAASA,IAAW,KAAOA,IAAW,GAAK,CACtE,GAAI40B,IAAcC,YAAa,YAAaC,WAAY,WACpDC,YAAa,YAAaC,WAAY,WAAYC,WAAY,WAC9DC,YAAa,YAAaC,WAAY,WAAYC,YAAa,YAE/Dx6B,GAAO8d,SAAUkc,KACjBh6B,EAAO8d,OAASkc,EAAUh6B,EAAO8d,SAIzC,MADA9d,GAAOwC,YAAYsZ,MAAMgC,OAAS7d,KAAKw6B,iBAAkBlxB,EAAOsK,cAAgB,IAAMzL,KAAKyC,IAAM7K,EAAO8d,QACjG9d,EAAO8d,QAElB0W,EAAU1zB,UAAU25B,iBAAmB,SAAUv3B,EAAQ8K,GACrD,GAAI0sB,KACY,eAAZ1sB,EACA0sB,IACK,MAAO,KAAM,cAAe,KAAM,KAAM,aAAc,KAAM,MAAO,cACnE,MAAO,MAAO,aAAc,MAAO,MAAO,cAC1C,MAAO,MAAO,aAAc,MAAO,MAAO,cAC1C,MAAO,MAAO,aAGF,aAAZ1sB,EACL0sB,IACK,MAAO,KAAM,aAAc,KAAM,KAAM,cAAe,KAAM,MAAO,aACnE,MAAO,MAAO,cAAe,MAAO,MAAO,aAAc,MAAO,MAAO,cACvE,MAAO,MAAO,aAAc,MAAO,MAAO,cAG9B,cAAZ1sB,EACL0sB,IACK,MAAO,KAAM,cAAe,KAAM,KAAM,aACxC,KAAM,MAAO,cAAe,MAAO,MAAO,aAAc,MAAO,MAAO,cACtE,MAAO,MAAO,aAAc,MAAO,MAAO,cAAe,MAAO,MAAO,aAG3D,aAAZ1sB,EACL0sB,IACK,MAAO,KAAM,aAAc,KAAM,KAAM,cAAe,KAAM,MAAO,aACnE,MAAO,MAAO,cAAe,MAAO,MAAO,aAAc,MAAO,MAAO,cACvE,MAAO,MAAO,aAAc,MAAO,MAAO,cAG9B,cAAZ1sB,EACL0sB,IACK,MAAO,KAAM,cAAe,KAAM,KAAM,aAAc,KAAM,MAAO,cACnE,MAAO,MAAO,aAAc,MAAO,MAAO,cAAe,MAAO,MAAO,aACvE,MAAO,MAAO,cAAe,MAAO,MAAO,aAG/B,aAAZ1sB,EACL0sB,IACK,MAAO,KAAM,aAAc,KAAM,KAAM,cAAe,KAAM,MAAO,aACnE,MAAO,MAAO,cAAe,MAAO,MAAO,aAAc,MAAO,MAAO,cACvE,MAAO,MAAO,aAAc,MAAO,MAAO,cAG9B,cAAZ1sB,EACL0sB,IACK,MAAO,KAAM,cAAe,KAAM,KAAM,aAAc,KAAM,MAAO,cACnE,MAAO,MAAO,aAAc,MAAO,MAAO,cAAe,MAAO,MAAO,aACvE,MAAO,MAAO,cAAe,MAAO,MAAO,aAG/B,aAAZ1sB,IACL0sB,IACK,MAAO,KAAM,aAAc,KAAM,KAAM,cAAe,KAAM,MAAO,aACnE,MAAO,MAAO,cAAe,MAAO,MAAO,aAAc,MAAO,MAAO,cACvE,MAAO,MAAO,aAAc,MAAO,MAAO,cAInD,KAAK,GADDC,GAAiBz3B,EAAS,EAAI,IAAMkF,KAAKC,IAAInF,GAAUA,EAClD03B,EAAK,EAAGC,EAAmBH,EAAgBE,EAAKC,EAAiBz1B,OAAQw1B,IAAM,CACpF,GAAIE,GAAKD,EAAiBD,GAAKG,EAAcD,EAAG,GAAIE,EAAYF,EAAG,GAAIG,EAAgBH,EAAG,EAC1F,IAAKH,EAAiBI,GAAeJ,GAAkBK,GAClDL,EAAiB,IAAMI,GAAeJ,EAAiB,KAAOK,EAC/D,MAAOC,GAGf,MAAOjtB,IAEXwmB,EAAU1zB,UAAUw4B,4BAA8B,SAAU74B,EAAGC,EAAG8B,GAC9D,GAAIC,GAAeD,EAAYD,WAAW,MACtCvC,EAASC,KAAKD,OACd+c,EAAWC,SAASZ,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,aAC5Die,GAAY,CAChBl7B,GAAO+C,OAAO,iBAAmBxB,KAAM,8BAA+ByB,kBAAkB,EACpFvB,OAAS6xB,OAAQ,IAErB,KAAK,GADDJ,GACKvqB,EAAI,EAAGA,EAAI3I,EAAOiH,gBAAiB0B,IAAK,CAC7C,GAAIzE,IAAQmF,gBACZrJ,GAAO+C,OAAO,iBAAmBxB,KAAM,kBAAmByB,kBAAkB,EAAOvB,OAASyC,IAAKA,KACjGgvB,EAAUjvB,YAAWC,EAAkB,aAAEyE,GAAGG,WAC5C9I,EAAO8I,OAAS7E,YAAWjE,EAAOkH,UAAUyB,GAAGG,WAC/C9I,EAAO+C,OAAO,iBAAmBxB,KAAM,kBAAmByB,kBAAkB,EAAOvB,OAASA,MAAO,IAEnG,KAAK,GADDyD,GAAMguB,EAAQ9tB,OACT2D,EAAI,EAAGA,EAAI7D,EAAK6D,IACrB,GAAU,IAANA,EAAS,CACT,GAAIsF,IAAW,CAIf,IAHI6kB,EAAQnqB,EAAI,IAAMmqB,EAAQnqB,KAC1BsF,EAAWpO,KAAKoO,SAAS5N,EAAGC,EAAGwyB,EAAQnqB,EAAI,GAAGtI,EAAGyyB,EAAQnqB,EAAI,GAAGrI,EAAGwyB,EAAQnqB,GAAGtI,EAAGyyB,EAAQnqB,GAAGrI,IAE5F2N,EAAU,CACVpO,KAAK40B,YAAa,EAClB70B,EAAO+C,OAAO,iBAAmBxB,KAAM,8BAA+ByB,kBAAkB,EACpFvB,OAAS6xB,MAAO3qB,KACpB3I,EAAO+C,OAAO,iBAAmBxB,KAAM,WAAYyB,kBAAkB,EACjEvB,OAASuN,YAAa,KAAME,YAAa,QAC7C1M,EAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS,UAC3Cod,GAAY,CACZ,OAEC,IAAKj7B,KAAKg2B,cAAgBj2B,EAAOkH,UAAUyB,GAAG0qB,WAAY,CAO3D,IANIpzB,KAAK40B,YAAc50B,KAAKg2B,gBACxBxzB,EAAa2B,UAAU,EAAG,EAAG5B,EAAYlC,MAAOkC,EAAYjC,QACxDP,EAAO6C,UAAUwC,OAAoC,SAA3B0X,EAASjB,MAAMG,SACzCjc,EAAO+C,OAAO,QAAUxB,KAAM,aAAcyB,kBAAkB,EAAOvB,OAAS6D,OAAQ,YAAapB,IAAKlE,EAAO6C,cAGnH5C,KAAKg2B,aAAc,CACfjnB,EAAchP,EAAOkH,UAAUyB,GAAGqG,WACtChP,GAAO+C,OAAO,iBAAmBxB,KAAM,WAAYyB,kBAAkB,EACjEvB,OAASuN,YAAaA,EAAaE,YAAalP,EAAOkH,UAAUyB,GAAGuG,mBAGxElP,GAAO+C,OAAO,iBAAmBxB,KAAM,8BAA+ByB,kBAAkB,EACpFvB,OAAS6xB,MAAO,OAExBrzB,MAAK40B,YAAa,OAGrB,CACD,GAAIp0B,EAAIT,EAAO8I,OAAOC,GAAGtI,EAAIT,EAAOkH,UAAUyB,GAAGuG,aAC7CzO,EAAIT,EAAO8I,OAAOC,GAAGtI,EAAIT,EAAOkH,UAAUyB,GAAGuG,aAC7CxO,EAAIV,EAAO8I,OAAOC,GAAGrI,EAAIV,EAAOkH,UAAUyB,GAAGuG,aAC7CxO,EAAIV,EAAO8I,OAAOC,GAAGrI,EAAIV,EAAOkH,UAAUyB,GAAGuG,YAAa,CAC1DjP,KAAK40B,YAAa,EAClB70B,EAAO+C,OAAO,iBAAmBxB,KAAM,8BAA+ByB,kBAAkB,EACpFvB,OAAS6xB,MAAO3qB,KACpB3I,EAAO+C,OAAO,iBAAmBxB,KAAM,WAAYyB,kBAAkB,EACjEvB,OAASuN,YAAa,KAAME,YAAa,QAC7C1M,EAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS,UAC3Cod,GAAY,CACZ,OAEC,IAAKj7B,KAAKg2B,cAAgBj2B,EAAOkH,UAAUyB,GAAG0qB,WAAY,CAO3D,IANIpzB,KAAK40B,YAAc50B,KAAKg2B,gBACxBxzB,EAAa2B,UAAU,EAAG,EAAG5B,EAAYlC,MAAOkC,EAAYjC,QACxDP,EAAO6C,UAAUwC,OAAoC,SAA3B0X,EAASjB,MAAMG,SACzCjc,EAAO+C,OAAO,QAAUxB,KAAM,aAAcyB,kBAAkB,EAAOvB,OAAS6D,OAAQ,YAAapB,IAAKlE,EAAO6C,cAGnH5C,KAAKg2B,aAAc,CACnB,GAAIjnB,GAAchP,EAAOkH,UAAUyB,GAAGqG,WACtChP,GAAO+C,OAAO,iBAAmBxB,KAAM,WAAYyB,kBAAkB,EACjEvB,OAASuN,YAAaA,EAAaE,YAAalP,EAAOkH,UAAUyB,GAAGuG,eAE5EjP,KAAK40B,YAAa,GAI9B,GAAIqG,EACA,QAIZ1G,EAAU1zB,UAAUs4B,iBAAmB,SAAU34B,EAAGC,EAAGwD,EAAK1B,EAAa2b,GAErE,IAAK,GADDne,GAASC,KAAKD,OACTiF,EAAI,EAAGC,EAAMhB,EAAIkB,OAAQH,EAAIC,EAAKD,IAAK,CAC5C,GAAsB,SAAlBjF,EAAO8d,OACP,MAEJ,IAAIvU,GAAStF,YAAWC,EAAIe,OAAQ,EACpChF,MAAKq1B,eAAiB/rB,EAAOuV,UACR,SAAjBvV,EAAOlE,OAAqC,UAAjBkE,EAAOlE,MAClCpF,KAAKg5B,sBAAsB1vB,EAAQ9I,EAAGC,EAAG8B,GAEnB,SAAjB+G,EAAOlE,MACZpF,KAAKi5B,iBAAiB3vB,EAAQ9I,EAAGC,EAAG8B,GAE9BN,oBAAkBqH,EAAOsK,eAAyC,IAAxBtK,EAAOsK,aAIvDrR,EAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS7d,KAAK84B,eAAexvB,EAAQ9I,EAAGC,EAAGyd,GAAiB,GAH9Fle,KAAKk5B,0BAA0B5vB,EAAQ9I,EAAGC,EAAG8B,KAOzDgyB,EAAU1zB,UAAUuN,SAAW,SAAU5N,EAAGC,EAAGy6B,EAAIC,EAAIC,EAAIC,GACvD,GAAI9iB,GAAKpQ,KAAK6Y,IAAIka,EAAIE,GAClB3iB,EAAKtQ,KAAK4Y,IAAIma,EAAIE,GAClB5iB,EAAKrQ,KAAK6Y,IAAIma,EAAIE,GAClB3iB,EAAKvQ,KAAK4Y,IAAIoa,EAAIE,EACtB,OAAK9iB,IAAM/X,GAAKA,GAAKiY,GAAQD,GAAM/X,GAAKA,GAAKiY,GAOjD6b,EAAU1zB,UAAU21B,kBAAoB,SAAUh2B,EAAGC,EAAGyd,GACpD,GAAIne,GAASC,KAAKD,OACdkE,GAAQ5D,MAAO,EAAGC,OAAQ,EAC9BP,GAAO+C,OAAO,aAAexB,KAAM,mBAAoByB,kBAAkB,EACrEvB,OAASnB,MAAON,EAAO6C,UAAUC,YAAYxC,MAAOC,OAAQP,EAAO6C,UAAUC,YAAYvC,OAAQ2D,IAAKA,IAC1G,IAAIC,GAAeD,EACfyvB,EAAwB1zB,KAAK83B,0BAC7BwD,GAAsBzb,OAAQ,SAAU6T,sBAAuBA,GAC/D6H,GAAoB1b,OAAQ,OAAQ6T,sBAAuBA,EAC/D1zB,MAAKs7B,kBAAoBA,EACzBt7B,KAAKu7B,gBAAkBA,EACQ,SAA3Bx7B,EAAO6C,UAAUwC,OAAyC,KAArBpF,KAAKu1B,aAC1Cx1B,EAAO+C,OAAO,SAAWxB,KAAM,kBAAmByB,kBAAkB,EAChEvB,OAASyC,IAAKlE,EAAO6C,UAAW44B,WAAY,QAEnB,KAA7Bx7B,KAAKi2B,qBAAoD,KAArBj2B,KAAKu1B,aAA2C,SAArBv1B,KAAKu1B,cACrC,SAA3Bx1B,EAAO6C,UAAUwC,OAA+C,UAA3BrF,EAAO6C,UAAUwC,OAC3B,SAA3BrF,EAAO6C,UAAUwC,MACjBpF,KAAKu1B,YAAc,WAGf/0B,EAAIT,EAAO6C,UAAUC,YAAY1C,QAAUM,EAAIV,EAAO6C,UAAUC,YAAYzC,OAC5EJ,KAAKu1B,YAAc,YAEd/0B,EAAIT,EAAO6C,UAAUC,YAAY1C,QAAUM,EAAIV,EAAO6C,UAAUC,YAAYzC,OACjFJ,KAAKu1B,YAAc,YAEd/0B,EAAIT,EAAO6C,UAAUC,YAAY1C,QAAUM,EAAIV,EAAO6C,UAAUC,YAAYzC,OACjFJ,KAAKu1B,YAAc,YAEd/0B,EAAIT,EAAO6C,UAAUC,YAAY1C,QAAUM,EAAIV,EAAO6C,UAAUC,YAAYzC,SACjFJ,KAAKu1B,YAAc,cAIA,UAA3Bx1B,EAAO6C,UAAUwC,QACb+C,KAAK6Q,MAAMxY,EAAIT,EAAOqC,YAAY/B,MAAQ,EAAGI,EAAIV,EAAOqC,YAAY9B,OAAS,GAAK,EAClFP,EAAO6C,UAAUgR,cAAgBzL,KAAK6Q,MAAMxY,EAAIT,EAAOqC,YAAY/B,MAAQ,EAAGI,EAAIV,EAAOqC,YAAY9B,OAAS,GAG9GP,EAAO6C,UAAUgR,aAAezL,KAAKC,IAAID,KAAK6Q,MAAMxY,EAAIT,EAAOqC,YAAY/B,MAAQ,EAAGI,EAAIV,EAAOqC,YAAY9B,OAAS,IAG9H,IAAI2C,GACA4U,GAAmB,EACnBC,GAAiB,CACrB,QAAQ9X,KAAKu1B,YAAY3iB,eACrB,IAAK,YACD5S,KAAKy7B,eAAej7B,EAAGC,EAAGyD,GAC1BnE,EAAO+C,OAAO,SAAWxB,KAAM,uBAAwByB,kBAAkB,EACrEvB,OAASyC,IAAKlE,EAAO6C,UAAW+lB,KAAM,KAAM+S,cAAe,QAC/D17B,KAAK27B,mBAAmBL,EAAmBC,EAAiB,SAC5D,MACJ,KAAK,WACDv7B,KAAK47B,cAAcp7B,EAAGC,GACtBV,EAAO+C,OAAO,SAAWxB,KAAM,uBAAwByB,kBAAkB,EACrEvB,OAASyC,IAAKlE,EAAO6C,UAAW+lB,KAAM,KAAM+S,cAAe,QAC/D17B,KAAK27B,mBAAmBL,EAAmBC,EAAiB,SAC5D,MACJ,KAAK,YACDv7B,KAAK67B,eAAer7B,EAAGC,EAAGyD,GAC1BnE,EAAO+C,OAAO,SAAWxB,KAAM,uBAAwByB,kBAAkB,EACrEvB,OAASyC,IAAKlE,EAAO6C,UAAW+lB,KAAM,KAAM+S,cAAe,QAC/D17B,KAAK27B,mBAAmBL,EAAmBC,EAAiB,SAC5D,MACJ,KAAK,WACDv7B,KAAK87B,cAAct7B,EAAGC,GACtBV,EAAO+C,OAAO,SAAWxB,KAAM,uBAAwByB,kBAAkB,EACrEvB,OAASyC,IAAKlE,EAAO6C,UAAW+lB,KAAM,KAAM+S,cAAe,QAC/D17B,KAAK27B,mBAAmBL,EAAmBC,EAAiB,SAC5D,MACJ,KAAK,WACDv7B,KAAK+7B,cAAcv7B,EAAGC,GACtBV,EAAO+C,OAAO,SAAWxB,KAAM,uBAAwByB,kBAAkB,EACrEvB,OAASyC,IAAKlE,EAAO6C,UAAW+lB,KAAM,KAAM+S,cAAe,QAC/D17B,KAAK27B,mBAAmBL,EAAmBC,EAAiB,SAC5D,MACJ,KAAK,YACDv7B,KAAKg8B,eAAex7B,EAAGC,EAAGyD,GAC1BnE,EAAO+C,OAAO,SAAWxB,KAAM,uBAAwByB,kBAAkB,EACrEvB,OAASyC,IAAKlE,EAAO6C,UAAW+lB,KAAM,KAAM+S,cAAe,QAC/D17B,KAAK27B,mBAAmBL,EAAmBC,EAAiB,SAC5D,MACJ,KAAK,WACDv7B,KAAKi8B,cAAcz7B,EAAGC,GACtBV,EAAO+C,OAAO,SAAWxB,KAAM,uBAAwByB,kBAAkB,EACrEvB,OAASyC,IAAKlE,EAAO6C,UAAW+lB,KAAM,KAAM+S,cAAe,QAC/D17B,KAAK27B,mBAAmBL,EAAmBC,EAAiB,SAC5D,MACJ,KAAK,YACDv7B,KAAKk8B,eAAe17B,EAAGC,EAAGyD,GAC1BnE,EAAO+C,OAAO,SAAWxB,KAAM,uBAAwByB,kBAAkB,EACrEvB,OAASyC,IAAKlE,EAAO6C,UAAW+lB,KAAM,KAAM+S,cAAe,QAC/D17B,KAAK27B,mBAAmBL,EAAmBC,EAAiB,SAC5D,MACJ,KAAK,WACGpzB,KAAK6Q,MAAMxY,GAAKT,EAAO6C,UAAUC,YAAY1C,OAAUJ,EAAO6C,UAAUC,YAAYxC,MAAQ,GAAKI,GAAKV,EAAO6C,UAAUC,YAAYzC,OAAUL,EAAO6C,UAAUC,YAAYvC,OAAS,IAAO,EAC1LP,EAAO6C,UAAUgR,cAAgBzL,KAAK6Q,MAAMxY,GAAKT,EAAO6C,UAAUC,YAAY1C,OAAUJ,EAAO6C,UAAUC,YAAYxC,MAC/G,GAAKI,GAAKV,EAAO6C,UAAUC,YAAYzC,OAAUL,EAAO6C,UAAUC,YAAYvC,OAAS,IAG7FP,EAAO6C,UAAUgR,aAAezL,KAAKC,IAAID,KAAK6Q,MAAMxY,GAAKT,EAAO6C,UAAUC,YAAY1C,OACjFJ,EAAO6C,UAAUC,YAAYxC,MAAQ,GAAKI,GAAKV,EAAO6C,UAAUC,YAAYzC,OAC5EL,EAAO6C,UAAUC,YAAYvC,OAAS,MAG3C2C,EADiC,IAAjClD,EAAO6C,UAAUsF,YACRnI,EAAOiD,UAAUC,OAGjBlD,EAAOiD,UAAUC,OAASlD,EAAO6C,UAAUsF,aAE3C,IACTjF,EAAS,IAAMA,EAEnB,KAAK,GAAI+B,GAAI,EAAGC,EAAMlF,EAAO6C,UAAUmV,YAAY5S,OAAQH,EAAIC,EAAKD,IACV,eAAlDjF,EAAO6C,UAAUmV,YAAY/S,GAAG4N,cAChCiF,GAAmB,EAEoC,aAAlD9X,EAAO6C,UAAUmV,YAAY/S,GAAG4N,gBACrCkF,GAAiB,EAGzB/X,GAAO6C,UAAUgR,cAAiB3Q,GAAUkF,KAAKyC,GAAK,KACvC,IAAX3H,GAA2B,MAAXA,EACZ6U,IACA/X,EAAO6C,UAAUgR,cAAwBzL,KAAKyC,GAAK,IAAjB,KAGtB,KAAX3H,IAA6B,MAAZA,EAClB4U,IACA9X,EAAO6C,UAAUgR,cAAwBzL,KAAKyC,GAAK,IAAjB,KAGtB,MAAX3H,IAA8B,MAAZA,EACnB6U,IACA/X,EAAO6C,UAAUgR,cAAwBzL,KAAKyC,GAAK,IAAjB,KAGtB,MAAX3H,IAA8B,KAAZA,GACnB4U,IACA9X,EAAO6C,UAAUgR,cAAwBzL,KAAKyC,GAAK,IAAjB,IAG1C,MACJ,KAAK,WACI3I,oBAAkBjC,KAAK44B,qBACxB74B,EAAO6C,UAAUqE,UAAUjH,KAAK44B,mBAAmBp4B,EAAIA,EACvDT,EAAO6C,UAAUqE,UAAUjH,KAAK44B,mBAAmBn4B,EAAIA,EAE3D,MACJ,SACI,IAAKyd,IAAoBne,EAAO0F,YAAYC,aAAc,CACtD,GAAI1F,KAAK60B,UAAU10B,OAAQ,CACvB,GAAIE,GAASL,KAAK60B,UAAU9sB,KAAO/H,KAAK01B,cAAcl1B,EAClDF,EAAUN,KAAK60B,UAAU7sB,KAAOhI,KAAK01B,cAAcj1B,CAYvD,IAXAV,EAAO6C,UAAUC,YAAY1C,QAAUE,EACvCN,EAAO6C,UAAUC,YAAYkF,MAAQ1H,EACrCN,EAAO6C,UAAUC,YAAYzC,QAAUE,EACvCP,EAAO6C,UAAUC,YAAYmF,MAAQ1H,EACN,SAA3BP,EAAO6C,UAAUwC,OAA+C,UAA3BrF,EAAO6C,UAAUwC,OACtDrF,EAAO6C,UAAU+2B,0BACjB55B,EAAO6C,UAAU+2B,wBAAwBn5B,GAAKH,EAC9CN,EAAO6C,UAAU+2B,wBAAwBl5B,GAAKH,EAC9CP,EAAO6C,UAAU0S,oBAAoB9U,GAAKH,EAC1CN,EAAO6C,UAAU0S,oBAAoB7U,GAAKH,GAEf,SAA3BP,EAAO6C,UAAUwC,MACjB,IAAK,GAAIJ,GAAI,EAAGC,EAAMlF,EAAO6C,UAAUqE,UAAU9B,OAAQH,EAAIC,EAAKD,IAC9DjF,EAAO6C,UAAUqE,UAAUjC,GAAGxE,GAAKH,EACnCN,EAAO6C,UAAUqE,UAAUjC,GAAGvE,GAAKH,GAGtCN,KAAKs1B,oBAAsBv1B,EAAO6C,UAAUC,YAAY1C,OAASJ,EAAOqD,IAAIC,UAC7EtD,EAAO6C,UAAUC,YAAYzC,OAASL,EAAOqD,IAAIE,SAAWvD,EAAO6C,UAAUC,YAAYkF,KACzFhI,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,WAAaxD,EAAO6C,UAAUC,YAAYmF,KAAOjI,EAAOqD,IAAIE,QAC3FvD,EAAOqD,IAAII,cACbzD,EAAO6C,UAAUC,YAAY1C,QAAUE,EACvCN,EAAO6C,UAAUC,YAAYkF,MAAQ1H,EACrCN,EAAO6C,UAAUC,YAAYzC,QAAUE,EACvCP,EAAO6C,UAAUC,YAAYmF,MAAQ1H,EACN,SAA3BP,EAAO6C,UAAUwC,OAA+C,UAA3BrF,EAAO6C,UAAUwC,OACtDrF,EAAO6C,UAAU+2B,0BACjB55B,EAAO6C,UAAU+2B,wBAAwBn5B,GAAKH,EAC9CN,EAAO6C,UAAU+2B,wBAAwBl5B,GAAKH,EAC9CP,EAAO6C,UAAU0S,oBAAoB9U,GAAKH,EAC1CN,EAAO6C,UAAU0S,oBAAoB7U,GAAKH,GAE9CN,KAAKm4B,aAAa93B,GAClBL,KAAKo4B,cAAc93B,QAIvBP,GAAO6C,UAAUC,YAAY1C,OAASK,EAAIR,KAAKy1B,eAAej1B,EAAIA,EAAIR,KAAKy1B,eAAej1B,EAC1FT,EAAO6C,UAAUC,YAAYzC,OAASK,EAAIT,KAAKy1B,eAAeh1B,EAAIA,EAAIT,KAAKy1B,eAAeh1B,EAC1FD,EAAIA,EAAIR,KAAKy1B,eAAej1B,EAAIR,KAAKy1B,eAAej1B,EAAIA,EACxDC,EAAIA,EAAIT,KAAKy1B,eAAeh1B,EAAIT,KAAKy1B,eAAeh1B,EAAIA,EACxDV,EAAO6C,UAAUC,YAAYkF,KAAOvH,EACpCT,EAAO6C,UAAUC,YAAYmF,KAAOvH,CAExCT,MAAK27B,mBAAmBL,EAAmBC,EAAiB,WAK5EhH,EAAU1zB,UAAU86B,mBAAqB,SAAUL,EAAmBC,EAAiB50B,GACnF,GAAI5G,GAASC,KAAKD,MAClBA,GAAO6C,UAAUC,YAAYxC,MAAQN,EAAO6C,UAAUC,YAAYkF,KAAOhI,EAAO6C,UAAUC,YAAY1C,OACtGJ,EAAO6C,UAAUC,YAAYvC,OAASP,EAAO6C,UAAUC,YAAYmF,KAAOjI,EAAO6C,UAAUC,YAAYzC,MACvG,IAAIuzB,GAAuB3zB,KAAK83B,yBAGhC,IAFAwD,EAAkB3H,qBAAuB3zB,KAAKs7B,kBAAkB3H,qBAAuBA,EACvF4H,EAAgB5H,qBAAuB3zB,KAAKu7B,gBAAgB5H,qBAAuBA,EACtE,WAAThtB,EAAmB,CACnB3G,KAAKke,iBAAkB,CACvB,IAAIxR,OAAa,EAOjB,QAN+B+G,KAA3B1T,EAAO6C,UAAUwC,QACjBsH,EAAa3M,EAAO6C,UAAUwC,MAAMuH,MAAM,UAE3B8G,KAAf/G,GAA8C,SAAlBA,EAAW,KACvC1M,KAAKke,iBAAkB,IAEtBle,KAAKke,iBAA6C,WAA1Ble,KAAKD,OAAOo8B,WAA0BjwB,cAAcnM,EAAOoM,SAAgE,IAAtDnM,KAAKD,OAAOoM,OAAOiwB,mBAAmBhwB,YACpIkvB,EAAkBzb,OAAsC,KAA7B7f,KAAKi2B,oBAA6B,UAAY,eAEzEl2B,EAAOsM,UAAUC,kBAAkB,kBAAmB,qBAAsBgvB,GAAmB/uB,KAAK,SAAU+uB,GAC1Gv7B,EAAO+C,OAAO,SAAWxB,KAAM,6BAA8ByB,kBAAkB,EAC3EvB,OAAS8xB,cAAegI,EAAkB3H,8BAGjD,IAAK3zB,KAAKke,gBAQV,CACD,GAAIme,IAA0Bxc,OAAQyb,EAAkBzb,OACpDC,2BAA6BnZ,KAAM5G,EAAO4f,iBAAiB5f,EAAO6C,UAAUwC,OACxEjF,OAAQm7B,EAAkB5H,sBAAsBvzB,OAChDC,OAAQk7B,EAAkB5H,sBAAsBtzB,OAChDC,MAAOi7B,EAAkB5H,sBAAsBrzB,MAC/CC,OAAQg7B,EAAkB5H,sBAAsBpzB,QACpDyf,0BAA4BpZ,KAAM5G,EAAO4f,iBAAiB5f,EAAO6C,UAAUwC,OACvEjF,OAAQm7B,EAAkB3H,qBAAqBxzB,OAC/CC,OAAQk7B,EAAkB3H,qBAAqBvzB,OAC/CC,MAAOi7B,EAAkB3H,qBAAqBtzB,MAC9CC,OAAQg7B,EAAkB3H,qBAAqBrzB,QACvDN,MAAKq8B,sBAAwBA,EACzBnwB,cAAcjK,oBAAkBjC,KAAKD,OAAOo8B,YAAcp8B,EAAOoM,SACZ,IAArDpM,EAAOoM,OAAO6T,uBAAuB5T,aACrCiwB,EAAsBxc,OAAS,eAE/B9f,EAAOsM,UAAUC,kBAAkB,sBAAuB,yBAA0B+vB,GAAuB9vB,KAAK,SAAU8vB,GACtHt8B,EAAO+C,OAAO,SAAWxB,KAAM,wBAAyByB,kBAAkB,EACtEvB,OAASyU,kBAAmBomB,EAAsBtc,gCAI1DhgB,EAAO0M,QAAQ,oBAAqB4vB,GACpCt8B,EAAO+C,OAAO,SAAWxB,KAAM,wBAAyByB,kBAAkB,EACtEvB,OAASyU,kBAAmBomB,EAAsBtc,iCAhCzB,KAA7B/f,KAAKi2B,sBACLqF,EAAkBzb,OAAS,WAE/B9f,EAAO0M,QAAQ,gBAAiB6uB,GAChCv7B,EAAO+C,OAAO,SAAWxB,KAAM,6BAA8ByB,kBAAkB,EAC3EvB,OAAS8xB,cAAegI,EAAkB3H,4BAgC9CznB,eAAcjK,oBAAkBjC,KAAKD,OAAOo8B,YAAcp8B,EAAOoM,SAClB,IAA/CpM,EAAOoM,OAAOmwB,iBAAiBlwB,aAC/BmvB,EAAgB1b,OAAS,aAEzB9f,EAAOsM,UAAUC,kBAAkB,kBAAmB,mBAAoBivB,GAAiBhvB,KAAK,SAAUgvB,GACtGx7B,EAAO+C,OAAO,SAAWxB,KAAM,6BAA8ByB,kBAAkB,EAC3EvB,OAAS8xB,cAAeiI,EAAgB5H,4BAIhD5zB,EAAO0M,QAAQ,gBAAiB8uB,GAChCx7B,EAAO+C,OAAO,SAAWxB,KAAM,6BAA8ByB,kBAAkB,EAC3EvB,OAAS8xB,cAAeiI,EAAgB5H,wBAGpD3zB,MAAKD,OAAOo8B,UAAYx1B,GAE5B4tB,EAAU1zB,UAAUs3B,aAAe,SAAU93B,GACzC,GAAIN,GAASC,KAAKD,OACdqY,EAAY/X,CAChB,IAAI+X,GAAa,EACb,IAASpT,EAAI,EAAGA,EAAIoT,IAChB/X,EAAQ+X,EAAYpT,EACpBjF,EAAO6C,UAAUC,YAAY1C,QAAUE,EACvCN,EAAO6C,UAAUC,YAAYkF,MAAQ1H,IACjCN,EAAO6C,UAAUC,YAAY1C,QAAUJ,EAAOqD,IAAIC,UAClDtD,EAAO6C,UAAUC,YAAYkF,MAAQhI,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,YAL/CyB,IASvBjF,EAAO6C,UAAUC,YAAY1C,QAAUE,EACvCN,EAAO6C,UAAUC,YAAYkF,MAAQ1H,MAK7C,KAAK,GAAI2E,GAAI,EAAGA,EAAImD,KAAKC,IAAIgQ,KACzB/X,EAAQ+X,EAAYpT,EACpBjF,EAAO6C,UAAUC,YAAY1C,QAAUE,EACvCN,EAAO6C,UAAUC,YAAYkF,MAAQ1H,IACjCN,EAAO6C,UAAUC,YAAY1C,QAAUJ,EAAOqD,IAAIC,UAClDtD,EAAO6C,UAAUC,YAAYkF,MAAQhI,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,YALrCyB,IASjCjF,EAAO6C,UAAUC,YAAY1C,QAAUE,EACvCN,EAAO6C,UAAUC,YAAYkF,MAAQ1H,GAKrDk0B,EAAU1zB,UAAUu3B,cAAgB,SAAU93B,GAC1C,GAAIP,GAASC,KAAKD,OACdw8B,EAAaj8B,CACjB,IAAIi8B,GAAc,EACd,IAASv3B,EAAI,EAAGA,EAAIu3B,IAChBj8B,EAASi8B,EAAav3B,EACtBjF,EAAO6C,UAAUC,YAAYzC,QAAUE,EACvCP,EAAO6C,UAAUC,YAAYmF,MAAQ1H,IACjCP,EAAO6C,UAAUC,YAAYzC,QAAUL,EAAOqD,IAAIE,SAClDvD,EAAO6C,UAAUC,YAAYmF,MAAQjI,EAAOqD,IAAIE,QAAUvD,EAAOqD,IAAII,aAL7CwB,IASxBjF,EAAO6C,UAAUC,YAAYzC,QAAUE,EACvCP,EAAO6C,UAAUC,YAAYmF,MAAQ1H,MAK7C,KAAK,GAAI0E,GAAI,EAAGA,EAAImD,KAAKC,IAAIm0B,KACzBj8B,EAASi8B,EAAav3B,EACtBjF,EAAO6C,UAAUC,YAAYzC,QAAUE,EACvCP,EAAO6C,UAAUC,YAAYmF,MAAQ1H,IACjCP,EAAO6C,UAAUC,YAAYzC,QAAUL,EAAOqD,IAAIE,SAClDvD,EAAO6C,UAAUC,YAAYmF,MAAQjI,EAAOqD,IAAIE,QAAUvD,EAAOqD,IAAII,aALnCwB,IASlCjF,EAAO6C,UAAUC,YAAYzC,QAAUE,EACvCP,EAAO6C,UAAUC,YAAYmF,MAAQ1H,GAKrDi0B,EAAU1zB,UAAU27B,UAAY,SAAUC,GACtC,GAAI18B,GAASC,KAAKD,OACdI,EAASs8B,EAAU18B,EAAO6C,UAAUC,YAAY1C,OAASJ,EAAO6C,UAAUC,YAAYkF,KACtF3H,EAASq8B,EAAU18B,EAAO6C,UAAUC,YAAYzC,OAASL,EAAO6C,UAAUC,YAAYmF,KACtFD,EAAO00B,EAAU18B,EAAO6C,UAAUC,YAAYkF,KAAOhI,EAAO6C,UAAUC,YAAY1C,OAClF6H,EAAOy0B,EAAU18B,EAAO6C,UAAUC,YAAYmF,KAAOjI,EAAO6C,UAAUC,YAAYzC,MAClFD,GAASJ,EAAOqD,IAAIC,WACpBlD,EAASJ,EAAOqD,IAAIC,UAEpBjD,EAASL,EAAOqD,IAAIE,UACpBlD,EAASL,EAAOqD,IAAIE,SAEpByE,EAAOhI,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,YACxCwE,EAAOhI,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,WAExCyE,EAAOjI,EAAOqD,IAAIE,QAAUvD,EAAOqD,IAAII,aACvCwE,EAAOjI,EAAOqD,IAAIE,QAAUvD,EAAOqD,IAAII,YAEvCi5B,GACA18B,EAAO6C,UAAUC,YAAY1C,OAASA,EACtCJ,EAAO6C,UAAUC,YAAYzC,OAASA,EACtCL,EAAO6C,UAAUC,YAAYkF,KAAOA,EACpChI,EAAO6C,UAAUC,YAAYmF,KAAOA,IAGpCjI,EAAO6C,UAAUC,YAAY1C,OAAS4H,EACtChI,EAAO6C,UAAUC,YAAYzC,OAAS4H,EACtCjI,EAAO6C,UAAUC,YAAYkF,KAAO5H,EACpCJ,EAAO6C,UAAUC,YAAYmF,KAAO5H,IAG5Cm0B,EAAU1zB,UAAU67B,wBAA0B,WAC1C,GAAI38B,GAASC,KAAKD,MACbC,MAAKs1B,mBAAuD,IAAlCv1B,EAAO6C,UAAUgR,eAC5C5T,KAAKw8B,WAAU,GACgB,SAA3Bz8B,EAAO6C,UAAUwC,OAA+C,UAA3BrF,EAAO6C,UAAUwC,OAC3B,SAA3BrF,EAAO6C,UAAUwC,OACjBpF,KAAKw8B,WAAU,KAI3BjI,EAAU1zB,UAAU87B,4BAA8B,WAC9C,GAAI58B,GAASC,KAAKD,OACd68B,GAAa,CASjB,OARK58B,MAAKs1B,oBACFv1B,EAAO6C,UAAUC,YAAY1C,OAASJ,EAAOqD,IAAIC,UACjDtD,EAAO6C,UAAUC,YAAYzC,OAASL,EAAOqD,IAAIE,SACjDvD,EAAO6C,UAAUC,YAAYkF,KAAOhI,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,WACrExD,EAAO6C,UAAUC,YAAYmF,KAAOjI,EAAOqD,IAAIE,QAAUvD,EAAOqD,IAAII,cACpEo5B,GAAa,GAGdA,GAEXrI,EAAU1zB,UAAUg8B,qBAAuB,SAAUvb,GACjD,GAAIvhB,GAASC,KAAKD,MACdA,GAAO6C,UAAUC,YAAYxC,MAAQ,IACrCN,EAAO6C,UAAUC,YAAYxC,MAAQ,EACrCN,EAAO6C,UAAUC,YAAY1C,OAASmhB,EAAcze,YAAY1C,OAChEJ,EAAO6C,UAAUC,YAAYkF,KAAOuZ,EAAcze,YAAYkF,MAE9DhI,EAAO6C,UAAUC,YAAYvC,OAAS,IACtCP,EAAO6C,UAAUC,YAAYvC,OAAS,EACtCP,EAAO6C,UAAUC,YAAYzC,OAASkhB,EAAcze,YAAYzC,OAChEL,EAAO6C,UAAUC,YAAYmF,KAAOsZ,EAAcze,YAAYmF,OAGtEusB,EAAU1zB,UAAUi8B,cAAgB,SAAUniB,GAC1C,GAAI5a,GAASC,KAAKD,OACdoD,GAAU3C,EAAGma,EAAOla,EAAGka,EAC3B,IAAI5a,EAAO6C,UAAUwC,OAAoC,gBAA3BrF,EAAO6C,UAAUwC,OAChB,gBAA3BrF,EAAO6C,UAAUwC,OAAsD,gBAA3BrF,EAAO6C,UAAUwC,MAAyB,CACtF,GAAItB,GAAQ/D,EAAO6C,UAAUwC,MAAMuH,MAAM,IACzC,IAAI7I,EAAMqB,OAAS,EAAG,CAClBrB,EAAQA,EAAM,GAAG6I,MAAM,IACvB,IAAIowB,GAAWpiB,EAAS8S,SAAS3pB,EAAM,GAAI,GAC3CX,GAAM3C,EAAIu8B,EAAYtP,SAAS3pB,EAAM,GAAI,IACzCX,EAAM1C,EAAIs8B,EAAYtP,SAAS3pB,EAAM,GAAI,KAGjD,MAAOX,IAEXoxB,EAAU1zB,UAAU46B,eAAiB,SAAUj7B,EAAGC,EAAGyD,GACjD,GAEI7D,GACAC,EACAqa,EACAqiB,EALAj9B,EAASC,KAAKD,OAMdk9B,EAAYj9B,KAAKw0B,UAAUh0B,EAC3B08B,EAAYl9B,KAAKw0B,UAAU/zB,EAC3B6gB,EAAgBtd,YAAWjE,EAAO6C,UAAW,MAAM,EACvD,IAA+B,SAA3B7C,EAAO6C,UAAUwC,UACOqO,KAApBzT,KAAKy0B,SAASj0B,OAAuCiT,KAApBzT,KAAKy0B,SAASh0B,GAC/CT,KAAKw0B,UAAUh0B,EAAIT,EAAO6C,UAAUC,YAAY1C,OAASK,EACzDR,KAAKw0B,UAAU/zB,EAAIV,EAAO6C,UAAUC,YAAYzC,OAASK,IAGzDT,KAAKw0B,UAAUh0B,EAAIR,KAAKy0B,SAASj0B,EAAIA,EACrCR,KAAKw0B,UAAU/zB,EAAIT,KAAKy0B,SAASh0B,EAAIA,GAEzCT,KAAKy0B,SAASj0B,EAAIA,EAClBR,KAAKy0B,SAASh0B,EAAIA,EAOlBu8B,GANIh9B,KAAKw0B,UAAUh0B,GAAKy8B,GAAaj9B,KAAKw0B,UAAU/zB,GAAKy8B,EAC9C/0B,KAAK6Y,IAAIhhB,KAAKw0B,UAAUh0B,EAAGR,KAAKw0B,UAAU/zB,GAG1C0H,KAAK4Y,IAAI/gB,KAAKw0B,UAAUh0B,EAAGR,KAAKw0B,UAAU/zB,IAEhC,GACrBV,EAAO6C,UAAUC,YAAY1C,QAAW+D,EAAa7D,MAAQ,IAAO28B,EACpEj9B,EAAO6C,UAAUC,YAAYzC,QAAW8D,EAAa5D,OAAS,IAAO08B,EACjEh9B,KAAK28B,gCACL58B,EAAO6C,UAAUC,YAAY1C,QAAW+D,EAAa7D,MAAQ,IAAO28B,EACpEj9B,EAAO6C,UAAUC,YAAYzC,QAAW8D,EAAa5D,OAAS,IAAO08B,GAEzEj9B,EAAO6C,UAAUC,YAAYxC,MAAQN,EAAO6C,UAAUC,YAAYkF,KAAOhI,EAAO6C,UAAUC,YAAY1C,OACtGJ,EAAO6C,UAAUC,YAAYvC,OAASP,EAAO6C,UAAUC,YAAYmF,KAAOjI,EAAO6C,UAAUC,YAAYzC,OACvGL,EAAO+C,OAAO,SAAWxB,KAAM,iBAAkByB,kBAAkB,EAC/DvB,OAASyC,IAAKlE,EAAO6C,iBAExB,CACD,GAAI8J,OAAa,EAIjB,QAH+B+G,KAA3B1T,EAAO6C,UAAUwC,QACjBsH,EAAa3M,EAAO6C,UAAUwC,MAAMuH,MAAM,MAEf,gBAA3B5M,EAAO6C,UAAUwC,WAAuDqO,KAA3B1T,EAAO6C,UAAUwC,OAAyC,SAAlBsH,EAAW,GAAgB,CAEhH,GADA1M,KAAKm9B,eAAep9B,EAAO6C,UAAUC,YAAarC,EAAGC,EAAGV,EAAO6C,UAAUgR,cACrE7T,EAAO6C,UAAUC,YAAY1C,OAASJ,EAAO6C,UAAUC,YAAYkF,KAAM,CACrErD,EAAO3E,EAAO6C,UAAUC,YAAY1C,MACxCJ,GAAO6C,UAAUC,YAAY1C,OAASJ,EAAO6C,UAAUC,YAAYkF,KACnEhI,EAAO6C,UAAUC,YAAYkF,KAAOrD,EACpC1E,KAAKu1B,YAAcx1B,EAAOwC,YAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS,YAEzE,GAAI9d,EAAO6C,UAAUC,YAAYzC,OAASL,EAAO6C,UAAUC,YAAYmF,KAAM,CACzE,GAAItD,GAAO3E,EAAO6C,UAAUC,YAAYzC,MACxCL,GAAO6C,UAAUC,YAAYzC,OAASL,EAAO6C,UAAUC,YAAYmF,KACnEjI,EAAO6C,UAAUC,YAAYmF,KAAOtD,EACpC1E,KAAKu1B,YAAcx1B,EAAOwC,YAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS,YAEzE7d,KAAK08B,8BAGL,IAAI38B,EAAO6C,UAAUC,YAAY1C,OAASK,GAAKT,EAAO6C,UAAUC,YAAYzC,OAASK,EAAG,CACpFJ,EAAQG,EAAIT,EAAO6C,UAAUC,YAAY1C,OACzCG,EAASG,EAAIV,EAAO6C,UAAUC,YAAYzC,OAC1Cua,EAAQxS,KAAK6Y,IAAI3gB,EAAOC,EACpBy8B,GAAW/8B,KAAK88B,cAAcniB,EAClC5a,GAAO6C,UAAUC,YAAY1C,QAAU48B,EAASv8B,EAChDT,EAAO6C,UAAUC,YAAYzC,QAAU28B,EAASt8B,CAChD,IAAIwa,GAAOlb,EAAOqD,IAAIC,SAAW,EAAItD,EAAOqD,IAAIC,SAAW,EACvD6X,EAAQnb,EAAOqD,IAAIE,QAAU,EAAIvD,EAAOqD,IAAIE,QAAU,GACtDvD,EAAO6C,UAAUC,YAAY1C,OAAS8a,GAAQlb,EAAO6C,UAAUC,YAAYzC,OAAS8a,KACpFnb,EAAO6C,UAAUC,YAAY1C,QAAU48B,EAASv8B,EAChDT,EAAO6C,UAAUC,YAAYzC,QAAU28B,EAASt8B,OAGnD,CACDJ,EAAQN,EAAO6C,UAAUC,YAAY1C,OAASK,EAC9CF,EAASG,EAAIV,EAAO6C,UAAUC,YAAYmF,KAC1C2S,EAAQxS,KAAK4Y,IAAI1gB,EAAOC,EACxB,IAAIy8B,GAAW/8B,KAAK88B,cAAcniB,EAClC5a,GAAO6C,UAAUC,YAAY1C,QAAU48B,EAASv8B,EAChDT,EAAO6C,UAAUC,YAAYzC,QAAU28B,EAASt8B,CAChD,IAAIwa,GAAOlb,EAAOqD,IAAIC,SAAW,EAAItD,EAAOqD,IAAIC,SAAW,EACvD+5B,EAAQr9B,EAAOqD,IAAIE,QAAU,EAAIvD,EAAOqD,IAAIE,QAAU,GACtDvD,EAAO6C,UAAUC,YAAY1C,OAAS8a,GAAQlb,EAAO6C,UAAUC,YAAYzC,OAASg9B,KACpFr9B,EAAO6C,UAAUC,YAAY1C,QAAU48B,EAASv8B,EAChDT,EAAO6C,UAAUC,YAAYzC,QAAU28B,EAASt8B,GAI5DV,EAAO6C,UAAUC,YAAYxC,MAAQN,EAAO6C,UAAUC,YAAYkF,KAAOhI,EAAO6C,UAAUC,YAAY1C,OACtGJ,EAAO6C,UAAUC,YAAYvC,OAASP,EAAO6C,UAAUC,YAAYmF,KAAOjI,EAAO6C,UAAUC,YAAYzC,OACvGJ,KAAK68B,qBAAqBvb,KAGlCiT,EAAU1zB,UAAU+6B,cAAgB,SAAUp7B,EAAGC,GAC7C,GACIJ,GACAC,EACAqa,EAHA5a,EAASC,KAAKD,MAIlB,IAA+B,SAA3BA,EAAO6C,UAAUwC,MAAkB,CACnC,GAAIsH,OAAa,EAIjB,IAHI3M,EAAO6C,UAAUwC,QACjBsH,EAAa3M,EAAO6C,UAAUwC,MAAMuH,MAAM,MAEf,gBAA3B5M,EAAO6C,UAAUwC,OAA4BrF,EAAO6C,UAAUwC,OAA2B,SAAlBsH,EAAW,GAAgB,CAiBlG,GAhB+B,SAA3B3M,EAAO6C,UAAUwC,OAA+C,UAA3BrF,EAAO6C,UAAUwC,OAAgD,SAA3BrF,EAAO6C,UAAUwC,OAC1D,IAAlCrF,EAAO6C,UAAUgR,cAAsB5T,KAAK60B,UAAU10B,QAClDH,KAAK60B,UAAU10B,QAAUH,KAAK60B,UAAUz0B,SACxCJ,KAAK01B,cAAcl1B,EAAIR,KAAK60B,UAAU9sB,KACtC/H,KAAK01B,cAAcj1B,EAAIT,KAAK60B,UAAU7sB,KACtChI,KAAK60B,UAAU9sB,KAAOvH,EACtBR,KAAK60B,UAAU7sB,KAAOvH,GAE1BJ,EAASL,KAAK60B,UAAU9sB,KAAO/H,KAAK01B,cAAcl1B,EAClDF,EAAUN,KAAK60B,UAAU7sB,KAAOhI,KAAK01B,cAAcj1B,EACnDT,KAAKu4B,qBAAqBx4B,EAAO6C,UAAUC,YAAaxC,EAAOC,EAAQP,EAAO6C,UAAUgR,gBAGxF7T,EAAO6C,UAAUC,YAAYzC,OAASK,EACtCV,EAAO6C,UAAUC,YAAYvC,OAASP,EAAO6C,UAAUC,YAAYmF,KAAOjI,EAAO6C,UAAUC,YAAYzC,QAEvGL,EAAO6C,UAAUC,YAAYzC,OAASL,EAAO6C,UAAUC,YAAYmF,KAAM,CACzE,GAAItD,GAAO3E,EAAO6C,UAAUC,YAAYzC,MACxCL,GAAO6C,UAAUC,YAAYzC,OAASL,EAAO6C,UAAUC,YAAYmF,KACnEjI,EAAO6C,UAAUC,YAAYmF,KAAOtD,EACpC1E,KAAKu1B,YAAcv1B,KAAKo2B,eAAiB,WAE7Cp2B,KAAK08B,8BAEJ,CACD,GAAI38B,EAAO6C,UAAUC,YAAYkF,KAAOvH,GAAKT,EAAO6C,UAAUC,YAAYzC,OAASK,EAAG,CAClFJ,EAAQN,EAAO6C,UAAUC,YAAYkF,KAAOvH,EAC5CF,EAASG,EAAIV,EAAO6C,UAAUC,YAAYzC,OAC1Cua,EAAQxS,KAAK6Y,IAAI3gB,EAAOC,EACpBy8B,GAAW/8B,KAAK88B,cAAcniB,EAClC5a,GAAO6C,UAAUC,YAAYkF,MAAQg1B,EAASv8B,EAC9CT,EAAO6C,UAAUC,YAAYzC,QAAU28B,EAASt8B,GAC5CV,EAAO6C,UAAUC,YAAYkF,KAAQhI,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,WACtExD,EAAO6C,UAAUC,YAAYzC,OAASL,EAAOqD,IAAIE,WACjDvD,EAAO6C,UAAUC,YAAYkF,MAAQg1B,EAASv8B,EAC9CT,EAAO6C,UAAUC,YAAYzC,QAAU28B,EAASt8B,OAGnD,CACDJ,EAAQG,EAAIT,EAAO6C,UAAUC,YAAYkF,KACzCzH,EAASP,EAAO6C,UAAUC,YAAYzC,OAASK,EAC/Cka,EAAQxS,KAAK4Y,IAAI1gB,EAAOC,EACxB,IAAIy8B,GAAW/8B,KAAK88B,cAAcniB,EAClC5a,GAAO6C,UAAUC,YAAYkF,MAAQg1B,EAASv8B,EAC9CT,EAAO6C,UAAUC,YAAYzC,QAAU28B,EAASt8B,GAC5CV,EAAO6C,UAAUC,YAAYkF,KAAQhI,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,WACtExD,EAAO6C,UAAUC,YAAYzC,OAASL,EAAOqD,IAAIE,WACjDvD,EAAO6C,UAAUC,YAAYkF,MAAQg1B,EAASv8B,EAC9CT,EAAO6C,UAAUC,YAAYzC,QAAU28B,EAASt8B,GAGxDV,EAAO6C,UAAUC,YAAYxC,MAAQN,EAAO6C,UAAUC,YAAYkF,KAAOhI,EAAO6C,UAAUC,YAAY1C,OACtGJ,EAAO6C,UAAUC,YAAYvC,OAASP,EAAO6C,UAAUC,YAAYmF,KAAOjI,EAAO6C,UAAUC,YAAYzC,UAInHm0B,EAAU1zB,UAAUg7B,eAAiB,SAAUr7B,EAAGC,EAAGyD,GACjD,GAEI7D,GACAC,EACAqa,EACAqiB,EALAj9B,EAASC,KAAKD,OAMdk9B,EAAYj9B,KAAKw0B,UAAUh0B,EAC3B08B,EAAYl9B,KAAKw0B,UAAU/zB,EAC3B6gB,EAAgBtd,YAAWjE,EAAO6C,UAAW,MAAM,EACvD,IAA+B,SAA3B7C,EAAO6C,UAAUwC,UACOqO,KAApBzT,KAAKy0B,SAASj0B,OAAuCiT,KAApBzT,KAAKy0B,SAASh0B,GAC/CT,KAAKw0B,UAAUh0B,EAAIA,EAAIT,EAAO6C,UAAUC,YAAYkF,KACpD/H,KAAKw0B,UAAU/zB,EAAIV,EAAO6C,UAAUC,YAAYzC,OAASK,IAGzDT,KAAKw0B,UAAUh0B,EAAIA,EAAIR,KAAKy0B,SAASj0B,EACrCR,KAAKw0B,UAAU/zB,EAAIT,KAAKy0B,SAASh0B,EAAIA,GAEzCT,KAAKy0B,SAASj0B,EAAIA,EAClBR,KAAKy0B,SAASh0B,EAAIA,EAOlBu8B,GANIh9B,KAAKw0B,UAAUh0B,GAAKy8B,GAAaj9B,KAAKw0B,UAAU/zB,GAAKy8B,EAC9C/0B,KAAK6Y,IAAIhhB,KAAKw0B,UAAUh0B,EAAGR,KAAKw0B,UAAU/zB,GAG1C0H,KAAK4Y,IAAI/gB,KAAKw0B,UAAUh0B,EAAGR,KAAKw0B,UAAU/zB,IAEhC,GACrBV,EAAO6C,UAAUC,YAAYkF,MAAS7D,EAAa7D,MAAQ,IAAO28B,EAClEj9B,EAAO6C,UAAUC,YAAYzC,QAAW8D,EAAa5D,OAAS,IAAO08B,EACjEh9B,KAAK28B,gCACL58B,EAAO6C,UAAUC,YAAYkF,MAAS7D,EAAa7D,MAAQ,IAAO28B,EAClEj9B,EAAO6C,UAAUC,YAAYzC,QAAW8D,EAAa5D,OAAS,IAAO08B,GAEzEj9B,EAAO6C,UAAUC,YAAYxC,MAAQN,EAAO6C,UAAUC,YAAYkF,KAAOhI,EAAO6C,UAAUC,YAAY1C,OACtGJ,EAAO6C,UAAUC,YAAYvC,OAASP,EAAO6C,UAAUC,YAAYmF,KAAOjI,EAAO6C,UAAUC,YAAYzC,OACvGL,EAAO+C,OAAO,SAAWxB,KAAM,iBAAkByB,kBAAkB,EAC/DvB,OAASyC,IAAKlE,EAAO6C,iBAExB,CACD,GAAI8J,OAAa,EAIjB,IAHI3M,EAAO6C,UAAUwC,QACjBsH,EAAa3M,EAAO6C,UAAUwC,MAAMuH,MAAM,MAEf,gBAA3B5M,EAAO6C,UAAUwC,WAAuDqO,KAA3B1T,EAAO6C,UAAUwC,OAAyC,SAAlBsH,EAAW,GAAgB,CAEhH,GADA1M,KAAKs4B,eAAev4B,EAAO6C,UAAUC,YAAarC,EAAGC,EAAGV,EAAO6C,UAAUgR,cACrE7T,EAAO6C,UAAUC,YAAYkF,KAAOhI,EAAO6C,UAAUC,YAAY1C,OAAQ,CACrEuE,EAAO3E,EAAO6C,UAAUC,YAAYkF,IACxChI,GAAO6C,UAAUC,YAAYkF,KAAOhI,EAAO6C,UAAUC,YAAY1C,OACjEJ,EAAO6C,UAAUC,YAAY1C,OAASuE,EACtC1E,KAAKu1B,YAAcx1B,EAAOwC,YAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS,YAEzE,GAAI9d,EAAO6C,UAAUC,YAAYzC,OAASL,EAAO6C,UAAUC,YAAYmF,KAAM,CACzE,GAAItD,GAAO3E,EAAO6C,UAAUC,YAAYzC,MACxCL,GAAO6C,UAAUC,YAAYzC,OAASL,EAAO6C,UAAUC,YAAYmF,KACnEjI,EAAO6C,UAAUC,YAAYmF,KAAOtD,EACpC1E,KAAKu1B,YAAcx1B,EAAOwC,YAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS,YAEzE7d,KAAK08B,8BAGL,IAAI38B,EAAO6C,UAAUC,YAAYkF,KAAOvH,GAAKT,EAAO6C,UAAUC,YAAYzC,OAASK,EAAG,CAClFJ,EAAQN,EAAO6C,UAAUC,YAAYkF,KAAOvH,EAC5CF,EAASG,EAAIV,EAAO6C,UAAUC,YAAYzC,OAC1Cua,EAAQxS,KAAK6Y,IAAI3gB,EAAOC,EACpBy8B,GAAW/8B,KAAK88B,cAAcniB,EAClC5a,GAAO6C,UAAUC,YAAYkF,MAAQg1B,EAASv8B,EAC9CT,EAAO6C,UAAUC,YAAYzC,QAAU28B,EAASt8B,CAChD,IAAIsH,GAAOhI,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,UAAYxD,EAAOqC,YAAY/B,MACvEN,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,UAAYxD,EAAOqC,YAAY/B,MAChE2H,EAAOjI,EAAOqD,IAAIE,QAAU,EAAIvD,EAAOqD,IAAIE,QAAU,GACrDvD,EAAO6C,UAAUC,YAAYkF,KAAOA,GAAQhI,EAAO6C,UAAUC,YAAYzC,OAAS4H,KAClFjI,EAAO6C,UAAUC,YAAYkF,MAAQg1B,EAASv8B,EAC9CT,EAAO6C,UAAUC,YAAYzC,QAAU28B,EAASt8B,OAGnD,CACDJ,EAAQG,EAAIT,EAAO6C,UAAUC,YAAYkF,KACzCzH,EAASP,EAAO6C,UAAUC,YAAYzC,OAASK,EAC/Cka,EAAQxS,KAAK4Y,IAAI1gB,EAAOC,EACxB,IAAIy8B,GAAW/8B,KAAK88B,cAAcniB,EAClC5a,GAAO6C,UAAUC,YAAYkF,MAAQg1B,EAASv8B,EAC9CT,EAAO6C,UAAUC,YAAYzC,QAAU28B,EAASt8B,CAChD,IAAIsH,GAAOhI,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,UAAYxD,EAAOqC,YAAY/B,MACvEN,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,UAAYxD,EAAOqC,YAAY/B,MAChE2H,EAAOjI,EAAOqD,IAAIE,QAAU,EAAIvD,EAAOqD,IAAIE,QAAU,GACrDvD,EAAO6C,UAAUC,YAAYkF,KAAOA,GAAQhI,EAAO6C,UAAUC,YAAYzC,OAAS4H,KAClFjI,EAAO6C,UAAUC,YAAYkF,MAAQg1B,EAASv8B,EAC9CT,EAAO6C,UAAUC,YAAYzC,QAAU28B,EAASt8B,GAI5DV,EAAO6C,UAAUC,YAAYxC,MAAQN,EAAO6C,UAAUC,YAAYkF,KAAOhI,EAAO6C,UAAUC,YAAY1C,OACtGJ,EAAO6C,UAAUC,YAAYvC,OAASP,EAAO6C,UAAUC,YAAYmF,KAAOjI,EAAO6C,UAAUC,YAAYzC,OACvGJ,KAAK68B,qBAAqBvb,KAGlCiT,EAAU1zB,UAAUi7B,cAAgB,SAAUt7B,EAAGC,GAC7C,GACIJ,GACAC,EACAqa,EAHA5a,EAASC,KAAKD,MAIlB,IAA+B,SAA3BA,EAAO6C,UAAUwC,MAAkB,CACnC,GAAIsH,OAAa,EAIjB,IAHI3M,EAAO6C,UAAUwC,QACjBsH,EAAa3M,EAAO6C,UAAUwC,MAAMuH,MAAM,MAEf,gBAA3B5M,EAAO6C,UAAUwC,OAA4BrF,EAAO6C,UAAUwC,OAA2B,SAAlBsH,EAAW,GAAgB,CAiBlG,GAhB+B,SAA3B3M,EAAO6C,UAAUwC,OAA+C,UAA3BrF,EAAO6C,UAAUwC,OAAgD,SAA3BrF,EAAO6C,UAAUwC,OAC1D,IAAlCrF,EAAO6C,UAAUgR,cAAsB5T,KAAK60B,UAAU10B,QAClDH,KAAK60B,UAAU10B,QAAUH,KAAK60B,UAAUz0B,SACxCJ,KAAK01B,cAAcl1B,EAAIR,KAAK60B,UAAU9sB,KACtC/H,KAAK01B,cAAcj1B,EAAIT,KAAK60B,UAAU7sB,KACtChI,KAAK60B,UAAU9sB,KAAOvH,EACtBR,KAAK60B,UAAU7sB,KAAOvH,GAE1BJ,EAASL,KAAK60B,UAAU9sB,KAAO/H,KAAK01B,cAAcl1B,EAClDF,EAAUN,KAAK60B,UAAU7sB,KAAOhI,KAAK01B,cAAcj1B,EACnDT,KAAKu4B,qBAAqBx4B,EAAO6C,UAAUC,YAAaxC,EAAOC,EAAQP,EAAO6C,UAAUgR,gBAGxF7T,EAAO6C,UAAUC,YAAY1C,OAASK,EACtCT,EAAO6C,UAAUC,YAAYxC,MAAQN,EAAO6C,UAAUC,YAAYkF,KAAOhI,EAAO6C,UAAUC,YAAY1C,QAE3E,SAA3BJ,EAAO6C,UAAUwC,OAA+C,UAA3BrF,EAAO6C,UAAUwC,OAAgD,SAA3BrF,EAAO6C,UAAUwC,MAC5FrF,EAAO6C,UAAUC,YAAYzC,OAASK,EACtCV,EAAO6C,UAAUC,YAAYvC,OAASP,EAAO6C,UAAUC,YAAYmF,KAAOjI,EAAO6C,UAAUC,YAAYzC,OACnGJ,KAAKg4B,6BACLh4B,KAAKu1B,YAAc,WACwB,UAAvCx1B,EAAO6C,UAAU4U,kBACjBzX,EAAO6C,UAAU4U,kBAAoB,OAEO,SAAvCzX,EAAO6C,UAAU4U,oBACtBzX,EAAO6C,UAAU4U,kBAAoB,cAI5C,IAAIzX,EAAO6C,UAAUC,YAAY1C,OAASJ,EAAO6C,UAAUC,YAAYkF,KAAM,CAC9E,GAAIrD,GAAO3E,EAAO6C,UAAUC,YAAY1C,MACxCJ,GAAO6C,UAAUC,YAAY1C,OAASJ,EAAO6C,UAAUC,YAAYkF,KACnEhI,EAAO6C,UAAUC,YAAYkF,KAAOrD,EACpC1E,KAAKu1B,YAAcv1B,KAAKo2B,eAAiB,WAE7Cp2B,KAAK08B,8BAEJ,CACD,GAAI38B,EAAO6C,UAAUC,YAAY1C,OAASK,GAAKT,EAAO6C,UAAUC,YAAYmF,KAAOvH,EAAG,CAClFJ,EAAQG,EAAIT,EAAO6C,UAAUC,YAAY1C,OACzCG,EAASP,EAAO6C,UAAUC,YAAYmF,KAAOvH,EAC7Cka,EAAQxS,KAAK6Y,IAAI3gB,EAAOC,EACpBy8B,GAAW/8B,KAAK88B,cAAcniB,EAClC5a,GAAO6C,UAAUC,YAAY1C,QAAU48B,EAASv8B,EAChDT,EAAO6C,UAAUC,YAAYmF,MAAQ+0B,EAASt8B,GAC1CV,EAAO6C,UAAUC,YAAY1C,OAASJ,EAAOqD,IAAIC,UAAYtD,EAAO6C,UAAUC,YAAYmF,KACzFjI,EAAOqD,IAAIE,QAAUvD,EAAOqD,IAAII,cACjCzD,EAAO6C,UAAUC,YAAY1C,QAAU48B,EAASv8B,EAChDT,EAAO6C,UAAUC,YAAYmF,MAAQ+0B,EAASt8B,OAGjD,CACDJ,EAAQN,EAAO6C,UAAUC,YAAY1C,OAASK,EAC9CF,EAASG,EAAIV,EAAO6C,UAAUC,YAAYmF,KAC1C2S,EAAQxS,KAAK4Y,IAAI1gB,EAAOC,EACxB,IAAIy8B,GAAW/8B,KAAK88B,cAAcniB,EAClC5a,GAAO6C,UAAUC,YAAY1C,QAAU48B,EAASv8B,EAChDT,EAAO6C,UAAUC,YAAYmF,MAAQ+0B,EAASt8B,GAC1CV,EAAO6C,UAAUC,YAAY1C,OAASJ,EAAOqD,IAAIC,UAAYtD,EAAO6C,UAAUC,YAAYmF,KACzFjI,EAAOqD,IAAIE,QAAUvD,EAAOqD,IAAII,cACjCzD,EAAO6C,UAAUC,YAAY1C,QAAU48B,EAASv8B,EAChDT,EAAO6C,UAAUC,YAAYmF,MAAQ+0B,EAASt8B,GAGtDV,EAAO6C,UAAUC,YAAYxC,MAAQN,EAAO6C,UAAUC,YAAYkF,KAAOhI,EAAO6C,UAAUC,YAAY1C,OACtGJ,EAAO6C,UAAUC,YAAYvC,OAASP,EAAO6C,UAAUC,YAAYmF,KAAOjI,EAAO6C,UAAUC,YAAYzC,UAInHm0B,EAAU1zB,UAAUk7B,cAAgB,SAAUv7B,EAAGC,GAC7C,GACIJ,GACAC,EACAqa,EAHA5a,EAASC,KAAKD,MAIlB,IAA+B,SAA3BA,EAAO6C,UAAUwC,MAAkB,CACnC,GAAIsH,OAAa,EAIjB,IAHI3M,EAAO6C,UAAUwC,QACjBsH,EAAa3M,EAAO6C,UAAUwC,MAAMuH,MAAM,MAEf,gBAA3B5M,EAAO6C,UAAUwC,OAA4BrF,EAAO6C,UAAUwC,OAA2B,SAAlBsH,EAAW,GAAgB,CAiBlG,GAhB+B,SAA3B3M,EAAO6C,UAAUwC,OAA+C,UAA3BrF,EAAO6C,UAAUwC,OAAgD,SAA3BrF,EAAO6C,UAAUwC,OAC1D,IAAlCrF,EAAO6C,UAAUgR,cAAsB5T,KAAK60B,UAAU10B,QAClDH,KAAK60B,UAAU10B,QAAUH,KAAK60B,UAAUz0B,SACxCJ,KAAK01B,cAAcl1B,EAAIR,KAAK60B,UAAU9sB,KACtC/H,KAAK01B,cAAcj1B,EAAIT,KAAK60B,UAAU7sB,KACtChI,KAAK60B,UAAU9sB,KAAOvH,EACtBR,KAAK60B,UAAU7sB,KAAOvH,GAE1BJ,EAASL,KAAK60B,UAAU9sB,KAAO/H,KAAK01B,cAAcl1B,EAClDF,EAAUN,KAAK60B,UAAU7sB,KAAOhI,KAAK01B,cAAcj1B,EACnDT,KAAKu4B,qBAAqBx4B,EAAO6C,UAAUC,YAAaxC,EAAOC,EAAQP,EAAO6C,UAAUgR,gBAGxF7T,EAAO6C,UAAUC,YAAYkF,KAAOvH,EACpCT,EAAO6C,UAAUC,YAAYxC,MAAQN,EAAO6C,UAAUC,YAAYkF,KAAOhI,EAAO6C,UAAUC,YAAY1C,QAE3E,SAA3BJ,EAAO6C,UAAUwC,OAA+C,UAA3BrF,EAAO6C,UAAUwC,OAAgD,SAA3BrF,EAAO6C,UAAUwC,MAC5FrF,EAAO6C,UAAUC,YAAYmF,KAAOvH,EACpCV,EAAO6C,UAAUC,YAAYvC,OAASP,EAAO6C,UAAUC,YAAYmF,KAAOjI,EAAO6C,UAAUC,YAAYzC,OACnGJ,KAAKg4B,6BACLh4B,KAAKu1B,YAAc,WACwB,UAAvCx1B,EAAO6C,UAAU4U,kBACjBzX,EAAO6C,UAAU4U,kBAAoB,OAEO,SAAvCzX,EAAO6C,UAAU4U,oBACtBzX,EAAO6C,UAAU4U,kBAAoB,cAI5C,IAAIzX,EAAO6C,UAAUC,YAAYkF,KAAOhI,EAAO6C,UAAUC,YAAY1C,OAAQ,CAC9E,GAAIuE,GAAO3E,EAAO6C,UAAUC,YAAYkF,IACxChI,GAAO6C,UAAUC,YAAYkF,KAAOhI,EAAO6C,UAAUC,YAAY1C,OACjEJ,EAAO6C,UAAUC,YAAY1C,OAASuE,EACtC1E,KAAKu1B,YAAcv1B,KAAKo2B,eAAiB,WAE7Cp2B,KAAK08B,8BAEJ,CACD,GAAI38B,EAAO6C,UAAUC,YAAYkF,KAAOvH,GAAKT,EAAO6C,UAAUC,YAAYmF,KAAOvH,EAAG,CAChFJ,EAAQN,EAAO6C,UAAUC,YAAYkF,KAAOvH,EAC5CF,EAASP,EAAO6C,UAAUC,YAAYmF,KAAOvH,EAC7Cka,EAAQxS,KAAK6Y,IAAI3gB,EAAOC,EACpBy8B,GAAW/8B,KAAK88B,cAAcniB,EAClC5a,GAAO6C,UAAUC,YAAYkF,MAAQg1B,EAASv8B,EAC9CT,EAAO6C,UAAUC,YAAYmF,MAAQ+0B,EAASt8B,GAC1CV,EAAO6C,UAAUC,YAAYkF,KAAQhI,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,WACtExD,EAAO6C,UAAUC,YAAYmF,KAAQjI,EAAOqD,IAAIE,QAAUvD,EAAOqD,IAAII,cACrEzD,EAAO6C,UAAUC,YAAYkF,MAAQg1B,EAASv8B,EAC9CT,EAAO6C,UAAUC,YAAYmF,MAAQ+0B,EAASt8B,OAGjD,CACDJ,EAAQG,EAAIT,EAAO6C,UAAUC,YAAYkF,KACzCzH,EAASG,EAAIV,EAAO6C,UAAUC,YAAYmF,KAC1C2S,EAAQxS,KAAK4Y,IAAI1gB,EAAOC,EACxB,IAAIy8B,GAAW/8B,KAAK88B,cAAcniB,EAClC5a,GAAO6C,UAAUC,YAAYkF,MAAQg1B,EAASv8B,EAC9CT,EAAO6C,UAAUC,YAAYmF,MAAQ+0B,EAASt8B,GAC1CV,EAAO6C,UAAUC,YAAYkF,KAAQhI,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,WACtExD,EAAO6C,UAAUC,YAAYmF,KAAQjI,EAAOqD,IAAIE,QAAUvD,EAAOqD,IAAII,cACrEzD,EAAO6C,UAAUC,YAAYkF,MAAQg1B,EAASv8B,EAC9CT,EAAO6C,UAAUC,YAAYmF,MAAQ+0B,EAASt8B,GAGtDV,EAAO6C,UAAUC,YAAYxC,MAAQN,EAAO6C,UAAUC,YAAYkF,KAAOhI,EAAO6C,UAAUC,YAAY1C,OACtGJ,EAAO6C,UAAUC,YAAYvC,OAASP,EAAO6C,UAAUC,YAAYmF,KAAOjI,EAAO6C,UAAUC,YAAYzC,UAInHm0B,EAAU1zB,UAAUm7B,eAAiB,SAAUx7B,EAAGC,EAAGyD,GACjD,GAEI7D,GACAC,EACAqa,EACAqiB,EALAj9B,EAASC,KAAKD,OAMdk9B,EAAYj9B,KAAKw0B,UAAUh0B,EAC3B08B,EAAYl9B,KAAKw0B,UAAU/zB,EAC3B6gB,EAAgBtd,YAAWjE,EAAO6C,UAAW,MAAM,EACvD,IAA+B,SAA3B7C,EAAO6C,UAAUwC,MACbnD,oBAAkBjC,KAAKy0B,SAASj0B,IAAMyB,oBAAkBjC,KAAKy0B,SAASh0B,IACtET,KAAKw0B,UAAUh0B,EAAIT,EAAO6C,UAAUC,YAAY1C,OAASK,EACzDR,KAAKw0B,UAAU/zB,EAAIA,EAAIV,EAAO6C,UAAUC,YAAYmF,OAGpDhI,KAAKw0B,UAAUh0B,EAAIR,KAAKy0B,SAASj0B,EAAIA,EACrCR,KAAKw0B,UAAU/zB,EAAIA,EAAIT,KAAKy0B,SAASh0B,GAEzCT,KAAKy0B,SAASj0B,EAAIA,EAClBR,KAAKy0B,SAASh0B,EAAIA,EAOlBu8B,GANIh9B,KAAKw0B,UAAUh0B,GAAKy8B,GAAaj9B,KAAKw0B,UAAU/zB,GAAKy8B,EAC9C/0B,KAAK6Y,IAAIhhB,KAAKw0B,UAAUh0B,EAAGR,KAAKw0B,UAAU/zB,GAG1C0H,KAAK4Y,IAAI/gB,KAAKw0B,UAAUh0B,EAAGR,KAAKw0B,UAAU/zB,IAEhC,GACrBV,EAAO6C,UAAUC,YAAY1C,QAAW+D,EAAa7D,MAAQ,IAAO28B,EACpEj9B,EAAO6C,UAAUC,YAAYmF,MAAS9D,EAAa5D,OAAS,IAAO08B,EAC/Dh9B,KAAK28B,gCACL58B,EAAO6C,UAAUC,YAAY1C,QAAW+D,EAAa7D,MAAQ,IAAO28B,EACpEj9B,EAAO6C,UAAUC,YAAYmF,MAAS9D,EAAa5D,OAAS,IAAO08B,GAEvEj9B,EAAO6C,UAAUC,YAAYxC,MAAQN,EAAO6C,UAAUC,YAAYkF,KAAOhI,EAAO6C,UAAUC,YAAY1C,OACtGJ,EAAO6C,UAAUC,YAAYvC,OAASP,EAAO6C,UAAUC,YAAYmF,KAAOjI,EAAO6C,UAAUC,YAAYzC,OACvGL,EAAO+C,OAAO,SAAWxB,KAAM,iBAAkByB,kBAAkB,EAC/DvB,OAASyC,IAAKlE,EAAO6C,iBAExB,CACD,GAAI8J,OAAa,EAIjB,QAH+B+G,KAA3B1T,EAAO6C,UAAUwC,QACjBsH,EAAa3M,EAAO6C,UAAUwC,MAAMuH,MAAM,MAEf,gBAA3B5M,EAAO6C,UAAUwC,WAAuDqO,KAA3B1T,EAAO6C,UAAUwC,OAAyC,SAAlBsH,EAAW,GAAgB,CAEhH,GADA1M,KAAKq9B,eAAet9B,EAAO6C,UAAUC,YAAarC,EAAGC,EAAGV,EAAO6C,UAAUgR,cACrE7T,EAAO6C,UAAUC,YAAY1C,OAASJ,EAAO6C,UAAUC,YAAYkF,KAAM,CACrErD,EAAO3E,EAAO6C,UAAUC,YAAY1C,MACxCJ,GAAO6C,UAAUC,YAAY1C,OAASJ,EAAO6C,UAAUC,YAAYkF,KACnEhI,EAAO6C,UAAUC,YAAYkF,KAAOrD,EACpC1E,KAAKu1B,YAAcx1B,EAAOwC,YAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS,YAEzE,GAAI9d,EAAO6C,UAAUC,YAAYmF,KAAOjI,EAAO6C,UAAUC,YAAYzC,OAAQ,CACzE,GAAIsE,GAAO3E,EAAO6C,UAAUC,YAAYmF,IACxCjI,GAAO6C,UAAUC,YAAYmF,KAAOjI,EAAO6C,UAAUC,YAAYzC,OACjEL,EAAO6C,UAAUC,YAAYzC,OAASsE,EACtC1E,KAAKu1B,YAAcx1B,EAAOwC,YAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS,YAEzE7d,KAAK08B,8BAGL,IAAI38B,EAAO6C,UAAUC,YAAY1C,OAASK,GAAKT,EAAO6C,UAAUC,YAAYmF,KAAOvH,EAAG,CAClFJ,EAAQG,EAAIT,EAAO6C,UAAUC,YAAY1C,OACzCG,EAASP,EAAO6C,UAAUC,YAAYmF,KAAOvH,EAC7Cka,EAAQxS,KAAK6Y,IAAI3gB,EAAOC,EACpBy8B,GAAW/8B,KAAK88B,cAAcniB,EAClC5a,GAAO6C,UAAUC,YAAY1C,QAAU48B,EAASv8B,EAChDT,EAAO6C,UAAUC,YAAYmF,MAAQ+0B,EAASt8B,CAC9C,IAAIsH,GAAOhI,EAAOqD,IAAIC,SAAW,EAAItD,EAAOqD,IAAIC,SAAW,EACvD2E,EAAOjI,EAAOqD,IAAIE,QAAUvD,EAAOqD,IAAII,WAAazD,EAAOqC,YAAY9B,OAASP,EAAOqD,IAAIE,QAC3FvD,EAAOqD,IAAII,WAAazD,EAAOqC,YAAY9B,QAC3CP,EAAO6C,UAAUC,YAAY1C,OAAS4H,GAAQhI,EAAO6C,UAAUC,YAAYmF,KAAOA,KAClFjI,EAAO6C,UAAUC,YAAY1C,QAAU48B,EAASv8B,EAChDT,EAAO6C,UAAUC,YAAYmF,MAAQ+0B,EAASt8B,OAGjD,CACDJ,EAAQN,EAAO6C,UAAUC,YAAY1C,OAASK,EAC9CF,EAASG,EAAIV,EAAO6C,UAAUC,YAAYmF,KAC1C2S,EAAQxS,KAAK4Y,IAAI1gB,EAAOC,EACxB,IAAIy8B,GAAW/8B,KAAK88B,cAAcniB,EAClC5a,GAAO6C,UAAUC,YAAY1C,QAAU48B,EAASv8B,EAChDT,EAAO6C,UAAUC,YAAYmF,MAAQ+0B,EAASt8B,CAC9C,IAAIsH,GAAOhI,EAAOqD,IAAIC,SAAW,EAAItD,EAAOqD,IAAIC,SAAW,EACvD2E,EAAOjI,EAAOqD,IAAIE,QAAUvD,EAAOqD,IAAII,WAAazD,EAAOqC,YAAY9B,OAASP,EAAOqD,IAAIE,QAC3FvD,EAAOqD,IAAII,WAAazD,EAAOqC,YAAY9B,QAC3CP,EAAO6C,UAAUC,YAAY1C,OAAS4H,GAAQhI,EAAO6C,UAAUC,YAAYmF,KAAOA,KAClFjI,EAAO6C,UAAUC,YAAY1C,QAAU48B,EAASv8B,EAChDT,EAAO6C,UAAUC,YAAYmF,MAAQ+0B,EAASt8B,GAI1DV,EAAO6C,UAAUC,YAAYxC,MAAQN,EAAO6C,UAAUC,YAAYkF,KAAOhI,EAAO6C,UAAUC,YAAY1C,OACtGJ,EAAO6C,UAAUC,YAAYvC,OAASP,EAAO6C,UAAUC,YAAYmF,KAAOjI,EAAO6C,UAAUC,YAAYzC,OACvGJ,KAAK68B,qBAAqBvb,KAGlCiT,EAAU1zB,UAAUo7B,cAAgB,SAAUz7B,EAAGC,GAC7C,GACIJ,GACAC,EACAqa,EAHA5a,EAASC,KAAKD,MAIlB,IAA+B,SAA3BA,EAAO6C,UAAUwC,MAAkB,CACnC,GAAIsH,OAAa,EAIjB,IAHI3M,EAAO6C,UAAUwC,QACjBsH,EAAa3M,EAAO6C,UAAUwC,MAAMuH,MAAM,MAEf,gBAA3B5M,EAAO6C,UAAUwC,OAA4BrF,EAAO6C,UAAUwC,OAA2B,SAAlBsH,EAAW,GAAgB,CAiBlG,GAhB+B,SAA3B3M,EAAO6C,UAAUwC,OAA+C,UAA3BrF,EAAO6C,UAAUwC,OAAgD,SAA3BrF,EAAO6C,UAAUwC,OAC1D,IAAlCrF,EAAO6C,UAAUgR,cAAsB5T,KAAK60B,UAAU10B,QAClDH,KAAK60B,UAAU10B,QAAUH,KAAK60B,UAAUz0B,SACxCJ,KAAK01B,cAAcl1B,EAAIR,KAAK60B,UAAU9sB,KACtC/H,KAAK01B,cAAcj1B,EAAIT,KAAK60B,UAAU7sB,KACtChI,KAAK60B,UAAU9sB,KAAOvH,EACtBR,KAAK60B,UAAU7sB,KAAOvH,GAE1BJ,EAASL,KAAK60B,UAAU9sB,KAAO/H,KAAK01B,cAAcl1B,EAClDF,EAAUN,KAAK60B,UAAU7sB,KAAOhI,KAAK01B,cAAcj1B,EACnDT,KAAKu4B,qBAAqBx4B,EAAO6C,UAAUC,YAAaxC,EAAOC,EAAQP,EAAO6C,UAAUgR,gBAGxF7T,EAAO6C,UAAUC,YAAYmF,KAAOvH,EACpCV,EAAO6C,UAAUC,YAAYvC,OAASP,EAAO6C,UAAUC,YAAYmF,KAAOjI,EAAO6C,UAAUC,YAAYzC,QAEvGL,EAAO6C,UAAUC,YAAYmF,KAAOjI,EAAO6C,UAAUC,YAAYzC,OAAQ,CACzE,GAAIsE,GAAO3E,EAAO6C,UAAUC,YAAYmF,IACxCjI,GAAO6C,UAAUC,YAAYmF,KAAOjI,EAAO6C,UAAUC,YAAYzC,OACjEL,EAAO6C,UAAUC,YAAYzC,OAASsE,EACtC1E,KAAKu1B,YAAcv1B,KAAKo2B,eAAiB,WAE7Cp2B,KAAK08B,8BAEJ,CACD,GAAI38B,EAAO6C,UAAUC,YAAYkF,KAAOvH,GAAKT,EAAO6C,UAAUC,YAAYmF,KAAOvH,EAAG,CAChFJ,EAAQN,EAAO6C,UAAUC,YAAYkF,KAAOvH,EAC5CF,EAASP,EAAO6C,UAAUC,YAAYmF,KAAOvH,EAC7Cka,EAAQxS,KAAK6Y,IAAI3gB,EAAOC,EACpBy8B,GAAW/8B,KAAK88B,cAAcniB,EAClC5a,GAAO6C,UAAUC,YAAYkF,MAAQg1B,EAASv8B,EAC9CT,EAAO6C,UAAUC,YAAYmF,MAAQ+0B,EAASt8B,GAC1CV,EAAO6C,UAAUC,YAAYkF,KAAQhI,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,WACtExD,EAAO6C,UAAUC,YAAYmF,KAAQjI,EAAOqD,IAAIE,QAAUvD,EAAOqD,IAAII,cACrEzD,EAAO6C,UAAUC,YAAYkF,MAAQg1B,EAASv8B,EAC9CT,EAAO6C,UAAUC,YAAYmF,MAAQ+0B,EAASt8B,OAGjD,CACDJ,EAAQG,EAAIT,EAAO6C,UAAUC,YAAYkF,KACzCzH,EAASG,EAAIV,EAAO6C,UAAUC,YAAYmF,KAC1C2S,EAAQxS,KAAK4Y,IAAI1gB,EAAOC,EACxB,IAAIy8B,GAAW/8B,KAAK88B,cAAcniB,EAClC5a,GAAO6C,UAAUC,YAAYkF,MAAQg1B,EAASv8B,EAC9CT,EAAO6C,UAAUC,YAAYmF,MAAQ+0B,EAASv8B,GAC1CT,EAAO6C,UAAUC,YAAYkF,KAAQhI,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,WACtExD,EAAO6C,UAAUC,YAAYmF,KAAQjI,EAAOqD,IAAIE,QAAUvD,EAAOqD,IAAII,cACrEzD,EAAO6C,UAAUC,YAAYkF,MAAQg1B,EAASv8B,EAC9CT,EAAO6C,UAAUC,YAAYmF,MAAQ+0B,EAASt8B,GAGtDV,EAAO6C,UAAUC,YAAYxC,MAAQN,EAAO6C,UAAUC,YAAYkF,KAAOhI,EAAO6C,UAAUC,YAAY1C,OACtGJ,EAAO6C,UAAUC,YAAYvC,OAASP,EAAO6C,UAAUC,YAAYmF,KAAOjI,EAAO6C,UAAUC,YAAYzC,UAInHm0B,EAAU1zB,UAAUq7B,eAAiB,SAAU17B,EAAGC,EAAGyD,GACjD,GAEI7D,GACAC,EACAqa,EACAqiB,EALAj9B,EAASC,KAAKD,OAMdk9B,EAAYj9B,KAAKw0B,UAAUh0B,EAC3B08B,EAAYl9B,KAAKw0B,UAAU/zB,EAC3B6gB,EAAgBtd,YAAWjE,EAAO6C,UAAW,MAAM,EACvD,IAA+B,SAA3B7C,EAAO6C,UAAUwC,UACOqO,KAApBzT,KAAKy0B,SAASj0B,OAAuCiT,KAApBzT,KAAKy0B,SAASh0B,GAC/CT,KAAKw0B,UAAUh0B,EAAIA,EAAIT,EAAO6C,UAAUC,YAAYkF,KACpD/H,KAAKw0B,UAAU/zB,EAAIA,EAAIV,EAAO6C,UAAUC,YAAYmF,OAGpDhI,KAAKw0B,UAAUh0B,EAAIA,EAAIR,KAAKy0B,SAASj0B,EACrCR,KAAKw0B,UAAU/zB,EAAIA,EAAIT,KAAKy0B,SAASh0B,GAEzCT,KAAKy0B,SAASj0B,EAAIA,EAClBR,KAAKy0B,SAASh0B,EAAIA,EAOlBu8B,GANIh9B,KAAKw0B,UAAUh0B,GAAKy8B,GAAaj9B,KAAKw0B,UAAU/zB,GAAKy8B,EAC9C/0B,KAAK4Y,IAAI/gB,KAAKw0B,UAAUh0B,EAAGR,KAAKw0B,UAAU/zB,GAG1C0H,KAAK6Y,IAAIhhB,KAAKw0B,UAAUh0B,EAAGR,KAAKw0B,UAAU/zB,IAEhC,GACrBV,EAAO6C,UAAUC,YAAYkF,MAAS7D,EAAa7D,MAAQ,GAAM28B,EACjEj9B,EAAO6C,UAAUC,YAAYmF,MAAS9D,EAAa5D,OAAS,GAAM08B,EAC9Dh9B,KAAK28B,gCACL58B,EAAO6C,UAAUC,YAAYkF,MAAS7D,EAAa7D,MAAQ,GAAM28B,EACjEj9B,EAAO6C,UAAUC,YAAYmF,MAAS9D,EAAa5D,OAAS,GAAM08B,GAEtEj9B,EAAO6C,UAAUC,YAAYxC,MAAQN,EAAO6C,UAAUC,YAAYkF,KAAOhI,EAAO6C,UAAUC,YAAY1C,OACtGJ,EAAO6C,UAAUC,YAAYvC,OAASP,EAAO6C,UAAUC,YAAYmF,KAAOjI,EAAO6C,UAAUC,YAAYzC,OACvGL,EAAO+C,OAAO,SAAWxB,KAAM,iBAAkByB,kBAAkB,EAC/DvB,OAASyC,IAAKlE,EAAO6C,iBAExB,CACD,GAAI8J,OAAa,EAIjB,QAH+B+G,KAA3B1T,EAAO6C,UAAUwC,QACjBsH,EAAa3M,EAAO6C,UAAUwC,MAAMuH,MAAM,MAEf,gBAA3B5M,EAAO6C,UAAUwC,WAAuDqO,KAA3B1T,EAAO6C,UAAUwC,OAAyC,SAAlBsH,EAAW,GAAgB,CAEhH,GADA1M,KAAKs9B,eAAev9B,EAAO6C,UAAUC,YAAarC,EAAGC,EAAGV,EAAO6C,UAAUgR,cACrE7T,EAAO6C,UAAUC,YAAYkF,KAAOhI,EAAO6C,UAAUC,YAAY1C,OAAQ,CACrEuE,EAAO3E,EAAO6C,UAAUC,YAAYkF,IACxChI,GAAO6C,UAAUC,YAAYkF,KAAOhI,EAAO6C,UAAUC,YAAY1C,OACjEJ,EAAO6C,UAAUC,YAAY1C,OAASuE,EACtC1E,KAAKu1B,YAAcx1B,EAAOwC,YAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS,YAEzE,GAAI9d,EAAO6C,UAAUC,YAAYmF,KAAOjI,EAAO6C,UAAUC,YAAYzC,OAAQ,CACzE,GAAIsE,GAAO3E,EAAO6C,UAAUC,YAAYmF,IACxCjI,GAAO6C,UAAUC,YAAYmF,KAAOjI,EAAO6C,UAAUC,YAAYzC,OACjEL,EAAO6C,UAAUC,YAAYzC,OAASsE,EACtC1E,KAAKu1B,YAAcx1B,EAAOwC,YAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS,YAEzE7d,KAAK08B,8BAGL,IAAI38B,EAAO6C,UAAUC,YAAYkF,KAAOvH,GAAKT,EAAO6C,UAAUC,YAAYmF,KAAOvH,EAAG,CAChFJ,EAAQN,EAAO6C,UAAUC,YAAYkF,KAAOvH,EAC5CF,EAASP,EAAO6C,UAAUC,YAAYmF,KAAOvH,EAC7Cka,EAAQxS,KAAK6Y,IAAI3gB,EAAOC,EACpBy8B,GAAW/8B,KAAK88B,cAAcniB,EAClC5a,GAAO6C,UAAUC,YAAYkF,MAAQg1B,EAASv8B,EAC9CT,EAAO6C,UAAUC,YAAYmF,MAAQ+0B,EAASt8B,CAC9C,IAAIsH,GAAOhI,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,UAAYxD,EAAOqC,YAAY/B,MACvEN,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,UAAYxD,EAAOqC,YAAY/B,MAChE2H,EAAOjI,EAAOqD,IAAIE,QAAUvD,EAAOqD,IAAII,WAAazD,EAAOqC,YAAY9B,OACvEP,EAAOqD,IAAIE,QAAUvD,EAAOqD,IAAII,WAAazD,EAAOqC,YAAY9B,QAChEP,EAAO6C,UAAUC,YAAYkF,KAAOA,GAAQhI,EAAO6C,UAAUC,YAAYmF,KAAOA,KAChFjI,EAAO6C,UAAUC,YAAYkF,MAAQg1B,EAASv8B,EAC9CT,EAAO6C,UAAUC,YAAYmF,MAAQ+0B,EAASt8B,OAGjD,CACDJ,EAAQG,EAAIT,EAAO6C,UAAUC,YAAYkF,KACzCzH,EAASG,EAAIV,EAAO6C,UAAUC,YAAYmF,KAC1C2S,EAAQxS,KAAK4Y,IAAI1gB,EAAOC,EACxB,IAAIy8B,GAAW/8B,KAAK88B,cAAcniB,EAClC5a,GAAO6C,UAAUC,YAAYkF,MAAQg1B,EAASv8B,EAC9CT,EAAO6C,UAAUC,YAAYmF,MAAQ+0B,EAASt8B,CAC9C,IAAIsH,GAAOhI,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,UAAYxD,EAAOqC,YAAY/B,MAAQN,EAAOqD,IAAIC,SAC1FtD,EAAOqD,IAAIG,UAAYxD,EAAOqC,YAAY/B,MAC1C2H,EAAOjI,EAAOqD,IAAIE,QAAUvD,EAAOqD,IAAII,WAAazD,EAAOqC,YAAY9B,OAASP,EAAOqD,IAAIE,QAC3FvD,EAAOqD,IAAII,WAAazD,EAAOqC,YAAY9B,QAC3CP,EAAO6C,UAAUC,YAAYkF,KAAOA,GAAQhI,EAAO6C,UAAUC,YAAYmF,KAAOA,KAChFjI,EAAO6C,UAAUC,YAAYkF,MAAQg1B,EAASv8B,EAC9CT,EAAO6C,UAAUC,YAAYmF,MAAQ+0B,EAASt8B,GAI1DV,EAAO6C,UAAUC,YAAYxC,MAAQN,EAAO6C,UAAUC,YAAYkF,KAAOhI,EAAO6C,UAAUC,YAAY1C,OACtGJ,EAAO6C,UAAUC,YAAYvC,OAASP,EAAO6C,UAAUC,YAAYmF,KAAOjI,EAAO6C,UAAUC,YAAYzC,OACvGJ,KAAK68B,qBAAqBvb,KAGlCiT,EAAU1zB,UAAUs8B,eAAiB,SAAUI,EAAW/8B,EAAGC,EAAGsY,GAC5D,GAAIykB,GAAKD,EAAUp9B,OAASo9B,EAAUl9B,MAAQ,EAC1Co9B,EAAKF,EAAUn9B,OAASm9B,EAAUj9B,OAAS,EAC3Co9B,EAAW19B,KAAK29B,aAAaJ,EAAUx1B,KAAMw1B,EAAUv1B,KAAMw1B,EAAIC,EAAI1kB,GACrE6kB,IAAcF,EAAS,GAAKl9B,GAAK,GAAIk9B,EAAS,GAAKj9B,GAAK,GACxDo9B,EAAiB79B,KAAK29B,aAAaD,EAAS,GAAIA,EAAS,GAAIE,EAAU,GAAIA,EAAU,IAAK7kB,GAC1F+kB,EAAa99B,KAAK29B,aAAan9B,EAAGC,EAAGm9B,EAAU,GAAIA,EAAU,IAAK7kB,EAOtE,OANAwkB,GAAUx1B,KAAO81B,EAAe,GAChCN,EAAUv1B,KAAO61B,EAAe,GAChCN,EAAUn9B,OAAS09B,EAAW,GAC9BP,EAAUp9B,OAAS29B,EAAW,GAC9BP,EAAUl9B,MAAQk9B,EAAUx1B,KAAOw1B,EAAUp9B,OAC7Co9B,EAAUj9B,OAASi9B,EAAUv1B,KAAOu1B,EAAUn9B,OACvCm9B,GAEXhJ,EAAU1zB,UAAUy3B,eAAiB,SAAUiF,EAAW/8B,EAAGC,EAAGsY,GAC5D,GAAIykB,GAAKD,EAAUp9B,OAASo9B,EAAUl9B,MAAQ,EAC1Co9B,EAAKF,EAAUn9B,OAASm9B,EAAUj9B,OAAS,EAC3Cy9B,EAAW/9B,KAAK29B,aAAaJ,EAAUp9B,OAAQo9B,EAAUv1B,KAAMw1B,EAAIC,EAAI1kB,GACvE6kB,IAAcG,EAAS,GAAKv9B,GAAK,GAAIu9B,EAAS,GAAKt9B,GAAK,GACxDu9B,EAAgBh+B,KAAK29B,aAAaI,EAAS,GAAIA,EAAS,GAAIH,EAAU,GAAIA,EAAU,IAAK7kB,GACzFklB,EAAcj+B,KAAK29B,aAAan9B,EAAGC,EAAGm9B,EAAU,GAAIA,EAAU,IAAK7kB,EAOvE,OANAwkB,GAAUp9B,OAAS69B,EAAc,GACjCT,EAAUv1B,KAAOg2B,EAAc,GAC/BT,EAAUl9B,MAAQ49B,EAAY,GAAKD,EAAc,GACjDT,EAAUj9B,OAAS09B,EAAc,GAAKC,EAAY,GAClDV,EAAUx1B,KAAOw1B,EAAUp9B,OAASo9B,EAAUl9B,MAC9Ck9B,EAAUn9B,OAASm9B,EAAUv1B,KAAOu1B,EAAUj9B,OACvCi9B,GAEXhJ,EAAU1zB,UAAUw8B,eAAiB,SAAUE,EAAW/8B,EAAGC,EAAGsY,GAC5D,GAAIykB,GAAKD,EAAUp9B,OAASo9B,EAAUl9B,MAAQ,EAC1Co9B,EAAKF,EAAUn9B,OAASm9B,EAAUj9B,OAAS,EAC3C49B,EAAWl+B,KAAK29B,aAAaJ,EAAUx1B,KAAMw1B,EAAUn9B,OAAQo9B,EAAIC,EAAI1kB,GACvE6kB,IAAcM,EAAS,GAAK19B,GAAK,GAAI09B,EAAS,GAAKz9B,GAAK,GACxDw9B,EAAcj+B,KAAK29B,aAAaO,EAAS,GAAIA,EAAS,GAAIN,EAAU,GAAIA,EAAU,IAAK7kB,GACvFilB,EAAgBh+B,KAAK29B,aAAan9B,EAAGC,EAAGm9B,EAAU,GAAIA,EAAU,IAAK7kB,EAOzE,OANAwkB,GAAUx1B,KAAOk2B,EAAY,GAC7BV,EAAUn9B,OAAS69B,EAAY,GAC/BV,EAAUp9B,OAAS69B,EAAc,GACjCT,EAAUv1B,KAAOg2B,EAAc,GAC/BT,EAAUl9B,MAAQk9B,EAAUx1B,KAAOw1B,EAAUp9B,OAC7Co9B,EAAUj9B,OAASi9B,EAAUv1B,KAAOu1B,EAAUn9B,OACvCm9B,GAEXhJ,EAAU1zB,UAAUy8B,eAAiB,SAAUC,EAAW/8B,EAAGC,EAAGsY,GAC5D,GAAIykB,GAAKD,EAAUp9B,OAASo9B,EAAUl9B,MAAQ,EAC1Co9B,EAAKF,EAAUn9B,OAASm9B,EAAUj9B,OAAS,EAC3C69B,EAAWn+B,KAAK29B,aAAaJ,EAAUp9B,OAAQo9B,EAAUn9B,OAAQo9B,EAAIC,EAAI1kB,GACzE6kB,IAAcO,EAAS,GAAK39B,GAAK,GAAI29B,EAAS,GAAK19B,GAAK,GACxDq9B,EAAa99B,KAAK29B,aAAaQ,EAAS,GAAIA,EAAS,GAAIP,EAAU,GAAIA,EAAU,IAAK7kB,GACtF8kB,EAAiB79B,KAAK29B,aAAan9B,EAAGC,EAAGm9B,EAAU,GAAIA,EAAU,IAAK7kB,EAO1E,OANAwkB,GAAUp9B,OAAS29B,EAAW,GAC9BP,EAAUn9B,OAAS09B,EAAW,GAC9BP,EAAUl9B,MAAQw9B,EAAe,GAAKC,EAAW,GACjDP,EAAUj9B,OAASu9B,EAAe,GAAKC,EAAW,GAClDP,EAAUx1B,KAAOw1B,EAAUp9B,OAASo9B,EAAUl9B,MAC9Ck9B,EAAUv1B,KAAOu1B,EAAUn9B,OAASm9B,EAAUj9B,OACvCi9B,GAEXhJ,EAAU1zB,UAAU03B,qBAAuB,SAAUgF,EAAW/8B,EAAGC,EAAGsY,GAClE,GAAIykB,GAAKD,EAAUp9B,OAASo9B,EAAUl9B,MAAQ,EAC1Co9B,EAAKF,EAAUn9B,OAASm9B,EAAUj9B,OAAS,CAC/CN,MAAKw4B,mBAAmB+E,EAAW/8B,EAAGC,EAAGsY,EACzC,IAAIolB,GAAWn+B,KAAK29B,aAAaJ,EAAUp9B,OAAQo9B,EAAUn9B,OAAQo9B,EAAIC,EAAI1kB,GACzEmlB,EAAWl+B,KAAK29B,aAAaJ,EAAUx1B,KAAMw1B,EAAUn9B,OAAQo9B,EAAIC,EAAI1kB,GACvE2kB,EAAW19B,KAAK29B,aAAaJ,EAAUx1B,KAAMw1B,EAAUv1B,KAAMw1B,EAAIC,EAAI1kB,GACrEglB,EAAW/9B,KAAK29B,aAAaJ,EAAUp9B,OAAQo9B,EAAUv1B,KAAMw1B,EAAIC,EAAI1kB,GACvE6kB,IAAcO,EAAS,GAAKT,EAAS,IAAM,GAAIS,EAAS,GAAKT,EAAS,IAAM,GAC5EI,EAAa99B,KAAK29B,aAAaQ,EAAS,GAAIA,EAAS,GAAIP,EAAU,GAAIA,EAAU,IAAK7kB,GACtFilB,EAAgBh+B,KAAK29B,aAAaI,EAAS,GAAIA,EAAS,GAAIH,EAAU,GAAIA,EAAU,IAAK7kB,GACzFklB,EAAcj+B,KAAK29B,aAAaO,EAAS,GAAIA,EAAS,GAAIN,EAAU,GAAIA,EAAU,IAAK7kB,EAO3F,OANAwkB,GAAUp9B,OAAS29B,EAAW,GAC9BP,EAAUn9B,OAAS09B,EAAW,GAC9BP,EAAUx1B,KAAOk2B,EAAY,GAC7BV,EAAUv1B,KAAOg2B,EAAc,GAC/BT,EAAUl9B,MAAQk9B,EAAUx1B,KAAOw1B,EAAUp9B,OAC7Co9B,EAAUj9B,OAASi9B,EAAUv1B,KAAOu1B,EAAUn9B,OACvCm9B,GAEXhJ,EAAU1zB,UAAU88B,aAAe,SAAUn9B,EAAGC,EAAG+8B,EAAIC,EAAI1kB,GACvD,QACKvY,EAAIg9B,GAAMr1B,KAAKgR,IAAIJ,IAAUtY,EAAIg9B,GAAMt1B,KAAKkR,IAAIN,GAASykB,GACzDh9B,EAAIg9B,GAAMr1B,KAAKkR,IAAIN,IAAUtY,EAAIg9B,GAAMt1B,KAAKgR,IAAIJ,GAAS0kB,IAGlElJ,EAAU1zB,UAAUu9B,gBAAkB,SAAUrwB,EAASvM,EAAOhB,EAAGC,GAC/D,OAAQsN,GACJ,IAAK,IACDvM,GAAShB,CACT,MACJ,KAAK,IACDgB,GAASf,CACT,MACJ,KAAK,QACDe,GAAUhB,EAAI,GAAKA,EAAI2H,KAAKC,IAAI5H,EAChC,MACJ,KAAK,QACDgB,GAAUf,EAAI,GAAKA,EAAI0H,KAAKC,IAAI3H,EAChC,MACJ,KAAK,UACDe,GAAUf,GAAMD,EAAI,GAAKA,EAAI2H,KAAKC,IAAI5H,IAAM,CAC5C,MACJ,KAAK,cACDgB,IAAWhB,EAAI,GAAKA,EAAI2H,KAAKC,IAAI5H,KAAQC,EAAI,GAAKA,EAAI0H,KAAKC,IAAI3H,IAAM,CACrE,MACJ,KAAK,UACDe,IAAWf,EAAI,GAAKA,EAAI0H,KAAKC,IAAI3H,IAAOD,EAAI,CAC5C,MACJ,KAAK,MACDgB,GAAUhB,EAAKC,EAAI,EAG3B,MAAOe,IAEX+yB,EAAU1zB,UAAU23B,mBAAqB,SAAU+E,EAAW/8B,EAAGC,EAAGsY,GAChE,GAAInF,GAAemF,GAAS,IAAM5Q,KAAKyC,IACnCmD,EAAU/N,KAAKq+B,kBAAkBzqB,EAAc5T,KAAKo2B,eAC5B,cAAxBp2B,KAAKo2B,gBACLmH,EAAUl9B,MAAQL,KAAKo+B,gBAAgBrwB,EAASwvB,EAAUl9B,MAAOG,EAAGC,GACpE88B,EAAUx1B,KAAOw1B,EAAUl9B,MAAQk9B,EAAUp9B,QAEhB,aAAxBH,KAAKo2B,gBACVmH,EAAUn9B,OAASJ,KAAKo+B,gBAAgBrwB,EAASwvB,EAAUn9B,OAAQI,EAAGC,GACtE88B,EAAUj9B,OAASi9B,EAAUv1B,KAAOu1B,EAAUn9B,QAEjB,aAAxBJ,KAAKo2B,gBACVmH,EAAUp9B,OAASH,KAAKo+B,gBAAgBrwB,EAASwvB,EAAUp9B,OAAQK,EAAGC,GACtE88B,EAAUl9B,MAAQk9B,EAAUp9B,OAASo9B,EAAUx1B,MAElB,aAAxB/H,KAAKo2B,iBACVmH,EAAUj9B,OAASN,KAAKo+B,gBAAgBrwB,EAASwvB,EAAUj9B,OAAQE,EAAGC,GACtE88B,EAAUv1B,KAAOu1B,EAAUj9B,OAASi9B,EAAUn9B,SAGtDm0B,EAAU1zB,UAAUw9B,kBAAoB,SAAUp7B,EAAQ8K,GACtD,GAAI0sB,KACY,cAAZ1sB,EACA0sB,IACK,MAAO,IAAK,MACZ,EAAG,KAAM,MACT,KAAM,KAAM,YACZ,KAAM,MAAO,UACb,MAAO,MAAO,gBACd,MAAO,MAAO,UACd,MAAO,MAAO,YACd,MAAO,MAAO,MACd,MAAO,MAAO,QAGF,aAAZ1sB,EACL0sB,IACK,MAAO,IAAK,MACZ,EAAG,KAAM,MACT,KAAM,KAAM,QACZ,KAAM,MAAO,MACb,MAAO,MAAO,YACd,MAAO,MAAO,UACd,MAAO,MAAO,gBACd,MAAO,MAAO,UACd,MAAO,MAAO,YAGF,aAAZ1sB,EACL0sB,IACK,MAAO,IAAK,MACZ,EAAG,KAAM,MACT,KAAM,KAAM,YACZ,KAAM,MAAO,UACb,MAAO,MAAO,gBACd,MAAO,MAAO,UACd,MAAO,MAAO,YACd,MAAO,MAAO,MACd,MAAO,MAAO,QAGF,aAAZ1sB,IACL0sB,IACK,MAAO,IAAK,MACZ,EAAG,KAAM,MACT,KAAM,KAAM,QACZ,KAAM,MAAO,MACb,MAAO,MAAO,YACd,MAAO,MAAO,UACd,MAAO,MAAO,gBACd,MAAO,MAAO,UACd,MAAO,MAAO,YAIvB,KAAK,GADDC,GAAiBz3B,EAAS,EAAI,IAAMkF,KAAKC,IAAInF,GAAUA,EAClD03B,EAAK,EAAG2D,EAAmB7D,EAAgBE,EAAK2D,EAAiBn5B,OAAQw1B,IAAM,CACpF,GAAIE,GAAKyD,EAAiB3D,GAAKG,EAAcD,EAAG,GAAIE,EAAYF,EAAG,GAAIG,EAAgBH,EAAG,EAC1F,IAAKH,EAAiBI,GAAeJ,GAAkBK,GAClDL,EAAiB,IAAMI,GAAeJ,EAAiB,KAAOK,EAC/D,MAAOC,GAGf,MAAOjtB,IAEXwmB,EAAU1zB,UAAU41B,mBAAqB,SAAUj2B,EAAGC,EAAGkG,GACrD,GAAI5G,GAASC,KAAKD,OACdq5B,GAAW,CACqB,MAAhCr5B,EAAO6C,UAAUuQ,gBAAgDM,KAA3B1T,EAAO6C,UAAUwC,OAAwBrF,EAAO0F,YAAYC,cACjG3F,EAAO0F,YAAY84B,SAAUx+B,EAAO0F,YAAYwN,SACjDlT,EAAO6C,UAAUwC,MAAQ,OAE7B,IAAIkE,GAAStF,YAAWjE,EAAO6C,cAAe,EAC9C,KAAIX,oBAAkBqH,EAAOwL,eAA7B,CAGA,GAAI7R,EAUJ,KARIA,EADuB,IAAvBqG,EAAOpB,YACEnI,EAAOiD,UAAUC,OAGjBlD,EAAOiD,UAAUC,OAASqG,EAAOpB,aAEjC,IACTjF,EAAS,IAAMA,GAEfjD,KAAK20B,cACL,GAAqB,SAAjBrrB,EAAOlE,OAAqC,UAAjBkE,EAAOlE,MAClCg0B,EAAWp5B,KAAKw+B,+BAA+Bh+B,EAAGC,EAAG6I,OAEpD,IAAqB,SAAjBA,EAAOlE,MACZg0B,EAAWp5B,KAAKy+B,0BAA0Bj+B,EAAGC,EAAG6I,OAE/C,IAAIA,EAAOsK,aACZ5T,KAAKk5B,0BAA0B5vB,EAAQ9I,EAAGC,EAAGV,EAAOwC,aAC9B,aAAlBxC,EAAO8d,QACP9d,EAAOwC,YAAYsZ,MAAMgC,OAAS7d,KAAKD,OAAO8d,OAAS,WACvD7d,KAAKu1B,YAAcx1B,EAAO8d,QAEH,SAAlB9d,EAAO8d,QACZ7d,KAAK60B,UAAU10B,OAASH,KAAK01B,cAAcl1B,EAAIR,KAAK60B,UAAU9sB,KAAOvH,EACrER,KAAK60B,UAAUz0B,OAASJ,KAAK01B,cAAcj1B,EAAIT,KAAK60B,UAAU7sB,KAAOvH,GAE9C,YAAlBV,EAAO8d,SACZub,GAAW,EACXp5B,KAAKu1B,YAAcx1B,EAAO8d,OAC1B9d,EAAO0F,YAAY2zB,UAAW,OAGjC,CACD,GAAI9jB,GAAsBtV,KAAKq4B,sBAAsB/uB,EACjD9I,IAAM8I,EAAOwL,cAAc3U,OAAwC,EAA9BmJ,EAAOwL,cAAcpK,QAC1DlK,GAAM8I,EAAOwL,cAAc3U,OAAwC,EAA9BmJ,EAAOwL,cAAcpK,QAC1DjK,GAAM6I,EAAOwL,cAAc1U,OAAwC,EAA9BkJ,EAAOwL,cAAcpK,QAC1DjK,GAAM6I,EAAOwL,cAAc1U,OAAwC,EAA9BkJ,EAAOwL,cAAcpK,QAAqC,cAArB1K,KAAKu1B,aAC/EjsB,EAAOwL,cAAc3U,OAASmJ,EAAOwL,cAAc1U,OAAS,EAC5DL,EAAOwC,YAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS,YAClDub,GAAW,EACXp5B,KAAKu1B,YAAcx1B,EAAOwC,YAAYsZ,MAAMgC,QAEvCrd,GAAM8I,EAAOwL,cAAc3U,OAAwC,EAA9BmJ,EAAOwL,cAAcpK,QAC/DlK,GAAM8I,EAAO0L,eAAe7U,OAAwC,EAA9BmJ,EAAOwL,cAAcpK,QAC3DjK,GAAM6I,EAAOyL,gBAAgB3U,OAAwC,EAA9BkJ,EAAOwL,cAAcpK,QAC5DjK,GAAM6I,EAAOyL,gBAAgB3U,OAAwC,EAA9BkJ,EAAOwL,cAAcpK,QAAqC,aAArB1K,KAAKu1B,aACjFjsB,EAAOyL,gBAAgB5U,OAASmJ,EAAOyL,gBAAgB3U,OAAS,EAChEL,EAAOwC,YAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS,WAClDub,GAAW,EACXp5B,KAAKu1B,YAAcx1B,EAAOwC,YAAYsZ,MAAMgC,QAEvCrd,GAAM8I,EAAO0L,eAAe7U,OAAwC,EAA9BmJ,EAAOwL,cAAcpK,QAChElK,GAAM8I,EAAO0L,eAAe7U,OAAwC,EAA9BmJ,EAAOwL,cAAcpK,QAC3DjK,GAAM6I,EAAO0L,eAAe5U,OAAwC,EAA9BkJ,EAAOwL,cAAcpK,QAC3DjK,GAAM6I,EAAO0L,eAAe5U,OAAwC,EAA9BkJ,EAAOwL,cAAcpK,QAAqC,cAArB1K,KAAKu1B,aAChFjsB,EAAO0L,eAAe7U,OAASmJ,EAAO0L,eAAe5U,OAAS,EAC9DL,EAAOwC,YAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS,YAClDub,GAAW,EACXp5B,KAAKu1B,YAAcx1B,EAAOwC,YAAYsZ,MAAMgC,QAEvCrd,GAAM8I,EAAO2L,iBAAiB9U,OAAwC,EAA9BmJ,EAAOwL,cAAcpK,QAClElK,GAAM8I,EAAO2L,iBAAiB9U,OAAwC,EAA9BmJ,EAAOwL,cAAcpK,QAC7DjK,GAAM6I,EAAOwL,cAAc1U,OAAwC,EAA9BkJ,EAAOwL,cAAcpK,QAC1DjK,GAAM6I,EAAO6L,iBAAiB/U,OAAwC,EAA9BkJ,EAAOwL,cAAcpK,QAAqC,aAArB1K,KAAKu1B,aAClFjsB,EAAO2L,iBAAiB9U,OAASmJ,EAAO2L,iBAAiB7U,OAAS,EAClEL,EAAOwC,YAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS,WAClDub,GAAW,EACXp5B,KAAKu1B,YAAcx1B,EAAOwC,YAAYsZ,MAAMgC,QAEvCrd,GAAM8I,EAAO4L,kBAAkB/U,OAAwC,EAA9BmJ,EAAOwL,cAAcpK,QACnElK,GAAM8I,EAAO4L,kBAAkB/U,OAAwC,EAA9BmJ,EAAOwL,cAAcpK,QAC9DjK,GAAM6I,EAAO0L,eAAe5U,OAAwC,EAA9BkJ,EAAOwL,cAAcpK,QAC3DjK,GAAM6I,EAAO+L,kBAAkBjV,OAAwC,EAA9BkJ,EAAOwL,cAAcpK,QAAqC,aAArB1K,KAAKu1B,aACnFjsB,EAAO4L,kBAAkB/U,OAASmJ,EAAO4L,kBAAkB9U,OAAS,EACpEL,EAAOwC,YAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS,WAClDub,GAAW,EACXp5B,KAAKu1B,YAAcx1B,EAAOwC,YAAYsZ,MAAMgC,QAEvCrd,GAAM8I,EAAO6L,iBAAiBhV,OAAwC,EAA9BmJ,EAAOwL,cAAcpK,QAClElK,GAAM8I,EAAO6L,iBAAiBhV,OAAwC,EAA9BmJ,EAAOwL,cAAcpK,QAC7DjK,GAAM6I,EAAO6L,iBAAiB/U,OAAwC,EAA9BkJ,EAAOwL,cAAcpK,QAC7DjK,GAAM6I,EAAO6L,iBAAiB/U,OAAwC,EAA9BkJ,EAAOwL,cAAcpK,QAAqC,cAArB1K,KAAKu1B,aAClFjsB,EAAO6L,iBAAiBhV,OAASmJ,EAAO6L,iBAAiB/U,OAAS,EAClEL,EAAOwC,YAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS,YAClDub,GAAW,EACXp5B,KAAKu1B,YAAcx1B,EAAOwC,YAAYsZ,MAAMgC,QAEvCrd,GAAM8I,EAAO6L,iBAAiBhV,OAAwC,EAA9BmJ,EAAOwL,cAAcpK,QAClElK,GAAM8I,EAAO+L,kBAAkBlV,OAAwC,EAA9BmJ,EAAOwL,cAAcpK,QAC9DjK,GAAM6I,EAAO8L,mBAAmBhV,OAAwC,EAA9BkJ,EAAOwL,cAAcpK,QAC/DjK,GAAM6I,EAAO8L,mBAAmBhV,OAAwC,EAA9BkJ,EAAOwL,cAAcpK,QAAqC,aAArB1K,KAAKu1B,aACpFjsB,EAAO8L,mBAAmBjV,OAASmJ,EAAO8L,mBAAmBhV,OAAS,EACtEL,EAAOwC,YAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS,WAClDub,GAAW,EACXp5B,KAAKu1B,YAAcx1B,EAAOwC,YAAYsZ,MAAMgC,QAEvCrd,GAAM8I,EAAO+L,kBAAkBlV,OAAwC,EAA9BmJ,EAAOwL,cAAcpK,QACnElK,GAAM8I,EAAO+L,kBAAkBlV,OAAwC,EAA9BmJ,EAAOwL,cAAcpK,QAC9DjK,GAAM6I,EAAO+L,kBAAkBjV,OAAwC,EAA9BkJ,EAAOwL,cAAcpK,QAC9DjK,GAAM6I,EAAO+L,kBAAkBjV,OAAwC,EAA9BkJ,EAAOwL,cAAcpK,QAAqC,cAArB1K,KAAKu1B,aACnFjsB,EAAO+L,kBAAkBlV,OAASmJ,EAAO+L,kBAAkBjV,OAAS,EACpEL,EAAOwC,YAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS,YAClDub,GAAW,EACXp5B,KAAKu1B,YAAcx1B,EAAOwC,YAAYsZ,MAAMgC,QAEvCvI,GACL9U,GAAK8U,EAAoB9U,EAAmC,EAA9B8I,EAAOwL,cAAcpK,QACnDlK,GAAK8U,EAAoB9U,EAAmC,EAA9B8I,EAAOwL,cAAcpK,QACnDjK,GAAK6U,EAAoB7U,EAAmC,EAA9B6I,EAAOwL,cAAcpK,QACnDjK,GAAK6U,EAAoB7U,EAAmC,EAA9B6I,EAAOwL,cAAcpK,QAAoC,aAArB1K,KAAKu1B,aACvEx1B,EAAOwC,YAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS,WAClD7d,KAAKu1B,YAAcx1B,EAAOwC,YAAYsZ,MAAMgC,SAG5C7d,KAAK60B,UAAU10B,OAASH,KAAK01B,cAAcl1B,EAAIR,KAAK60B,UAAU9sB,KAAOvH,EACrER,KAAK60B,UAAUz0B,OAASJ,KAAK01B,cAAcj1B,EAAIT,KAAK60B,UAAU7sB,KAAOvH,GAEnD,SAAjB6I,EAAOlE,OAAwC,aAAlBrF,EAAO8d,QACnB,aAAlB9d,EAAO8d,QAA2C,aAAlB9d,EAAO8d,QACrB,aAAlB9d,EAAO8d,SACP9d,EAAOwC,YAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS,OAClD7d,KAAKu1B,YAAc,GACnBv1B,KAAK60B,UAAU10B,OAASH,KAAK01B,cAAcl1B,EAAIR,KAAK60B,UAAU9sB,KAAOvH,EACrER,KAAK60B,UAAUz0B,OAASJ,KAAK01B,cAAcj1B,EAAIT,KAAK60B,UAAU7sB,KAAOvH,OAK7ET,MAAK60B,UAAU10B,OAASH,KAAK01B,cAAcl1B,EAAIR,KAAK60B,UAAU9sB,KAAOvH,EACrER,KAAK60B,UAAUz0B,OAASJ,KAAK01B,cAAcj1B,EAAIT,KAAK60B,UAAU7sB,KAAOvH,CAEzET,MAAK01B,cAAcl1B,EAAIR,KAAK01B,cAAcj1B,EAAIT,KAAKw0B,UAAUh0B,EAAIR,KAAKw0B,UAAU/zB,EAAI,EACvE,eAATkG,EACIyyB,GAAa54B,GAAK8I,EAAOzG,YAAY1C,QAAUK,GAAK8I,EAAOzG,YAAYkF,MACpEtH,GAAK6I,EAAOzG,YAAYzC,QAAUK,GAAK6I,EAAOzG,YAAYmF,MAA8B,aAArBhI,KAAKu1B,YAC3Ex1B,EAAO0F,YAAYwZ,YAAa,EAEV,SAAjB3V,EAAOlE,OAAqC,UAAjBkE,EAAOlE,OACvCpF,KAAKg5B,sBAAsB1vB,EAAQ9I,EAAGC,EAAGV,EAAOwC,aAC1B,SAAlBxC,EAAO8d,SACP9d,EAAO0F,YAAYwZ,YAAa,IAGd,SAAjB3V,EAAOlE,QACZpF,KAAKi5B,iBAAiB3vB,EAAQ9I,EAAGC,EAAGV,EAAOwC,aACrB,SAAlBxC,EAAO8d,SACP9d,EAAO0F,YAAYwZ,YAAa,IAKxClf,EAAO0F,YAAYwZ,YAAa,EAER,IAAxB3V,EAAOsK,cAA4C,aAArB5T,KAAKu1B,aACd,aAArBv1B,KAAKu1B,aAAmD,aAArBv1B,KAAKu1B,aACnB,aAArBv1B,KAAKu1B,cACLv1B,KAAK60B,UAAU10B,OAASH,KAAK01B,cAAcl1B,EAAIR,KAAK60B,UAAU9sB,KAAOvH,EACrER,KAAK60B,UAAUz0B,OAASJ,KAAK01B,cAAcj1B,EAAIT,KAAK60B,UAAU7sB,KAAOvH,KAG7E8zB,EAAU1zB,UAAU29B,+BAAiC,SAAUh+B,EAAGC,EAAG6I,GAIjE,IAAK,GADDnG,GAFAi2B,GAAW,EACXr5B,EAASC,KAAKD,OAETiF,EAAI,EAAGA,EAAI,EAAGA,IAEnB,GADA7B,EAAQmG,EAAOrC,UAAUjC,GACrBxE,GAAM2C,EAAM3C,EAAmC,EAA9B8I,EAAOwL,cAAcpK,QAAgBlK,GAAM2C,EAAM3C,EAAmC,EAA9B8I,EAAOwL,cAAcpK,QAC5FjK,GAAM0C,EAAM1C,EAAmC,EAA9B6I,EAAOwL,cAAcpK,QAAgBjK,GAAM0C,EAAM1C,EAAmC,EAA9B6I,EAAOwL,cAAcpK,OAAc,CAC1GpB,EAAO2L,iBAAiB9U,OAASmJ,EAAO2L,iBAAiB7U,OAAS,EAClEJ,KAAKu1B,YAAc,WACnB6D,GAAW,CACX,OAGR,IAAKA,EACD,IAASp0B,EAAI,EAAGA,EAAI,EAAGA,IAEnB,GADA7B,EAAQmG,EAAOrC,UAAUqC,EAAOrC,UAAU9B,OAASH,GAC/CxE,GAAM2C,EAAM3C,EAAmC,EAA9B8I,EAAOwL,cAAcpK,QAAgBlK,GAAM2C,EAAM3C,EAAmC,EAA9B8I,EAAOwL,cAAcpK,QAC5FjK,GAAM0C,EAAM1C,EAAmC,EAA9B6I,EAAOwL,cAAcpK,QAAgBjK,GAAM0C,EAAM1C,EAAmC,EAA9B6I,EAAOwL,cAAcpK,OAAc,CAC1GpB,EAAO4L,kBAAkB/U,OAASmJ,EAAO4L,kBAAkB9U,OAAS,EACpEJ,KAAKu1B,YAAc,WACnB6D,GAAW,CACX,OAIZ,IAAKA,EACD,IAASp0B,EAAI,EAAGA,EAAIsE,EAAOrC,UAAU9B,OAAQH,IAAK,CAE9C,GADA7B,EAAQmG,EAAOrC,UAAUjC,GACrBxE,GAAM2C,EAAM3C,EAAmC,EAA9B8I,EAAOwL,cAAcpK,QAAgBlK,GAAM2C,EAAM3C,EAAmC,EAA9B8I,EAAOwL,cAAcpK,QAC5FjK,GAAM0C,EAAM1C,EAAmC,EAA9B6I,EAAOwL,cAAcpK,QAAgBjK,GAAM0C,EAAM1C,EAAmC,EAA9B6I,EAAOwL,cAAcpK,OAAc,CAC1G3K,EAAOwC,YAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS,OAClD7d,KAAK60B,UAAU10B,OAASH,KAAK01B,cAAcl1B,EAAIR,KAAK60B,UAAU9sB,KAAOvH,EACrER,KAAK60B,UAAUz0B,OAASJ,KAAK01B,cAAcj1B,EAAIT,KAAK60B,UAAU7sB,KAAOvH,CACrE,OAGAV,EAAOwC,YAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS,UAI9D,MAAOub,IAEX7E,EAAU1zB,UAAU49B,0BAA4B,SAAUj+B,EAAGC,EAAG6I,GAC5D,GAAI8vB,IAAW,CAWf,OAVAp5B,MAAK44B,kBAAoB54B,KAAKg5B,sBAAsB1vB,EAAQ9I,EAAGC,EAAGT,KAAKD,OAAOwC,aACnD,SAAvBvC,KAAKD,OAAO8d,SACZub,GAAW,EACXp5B,KAAKu1B,YAAc,YAElB6D,IACDp5B,KAAKD,OAAOwC,YAAYsZ,MAAMgC,OAAS7d,KAAKD,OAAO8d,OAAS,OAC5D7d,KAAK60B,UAAU10B,OAASH,KAAK01B,cAAcl1B,EAAIR,KAAK60B,UAAU9sB,KAAOvH,EACrER,KAAK60B,UAAUz0B,OAASJ,KAAK01B,cAAcj1B,EAAIT,KAAK60B,UAAU7sB,KAAOvH,GAElE24B,GAEX7E,EAAU1zB,UAAU61B,iBAAmB,SAAUr2B,EAAOC,GACpD,GAAIP,GAASC,KAAKD,OACdkD,EAASlD,EAAOiD,UAAUC,QAE1BA,EADiC,IAAjClD,EAAO6C,UAAUsF,YACRnI,EAAOiD,UAAUC,OAGjBlD,EAAOiD,UAAUC,OAASlD,EAAO6C,UAAUsF,aAE3C,IACTjF,EAAS,IAAMA,EAEnB,KAAK,GAAI+B,GAAI,EAAGC,EAAMlF,EAAO6C,UAAUmV,YAAY5S,OAAQH,EAAIC,EAAKD,IAAK,CACrE,GAAI2jB,GAAO5oB,EAAO6C,UAAUmV,YAAY/S,GAAG4N,aAC3C,QAAQ3P,GACJ,IAAK,GACD,OAAQ0lB,GACJ,IAAK,aACD5oB,EAAO6C,UAAUC,aAAgB1C,OAAQJ,EAAO6C,UAAUC,YAAYkF,KAAO1H,EACzED,OAAQL,EAAO6C,UAAUC,YAAYzC,OACrC2H,KAAOhI,EAAO6C,UAAUC,YAAiB,KACzCmF,KAAMjI,EAAO6C,UAAUC,YAAYzC,QAAUE,GAAkB,GACnE,MACJ,KAAK,WACDP,EAAO6C,UAAUC,YAAYzC,OAASL,EAAO6C,UAAUC,YAAYmF,KAAO1H,EAC1EP,EAAO6C,UAAUC,aAAgB1C,OAAQJ,EAAO6C,UAAUC,YAAY1C,OAClEC,OAAQL,EAAO6C,UAAUC,YAAYzC,OACrC2H,KAAOhI,EAAO6C,UAAUC,YAAY1C,QAAUE,GAAgB,GAC9D2H,KAAMjI,EAAO6C,UAAUC,YAAYmF,KACvC,MACJ,SACIjI,EAAO6C,UAAUC,aAAgB1C,OAAQJ,EAAO6C,UAAUC,YAAY1C,OAClEC,OAAQL,EAAO6C,UAAUC,YAAYzC,OACrC2H,KAAOhI,EAAO6C,UAAUC,YAAY1C,QAAUE,GAAgB,GAC9D2H,KAAMjI,EAAO6C,UAAUC,YAAYzC,QAAUE,GAAkB,IAG3E,KACJ,KAAK,IACD,OAAQqoB,GACJ,IAAK,aACD5oB,EAAO6C,UAAUC,YAAYkF,KAAOhI,EAAO6C,UAAUC,YAAY1C,OAASG,EAC1EP,EAAO6C,UAAUC,aAAgB1C,OAAQJ,EAAO6C,UAAUC,YAAY1C,OAClEC,OAAQL,EAAO6C,UAAUC,YAAYzC,OAAQ2H,KAAOhI,EAAO6C,UAAUC,YAAiB,KACtFmF,KAAMjI,EAAO6C,UAAUC,YAAYzC,QAAUC,GAAgB,GACjE,MACJ,KAAK,WACDN,EAAO6C,UAAUC,YAAY1C,OAASJ,EAAO6C,UAAUC,YAAYkF,KAAOzH,EAC1EP,EAAO6C,UAAUC,aAAgB1C,OAAQJ,EAAO6C,UAAUC,YAAY1C,OAClEC,OAAQL,EAAO6C,UAAUC,YAAYmF,KAAO3H,EAC5C0H,KAAOhI,EAAO6C,UAAUC,YAAiB,KACzCmF,KAAMjI,EAAO6C,UAAUC,YAAYmF,KACvC,MACJ,SACIjI,EAAO6C,UAAUC,YAAY1C,OAASJ,EAAO6C,UAAUC,YAAYkF,KAAOzH,EAC1EP,EAAO6C,UAAUC,aAAgB1C,OAAQJ,EAAO6C,UAAUC,YAAY1C,OAClEC,OAAQL,EAAO6C,UAAUC,YAAYzC,OAAQ2H,KAAOhI,EAAO6C,UAAUC,YAAiB,KACtFmF,KAAMjI,EAAO6C,UAAUC,YAAYzC,QAAUC,GAAgB,IAGzE,KACJ,KAAK,KACD,OAAQsoB,GACJ,IAAK,aACD5oB,EAAO6C,UAAUC,YAAYzC,OAASL,EAAO6C,UAAUC,YAAYmF,KAAO1H,EAC1EP,EAAO6C,UAAUC,aAAgB1C,OAAQJ,EAAO6C,UAAUC,YAAY1C,OAClEC,OAAQL,EAAO6C,UAAUC,YAAYzC,OACrC2H,KAAOhI,EAAO6C,UAAUC,YAAY1C,OAASE,EAC7C2H,KAAMjI,EAAO6C,UAAUC,YAAYmF,KACvC,MACJ,KAAK,WACDjI,EAAO6C,UAAUC,YAAYmF,KAAOjI,EAAO6C,UAAUC,YAAYzC,OAASE,EAC1EP,EAAO6C,UAAUC,aAAgBkF,KAAMhI,EAAO6C,UAAUC,YAAYkF,KAAMC,KAAMjI,EAAO6C,UAAUC,YAAYmF,KACzG7H,OAASJ,EAAO6C,UAAUC,YAAYkF,MAAQ1H,GAAgB,GAC9DD,OAAQL,EAAO6C,UAAUC,YAAYzC,OACzC,MACJ,SACIL,EAAO6C,UAAUC,aAAgBkF,KAAMhI,EAAO6C,UAAUC,YAAYkF,KAAMC,KAAMjI,EAAO6C,UAAUC,YAAYmF,KACzG7H,OAASJ,EAAO6C,UAAUC,YAAYkF,MAAQ1H,GAAgB,GAC9DD,OAAQL,EAAO6C,UAAUC,YAAYmF,MAAQ1H,GAAkB,IAG3E,KACJ,KAAK,KACD,OAAQqoB,GACJ,IAAK,aACD5oB,EAAO6C,UAAUC,YAAY1C,OAASJ,EAAO6C,UAAUC,YAAYkF,KAAOzH,EAC1EP,EAAO6C,UAAUC,aAAgB1C,OAAQJ,EAAO6C,UAAUC,YAAY1C,OAClEC,OAAQL,EAAO6C,UAAUC,YAAYmF,MAAQ3H,GAAgB,GAC7D0H,KAAMhI,EAAO6C,UAAUC,YAAYkF,KACnCC,KAAMjI,EAAO6C,UAAUC,YAAYmF,KACvC,MACJ,KAAK,WACDjI,EAAO6C,UAAUC,aAAgB1C,OAAQJ,EAAO6C,UAAUC,YAAY1C,OAClEC,OAAQL,EAAO6C,UAAUC,YAAYzC,OACrC2H,KAAOhI,EAAO6C,UAAUC,YAAY1C,OAASG,EAC7C0H,KAAMjI,EAAO6C,UAAUC,YAAYzC,QAAUC,GAAgB,GACjE,MACJ,SACIN,EAAO6C,UAAUC,YAAYkF,KAAOhI,EAAO6C,UAAUC,YAAY1C,OAASG,EAC1EP,EAAO6C,UAAUC,aAAgB1C,OAAQJ,EAAO6C,UAAUC,YAAY1C,OAClEC,OAAQL,EAAO6C,UAAUC,YAAYmF,MAAQ3H,GAAgB,GAC7D0H,KAAMhI,EAAO6C,UAAUC,YAAYkF,KACnCC,KAAMjI,EAAO6C,UAAUC,YAAYmF,QAM3D,GAA4C,IAAxCjI,EAAO6C,UAAUmV,YAAY5S,OAC7B,OAAQlC,GACJ,IAAK,GACDlD,EAAO6C,UAAUC,aAAgB1C,OAAQJ,EAAO6C,UAAUC,YAAY1C,OAAQC,OAAQL,EAAO6C,UAAUC,YAAYzC,OAC/G2H,KAAOhI,EAAO6C,UAAUC,YAAY1C,QAAUE,GAAgB,GAC9D2H,KAAMjI,EAAO6C,UAAUC,YAAYzC,QAAUE,GAAkB,GACnE,MACJ,KAAK,IACDP,EAAO6C,UAAUC,YAAY1C,OAASJ,EAAO6C,UAAUC,YAAYkF,KAAOzH,EAC1EP,EAAO6C,UAAUC,aAAgB1C,OAAQJ,EAAO6C,UAAUC,YAAY1C,OAAQC,OAAQL,EAAO6C,UAAUC,YAAYzC,OAC/G2H,KAAOhI,EAAO6C,UAAUC,YAAiB,KACzCmF,KAAMjI,EAAO6C,UAAUC,YAAYzC,QAAUC,GAAgB,GACjE,MACJ,KAAK,KACDN,EAAO6C,UAAUC,aAAgBkF,KAAMhI,EAAO6C,UAAUC,YAAYkF,KAAMC,KAAMjI,EAAO6C,UAAUC,YAAYmF,KACzG7H,OAASJ,EAAO6C,UAAUC,YAAYkF,MAAQ1H,GAAgB,GAC9DD,OAAQL,EAAO6C,UAAUC,YAAYmF,MAAQ1H,GAAkB,GACnE,MACJ,KAAK,KACDP,EAAO6C,UAAUC,YAAYkF,KAAOhI,EAAO6C,UAAUC,YAAY1C,OAASG,EAC1EP,EAAO6C,UAAUC,aAAgB1C,OAAQJ,EAAO6C,UAAUC,YAAY1C,OAClEC,OAAQL,EAAO6C,UAAUC,YAAYmF,MAAQ3H,GAAgB,GAC7D0H,KAAMhI,EAAO6C,UAAUC,YAAYkF,KACnCC,KAAMjI,EAAO6C,UAAUC,YAAYmF,MAInDjI,EAAO6C,UAAUC,YAAYxC,MAAQN,EAAO6C,UAAUC,YAAYkF,KAAOhI,EAAO6C,UAAUC,YAAY1C,OACtGJ,EAAO6C,UAAUC,YAAYvC,OAASP,EAAO6C,UAAUC,YAAYmF,KAAOjI,EAAO6C,UAAUC,YAAYzC,OACvE,MAA5BL,EAAOiD,UAAUC,SAA+C,MAA7BlD,EAAOiD,UAAUC,SACpDlD,EAAOiD,UAAUC,OAAS,IAGlCsxB,EAAU1zB,UAAU81B,eAAiB,SAAUx2B,EAAQC,GACnD,GAAIL,GAASC,KAAKD,MAClB,KAAIkC,oBAAkBlC,EAAO6C,UAAUC,aAGvC,GAAI9C,EAAO0F,YAAYwN,OAAQ,CAC3B,GAAIyrB,GAAYv+B,GAAkB,EAC9Bw+B,EAAav+B,GAAkBL,EAAO6C,UAAUyF,aAAaE,aAClBkL,KAA3C1T,EAAO6C,UAAUyF,aAAaE,WAC9BxI,EAAO6C,UAAUyF,aAAaE,SAAsE,GAA1DJ,KAAKC,IAAIrI,EAAO8E,QAAQxE,MAAQN,EAAO8E,QAAQvE,SAE7FN,KAAK02B,iBAAiBgI,EAAWC,GACjC3+B,KAAKy1B,eAAej1B,EAAIT,EAAO6C,UAAUC,YAAYkF,KACrD/H,KAAKy1B,eAAeh1B,EAAIV,EAAO6C,UAAUC,YAAYmF,SACjByL,KAAhC1T,EAAO6C,UAAUgK,aACjB7M,EAAO6C,UAAUC,YAAcmB,YAAWjE,EAAO6C,UAAUC,gBAAiB,IAEhF9C,EAAO+C,OAAO,QAAUxB,KAAM,aAAcyB,kBAAkB,EAAOvB,OAAS6D,OAAQ,mBAErF,IAAIlF,GAAUC,EACfL,EAAO6C,UAAUC,YAAY1C,OAASH,KAAKy1B,eAAej1B,EAAIL,EAC9DJ,EAAO6C,UAAUC,YAAYzC,OAASJ,KAAKy1B,eAAeh1B,EAAIL,EAC9DL,EAAO0F,YAAYwZ,YAAa,MAE/B,CACD,GAAI2f,GAAa7+B,EAAO6C,SACxB7C,GAAO6C,UAAUC,aAAgB1C,OAAQy+B,EAAWhyB,WAAWzM,OAAQC,OAAQw+B,EAAWhyB,WAAWxM,OACjG2H,KAAM62B,EAAWhyB,WAAW7E,KAAMC,KAAM42B,EAAWhyB,WAAW5E,MAClEjI,EAAO6C,UAAUC,YAAYxC,MAAQN,EAAO6C,UAAUC,YAAYkF,KAAOhI,EAAO6C,UAAUC,YAAY1C,OACtGJ,EAAO6C,UAAUC,YAAYvC,OAASP,EAAO6C,UAAUC,YAAYmF,KAAOjI,EAAO6C,UAAUC,YAAYzC,SAG/Gm0B,EAAU1zB,UAAUs2B,sBAAwB,SAAU9H,GAClD,GAAI9jB,GAAQvL,KACRD,EAASC,KAAKD,MAOlB,IANe,eAAXsvB,EAAE1oB,KACF3G,KAAK00B,SAAU,EAGf10B,KAAK00B,SAAU,EAEJ,eAAXrF,EAAE1oB,MAAyB0oB,EAAEwP,gBAAkB9+B,EAAOqC,aAAgBrC,EAAO0L,cAAjF,CAGAzL,KAAKke,iBAAkB,EACvBle,KAAK8+B,OAAQ,CACb,IAAIpyB,OAC2B+G,KAA3B1T,EAAO6C,UAAUwC,QACjBsH,EAAa3M,EAAO6C,UAAUwC,MAAMuH,MAAM,UAE3B8G,KAAf/G,GAA8C,SAAlBA,EAAW,KACvC1M,KAAKke,iBAAkB,GAEvBle,KAAKke,kBACLle,KAAK61B,WAAa91B,EAAOie,WAAY,EAEzC,IAAI+gB,IAA8B57B,MAAOnD,KAAKg/B,YAAY3P,GACtDnjB,eAAcnM,EAAOoM,SAAgD,IAAtCpM,EAAOoM,OAAO8yB,QAAQ7yB,YAErDrM,EAAOsM,UAAUC,kBAAkB,kBAAmB,QAASyyB,GAA2BxyB,KAAK,SAAUwyB,GACrGxzB,EAAM2zB,WAAWH,EAA2B1P,MAIhDtvB,EAAO0M,QAAQ,QAASsyB,GACxB/+B,KAAKk/B,WAAWH,EAA2B1P,MAGnDkF,EAAU1zB,UAAUs+B,eAAiB,SAAU3+B,EAAGC,GAC9C,GAAIV,GAASC,KAAKD,MAalB,OAZIS,GAAIT,EAAOqD,IAAIC,SACf7C,EAAIT,EAAOqD,IAAIC,SAEV7C,EAAIT,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,YAC1C/C,EAAIT,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,WAErC9C,EAAIV,EAAOqD,IAAIE,QACf7C,EAAIV,EAAOqD,IAAIE,QAEV7C,EAAIV,EAAOqD,IAAIE,QAAUvD,EAAOqD,IAAII,aACzC/C,EAAIV,EAAOqD,IAAIE,QAAUvD,EAAOqD,IAAII,aAE/BhD,EAAGA,EAAGC,EAAGA,IAEtB8zB,EAAU1zB,UAAUq+B,WAAa,SAAUH,EAA2B1P,GAClE,GAAItvB,GAASC,KAAKD,OACdS,EAAIu+B,EAA0B57B,MAAM3C,EACpCC,EAAIs+B,EAA0B57B,MAAM1C,EACpCod,EAAS9d,EAAO6C,UAAUwC,OAAoC,SAA3BrF,EAAO6C,UAAUwC,MACpDrF,EAAO8d,OAAS,SACpB,IAAiC,KAA7B7d,KAAKi2B,oBAA4B,CACjC,GAAIvqB,IAAa3F,WACjBhG,GAAO+C,OAAO,UAAYxB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAASsE,OAAQ4F,KAC3F1L,KAAKk2B,eAAiBxqB,EAAkB,QACxC1L,KAAKk2B,eAAehxB,QAAUlB,YAAWjE,EAAOmF,YAAa,GAC7DlF,KAAKk2B,eAAejvB,UAAYjD,YAAWjE,EAAOkH,cAAe,GACjEjH,KAAKk2B,eAAerwB,iBAAmB7B,YAAWjE,EAAO8F,qBAAsB,EAC/E,IAAIuZ,IAAoBhW,aAAc,KAKtC,IAJArJ,EAAO+C,OAAO,iBAAmBxB,KAAM,kBAAmByB,kBAAkB,EACxEvB,OAASyC,IAAKmb,KAClBpf,KAAKk2B,eAAe9sB,aAAepF,YAAWob,EAA8B,iBAAO,GACnFpf,KAAK22B,eAAen2B,EAAGC,GACU,SAA7BT,KAAKi2B,oBAAgC,CACrC,GAAI9yB,GAAQnD,KAAKm/B,eAAe3+B,EAAGC,EACnCV,GAAO6C,UAAUqE,UAAUhB,MAAOzF,EAAG2C,EAAM3C,EAAGC,EAAG0C,EAAM1C,IACZ,IAAvCV,EAAO6C,UAAUC,YAAYxC,OAAuD,IAAxCN,EAAO6C,UAAUC,YAAYvC,SACzEP,EAAO6C,UAAUC,YAAYxC,MAAQ,EACrCN,EAAO6C,UAAUC,YAAYvC,OAAS,EACtCP,EAAO6C,UAAUC,YAAY1C,OAASJ,EAAO6C,UAAUqE,UAAUlH,EAAO6C,UAAUqE,UAAU9B,OAAS,GAAG3E,EACxGT,EAAO6C,UAAUC,YAAYzC,OAASL,EAAO6C,UAAUqE,UAAUlH,EAAO6C,UAAUqE,UAAU9B,OAAS,GAAG1E,GAMhH,MAHAV,GAAO6C,UAAUC,YAAYkF,KAAOhI,EAAO6C,UAAUC,YAAY1C,OACjEJ,EAAO6C,UAAUC,YAAYmF,KAAOjI,EAAO6C,UAAUC,YAAYzC,YACjEL,EAAO0F,YAAYwZ,YAAa,GAGhCjf,KAAKke,iBAAmBle,KAAK61B,aAC7B71B,KAAKu2B,UAAU/1B,EAAGC,GACI,SAAlBV,EAAO8d,QAAuC,cAAlB9d,EAAO8d,QACjB,YAAlB9d,EAAO8d,QAA0C,SAAlB9d,EAAO8d,SACtC7d,KAAK8+B,OAAQ,IAGjB/+B,EAAO6C,UAAUwC,MACjBpF,KAAK20B,eAAgB,EAGrB30B,KAAK20B,eAAgB,CAEzB,IAAI7uB,IAAWC,WACfhG,GAAO+C,OAAO,UAAYxB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAASsE,OAAQA,IAC3F,IAAIiH,GAAUjH,EAAgB,QAC1BlD,EAAYoB,YAAWjE,EAAO6C,UAAW,MAAM,GAC/Cw8B,EAAUp/B,KAAKq/B,aAAahQ,EAAGrvB,KAAKke,iBACpCohB,EAAiBt/B,KAAKu/B,oBAAoBlQ,EAAGrvB,KAAKke,iBAClDshB,EAAeJ,GAAoBp/B,KAAKw/B,aAAanQ,EAAGrvB,KAAKke,iBAC7D2a,EAAoB74B,KAAK62B,eAAe2I,EAC5C,IAAIx/B,KAAK00B,UAAY0K,GAAWx8B,EAAUwC,QAAUpF,KAAKke,gBAAiB,CAClEle,KAAKy/B,SAASj/B,EAAGC,KACjBV,EAAO8zB,OAAM,GACb9zB,EAAO+C,OAAO,QAAUxB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAAS2Q,WAAY,QAEjG,IAAIrF,GAAc9I,YAAWjE,EAAOiG,YAAa,EACjDjG,GAAO+C,OAAO,aAAexB,KAAM,qBAAsByB,kBAAkB,EACvEvB,OAAS6L,UAAW,iBAAkBC,YAAaP,EAASQ,gBAAiBR,EAAQ7H,QACjFsI,kBAAmBT,EAAQ9F,UAAWwG,qBAAsBV,EAAQ3D,aACpEsE,gBAAiBZ,EAAaa,aAAc,KAC5CC,YAAa,KAAMC,eAAgB,KAAMrI,aAAczF,EAAOyF,gBAClEqzB,GACA94B,EAAO+C,OAAO,aAAexB,KAAM,gBAAiBE,OAASmF,KAAM,QAY3E,GATKy4B,GAAYr/B,EAAOse,WAAcre,KAAKke,kBAClChS,aAIInM,EAAO0L,eACZ1L,EAAO+N,cAAc/N,EAAOgO,QAAS,cAAe,eAJpDhO,EAAO+C,OAAO,WAAaxB,KAAM,uBAAwByB,kBAAkB,IAC3EhD,EAAO+C,OAAO,WAAaxB,KAAM,2BAA4ByB,kBAAkB,OAMnF/C,KAAK61B,aAAc71B,KAAK8+B,OAA4B,SAAlB/+B,EAAO8d,SAAqB7d,KAAK00B,SAC/D0K,GAAYE,GAAmBv/B,EAAOse,UA+BzC,CACD,GAAIqhB,IAAc,GACd3/B,EAAO6C,UAAUwC,OAAqC,SAA3BrF,EAAO6C,UAAUwC,OACjB,UAA3BrF,EAAO6C,UAAUwC,QACjBs6B,GAAc,EAElB,IAAI72B,GAAS7I,KAAKg/B,YAAY3P,GAC1BsQ,EAAM92B,EAAOrI,EACbo/B,EAAM/2B,EAAOpI,CACbT,MAAKy/B,SAASE,EAAKC,KACnB7/B,EAAO8zB,OAAM,GACTgF,GACA94B,EAAO+C,OAAO,aAAexB,KAAM,gBAAiBE,OAASmF,KAAM,QAEvE5G,EAAO+C,OAAO,QAAUxB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAAS2Q,WAAY,SAEjGpS,EAAO+C,OAAO,SAAWxB,KAAM,eAAgByB,kBAAkB,EAC7DvB,OAAShB,EAAGm/B,EAAKl/B,EAAGm/B,EAAKrkB,aAAa,IAC1C,IAAItX,IAAQovB,MAAO,KACnBtzB,GAAO+C,OAAO,iBAAmBxB,KAAM,8BAA+ByB,kBAAkB,EAAOvB,OAASyC,IAAKA,IAC7G,IAAI47B,IAAaC,sBAAuB,KAExC,IADA//B,EAAO+C,OAAO,iBAAmBxB,KAAM,2BAA4ByB,kBAAkB,EAAOvB,OAASyC,IAAK47B,KACtG7/B,KAAK40B,YAAe50B,KAAK81B,kBAAoB/1B,EAAOse,UAAY,CAChE,IAAKpc,oBAAkB49B,EAAgC,wBACnDA,EAAgC,wBAAM57B,EAAW,MAAG,CACpD,GAAI87B,GAAmB97B,EAAW,KAKlC,IAJAlE,EAAO8zB,QACP7zB,KAAK81B,iBAAkB,EACvB/1B,EAAO+C,OAAO,iBAAmBxB,KAAM,8BAA+ByB,kBAAkB,EACpFvB,OAAS6xB,MAAO0M,KAChB97B,EAAW,OAAK,EAAG,CACf8K,EAAchP,EAAOkH,UAAUhD,EAAW,OAAG8K,WACjDhP,GAAO+C,OAAO,iBAAmBxB,KAAM,WAAYyB,kBAAkB,EACjEvB,OAASuN,YAAaA,EAAaE,YAAalP,EAAOkH,UAAUhD,EAAW,OAAGgL,gBAK3F,GAFA4wB,EAAgC,sBAAI,KACpC9/B,EAAO+C,OAAO,iBAAmBxB,KAAM,2BAA4ByB,kBAAkB,EAAOvB,OAASyC,IAAK47B,MACrG59B,oBAAkBgC,EAAW,QAAMA,EAAW,OAAK,EACpDlE,EAAO+C,OAAO,iBAAmBxB,KAAM,YAAaE,OAASmF,KAAM,QAC9DuF,cAIDnM,EAAO+N,cAAc/N,EAAOgO,QAAS,OACrChO,EAAO+N,cAAc/N,EAAOgO,QAAS,qBAAsB,QAJ3DhO,EAAO+C,OAAO,WAAaxB,KAAM,YAAayB,kBAAkB,EAAOvB,OAASw+B,WAAW,SAO9F,IAAIH,EAAgC,sBAAG,CACxC9/B,EAAO8zB,OACP,IAAI9kB,GAAchP,EAAOkH,UAAU44B,EAAgC,uBAAG9wB,WACtEhP,GAAO+C,OAAO,iBAAmBxB,KAAM,WAAYyB,kBAAkB,EACjEvB,OAASuN,YAAaA,EAAaE,YAAalP,EAAOkH,UAAU44B,EAAgC,uBAAG5wB,oBAG3G,CAkBD,GAjBIjP,KAAKg2B,eACLj2B,EAAO+C,OAAO,iBAAmBxB,KAAM,YAAaE,OAASmF,KAAM,QAC/DoW,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,6BAC5CD,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,2BAA2BnB,MAAMG,QAAU,SAG1F9P,cACDnM,EAAO+C,OAAO,WAAaxB,KAAM,2BAA4ByB,kBAAkB,IAEnF/C,KAAKg2B,cAAe,EAChB0J,EACA1/B,KAAKu2B,UAAUoJ,EAAKC,GAEJ,YAAX/hB,IACL9d,EAAOwC,YAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAASA,GAGhC,cAAlB9d,EAAO8d,QAA2B5B,UAAQC,UAAYnc,EAAOse,UAAY,CACzE,GAAIte,EAAOse,UAAW,CAClB,GAAIpc,oBAAkBlC,EAAO6C,UAAUmQ,gBAAiB,CACpD,GAAIC,IAAUD,kBACdhT,GAAO+C,OAAO,SAAWxB,KAAM,oBAAqByB,kBAAkB,EAClEvB,OAASyC,IAAK+O,KAClBjT,EAAO6C,UAAUmQ,eAAiBC,EAAsB,eAE5D,GAAIE,IAAUwb,eAAgB,KAC9B3uB,GAAO+C,OAAO,iBAAmBxB,KAAM,oBAAqByB,kBAAkB,EAAOvB,OAASyC,IAAKiP,KAC/FjR,oBAAkBiR,EAAsB,iBACxCnT,EAAO+C,OAAO,iBAAmBxB,KAAM,oBAAqByB,kBAAkB,EAAOvB,OAASA,MAAO,KAEzGxB,KAAKwC,aAAakT,YAAc3V,EAAO6C,UAAUmQ,eAAehE,YAChE/O,KAAKwC,aAAa4Q,UAAYrT,EAAO6C,UAAUmQ,eAAehE,YAC9DhP,EAAO+C,OAAO,iBAAmBxB,KAAM,sBAAuByB,kBAAkB,EAC5EvB,OAAS6tB,EAAGA,EAAGhqB,OAAQtF,EAAOwC,mBAGlCxC,GAAO+C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,IACrE/C,KAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOwC,YAAYlC,MAAON,EAAOwC,YAAYjC,OAEnFP,GAAO0F,YAAYuF,aAAc,EACjChL,KAAKu1B,YAAc,GACnBv1B,KAAK60B,UAAU10B,OAASH,KAAK60B,UAAUz0B,OAASJ,KAAK60B,UAAU9sB,KAAO/H,KAAK60B,UAAU7sB,KAAO,EAEzE,cAAlBjI,EAAO8d,QAAmD,eAAzBwR,EAAE1oB,KAAKiM,eACxC7S,EAAO0F,YAAYuF,aAAiC,YAAlBjL,EAAO8d,SAAyB9d,EAAOse,WACtEte,EAAO0F,YAAYmG,cACnB7L,EAAO+C,OAAO,aAAexB,KAAM,aAAcE,OAAS4E,KAAM,QAEpEpG,KAAKi4B,WAAW0H,EAAKC,EAAKvQ,EAAE1oB,OAEO,KAA7B5G,EAAO0F,YAAYL,QAAgBrF,EAAO0F,YAAYC,cAAkB3F,EAAOse,WAA+B,YAAlBte,EAAO8d,QACzG7d,KAAK22B,eAAegJ,EAAKC,QAzI7B5/B,MAAKy/B,SAASj/B,EAAGC,KACjBV,EAAO8zB,OAAM,GACTgF,GACA94B,EAAO+C,OAAO,aAAexB,KAAM,gBAAiBE,OAASmF,KAAM,QAEvE5G,EAAO+C,OAAO,QAAUxB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAAS2Q,WAAY,SAE7FnS,KAAKg2B,eACLj2B,EAAO+C,OAAO,iBAAmBxB,KAAM,WAAYyB,kBAAkB,IACrE/C,KAAK81B,iBAAkB,EAClB5pB,cACDnM,EAAO+C,OAAO,WAAaxB,KAAM,qBAAsByB,kBAAkB,MAG7EhD,EAAO6C,UAAUwC,OAAqC,cAA3BrF,EAAO6C,UAAUwC,OACjB,YAA3BrF,EAAO6C,UAAUwC,OAAkD,SAA3BrF,EAAO6C,UAAUwC,OAC9B,UAA3BrF,EAAO6C,UAAUwC,OAAgD,SAA3BrF,EAAO6C,UAAUwC,OAA+C,SAA3BrF,EAAO6C,UAAUwC,QAC5FrF,EAAO+C,OAAO,SAAWxB,KAAM,eAAgByB,kBAAkB,EAC7DvB,OAAShB,EAAG,KAAMC,EAAG,KAAM8a,YAAa,QAC5Cxb,EAAO+C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,IAChEmJ,aAKDnM,EAAO+N,cAAc/N,EAAOgO,QAAS,gBAJrChO,EAAO+C,OAAO,WAAaxB,KAAM,oBAAqBE,OAASmF,KAAM,UACrE5G,EAAO+C,OAAO,WAAaxB,KAAM,uBAAwByB,kBAAkB,MAMnF/C,KAAKs3B,uBAAuBjI,EAiHhCrvB,MAAK80B,iBAAkB,EACvB90B,KAAKshB,cAAgBtd,YAAWjE,EAAO6C,cAAe,IAE1D2xB,EAAU1zB,UAAUu2B,sBAAwB,SAAU/H,GAClD,GAAItvB,GAASC,KAAKD,OACd8d,EAAS9d,EAAO8d,OAChBoiB,EAAelgC,EAAOwC,YAAYsZ,MAAMgC,MAC5CwR,GAAE6Q,gBACF,IAAIC,GAAOpgC,EAAOqC,YAAYytB,uBAC9B,IAAe,cAAXR,EAAE1oB,MAA6C,IAArB0oB,EAAEK,QAAQvqB,OAAc,CAClD,GAAInF,KAAKi1B,YACLj1B,KAAKk1B,aAAel1B,KAAKogC,cAAc/Q,EAAEK,SACzC1vB,KAAKm1B,eACLn1B,KAAKm1B,YAAYlvB,MAAOzF,EAAI6uB,EAAEK,QAAQ,GAAGF,SAAYH,EAAEK,QAAQ,GAAG2Q,MAAQtgC,EAAOqC,YAAYk+B,WAAcH,EAAKllB,KAC5Gxa,GAAI4uB,EAAEK,QAAQ,GAAGD,SAAYJ,EAAEK,QAAQ,GAAG6Q,MAAQxgC,EAAOqC,YAAYo+B,WAAcL,EAAKzZ,MAC5F1mB,KAAKm1B,YAAYlvB,MAAOzF,GAAI6uB,EAAEK,QAAQ,GAAGF,SAAYH,EAAEK,QAAQ,GAAG2Q,MAAQtgC,EAAOqC,YAAYk+B,YAAeH,EAAKllB,KAC7Gxa,GAAI4uB,EAAEK,QAAQ,GAAGD,SAAYJ,EAAEK,QAAQ,GAAG6Q,MAAQxgC,EAAOqC,YAAYo+B,WAAcL,EAAKzZ,UAE3F,CACD,GAAI+Z,IAAgBpR,EAAEK,QAAQ,GAAGF,SAAYH,EAAEK,QAAQ,GAAG2Q,MAAQtgC,EAAOqC,YAAYk+B,YAAeH,EAAKllB,KACrGylB,GAAgBrR,EAAEK,QAAQ,GAAGD,SAAYJ,EAAEK,QAAQ,GAAG6Q,MAAQxgC,EAAOqC,YAAYo+B,WAAcL,EAAKzZ,IACpGia,GAAiBtR,EAAEK,QAAQ,GAAGF,SAAYH,EAAEK,QAAQ,GAAG2Q,MAAQtgC,EAAOqC,YAAYk+B,YAAeH,EAAKllB,KACtG2lB,GAAiBvR,EAAEK,QAAQ,GAAGD,SAAYJ,EAAEK,QAAQ,GAAG6Q,MAAQxgC,EAAOqC,YAAYo+B,WAAcL,EAAKzZ,IACrGma,GAAWrgC,EAAGigC,EAAeE,EAAgBA,GAAkBA,EAAgBF,GAAgB,EAC3FA,GAAiBA,EAAeE,GAAiB,EAAIlgC,EAAGigC,EAAeE,EACvEA,GAAkBA,EAAgBF,GAAgB,EAAKA,GAAiBA,EAAeE,GAAiB,EAChH,IAAI5gC,KAAKo1B,eAAe50B,IAAMqgC,EAAOrgC,GAAKR,KAAKo1B,eAAe30B,IAAMogC,EAAOpgC,EAAG,CAC1E,GAAIkG,GAAO,EACX,IAAe,cAAX0oB,EAAE1oB,OAAyB5G,EAAOkN,aAAa6zB,YAAcC,cAAYC,SAAWD,cAAYC,MAAO,CACvGhhC,KAAK21B,SAAW,OAChB,IAAIhb,GAAQ3a,KAAKihC,eAAejhC,KAAKk1B,aAAcl1B,KAAKogC,cAAc/Q,EAAEK,SACxE1vB,MAAKk1B,aAAel1B,KAAKogC,cAAc/Q,EAAEK,SACrC/U,EAAQ,EACRhU,EAAO,SAEFgU,EAAQ,IACbhU,EAAO,WAGF,KAATA,GACA5G,EAAO+C,OAAO,QAAUxB,KAAM,mBAAoByB,kBAAkB,EAChEvB,OAAShB,EAAGqgC,EAAOrgC,EAAGC,EAAGogC,EAAOpgC,EAAGkG,KAAMA,KAEjD3G,KAAKm1B,eACLn1B,KAAKm1B,YAAYlvB,MAAOzF,EAAG6uB,EAAEK,QAAQ,GAAGF,SAAYH,EAAEK,QAAQ,GAAG2Q,MAAQtgC,EAAOqC,YAAYk+B,WACxF7/B,EAAG4uB,EAAEK,QAAQ,GAAGD,SAAYJ,EAAEK,QAAQ,GAAG6Q,MAAQxgC,EAAOqC,YAAYo+B,YACxExgC,KAAKm1B,YAAYlvB,MAAOzF,EAAG6uB,EAAEK,QAAQ,GAAGF,SAAYH,EAAEK,QAAQ,GAAG2Q,MAAQtgC,EAAOqC,YAAYk+B,WACxF7/B,EAAG4uB,EAAEK,QAAQ,GAAGD,SAAYJ,EAAEK,QAAQ,GAAG6Q,MAAQxgC,EAAOqC,YAAYo+B,YACxExgC,KAAKo1B,eAAe50B,EAAIqgC,EAAOrgC,EAC/BR,KAAKo1B,eAAe30B,EAAIogC,EAAOpgC,GAIvC,YADAT,KAAKi1B,aAAc,GAGvB,GAAIz0B,GACAC,CACW,eAAX4uB,EAAE1oB,MACFnG,EAAI6uB,EAAEG,QACN/uB,EAAI4uB,EAAEI,UAGNzvB,KAAK+1B,cAAcv1B,EAAIA,EAAI6uB,EAAEK,QAAQ,GAAGF,QACxCxvB,KAAK+1B,cAAct1B,EAAIA,EAAI4uB,EAAEK,QAAQ,GAAGD,SAE5CjvB,GAAK2/B,EAAKllB,KACVxa,GAAK0/B,EAAKzZ,IACV1mB,KAAKu3B,uBAAuBlI,EAC5B,IACI3iB,GADAwR,GAAkB,MAESzK,KAA3B1T,EAAO6C,UAAUwC,QACjBsH,EAAa3M,EAAO6C,UAAUwC,MAAMuH,MAAM,UAE3B8G,KAAf/G,GAA8C,SAAlBA,EAAW,KACvCwR,GAAkB,GAElBA,GACAne,EAAO+C,OAAO,aAAexB,KAAM,oBAAqBE,OAAS0/B,WAAW,KAEhFnhC,EAAOwC,YAAYsZ,MAAMgC,OAASoiB,EAClClgC,EAAO8d,OAASA,GACZ9d,EAAO0F,YAAYuF,kBAAiDyI,KAAjC1T,EAAO6C,UAAUC,aAA6B9C,EAAOmF,QAAQC,OAAS,KACxGnF,KAAK61B,gBAA+CpiB,KAAjC1T,EAAO6C,UAAUC,cACZ,KAArB7C,KAAKu1B,cACLv1B,KAAKu2B,UAAU/1B,EAAGC,GACbV,EAAO6C,UAAUC,cACsB,IAAvC9C,EAAO6C,UAAUC,YAAYxC,QAAiB4B,oBAAkBlC,EAAO6C,UAAUic,YAC9E7e,KAAKq1B,iBAAmBt1B,EAAO6C,UAAUic,YACxB,YAAlB9e,EAAO8d,QACQ,SAAlB9d,EAAO8d,QAAuC,cAAlB9d,EAAO8d,QACd,SAAlB9d,EAAO8d,QAAuC,YAAlB9d,EAAO8d,SACtC9d,EAAOwC,YAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS,QAEtD7d,KAAKi4B,WAAWz3B,EAAGC,EAAG4uB,EAAE1oB,OAG5B5G,EAAO0F,YAAYwZ,aACnBjf,KAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOqC,YAAY/B,MAAON,EAAOqC,YAAY9B,QAC/EN,KAAKw2B,kBAAkBh2B,EAAGC,EAAGyd,GAC7Bne,EAAO+C,OAAO,SAAWxB,KAAM,uBAAwByB,kBAAkB,EAAOvB,OAASyC,IAAKlE,EAAO6C,aACjG5C,KAAKs1B,mBACAv1B,EAAO6C,UAAUC,YAAY1C,OAASJ,EAAOqD,IAAIC,UACjDtD,EAAO6C,UAAUC,YAAYkF,KAAOhI,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,WACrExD,EAAO6C,UAAUC,YAAYzC,OAASL,EAAOqD,IAAIE,SAC9CvD,EAAO6C,UAAUC,YAAYmF,KAAOjI,EAAOqD,IAAIE,QAAUvD,EAAOqD,IAAII,aACxExD,KAAKs1B,mBAAoB,GAE7Bv1B,EAAO+C,OAAO,QAAUxB,KAAM,aAAcyB,kBAAkB,EAAOvB,OAAS6D,OAAQ,YAAapB,IAAK,KAAMsO,YAAa,KACnH1J,OAAQ,KAAM2J,eAAe,EAAMC,YAAa,KAAMC,mBAAoB,SAGlF3S,EAAO+C,OAAO,QAAUxB,KAAM,aAAcyB,kBAAkB,EAAOvB,OAAS6D,OAAQ,YAAapB,IAAK,KAAMsO,YAAa,KACnH1J,OAAQ,KAAM2J,cAAe,KAAMC,YAAa,KAAMC,mBAAoB,QAElFwL,IACAle,KAAK61B,WAAa91B,EAAOie,WAAY,KAIjDuW,EAAU1zB,UAAUw2B,oBAAsB,SAAUhI,GAChD,GAAI9jB,GAAQvL,KACRD,EAASC,KAAKD,MACH,gBAAXsvB,EAAE1oB,KACF3G,KAAK00B,SAAU,EAEC,aAAXrF,EAAE1oB,MACP0oB,EAAE8R,2BAEN9R,EAAE6Q,iBACEngC,EAAOie,WACPhe,KAAKw3B,qBAAqBnI,EAE9B,IAAI7uB,GACAC,CACW,aAAX4uB,EAAE1oB,MACFnG,EAAI6uB,EAAEG,QACN/uB,EAAI4uB,EAAEI,UAGNjvB,EAAIR,KAAK+1B,cAAcv1B,EACvBC,EAAIT,KAAK+1B,cAAct1B,EAE3B,IAAI0/B,GAAOpgC,EAAOqC,YAAYytB,uBAC9BrvB,IAAK2/B,EAAKllB,KACVxa,GAAK0/B,EAAKzZ,IACK,aAAX2I,EAAE1oB,OACF3G,KAAKk1B,aAAel1B,KAAKm1B,eACzBn1B,KAAKi1B,aAAc,EACmB,SAAlCl1B,EAAO+c,SAASjB,MAAMG,UACtBhc,KAAK24B,MAAQ,GAGrB,IACIjsB,GADAwR,GAAkB,CAQtB,QAN+BzK,KAA3B1T,EAAO6C,UAAUwC,QACjBsH,EAAa3M,EAAO6C,UAAUwC,MAAMuH,MAAM,UAE3B8G,KAAf/G,GAA8C,SAAlBA,EAAW,KACvCwR,GAAkB,GAElBhS,cAAclM,KAAKD,OAAOo8B,UAAW,CACrC,GAA8B,QAA1Bn8B,KAAKD,OAAOo8B,UACRp8B,EAAOoM,SAAiD,IAAvCpM,EAAOoM,OAAOi1B,SAASh1B,aACxCrM,EAAOsM,UAAUC,kBAAkB,gBAAiB,WAAYtM,KAAKD,OAAOshC,kBAG/E,IAA8B,WAA1BrhC,KAAKD,OAAOo8B,WACjB,IAAKn8B,KAAKke,iBAAmBle,KAAKD,OAAOoM,SAA8D,IAApDnM,KAAKD,OAAOoM,OAAOm1B,iBAAiBl1B,YACnFpM,KAAKs7B,kBAAkB3H,qBAAuB3zB,KAAK83B,0BACnD93B,KAAKs7B,kBAAkBzb,OAAsC,KAA7B7f,KAAKi2B,oBAA6B,UAAY,aAE9Ej2B,KAAKD,OAAOsM,UAAUC,kBAAkB,kBAAmB,mBAAoBtM,KAAKs7B,mBAAmB/uB,KAAK,SAAU+uB,GAClH/vB,EAAMxL,OAAO+C,OAAO,SAAWxB,KAAM,6BAA8ByB,kBAAkB,EACjFvB,OAAS8xB,cAAegI,EAAkB3H,8BAGjD,IAAI3zB,KAAKs7B,mBAAqBt7B,KAAKq8B,uBAAyBr8B,KAAKD,OAAOoM,SACjB,IAAxDnM,KAAKD,OAAOoM,OAAOo1B,qBAAqBn1B,YAAsB,CAC9D,GAAI2T,IAA6BpZ,KAAM3G,KAAKD,OAAO6C,UAAUwC,MACzDjF,OAAQH,KAAKs7B,kBAAkB3H,qBAAqBxzB,OACpDC,OAAQJ,KAAKs7B,kBAAkB3H,qBAAqBvzB,OACpDC,MAAOL,KAAKs7B,kBAAkB3H,qBAAqBtzB,MACnDC,OAAQN,KAAKs7B,kBAAkB3H,qBAAqBrzB,OACxDN,MAAKq8B,sBAAsBtc,yBAA2BA,EACtD/f,KAAKq8B,sBAAsBxc,OAAS,aAEpC7f,KAAKD,OAAOsM,UAAUC,kBAAkB,sBAAuB,uBAAwBtM,KAAKq8B,uBAAuB9vB,KAAK,SAAU8vB,GAC9H9wB,EAAMxL,OAAO+C,OAAO,SAAWxB,KAAM,iCAAkCyB,kBAAkB,EACrFvB,OAASyU,kBAAmBomB,EAAsBtc,mCAK1D/f,MAAKu7B,iBAAmBv7B,KAAKD,OAAOoM,SAA4D,IAAlDnM,KAAKD,OAAOoM,OAAOq1B,eAAep1B,cAChFpM,KAAKu7B,gBAAgB5H,qBAAuB3zB,KAAK83B,0BACjD93B,KAAKu7B,gBAAgB1b,OAAS,WAE9B7f,KAAKD,OAAOsM,UAAUC,kBAAkB,kBAAmB,iBAAkBtM,KAAKu7B,iBAAiBhvB,KAAK,SAAUgvB,GAC9GhwB,EAAMxL,OAAO+C,OAAO,SAAWxB,KAAM,6BAA8ByB,kBAAkB,EACjFvB,OAAS8xB,cAAeiI,EAAgB5H,0BAIxD3zB,MAAKs7B,kBAAoB,KACzBt7B,KAAKu7B,gBAAkB,KACvBv7B,KAAKD,OAAOshC,aAAe,KAC3BrhC,KAAKD,OAAOo8B,UAAY,KAE5B,GAAiC,SAA7Bn8B,KAAKi2B,oBAAT,CAGA,GAAI5G,EAAEwP,gBAAkB9+B,EAAOwC,YAAa,CAExC,GADAvC,KAAK44B,kBAAoB,KACQ,KAA7B54B,KAAKi2B,oBAA4B,CACjC,GAAiC,SAA7Bj2B,KAAKi2B,oBAAgC,CACrC,GAAIwL,GAAgBz9B,YAAWjE,EAAOiG,YAAa,EACnDjG,GAAO+C,OAAO,aAAexB,KAAM,qBAAsByB,kBAAkB,EACvEvB,OAAS6L,UAAW,iBAAkBC,YAAatN,KAAKk2B,eAAgB3oB,gBAAiBvN,KAAKk2B,eAAehxB,QACzGsI,kBAAmBxN,KAAKk2B,eAAejvB,UAAWwG,qBAAsBzN,KAAKk2B,eAAe9sB,aAC5FsE,gBAAiB+zB,EAAe9zB,aAAc,KAC9CC,YAAa,KAAMC,eAAgB,KAAMrI,aAAc,YAG/DzF,GAAO+C,OAAO,aAAexB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAAS0D,QAASlF,KAAKk2B,eAAehxB,UAErHlF,MAAK80B,iBAAkB,EACvB90B,KAAKi2B,oBAAsB,GACgB,IAAvCl2B,EAAO6C,UAAUC,YAAYxC,OAAuD,IAAxCN,EAAO6C,UAAUC,YAAYvC,QACzEP,EAAO+C,OAAO,QAAUxB,KAAM,gBAAiBE,OAASgI,oBAAqB,QAGrFxJ,KAAKg4B,2BACLh4B,KAAK04B,qBACL34B,EAAO0F,YAAYL,MAAQrF,EAAO0F,YAAYL,MAAMwN,aACpD,IAAI9F,GAAc9I,YAAWjE,EAAOiG,YAAa,GAC7CF,GAAWC,WACfhG,GAAO+C,OAAO,UAAYxB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAASsE,OAAQA,IAC3F,IAAIiH,GAAUjH,EAAgB,OAC9BiH,GAAQ7H,QAAUlB,YAAWjE,EAAOmF,YAAa,GACjD6H,EAAQ9F,UAAYjD,YAAWjE,EAAOkH,cAAe,GACrD8F,EAAQlH,iBAAmB7B,YAAWjE,EAAO8F,qBAAsB,EACnE,IAAIuZ,IAAoBhW,aAAc,KAyBtC,IAxBArJ,EAAO+C,OAAO,iBAAmBxB,KAAM,kBAAmByB,kBAAkB,EACxEvB,OAASyC,IAAKmb,KAClBrS,EAAQ3D,aAAepF,YAAWob,EAA8B,iBAAO,GAClErf,EAAOse,WAAcH,IAClBle,KAAKqhB,aAAsD,IAAvCthB,EAAO6C,UAAUC,YAAYxC,QACjDN,EAAOmF,QAAQe,KAAKlG,EAAO6C,WACvB8+B,KAAKC,UAAU5hC,EAAO6C,UAAUC,eAAiB6+B,KAAKC,UAAU3hC,KAAKshB,cAAcze,cACnF9C,EAAO+C,OAAO,aAAexB,KAAM,qBAAsByB,kBAAkB,EACvEvB,OAAS6L,UAAW,iBAAkBC,YAAaP,EAASQ,gBAAiBvN,KAAKqhB,YAC9E7T,kBAAmBT,EAAQ9F,UAAWwG,qBAAsBV,EAAQ3D,aACpEsE,gBAAiBZ,EAAaa,aAAc,KAC5CC,YAAa,KAAMC,eAAgB,KAAMrI,aAAc,QAEnExF,KAAKi3B,YAAYl3B,EAAOmF,QAAQnF,EAAOmF,QAAQC,OAAS,IAAI,GAC5DnF,KAAKqhB,gBAAc5N,IAElBzT,KAAKg2B,eACNh2B,KAAK4hC,gBAAgBphC,EAAGC,GACxBV,EAAO0F,YAAY2zB,UAAW,EACzBltB,cACDnM,EAAO+C,OAAO,WAAaxB,KAAM,qBAAsByB,kBAAkB,MAIjFhD,EAAO6C,UAAW,CAClB,GACIi/B,GADAC,GAAoB,CAWxB,QAT+BruB,KAA3B1T,EAAO6C,UAAUwC,QACjBy8B,EAAe9hC,EAAO6C,UAAUwC,MAAMuH,MAAM,UAE3B8G,KAAjBouB,IAA+B9hC,EAAO0F,YAAYC,cAAgB3F,EAAOse,WACzEyjB,GAAoB,MAEEruB,KAAjBouB,GAAkD,SAApBA,EAAa,KAChDC,GAAoB,GAEnB51B,aAqB+B,cAA3BnM,EAAO6C,UAAUwC,OAAsD,YAA3BrF,EAAO6C,UAAUwC,OAC/B,SAA3BrF,EAAO6C,UAAUwC,OAA+C,UAA3BrF,EAAO6C,UAAUwC,OAAgD,SAA3BrF,EAAO6C,UAAUwC,MAChGrF,EAAO+N,cAAc/N,EAAOgO,QAAShO,EAAO6C,UAAUwC,OAEtB,SAA3BrF,EAAO6C,UAAUwC,OACtBrF,EAAO+N,cAAc/N,EAAOgO,QAAS,YA1B5B,CACb,GAAgC,cAA3BhO,EAAO6C,UAAUwC,OAAsD,YAA3BrF,EAAO6C,UAAUwC,OAC/B,SAA3BrF,EAAO6C,UAAUwC,OAA+C,UAA3BrF,EAAO6C,UAAUwC,OAAgD,SAA3BrF,EAAO6C,UAAUwC,MAChGrF,EAAO+C,OAAO,WAAaxB,KAAM,kBAAmByB,kBAAkB,EAAOvB,OAASmF,KAAM,SACpF8C,WAAY,KAAMC,WAAY,KAAMC,UAAW,KAAMC,MAAO,YAEnE,IAA+B,SAA3B7J,EAAO6C,UAAUwC,MACtBrF,EAAO+C,OAAO,WAAaxB,KAAM,kBAAmByB,kBAAkB,EAAOvB,OAASmF,KAAM,OACpF8C,WAAY,KAAMC,WAAY,KAAMC,UAAW,KAAMC,MAAO,YAEnE,IAAI5J,KAAKg2B,aACVj2B,EAAO+C,OAAO,WAAaxB,KAAM,kBAAmByB,kBAAkB,EAAOvB,OAASmF,KAAM,MACpF8C,WAAY,KAAMC,WAAY,KAAMC,UAAW,KAAMC,MAAO,YAEnE,KAAKk4B,EAAmB,CACzB,GAAIxlB,IAAc3V,KAAM,OAAQ8C,WAAY,KAAMC,YAAY,EAAOC,UAAW,KAChF5J,GAAO+C,OAAO,WAAaxB,KAAM,kBAAmByB,kBAAkB,EAAOvB,MAAO8a,IAExFvc,EAAO+C,OAAO,WAAaxB,KAAM,uBAAwByB,kBAAkB,UAaxD0Q,KAA3B1T,EAAO6C,UAAUwC,QACjBsH,EAAa3M,EAAO6C,UAAUwC,MAAMuH,MAAM,UAE3B8G,KAAf/G,GAA8C,SAAlBA,EAAW,KACvCwR,GAAkB,GAElBne,EAAO6C,UAAUwC,QAAU8Y,GAAmBmR,EAAEwP,gBAAkB9+B,EAAOwC,aACvC,SAAlCxC,EAAO+c,SAASjB,MAAMG,UACS,SAA3Bjc,EAAO6C,UAAUwC,MACZ8G,cACDnM,EAAO+C,OAAO,WAAaxB,KAAM,kBAAmByB,kBAAkB,EAAOvB,OAASmF,KAAM,OACpF8C,WAAY,KAAMC,WAAY,KAAMC,UAAW,KAAMC,MAAO,QAInEsC,cACDnM,EAAO+C,OAAO,WAAaxB,KAAM,kBAAmByB,kBAAkB,EAAOvB,OAASmF,KAAM,SACpF8C,WAAY,KAAMC,WAAY,KAAMC,UAAW,KAAMC,MAAO,QAGvEsC,aAKDnM,EAAO+N,cAAc/N,EAAOgO,QAAS,qBAAsBhO,EAAO6C,UAAUwC,QAJ5ErF,EAAO+C,OAAO,WAAaxB,KAAM,uBAAwByB,kBAAkB,IAC3EhD,EAAO+C,OAAO,WAAaxB,KAAM,YAAayB,kBAAkB,EAAOvB,OAASw+B,UAAW,UAM/FjgC,EAAOse,WAAagR,EAAEwP,gBAAkB9+B,EAAOwC,YAC/CxC,EAAO+C,OAAO,iBAAmBxB,KAAM,oBAAqByB,kBAAkB,EAC1EvB,OAAS6tB,EAAGA,EAAGhqB,OAAQtF,EAAOwC,YAAagD,QAASvF,KAAKwC,gBAG7DzC,EAAO0F,YAAYL,MAAQ,GAE/BpF,KAAKu1B,YAAc,GACnBx1B,EAAO0F,YAAYs8B,cAAgBhiC,EAAO0F,YAAYwZ,YAAa,EACnEjf,KAAKs2B,oBAET/B,EAAU1zB,UAAUm3B,yBAA2B,SAAU/zB,GACrD,GAAI+9B,IAAa,EACbjiC,EAASC,KAAKD,MAElB,KADAkE,EAAMA,GAAYlE,EAAO6C,WACjBwC,QAAwB,SAAdnB,EAAImB,OAA+C,UAA3BrF,EAAO6C,UAAUwC,OAAoB,CAC3E,GAAIV,OAAO,EAaX,KAZ0B,aAArB1E,KAAKu1B,aAA8BtxB,EAAIpB,YAAYkF,KAAO9D,EAAIpB,YAAY1C,QACrD,aAArBH,KAAKu1B,aAA8BtxB,EAAIpB,YAAY1C,OAAS8D,EAAIpB,YAAYkF,QAC7Ei6B,GAAa,EACbt9B,EAAOT,EAAIpB,YAAY1C,OACvB8D,EAAIpB,YAAY1C,OAAS8D,EAAIpB,YAAYkF,KACzC9D,EAAIpB,YAAYkF,KAAOrD,EACvBA,EAAOT,EAAIpB,YAAYzC,OACvB6D,EAAIpB,YAAYzC,OAAS6D,EAAIpB,YAAYmF,KACzC/D,EAAIpB,YAAYmF,KAAOtD,GAE3BT,EAAIpB,YAAYxC,MAAQ8H,KAAKC,IAAInE,EAAIpB,YAAYkF,KAAO9D,EAAIpB,YAAY1C,QACxE8D,EAAIpB,YAAYvC,OAAS6H,KAAKC,IAAInE,EAAIpB,YAAYmF,KAAO/D,EAAIpB,YAAYzC,QAC1C,SAA3BL,EAAO6C,UAAUwC,MAAkB,CACnCrF,EAAO+C,OAAO,SAAWxB,KAAM,2BAA4ByB,kBAAkB,EACzEvB,OAASyC,IAAKA,IAElB,KAAK,GAAIe,GAAI,EAAGA,EAAIf,EAAIgD,UAAU9B,OAAQH,IACtCf,EAAIgD,UAAUjC,GAAG2D,QAAU1E,EAAIgD,UAAUjC,GAAGxE,EACxCT,EAAOqD,IAAIC,UAAYtD,EAAOqD,IAAIG,UACtCU,EAAIgD,UAAUjC,GAAG4D,QAAU3E,EAAIgD,UAAUjC,GAAGvE,EACxCV,EAAOqD,IAAIE,SAAWvD,EAAOqD,IAAII,YAIjD,MAAOw+B,IAEXzN,EAAU1zB,UAAU63B,mBAAqB,SAAUz0B,GAC/C,GAAIlE,GAASC,KAAKD,MAElB,KADAkE,EAAMA,GAAYlE,EAAO6C,WACjBwC,OAA8B,IAArBnB,EAAI2P,aAAoB,CACrC7T,EAAO+C,OAAO,SAAWxB,KAAM,+BAAgCyB,kBAAkB,EAC7EvB,OAASyC,IAAKA,IAElB,KAASe,EAAI,EAAGA,EAAIf,EAAIs1B,oBAAoBp0B,OAAQH,IAChDf,EAAIs1B,oBAAoBv0B,GAAG2D,QAAU1E,EAAIs1B,oBAAoBv0B,GAAGxE,EAC5DT,EAAOqD,IAAIC,UAAYtD,EAAOqD,IAAIG,UACtCU,EAAIs1B,oBAAoBv0B,GAAG4D,QAAU3E,EAAIs1B,oBAAoBv0B,GAAGvE,EAC5DV,EAAOqD,IAAIE,SAAWvD,EAAOqD,IAAII,UAEzC,KAASwB,EAAI,EAAGA,EAAIf,EAAIy1B,uBAAuBv0B,OAAQH,IACnDf,EAAIy1B,uBAAuB10B,GAAG2D,QAAU1E,EAAIy1B,uBAAuB10B,GAAGxE,EAClET,EAAOqD,IAAIC,UAAYtD,EAAOqD,IAAIG,UACtCU,EAAIy1B,uBAAuB10B,GAAG4D,QAAU3E,EAAIy1B,uBAAuB10B,GAAGvE,EAClEV,EAAOqD,IAAIE,SAAWvD,EAAOqD,IAAII,UAEzC,KAASwB,EAAI,EAAGA,EAAIf,EAAIu1B,qBAAqBr0B,OAAQH,IACjDf,EAAIu1B,qBAAqBx0B,GAAG2D,QAAU1E,EAAIu1B,qBAAqBx0B,GAAGxE,EAC9DT,EAAOqD,IAAIC,UAAYtD,EAAOqD,IAAIG,UACtCU,EAAIu1B,qBAAqBx0B,GAAG4D,QAAU3E,EAAIu1B,qBAAqBx0B,GAAGvE,EAC9DV,EAAOqD,IAAIE,SAAWvD,EAAOqD,IAAII,UAEzC,KAAK,GAAIwB,GAAI,EAAGA,EAAIf,EAAIw1B,sBAAsBt0B,OAAQH,IAClDf,EAAIw1B,sBAAsBz0B,GAAG2D,QAAU1E,EAAIw1B,sBAAsBz0B,GAAGxE,EAChET,EAAOqD,IAAIC,UAAYtD,EAAOqD,IAAIG,UACtCU,EAAIw1B,sBAAsBz0B,GAAG4D,QAAU3E,EAAIw1B,sBAAsBz0B,GAAGvE,EAChEV,EAAOqD,IAAIE,SAAWvD,EAAOqD,IAAII,aAIjD+wB,EAAU1zB,UAAUm+B,YAAc,SAAU3P,GACxCA,EAAE6Q,gBACF,IAAI1/B,GACAC,CACW,eAAX4uB,EAAE1oB,MACFnG,EAAI6uB,EAAEG,QACN/uB,EAAI4uB,EAAEI,UAGNzvB,KAAK+1B,cAAcv1B,EAAIA,EAAI6uB,EAAEK,QAAQ,GAAGF,QACxCxvB,KAAK+1B,cAAct1B,EAAIA,EAAI4uB,EAAEK,QAAQ,GAAGD,QAE5C,IAAI0Q,GAAOngC,KAAKD,OAAOqC,YAAYytB,uBAGnC,OAFArvB,IAAK2/B,EAAKllB,KACVxa,GAAK0/B,EAAKzZ,KACDlmB,EAAGA,EAAGC,EAAGA,IAEtB8zB,EAAU1zB,UAAUohC,gBAAkB,WAGlC,IAAK,GAFD5O,GACAtzB,EAASC,KAAKD,OACTiF,EAAI,EAAGA,EAAIjF,EAAOmF,QAAQC,OAAQH,IACvC,GAAIjF,EAAO6C,UAAUic,YAAc9e,EAAOmF,QAAQF,GAAG6Z,UAAW,CAC5DwU,EAAQruB,CACR,OAGR,MAAOquB,IAEXkB,EAAU1zB,UAAU2+B,aAAe,SAAUnQ,EAAGnR,GAC5C,GAAIne,GAASC,KAAKD,OACdq/B,GAAU,CACd,IAAIr/B,EAAOse,UACP,MAAO+gB,EAEX,IAAIr/B,EAAO6C,UAAUwC,OAAoC,SAA3BrF,EAAO6C,UAAUwC,OAAoBpF,KAAK80B,gBAAiB,CACrF,GAAI0G,GAA+C,UAAlCz7B,EAAO+c,SAASjB,MAAMG,QACnCpZ,EAAYoB,YAAWjE,EAAO6C,UAAW,MAAM,EACnD7C,GAAO+C,OAAO,SAAWxB,KAAM,eAAgByB,kBAAkB,EAC7DvB,OAAShB,EAAG,KAAMC,EAAG,KAAM8a,aAAa,IAC5C,IAAI1S,GAAS7I,KAAKg/B,YAAY3P,GAC1B7uB,EAAIqI,EAAOrI,EACXC,EAAIoI,EAAOpI,CAKf,IAJA2+B,EAAUp/B,KAAKkiC,cAAc1hC,EAAGC,EAAGyd,GAC9BA,GACDle,KAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOwC,YAAYlC,MAAON,EAAOwC,YAAYjC,QAE/Ek7B,EAAY,CACZz7B,EAAO+c,SAAStb,MAAQzB,EAAOmF,QAAQnF,EAAOmF,QAAQC,OAAS,GAAGgO,WAClEpT,EAAO+c,SAASjB,MAAMG,QAAU,QAChCjc,EAAO6C,UAAYA,CACfywB,GAAQrzB,KAAKiiC,iBACbhgC,qBAAkBoxB,GAClBtzB,EAAOmF,QAAQwB,MAGf3G,EAAOmF,QAAQi9B,OAAO9O,EAAO,OAGhC,KAAK+L,GAAWx8B,EAAUwC,MAAO,CAClCrF,EAAO6C,UAAYA,CACnB,IAAIywB,GAAQrzB,KAAKiiC,iBACXhgC,qBAAkBoxB,IACpBqO,KAAKC,UAAU5hC,EAAO6C,UAAUC,eAAiB6+B,KAAKC,UAAU5hC,EAAOmF,QAAQmuB,GAAOxwB,aAGjFZ,oBAAkBlC,EAAO6C,UAAUic,YACxC9e,EAAOmF,QAAQwB,MAHf3G,EAAOmF,QAAQi9B,OAAO9O,EAAO,IAOzC,MAAO+L,IAEX7K,EAAU1zB,UAAUw+B,aAAe,SAAUhQ,EAAGnR,GAC5C,GAAIne,GAASC,KAAKD,OACdq/B,GAAU,CACd,IAAe,eAAX/P,EAAE1oB,OAA0B5G,EAAOse,UAAW,CAC1Cte,EAAO6C,WAAwC,SAA3B7C,EAAO6C,UAAUwC,QACrCpF,KAAK24B,MAAQ3B,WAAWh3B,KAAKoiC,SAASte,KAAK9jB,MAAO,IAAMqvB,GAE5D,IAAImM,GAA+C,UAAlCz7B,EAAO+c,SAASjB,MAAMG,QACnCpZ,EAAYoB,YAAWjE,EAAO6C,UAAW,MAAM,EACnD7C,GAAO+C,OAAO,SAAWxB,KAAM,eAAgByB,kBAAkB,EAC7DvB,OAAShB,EAAG,KAAMC,EAAG,KAAM8a,aAAa,IAC5C,IAAI1S,GAAS7I,KAAKg/B,YAAY3P,GAC1B7uB,EAAIqI,EAAOrI,EACXC,EAAIoI,EAAOpI,CAKf,IAJA2+B,EAAUp/B,KAAKkiC,cAAc1hC,EAAGC,EAAGyd,GAC9BA,GACDle,KAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOwC,YAAYlC,MAAON,EAAOwC,YAAYjC,QAE/Ek7B,EAAY,CACZz7B,EAAO+c,SAAStb,MAAQzB,EAAOmF,QAAQnF,EAAOmF,QAAQC,OAAS,GAAGgO,WAClEpT,EAAO+c,SAASjB,MAAMG,QAAU,QAChCjc,EAAO6C,UAAYA,CACfywB,GAAQrzB,KAAKiiC,iBACbhgC,qBAAkBoxB,GAClBtzB,EAAOmF,QAAQwB,MAGf3G,EAAOmF,QAAQi9B,OAAO9O,EAAO,OAGhC,KAAK+L,GAAWx8B,EAAUwC,MAAO,CAClCrF,EAAO6C,UAAYA,CACnB,IAAIywB,GAAQrzB,KAAKiiC,iBACZ/jB,KACKjc,oBAAkBoxB,IAAUqO,KAAKC,UAAU5hC,EAAO6C,UAAUC,eAC9D6+B,KAAKC,UAAU5hC,EAAOmF,QAAQmuB,GAAOxwB,aAGhCZ,oBAAkBlC,EAAO6C,UAAUic,YACxC9e,EAAOmF,QAAQwB,MAHf3G,EAAOmF,QAAQi9B,OAAO9O,EAAO,KAS7C,MAAO+L,IAEX7K,EAAU1zB,UAAU0+B,oBAAsB,SAAUlQ,EAAGnR,GACnD,GAAIne,GAASC,KAAKD,OACdu/B,GAAiB,CACrB,IAAe,eAAXjQ,EAAE1oB,OAA0BuX,IAAoBne,EAAOse,UAAW,CAClE,GAAImd,GAA+C,UAAlCz7B,EAAO+c,SAASjB,MAAMG,QACnCpZ,EAAYoB,YAAWjE,EAAO6C,UAAW,MAAM,EACnD7C,GAAO+C,OAAO,SAAWxB,KAAM,eAAgByB,kBAAkB,EAC7DvB,OAAShB,EAAG,KAAMC,EAAG,KAAM8a,aAAa,IAC5C,IAAI1S,GAAS7I,KAAKg/B,YAAY3P,GAC1B7uB,EAAIqI,EAAOrI,EACXC,EAAIoI,EAAOpI,CAKf,IAJAT,KAAKu2B,UAAU/1B,EAAGC,GACdT,KAAK40B,aACL0K,GAAiB,GAEjB9D,EAAY,CACZz7B,EAAO+c,SAAStb,MAAQzB,EAAOmF,QAAQnF,EAAOmF,QAAQC,OAAS,GAAGgO,WAClEpT,EAAO+c,SAASjB,MAAMG,QAAU,QAChCjc,EAAO6C,UAAYA,CACfywB,GAAQrzB,KAAKiiC,iBACbhgC,qBAAkBoxB,GAClBtzB,EAAOmF,QAAQwB,MAGf3G,EAAOmF,QAAQi9B,OAAO9O,EAAO,OAGhC,IAAIzwB,EAAUwC,MAAO,CACtBrF,EAAO6C,UAAYA,CACnB,IAAIywB,GAAQrzB,KAAKiiC,iBACZ/jB,KACKjc,oBAAkBoxB,IAAUqO,KAAKC,UAAU5hC,EAAO6C,UAAUC,eAC9D6+B,KAAKC,UAAU5hC,EAAOmF,QAAQmuB,GAAOxwB,aAGhCZ,oBAAkBlC,EAAO6C,UAAUic,YACxC9e,EAAOmF,QAAQwB,MAHf3G,EAAOmF,QAAQi9B,OAAO9O,EAAO,KAQ7C,MAAOiM,IAEX/K,EAAU1zB,UAAU4+B,SAAW,SAAUj/B,EAAGC,GACxC,GAAIV,GAASC,KAAKD,OACdg5B,GAAU,CAmBd,QAlBIh5B,EAAO6C,UAAUwC,OAAqC,cAA3BrF,EAAO6C,UAAUwC,OAAoD,YAA3BrF,EAAO6C,UAAUwC,OAC3D,SAA3BrF,EAAO6C,UAAUwC,OAA+C,SAA3BrF,EAAO6C,UAAUwC,OAA+C,UAA3BrF,EAAO6C,UAAUwC,OAChE,SAA3BrF,EAAO6C,UAAUwC,QAKb2zB,IAJAv4B,GAAMT,EAAO6C,UAAUC,YAAY1C,OAAkD,EAAxCJ,EAAO6C,UAAUkS,cAAcpK,QAC5ElK,GAAMT,EAAO6C,UAAUC,YAAYkF,KAAgD,EAAxChI,EAAO6C,UAAUkS,cAAcpK,QAC1EjK,GAAMV,EAAO6C,UAAUC,YAAYzC,OAAkD,EAAxCL,EAAO6C,UAAUkS,cAAcpK,QAC5EjK,GAAMV,EAAO6C,UAAUC,YAAYmF,KAAgD,EAAxCjI,EAAO6C,UAAUkS,cAAcpK,UAGjC,YAApC3K,EAAOwC,YAAYsZ,MAAMgC,QAA4D,SAApC9d,EAAOwC,YAAYsZ,MAAMgC,QAC3C,cAApC9d,EAAOwC,YAAYsZ,MAAMgC,QAA8D,YAApC9d,EAAOwC,YAAYsZ,MAAMgC,QACxC,SAApC9d,EAAOwC,YAAYsZ,MAAMgC,SAO1Bkb,GAEXxE,EAAU1zB,UAAUg2B,eAAiB,SAAU2I,GAC3C,GAAIz/B,GAASC,KAAKD,OACdg5B,GAAU,CACd,IAAIh5B,EAAOse,UACP,MAAO0a,EAEX,IAAI90B,GAAMD,YAAWjE,EAAO6C,UAAW,MAAM,EAK7C,IAJI5C,KAAK80B,iBAA8C,SAA3B/0B,EAAO6C,UAAUwC,OAAoBo6B,IAC7Dx/B,KAAK41B,qBAAsB,EAC3B71B,EAAO+C,OAAO,QAAUxB,KAAM,qBAAsByB,kBAAkB,EAAOvB,OAAS4E,MAAM,MAE1D,UAAlCrG,EAAO+c,SAASjB,MAAMG,QAAqB,CAC3C,GAAIpZ,GAAYoB,YAAWjE,EAAO6C,UAAW,MAAM,EACnD7C,GAAO+C,OAAO,SAAWxB,KAAM,eAAgByB,kBAAkB,EAC7DvB,OAAShB,EAAG,KAAMC,EAAG,KAAM8a,YAAa,QAC5CtX,EAAMD,YAAWjE,EAAOmF,QAAQnF,EAAOmF,QAAQC,OAAS,GAAI,MAAM,GAClEpF,EAAOmF,QAAQwB,MACf3G,EAAO6C,UAAYoB,YAAWpB,EAAW,MAAM,GAC/C7C,EAAO+c,SAAStb,MAAQyC,EAAIkP,WAC5BpT,EAAO+c,SAASjB,MAAMG,QAAU,OAChC,IAAIjN,GAAc9K,EAAI8O,gBAAkB9O,EAAI8O,eAAehE,YAA+D,QAAjD9K,EAAI8O,eAAehE,YAAYpC,MAAM,KAAK,GAC/G3M,KAAKqiC,SAAS1a,WAAW1jB,EAAI8O,eAAehE,YAAYpC,MAAM,KAAK,GAAGA,MAAM,KAAK,IAAKgb,WAAW1jB,EAAI8O,eAAehE,YAAYpC,MAAM,KAAK,GAAGA,MAAM,KAAK,IAAKgb,WAAW1jB,EAAI8O,eAAehE,YAAYpC,MAAM,KAAK,GAAGA,MAAM,KAAK,KACjO1I,EAAI8O,eAAehE,YAAc,IACjCA,IAA+B,YAAhBA,IACfA,EAAc,QAEd/O,KAAKshB,cAAcvO,gBAAkB/S,KAAKshB,cAAcvO,eAAehE,aACrB,YAAlD/O,KAAKshB,cAAcvO,eAAehE,cAClC/O,KAAKshB,cAAcvO,eAAehE,YAAc,SAEhD9K,EAAIkP,aAAenT,KAAKshB,cAAcnO,YACrCpE,GAAgBA,IAAgB/O,KAAKshB,cAAcvO,eAAehE,aACnE9K,EAAIoE,aAAa+G,aAAepP,KAAKshB,cAAcjZ,aAAa+G,YAChEjH,KAAK2jB,MAAM7nB,EAAIoE,aAAaE,YAAcJ,KAAK2jB,MAAM9rB,KAAKshB,cAAcjZ,aAAaE,WACrFJ,KAAK2jB,MAAM7nB,EAAIoE,aAAaC,aAAeH,KAAK2jB,MAAM9rB,KAAKshB,cAAcjZ,aAAaC,YACtFrE,EAAIoE,aAAagH,OAASrP,KAAKshB,cAAcjZ,aAAagH,MAC1DpL,EAAIoE,aAAaiH,SAAWtP,KAAKshB,cAAcjZ,aAAaiH,QAC5DrL,EAAIoE,aAAakH,YAAcvP,KAAKshB,cAAcjZ,aAAakH,aAC/DwpB,GAAU,GAEV/4B,KAAK41B,sBAAwBmD,IAC7BA,GAAU,EACV/4B,KAAK41B,qBAAsB,OAI/B51B,MAAKshB,cAAcze,YAAYvC,OAAS6H,KAAKC,IAAIpI,KAAKshB,cAAcze,YAAYvC,QAChFy4B,EAAU2I,KAAKC,UAAU19B,KAASy9B,KAAKC,UAAU3hC,KAAKshB,cAE1D,OAAOyX,IAEXxE,EAAU1zB,UAAUy2B,uBAAyB,SAAUjI,GACnD,GAAItvB,GAASC,KAAKD,MAClBsvB,GAAE6Q,gBACF,IAAI1/B,GACAC,CACW,eAAX4uB,EAAE1oB,MACFnG,EAAI6uB,EAAEiT,SAAYjT,EAAEgR,MAAQtgC,EAAOqC,YAAYk+B,WAC/C7/B,EAAI4uB,EAAEkT,SAAYlT,EAAEkR,MAAQxgC,EAAOqC,YAAYo+B,YAG/ChgC,EAAI6uB,EAAEK,QAAQ,GAAGF,SAAYH,EAAEK,QAAQ,GAAG2Q,MAAQtgC,EAAOqC,YAAYk+B,WACrE7/B,EAAI4uB,EAAEK,QAAQ,GAAGD,SAAYJ,EAAEK,QAAQ,GAAG6Q,MAAQxgC,EAAOqC,YAAYo+B,UAEzE,IAAIL,GAAOpgC,EAAOqC,YAAYytB,uBAC9BrvB,IAAK2/B,EAAKllB,KACVxa,GAAK0/B,EAAKzZ,IACV1mB,KAAK+3B,SAAYv3B,EAAGA,EAAGC,EAAGA,EAC1B,IAAI+hC,IAAmBC,YAAa,KACpC1iC,GAAO+C,OAAO,aAAexB,KAAM,iBAAkByB,kBAAkB,EACnEvB,OAASyC,IAAKu+B,KACdvgC,oBAAkBugC,EAA4B,cAC9CziC,EAAO+C,OAAO,aAAexB,KAAM,iBAAkByB,kBAAkB,EACnEvB,OAAS2B,OAAS3C,EAAGA,EAAGC,EAAGA,OAGvC8zB,EAAU1zB,UAAU02B,uBAAyB,SAAUlI,GACnD,GAAItvB,GAASC,KAAKD,MACdC,MAAK61B,WACL91B,EAAOqC,YAAYyZ,MAAMgC,OAAS,QAGlC7d,KAAK61B,WAAa91B,EAAOie,WAAY,EACrCje,EAAOqC,YAAYyZ,MAAMgC,OAAS9d,EAAOwC,YAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS,UAExF,IAAIrd,GACAC,CACW,eAAX4uB,EAAE1oB,MACFnG,EAAI6uB,EAAEiT,QACN7hC,EAAI4uB,EAAEkT,UAGN/hC,EAAI6uB,EAAEK,QAAQ,GAAGF,SAAYH,EAAEK,QAAQ,GAAG2Q,MAAQtgC,EAAOqC,YAAYk+B,WACrE7/B,EAAI4uB,EAAEK,QAAQ,GAAGD,SAAYJ,EAAEK,QAAQ,GAAG6Q,MAAQxgC,EAAOqC,YAAYo+B,UAEzE,IAAIL,GAAOpgC,EAAOqC,YAAYytB,wBAG1B6S,GAAYliC,EAFhBA,GAAK2/B,EAAKllB,KAEYxa,EADtBA,GAAK0/B,EAAKzZ,IAEV3mB,GAAO+C,OAAO,aAAexB,KAAM,aAAcyB,kBAAkB,EAC/DvB,OAAS2B,OAAS3C,EAAGA,EAAGC,EAAGA,MAC3BT,KAAK+3B,SAAW2K,GAAW3iC,EAAOie,WAAahe,KAAK61B,YACpD91B,EAAO+C,OAAO,aAAexB,KAAM,kBAAmByB,kBAAkB,EACpEvB,OAAS0I,MAAO,KAAMC,MAAO,SAGzCoqB,EAAU1zB,UAAU22B,qBAAuB,SAAUnI,GACjD,GAAItvB,GAASC,KAAKD,MAClBsvB,GAAE6Q,gBACF,IAAIyC,IAAeD,QAAS,KAC5B3iC,GAAO+C,OAAO,aAAexB,KAAM,aAAcyB,kBAAkB,EAC/DvB,OAASyC,IAAK0+B,KACd5iC,EAAOie,WACHhe,KAAK+3B,SAAW4K,EAAoB,SAAK5iC,EAAOie,WAAahe,KAAK61B,aAClE71B,KAAK+3B,QAAU,KACfh4B,EAAO+C,OAAO,aAAexB,KAAM,aAAcyB,kBAAkB,EAC/DvB,OAAS2B,MAAO,QACpBpD,EAAO+C,OAAO,aAAexB,KAAM,iBAAkByB,kBAAkB,EACnEvB,OAAS2B,MAAO,SAGK,SAA7BnD,KAAKi2B,sBACLl2B,EAAO0F,YAAYwZ,YAAa,IAGxCsV,EAAU1zB,UAAU42B,kBAAoB,SAAUpI,GAC9CA,EAAE6Q,iBACqB,IAAnBlgC,KAAKm2B,UACLn2B,KAAKm2B,WAAY,GAAI7G,OAAOC,WAGtB,GAAID,OAAOC,UAAavvB,KAAKm2B,UAAa,KAC5Cn2B,KAAKD,OAAO+C,OAAO,SAAWxB,KAAM,kBAAmByB,kBAAkB,EAAOvB,OAAS6tB,EAAGA,KAC5FrvB,KAAKm2B,UAAY,GAGjBn2B,KAAKm2B,WAAY,GAAI7G,OAAOC,UAGX,IAArBF,EAAEK,QAAQvqB,OACVnF,KAAKi1B,aAAc,EAGnBj1B,KAAKm3B,sBAAsB9H,GAE/BM,eAAa7R,IAAI9d,KAAKD,OAAOqC,YAAa,WAAYpC,KAAKq3B,oBAAqBr3B,MAChF2vB,eAAa7R,IAAI9d,KAAKD,OAAOqC,YAAa,YAAapC,KAAKo3B,sBAAuBp3B,MACnF2vB,eAAa7R,IAAI9d,KAAKD,OAAOwC,YAAa,WAAYvC,KAAKq3B,oBAAqBr3B,MAChF2vB,eAAa7R,IAAI9d,KAAKD,OAAOwC,YAAa,YAAavC,KAAKo3B,sBAAuBp3B,OAEvFu0B,EAAU1zB,UAAU43B,YAAc,WAC9B9I,eAAa3D,OAAOhsB,KAAKD,OAAOqC,YAAa,WAAYpC,KAAKq3B,qBAC9D1H,eAAa3D,OAAOhsB,KAAKD,OAAOqC,YAAa,YAAapC,KAAKo3B,uBAC/DzH,eAAa3D,OAAOhsB,KAAKD,OAAOwC,YAAa,WAAYvC,KAAKq3B,qBAC9D1H,eAAa3D,OAAOhsB,KAAKD,OAAOwC,YAAa,YAAavC,KAAKo3B,wBAEnE7C,EAAU1zB,UAAU62B,oBAAsB,SAAUrI,GAChD,GAAI9jB,GAAQvL,KACRD,EAASC,KAAKD,QACdsvB,EAAEuT,SAAsB,MAAVvT,EAAEwT,KAAyB,MAAVxT,EAAEwT,KACjCxT,EAAE6Q,gBAEN,IAAIj8B,IAAQ0K,SAAU,GAAIqD,SAAU,KACpCjS,GAAO+C,OAAO,QAAUxB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAASyC,IAAKA,IACpF,IACIyI,GADAwZ,GAAevX,SAAU1K,EAAc,SAAG+N,SAAU/N,EAAc,SAAG6H,QAAQ,EAEjF,QAAQujB,EAAEwT,KACN,IAAMxT,GAAEuT,SAAW,IACX12B,cAAcnM,EAAOoM,SAA+C,IAArCpM,EAAOoM,OAAOga,OAAO/Z,YAEpDrM,EAAOsM,UAAUC,kBAAkB,uBAAwB,aAAc4Z,GAAY3Z,KAAK,SAAUnL,GAChGmK,EAAM6a,gBAAgBhlB,EAAMiuB,MAIhCtvB,EAAO0M,QAAQ,aAAcyZ,GAC7BlmB,KAAKomB,gBAAgBF,EAAYmJ,GAErC,MACJ,KAAMA,GAAEuT,SAAW,IACX7iC,EAAO+iC,eACP/iC,EAAO+C,OAAO,aAAexB,KAAM,aAEvC,MACJ,KAAM+tB,GAAEuT,SAAW,IACX7iC,EAAO+iC,eACP/iC,EAAO+C,OAAO,aAAexB,KAAM,aAEvC,MACJ,KAAM+tB,GAAEuT,SAAW,KACV7iC,EAAOkN,aAAa6zB,YAAcC,cAAYgC,YAAchC,cAAYgC,WACzE/iC,KAAK21B,SAAW,WAChB51B,EAAO+C,OAAO,aAAexB,KAAM,aAAcyB,kBAAkB,EAC/DvB,OAASqC,WAAY,GAAIsD,UAAW,QAE5C,MACJ,KAAMkoB,GAAEuT,SAAW,KACV7iC,EAAOkN,aAAa6zB,YAAcC,cAAYgC,YAAchC,cAAYgC,WACzE/iC,KAAK21B,SAAW,WAChB51B,EAAO+C,OAAO,aAAexB,KAAM,aAAcyB,kBAAkB,EAC/DvB,OAASqC,YAAa,GAAIsD,UAAW,QAE7C,MACJ,KAAK,SACDnH,KAAK63B,YACL,MACJ,KAAK,SACD93B,EAAO+C,OAAO,QAAUxB,KAAM,gBAAiBE,OAASgI,oBAAqB,OAC7E,MACJ,KAAK,QACGzJ,EAAO6C,UAAUwC,QACjBsH,EAAa3M,EAAO6C,UAAUwC,MAAMuH,MAAM,MAE1C3M,KAAKgjC,eAAe3T,IACpBtvB,EAAO6C,UAAUgK,YAAe7M,EAAO6C,UAAUwC,OAA2B,SAAlBsH,EAAW,IACrE3M,EAAO6B,MAEX,MACJ,KAAK,MACD5B,KAAK82B,kBACL,MACJ,SACQ7a,UAAQC,UAA8C,UAAlCnc,EAAO+c,SAASjB,MAAMG,SAC1Cgb,WAAWh3B,KAAK43B,YAAY9T,KAAK9jB,MAAO,EAAGqvB,KAK3DkF,EAAU1zB,UAAUmiC,eAAiB,SAAU3T,GAC3C,GAAIjpB,IAAO,EAEPqd,EAAS4L,EAAE5L,MAIf,OAHKA,GAAOzG,KAAOhd,KAAKD,OAAOgO,QAAQiP,GAAK,OAAuB,KAAdyG,EAAOzG,IAAe9Q,eACvE9F,GAAO,GAEJA,GAEXmuB,EAAU1zB,UAAUulB,gBAAkB,SAAUC,EAAoBgJ,GAChE,GAAItvB,GAASC,KAAKD,MACbsmB,GAAmBva,QACpB/L,EAAO+C,OAAO,UAAYxB,KAAM,SAAUyB,kBAAkB,EACxDvB,OAASmF,KAAM0f,EAAmBrU,SAAUrD,SAAU0X,EAAmB1X,YAEjF0gB,EAAE6Q,iBACF7Q,EAAE8R,4BAEN5M,EAAU1zB,UAAU82B,aAAe,SAAUtI,GACzC,GACI7uB,GACAC,EAFAV,EAASC,KAAKD,OAGdkjC,GAAiB,CACN,gBAAX5T,EAAE1oB,OAEFnG,EAAI6uB,EAAEG,QACN/uB,EAAI4uB,EAAEI,QAEV,IAAI0Q,GAAOpgC,EAAOqC,YAAYytB,uBAQ9B,IAPArvB,GAAK2/B,EAAKllB,KACVxa,GAAK0/B,EAAKzZ,IACNlmB,EAAIT,EAAOqD,IAAIC,UAAY7C,EAAIT,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,WAAa9C,EAAIV,EAAOqD,IAAIE,SAC5F7C,EAAIV,EAAOqD,IAAIE,QAAUvD,EAAOqD,IAAII,aACpCy/B,GAAiB,GAErB5T,EAAE6T,mBACgB,IAAd7T,EAAEuT,SAAoBK,EAAgB,CACtC5T,EAAE6Q,kBACGngC,EAAOqe,WAAcre,EAAO6C,UAAUwC,OAAkD,SAAzCrF,EAAO6C,UAAUwC,MAAMuH,MAAM,KAAK,KAClF5M,EAAO8zB,QACF3nB,cACDnM,EAAO+C,OAAO,WAAaxB,KAAM,2BAA4ByB,kBAAkB,IAGvF,IAAI4D,GAAO,EACI,gBAAX0oB,EAAE1oB,OAA0B5G,EAAOkN,aAAa6zB,YAAcC,cAAYoC,cAAgBpC,cAAYoC,aACtGnjC,KAAK21B,SAAW,aAGZhvB,EADA0oB,EAAE+T,WAAa,EACR,SAGA,WAGF,KAATz8B,GACA5G,EAAO+C,OAAO,QAAUxB,KAAM,mBAAoByB,kBAAkB,EAChEvB,OAAShB,EAAGA,EAAGC,EAAGA,EAAGkG,KAAMA,OAI3C4tB,EAAU1zB,UAAU+2B,YAAc,SAAUvI,GACxC,GAAItvB,GAASC,KAAKD,MACmB,QAAjCsjC,OAAOC,aAAajU,EAAEkU,SACtBvjC,KAAKw1B,SAAW,GAEpBz1B,EAAO+c,SAASF,aAAa,OAAQ5c,KAAKw1B,QAAQnQ,YAClDtlB,EAAO+c,SAASjB,MAAMvb,OAAS,OAC/BP,EAAO+c,SAASjB,MAAMvb,OAASP,EAAO+c,SAAS0mB,aAAe,KAC9DzjC,EAAO+C,OAAO,SAAWxB,KAAM,kBAAmByB,kBAAkB,EAAOvB,OAAS6tB,EAAGA,KACnFpT,UAAQC,WACRnc,EAAO+c,SAASjB,MAAMxb,MAAQsnB,WAAW5nB,EAAO+c,SAASjB,MAAMxb,OAASN,EAAO+c,SAASjB,MAAMtT,SAAW,KAE7G,IAAI8R,GAAOta,EAAO+c,SAAStb,MAAMmL,MAAM,KACvC3M,MAAKw1B,QAAUnb,EAAKlV,OACpBpF,EAAO+c,SAASF,aAAa,OAAQ5c,KAAKw1B,QAAQnQ,YAClDrlB,KAAK41B,qBAAsB,GAE/BrB,EAAU1zB,UAAUme,eAAiB,WACjC,GAAIjf,GAASC,KAAKD,QACbA,EAAOyL,UAAYzL,EAAO0L,gBAC3B1L,EAAOse,WAAY,EACnBte,EAAO+C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,IACrE/C,KAAKu1B,YAAc,GACnBv1B,KAAK60B,UAAU10B,OAASH,KAAK60B,UAAUz0B,OAASJ,KAAK60B,UAAU9sB,KAAO/H,KAAK60B,UAAU7sB,KAAO,EAC5FjI,EAAO0F,YAAYL,MAAQ,GAC3BpF,KAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOwC,YAAYlC,MAAON,EAAOwC,YAAYjC,QAC/EP,EAAO0F,YAAYuF,aAAc,EACjCjL,EAAO0F,YAAYC,cAAe,EAClC3F,EAAOwC,YAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS,YAG1D0W,EAAU1zB,UAAUk2B,iBAAmB,SAAU12B,EAAOC,GACpD,GACIP,GAASC,KAAKD,MACdA,GAAOqD,IAAIG,UAAYxD,EAAOqD,IAAII,YAClCzD,EAAO6C,UAAUC,YAAY1C,OAASH,KAAK60B,UAAU10B,OAAWE,EAAQ,EAAMC,EAAS,MAEvFP,EAAO6C,UAAUC,YAAYzC,OAASJ,KAAK60B,UAAUz0B,OAAWE,EAAS,EAAMA,EAAS,MAExFP,EAAO6C,UAAUC,YAAYkF,KAAS1H,EAAQ,EAAMC,EAAS,MAC7DP,EAAO6C,UAAUC,YAAYmF,KAAS1H,EAAS,EAAMA,EAAS,QAG9DP,EAAO6C,UAAUC,YAAYzC,OAASJ,KAAK60B,UAAU10B,OAAWG,EAAS,EAAK,EAAU,MAExFP,EAAO6C,UAAUC,YAAYmF,KAAS1H,EAAS,EAAK,EAAU,MAC9DP,EAAO6C,UAAUC,YAAY1C,OAASH,KAAK60B,UAAU10B,WACrDJ,EAAO6C,UAAUC,YAAYkF,KAAO1H,QAG5Ck0B,EAAU1zB,UAAU+1B,eAAiB,SAAUp2B,EAAGC,EAAGwT,EAAUC,GAW3D,IAAK,GAVDnU,GAASC,KAAKD,OAEd0jC,EAAgBxvB,EAChByvB,EAAiBxvB,EACjByvB,EAAcnjC,EAAIC,EAClBmjC,EAAeH,GAAiBC,EAAiBD,EAAgBC,EACjErjC,EAAQujC,EAAeD,EACvBrjC,EAASsjC,EACTC,EAAa7jC,KAAK8jC,SAASzjC,EAAOojC,GAClCM,KACK/+B,EAAI,EAAGA,EAAI,EAAGA,IACT,IAANA,EACA++B,EAAa99B,KAAK5F,EAAQwjC,GAG1BE,EAAa99B,KAAK3F,EAASujC,EAGnCxjC,GAAQ0jC,EAAa,GACrBzjC,EAASyjC,EAAa,EAGtB,KAAK,GAFDC,GAAchkC,KAAK8jC,SAASxjC,EAAQojC,GACpCO,KACKj/B,EAAI,EAAGA,EAAI,EAAGA,IACT,IAANA,EACAi/B,EAAch+B,KAAK5F,EAAQ2jC,GAG3BC,EAAch+B,KAAK3F,EAAS0jC,EAGpC3jC,GAAQ4jC,EAAc,GACtB3jC,EAAS2jC,EAAc,GACvBlkC,EAAO6C,UAAUC,YAAYxC,MAAQA,EACrCN,EAAO6C,UAAUC,YAAYvC,OAASA,EACtCP,EAAO6C,UAAUC,YAAY1C,YAAUH,KAAK60B,UAAU10B,QAAUsjC,EAAgBpjC,GAAS,GACzFN,EAAO6C,UAAUC,YAAYzC,YAAUJ,KAAK60B,UAAUz0B,QAAUsjC,EAAiBpjC,GAAU,GAC3FP,EAAO6C,UAAUC,YAAYkF,MAAS07B,EAAgBpjC,GAAS,EAAIA,MACnEN,EAAO6C,UAAUC,YAAYmF,MAAS07B,EAAiBpjC,GAAU,EAAIA,MACjEP,EAAO6C,UAAUC,YAAY1C,OAASJ,EAAOqD,IAAIC,UAAYtD,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,UAC9FxD,EAAOqC,YAAYoC,cACnBzE,EAAO6C,UAAUC,YAAY1C,OAASJ,EAAOqD,IAAIC,SACjDtD,EAAO6C,UAAUC,YAAYkF,KAAOhI,EAAO6C,UAAUC,YAAY1C,OAASE,OAE1EN,EAAO6C,UAAUC,YAAYzC,OAASL,EAAOqD,IAAIE,SAAWvD,EAAOqD,IAAIE,QAAUvD,EAAOqD,IAAII,WAC5FzD,EAAOqC,YAAYqC,eACnB1E,EAAO6C,UAAUC,YAAYzC,OAASL,EAAOqD,IAAIE,QACjDvD,EAAO6C,UAAUC,YAAYmF,KAAOjI,EAAO6C,UAAUC,YAAYzC,OAASE,OAE9EP,EAAO6C,UAAUC,YAAYxC,MAAQN,EAAO6C,UAAUC,YAAYkF,KAAOhI,EAAO6C,UAAUC,YAAY1C,OACtGJ,EAAO6C,UAAUC,YAAYvC,OAASP,EAAO6C,UAAUC,YAAYmF,KAAOjI,EAAO6C,UAAUC,YAAYzC,QAE3Gm0B,EAAU1zB,UAAUijC,SAAW,SAAUtiC,EAAO0iC,GAC5C,MAAO1iC,GAAQ0iC,EAAgBA,EAAgB1iC,EAAQ,GAE3D+yB,EAAU1zB,UAAUo3B,WAAa,SAAUz3B,EAAGC,EAAGkG,GAC7C,GAAI5G,GAASC,KAAKD,MAClB,IAA2B,cAAvB4G,EAAKiM,eAAwD,eAAvBjM,EAAKiM,cAAgC,CAC3E,GACI/F,IAAS,CACT9M,GAAO6C,UAAUwC,OAEK,SADTrF,EAAO6C,UAAUwC,MAAMuH,MAAM,KAC3B,KACXE,GAAS,GAGjB7M,KAAKkiC,cAAc1hC,EAAGC,EAAGoM,GACzB7M,KAAKy2B,mBAAmBj2B,EAAGC,EAAGkG,OAG9B,QAAQ3G,KAAKu1B,YAAY3iB,eACrB,IAAK,YACD7S,EAAO6C,UAAUkS,cAAc3U,OAASK,EACxCT,EAAO6C,UAAUkS,cAAc1U,OAASK,CACxC,MACJ,KAAK,WACDV,EAAO6C,UAAUmS,gBAAgB5U,OAASK,EAC1CT,EAAO6C,UAAUmS,gBAAgB3U,OAASK,CAC1C,MACJ,KAAK,YACDV,EAAO6C,UAAUoS,eAAe7U,OAASK,EACzCT,EAAO6C,UAAUoS,eAAe5U,OAASK,CACzC,MACJ,KAAK,WACDV,EAAO6C,UAAUqS,iBAAiB9U,OAASK,EAC3CT,EAAO6C,UAAUqS,iBAAiB7U,OAASK,CAC3C,MACJ,KAAK,WACDV,EAAO6C,UAAUsS,kBAAkB/U,OAASK,EAC5CT,EAAO6C,UAAUsS,kBAAkB9U,OAASK,CAC5C,MACJ,KAAK,YACDV,EAAO6C,UAAUuS,iBAAiBhV,OAASK,EAC3CT,EAAO6C,UAAUuS,iBAAiB/U,OAASK,CAC3C,MACJ,KAAK,WACDV,EAAO6C,UAAUwS,mBAAmBjV,OAASK,EAC7CT,EAAO6C,UAAUwS,mBAAmBhV,OAASK,CAC7C,MACJ,KAAK,YACDV,EAAO6C,UAAUyS,kBAAkBlV,OAASK,EAC5CT,EAAO6C,UAAUyS,kBAAkBjV,OAASK,CAC5C,MACJ,SACQT,KAAK60B,UAAU10B,QAAUH,KAAK60B,UAAUz0B,SACxCJ,KAAK01B,cAAcl1B,EAAIR,KAAK60B,UAAU9sB,KACtC/H,KAAK01B,cAAcj1B,EAAIT,KAAK60B,UAAU7sB,KACtChI,KAAK60B,UAAU9sB,KAAOvH,EACtBR,KAAK60B,UAAU7sB,KAAOvH,KAM1C8zB,EAAU1zB,UAAUqhC,cAAgB,SAAU1hC,EAAGC,EAAGoM,GAChD,GAAItB,GAAQvL,KACRD,EAASC,KAAKD,OACdq/B,GAAU,CACd,IAA8B,IAA1Br/B,EAAOmF,QAAQC,SAAiBpF,EAAO0F,YAAYC,eAAiBmH,EAAQ,CAG5E,IAAK,GAFDyH,GAAQ,EACRtP,MAAI,GACCquB,EAAQ,EAAGA,EAAQtzB,EAAOmF,QAAQC,OAAQkuB,IAAS,CACxD,GAAIxV,GAAS9d,EAAOwC,YAAYsZ,MAAMgC,MACtC7d,MAAKu2B,UAAU/1B,EAAGC,EAClB,IAAI6I,GAAStF,YAAWjE,EAAOmF,QAAQmuB,OAAY,EACnD,IAAqB,SAAjB/pB,EAAOlE,OAAqC,UAAjBkE,EAAOlE,OAClC,IAAK,GAAIsV,GAAI,EAAGA,EAAIpR,EAAOrC,UAAU9B,OAAQuV,IACzC,GAAIla,GAAK8I,EAAOrC,UAAUyT,GAAGla,EAAmC,EAA9B8I,EAAOwL,cAAcpK,QACnDlK,GAAK8I,EAAOrC,UAAUyT,GAAGla,EAAmC,EAA9B8I,EAAOwL,cAAcpK,QACnDjK,GAAK6I,EAAOrC,UAAUyT,GAAGja,EAAmC,EAA9B6I,EAAOwL,cAAcpK,QACnDjK,GAAK6I,EAAOrC,UAAUyT,GAAGja,EAAmC,EAA9B6I,EAAOwL,cAAcpK,OAAa,CAC5D1K,KAAK00B,SAA6B,SAAlB30B,EAAO8d,QACL,SAAlB9d,EAAO8d,QAAqB7d,KAAK80B,iBACnB,IAAVxgB,GAAeA,EAAQ9T,EAAI8I,EAAOzG,YAAY1C,UAC9CmU,EAAQ9T,EAAIT,EAAOmF,QAAQmuB,GAAOxwB,YAAY1C,OAC9C6E,EAAIquB,GAGHtzB,EAAOmF,QAAQmuB,GAAOxU,YAAc7e,KAAKshB,cAAczC,YAC5D7Z,EAAIquB,EAER,YAIP,IAAqB,SAAjB/pB,EAAOlE,MAAkB,CAC9B,GAAI++B,GAAWnkC,KAAKi5B,iBAAiB3vB,EAAQ9I,EAAGC,EAAGV,EAAOwC,YACzC,aAAb4hC,GAAuC,SAAbA,IACtBnkC,KAAK00B,SAA6B,SAAlB30B,EAAO8d,QAAuC,SAAlB9d,EAAO8d,QAAqB7d,KAAK80B,iBAC/D,IAAVxgB,GAAeA,EAAQ9T,EAAI8I,EAAOzG,YAAY1C,UAC9CmU,EAAQ9T,EAAIT,EAAOmF,QAAQmuB,GAAOxwB,YAAY1C,OAC9C6E,EAAIquB,GAGHtzB,EAAOmF,QAAQmuB,GAAOxU,YAAc7e,KAAKshB,cAAczC,YAC5D7Z,EAAIquB,QAIX,IAA4B,IAAxB/pB,EAAOsK,aAAoB,CAChC,GAAIwwB,GAAWpkC,KAAKk5B,0BAA0B5vB,EAAQ9I,EAAGC,EAAGV,EAAOwC,YAClD,aAAb6hC,GAAuC,SAAbA,IACtBpkC,KAAK00B,SAA6B,SAAlB30B,EAAO8d,QAAuC,SAAlB9d,EAAO8d,QAAqB7d,KAAK80B,iBAC/D,IAAVxgB,GAAeA,EAAQ9T,EAAI8I,EAAOzG,YAAY1C,UAC9CmU,EAAQ9T,EAAIT,EAAOmF,QAAQmuB,GAAOxwB,YAAY1C,OAC9C6E,EAAIquB,GAGHtzB,EAAOmF,QAAQmuB,GAAOxU,YAAc7e,KAAKshB,cAAczC,YAC5D7Z,EAAIquB,QAIX,CACD,GAAI/d,GAAsBtV,KAAKq4B,sBAAsB/uB,IAChD9I,GAAM8I,EAAOzG,YAAY1C,OAAwC,EAA9BmJ,EAAOwL,cAAcpK,QACzDlK,GAAM8I,EAAOzG,YAAYkF,KAAsC,EAA9BuB,EAAOwL,cAAcpK,QACtDjK,GAAM6I,EAAOzG,YAAYzC,OAAwC,EAA9BkJ,EAAOwL,cAAcpK,QACxDjK,GAAM6I,EAAOzG,YAAYmF,KAAsC,EAA9BsB,EAAOwL,cAAcpK,QACrD4K,GACG9U,GAAM8U,EAAoB9U,EAAmC,EAA9B8I,EAAOwL,cAAcpK,QACpDlK,GAAM8U,EAAoB9U,EAAmC,EAA9B8I,EAAOwL,cAAcpK,QACpDjK,GAAM6U,EAAoB7U,EAAmC,EAA9B6I,EAAOwL,cAAcpK,QACpDjK,GAAM6U,EAAoB7U,EAAmC,EAA9B6I,EAAOwL,cAAcpK,UACpD1K,KAAK00B,SAAsB,SAAX7W,GAAgC,aAAXA,GAAyB7d,KAAK80B,iBAC9C,SAAlB/0B,EAAO8d,QAAuC,aAAlB9d,EAAO8d,QACxB,IAAVvJ,GAAeA,EAAQ9T,EAAI8I,EAAOzG,YAAY1C,UAC9CmU,EAAQ9T,EAAIT,EAAOmF,QAAQmuB,GAAOxwB,YAAY1C,OAC9C6E,EAAIquB,GAGHtzB,EAAOmF,QAAQmuB,GAAOxU,YAAc7e,KAAKshB,cAAczC,YAC5D7Z,EAAIquB,KAKpB,GAAIpxB,oBAAkB+C,GAClBjF,EAAO+C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,IACrEq8B,GAAU,MAET,CACDp/B,KAAKqhB,YAAcrd,YAAWjE,EAAOmF,YAAa,GAClDnF,EAAO0F,YAAYC,cAAe,EAClC3F,EAAO6C,UAAYoB,YAAWjE,EAAOmF,QAAQF,OAAQ,EACrD,IAAIN,GAAOV,YAAWjE,EAAOmF,QAAQF,OAAQ,EAE7C,IADAjF,EAAOmF,QAAQi9B,OAAOn9B,EAAG,GACO,IAA5BjF,EAAOiD,UAAUC,OAAc,CAC/B,GAAIklB,GAASnoB,KAAKqC,aAAasC,MAC/B3E,MAAKqC,aAAa8B,UAAU,EAAG,EAAGpE,EAAOqC,YAAY/B,MAAON,EAAOqC,YAAY9B,QAC/EP,EAAO+C,OAAO,UAAYxB,KAAM,qBAAsByB,kBAAkB,IACxE/C,KAAKqC,aAAauC,UAAU7E,EAAO8E,QAAS9E,EAAOqD,IAAIgB,QAASrE,EAAOqD,IAAIiB,OAAQtE,EAAOqD,IAAIkB,SAAUvE,EAAOqD,IAAImB,UAAWxE,EAAOqD,IAAIC,SAAUtD,EAAOqD,IAAIE,QAASvD,EAAOqD,IAAIG,UAAWxD,EAAOqD,IAAII,YACxMxD,KAAKqC,aAAasC,OAAS,OAC3B5E,EAAO+C,OAAO,SAAWxB,KAAM,iBAAkByB,kBAAkB,IACnEhD,EAAO6C,UAAYoB,YAAWmkB,MAAY,GAC1CpoB,EAAO+C,OAAO,iBAAmBxB,KAAM,iBAAkByB,kBAAkB,EACvEvB,OAAS+D,QAASvF,KAAKqC,aAAcwG,OAAQ,QACjD7I,KAAKqC,aAAasC,OAASwjB,EAC3BnoB,KAAKk4B,0BAGLn4B,GAAO+C,OAAO,QAAUxB,KAAM,2BAA4ByB,kBAAkB,IAC5EhD,EAAO+C,OAAO,iBAAmBxB,KAAM,iBAAkByB,kBAAkB,EACvEvB,OAAS+D,QAASvF,KAAKqC,aAAcwG,OAAQ,OAErD9I,GAAO+C,OAAO,QAAUxB,KAAM,mBAAoByB,kBAAkB,EAAOvB,OAAS+D,QAASvF,KAAKqC,iBAC7FtC,EAAOgE,oBAA0D,gBAApChE,EAAOgE,mBAAmBqB,OAA4BrF,EAAOyF,eAC3FzF,EAAO+C,OAAO,QAAUxB,KAAM,aAAcyB,kBAAkB,EAC1DvB,OAAS+D,QAASvF,KAAKqC,aAAc+H,OAAQ,KAAMC,OAAQ,QAEnErK,KAAK22B,iBACL52B,EAAO6C,UAAYoB,YAAWU,MAAU,EACxC,IAAIoK,GAAqB9K,YAAWjE,EAAO6C,UAAUmQ,mBAAoB,EACzEhT,GAAO+C,OAAO,QAAUxB,KAAM,wBAAyByB,kBAAkB,EACrEvB,OAASsN,mBAAoBA,IACjC,IAAII,GAAmBlL,YAAWjE,EAAO6C,UAAUyF,iBAAkB,EACrEtI,GAAO+C,OAAO,QAAUxB,KAAM,sBAAuByB,kBAAkB,EAAOvB,OAAS0N,iBAAkBA,IACzG,IAAIokB,GAAgBtzB,KAAK83B,0BACrBuM,GAAwBxkB,OAAQ,SAAU6T,sBAAuBJ,EACjEK,qBAAsBL,EACK,UAA3BvzB,EAAO6C,UAAUwC,OAA+C,UAA3BrF,EAAO6C,UAAUwC,QACtDi/B,EAAoB1Q,qBAAqBtzB,MAAQN,EAAO6C,UAAUC,YAAYkF,KAAOhI,EAAO6C,UAAUC,YAAY1C,OAClHkkC,EAAoB1Q,qBAAqBrzB,OAASP,EAAO6C,UAAUC,YAAYmF,KAAOjI,EAAO6C,UAAUC,YAAYzC,QAEvHJ,KAAKke,iBAAkB,CACvB,IAAIxR,OAAa,EAOjB,QAN+B+G,KAA3B1T,EAAO6C,UAAUwC,QACjBsH,EAAa3M,EAAO6C,UAAUwC,MAAMuH,MAAM,UAE3B8G,KAAf/G,GAA8C,SAAlBA,EAAW,KACvC1M,KAAKke,iBAAkB,IAEtBle,KAAKke,iBAAmBhS,cAAcjK,oBAAkBjC,KAAKD,OAAOo8B,YACrEp8B,EAAOoM,SAAsD,IAA5CpM,EAAOoM,OAAOynB,cAAcxnB,YAE7CrM,EAAOsM,UAAUC,kBAAkB,kBAAmB,UAAW+3B,GAAqB93B,KAAK,SAAUknB,GACjGloB,EAAM+4B,WAAW7Q,SAGpB,IAAKzzB,KAAKke,gBAIV,CACD,GAAI0B,IAA0BC,OAAQwkB,EAAoBxkB,OACtDC,2BAA6BnZ,KAAM5G,EAAO4f,iBAAiB5f,EAAO6C,UAAUwC,OACxEjF,OAAQkkC,EAAoB3Q,sBAAsBvzB,OAClDC,OAAQikC,EAAoB3Q,sBAAsBtzB,OAClDC,MAAOgkC,EAAoB3Q,sBAAsBrzB,MACjDC,OAAQ+jC,EAAoB3Q,sBAAsBpzB,QACtDyf,0BAA4BpZ,KAAM5G,EAAO4f,iBAAiB5f,EAAO6C,UAAUwC,OACvEjF,OAAQkkC,EAAoB1Q,qBAAqBxzB,OACjDC,OAAQikC,EAAoB1Q,qBAAqBvzB,OACjDC,MAAOgkC,EAAoB1Q,qBAAqBtzB,MAChDC,OAAQ+jC,EAAoB1Q,qBAAqBrzB,QACrD4L,eAAcnM,EAAOoM,SAA+D,IAArDpM,EAAOoM,OAAO6T,uBAAuB5T,YAEpErM,EAAOsM,UAAUC,kBAAkB,sBAAuB,yBAA0BsT,GAAuBrT,KAAK,SAAUqT,GACtHykB,EAAoB1Q,qBAAqBxzB,OAASyf,EAAsBG,yBAAyB5f,OACjGkkC,EAAoB1Q,qBAAqBvzB,OAASwf,EAAsBG,yBAAyB3f,OACjGikC,EAAoB1Q,qBAAqBtzB,MAAQuf,EAAsBG,yBAAyB1f,MAChGgkC,EAAoB1Q,qBAAqBrzB,OAASsf,EAAsBG,yBAAyBzf,OACjGiL,EAAM+4B,WAAWD,MAIrBtkC,EAAO0M,QAAQ,oBAAqBmT,GACpCykB,EAAoB1Q,qBAAqBxzB,OAASyf,EAAsBG,yBAAyB5f,OACjGkkC,EAAoB1Q,qBAAqBvzB,OAASwf,EAAsBG,yBAAyB3f,OACjGikC,EAAoB1Q,qBAAqBtzB,MAAQuf,EAAsBG,yBAAyB1f,MAChGgkC,EAAoB1Q,qBAAqBrzB,OAASsf,EAAsBG,yBAAyBzf,OACjGN,KAAKskC,WAAWD,QA/BpBtkC,GAAO0M,QAAQ,gBAAiB43B,GAChCrkC,KAAKskC,WAAWD,EAiCpBjF,IAAU,GAGlB,MAAOA,IAEX7K,EAAU1zB,UAAUyjC,WAAa,SAAU7Q,GACvC,GAAI1zB,GAASC,KAAKD,MAGlB,IAFAA,EAAO+C,OAAO,SAAWxB,KAAM,6BAA8ByB,kBAAkB,EAC3EvB,OAAS8xB,cAAeG,EAAkBE,wBAC1C5zB,EAAO6C,UAAUC,YAAa,CAC9B,GAAIoB,IAAQkO,WAAY,KACxBpS,GAAO+C,OAAO,QAAUxB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAASyC,IAAKA,KAClFhC,oBAAkBgC,EAAgB,aAClClE,EAAO+C,OAAO,QAAUxB,KAAM,gBAAiByB,kBAAkB,EAC7DvB,OAAS2Q,WAAYnO,YAAWjE,EAAO6C,cAAe,MAE9D7C,EAAO+C,OAAO,QAAUxB,KAAM,aAAcyB,kBAAkB,EAAOvB,OAAS6D,OAAQ,YAAapB,IAAKlE,EAAO6C,UAAW2P,YAAa,KAC/H1J,OAAQ,KAAM2J,eAAe,EAAMC,YAAa,KAAMC,oBAAoB,KAC7E1S,KAAK80B,kBACF/0B,EAAO6C,UAAUC,YAAY1C,OAASJ,EAAOqD,IAAIC,SACjDrD,KAAKs1B,mBAAoB,EAEpBv1B,EAAO6C,UAAUC,YAAYkF,KAAOhI,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,UAC1EvD,KAAKs1B,mBAAoB,EAEpBv1B,EAAO6C,UAAUC,YAAYzC,OAASL,EAAOqD,IAAIE,QACtDtD,KAAKs1B,mBAAoB,EAEpBv1B,EAAO6C,UAAUC,YAAYmF,KAAOjI,EAAOqD,IAAIE,QAAUvD,EAAOqD,IAAII,aACzExD,KAAKs1B,mBAAoB,MAMzCf,EAAU1zB,UAAUu/B,cAAgB,SAAU1Q,GAC1C,GAAIyQ,GAAOngC,KAAKD,OAAOqC,YAAYytB,uBAInC,SAHWrvB,EAAGkvB,EAAQ,GAAG2Q,MAAQF,EAAKllB,KAAMxa,EAAGivB,EAAQ,GAAG6Q,MAAQJ,EAAKzZ,MAC5DlmB,EAAGkvB,EAAQ,GAAG2Q,MAAQF,EAAKllB,KAAMxa,EAAGivB,EAAQ,GAAG6Q,MAAQJ,EAAKzZ,OAI3E6N,EAAU1zB,UAAUogC,eAAiB,SAAU/L,EAAcqP,GACzD,GAAIC,GAAgBxkC,KAAKykC,YAAYvP,EAAa,GAAIA,EAAa,GAEnE,OADkBl1B,MAAKykC,YAAYF,EAAW,GAAIA,EAAW,IACxCC,GAEzBjQ,EAAU1zB,UAAU4jC,YAAc,SAAU5qB,EAAGE,GAC3C,GAAIvZ,GAAI,EACJC,EAAI,CAKR,OAJIoZ,IAAKE,IACLvZ,EAAIqZ,EAAErZ,EAAIuZ,EAAEvZ,EACZC,EAAIoZ,EAAEpZ,EAAIsZ,EAAEtZ,GAET0H,KAAK+R,KAAK1Z,EAAIA,EAAIC,EAAIA,IAEjC8zB,EAAU1zB,UAAUo2B,YAAc,SAAUhzB,EAAKygC,GAE7C,IAAK,GADD3kC,GAASC,KAAKD,OACTiF,EAAI,EAAGC,EAAMlF,EAAOmF,QAAQC,OAAQH,EAAIC,EAAKD,IAClD,GAAI08B,KAAKC,UAAU19B,KAASy9B,KAAKC,UAAU5hC,EAAOmF,QAAQF,IAAK,CAC3DjF,EAAOmF,QAAQi9B,OAAOn9B,EAAG,EACzB,OAGRhF,KAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOwC,YAAYlC,MAAON,EAAOwC,YAAYjC,QAC3EN,KAAKs1B,mBACDv1B,EAAO6C,UAAUC,YAAY1C,OAASJ,EAAOqD,IAAIC,WACjDrD,KAAKs1B,mBAAoB,GAEzBoP,GAAa3kC,EAAO6C,UAAUgR,aAC9B7T,EAAO+C,OAAO,QAAUxB,KAAM,aAAcyB,kBAAkB,EAAOvB,OAAS6D,OAAQ,YAAapB,IAAK,KAAMsO,YAAa,KACnH1J,OAAQ,KAAM2J,eAAe,EAAMC,YAAa,KAAMC,mBAAoB,UAQlFgyB,GAAa3kC,EAAO6C,UAAUgR,aAC9B7T,EAAO+C,OAAO,QAAUxB,KAAM,aAAcyB,kBAAkB,EAAOvB,OAAS6D,OAAQ,YAAapB,IAAK,KAAMsO,YAAa,KACnH1J,OAAQ,KAAM2J,eAAe,EAAMC,YAAa,KAAMC,mBAAoB,UAQ9F6hB,EAAU1zB,UAAUuhC,SAAW,SAAU/S,GACjCrvB,KAAK24B,MAAQ,KACbgM,aAAa3kC,KAAK24B,OAClB34B,KAAK24B,MAAQ,EACb34B,KAAKD,OAAO+C,OAAO,SAAWxB,KAAM,iBAAkByB,kBAAkB,EAAOvB,OAAS6tB,EAAGA,KACvFpT,UAAQC,UACRlc,KAAKwC,aAAa2B,UAAU,EAAG,EAAGnE,KAAKD,OAAOwC,YAAYlC,MAAOL,KAAKD,OAAOwC,YAAYjC,UAIrGi0B,EAAU1zB,UAAU+gC,gBAAkB,SAAUphC,EAAGC,GAC/C,GAAIV,GAASC,KAAKD,OACdqO,GAAW,EACX9E,EAAStF,YAAWjE,EAAO6C,cAAe,EAC9C,KAAIX,oBAAkBqH,EAAOzG,aAA7B,CAGA,GAAI6H,GAASpB,EAAOwL,cAAgBxL,EAAOwL,cAAcpK,OAAS,CAClE,IAAKlK,GAAK2H,KAAK2xB,MAAMxwB,EAAOzG,YAAY1C,SACpCK,GAAK2H,KAAKkqB,KAAK/oB,EAAOzG,YAAYkF,OAClCtH,GAAK0H,KAAK2xB,MAAMxwB,EAAOzG,YAAYzC,SACnCK,GAAK0H,KAAKkqB,KAAK/oB,EAAOzG,YAAYmF,MAClCoG,GAAW,MAEV,IAAe,IAAX1D,GAAiBlK,GAAK2H,KAAK2xB,MAAMxwB,EAAOzG,YAAY1C,QAAUuK,GACnElK,GAAK2H,KAAKkqB,KAAK/oB,EAAOzG,YAAYkF,MAAQ2C,GAC1CjK,GAAK0H,KAAK2xB,MAAMxwB,EAAOzG,YAAYzC,QAAUsK,GAC7CjK,GAAK0H,KAAKkqB,KAAK/oB,EAAOzG,YAAYmF,MAAQ0C,EAC1C0D,GAAW,EACXpO,KAAKshB,eAAkBze,aAAe1C,OAAQ,EAAGC,OAAQ,EAAG2H,KAAM,EAAGC,KAAM,EAAG3H,MAAO,EAAGC,OAAQ,GAC5FyX,eAAiBgd,YAAcC,sBAElC,IAAqB,SAAjB1rB,EAAOlE,OAAyC,KAArBpF,KAAKu1B,YACrCnnB,GAAW,MAEV,IAAqB,SAAjB9E,EAAOlE,OAAqC,UAAjBkE,EAAOlE,MAAmB,CAC1D,GAAIw/B,IAAepkC,EAAG8I,EAAOzG,YAAY1C,OAASmJ,EAAOzG,YAAYkF,KAAOuB,EAAOzG,YAAY1C,OACvFmJ,EAAOzG,YAAYkF,KACvBtH,EAAG6I,EAAOzG,YAAYzC,OAASkJ,EAAOzG,YAAYmF,KAAOsB,EAAOzG,YAAYzC,OAASkJ,EAAOzG,YAAYmF,MACxG68B,GAAerkC,EAAG8I,EAAOzG,YAAY1C,OAASmJ,EAAOzG,YAAYkF,KAAOuB,EAAOzG,YAAY1C,OACvFmJ,EAAOzG,YAAYkF,KACvBtH,EAAG6I,EAAOzG,YAAYzC,OAASkJ,EAAOzG,YAAYmF,KAAOsB,EAAOzG,YAAYzC,OAASkJ,EAAOzG,YAAYmF,KACxGxH,IAAM2H,KAAK2xB,MAAM8K,EAAWpkC,GAAK,GAAMA,GAAM2H,KAAKkqB,KAAKwS,EAAWrkC,GAAK,GACvEC,GAAM0H,KAAK2xB,MAAM8K,EAAWnkC,GAAK,GAAMA,GAAM0H,KAAKkqB,KAAKwS,EAAWpkC,GAAK,IACvE2N,GAAW,OAGd,IAAqB,SAAjB9E,EAAOlE,MAEG,UADXyY,EAAS7d,KAAKi5B,iBAAiB3vB,EAAQ9I,EAAGC,EAAGV,EAAOwC,gBAEpD6L,GAAW,OAGd,IAAyB,aAArBpO,KAAKu1B,YACVnnB,GAAW,MAEV,IAA4B,IAAxB9E,EAAOsK,aAAoB,CAChC,GAAIiK,GAAS7d,KAAKk5B,0BAA0B5vB,EAAQ9I,EAAGC,EAAGV,EAAOwC,cACjD,YAAXsb,GAAmC,SAAXA,GAA2C,aAArB7d,KAAKu1B,aAAmD,aAArBv1B,KAAKu1B,aAClE,aAArBv1B,KAAKu1B,aAAmD,aAArBv1B,KAAKu1B,eACxCnnB,GAAW,GAGnB,IAAKA,EAAU,CASX,GARInM,oBAAkBlC,EAAO6C,UAAUic,aACnC9e,EAAO6C,UAAUic,UAAY,UAAY9e,EAAOmF,QAAQC,OAAS,IAErEpF,EAAO+C,OAAO,SAAWxB,KAAM,uBAAwByB,kBAAkB,QACrC0Q,KAAhC1T,EAAO6C,UAAUgK,YAAmE,IAAvC7M,EAAO6C,UAAUgK,WAAWzM,QACrE,IADqFJ,EAAO6C,UAAUgK,WAAW7E,MAC3GhI,EAAO0F,YAAYC,cAA6C,KAA7B3F,EAAO0F,YAAYL,OAChErF,EAAOmF,QAAQe,KAAKjC,YAAWjE,EAAO6C,cAAe,IAE1B,SAA3B7C,EAAO6C,UAAUwC,OAAkD,YAA7BrF,EAAO0F,YAAYL,OAAoD,cAA7BrF,EAAO0F,YAAYL,OACtE,SAA7BrF,EAAO0F,YAAYL,OAA+C,UAA3BrF,EAAO6C,UAAUwC,OAAgD,SAA3BrF,EAAO6C,UAAUwC,MAAmB,CACjH,GAAIqK,GAAazP,KAAKqC,aAAasC,MACnC3E,MAAKqC,aAAasC,OAAS,sHAG3B,KAAK,GAAIK,GAAI,EAAGA,EAAIjF,EAAOmF,QAAQC,OAAQH,IAAK,CAC5C,GAAIf,IAAQmK,UAAU,EACtBrO,GAAO+C,OAAO,QAAUxB,KAAM,eAAgByB,kBAAkB,EAC5DvB,OAASyC,IAAKlE,EAAOmF,QAAQF,GAAIc,OAAQ7B,KACzCA,EAAc,WACdlE,EAAO+C,OAAO,SAAWxB,KAAM,QAASyB,kBAAkB,EACtDvB,OAAS4D,MAAOrF,EAAOmF,QAAQF,GAAGI,MAAOnB,IAAKlE,EAAOmF,QAAQF,GAAIK,OAAQ,QAC7EtF,EAAO+C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,KAG7EhD,EAAO+C,OAAO,iBAAmBxB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAASuD,eAAgB,QACxG/E,KAAKqC,aAAasC,OAAS8K,EACvB1P,EAAO6C,UAAUwC,OACjBrF,EAAO+C,OAAO,SAAWxB,KAAM,QAASyB,kBAAkB,EACtDvB,OAAS4D,MAAO,KAAMnB,IAAK,KAAMoB,OAAQ,QAEjDtF,EAAO+C,OAAO,QAAUxB,KAAM,mBAAoByB,kBAAkB,EAAOvB,OAAS+D,QAASvF,KAAKqC,gBAClGtC,EAAO+C,OAAO,QAAUxB,KAAM,mBAAoByB,kBAAkB,EAAOvB,OAAS+D,QAASvF,KAAKwC,gBAC9FzC,EAAOyF,cACPzF,EAAO+C,OAAO,QAAUxB,KAAM,aAAcyB,kBAAkB,EAC1DvB,OAAS+D,QAASvF,KAAKqC,aAAc+H,OAAQ,KAAMC,OAAQ,QAGlE6B,cACDnM,EAAO+C,OAAO,WAAaxB,KAAM,uBAAwByB,kBAAkB,OAIvFwxB,EAAU1zB,UAAUq3B,oBAAsB,WACtC,GAAIn4B,GAASC,KAAKD,MAClB,IAAqC,IAAjCA,EAAOuG,eAAenB,OAAc,CACpC,GAAI8D,GAA2BjF,YAAWjE,EAAOsH,SAAS4B,6BAA8B,EACxFlJ,GAAO+C,OAAO,QAAUxB,KAAM,2BAA4ByB,kBAAkB,IAC5EhD,EAAOsH,SAAS4B,yBAA2BA,MAG3ClJ,GAAO+C,OAAO,QAAUxB,KAAM,2BAA4ByB,kBAAkB,KAGpFwxB,EAAU1zB,UAAUq2B,yBAA2B,WAC3C,GAAIn3B,GAASC,KAAKD,MAClBA,GAAO6C,UAAUyF,aAAa+G,WAAarP,EAAO+c,SAASjB,MAAMzM,WACjErP,EAAO6C,UAAUmQ,eAAehE,YAA8C,KAAhChP,EAAO+c,SAASjB,MAAMsX,OAChEpzB,EAAO+c,SAASjB,MAAMsX,MAAMxmB,MAAM,KAAK,IAAM5M,EAAO+c,SAASjB,MAAMsX,MAAMxmB,MAAM,KAAK,GAAGA,MAAM,KAAK,IAClG5M,EAAO+c,SAASjB,MAAMsX,MAAMxmB,MAAM,KAAK,GAAGA,MAAM,KAAK,IAAM5M,EAAO+c,SAASjB,MAAMsX,MAAMxmB,MAAM,KAAK,GAAGA,MAAM,KAAK,GAChH3M,KAAKqiC,SAAS1a,WAAW5nB,EAAO+c,SAASjB,MAAMsX,MAAMxmB,MAAM,KAAK,GAAGA,MAAM,KAAK,IAAKgb,WAAW5nB,EAAO+c,SAASjB,MAAMsX,MAAMxmB,MAAM,KAAK,GAAGA,MAAM,KAAK,IAAKgb,WAAW5nB,EAAO+c,SAASjB,MAAMsX,MAAMxmB,MAAM,KAAK,GAAGA,MAAM,KAAK,KACxN5M,EAAO+c,SAASjB,MAAMsX,MACe,SAArCpzB,EAAO+c,SAASjB,MAAMipB,WACtB/kC,EAAO6C,UAAUyF,aAAagH,MAAO,EAGrCtP,EAAO6C,UAAUyF,aAAagH,MAAO,EAED,WAApCtP,EAAO+c,SAASjB,MAAMkpB,UACtBhlC,EAAO6C,UAAUyF,aAAaiH,QAAS,EAGvCvP,EAAO6C,UAAUyF,aAAaiH,QAAS,EAE3CvP,EAAO6C,UAAUyF,aAAaE,SAAYof,WAAW5nB,EAAO+c,SAASjB,MAAMtT,WAE/EgsB,EAAU1zB,UAAUwhC,SAAW,SAAU2C,EAAGC,EAAGlrB,GAC3C,MAAO,IAAM/Z,KAAKklC,eAAeF,GAAKhlC,KAAKklC,eAAeD,GAAKjlC,KAAKklC,eAAenrB,IAEvFwa,EAAU1zB,UAAUqkC,eAAiB,SAAUC,GAC3C,GAAIC,GAAMD,EAAI9f,SAAS,GACvB,OAAsB,KAAf+f,EAAIjgC,OAAe,IAAMigC,EAAMA,GAE1C7Q,EAAU1zB,UAAUg3B,WAAa,WAC7B,GAAI93B,GAASC,KAAKD,OACd0zB,IAEJ,IAAIzzB,KAAKg2B,aAAc,CACnBh2B,KAAKqlC,+BACL,IAAIv4B,GAAc9I,YAAWjE,EAAOiG,YAAa,GAC7CF,GAAWC,WACfhG,GAAO+C,OAAO,UAAYxB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAASsE,OAAQA,MACvFiH,EAAUjH,EAAgB,SACtBZ,QAAUlB,YAAWjE,EAAOmF,YAAa,GACjD6H,EAAQ9F,UAAYjD,YAAWjE,EAAOkH,cAAe,GACrD8F,EAAQlH,iBAAmB7B,YAAWjE,EAAO8F,qBAAsB,EAC/DuZ,IAAoBhW,aAAc,KACtCrJ,GAAO+C,OAAO,iBAAmBxB,KAAM,kBAAmByB,kBAAkB,EACxEvB,OAASyC,IAAKmb,KAClBrS,EAAQ3D,aAAepF,YAAWob,EAA8B,iBAAO,EACnEnb,IAAQqhC,uBAAwB,KACpCvlC,GAAO+C,OAAO,iBAAmBxB,KAAM,4BAA6ByB,kBAAkB,EAAOvB,OAASyC,IAAKA,KAC3GlE,EAAO+C,OAAO,iBAAmBxB,KAAM,YAAaE,OAASwb,GAAI/Y,EAA4B,0BAC7FlE,EAAO+C,OAAO,aAAexB,KAAM,qBAAsByB,kBAAkB,EACvEvB,OAAS6L,UAAW,wBAAyBC,YAAaP,EAASQ,gBAAiBvN,KAAKqhB,YACrF7T,kBAAmBT,EAAQ9F,UAAWwG,qBAAsBV,EAAQ3D,aACpEsE,gBAAiBZ,EAAaa,aAAc,KAC5CC,YAAa,KAAMC,eAAgB,KAAMrI,aAAc,QAC/DzF,EAAO+C,OAAO,aAAexB,KAAM,gBAAiBE,OAASmF,KAAM,QACnE5G,EAAO+C,OAAO,iBAAmBxB,KAAM,oCAEtC,IAAsC,SAAlCvB,EAAO+c,SAASjB,MAAMG,QAAoB,CAC/C,GAAI/X,IAAQkO,WAAY,KAMxB,IALApS,EAAO+C,OAAO,QAAUxB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAASyC,IAAKA,KAClFA,EAAgB,aAChBA,EAAgB,WAAe,YAAS,MAAIkE,KAAKC,IAAInE,EAAgB,WAAe,YAAS,OAC7FA,EAAgB,WAAe,YAAU,OAAIkE,KAAKC,IAAInE,EAAgB,WAAe,YAAU,SAE/FA,EAAgB,YAAKy9B,KAAKC,UAAU19B,EAAgB,cAAOy9B,KAAKC,UAAU5hC,EAAO6C,WAAY,CAC7F,GAAIywB,GAAQtzB,EAAO6C,UAAUic,SAC7B9e,GAAO+C,OAAO,QAAUxB,KAAM,gBAAiBE,OAASgI,oBAAqB,OAC7E,KAAK,GAAIxE,GAAI,EAAGA,EAAIjF,EAAOmF,QAAQC,OAAQH,IACvC,GAAIjF,EAAOmF,QAAQF,GAAG6Z,YAAcwU,EAAO,CACvCtzB,EAAOmF,QAAQi9B,OAAOn9B,EAAG,GACzBjF,EAAO+C,OAAO,QAAUxB,KAAM,eAAgBE,OAAS8Z,aAAc,OACrE,QAIRxV,GAAWoK,UAAW,KAE1B,IADAnQ,EAAO+C,OAAO,QAAUxB,KAAM,aAAcE,OAASyC,IAAK6B,KACtDA,EAAkB,UAClB/F,EAAO+C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,IACrE/C,KAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOwC,YAAYlC,MAAON,EAAOwC,YAAYjC,QAC/EP,EAAO+C,OAAO,QAAUxB,KAAM,eAAgBE,OAAS8Z,aAAc,QAChEpP,aAIDnM,EAAO+N,cAAc/N,EAAOgO,QAAS,eAHrChO,EAAO+C,OAAO,WAAaxB,KAAM,uBAAwByB,kBAAkB,QAM9E,IAAIhD,EAAO6C,UAAUwC,MAAO,CAC7BrF,EAAOmF,QAAQe,KAAKlG,EAAO6C,UAC3B,IAAIkK,GAAc9I,YAAWjE,EAAOiG,YAAa,GAC7Cu/B,GAAax/B,WACjBhG,GAAO+C,OAAO,UAAYxB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAASsE,OAAQy/B,IAC3F,IAAIx4B,GAAUw4B,EAAkB,OAChCx4B,GAAQ7H,QAAUlB,YAAWjE,EAAOmF,YAAa,GACjD6H,EAAQ9F,UAAYjD,YAAWjE,EAAOkH,cAAe,GACrD8F,EAAQlH,iBAAmB7B,YAAWjE,EAAO8F,qBAAsB,EACnE,IAAIuZ,IAAoBhW,aAAc,KACtCrJ,GAAO+C,OAAO,iBAAmBxB,KAAM,kBAAmByB,kBAAkB,EACxEvB,OAASyC,IAAKmb,KAClBrS,EAAQ3D,aAAepF,YAAWob,EAA8B,iBAAO,GACvErf,EAAOmF,QAAQwB,MAEf+sB,GAAsB5T,OAAQ,SAAU6T,sBADhB1zB,KAAK83B,0BACyDnE,qBAAsB,MAC5G5zB,EAAO+C,OAAO,SAAWxB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAAS2R,WAAY,MAC9FpT,EAAOif,iBACH9S,cAAcnM,EAAOoM,SAAsD,IAA5CpM,EAAOoM,OAAOynB,cAAcxnB,YAC3DrM,EAAOsM,UAAUC,kBAAkB,kBAAmB,UAAWmnB,IAGjE1zB,EAAO0M,QAAQ,gBAAiBgnB,GAC3BvnB,cACDnM,EAAO+C,OAAO,WAAaxB,KAAM,uBAAwByB,kBAAkB,KAG9Ed,oBAAkB8K,EAAQ7H,QAAQ6H,EAAQ7H,QAAQC,OAAS,GAAG0Z,aAC/D9e,EAAO+C,OAAO,aAAexB,KAAM,qBAAsByB,kBAAkB,EACvEvB,OAAS6L,UAAW,YAAaC,YAAaP,EAASQ,gBAAiBvN,KAAKqhB,YACzE7T,kBAAmBT,EAAQ9F,UAAWwG,qBAAsBV,EAAQ3D,aACpEsE,gBAAiBZ,EAAaa,aAAc,KAC5CC,YAAa,KAAMC,eAAgB,KAAMrI,aAAc,QAC/DzF,EAAO+C,OAAO,aAAexB,KAAM,gBAAiBE,OAASmF,KAAM,SAG3E5G,EAAO+C,OAAO,QAAUxB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAAS2Q,WAAY,QAE7F4K,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,6BAC5CD,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,2BAA2BnB,MAAMG,QAAU,SAG/FuY,EAAU1zB,UAAUwkC,8BAAgC,WAChD,GAAItlC,GAASC,KAAKD,OACd8/B,GAAaC,sBAAuB,KAExC,IADA//B,EAAO+C,OAAO,iBAAmBxB,KAAM,2BAA4ByB,kBAAkB,EAAOvB,OAASyC,IAAK47B,MACrG59B,oBAAkB49B,EAAgC,yBAAO59B,oBAAkBlC,EAAOkH,UAAU44B,EAAgC,yBACtD,YAApE9/B,EAAOkH,UAAU44B,EAAgC,uBAAG9wB,YAA2B,CAClF,GAAI9K,IAAQuhC,8BAA+B,KAC3CzlC,GAAO+C,OAAO,iBAAmBxB,KAAM,mCAAoCE,OAASyC,IAAKA,KACzFlE,EAAOkH,UAAU44B,EAAgC,uBAAG9wB,YAAc9K,EAAmC,8BAAE8K,cAG/GwlB,EAAU1zB,UAAUi3B,wBAA0B,SAAU7zB,GACpD,GAAIlE,GAASC,KAAKD,OACdglC,IAC2B,UAA3BhlC,EAAO6C,UAAUwC,OAAoBrF,EAAO6C,UAAUyF,eAClDtI,EAAO6C,UAAUyF,aAAagH,MAC9B01B,EAAU9+B,KAAK,QAEflG,EAAO6C,UAAUyF,aAAaiH,QAC9By1B,EAAU9+B,KAAK,UAEflG,EAAO6C,UAAUyF,aAAakH,WAC9Bw1B,EAAU9+B,KAAK,aAGvB,IAAIyZ,IACA1C,GAAK/a,oBAAkBlC,EAAO6C,UAAUic,WAA0C,KAA7B9e,EAAO6C,UAAUic,UACtElY,KAAM5G,EAAO+G,aAAa/G,EAAO6C,UAAUwC,OAC3CjF,OAAQJ,EAAO6C,UAAUC,YAAY1C,OAAQC,OAAQL,EAAO6C,UAAUC,YAAYzC,OAClFC,MAAON,EAAO6C,UAAUC,YAAYxC,MAAOC,OAAQP,EAAO6C,UAAUC,YAAYvC,OAChFyO,YAAahP,EAAO6C,UAAUmQ,eAAiBhT,EAAO6C,UAAUmQ,eAAehE,YAAc,KAC7FE,YAAalP,EAAO6C,UAAUmQ,eAAiBhT,EAAO6C,UAAUmQ,eAAe9D,YAAc,KAC7FD,UAAWjP,EAAO6C,UAAUmQ,eAAiBhT,EAAO6C,UAAUmQ,eAAe/D,UAAY,KACzFtE,OAAmC,YAA3B3K,EAAO6C,UAAUwC,MAAsBrF,EAAO6C,UAAUC,YAAYxC,MAAQ,EAAI,KACxF8E,OAAmC,SAA3BpF,EAAO6C,UAAUwC,OAA+C,UAA3BrF,EAAO6C,UAAUwC,MAAoBrF,EAAO6C,UAAUC,YAAYxC,MAAQ,KACvH8O,KAAiC,SAA3BpP,EAAO6C,UAAUwC,MAAoBrF,EAAO6C,UAAUuQ,WAAapT,EAAO6C,UAAUuQ,WACrFpT,EAAO6C,UAAUyF,aAAa8G,KAAOpP,EAAO6C,UAAUyF,aAAa8G,KAAO,KAAS,KACxF5G,SAAqC,SAA3BxI,EAAO6C,UAAUwC,OAAoBrF,EAAO6C,UAAUyF,aAAetI,EAAO6C,UAAUyF,aAAaE,SAAmB,KAChI6G,WAAuC,SAA3BrP,EAAO6C,UAAUwC,OAAoBrF,EAAO6C,UAAUyF,aAAetI,EAAO6C,UAAUyF,aAAa+G,WAAqB,KACpI21B,UAAsC,SAA3BhlC,EAAO6C,UAAUwC,MAAmB2/B,EAAY,KAC3D5R,MAAkC,SAA3BpzB,EAAO6C,UAAUwC,OAAoBrF,EAAO6C,UAAUmQ,eAAiBhT,EAAO6C,UAAUmQ,eAAehE,YAAsB,KAKxI,OAHI9K,KACAA,EAAsB,iBAAIyb,GAEvBA,GAEX6U,EAAU1zB,UAAU+4B,mBAAqB,SAAU6L,EAAOC,EAAOC,EAAWC,EAAYC,EAAWlZ,EAAQC,GACvG,GAAIpiB,GAAUi7B,EAAQE,EAAY,EAC9Bl7B,EAAUi7B,EAAQE,EAAa,EAC/BE,EAAWD,GAAa19B,KAAKyC,GAAK,KAClCm7B,EAAW59B,KAAKgR,IAAI2sB,GACpBE,EAAW79B,KAAKkR,IAAIysB,GACpBG,EAAStZ,EAASniB,EAClB07B,EAAStZ,EAASniB,EAClB07B,EAAWF,EAASF,EAAWG,EAASF,EACxCI,GAAYH,EAASD,EAAWE,EAASH,EACzCM,EAAYV,EAAY,EACxBW,EAAaV,EAAa,CAE9B,OAAIO,KAAaE,GAAaF,GAAYE,GAAaD,IAAaE,GAChEF,GAAYE,GAOpB/R,EAAU1zB,UAAUw3B,sBAAwB,SAAUp0B,EAAK6B,GACvD,GAAIwP,GACArS,EACA4U,GAAmB,EACnBC,GAAiB,CAUrB,KARI7U,EADoB,IAApBgB,EAAIiE,YACKlI,KAAKD,OAAOiD,UAAUC,OAGtBjD,KAAKD,OAAOiD,UAAUC,OAASgB,EAAIiE,aAEnC,IACTjF,EAAS,IAAMA,GAEfgB,EAAI8T,YACJ,IAAK,GAAI/S,GAAI,EAAGA,EAAIf,EAAI8T,YAAY5S,OAAQH,IACC,eAArCf,EAAI8T,YAAY/S,GAAG4N,cACnBiF,GAAmB,EAEuB,aAArC5T,EAAI8T,YAAY/S,GAAG4N,gBACxBkF,GAAiB,EA+C7B,OA3Ce,KAAX7U,GAA2B,MAAXA,EAEZqS,EADAwC,GACwBtX,EAAGyD,EAAI8Q,gBAAgB5U,OAC3CM,EAAGwD,EAAI8Q,gBAAgB3U,OAAS6D,EAAImS,qBAGhB5V,EAAGyD,EAAImR,mBAAmBjV,OAC9CM,EAAGwD,EAAImR,mBAAmBhV,OAAS6D,EAAImS,oBAG/B,KAAXnT,IAA6B,MAAZA,EAElBqS,EADAuC,GACwBrX,EAAGyD,EAAIiR,kBAAkB/U,OACzC8D,EAAImS,mBAAoB3V,EAAGwD,EAAIgR,iBAAiB7U,SAGhCI,EAAGyD,EAAIgR,iBAAiB9U,OACxC8D,EAAImS,mBAAoB3V,EAAGwD,EAAIgR,iBAAiB7U,QAG5C,MAAX6C,IAA8B,MAAZA,EAEnBqS,EADAwC,GACwBtX,EAAGyD,EAAImR,mBAAmBjV,OAC9CM,EAAGwD,EAAImR,mBAAmBhV,OAAS6D,EAAImS,qBAGnB5V,EAAGyD,EAAI8Q,gBAAgB5U,OAC3CM,EAAGwD,EAAI8Q,gBAAgB3U,OAAS6D,EAAImS,oBAG5B,MAAXnT,IAA8B,KAAZA,IAEnBqS,EADAuC,GACwBrX,EAAGyD,EAAIgR,iBAAiB9U,OACxC8D,EAAImS,mBAAoB3V,EAAGwD,EAAIgR,iBAAiB7U,SAGhCI,EAAGyD,EAAIiR,kBAAkB/U,OACzC8D,EAAImS,mBAAoB3V,EAAGwD,EAAIgR,iBAAiB7U,SAG5D0F,IACAA,EAA4B,oBAAIwP,GAE7BA,GAEJif,KCh8IPgS,EAAuB,WACvB,QAASA,GAAMxmC,GACXC,KAAKqI,cAAiB8G,KAAM,aAAcC,WAAY,QAAS7G,SAAU,KAAMD,UAAW,KAAM+G,MAAM,EAAOC,QAAQ,EAAOC,WAAW,GACvIvP,KAAK+S,gBAAmBhE,YAAa,OAAQC,UAAW,GAAIC,YAAa,MACzEjP,KAAKmT,WAAa,GAClBnT,KAAKD,OAASA,EACdC,KAAKY,mBAqtFT,MAntFA2lC,GAAM1lC,UAAUC,QAAU,WAClBd,KAAKD,OAAOgB,aAGhBf,KAAKgB,uBAETulC,EAAM1lC,UAAUD,iBAAmB,WAC/BZ,KAAKD,OAAOkB,GAAG,QAASjB,KAAKoF,MAAOpF,MACpCA,KAAKD,OAAOkB,GAAG,YAAajB,KAAKc,QAASd,OAE9CumC,EAAM1lC,UAAUG,oBAAsB,WAClChB,KAAKD,OAAOoB,IAAI,QAASnB,KAAKoF,OAC9BpF,KAAKD,OAAOoB,IAAI,YAAanB,KAAKc,UAEtCylC,EAAM1lC,UAAUuE,MAAQ,SAAUhE,GAE9B,OADApB,KAAKwmC,oBACGplC,EAAKE,MACT,IAAK,cACDtB,KAAKymC,YAAYrlC,EAAKI,MAAS,EAAGJ,EAAKI,MAAS,EAAGJ,EAAKI,MAAe,QAAGJ,EAAKI,MAAe,QAAGJ,EAAKI,MAAmB,YAAGJ,EAAKI,MAAmB,YAAGJ,EAAKI,MAAiB,UAC7K,MACJ,KAAK,WACDxB,KAAK0mC,SAAStlC,EAAKI,MAAc,OAAGJ,EAAKI,MAAc,OAAGJ,EAAKI,MAAY,KAAGJ,EAAKI,MAAY,KAAGJ,EAAKI,MAAmB,YAAGJ,EAAKI,MAAmB,YACrJ,MACJ,KAAK,YACDxB,KAAK2mC,UAAUvlC,EAAKI,MAAc,OAAGJ,EAAKI,MAAc,OAAGJ,EAAKI,MAAY,KAAGJ,EAAKI,MAAY,KAAGJ,EAAKI,MAAmB,YAAGJ,EAAKI,MAAmB,YAAGJ,EAAKI,MAAkB,WAAGJ,EAAKI,MAAgB,SACxM,MACJ,KAAK,WACDxB,KAAK4mC,SAASxlC,EAAKI,MAAiB,UAAGJ,EAAKI,MAAmB,YAAGJ,EAAKI,MAAmB,YAC1F,MACJ,KAAK,gBACDxB,KAAK6mC,cAAczlC,EAAKI,MAAS,EAAGJ,EAAKI,MAAS,EAAGJ,EAAKI,MAAa,MAAGJ,EAAKI,MAAc,OAAGJ,EAAKI,MAAmB,YAAGJ,EAAKI,MAAmB,YAAGJ,EAAKI,MAAiB,UAC5K,MACJ,KAAK,WACDxB,KAAK8mC,SAAS1lC,EAAKI,MAAS,EAAGJ,EAAKI,MAAS,EAAGJ,EAAKI,MAAY,KAAGJ,EAAKI,MAAkB,WAAGJ,EAAKI,MAAgB,SAAGJ,EAAKI,MAAY,KAAGJ,EAAKI,MAAc,OAAGJ,EAAKI,MAAa,MAClL,MACJ,KAAK,eACDxB,KAAK+mC,aAAa3lC,EAAKI,MAAS,EAAGJ,EAAKI,MAAS,EAAGJ,EAAKI,MAAmB,YAC5E,MACJ,KAAK,QACDxB,KAAKgnC,MAAM5lC,EAAKI,MAAa,MAAGJ,EAAKI,MAAW,IAAGJ,EAAKI,MAAc,OACtE,MACJ,KAAK,6BACDxB,KAAKinC,2BAA2B7lC,EAAKI,MAAqB,cAC1D,MACJ,KAAK,wBACDxB,KAAKknC,sBAAsB9lC,EAAKI,MAAyB,kBACzD,MACJ,KAAK,iBACDxB,KAAKmnC,gBACL,MACJ,KAAK,uBACDnnC,KAAKonC,sBACL,MACJ,KAAK,cACDpnC,KAAKqnC,YAAYjmC,EAAKI,MAAsB,eAC5C,MACJ,KAAK,YACDxB,KAAKsnC,UAAUlmC,EAAKI,MAAc,OAClC,MACJ,KAAK,gBACDxB,KAAKunC,eACL,MACJ,KAAK,kBACDvnC,KAAKwnC,eACL,MACJ,KAAK,cACDxnC,KAAKynC,YACL,MACJ,KAAK,aACDznC,KAAK0nC,UAAUtmC,EAAKI,MAAW,IAAGJ,EAAKI,MAAmB,YAAGJ,EAAKI,MAAmB,YAAGJ,EAAKI,MAAiB,UAAGJ,EAAKI,MAAa,MAAGJ,EAAKI,MAAa,MAAGJ,EAAKI,MAAc,OAC9K,MACJ,KAAK,iBACDxB,KAAK2nC,eAAevmC,EAAKI,MAAS,EAAGJ,EAAKI,MAAS,EAAGJ,EAAKI,MAAc,OACzE,MACJ,KAAK,kBACDxB,KAAK4nC,gBAAgBxmC,EAAKI,MAAS,EACnC,MACJ,KAAK,iBACDxB,KAAK6nC,eAAezmC,EAAKI,MAAS,EAClC,MACJ,KAAK,aACDxB,KAAK8nC,WAAW1mC,EAAKI,MAAa,MAAGJ,EAAKI,MAAa,MAAGJ,EAAKI,MAAiB,UAChF,MACJ,KAAK,mBACDxB,KAAK+nC,iBAAiB3mC,EAAKI,MAAiB,UAC5C,MACJ,KAAK,iBACDxB,KAAKgoC,eAAe5mC,EAAKI,MAAY,KACrC,MACJ,KAAK,kBACDxB,KAAKioC,gBAAgB7mC,EAAKI,MAAW,IAAGJ,EAAKI,MAAkB,WAC/D,MACJ,KAAK,iBACDxB,KAAKkoC,eAAe9mC,EAAKI,MAAW,IACpC,MACJ,KAAK,gBACDxB,KAAKmoC,cAAc/mC,EAAKI,MAAY,KAAGJ,EAAKI,MAAe,QAC3D,MACJ,KAAK,qBACDxB,KAAKooC,oBACL,MACJ,KAAK,cACDpoC,KAAKqoC,aACL,MACJ,KAAK,mBACDroC,KAAKsoC,kBACL,MACJ,KAAK,cACDtoC,KAAKuoC,YAAYnnC,EAAKI,MAAmB,YACzC,MACJ,KAAK,YACDmuB,eAAa7R,IAAI9d,KAAKD,OAAOwC,YAAa,WAAYvC,KAAK6nC,eAAgB7nC,MAC3E2vB,eAAa7R,IAAI9d,KAAKD,OAAO+c,SAAU,YAAa9c,KAAK6nC,eAAgB7nC,KACzE,MACJ,KAAK,cACD2vB,eAAa3D,OAAOhsB,KAAKD,OAAOwC,YAAa,WAAYvC,KAAK6nC,gBAC9DlY,eAAa3D,OAAOhsB,KAAKD,OAAO+c,SAAU,YAAa9c,KAAK6nC,eAC5D,MACJ,KAAK,kBACD7nC,KAAKwoC,gBAAgBpnC,EAAKI,MAAU,GAAGJ,EAAKI,MAAW,IACvD,MACJ,KAAK,mBACDxB,KAAKyoC,iBAAiBrnC,EAAKI,MAAW,IACtC,MACJ,KAAK,kBACDxB,KAAK0oC,gBAAgBtnC,EAAKI,MAAS,EAAGJ,EAAKI,MAAS,EAAGJ,EAAKI,MAAW,IACvE,MACJ,KAAK,sBACDxB,KAAK2oC,oBAAoBvnC,EAAKI,MAAkB,WAAGJ,EAAKI,MAA8B,uBAAGJ,EAAKI,MAAW,IACzG,MACJ,KAAK,cACDxB,KAAK4oC,YAAYxnC,EAAKI,MAAU,GAAGJ,EAAKI,MAAW,IACnD,MACJ,KAAK,cACDxB,KAAK6oC,YAAYznC,EAAKI,MAAU,GAChC,MACJ,KAAK,aACDxB,KAAK8oC,WAAW1nC,EAAKI,MAAiB,UAAGJ,EAAKI,MAAY,KAAGJ,EAAKI,MAAW,IAC7E,MACJ,KAAK,2BACDJ,EAAKI,MAAW,IAAEyF,UAAYjH,KAAK+oC,cAAc3nC,EAAKI,MAAW,IAAEqB,YAAY1C,OAAQiB,EAAKI,MAAW,IAAEqB,YAAYzC,OAAQgB,EAAKI,MAAW,IAAEqB,YAAYkF,KAAM3G,EAAKI,MAAW,IAAEqB,YAAYmF,KAC/L,MACJ,KAAK,+BACDhI,KAAKgpC,6BAA6B5nC,EAAKI,MAAW,IAClD,MACJ,KAAK,kBACGJ,EAAKI,MAAoB,aACzBxB,KAAKqI,aAAejH,EAAKI,MAAoB,aAExCJ,EAAKI,MAAkB,WAC5BxB,KAAKqI,aAAa+G,WAAahO,EAAKI,MAAkB,WAEjDJ,EAAKI,MAAgB,WAC1BxB,KAAKqI,aAAaE,SAAWnH,EAAKI,MAAgB,SAEtD,MACJ,KAAK,oBACGJ,EAAKI,MAAsB,eAC3BxB,KAAK+S,eAAiB3R,EAAKI,MAAsB,eAE5CJ,EAAKI,MAAmB,YAC7BxB,KAAK+S,eAAehE,YAAc3N,EAAKI,MAAmB,YAErDJ,EAAKI,MAAiB,UAC3BxB,KAAK+S,eAAe/D,UAAY5N,EAAKI,MAAiB,UAEjDJ,EAAKI,MAAmB,cAC7BxB,KAAK+S,eAAe9D,YAAc7N,EAAKI,MAAmB,YAE9D,MACJ,KAAK,oBACDJ,EAAKI,MAAW,IAAkB,eAAIxB,KAAK+S,cAC3C,MACJ,KAAK,gBACD/S,KAAKmT,WAAa/R,EAAKI,MAAkB,UACzC,MACJ,KAAK,gBACDJ,EAAKI,MAAW,IAAc,WAAIxB,KAAKmT,UACvC,MACJ,KAAK,gBACDnT,KAAKipC,cAAc7nC,EAAKI,MAAc,OAAGJ,EAAKI,MAAc,OAAGJ,EAAKI,MAAY,KAAGJ,EAAKI,MAAS,EAAGJ,EAAKI,MAAS,EAClH,MACJ,KAAK,mBACDxB,KAAKkpC,iBAAiB9nC,EAAKI,MAAc,OAAGJ,EAAKI,MAAc,OAAGJ,EAAKI,MAAY,KAAGJ,EAAKI,MAAS,EAAGJ,EAAKI,MAAS,EACrH,MACJ,KAAK,0BACDxB,KAAKmpC,yBACL,MACJ,KAAK,sBACDnpC,KAAKopC,oBAAoBhoC,EAAKI,MAAY,KAAGJ,EAAKI,MAAkB,WAAGJ,EAAKI,MAAgB,SAAGJ,EAAKI,MAAY,KAAGJ,EAAKI,MAAc,OAAGJ,EAAKI,MAAmB,YACjK,MACJ,KAAK,kBACDxB,KAAKqpC,gBAAgBjoC,EAAKI,MAAS,EACnC,MACJ,KAAK,mBACDxB,KAAKspC,iBAAiBloC,EAAKI,MAAW,IACtC,MACJ,KAAK,gCACDxB,KAAKupC,8BAA8BnoC,EAAKI,MAAW,IAAGJ,EAAKI,MAAc,OACzE,MACJ,KAAK,QACDxB,KAAKkC,UAIjBqkC,EAAM1lC,UAAUsB,cAAgB,WAC5B,MAAO,SAEXokC,EAAM1lC,UAAU2lC,kBAAoB,WAC5BxmC,KAAKD,OAAOqC,cACZpC,KAAKqC,aAAerC,KAAKD,OAAOqC,YAAYE,WAAW,OAEvDtC,KAAKD,OAAOwC,cACZvC,KAAKwC,aAAexC,KAAKD,OAAOwC,YAAYD,WAAW,QAG/DikC,EAAM1lC,UAAUqB,MAAQ,WACpBlC,KAAKqI,cACC8G,KAAM,aAAcC,WAAY,QAAS7G,SAAU,KAAMD,UAAW,KAAM+G,MAAM,EAAOC,QAAQ,EAAOC,WAAW,GACvHvP,KAAK+S,gBAAmBhE,YAAa,OAAQC,UAAW,GAAIC,YAAa,OAE7Es3B,EAAM1lC,UAAU4lC,YAAc,SAAUjmC,EAAGC,EAAG+oC,EAASC,EAASx6B,EAAaF,EAAaC,EAAW/L,GACjGjD,KAAK0pC,gBAAgB,UACrB,IAAInzB,GAAQ/V,GAAKC,GAAMD,EAAGA,EAAGC,EAAGA,GAAM,IACtCT,MAAK0nC,UAAU,UAAWz4B,EAAaF,EAAaC,EAAWuH,EAAOizB,EAASC,EAAS,KAAM,KAAM,KAAMxmC,IAE9GsjC,EAAM1lC,UAAU6lC,SAAW,SAAUvmC,EAAQC,EAAQ2H,EAAMC,EAAMiH,EAAaF,GAC1E/O,KAAK0pC,gBAAgB,OACrB,IAAInzB,GAAQpW,GAAUC,GAAWI,EAAGL,EAAQM,EAAGL,GAAW,KACtDC,EAAQ0H,EAAO5H,EACfG,EAAS0H,EAAO5H,CACpBJ,MAAK0nC,UAAU,OAAQz4B,EAAaF,EAAa,KAAMwH,EAAOlW,EAAOC,IAEzEimC,EAAM1lC,UAAU+lC,SAAW,SAAU3/B,EAAWgI,EAAaF,GAEzD,GADA/O,KAAK0pC,gBAAgB,QACjBziC,EACAjH,KAAK0nC,UAAU,OAAQz4B,EAAaF,EAAa,KAAM,KAAM,KAAM,KAAM9H,OAExE,CACDjH,KAAK0nC,UAAU,OAAQz4B,EAAaF,EAAa,KAAM,KAAM,KAAM,KACnE,IAAI9K,GAAMD,YAAWhE,KAAKD,OAAOmF,QAAQlF,KAAKD,OAAOmF,QAAQC,OAAS,GAAI,MAAM,EAChFlB,GAAImB,MAAQ,OACZnB,EAAI0lC,SAAW,KACf1lC,EAAIgD,YAAezG,EAAGyD,EAAIpB,YAAY1C,OAAQM,EAAGwD,EAAIpB,YAAYzC,SAC3DI,EAAGyD,EAAIpB,YAAYkF,KAAMtH,EAAGwD,EAAIpB,YAAYmF,OAClDhI,KAAKD,OAAOmF,QAAQlF,KAAKD,OAAOmF,QAAQC,OAAS,GAAKlB,IAG9DsiC,EAAM1lC,UAAU8lC,UAAY,SAAUxmC,EAAQC,EAAQ2H,EAAMC,EAAMiH,EAAaF,EAAa66B,EAAYC,GACpG7pC,KAAK0pC,gBAAgB,QACrB,IAAInzB,GAAQpW,GAAUC,GAAWI,EAAGL,EAAQM,EAAGL,GAAW,KACtDC,EAAQ0H,EAAO5H,EACfG,EAAS0H,EAAO5H,CACpBJ,MAAK0nC,UAAU,QAASz4B,EAAaF,EAAa,KAAMwH,EAAOlW,EAAOC,EAAQ,KAAMspC,EAAYC,IAEpGtD,EAAM1lC,UAAUgmC,cAAgB,SAAUrmC,EAAGC,EAAGJ,EAAOC,EAAQ2O,EAAaF,EAAaC,EAAW/L,GAChGjD,KAAK0pC,gBAAgB,YACrB,IAAInzB,GAAQ/V,GAAKC,GAAMD,EAAGA,EAAGC,EAAGA,GAAM,IACtCT,MAAK0nC,UAAU,YAAaz4B,EAAaF,EAAaC,EAAWuH,EAAOlW,EAAOC,EAAQ,KAAM,KAAM,KAAM2C,IAE7GsjC,EAAM1lC,UAAUimC,SAAW,SAAUtmC,EAAGC,EAAG0O,EAAMC,EAAY7G,EAAU8G,EAAMC,EAAQ6jB,GACjFnzB,KAAKwnC,cAAcr4B,EAAMC,EAAY7G,EAAU8G,EAAMC,EAAQ6jB,EAAO3yB,EAAGC,IAE3E8lC,EAAM1lC,UAAU6oC,gBAAkB,SAAU/iC,GACxC3G,KAAK+mC,eACL/mC,KAAKD,OAAO6C,UAAUwC,MAAQuB,EACQ,iBAAlC3G,KAAKD,OAAO0F,YAAYL,QACxBpF,KAAKgnC,QACLhnC,KAAKD,OAAOwC,YAAYsZ,MAAMgC,OAAS7d,KAAKD,OAAO8d,OAAS,UAC5D7d,KAAKD,OAAO0F,YAAYL,MAAQ,IAEpCpF,KAAKD,OAAO0F,YAAYC,cAAe,GAE3C6gC,EAAM1lC,UAAUkT,kBAAoB,SAAU9P,GAG1C,MAFAA,GAAIpB,YAAYxC,MAAQ4D,EAAIpB,YAAYkF,KAAO9D,EAAIpB,YAAY1C,OAC/D8D,EAAIpB,YAAYvC,OAAS2D,EAAIpB,YAAYmF,KAAO/D,EAAIpB,YAAYzC,OACzD6D,GAEXsiC,EAAM1lC,UAAUipC,aAAe,SAAUzpC,EAAOC,GACxCD,GAASC,IACTN,KAAKD,OAAO6C,UAAUC,YAAYxC,MAAQA,EAC1CL,KAAKD,OAAO6C,UAAUC,YAAYvC,OAASA,EACS,YAAhDN,KAAKD,OAAO0F,YAAYL,MAAMwN,gBAC9B5S,KAAKD,OAAO6C,UAAUC,YAAYxC,MAAQ,EAAIA,EAC9CL,KAAKD,OAAO6C,UAAUC,YAAYvC,OAAS,EAAIA,KAI3DimC,EAAM1lC,UAAUkpC,aAAe,SAAUpjC,GACrC,GAAIqjC,GAAYrjC,CAMhB,OALIA,KAGAqjC,GAFwBC,KAAQ,OAAQC,MAAS,QAASC,WAAc,aACpEC,OAAU,SAAUC,YAAe,cAAeC,OAAU,SAAUC,YAAe,cAAeC,IAAO,OACnF,GAAK7jC,IAE9BqjC,GAEXzD,EAAM1lC,UAAU6mC,UAAY,SAAU/gC,EAAMsI,EAAaF,EAAaC,EAAWuH,EAAOlW,EAAOC,EAAQ2G,EAAW2iC,EAAYC,EAAU5mC,GACpI,GAAIsI,GAAQvL,KACRD,EAASC,KAAKD,MAClB,KAAKA,EAAOyL,UAAYzL,EAAO0L,cAAe,CAC1C1L,EAAO+C,OAAO,QAAUxB,KAAM,iBAAkByB,kBAAkB,IAClE/C,KAAK+mC,cACL,IAAI0D,GAAYzmC,YAAWjE,EAAOmF,YAAa,EAM/C,IALAnF,EAAOse,WAAY,EACnBre,KAAKmT,WAAa,GAClBnT,KAAKD,OAAOwC,YAAYsZ,MAAMG,QAAU,QACxChc,KAAKsoC,mBACLvoC,EAAO0F,YAAYL,MAAQuB,EACoB,SAA3C5G,EAAO0F,YAAYL,MAAMwN,eAA4B3Q,oBAAkBgF,GACvElH,EAAO6C,UAAUwC,MAAQrF,EAAO0F,YAAYL,MAAMwN,cAClD7S,EAAO6C,UAAUqE,aACjBlH,EAAOwC,YAAYsZ,MAAMgC,OAAS7d,KAAKD,OAAO8d,OAAS,YACvD9d,EAAO+C,OAAO,aAAexB,KAAM,yBAA0ByB,kBAAkB,EAAOvB,OAASA,MAAO,UACjG0K,eACDnM,EAAO+C,OAAO,WAAaxB,KAAM,kBAAmByB,kBAAkB,EAAOvB,OAASmF,KAAM,SACpF8C,WAAY,KAAMC,WAAY,KAAMC,UAAW,KAAMC,MAAO,QACpE7J,EAAO+C,OAAO,WAAaxB,KAAM,uBAAwByB,kBAAkB,SAI/E,IAA+C,iBAA3ChD,EAAO0F,YAAYL,MAAMwN,eAA+E,KAA3C7S,EAAO0F,YAAYL,MAAMwN,cAAsB,CAC5G7S,EAAO6C,UAAUwC,MAAQrF,EAAO0F,YAAYL,MAAMwN,cAClD5S,KAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOwC,YAAYlC,MAAON,EAAOwC,YAAYjC,QAC3E2B,oBAAkBlC,EAAO6C,UAAUmQ,kBACnChT,EAAO6C,UAAUmQ,eAAiB/S,KAAK+S,gBAEI,SAA3ChT,EAAO0F,YAAYL,MAAMwN,eAA4B3L,IACrDlH,EAAO6C,UAAUqE,UAAYA,GAEjClH,EAAO6C,UAAUmQ,eAAe9D,YAAcA,GAA4BlP,EAAO6C,UAAUmQ,eAAe9D,YAC1GlP,EAAO6C,UAAUmQ,eAAehE,YAAcA,GAA4BhP,EAAO6C,UAAUmQ,eAAehE,YAC1GhP,EAAO6C,UAAUmQ,eAAe/D,UAAYA,GAAwBjP,EAAO6C,UAAUmQ,eAAe/D,SACpG,IAAIoJ,GAAYrY,EAAOqD,IAAIG,UAAY,IAAM,IAAMxD,EAAOqD,IAAIG,UAAY,EACtEg5B,EAAax8B,EAAOqD,IAAII,WAAa,IAAM,IAAMzD,EAAOqD,IAAII,WAAa,CAC7EzD,GAAO6C,UAAUC,YAAYxC,MAAQ+X,EACrCrY,EAAO6C,UAAUC,YAAYvC,OAASi8B,EACS,SAA3Cx8B,EAAO0F,YAAYL,MAAMwN,eAAuE,UAA3C7S,EAAO0F,YAAYL,MAAMwN,eAC9E7S,EAAO6C,UAAU+mC,SAAW,aAC5B5pC,EAAO6C,UAAUC,YAAYvC,OAAS,EACS,UAA3CP,EAAO0F,YAAYL,MAAMwN,gBACzB7S,EAAO6C,UAAUC,YAAYxC,OAAS,GACtCN,EAAO6C,UAAU2T,MAAQvW,KAAK+pC,aAAaH,GAC3C7pC,EAAO6C,UAAU4T,IAAMxW,KAAK+pC,aAAaF,KAGG,cAA3C9pC,EAAO0F,YAAYL,MAAMwN,gBAC9B7S,EAAO6C,UAAUC,YAAYxC,OAASN,EAAO6C,UAAUC,YAAYxC,MAAQ,GAE/EL,KAAK8pC,aAAazpC,EAAOC,GACrBiW,GACAxW,EAAO6C,UAAUC,YAAY1C,OAASoW,EAAM/V,EAC5CT,EAAO6C,UAAUC,YAAYzC,OAASmW,EAAM9V,EAC5CV,EAAO6C,UAAUC,YAAYkF,KAAOhI,EAAO6C,UAAUC,YAAY1C,OAC7DJ,EAAO6C,UAAUC,YAAYxC,MACjCN,EAAO6C,UAAUC,YAAYmF,KAAOjI,EAAO6C,UAAUC,YAAYzC,OAC7DL,EAAO6C,UAAUC,YAAYvC,QAGjCN,KAAK0qC,kBAET1qC,KAAK2qC,8BAC0C,UAA3C5qC,EAAO0F,YAAYL,MAAMwN,gBACzB7S,EAAO6C,UAAU4U,kBAAoB,SAEzCzX,EAAO0F,YAAYwZ,WAAalf,EAAO0F,YAAYC,cAAe,EAClE1F,KAAK4qC,gBACL,IAAI3mC,IAAQyb,oBACZ3f,GAAO+C,OAAO,aAAexB,KAAM,0BAA2ByB,kBAAkB,EAAOvB,OAASyC,IAAKA,IACrG,IAAIqvB,GAAgBrvB,EAAsB,iBACtCwvB,GAAsB5T,OAAQ,SAAU6T,sBAAuBJ,EAC/DK,qBAAsBL,EACtBpnB,eAAcnM,EAAOoM,SAAsD,IAA5CpM,EAAOoM,OAAOynB,cAAcxnB,YAE3DpM,KAAKD,OAAOsM,UAAUC,kBAAkB,kBAAmB,UAAWmnB,GAAmBlnB,KAAK,SAAUknB,GACpGloB,EAAM07B,2BAA2BxT,EAAkBE,sBACnDpoB,EAAMu+B,aAAazpC,EAAOC,GAC1BP,EAAO+C,OAAO,QAAUxB,KAAM,aAAcyB,kBAAkB,EAAOvB,OAAS6D,OAAQ,eAClFpC,IACAlD,EAAO6C,UAAUgR,aAAe3Q,GAAUkF,KAAKyC,GAAK,KACpD7K,EAAO+C,OAAO,aAAexB,KAAM,qBAAsByB,kBAAkB,EAAOvB,OAASyC,IAAKlE,EAAO6C,cAE3G7C,EAAO+N,cAAc/N,EAAOgO,QAAS,qBAAsB,SAC3DhO,EAAO+C,OAAO,aAAexB,KAAM,kBAAmByB,kBAAkB,EAAOvB,OAAS4E,MAAM,KAC9FrG,EAAO+C,OAAO,aAAexB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAAS0D,QAASulC,KACzF1qC,EAAO8qC,gBACP9qC,EAAO+C,OAAO,aAAexB,KAAM,iBAAkByB,kBAAkB,IAE3EhD,EAAO8qC,gBAAiB,KAI5B9qC,EAAO0M,QAAQ,gBAAiBgnB,GAChCzzB,KAAKinC,2BAA2BxT,EAAkBE,sBAClD3zB,KAAK8pC,aAAazpC,EAAOC,GACzBP,EAAO+C,OAAO,QAAUxB,KAAM,aAAcyB,kBAAkB,EAAOvB,OAAS6D,OAAQ,eAClFpC,IACAlD,EAAO6C,UAAUgR,aAAe3Q,GAAUkF,KAAKyC,GAAK,KACpD7K,EAAO+C,OAAO,aAAexB,KAAM,qBAAsByB,kBAAkB,EAAOvB,OAASyC,IAAKlE,EAAO6C,cAEtGsJ,aAIDnM,EAAO+N,cAAc/N,EAAOgO,QAAS,qBAAsB,SAH3DhO,EAAO+C,OAAO,WAAaxB,KAAM,YAAayB,kBAAkB,EAAOvB,OAASw+B,UAAW,QAK/FjgC,EAAO+C,OAAO,aAAexB,KAAM,kBAAmByB,kBAAkB,EAAOvB,OAAS4E,MAAM,KAC9FrG,EAAO+C,OAAO,aAAexB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAAS0D,QAASulC,KAC7F1qC,EAAO+C,OAAO,WAAaxB,KAAM,kBAAmByB,kBAAkB,EAAOvB,OAASmF,KAAM,SACpF8C,WAAY,KAAMC,WAAY,KAAMC,UAAW,KAAMC,MAAO,QACpE7J,EAAO+C,OAAO,WAAaxB,KAAM,uBAAwByB,kBAAkB,IACvEhD,EAAO8qC,gBACP9qC,EAAO+C,OAAO,aAAexB,KAAM,iBAAkByB,kBAAkB,IAE3EhD,EAAO8qC,gBAAiB,MAM5CtE,EAAM1lC,UAAU+pC,eAAiB,WAC7B,GAAI7qC,GAASC,KAAKD,MAClBA,GAAO6C,UAAUsF,YAAcnI,EAAOiD,UAAUC,OAChDlD,EAAO6C,UAAUmE,UAAYhH,EAAOiD,UAAUU,cAC9C3D,EAAO6C,UAAUkoC,SAAW/qC,EAAOiD,UAAUU,cAC7C3D,EAAO6C,UAAUmV,gBAErBwuB,EAAM1lC,UAAU8pC,4BAA8B,WAC1C,GAAI5qC,GAASC,KAAKD,MAClB,KAA+B,SAA3BA,EAAO6C,UAAUwC,OAA+C,UAA3BrF,EAAO6C,UAAUwC,SACtDrF,EAAO6C,UAAUqE,UAAYjH,KAAK+oC,cAAchpC,EAAO6C,UAAUC,YAAY1C,OAAQJ,EAAO6C,UAAUC,YAAYzC,OAAQL,EAAO6C,UAAUC,YAAYkF,KAAMhI,EAAO6C,UAAUC,YAAYmF,MACtLjI,EAAO6C,UAAUqE,WACjB,IAAK,GAAIjC,GAAI,EAAGC,EAAMlF,EAAO6C,UAAUqE,UAAU9B,OAAQH,EAAIC,EAAKD,IAC9DjF,EAAO6C,UAAUqE,UAAUjC,GAAG2D,QAAU5I,EAAO6C,UAAUqE,UAAUjC,GAAGxE,EAClET,EAAOqD,IAAIC,UAAYtD,EAAOqD,IAAIG,UACtCxD,EAAO6C,UAAUqE,UAAUjC,GAAG4D,QAAU7I,EAAO6C,UAAUqE,UAAUjC,GAAGvE,EAClEV,EAAOqD,IAAIE,SAAWvD,EAAOqD,IAAII,YAKrD+iC,EAAM1lC,UAAUkqC,YAAc,WAC1B,GAAIhrC,GAASC,KAAKD,OACd+F,GAAWC,WACfhG,GAAO+C,OAAO,UAAYxB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAASsE,OAAQA,KAC3F9F,KAAK+M,QAAUjH,EAAgB,QAC/B9F,KAAK+M,QAAQ7H,QAAUlB,YAAWjE,EAAOmF,YAAa,GACtDlF,KAAK+M,QAAQ9F,UAAYjD,YAAWjE,EAAOkH,cAAe,GAC1DjH,KAAK+M,QAAQlH,iBAAmB7B,YAAWjE,EAAO8F,qBAAsB,EACxE,IAAIuZ,IAAoBhW,aAAc,KACtCrJ,GAAO+C,OAAO,iBAAmBxB,KAAM,kBAAmByB,kBAAkB,EACxEvB,OAASyC,IAAKmb,KAClBpf,KAAK+M,QAAQ3D,aAAepF,YAAWob,EAA8B,iBAAO,IAEhFmnB,EAAM1lC,UAAU2mC,cAAgB,SAAUr4B,EAAMC,EAAY7G,EAAU8G,EAAMC,EAAQP,EAAavO,EAAGC,GAChG,GAAI8K,GAAQvL,KACRD,EAASC,KAAKD,MAClB,KAAKA,EAAOyL,UAAYzL,EAAO0L,cAAe,CACT,iBAA7B1L,EAAO0F,YAAYL,QACnBpF,KAAKgnC,QACLjnC,EAAOwC,YAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS,UAClD9d,EAAO0F,YAAYL,MAAQ,IAE/BrF,EAAO+C,OAAO,QAAUxB,KAAM,iBAAkByB,kBAAkB,IAClEhD,EAAOse,WAAY,EACnBre,KAAK+mC,eACL/mC,KAAK+qC,cACL/qC,KAAKsoC,mBACLvoC,EAAO6C,UAAUwC,MAAQrF,EAAO0F,YAAYL,MAAQ,OACpDrF,EAAO0F,YAAYC,cAAe,EAClC1F,KAAKopC,oBAAoBj6B,EAAMC,EAAY7G,EAAU8G,EAAMC,EAAQP,GACnEhP,EAAO0F,YAAYwN,OAASlT,EAAO0F,YAAYulC,eAAgB,EAC3D/oC,oBAAkBlC,EAAO6C,UAAUyF,aAAaE,YAC5CxI,EAAOqD,IAAIG,UAAYxD,EAAOqD,IAAII,WAClCzD,EAAO6C,UAAUyF,aAAaE,SAAYxI,EAAOqD,IAAIG,UAAY,GAGjExD,EAAO6C,UAAUyF,aAAaE,SAAYxI,EAAOqD,IAAII,WAAa,GAElEzD,EAAO6C,UAAUyF,aAAaE,SAAW,KACzCxI,EAAO6C,UAAUyF,aAAaE,SAAW,KAG7CxI,EAAOqD,IAAIG,UAAY,IACvBxD,EAAO6C,UAAUyF,aAAaE,SAAWJ,KAAK2xB,MAAO/5B,EAAOqD,IAAIG,UAAY,IAEvExD,EAAOqD,IAAII,WAAa,MAC7BzD,EAAO6C,UAAUyF,aAAaE,SAAWJ,KAAK2xB,MAAO/5B,EAAOqD,IAAII,WAAa,KAEjFzD,EAAO6C,UAAUsF,YAAcnI,EAAOiD,UAAUC,OAChDlD,EAAO6C,UAAUmE,UAAYhH,EAAOiD,UAAUU,cAC9C3D,EAAO6C,UAAUmV,eACjB/X,KAAK+nC,kBACL,IAAI1nC,GAAQL,KAAKwC,aAAayoC,YAAYlrC,EAAO6C,UAAUyF,aAAa8G,MAAM9O,MACjC,GAAzCN,EAAO6C,UAAUyF,aAAaE,SAC9BjI,EAASP,EAAO6C,UAAUyF,aAAaE,SAAoD,IAAzCxI,EAAO6C,UAAUyF,aAAaE,QAC/EtG,qBAAkBzB,IAAOyB,oBAAkBxB,GAO5CT,KAAK0qC,iBAAgB,EAAMrqC,EAAOC,IANlCP,EAAO6C,UAAUC,YAAY1C,OAASK,EACtCT,EAAO6C,UAAUC,YAAYzC,OAASK,EACtCV,EAAO6C,UAAUC,YAAYkF,KAAOhI,EAAO6C,UAAUC,YAAY1C,OAASE,EAC1EN,EAAO6C,UAAUC,YAAYmF,KAAOjI,EAAO6C,UAAUC,YAAYzC,OAASE,EAK9E,IAAI2D,IAAQyb,oBACZ3f,GAAO+C,OAAO,aAAexB,KAAM,0BAA2ByB,kBAAkB,EAAOvB,OAASyC,IAAKA,IACrG,IAAIqvB,GAAgBrvB,EAAsB,iBACtCwvB,GAAsB5T,OAAQ,SAAU6T,sBAAuBJ,EAC/DK,qBAAsBL,EACtBpnB,eAAcnM,EAAOoM,SAAsD,IAA5CpM,EAAOoM,OAAOynB,cAAcxnB,YAE3DrM,EAAOsM,UAAUC,kBAAkB,kBAAmB,UAAWmnB,GAAmBlnB,KAAK,SAAUknB,GAC/FloB,EAAM2/B,mBAAmBzX,GACrB1zB,EAAO8qC,gBACP9qC,EAAO+C,OAAO,aAAexB,KAAM,iBAAkByB,kBAAkB,IAE3EhD,EAAO8qC,gBAAiB,KAI5B9qC,EAAO0M,QAAQ,gBAAiBgnB,GAChCzzB,KAAKkrC,mBAAmBzX,GACpB1zB,EAAO8qC,gBACP9qC,EAAO+C,OAAO,aAAexB,KAAM,iBAAkByB,kBAAkB,IAE3EhD,EAAO8qC,gBAAiB,KAIpCtE,EAAM1lC,UAAUqqC,mBAAqB,SAAUzX,GAC3C,GAAI1zB,GAASC,KAAKD,MAClBC,MAAKinC,2BAA2BxT,EAAkBE,sBAClD3zB,KAAKmrC,UAAUprC,EAAO6C,UAAUyF,aAAa8G,MAC7CpP,EAAO6C,UAAUkoC,SAAW/qC,EAAOiD,UAAUU,cAC7C1D,KAAKioC,gBAAgBloC,EAAO6C,WAC5B7C,EAAOmF,QAAQe,KAAKlG,EAAO6C,UAC3B,IAAIkK,GAAc9I,YAAWjE,EAAOiG,YAAa,EACjDjG,GAAO+C,OAAO,aAAexB,KAAM,qBAAsByB,kBAAkB,EACvEvB,OAAS6L,UAAW,iBAAkBC,YAAatN,KAAK+M,QAASQ,gBAAiBvN,KAAK+M,QAAQ7H,QAC3FsI,kBAAmBxN,KAAK+M,QAAQ9F,UAAWwG,qBAAsBzN,KAAK+M,QAAQ3D,aAC9EsE,gBAAiBZ,EAAaa,aAAc,KAC5CC,YAAa,KAAMC,eAAgB,KAAMrI,aAAc,QAC/DzF,EAAO+C,OAAO,aAAexB,KAAM,cAAeyB,kBAAkB,EAChEvB,OAASyC,IAAKlE,EAAOmF,QAAQnF,EAAOmF,QAAQC,OAAS,MACpD+G,aAIDnM,EAAO+N,cAAc/N,EAAOgO,QAAS,qBAAsB,QAH3DhO,EAAO+C,OAAO,WAAaxB,KAAM,YAAayB,kBAAkB,EAAOvB,OAASw+B,UAAW,QAK/FjgC,EAAO+C,OAAO,aAAexB,KAAM,kBAAmByB,kBAAkB,EAAOvB,OAAS4E,MAAM,KACzF8F,aAMDnM,EAAO+N,cAAc/N,EAAOgO,QAAS,SALrChO,EAAO+C,OAAO,WAAaxB,KAAM,kBAAmByB,kBAAkB,EAAOvB,OAASmF,KAAM,OACpF8C,WAAY,KAAMC,WAAY,KAAMC,UAAW,KAAMC,MAAO,QACpE7J,EAAO+C,OAAO,WAAaxB,KAAM,uBAAwByB,kBAAkB,MAMnFwjC,EAAM1lC,UAAUuoC,oBAAsB,SAAUj6B,EAAMC,EAAY7G,EAAU8G,EAAMC,EAAQP,GACtF,GAAIhP,GAASC,KAAKD,MAClBC,MAAKmT,WAAa,GAClBpT,EAAOwC,YAAYsZ,MAAMG,QAAU,QAC/B/Z,oBAAkBlC,EAAO6C,UAAUyF,gBACnCtI,EAAO6C,UAAUyF,aAAerI,KAAKqI,cAErCpG,oBAAkBlC,EAAO6C,UAAUmQ,kBACnChT,EAAO6C,UAAUmQ,eAAiB/S,KAAK+S,gBAE3ChT,EAAO6C,UAAUmQ,eAAehE,YAAcA,GAAehP,EAAO6C,UAAUmQ,eAAehE,YAC7FhP,EAAO6C,UAAUyF,aAAa8G,KAAOA,GAAQpP,EAAO6C,UAAUyF,aAAa8G,KAC3EpP,EAAO6C,UAAUyF,aAAa+G,WAAaA,GAAcrP,EAAO6C,UAAUyF,aAAa+G,WACvFrP,EAAO6C,UAAUyF,aAAaE,SAAWA,GAAYxI,EAAO6C,UAAUyF,aAAaE,SACnFxI,EAAO6C,UAAUyF,aAAagH,KAAOA,GAAQtP,EAAO6C,UAAUyF,aAAagH,KAC3EtP,EAAO6C,UAAUyF,aAAaiH,OAASA,GAAUvP,EAAO6C,UAAUyF,aAAaiH,QAEnFi3B,EAAM1lC,UAAUkmC,aAAe,SAAUvmC,EAAGC,EAAG8a,GAC3C,GAAI7O,GACA3M,EAASC,KAAKD,MACdA,GAAO6C,UAAUwC,QACjBsH,EAAa3M,EAAO6C,UAAUwC,MAAMuH,MAAM,MAE1C5M,EAAO6C,UAAUgK,YAAe7M,EAAO6C,UAAUwC,OAA2B,SAAlBsH,EAAW,KAC/B,UAAlC3M,EAAO+c,SAASjB,MAAMG,SACtBjc,EAAO+C,OAAO,aAAexB,KAAM,2BAA4ByB,kBAAkB,IACjF/C,KAAKioC,gBAAgBloC,EAAO6C,WAAW,GACnCpC,GAAKC,EACAD,IAAMT,EAAO6C,UAAUC,YAAY1C,QAAYM,IAAMV,EAAO6C,UAAUC,YAAYzC,QACnFJ,KAAKorC,0BAITprC,KAAKorC,yBACLrrC,EAAO+c,SAASjB,MAAM7Y,UAAY,GAClCjD,EAAO+C,OAAO,WAAaxB,KAAM,uBAAwByB,kBAAkB,KAE/E/C,KAAKsoC,oBAGLtoC,KAAKuoC,YAAYhtB,KAI7BgrB,EAAM1lC,UAAUmmC,MAAQ,SAAU5hC,EAAOnB,EAAKoB,GAC1C,GAAItF,GAASC,KAAKD,MAClB,KAAKA,EAAOyL,SACR,GAAIzL,EAAOse,YAActe,EAAO0F,YAAYC,aAAc,CACtD,GAAIrC,GAAWtD,EAAOqD,IAAIC,SACtBC,EAAUvD,EAAOqD,IAAIE,QACrBC,EAAYxD,EAAOqD,IAAIG,UACvBC,EAAazD,EAAOqD,IAAII,UAC5BzD,GAAO+C,OAAO,QAAUxB,KAAM,2BAA4ByB,kBAAkB,GAC5E,IAAI2B,GAAO1E,KAAKqC,aAAasC,MAC7B3E,MAAKqC,aAAasC,OAAS,OAC3B5E,EAAOse,WAAY,EACnBre,KAAKmnC,iBACLpnC,EAAO+C,OAAO,gBAAkBxB,KAAM,iBAAkByB,kBAAkB,EACtEvB,OAAS+D,QAASvF,KAAKqC,aAAcwG,OAAQ,QACjD9I,EAAOse,WAAY,GACfte,EAAOyF,cAAiBzF,EAAOgE,oBACK,gBAApChE,EAAOgE,mBAAmBqB,QAC1BrF,EAAO+C,OAAO,QAAUxB,KAAM,aAAcyB,kBAAkB,EAC1DvB,OAAS+D,QAASvF,KAAKqC,aAAc+H,OAAQ,KAAMC,OAAQ,QAEnEtK,EAAOqD,IAAIC,SAAWA,EACtBtD,EAAOqD,IAAIE,QAAUA,EACrBvD,EAAOqD,IAAIG,UAAYA,EACvBxD,EAAOqD,IAAII,WAAaA,EACxBxD,KAAKqC,aAAasC,OAASD,MAG3BW,GAASA,GAAkB,WACvBpD,oBAAkBlC,EAAO6C,UAAUwC,QAAUnD,oBAAkBmD,GAC/DrF,EAAO0F,YAAYL,MAAQ,GAG3BrF,EAAO0F,YAAYL,MAAQA,GAASrF,EAAO0F,YAAYL,MAE1B,KAA7BrF,EAAO0F,YAAYL,QACnBpF,KAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOwC,YAAYlC,MAAON,EAAOwC,YAAYjC,QAChD,SAA3BP,EAAO6C,UAAUwC,OACjBrF,EAAO+C,OAAO,QAAUxB,KAAM,aAAcyB,kBAAkB,EAAOvB,OAAS6D,OAAQA,EAAQpB,IAAKA,EAAKsO,YAAa,KAC7G1J,OAAQ,KAAM2J,eAAe,EAAMC,YAAa,KAAMC,mBAAoB,QAClF3S,EAAO+C,OAAO,QAAUxB,KAAM,mBAAoByB,kBAAkB,EAAOvB,OAAS+D,QAASvF,KAAKqC,iBAGlGtC,EAAO+C,OAAO,QAAUxB,KAAM,aAAcyB,kBAAkB,EAAOvB,OAAS6D,OAAQA,EAAQpB,IAAKA,KAEvGlE,EAAO6C,UAAUwC,MAAQrF,EAAO0F,YAAYL,MAAMwN,cAC7CxN,GAAsC,KAA7BrF,EAAO0F,YAAYL,OAAiBrF,EAAO0F,YAAYC,cACjE3F,EAAOmF,QAAQe,KAAKjC,YAAWjE,EAAO6C,cAAe,IAEzD5C,KAAKmT,WAAa,KAKlCozB,EAAM1lC,UAAU6pC,gBAAkB,SAAUv7B,EAAM9O,EAAOC,GACrD,GACI+qC,GACAC,EAFAvrC,EAASC,KAAKD,MAGdoP,IAAQ9O,GAASC,GACjB+qC,EAAchrC,EACdirC,EAAehrC,IAGf+qC,EAActrC,EAAO6C,UAAUC,YAAYxC,MAC3CirC,EAAevrC,EAAO6C,UAAUC,YAAYvC,QAEhDP,EAAO6C,UAAUC,YAAY1C,OAAUJ,EAAOqC,YAAY/B,MAAQ,EAAKgrC,EAAc,EACrFtrC,EAAO6C,UAAUC,YAAYzC,OAAUL,EAAOqC,YAAY9B,OAAS,EAAKgrC,EAAe,EACvFvrC,EAAO6C,UAAUC,YAAYkF,KAAQhI,EAAOqC,YAAY/B,MAAQ,EAAKgrC,EAAc,EACnFtrC,EAAO6C,UAAUC,YAAYmF,KAAQjI,EAAOqC,YAAY9B,OAAS,EAAKgrC,EAAe,GAEzF/E,EAAM1lC,UAAUqmC,sBAAwB,SAAUjxB,GAC9C,GAAIlW,GAASC,KAAKD,MAClBA,GAAO6C,UAAUC,YAAY1C,OAAS8V,EAAkB9V,OACxDJ,EAAO6C,UAAUC,YAAYzC,OAAS6V,EAAkB7V,OACxDL,EAAO6C,UAAUC,YAAYxC,MAAQ4V,EAAkB5V,MACvDN,EAAO6C,UAAUC,YAAYvC,OAAS2V,EAAkB3V,OACxDP,EAAO6C,UAAUC,YAAYkF,KAAOhI,EAAO6C,UAAUC,YAAY1C,OAASJ,EAAO6C,UAAUC,YAAYxC,MACvGN,EAAO6C,UAAUC,YAAYmF,KAAOjI,EAAO6C,UAAUC,YAAYzC,OAASL,EAAO6C,UAAUC,YAAYvC,QAE3GimC,EAAM1lC,UAAUomC,2BAA6B,SAAU3T,GACnD,GAAIvzB,GAASC,KAAKD,MAUlB,QATAA,EAAO6C,UAAUic,UAAYyU,EAActW,GAC3Cjd,EAAO6C,UAAUC,YAAY1C,OAASmzB,EAAcnzB,OACpDJ,EAAO6C,UAAUC,YAAYzC,OAASkzB,EAAclzB,OACpDL,EAAO6C,UAAUC,YAAYxC,MAAQizB,EAAcjzB,MACnDN,EAAO6C,UAAUC,YAAYvC,OAASgzB,EAAchzB,OACpDP,EAAO6C,UAAUC,YAAYkF,KAAOhI,EAAO6C,UAAUC,YAAY1C,OAASJ,EAAO6C,UAAUC,YAAYxC,MACvGN,EAAO6C,UAAUC,YAAYmF,KAAOjI,EAAO6C,UAAUC,YAAYzC,OAASL,EAAO6C,UAAUC,YAAYvC,OACvGP,EAAO6C,UAAUmQ,eAAehE,YAAcukB,EAAcvkB,YAC5DhP,EAAO6C,UAAUmQ,eAAe/D,UAAYskB,EAActkB,UAClDjP,EAAO6C,UAAUwC,OACrB,IAAK,UACDrF,EAAO6C,UAAUC,YAAYxC,MAA+B,EAAvBizB,EAAc5oB,MACnD,MACJ,KAAK,OACL,IAAK,QACD3K,EAAO6C,UAAUC,YAAYxC,MAAQizB,EAAcnuB,MACnD,MACJ,KAAK,OACDpF,EAAO6C,UAAUuQ,WAAapT,EAAO6C,UAAUyF,aAAa8G,KAAOmkB,EAAcnkB,KACjFpP,EAAO6C,UAAUyF,aAAaE,SAAW+qB,EAAc/qB,SACvDxI,EAAO6C,UAAUmQ,eAAehE,YAAcukB,EAAcH,MAC5DpzB,EAAO6C,UAAUyF,aAAa+G,WAAakkB,EAAclkB,WAKjE,GAA+B,SAA3BrP,EAAO6C,UAAUwC,OAAoBrF,EAAO6C,UAAUyF,aACtD,IAAK,GAAIrD,GAAI,EAAGA,EAAIsuB,EAAcyR,UAAU5/B,OAAQH,IAChD,OAAQsuB,EAAcyR,UAAU//B,IAC5B,IAAK,OACDjF,EAAO6C,UAAUyF,aAAagH,MAAO,CACrC,MACJ,KAAK,SACDtP,EAAO6C,UAAUyF,aAAaiH,QAAS,CACvC,MACJ,KAAK,YACDvP,EAAO6C,UAAUyF,aAAakH,WAAY,IAM9Dg3B,EAAM1lC,UAAUsqC,UAAY,SAAUI,GAClC,GAAIxrC,GAASC,KAAKD,MAClB,IAAsC,SAAlCA,EAAO+c,SAASjB,MAAMG,UAAuBjc,EAAO0F,YAAYwN,QAAqC,SAA3BlT,EAAO6C,UAAUwC,OAAmB,CAC/F,cAAXmmC,EACAvrC,KAAKmT,WAAanT,KAAKmT,WAAWuR,MAAM,GAAI,GAG5C1kB,KAAKmT,YAAco4B,EAEvBvrC,KAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOwC,YAAYlC,MAAON,EAAOwC,YAAYjC,QAC/EN,KAAK+nC,kBACL,IAAI1nC,GAAQL,KAAKwC,aAAayoC,YAAYjrC,KAAKmT,YAAY9S,MACZ,GAAzCN,EAAO6C,UAAUyF,aAAaE,SAChCjI,EAASP,EAAO6C,UAAUyF,aAAaE,SAAoD,IAAzCxI,EAAO6C,UAAUyF,aAAaE,QACpFvI,MAAKwC,aAAasY,SAAS9a,KAAKmT,WAAYpT,EAAO6C,UAAUC,YAAY1C,OAAQJ,EAAO6C,UAAUC,YAAYzC,OAC1GL,EAAO6C,UAAUyF,aAAaE,UAClCvI,KAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOwC,YAAYlC,MAAON,EAAOwC,YAAYjC,QAC/EP,EAAO0F,YAAYwN,QAAS,EAC5BlT,EAAO+C,OAAO,aAAexB,KAAM,iBAAkByB,kBAAkB,EACnEvB,OAASrB,OAAQE,EAAOD,OAAQE,OAG5CimC,EAAM1lC,UAAU4mC,WAAa,WACzB,GAAI1nC,GAASC,KAAKD,OACdglC,EAAY,EACZhlC,GAAO6C,UAAUyF,aAAagH,OAC9B01B,GAAa,SAEbhlC,EAAO6C,UAAUyF,aAAaiH,SAC9By1B,GAAa,WAEjB/kC,KAAKwC,aAAaiY,KAAOsqB,EAAYhlC,EAAO6C,UAAUyF,aAAaE,SAAW,MAAQxI,EAAO6C,UAAUyF,aAAa+G,UACpH,IAAIiL,GAAOta,EAAO6C,UAAUuQ,WAAWxG,MAAM,MACzCwC,EAAyC,UAAlCpP,EAAO+c,SAASjB,MAAMG,QAAsBhc,KAAK8oC,YAAW,GAAQ9oC,KAAK8oC,aAChFzoC,EAAQL,KAAKwC,aAAayoC,YAAY97B,GAAM9O,MAAiD,GAAzCN,EAAO6C,UAAUyF,aAAaE,SAClFjI,EAAS+Z,EAAKlV,QAAUpF,EAAO6C,UAAUyF,aAAaE,SAAoD,IAAzCxI,EAAO6C,UAAUyF,aAAaE,SACnGxI,GAAO+C,OAAO,aAAexB,KAAM,mBAAoByB,kBAAkB,EACrEvB,OAASnB,MAAOA,EAAOC,OAAQA,KACnCP,EAAO+C,OAAO,QAAUxB,KAAM,qBAAsByB,kBAAkB,EAAOvB,OAASmB,SAAU5C,EAAO6C,UAAUC,YAAaoB,IAAKlE,EAAO6C,UAClI4R,YAAa,KAAMhU,EAAG,KAAMC,EAAG,QACvCV,EAAO+C,OAAO,aAAexB,KAAM,cAAeyB,kBAAkB,EAChEvB,OAASyC,IAAKlE,EAAO6C,cAE7B2jC,EAAM1lC,UAAUuqC,uBAAyB,WACrC,GAAIrrC,GAASC,KAAKD,OACd+iC,GAAgB,EAChBh2B,EAAc9I,YAAWjE,EAAOiG,YAAa,GAC7CF,GAAWC,WACfhG,GAAO+C,OAAO,UAAYxB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAASsE,OAAQA,IAC3F,IAAIiH,GAAUjH,EAAgB,OAC9BiH,GAAQ7H,QAAUlB,YAAWjE,EAAOmF,YAAa,GACjD6H,EAAQ9F,UAAYjD,YAAWjE,EAAOkH,cAAe,GACrD8F,EAAQlH,iBAAmB7B,YAAWhE,KAAKD,OAAO8F,qBAAsB,EACxE,IAAIuZ,IAAoBhW,aAAc,KACtCrJ,GAAO+C,OAAO,iBAAmBxB,KAAM,kBAAmByB,kBAAkB,EACxEvB,OAASyC,IAAKmb,KAClBrS,EAAQ3D,aAAepF,YAAWob,EAA8B,iBAAO,GACnErf,EAAO6C,UAAUuQ,aAAepT,EAAO+c,SAAStb,QAChDshC,GAAgB,GAEpB/iC,EAAO6C,UAAUuQ,WAAapT,EAAO+c,SAAStb,MAC9CzB,EAAO+c,SAASjB,MAAMG,QAAU,OAChCjc,EAAO+c,SAAStb,MAAQ,GACxBxB,KAAK+nC,kBACL,IAAI1nC,GAAQL,KAAKwC,aAAayoC,YAAYlrC,EAAO6C,UAAUuQ,YAAY9S,MAC1B,GAAzCN,EAAO6C,UAAUyF,aAAaE,SAC9BjI,EAASP,EAAO6C,UAAUyF,aAAaE,SAAyD,IAA9CvI,KAAKD,OAAO6C,UAAUyF,aAAaE,SACrF8R,EAAOta,EAAO6C,UAAUuQ,WAAWxG,MAAM,KAC7C,IAAI0N,EAAKlV,OAAS,EAAG,CACjB7E,GAAU+Z,EAAKlV,MAEf,KAAK,GADDqmC,MACKxmC,EAAI,EAAGC,EAAMoV,EAAKlV,OAAQH,EAAIC,EAAKD,IACxCwmC,EAAUvlC,KAAKjG,KAAKwC,aAAayoC,YAAY5wB,EAAKrV,IAAI3E,MACT,GAAzCN,EAAO6C,UAAUyF,aAAaE,SAEtClI,GAAQ8H,KAAK4Y,IAAIimB,MAAM7+B,KAAMqjC,GAEjCzrC,EAAO+C,OAAO,aAAexB,KAAM,mBAAoByB,kBAAkB,EACrEvB,OAASnB,MAAOA,EAAOC,OAAQA,KACnCP,EAAO+C,OAAO,QAAUxB,KAAM,qBAAsByB,kBAAkB,EAAOvB,OAASmB,SAAU5C,EAAO6C,UAAUC,YAAaoB,IAAKlE,EAAO6C,UAClI4R,YAAa,KAAMhU,EAAG,KAAMC,EAAG,QACvCT,KAAKonC,uBACDtE,GACA9iC,KAAKgnC,MAAMjnC,EAAO6C,UAAUwC,MAAOrF,EAAO6C,WAC1C7C,EAAOmF,QAAQe,KAAKjC,YAAWjE,EAAO6C,cAAe,IACrD7C,EAAO+C,OAAO,aAAexB,KAAM,qBAAsByB,kBAAkB,EACvEvB,OAAS6L,UAAW,OAAQC,YAAaP,EAASQ,gBAAiBR,EAAQ7H,QACvEsI,kBAAmBT,EAAQ9F,UAAWwG,qBAAsBV,EAAQ3D,aACpEsE,gBAAiBZ,EAAaa,aAAc5N,EAAO6C,UAAUuQ,WAC7DvF,YAAa7N,EAAO+c,SAAStb,MAAOqM,eAAgB,KAAMrI,aAAc,UAGhFxF,KAAKgnC,MAAMjnC,EAAO6C,UAAUwC,MAAOrF,EAAO6C,WAC1C7C,EAAOmF,QAAQe,KAAKjC,YAAWjE,EAAO6C,cAAe,MAG7D2jC,EAAM1lC,UAAUsmC,eAAiB,WAE7B,IAAK,GADDpnC,GAASC,KAAKD,OACTiF,EAAI,EAAGC,EAAMlF,EAAOmF,QAAQC,OAAQH,EAAIC,EAAKD,IAClDhF,KAAKgnC,MAAMjnC,EAAOmF,QAAQF,GAAGI,MAAOrF,EAAOmF,QAAQF,IACnDhF,KAAKsoC,oBAGb/B,EAAM1lC,UAAUumC,qBAAuB,WACnC,GAAIrnC,GAASC,KAAKD,MAClBA,GAAO6C,UAAUkF,YAAe3H,QAAUJ,EAAO6C,UAAUC,YAAY1C,OAASJ,EAAOqD,IAAIC,UACnFtD,EAAOqD,IAAIG,UACfnD,QAAUL,EAAO6C,UAAUC,YAAYzC,OAASL,EAAOqD,IAAIE,SAAWvD,EAAOqD,IAAII,WACjFuE,MAAQhI,EAAO6C,UAAUC,YAAYkF,KAAOhI,EAAOqD,IAAIC,UAAYtD,EAAOqD,IAAIG,UAC9EyE,MAAQjI,EAAO6C,UAAUC,YAAYmF,KAAOjI,EAAOqD,IAAIE,SAAWvD,EAAOqD,IAAII,WAC7EnD,MAAON,EAAOqD,IAAIG,UAAYxD,EAAO6C,UAAUC,YAAYxC,MAAOC,OAAQP,EAAOqD,IAAII,WACjFzD,EAAO6C,UAAUC,YAAYvC,QACjCP,EAAO6C,UAAU+2B,0BACjB55B,EAAO6C,UAAU+2B,wBAAwBhxB,QAAU5I,EAAO6C,UAAU+2B,wBAAwBn5B,EACxFT,EAAOqD,IAAIC,UAAYtD,EAAOqD,IAAIG,UACtCxD,EAAO6C,UAAU+2B,wBAAwB/wB,QAAU7I,EAAO6C,UAAU+2B,wBAAwBl5B,EACxFV,EAAOqD,IAAIE,SAAWvD,EAAOqD,IAAII,YAEV,SAA3BzD,EAAO6C,UAAUwC,MACjBpF,KAAKyrC,gBAAgB1rC,EAAO6C,WAEI,UAA3B7C,EAAO6C,UAAUwC,OACtBpF,KAAKspC,iBAAiBvpC,EAAO6C,YAGrC2jC,EAAM1lC,UAAUwmC,YAAc,SAAUqE,GAEpC,IAAK,GADD3rC,GAASC,KAAKD,OACTiF,EAAI,EAAGC,EAAMlF,EAAOmF,QAAQC,OAAQH,EAAIC,EAAKD,IAAK,CACvD,GAAIe,GAAUhG,EAAOmF,QAAQF,EAM7B,IALAe,EAAQlD,YAAY1C,OAAU4F,EAAQ+B,WAAW3H,OAASJ,EAAOqD,IAAIG,UAAaxD,EAAOqD,IAAIC,SAC7F0C,EAAQlD,YAAYzC,OAAU2F,EAAQ+B,WAAW1H,OAASL,EAAOqD,IAAII,WAAczD,EAAOqD,IAAIE,QAC9FyC,EAAQlD,YAAYkF,KAAQhC,EAAQ+B,WAAWC,KAAOhI,EAAOqD,IAAIG,UAAaxD,EAAOqD,IAAIC,SACzF0C,EAAQlD,YAAYmF,KAAQjC,EAAQ+B,WAAWE,KAAOjI,EAAOqD,IAAII,WAAczD,EAAOqD,IAAIE,QAEpE,UADtByC,EAAU/F,KAAK+T,kBAAkBhO,IACrBX,MACRpF,KAAKkoC,eAAeniC,OAEnB,IAAsB,SAAlBA,EAAQX,OAAsC,UAAlBW,EAAQX,MAAmB,CAC5DW,EAAQkB,UAAYjH,KAAK+oC,cAAchjC,EAAQlD,YAAY1C,OAAQ4F,EAAQlD,YAAYzC,OAAQ2F,EAAQlD,YAAYkF,KAAMhC,EAAQlD,YAAYmF,KAC7I,KAAK,GAAIU,GAAI,EAAGijC,EAAQ5lC,EAAQkB,UAAU9B,OAAQuD,EAAIijC,EAAOjjC,IACzD3C,EAAQkB,UAAUyB,GAAGC,QAChB5C,EAAQkB,UAAUyB,GAAGlI,EAAIT,EAAOqD,IAAIC,UAAYtD,EAAOqD,IAAIG,UAChEwC,EAAQkB,UAAUyB,GAAGE,QAChB7C,EAAQkB,UAAUyB,GAAGjI,EAAIV,EAAOqD,IAAIE,SAAWvD,EAAOqD,IAAII,UAE7C,WAAlBuC,EAAQX,OACRpF,KAAK4rC,gBAAgB7lC,OAGxB,IAAsB,SAAlBA,EAAQX,MAAkB,CAC/B,IAAK,GAAI0D,GAAI,EAAG+iC,EAAQ9lC,EAAQkB,UAAU9B,OAAQ2D,EAAI+iC,EAAO/iC,IACzD/C,EAAQkB,UAAU6B,GAAGtI,EAAKuF,EAAQkB,UAAU6B,GAAGH,OAAS5I,EAAOqD,IAAIG,UAC7DxD,EAAOqD,IAAIC,SACjB0C,EAAQkB,UAAU6B,GAAGrI,EAAKsF,EAAQkB,UAAU6B,GAAGF,OAAS7I,EAAOqD,IAAII,WAC/DzD,EAAOqD,IAAIE,OAEnBtD,MAAKyrC,gBAAgB1lC,GAIzB,GAFAhG,EAAO+C,OAAO,QAAUxB,KAAM,qBAAsByB,kBAAkB,EAAOvB,OAASmB,SAAUoD,EAAQlD,YAChGoB,IAAK8B,KACT9D,oBAAkBypC,GAAe,CACjC,GAAIhnC,GAAO1E,KAAKqC,aAAasC,MAC7B3E,MAAKqC,aAAasC,OAAS,OAC3B3E,KAAKgnC,MAAMjhC,EAAQX,MAAOW,GAC1B/F,KAAKsoC,mBACLtoC,KAAKqC,aAAasC,OAASD,EAET,SAAlBqB,EAAQX,OAAsC,UAAlBW,EAAQX,OAAuC,SAAlBW,EAAQX,OAA6C,IAAzBW,EAAQ6N,eAC7F5T,KAAKgpC,6BAA6BjjC,GAClCA,EAAQuP,oBAAoB9U,EACvBuF,EAAQuP,oBAAoB3M,OAAS5I,EAAOqD,IAAIG,UAAaxD,EAAOqD,IAAIC,SAC7E0C,EAAQuP,oBAAoB7U,EACvBsF,EAAQuP,oBAAoB1M,OAAS7I,EAAOqD,IAAII,WAAczD,EAAOqD,IAAIE,QAC9EyC,EAAQ4zB,wBAAwBn5B,EAC3BuF,EAAQ4zB,wBAAwBhxB,OAAS5I,EAAOqD,IAAIG,UACjDxD,EAAOqD,IAAIC,SACnB0C,EAAQ4zB,wBAAwBl5B,EAC3BsF,EAAQ4zB,wBAAwB/wB,OAAS7I,EAAOqD,IAAII,WACjDzD,EAAOqD,IAAIE,WAI/BijC,EAAM1lC,UAAUymC,UAAY,SAAUrkC,GAClC,GAAIlD,GAASC,KAAKD,MAClB,IAAIC,KAAKD,OAAOmF,QAAQC,OAAS,EAC7B,GAAe,eAAXlC,GAAsC,aAAXA,GAAoC,eAAXA,GAAsC,aAAXA,GACpE,uBAAXA,GAA8C,uBAAXA,EACnCjD,KAAK8rC,4BAA4B7oC,EAAO2P,mBAEvC,IAAwB,mBAAU,CACnC5S,KAAK8rC,4BAA4B7oC,EACjC,IAAIwM,GAAazP,KAAKqC,aAAasC,MACnC3E,MAAKqC,aAAasC,OAAS,sHAE3B,KAAK,GAAIK,GAAI,EAAGC,EAAMlF,EAAOmF,QAAQC,OAAQH,EAAIC,EAAKD,IAE5B,SADLjF,EAAOmF,QAAQF,GAAGI,MAAMuH,MAAM,KAChC,IACX3M,KAAKgnC,MAAMjnC,EAAOmF,QAAQF,GAAGI,MAAOrF,EAAOmF,QAAQF,GAG3DhF,MAAKqC,aAAasC,OAAS8K,IAIvC82B,EAAM1lC,UAAUirC,4BAA8B,SAAU7oC,GAGpD,IAAK,GADD8oC,GADAhsC,EAASC,KAAKD,OAETszB,EAAQ,EAAGpuB,EAAMlF,EAAOmF,QAAQC,OAAQkuB,EAAQpuB,EAAKouB,IAAS,CACnE,GAAIttB,GAAUhG,EAAOmF,QAAQmuB,EAC7B,IAAItzB,EAAO6C,UAAUwC,QAAUW,EAAQX,OACnCrF,EAAO6C,UAAUC,YAAY1C,SAAW4F,EAAQlD,YAAY1C,QAC5DJ,EAAO6C,UAAUC,YAAYzC,SAAW2F,EAAQlD,YAAYzC,QAC5DL,EAAO6C,UAAUC,YAAYkF,OAAShC,EAAQlD,YAAYkF,MAC1DhI,EAAO6C,UAAUC,YAAYmF,OAASjC,EAAQlD,YAAYmF,MAC1DjI,EAAO6C,UAAUic,YAAc9Y,EAAQ8Y,UAAW,CAClDktB,EAAkB1Y,CAClB,QAGR,GAAe,eAAXpwB,GAAsC,aAAXA,GAAoC,eAAXA,GAAsC,aAAXA,GACpE,uBAAXA,GAA8C,uBAAXA,EAAiC,CACpE,GAAe,eAAXA,GAAsC,eAAXA,EAC3B,IAAK,GAAI+B,GAAI,EAAGC,EAAMlF,EAAOmF,QAAQC,OAAQH,EAAIC,EAAKD,KAC9Ce,EAAUhG,EAAOmF,QAAQF,IACjB+B,YAAchH,EAAOiD,UAAUU,gBACnCqC,EAAQlD,YAAY1C,QAAUJ,EAAOqD,IAAIC,SAAYtD,EAAOqD,IAAIG,UAAY,GAC5EwC,EAAQlD,YAAYkF,KAAQhI,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,WAAcwC,EAAQlD,YAAY1C,OAC3FJ,EAAOqD,IAAIC,UACf0C,EAAQlD,YAAY1C,OAAS4F,EAAQlD,YAAYkF,KAAOhC,EAAQlD,YAAYxC,MAC5EN,EAAO+C,OAAO,QAAUxB,KAAM,qBAAsByB,kBAAkB,EAAOvB,OAASmB,SAAUoD,EAAQlD,YAAaoB,IAAK8B,MAErHA,EAAQlD,YAAY1C,QAAUJ,EAAOqD,IAAIC,SAAYtD,EAAOqD,IAAIG,UAAY,IACjFwC,EAAQlD,YAAY1C,OAASJ,EAAOqD,IAAIC,UAAYtD,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,UACjFwC,EAAQlD,YAAYkF,MACxBhC,EAAQlD,YAAYkF,KAAOhC,EAAQlD,YAAY1C,OAAS4F,EAAQlD,YAAYxC,MAC5EN,EAAO+C,OAAO,QAAUxB,KAAM,qBAAsByB,kBAAkB,EAAOvB,OAASmB,SAAUoD,EAAQlD,YAChGoB,IAAK8B,MAEK,SAAlBA,EAAQX,OAAsC,UAAlBW,EAAQX,OAAuC,SAAlBW,EAAQX,MACjEpF,KAAKgsC,iBAAiBjmC,EAAS,cAED,IAAzBA,EAAQ6N,eACb7N,EAAQ6N,aAAe7N,EAAQ6N,aAAkD,GAAlCzL,KAAKyC,GAAK7E,EAAQ6N,cAC7D7N,EAAQ4zB,wBAAwBn5B,GAAKT,EAAOqD,IAAIC,SAAYtD,EAAOqD,IAAIG,UAAY,EACnFwC,EAAQ4zB,wBAAwBn5B,EAAKT,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,WACjEwC,EAAQ4zB,wBAAwBn5B,EAAIT,EAAOqD,IAAIC,UAE/C0C,EAAQ4zB,wBAAwBn5B,GAAKT,EAAOqD,IAAIC,SAAYtD,EAAOqD,IAAIG,UAAY,IACxFwC,EAAQ4zB,wBAAwBn5B,EAAIT,EAAOqD,IAAIC,UAC1CtD,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,UAAYwC,EAAQ4zB,wBAAwBn5B,IAEtFuF,EAAQ4zB,wBAAwBhxB,QAC3B5C,EAAQ4zB,wBAAwBn5B,EAAIT,EAAOqD,IAAIC,UAAYtD,EAAOqD,IAAIG,WAE/EwC,EAAQgB,UAAYhH,EAAOiD,UAAUU,cACrCqC,EAAQ+B,YAAe3H,QAAU4F,EAAQlD,YAAY1C,OAASJ,EAAOqD,IAAIC,UAAYtD,EAAOqD,IAAIG,UAC5FnD,QAAU2F,EAAQlD,YAAYzC,OAASL,EAAOqD,IAAIE,SAAWvD,EAAOqD,IAAII,WACxEuE,MAAQhC,EAAQlD,YAAYkF,KAAOhI,EAAOqD,IAAIC,UAAYtD,EAAOqD,IAAIG,UACrEyE,MAAQjC,EAAQlD,YAAYmF,KAAOjI,EAAOqD,IAAIE,SAAWvD,EAAOqD,IAAII,WACpEnD,MAAON,EAAOqD,IAAIG,UAAYwC,EAAQlD,YAAYxC,MAClDC,OAAQP,EAAOqD,IAAII,WAAauC,EAAQlD,YAAYvC,aAI/D,IAAe,aAAX2C,GAAoC,aAAXA,EAC9B,IAAS+B,EAAI,EAAGA,EAAIjF,EAAOmF,QAAQC,OAAQH,KACnCe,EAAUhG,EAAOmF,QAAQF,IACjB+B,YAAchH,EAAOiD,UAAUU,gBACnCqC,EAAQlD,YAAYzC,QAAUL,EAAOqD,IAAIE,QAAWvD,EAAOqD,IAAII,WAAa,GAC5EuC,EAAQlD,YAAYmF,KAAQjI,EAAOqD,IAAIE,QAAUvD,EAAOqD,IAAII,YACvDuC,EAAQlD,YAAYzC,OAASL,EAAOqD,IAAIE,SAC7CyC,EAAQlD,YAAYzC,OAAS2F,EAAQlD,YAAYmF,KAAOjC,EAAQlD,YAAYvC,OAC5EP,EAAO+C,OAAO,QAAUxB,KAAM,qBAAsByB,kBAAkB,EAAOvB,OAASmB,SAAUoD,EAAQlD,YAChGoB,IAAK8B,MAERA,EAAQlD,YAAYzC,QAAUJ,KAAKD,OAAOqC,YAAY9B,OAAS,IACpEyF,EAAQlD,YAAYzC,OAASL,EAAOqD,IAAIE,SAAWvD,EAAOqD,IAAIE,QAC1DvD,EAAOqD,IAAII,WAAauC,EAAQlD,YAAYmF,MAChDjC,EAAQlD,YAAYmF,KAAOjC,EAAQlD,YAAYzC,OAC3C2F,EAAQlD,YAAYvC,OACxBP,EAAO+C,OAAO,QAAUxB,KAAM,qBAAsByB,kBAAkB,EAAOvB,OAASmB,SAAUoD,EAAQlD,YAChGoB,IAAK8B,MAEK,SAAlBA,EAAQX,OAAsC,UAAlBW,EAAQX,OAClB,SAAlBW,EAAQX,MACRpF,KAAKgsC,iBAAiBjmC,EAAS,YAED,IAAzBA,EAAQ6N,eACb7N,EAAQ6N,cAAgB7N,EAAQ6N,aAC5B7N,EAAQ4zB,wBAAwBl5B,GAAKV,EAAOqD,IAAIE,QAAWvD,EAAOqD,IAAII,WAAa,EACnFuC,EAAQ4zB,wBAAwBl5B,EAAKV,EAAOqD,IAAIE,QAAUvD,EAAOqD,IAAII,YAChEuC,EAAQ4zB,wBAAwBl5B,EAAIV,EAAOqD,IAAIE,SAE/CyC,EAAQ4zB,wBAAwBl5B,GAAKV,EAAOqD,IAAIE,QACpDvD,EAAOqD,IAAII,WAAa,IACzBuC,EAAQ4zB,wBAAwBl5B,EAAIV,EAAOqD,IAAIE,SAAWvD,EAAOqD,IAAIE,QACjEvD,EAAOqD,IAAII,WAAauC,EAAQ4zB,wBAAwBl5B,IAEhEsF,EAAQ4zB,wBAAwB/wB,QAC3B7C,EAAQ4zB,wBAAwBl5B,EAAIV,EAAOqD,IAAIE,SAAWvD,EAAOqD,IAAII,YAE9EuC,EAAQgB,UAAYhH,EAAOiD,UAAUU,cACrCqC,EAAQ+B,YAAe3H,QAAU4F,EAAQlD,YAAY1C,OAASJ,EAAOqD,IAAIC,UAAYtD,EAAOqD,IAAIG,UAC5FnD,QAAU2F,EAAQlD,YAAYzC,OAASL,EAAOqD,IAAIE,SAAWvD,EAAOqD,IAAII,WACxEuE,MAAQhC,EAAQlD,YAAYkF,KAAOhI,EAAOqD,IAAIC,UAAYtD,EAAOqD,IAAIG,UACrEyE,MAAQjC,EAAQlD,YAAYmF,KAAOjI,EAAOqD,IAAIE,SAAWvD,EAAOqD,IAAII,WACpEnD,MAAON,EAAOqD,IAAIG,UAAYwC,EAAQlD,YAAYxC,MAClDC,OAAQP,EAAOqD,IAAII,WAAauC,EAAQlD,YAAYvC,aAI/D,IAAe,uBAAX2C,GAA8C,uBAAXA,EACxC,IAAK,GAAI+B,GAAI,EAAGC,EAAMlF,EAAOmF,QAAQC,OAAQH,EAAIC,EAAKD,KAC9Ce,EAAUhG,EAAOmF,QAAQF,IACjB+B,YAAchH,EAAOiD,UAAUU,gBACnCqC,EAAQlD,YAAY1C,QAAUJ,EAAOqD,IAAIC,SAAYtD,EAAOqD,IAAIG,UAAY,GAC5EwC,EAAQlD,YAAYkF,KAAQhI,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,WAAcwC,EAAQlD,YAAY1C,OAC3FJ,EAAOqD,IAAIC,UACf0C,EAAQlD,YAAY1C,OAAS4F,EAAQlD,YAAYkF,KAAOhC,EAAQlD,YAAYxC,MAC5EN,EAAO+C,OAAO,QAAUxB,KAAM,qBAAsByB,kBAAkB,EAAOvB,OAASmB,SAAUoD,EAAQlD,YAAaoB,IAAK8B,MAErHA,EAAQlD,YAAY1C,QAAUJ,EAAOqD,IAAIC,SAAYtD,EAAOqD,IAAIG,UAAY,IACjFwC,EAAQlD,YAAY1C,OAASJ,EAAOqD,IAAIC,UAAYtD,EAAOqD,IAAIC,SAC3DtD,EAAOqD,IAAIG,UAAYwC,EAAQlD,YAAYkF,MAC/ChC,EAAQlD,YAAYkF,KAAOhC,EAAQlD,YAAY1C,OAAS4F,EAAQlD,YAAYxC,MAC5EN,EAAO+C,OAAO,QAAUxB,KAAM,qBAAsByB,kBAAkB,EAAOvB,OAASmB,SAAUoD,EAAQlD,YAAaoB,IAAK8B,MAE1HA,EAAQlD,YAAYzC,QAAUL,EAAOqD,IAAIE,QAAWvD,EAAOqD,IAAII,WAAa,GAC5EuC,EAAQlD,YAAYmF,KAAQjI,EAAOqD,IAAIE,QAAUvD,EAAOqD,IAAII,YACvDuC,EAAQlD,YAAYzC,OAASL,EAAOqD,IAAIE,SAC7CyC,EAAQlD,YAAYzC,OAAS2F,EAAQlD,YAAYmF,KAC7CjC,EAAQlD,YAAYvC,OACxBP,EAAO+C,OAAO,QAAUxB,KAAM,qBAAsByB,kBAAkB,EAAOvB,OAASmB,SAAUoD,EAAQlD,YAAaoB,IAAK8B,MAErHA,EAAQlD,YAAYzC,QAAUJ,KAAKD,OAAOqC,YAAY9B,OAAS,IACpEyF,EAAQlD,YAAYzC,OAASL,EAAOqD,IAAIE,SAAWvD,EAAOqD,IAAIE,QAC1DvD,EAAOqD,IAAII,WAAauC,EAAQlD,YAAYmF,MAChDjC,EAAQlD,YAAYmF,KAAOjC,EAAQlD,YAAYzC,OAC3C2F,EAAQlD,YAAYvC,OACxBP,EAAO+C,OAAO,QAAUxB,KAAM,qBAAsByB,kBAAkB,EAAOvB,OAASmB,SAAUoD,EAAQlD,YAAaoB,IAAK8B,MAExG,SAAlBA,EAAQX,OAAsC,UAAlBW,EAAQX,OAAuC,SAAlBW,EAAQX,OACjEpF,KAAKgsC,iBAAiBjmC,EAAS9C,GAEnC8C,EAAQgB,UAAYhH,EAAOiD,UAAUU,cACrCqC,EAAQ+B,YAAe3H,QAAU4F,EAAQlD,YAAY1C,OAASJ,EAAOqD,IAAIC,UAAYtD,EAAOqD,IAAIG,UAC5FnD,QAAU2F,EAAQlD,YAAYzC,OAASL,EAAOqD,IAAIE,SAAWvD,EAAOqD,IAAII,WACxEuE,MAAQhC,EAAQlD,YAAYkF,KAAOhI,EAAOqD,IAAIC,UAAYtD,EAAOqD,IAAIG,UACrEyE,MAAQjC,EAAQlD,YAAYmF,KAAOjI,EAAOqD,IAAIE,SAAWvD,EAAOqD,IAAII,WACpEnD,MAAON,EAAOqD,IAAIG,UAAYwC,EAAQlD,YAAYxC,MAClDC,OAAQP,EAAOqD,IAAII,WAAauC,EAAQlD,YAAYvC,aAI5CmT,KAApBs4B,IACAhsC,EAAO6C,UAAYoB,YAAWjE,EAAOmF,QAAQ6mC,OAAsB,QAGtE,IAAe,KAAX9oC,EACLjD,KAAKunC,oBAEJ,KAAgB,KAAZtkC,EACL,IAAS+B,EAAI,EAAGA,EAAI,EAAGA,IACnBhF,KAAKunC,oBAGR,IAAwB,mBACzB,GAAItkC,EAAS,EACTjD,KAAKunC,oBAGL,KAASviC,EAAI,EAAGA,EAAI,EAAGA,IACnBhF,KAAKunC,iBAKrBhB,EAAM1lC,UAAU0mC,cAAgB,WAE5B,IAAK,GADDxnC,GAASC,KAAKD,OACTiF,EAAI,EAAGC,EAAMlF,EAAOmF,QAAQC,OAAQH,EAAIC,EAAKD,KAC9Ce,EAAUhG,EAAOmF,QAAQF,IACrBnC,YAAYzC,OAASL,EAAOqD,IAAIE,QAAWvD,EAAOqD,IAAII,WAAauC,EAAQ+B,WAAW3H,OAC9F4F,EAAQlD,YAAYmF,KAAOjI,EAAOqD,IAAIE,QAAWvD,EAAOqD,IAAII,WAAauC,EAAQ+B,WAAWC,KAC5FhC,EAAQlD,YAAY1C,OAAUJ,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,UAC1DxD,EAAOqD,IAAIG,UAAYwC,EAAQ+B,WAAWE,KAC/CjC,EAAQlD,YAAYkF,KAAQhI,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,UACxDxD,EAAOqD,IAAIG,UAAYwC,EAAQ+B,WAAW1H,OAC/C2F,EAAU/F,KAAK+T,kBAAkBhU,EAAOmF,QAAQF,IAChDhF,KAAKkoC,eAAeniC,GACE,SAAlBA,EAAQX,OAAsC,UAAlBW,EAAQX,OAClB,SAAlBW,EAAQX,OACRpF,KAAKisC,mBAAmBlmC,GACF,UAAlBA,EAAQX,OACRpF,KAAK4rC,gBAAgB7lC,IAGK,IAAzBA,EAAQ6N,eACb7N,EAAQ4zB,wBAAwBl5B,EAAIV,EAAOqD,IAAIE,QAAWvD,EAAOqD,IAAII,WAAauC,EAAQ4zB,wBAAwBhxB,OAClH5C,EAAQ4zB,wBAAwBn5B,EAAKT,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,UACjExD,EAAOqD,IAAIG,UAAYwC,EAAQ4zB,wBAAwB/wB,OAC5D7C,EAAQ4zB,wBAAwBhxB,QAAU5C,EAAQ4zB,wBAAwBn5B,EACpET,EAAOqD,IAAIC,UAAYtD,EAAOqD,IAAIG,UACxCwC,EAAQ4zB,wBAAwB/wB,QAAU7C,EAAQ4zB,wBAAwBl5B,EACpEV,EAAOqD,IAAIE,SAAWvD,EAAOqD,IAAII,WAG/C,KAAK,GAAIwB,GAAI,EAAGC,EAAMlF,EAAOmF,QAAQC,OAAQH,EAAIC,EAAKD,IAClDjF,EAAO+C,OAAO,QAAUxB,KAAM,qBAAsByB,kBAAkB,EAAOvB,OAASmB,SAAU5C,EAAOmF,QAAQF,GAAGnC,YAAaoB,IAAKlE,EAAOmF,QAAQF,KAGvJ,KAAK,GAAIA,GAAI,EAAGC,EAAMlF,EAAOmF,QAAQC,OAAQH,EAAIC,EAAKD,IAAK,CACvD,GAAIe,GAAUhG,EAAOmF,QAAQF,EAC7Be,GAAQ+B,YAAe3H,QAAU4F,EAAQlD,YAAY1C,OAASJ,EAAOqD,IAAIC,UAAYtD,EAAOqD,IAAIG,UAC5FnD,QAAU2F,EAAQlD,YAAYzC,OAASL,EAAOqD,IAAIE,SAAWvD,EAAOqD,IAAII,WACxEuE,MAAQhC,EAAQlD,YAAYkF,KAAOhI,EAAOqD,IAAIC,UAAYtD,EAAOqD,IAAIG,UACrEyE,MAAQjC,EAAQlD,YAAYmF,KAAOjI,EAAOqD,IAAIE,SAAWvD,EAAOqD,IAAII,WACpEnD,MAAON,EAAOqD,IAAIG,UAAYwC,EAAQlD,YAAYxC,MAClDC,OAAQP,EAAOqD,IAAII,WAAauC,EAAQlD,YAAYvC,UAGhEimC,EAAM1lC,UAAUorC,mBAAqB,SAAUhoC,GAC3C,IAAIhC,oBAAkBgC,EAAIgD,WAA1B,CAGA,GAAIlH,GAASC,KAAKD,MAClB,IAAIkE,EAAIgD,UAAU9B,OAAS,EAAG,CAC1B,IAASuD,EAAI,EAAGA,EAAIzE,EAAIgD,UAAU9B,OAAQuD,IACtCzE,EAAIgD,UAAUyB,GAAGjI,EAAIV,EAAOqD,IAAIE,QAAWvD,EAAOqD,IAAII,WAAaS,EAAIgD,UAAUyB,GAAGC,OACpF1E,EAAIgD,UAAUyB,GAAGlI,EAAKT,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,UAAcxD,EAAOqD,IAAIG,UAC5EU,EAAIgD,UAAUyB,GAAGE,MAEzB,KAAK,GAAIF,GAAI,EAAGA,EAAIzE,EAAIgD,UAAU9B,OAAQuD,IACtCzE,EAAIgD,UAAUyB,GAAGC,QAAU1E,EAAIgD,UAAUyB,GAAGlI,EAAIT,EAAOqD,IAAIC,UAAYtD,EAAOqD,IAAIG,UAClFU,EAAIgD,UAAUyB,GAAGE,QAAU3E,EAAIgD,UAAUyB,GAAGjI,EAAIV,EAAOqD,IAAIE,SAAWvD,EAAOqD,IAAII,UAErF,IAAI0oC,OAAY,EAEZA,GADAjqC,oBAAkBgC,EAAIgD,UAAUhD,EAAIgD,UAAU9B,OAAS,KACzC3E,EAAG,EAAGC,EAAG,IAGTD,EAAGyD,EAAIgD,UAAUhD,EAAIgD,UAAU9B,OAAS,GAAG3E,EAAGC,EAAGwD,EAAIgD,UAAUhD,EAAIgD,UAAU9B,OAAS,GAAG1E,EAE3G,IAAI6T,GAAQrQ,EAAIgD,UAAUhD,EAAIgD,UAAU9B,OAAS,GAAG3E,EAAI0rC,EAAU1rC,EAC9D+T,EAAQtQ,EAAIgD,UAAUhD,EAAIgD,UAAU9B,OAAS,GAAG1E,EAAIyrC,EAAUzrC,CAClEwD,GAAIpB,YAAY1C,OAAS8D,EAAIgD,UAAU,GAAGzG,EAC1CyD,EAAIpB,YAAYzC,OAAS6D,EAAIgD,UAAU,GAAGxG,EAC1CwD,EAAIpB,YAAYkF,KAAO9D,EAAIgD,UAAUhD,EAAIgD,UAAU9B,OAAS,GAAG3E,EAAK8T,EAAQ,EAC5ErQ,EAAIpB,YAAYmF,KAAO/D,EAAIgD,UAAUhD,EAAIgD,UAAU9B,OAAS,GAAG1E,EAAK8T,EAAQ,EAC5EtQ,EAAMjE,KAAK+T,kBAAkB9P,MAGrCsiC,EAAM1lC,UAAUmrC,iBAAmB,SAAU/nC,EAAKzC,GAC9C,IAAIS,oBAAkBgC,EAAIgD,aAGE,eAAxBzF,EAAMoR,cACN5S,KAAKmsC,wBAAwBloC,GAEA,aAAxBzC,EAAMoR,cACX5S,KAAKosC,sBAAsBnoC,IAG3BjE,KAAKmsC,wBAAwBloC,GAC7BA,EAAI8C,UAAY,GAChB/G,KAAKosC,sBAAsBnoC,IAE/BA,EAAIpB,YAAY1C,OAAS8D,EAAIgD,UAAU,GAAGzG,EAC1CyD,EAAIpB,YAAYzC,OAAS6D,EAAIgD,UAAU,GAAGxG,EAC1CwD,EAAIpB,YAAYkF,KAAO9D,EAAIgD,UAAUhD,EAAIgD,UAAU9B,OAAS,GAAG3E,EAC/DyD,EAAIpB,YAAYmF,KAAO/D,EAAIgD,UAAUhD,EAAIgD,UAAU9B,OAAS,GAAG1E,EAC3DwD,EAAIpB,YAAY1C,OAAS8D,EAAIpB,YAAYkF,MAAM,CAC/C,GAAIrD,GAAOT,EAAIpB,YAAY1C,MAC3B8D,GAAIpB,YAAY1C,OAAS8D,EAAIpB,YAAYkF,KACzC9D,EAAIpB,YAAYkF,KAAOrD,EACvBA,EAAOT,EAAIpB,YAAYzC,OACvB6D,EAAIpB,YAAYzC,OAAS6D,EAAIpB,YAAYmF,KACzC/D,EAAIpB,YAAYmF,KAAOtD,IAG/B6hC,EAAM1lC,UAAUsrC,wBAA0B,SAAUloC,GAChD,GAAIlE,GAASC,KAAKD,MAElB,IAAIkE,EAAI8C,YAAchH,EAAOiD,UAAUU,cAAe,CAClD,IAAK,GAAIoF,GAAI,EAAG7D,EAAMhB,EAAIgD,UAAU9B,OAAQ2D,EAAI7D,EAAK6D,IAAK,CACtD,GAAIujC,GAAYpoC,EAAIgD,UAAU6B,EAC1BujC,GAAU7rC,GAAKT,EAAOqD,IAAIC,SAAYtD,EAAOqD,IAAIG,UAAY,EAC7D8oC,EAAU7rC,EAAKT,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,WAAc8oC,EAAU7rC,EAClET,EAAOqD,IAAIC,UAEZgpC,EAAU7rC,GAAKT,EAAOqD,IAAIC,SAAYtD,EAAOqD,IAAIG,UAAY,IAClE8oC,EAAU7rC,EAAIT,EAAOqD,IAAIC,UAAYtD,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,UAClE8oC,EAAU7rC,IAElB6rC,EAAU1jC,QAAU0jC,EAAU7rC,EAAIT,EAAOqD,IAAIC,UAAYtD,EAAOqD,IAAIG,UACpE8oC,EAAUzjC,QAAUyjC,EAAU5rC,EAAIV,EAAOqD,IAAIE,SAAWvD,EAAOqD,IAAII,WAEvE,GAAkB,UAAdS,EAAImB,MAAmB,CACvB,GAAI5D,GAAQyC,EAAIsS,KAChBtS,GAAIsS,MAAQtS,EAAIuS,IAChBvS,EAAIuS,IAAMhV,EAEdyC,EAAI8C,UAAYhH,EAAOiD,UAAUU,gBAGzC6iC,EAAM1lC,UAAUurC,sBAAwB,SAAUnoC,GAC9C,GAAIlE,GAASC,KAAKD,MAElB,IAAIkE,EAAI8C,YAAchH,EAAOiD,UAAUU,cAAe,CAClD,IAAK,GAAIoF,GAAI,EAAG7D,EAAMhB,EAAIgD,UAAU9B,OAAQ2D,EAAI7D,EAAK6D,IAAK,CACtD,GAAIujC,GAAYpoC,EAAIgD,UAAU6B,EAC1BujC,GAAU5rC,GAAKV,EAAOqD,IAAIE,QAAWvD,EAAOqD,IAAII,WAAa,EAC7D6oC,EAAU5rC,EAAKV,EAAOqD,IAAIE,QAAUvD,EAAOqD,IAAII,YAC1C6oC,EAAU5rC,EAAIV,EAAOqD,IAAIE,SAEzB+oC,EAAU5rC,GAAKV,EAAOqD,IAAIE,QAAWvD,EAAOqD,IAAII,WAAa,IAClE6oC,EAAU5rC,EAAIV,EAAOqD,IAAIE,SAAWvD,EAAOqD,IAAIE,QAAUvD,EAAOqD,IAAII,WAChE6oC,EAAU5rC,IAElB4rC,EAAU1jC,QAAU0jC,EAAU7rC,EAAIT,EAAOqD,IAAIC,UAAYtD,EAAOqD,IAAIG,UACpE8oC,EAAUzjC,QAAUyjC,EAAU5rC,EAAIV,EAAOqD,IAAIE,SAAWvD,EAAOqD,IAAII,WAEvES,EAAI8C,UAAYhH,EAAOiD,UAAUU,gBAGzC6iC,EAAM1lC,UAAUyrC,iBAAmB,SAAUroC,GACzC,GAAIhB,EAUJ,QARIA,EADoB,IAApBgB,EAAIiE,YACKlI,KAAKD,OAAOiD,UAAUC,OAGtBjD,KAAKD,OAAOiD,UAAUC,OAASgB,EAAIiE,aAEnC,IACTjF,EAAS,IAAMA,GAEZA,GAEXsjC,EAAM1lC,UAAU8mC,eAAiB,SAAUnnC,EAAGC,EAAG6I,GAC7C,GAAIvJ,GAASC,KAAKD,OACdkD,EAASjD,KAAKssC,iBAAiBvsC,EAAO6C,UAC1C5C,MAAKusC,oBACArgC,aAIDnM,EAAO+N,cAAc/N,EAAOgO,QAAS,6BAHrChO,EAAO+C,OAAO,WAAaxB,KAAM,qBAAsByB,kBAAkB,IAKzEhD,EAAOgO,QAAQoO,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,eACvDjd,EAAOgO,QAAQoO,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,cAAcC,UAAUa,IAAI,cAEnF/d,EAAOgO,QAAQoO,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,YACvDjd,EAAOgO,QAAQoO,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,WAAWC,UAAUa,IAAI,cAEhF/d,EAAOgO,QAAQoO,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,cACvDjd,EAAOgO,QAAQoO,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,aAAaC,UAAUa,IAAI,cAEtF/d,EAAO+c,SAASjB,MAAMG,QAAU,QAChCjc,EAAO+c,SAASjB,MAAMZ,KAAOza,EAAI,KACjCT,EAAO+c,SAASjB,MAAM6K,IAAMjmB,EAAI,KAChCV,EAAO+c,SAASjB,MAAMzM,WAAa9F,EAAOjB,aAAa+G,WACvDrP,EAAO+c,SAASjB,MAAMtT,SAAWe,EAAOjB,aAAaE,SAAW,KAChExI,EAAO+c,SAASjB,MAAMsX,MAAQ7pB,EAAOyJ,eAAehE,YACpDhP,EAAO+c,SAASjB,MAAMipB,WAAax7B,EAAOjB,aAAagH,KAAO,OAAS,SACvEtP,EAAO+c,SAASjB,MAAMkpB,UAAYz7B,EAAOjB,aAAaiH,OAAS,SAAW,SAC1EvP,EAAO+c,SAASjB,MAAM2wB,OAAS,aAAezsC,EAAO4V,UAAU5V,EAAO6V,OAAqB,aAC3F7V,EAAO+c,SAAStb,MAAQ8H,EAAO6J,WAC/BpT,EAAO+c,SAASjB,MAAM4wB,SAAW,SACjC1sC,EAAO+c,SAASjB,MAAMxb,MAAQ,OAC9BN,EAAO+c,SAASjB,MAAMvb,OAAS,OAC/BP,EAAO+c,SAAS4vB,OACC3sC,GAAOiD,UAAUa,UAAlC,IACIg3B,GAAKvxB,EAAOzG,YAAaxC,EAAQw6B,EAAGx6B,MAAOC,EAASu6B,EAAGv6B,MACvD2C,GAAS,IAAO,GAAKA,EAAS,KAAQ,GAAgB,IAAXA,GAC3ClD,EAAO+c,SAASjB,MAAMxb,MAA4BC,EAAmB,KACrEP,EAAO+c,SAASjB,MAAMvb,OAA6BD,EAAiB,OAGpEN,EAAO+c,SAASjB,MAAMxb,MAA4BA,EAAiB,KACnEN,EAAO+c,SAASjB,MAAMvb,OAA6BA,EAAmB,MAE1EN,KAAK4nC,iBACL,IAAI3jC,IAAQuD,SAAU,KACtBzH,GAAO+C,OAAO,aAAexB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAASyC,IAAKA,KACrFA,EAAc,SAAEkB,QAAU,GAC1BnF,KAAK2sC,mBAEL1pC,EAAS,IAAO,GAAKA,EAAS,KAAQ,EAClC0kB,WAAW5nB,EAAO+c,SAASjB,MAAMZ,MAAQ0M,WAAW5nB,EAAO+c,SAASjB,MAAMxb,OAASN,EAAOqD,IAAIE,QAC9FvD,EAAOqD,IAAII,YACXxD,KAAKmpC,0BAILxhB,WAAW5nB,EAAO+c,SAASjB,MAAMZ,MAAQ0M,WAAW5nB,EAAO+c,SAASjB,MAAMxb,OAASN,EAAOqD,IAAIC,SAC9FtD,EAAOqD,IAAIG,WACXvD,KAAKmpC,0BAGbppC,EAAO+C,OAAO,aAAexB,KAAM,mBAAoByB,kBAAkB,KAE7EwjC,EAAM1lC,UAAU+mC,gBAAkB,SAAUvY,GACxC,GAAItvB,GAASC,KAAKD,OACdoP,EAAOnP,KAAK8oC,YAAW,EACW,WAAlC/oC,EAAO+c,SAASjB,MAAMG,QACtBhc,KAAK+nC,kBAAiB,GAGtB/nC,KAAK+nC,kBAET,IAAI6E,GAAiB5sC,KAAKwC,aAAayoC,YAAY97B,GAAM9O,MAASsnB,WAAW5nB,EAAO+c,SAASjB,MAAMtT,UAAY,EAC3GskC,EAAcxd,EAAIrvB,KAAKwC,aAAayoC,YAAY5H,OAAOC,aAAajU,EAAEkU,QAAQljC,MAAQ,EACtFiJ,EAAStF,YAAWjE,EAAO6C,cAAe,GAC1C+lB,EAAO,GACP1lB,EAASjD,KAAKssC,iBAAiBhjC,EAOnC,IALIqf,EADArf,EAAOvC,YAAchH,EAAOiD,UAAUU,cAC/B,GAGA3D,EAAOiD,UAAUU,cAEvB2rB,GAAK1H,WAAW5nB,EAAO+c,SAASjB,MAAMxb,OAAUusC,EAAgBC,GAAiB5qC,oBAAkBotB,GACpG,GAAe,IAAXpsB,EAC2B,eAAvB0lB,EAAK/V,cACA+U,WAAW5nB,EAAO+c,SAASjB,MAAMZ,MAAQlb,EAAOqD,IAAIC,SAAYupC,EAAgBC,EAAc,IAC/F9sC,EAAO+c,SAASjB,MAAMxb,MAASusC,EAAgBC,EAAe,MAG5D9sC,EAAOqD,IAAIG,WAAaokB,WAAW5nB,EAAO+c,SAASjB,MAAMZ,MAC/Dlb,EAAOqD,IAAIC,UAAcupC,EAAgBC,IACzC9sC,EAAO+c,SAASjB,MAAMxb,MAASusC,EAAgBC,EAAe,UAGjE,IAAe,KAAX5pC,EACsB,aAAvB0lB,EAAK/V,cACA+U,WAAW5nB,EAAO+c,SAASjB,MAAM6K,KAAO3mB,EAAOqD,IAAIE,QAAWspC,EAAgBC,EAAc,IAC7F9sC,EAAO+c,SAASjB,MAAMxb,MAASusC,EAAgBC,EAAe,MAG5D9sC,EAAOqD,IAAII,YAAcmkB,WAAW5nB,EAAO+c,SAASjB,MAAM6K,KAChE3mB,EAAOqD,IAAIE,SAAaspC,EAAgBC,IACxC9sC,EAAO+c,SAASjB,MAAMxb,MAASusC,EAAgBC,EAAe,UAGjE,IAAe,MAAX5pC,EAAgB,CACrB,GAAI6pC,GAAenlB,WAAW5nB,EAAO+c,SAASjB,MAAMZ,MAChD5X,EAAWtD,EAAOqD,IAAIC,QACC,gBAAvBslB,EAAK/V,cACgB7S,EAAOqD,IAAIG,WAAaupC,EAAezpC,GACvCupC,EAAgBC,IACjC9sC,EAAO+c,SAASjB,MAAMxb,MAASusC,EAAgBC,EAAe,MAI7CC,EAAezpC,EACfupC,EAAgBC,EAAc,IAC/C9sC,EAAO+c,SAASjB,MAAMxb,MAASusC,EAAgBC,EAAe,UAIrE,IAAe,MAAX5pC,EAAgB,CACrB,GAAI8pC,GAAcplB,WAAW5nB,EAAO+c,SAASjB,MAAM6K,KAC/CpjB,EAAUvD,EAAOqD,IAAIE,OACE,cAAvBqlB,EAAK/V,cACiB7S,EAAOqD,IAAII,YAAcupC,EAAczpC,GACvCspC,EAAgBC,IAClC9sC,EAAO+c,SAASjB,MAAMxb,MAASusC,EAAgBC,EAAe,MAI9CE,EAAczpC,EACdspC,EAAgBC,EAAc,IAC9C9sC,EAAO+c,SAASjB,MAAMxb,MAASusC,EAAgBC,EAAe,QAMlFtG,EAAM1lC,UAAU8rC,iBAAmB,WAC/B,GACII,GADAhtC,EAASC,KAAKD,OAEduJ,EAAStF,YAAWjE,EAAO6C,cAAe,GAC1C+lB,EAAO,GACP1lB,EAASjD,KAAKssC,iBAAiBhjC,EAUnC,QARIqf,EADArf,EAAOwhC,WAAa/qC,EAAOiD,UAAUU,cAC9B,GAEkB,KAApB4F,EAAOwhC,SACL/qC,EAAOiD,UAAUU,cAGjB4F,EAAOwhC,SAEV7nC,GACJ,IAAK,GAC0B,aAAvB0lB,EAAK/V,cACL7S,EAAO+c,SAASjB,MAAM+K,UAAa7mB,EAAOqD,IAAII,YAAczD,EAAOqD,IAAII,WACnEmkB,WAAW5nB,EAAO+c,SAASjB,MAAM6K,MAAS,MAG9CqmB,EAAcplB,WAAW5nB,EAAO+c,SAASjB,MAAM6K,KAAO3mB,EAAOqD,IAAIE,QACjEvD,EAAO+c,SAASjB,MAAM+K,UAAa7mB,EAAOqD,IAAII,WAAaupC,EAAe,KAE9E,MACJ,KAAK,IAC0B,eAAvBpkB,EAAK/V,cACL7S,EAAO+c,SAASjB,MAAM+K,UAAa7mB,EAAOqD,IAAIG,WAAaokB,WAAW5nB,EAAO+c,SAASjB,MAAMZ,MACxFlb,EAAOqD,IAAIC,UAAa,KAG5BtD,EAAO+c,SAASjB,MAAM+K,UAAae,WAAW5nB,EAAO+c,SAASjB,MAAMZ,MAAQlb,EAAOqD,IAAIC,SAAY,IAEvG,MACJ,KAAK,KAC0B,aAAvBslB,EAAK/V,eACLm6B,EAAcplB,WAAW5nB,EAAO+c,SAASjB,MAAM6K,KAAO3mB,EAAOqD,IAAIE,QACjEvD,EAAO+c,SAASjB,MAAM+K,UAAa7mB,EAAOqD,IAAII,WAAaupC,EAAe,MAG1EhtC,EAAO+c,SAASjB,MAAM+K,UAAae,WAAW5nB,EAAO+c,SAASjB,MAAM6K,KAAO3mB,EAAOqD,IAAIE,QAAW,IAErG,MACJ,KAAK,KAC0B,eAAvBqlB,EAAK/V,cACL7S,EAAO+c,SAASjB,MAAM+K,UAAae,WAAW5nB,EAAO+c,SAASjB,MAAMZ,MAAQlb,EAAOqD,IAAIC,SAAY,KAGnGtD,EAAO+c,SAASjB,MAAM+K,UAAY7mB,EAAOqD,IAAIG,WAAaokB,WAAW5nB,EAAO+c,SAASjB,MAAMZ,MACrFlb,EAAOqD,IAAIC,UAAY,OAK7CkjC,EAAM1lC,UAAU4qC,gBAAkB,SAAUxnC,GAExC,IAAK,GADDlE,GAASC,KAAKD,OACTiF,EAAI,EAAGC,EAAMhB,EAAIgD,UAAU9B,OAAQH,EAAIC,EAAKD,IAAK,CACtD,GAAIqnC,GAAYpoC,EAAIgD,UAAUjC,EAC9BqnC,GAAU1jC,QAAU0jC,EAAU7rC,EAAIT,EAAOqD,IAAIC,UAAYtD,EAAOqD,IAAIG,UACpE8oC,EAAUzjC,QAAUyjC,EAAU5rC,EAAIV,EAAOqD,IAAIE,SAAWvD,EAAOqD,IAAII,aAG3E+iC,EAAM1lC,UAAUwoC,gBAAkB,SAAUha,GACxC,GAAItvB,GAASC,KAAKD,MAClB,IAA+B,SAA3BA,EAAO6C,UAAUwC,MAAkB,CACnC,GAAInB,IAAQmB,MAAO,KAEnB,IADArF,EAAO+C,OAAO,aAAexB,KAAM,yBAA0BE,OAASyC,IAAKA,KACtD,SAAjBA,EAAW,MAAc,CACzB,GAAI6I,GAAc9I,YAAWhE,KAAKD,OAAOiG,YAAa,GAClDF,GAAWC,WACf/F,MAAKD,OAAO+C,OAAO,UAAYxB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAASsE,OAAQA,IAChG,IAAIiH,GAAUjH,EAAgB,OAC9BiH,GAAQ7H,QAAUlB,YAAWhE,KAAKD,OAAOmF,YAAa,GACtD6H,EAAQ9F,UAAYjD,YAAWhE,KAAKD,OAAOkH,cAAe,GAC1D8F,EAAQlH,iBAAmB7B,YAAWhE,KAAKD,OAAO8F,qBAAsB,EACxE,IAAIuZ,IAAoBhW,aAAc,KACtCpJ,MAAKD,OAAO+C,OAAO,iBAAmBxB,KAAM,kBAAmByB,kBAAkB,EAC7EvB,OAASyC,IAAKmb,KAClBrS,EAAQ3D,aAAepF,YAAWob,EAA8B,iBAAO,GACvErf,EAAO+C,OAAO,aAAexB,KAAM,yBAA0BE,OAASA,MAAO,MAC7EzB,EAAO0F,YAAYwZ,YAAa,EACjB,eAAXoQ,EAAE1oB,MACF5G,EAAO6C,UAAUqE,UAAUP,MAE/B1G,KAAKyrC,gBAAgB1rC,EAAO6C,WAC5B7C,EAAOmF,QAAQe,KAAKlG,EAAO6C,WAC3B7C,EAAO+C,OAAO,aAAexB,KAAM,qBAAsByB,kBAAkB,EACvEvB,OAAS6L,UAAW,iBAAkBC,YAAaP,EAASQ,gBAAiBR,EAAQ7H,QACjFsI,kBAAmBT,EAAQ9F,UAAWwG,qBAAsBV,EAAQ3D,aACpEsE,gBAAiBZ,EAAaa,aAAc,KAC5CC,YAAa,KAAMC,eAAgB,KAAMrI,aAAc,QAC/DzF,EAAOmF,QAAQwB,MACf3G,EAAO+C,OAAO,aAAexB,KAAM,sBAAuBE,OAAS6tB,EAAGA,KACtEtvB,EAAO+C,OAAO,QAAUxB,KAAM,aAAcE,OAAS4E,MAAM,KACvDrG,EAAOmF,QAAQnF,EAAOmF,QAAQC,OAAS,IACvCpF,EAAO6oC,YAAY7oC,EAAOmF,QAAQnF,EAAOmF,QAAQC,OAAS,GAAG0Z,WAE5D3S,aAIDnM,EAAO+N,cAAc/N,EAAOgO,QAAS,qBAAsBhO,EAAO6C,UAAUwC,OAH5ErF,EAAO+C,OAAO,WAAaxB,KAAM,YAAayB,kBAAkB,EAAOvB,OAASw+B,UAAW,WAQ3GuG,EAAM1lC,UAAUgnC,eAAiB,SAAUxY,GACvC,GAAItvB,GAASC,KAAKD,MAClB,IAA+B,SAA3BA,EAAO6C,UAAUwC,MAEjB,WADApF,MAAKqpC,gBAAgBha,EAGzB,IAAI7uB,GACAC,CAgBJ,IAfe,aAAX4uB,EAAE1oB,MACFnG,EAAI6uB,EAAEG,QACN/uB,EAAI4uB,EAAEI,SAEU,eAAXJ,EAAE1oB,OACPnG,EAAI6uB,EAAEK,QAAQ,GAAGF,QACjB/uB,EAAI4uB,EAAEK,QAAQ,GAAGD,QACjB1vB,EAAO+C,OAAO,aAAexB,KAAM,mBAAoByB,kBAAkB,EACrEvB,OAAShB,EAAG6uB,EAAEK,QAAQ,GAAGF,QAAS/uB,EAAG4uB,EAAEK,QAAQ,GAAGD,YAE1D1vB,EAAO+C,OAAO,WAAaxB,KAAM,oBAAqByB,kBAAkB,EAAOvB,OAAS6d,WAAW,KACnGtf,EAAO+C,OAAO,WAAaxB,KAAM,kBAAmByB,kBAAkB,EAAOvB,OAASmF,KAAM,OACpF8C,WAAY,KAAMC,WAAY,KAAMC,UAAW,KAAMC,MAAO,QACpE7J,EAAO+C,OAAO,WAAaxB,KAAM,oBAAqByB,kBAAkB,EAAOvB,OAAS6d,WAAW,KACnGtf,EAAO+C,OAAO,WAAaxB,KAAM,uBAAwByB,kBAAkB,IACtEd,oBAAkBzB,IAAOyB,oBAAkBxB,GA8E3C,GAAsC,UAAlCV,EAAO+c,SAASjB,MAAMG,SAA+C,KAAxBhc,KAAKgtC,gBAAoC,cAAX3d,EAAE1oB,KAAsB,CACpGjC,EAAO3E,EAAO+c,SAAStb,KAC3BzB,GAAO+c,SAAStb,OAAS,IACzBzB,EAAO+c,SAAStb,MAAQkD,MAEe,SAAlC3E,EAAO+c,SAASjB,MAAMG,UAC3Bjc,EAAO+c,SAASjB,MAAMG,QAAU,aApFgB,CAChD,GAAImkB,GAAOngC,KAAKD,OAAOqC,YAAYytB,uBACnCrvB,IAAK2/B,EAAKllB,KACVxa,GAAK0/B,EAAKzZ,GACV,IAAIiC,GAAO,GACP1lB,EAASjD,KAAKssC,iBAAiBvsC,EAAO6C,UAGlC+lB,GAF0B,KAA9B5oB,EAAO6C,UAAUkoC,SACb/qC,EAAO6C,UAAUkoC,WAAa/qC,EAAOiD,UAAUU,cACxC,GAGA3D,EAAOiD,UAAUU,cAIxB3D,EAAO6C,UAAUkoC,WAAa/qC,EAAOiD,UAAUU,cACxC,GAEiC,KAAnC3D,EAAOiD,UAAUU,cACf3D,EAAO6C,UAAUkoC,SAGjB/qC,EAAOiD,UAAUU,aAGhC,IAAIgB,OAAO,EACX,IAAsC,SAAlC3E,EAAO+c,SAASjB,MAAMG,QAAoB,CAC1CtX,EAAOV,YAAWjE,EAAO6C,cAAe,EACxC,KAAK,GAAIoC,GAAI,EAAGA,EAAIjF,EAAOmF,QAAQC,OAAQH,IACnC08B,KAAKC,UAAU5hC,EAAO6C,aAAe8+B,KAAKC,UAAU5hC,EAAOmF,QAAQF,KACnEjF,EAAOmF,QAAQi9B,OAAOn9B,EAAG,EAGjChF,MAAKsoC,mBACLtoC,KAAKwC,aAAa2B,UAAU,EAAG,EAAGnE,KAAKD,OAAOwC,YAAYlC,MAAOL,KAAKD,OAAOwC,YAAYjC,QACzFN,KAAKqC,aAAa8B,UAAU,EAAG,EAAGnE,KAAKD,OAAOwC,YAAYlC,MAAOL,KAAKD,OAAOwC,YAAYjC,QACzFP,EAAO+C,OAAO,QAAUxB,KAAM,mBAAoByB,kBAAkB,KAC/DhD,EAAOgE,oBAA0D,gBAApChE,EAAOgE,mBAAmBqB,OAA4BrF,EAAOyF,eAC3FzF,EAAO+C,OAAO,QAAUxB,KAAM,aAAcyB,kBAAkB,EAC1DvB,OAAS+D,QAASvF,KAAKqC,aAAc+H,OAAQ,KAAMC,OAAQ,QAEnEtK,EAAO6C,UAAY8B,EACnB1E,KAAK+nC,kBACL,IAAIz+B,GAAStF,YAAWjE,EAAO6C,cAAe,EAC9C,IAAIpC,GAAM8I,EAAOzG,YAAY1C,OAAwC,EAA9BmJ,EAAOwL,cAAcpK,QACxDlK,GAAM8I,EAAOzG,YAAYkF,KAAsC,EAA9BuB,EAAOwL,cAAcpK,QACtDjK,GAAM6I,EAAOzG,YAAYzC,OAAwC,EAA9BkJ,EAAOwL,cAAcpK,QACxDjK,GAAM6I,EAAOzG,YAAYmF,KAAsC,EAA9BsB,EAAOwL,cAAcpK,OAAc,CAUpE,GATA1K,KAAKwC,aAAa2B,UAAU,EAAG,EAAGnE,KAAKD,OAAOwC,YAAYlC,MAAOL,KAAKD,OAAOwC,YAAYjC,QACvD,IAA9BgJ,EAAOyO,YAAY5S,SACnBmE,EAAOyO,eACP4Q,EAAO,GACPrf,EAAOvC,UAAY,IAEV,KAAT4hB,GAAerf,EAAOyO,YAAY5S,OAAS,IAC3CwjB,EAAOrf,EAAOyO,YAAYzO,EAAOyO,YAAY5S,OAAS,IAEtDmE,EAAOyO,YAAY5S,QAAU,EAE7B3E,GADIqI,EAAS7I,KAAKipC,cAAc3/B,EAAQrG,EAAQ0lB,EAAMnoB,EAAGC,IAC9CD,EACXC,EAAIoI,EAAOpI,MAEV,CACD,GAAIoI,GAAS7I,KAAKkpC,iBAAiB5/B,EAAQrG,EAAQ0lB,EAAMnoB,EAAGC,EAC5DD,GAAIqI,EAAOrI,EACXC,EAAIoI,EAAOpI,EAEuB,IAAlCV,EAAO6C,UAAUgR,eACjBpT,EAAIT,EAAO6C,UAAU22B,oBAAoB,GAAG/4B,EAC5CC,EAAIV,EAAO6C,UAAU22B,oBAAoB,GAAG94B,GAEhDT,KAAK2nC,eAAennC,EAAGC,EAAG6I,OAG1BtJ,MAAKuoC,iBAarBhC,EAAM1lC,UAAUooC,cAAgB,SAAU3/B,EAAQrG,EAAQ0lB,EAAMnoB,EAAGC,GAC/D,GAAI0C,IAAU3C,EAAGA,EAAGC,EAAGA,EACvB,QAAQwC,GACJ,IAAK,GAC0B,eAAvB0lB,EAAK/V,eACLzP,EAAM3C,EAAI8I,EAAOzG,YAAYkF,KAC7B5E,EAAM1C,EAAI6I,EAAOzG,YAAYzC,QAED,aAAvBuoB,EAAK/V,eACVzP,EAAM3C,EAAI8I,EAAOzG,YAAY1C,OAC7BgD,EAAM1C,EAAI6I,EAAOzG,YAAYmF,OAG7B7E,EAAM3C,EAAI8I,EAAOzG,YAAY1C,OAC7BgD,EAAM1C,EAAI6I,EAAOzG,YAAYzC,OAEjC,MACJ,KAAK,IAC0B,eAAvBuoB,EAAK/V,eACLzP,EAAM3C,EAAI8I,EAAOzG,YAAY1C,OAC7BgD,EAAM1C,EAAI6I,EAAOzG,YAAYzC,QAED,aAAvBuoB,EAAK/V,eACVzP,EAAM3C,EAAI8I,EAAOzG,YAAYkF,KAC7B5E,EAAM1C,EAAI6I,EAAOzG,YAAYmF,OAG7B7E,EAAM3C,EAAI8I,EAAOzG,YAAYkF,KAC7B5E,EAAM1C,EAAI6I,EAAOzG,YAAYzC,OAEjC,MACJ,KAAK,KAC0B,eAAvBuoB,EAAK/V,eACLzP,EAAM3C,EAAI8I,EAAOzG,YAAY1C,OAC7BgD,EAAM1C,EAAI6I,EAAOzG,YAAYmF,MAED,aAAvB2gB,EAAK/V,eACVzP,EAAM3C,EAAI8I,EAAOzG,YAAYkF,KAC7B5E,EAAM1C,EAAI6I,EAAOzG,YAAYzC,SAG7B+C,EAAM3C,EAAI8I,EAAOzG,YAAYkF,KAC7B5E,EAAM1C,EAAI6I,EAAOzG,YAAYmF,KAEjC,MACJ,KAAK,KAC0B,eAAvB2gB,EAAK/V,eACLzP,EAAM3C,EAAI8I,EAAOzG,YAAYkF,KAC7B5E,EAAM1C,EAAI6I,EAAOzG,YAAYmF,MAED,aAAvB2gB,EAAK/V,eACVzP,EAAM3C,EAAI8I,EAAOzG,YAAY1C,OAC7BgD,EAAM1C,EAAI6I,EAAOzG,YAAYzC,SAG7B+C,EAAM3C,EAAI8I,EAAOzG,YAAY1C,OAC7BgD,EAAM1C,EAAI6I,EAAOzG,YAAYmF,MAIzC,MAAO7E,IAEXojC,EAAM1lC,UAAUqoC,iBAAmB,SAAU5/B,EAAQrG,EAAQ0lB,EAAMnoB,EAAGC,GAClE,GAAI0C,IAAU3C,EAAGA,EAAGC,EAAGA,EACvB,QAAQwC,GACJ,IAAK,GACGqG,EAAOyO,YAAY,IAA8C,eAAxCzO,EAAOyO,YAAY,GAAGnF,cACpB,eAAvB+V,EAAK/V,eACLzP,EAAM3C,EAAK8I,EAAOzG,YAAmB,OACrCM,EAAM1C,EAAK6I,EAAOzG,YAAmB,QAET,aAAvB8lB,EAAK/V,gBACVzP,EAAM3C,EAAK8I,EAAOzG,YAAiB,KACnCM,EAAM1C,EAAK6I,EAAOzG,YAAiB,MAIZ,eAAvB8lB,EAAK/V,eACLzP,EAAM3C,EAAK8I,EAAOzG,YAAiB,KACnCM,EAAM1C,EAAK6I,EAAOzG,YAAiB,MAEP,aAAvB8lB,EAAK/V,gBACVzP,EAAM3C,EAAK8I,EAAOzG,YAAiB,KACnCM,EAAM1C,EAAK6I,EAAOzG,YAAmB,OAG7C,MACJ,KAAK,IACGyG,EAAOyO,YAAY,IAA8C,eAAxCzO,EAAOyO,YAAY,GAAGnF,cACpB,eAAvB+V,EAAK/V,eACLzP,EAAM3C,EAAK8I,EAAOzG,YAAiB,KACnCM,EAAM1C,EAAK6I,EAAOzG,YAAiB,MAEP,aAAvB8lB,EAAK/V,gBACVzP,EAAM3C,EAAK8I,EAAOzG,YAAmB,OACrCM,EAAM1C,EAAK6I,EAAOzG,YAAiB,MAIZ,eAAvB8lB,EAAK/V,eACLzP,EAAM3C,EAAK8I,EAAOzG,YAAmB,OACrCM,EAAM1C,EAAK6I,EAAOzG,YAAiB,MAEP,aAAvB8lB,EAAK/V,gBACVzP,EAAM3C,EAAK8I,EAAOzG,YAAmB,OACrCM,EAAM1C,EAAK6I,EAAOzG,YAAmB,OAG7C,MACJ,KAAK,KACGyG,EAAOyO,YAAY,IAA8C,eAAxCzO,EAAOyO,YAAY,GAAGnF,cACpB,eAAvB+V,EAAK/V,eACLzP,EAAM3C,EAAK8I,EAAOzG,YAAmB,OACrCM,EAAM1C,EAAK6I,EAAOzG,YAAmB,QAET,aAAvB8lB,EAAK/V,gBACVzP,EAAM3C,EAAK8I,EAAOzG,YAAmB,OACrCM,EAAM1C,EAAK6I,EAAOzG,YAAmB,QAId,eAAvB8lB,EAAK/V,eACLzP,EAAM3C,EAAK8I,EAAOzG,YAAmB,OACrCM,EAAM1C,EAAK6I,EAAOzG,YAAmB,QAET,aAAvB8lB,EAAK/V,gBACVzP,EAAM3C,EAAK8I,EAAOzG,YAAmB,OACrCM,EAAM1C,EAAK6I,EAAOzG,YAAiB,KAG3C,MACJ,KAAK,KACGyG,EAAOyO,YAAY,IAA8C,eAAxCzO,EAAOyO,YAAY,GAAGnF,cACpB,eAAvB+V,EAAK/V,eACLzP,EAAM3C,EAAK8I,EAAOzG,YAAmB,OACrCM,EAAM1C,EAAK6I,EAAOzG,YAAmB,QAET,aAAvB8lB,EAAK/V,gBACVzP,EAAM3C,EAAK8I,EAAOzG,YAAiB,KACnCM,EAAM1C,EAAK6I,EAAOzG,YAAmB,QAId,eAAvB8lB,EAAK/V,eACLzP,EAAM3C,EAAK8I,EAAOzG,YAAiB,KACnCM,EAAM1C,EAAK6I,EAAOzG,YAAmB,QAET,aAAvB8lB,EAAK/V,gBACVzP,EAAM3C,EAAK8I,EAAOzG,YAAiB,KACnCM,EAAM1C,EAAK6I,EAAOzG,YAAiB,MAKnD,MAAOM,IAEXojC,EAAM1lC,UAAUmsC,aAAe,WAC3B,GAAIz2B,GAAQvW,KAAKD,OAAO+c,SAASmwB,eAC7BC,EAASltC,KAAKD,OAAO+c,SAASqwB,YAClC,OAAOntC,MAAKD,OAAO+c,SAAStb,MAAM4rC,UAAU72B,EAAO22B,IAEvD3G,EAAM1lC,UAAUinC,WAAa,SAAU59B,EAAOC,EAAOmB,GAEjD,IAAK,GADDvL,GAASC,KAAKD,OACTiF,EAAI,EAAGC,EAAMlF,EAAOmF,QAAQC,OAAQH,EAAIC,EAAKD,IAAK,CACvD,GAAIe,GAAUhG,EAAOmF,QAAQF,EAC7B,IAAkB,KAAdsG,GAAkC,aAAdA,GAMpB,GALAvF,EAAQlD,YAAY1C,QAAU+J,EAC9BnE,EAAQlD,YAAYkF,MAAQmC,EACxBnE,EAAQ4zB,0BACR5zB,EAAQ4zB,wBAAwBn5B,GAAK0J,GAEnB,SAAlBnE,EAAQX,MACR,IAAK,GAAI0D,GAAI,EAAGukC,EAAQtnC,EAAQkB,UAAU9B,OAAQ2D,EAAIukC,EAAOvkC,IACzD/C,EAAQkB,UAAU6B,GAAGtI,GAAK0J,MAUlC,IALAnE,EAAQlD,YAAY1C,QAAU+J,EAC9BnE,EAAQlD,YAAYkF,MAAQmC,EACxBnE,EAAQ4zB,0BACR5zB,EAAQ4zB,wBAAwBn5B,GAAK0J,GAEnB,SAAlBnE,EAAQX,MACR,IAAK,GAAI0D,GAAI,EAAGwkC,EAAQvnC,EAAQkB,UAAU9B,OAAQ2D,EAAIwkC,EAAOxkC,IACzD/C,EAAQkB,UAAU6B,GAAGtI,GAAK0J,CAItC,IAAkB,KAAdoB,GAAkC,eAAdA,GAMpB,GALAvF,EAAQlD,YAAYzC,QAAU+J,EAC9BpE,EAAQlD,YAAYmF,MAAQmC,EACxBpE,EAAQ4zB,0BACR5zB,EAAQ4zB,wBAAwBl5B,GAAK0J,GAEnB,SAAlBpE,EAAQX,MACR,IAAS0D,EAAI,EAAGA,EAAI/C,EAAQkB,UAAU9B,OAAQ2D,IAC1C/C,EAAQkB,UAAU6B,GAAGrI,GAAK0J,MAUlC,IALApE,EAAQlD,YAAYzC,QAAU+J,EAC9BpE,EAAQlD,YAAYmF,MAAQmC,EACxBpE,EAAQ4zB,0BACR5zB,EAAQ4zB,wBAAwBl5B,GAAK0J,GAEnB,SAAlBpE,EAAQX,MACR,IAAS0D,EAAI,EAAGA,EAAI/C,EAAQkB,UAAU9B,OAAQ2D,IAC1C/C,EAAQkB,UAAU6B,GAAGrI,GAAK0J,CAOtC,IAHApE,EAAU/F,KAAK+T,kBAAkBhO,GACjChG,EAAO+C,OAAO,QAAUxB,KAAM,qBAAsByB,kBAAkB,EAAOvB,OAASmB,SAAUoD,EAAQlD,YAChGoB,IAAK8B,KACS,SAAlBA,EAAQX,OAAsC,UAAlBW,EAAQX,MAAmB,CACvDW,EAAQkB,UAAYjH,KAAK+oC,cAAchjC,EAAQlD,YAAY1C,OAAQ4F,EAAQlD,YAAYzC,OAAQ2F,EAAQlD,YAAYkF,KAAMhC,EAAQlD,YAAYmF,KAC7I,KAAK,GAAI0S,GAAI,EAAG6yB,EAAQxnC,EAAQkB,UAAU9B,OAAQuV,EAAI6yB,EAAO7yB,IACzD3U,EAAQkB,UAAUyT,GAAG/R,QAChB5C,EAAQkB,UAAUyT,GAAGla,EAAIT,EAAOqD,IAAIC,UAAYtD,EAAOqD,IAAIG,UAChEwC,EAAQkB,UAAUyT,GAAG9R,QAChB7C,EAAQkB,UAAUyT,GAAGja,EAAIV,EAAOqD,IAAIE,SAAWvD,EAAOqD,IAAII,WAGvE,GAAIkB,GAAO1E,KAAKqC,aAAasC,MAC7B3E,MAAKqC,aAAasC,OAAS,OAC3B3E,KAAKgnC,MAAMjhC,EAAQX,MAAOW,GAC1B/F,KAAKqC,aAAasC,OAASD,EAC3B1E,KAAKsoC,qBAGb/B,EAAM1lC,UAAUknC,iBAAmB,SAAUyF,GACzC,GAAIztC,GAASC,KAAKD,MAClBC,MAAKwC,aAAakT,YAAc3V,EAAO6C,UAAUmQ,eAAehE,YAChE/O,KAAKwC,aAAa4Q,UAAYrT,EAAO6C,UAAUmQ,eAAehE,WAC9D,IAAIyL,GAAY,EACZza,GAAO6C,UAAUyF,aAAagH,OAC9BmL,EAAY,SAEZza,EAAO6C,UAAUyF,aAAaiH,SAC9BkL,EAAY,WAEZza,EAAO6C,UAAUyF,aAAagH,MAAQtP,EAAO6C,UAAUyF,aAAaiH,SACpEkL,EAAY,eAEhB,IAAIjS,GAAWilC,EAAY7lB,WAAW5nB,EAAO+c,SAASjB,MAAMtT,UAAYxI,EAAO6C,UAAUyF,aAAaE,SAClG6G,EAA+C,UAAlCrP,EAAO+c,SAASjB,MAAMG,QAAsBjc,EAAO+c,SAASjB,MAAMzM,WAAarP,EAAO6C,UAAUyF,aAAa+G,UAC9HpP,MAAKwC,aAAaiY,KAAOD,EAAYjS,EAAW,MAAa6G,GAEjEm3B,EAAM1lC,UAAUmnC,eAAiB,SAAUyF,GACvC,GAAI1tC,GAASC,KAAKD,MAClBC,MAAKooC,oBACL,IAAIljC,GAAUlB,YAAWjE,EAAOmF,YAAa,EAQ7C,QAPAnF,EAAOmF,QAAQwB,MACuB,SAAlC3G,EAAO+c,SAASjB,MAAMG,QACtBhc,KAAKioC,gBAAgBloC,EAAO6C,WAG5B5C,KAAKioC,gBAAgBloC,EAAO6C,WAAW,GAEnC6qC,GACJ,IAAK,UACDztC,KAAK0tC,gBAAgBD,EAAMvoC,EAAS,SAAU,SAC9C,MACJ,KAAK,OACDlF,KAAK0tC,gBAAgBD,EAAMvoC,EAAS,OAAQ,SAC5C,MACJ,KAAK,SACDlF,KAAK0tC,gBAAgBD,EAAMvoC,EAAS,SAAU,SAC9C,MACJ,KAAK,aACDlF,KAAK0tC,gBAAgBD,EAAMvoC,EAAS,OAAQ,YAIxDqhC,EAAM1lC,UAAU6sC,gBAAkB,SAAUD,EAAMvoC,EAAS4/B,EAAYC,GACnE,GAAIhlC,GAASC,KAAKD,MAClB,IAAsC,UAAlCA,EAAO+c,SAASjB,MAAMG,QAAqB,CAC3C,GAAI3b,GAAQL,KAAK2tC,iBAAiBF,EAClC1tC,GAAO+c,SAASjB,MAAMxb,MAAQA,EAAQ,KACtCN,EAAO+c,SAASjB,MAAMipB,WAAaA,EACnC/kC,EAAO+c,SAASjB,MAAMkpB,UAAYA,EAClC/kC,KAAKmoC,cAAcsF,EAAMvoC,OAGzBlF,MAAKqI,aAAagH,KAAOtP,EAAO6C,UAAUyF,aAAagH,KAAsB,WAAfy1B,EAC9D9kC,KAAKqI,aAAaiH,OAASvP,EAAO6C,UAAUyF,aAAaiH,OAAuB,WAAdy1B,EAClE/kC,KAAKynC,aACL1nC,EAAO+C,OAAO,aAAexB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAAS0D,QAASA,MAGrGqhC,EAAM1lC,UAAUyoC,iBAAmB,SAAUrlC,GACzC,GACI6B,IAAWqK,eAAgB,KADlBnQ,MAAKD,OAEX+C,OAAO,QAAUxB,KAAM,oBAAqByB,kBAAkB,EAAOvB,OAASyC,IAAK6B,IAC1F,IAAIX,EAEAA,GADAgD,KAAKC,IAAInE,EAAIpB,YAAYxC,OAAS8H,KAAKC,IAAInE,EAAIpB,YAAYvC,QAClD6H,KAAKC,IAAInE,EAAIpB,YAAYxC,OAGzB8H,KAAKC,IAAInE,EAAIpB,YAAYvC,OAItC,KAAK,GAFD0N,GAEK2sB,EAAK,EAAGiT,GADC,MAAO,QAAS,aAAc,SAAU,UACdjT,EAAKiT,EAAazoC,OAAQw1B,IAAM,CACxE3sB,EAAY4/B,EAAajT,EACzB,IAAIhyB,GAASxD,EAASW,EAAuB,eAAEkI,GAAkB,MAC7DpF,EAASzD,EAASW,EAAuB,eAAEkI,GAAmB,MAClElI,GAAuB,eAAEkI,GAAmB,OAAIrF,EAChD7C,EAAuB,eAAEkI,GAAmB,OAAIpF,IAGxD29B,EAAM1lC,UAAU+qC,gBAAkB,SAAU3nC,GACxC,GAAI6B,IAAWqK,eAAgB,KAC/BnQ,MAAKD,OAAO+C,OAAO,QAAUxB,KAAM,oBAAqByB,kBAAkB,EAAOvB,OAASyC,IAAK6B,IAC/F,IAAIX,EAEAA,GADAgD,KAAKC,IAAInE,EAAIpB,YAAYxC,OAAS8H,KAAKC,IAAInE,EAAIpB,YAAYvC,QAClD6H,KAAKC,IAAInE,EAAIpB,YAAYxC,OAGzB8H,KAAKC,IAAInE,EAAIpB,YAAYvC,OAItC,KAAK,GAFD0N,GAEK2sB,EAAK,EAAGkT,GADC,MAAO,QAAS,aAAc,SAAU,UACdlT,EAAKkT,EAAa1oC,OAAQw1B,IAAM,CACxE3sB,EAAY6/B,EAAalT,EACzB,IAAIhyB,GAAS7C,EAAuB,eAAEkI,GAAmB,OACrDpF,EAAS9C,EAAuB,eAAEkI,GAAmB,MACzDlI,GAAuB,eAAEkI,GAAkB,MAAI7I,EAASwD,EACxD7C,EAAuB,eAAEkI,GAAmB,OAAI7I,EAASyD,IAGjE29B,EAAM1lC,UAAUonC,gBAAkB,SAAUhkC,EAAKu3B,GAC7C,GAAIz7B,GAASC,KAAKD,OACdoP,EAAOnP,KAAK8oC,WAAWtN,GACvBn7B,EAAQL,KAAKwC,aAAayoC,YAAY97B,GAAM9O,MACH,GAAzCN,EAAO6C,UAAUyF,aAAaE,SAC9BjI,EAAUP,EAAO6C,UAAUyF,aAAaE,SAAoD,IAAzCxI,EAAO6C,UAAUyF,aAAaE,SACjFtF,EAASjD,KAAKssC,iBAAiBroC,EAC/BhC,qBAAkBu5B,GACH,IAAXv4B,GAAqC,MAArBkF,KAAKC,IAAInF,GACzBgB,EAAIoE,aAAaC,UAAYjI,EAAQ4D,EAAIoE,aAAaE,SAGtDtE,EAAIoE,aAAaC,UAAYhI,EAAS2D,EAAIoE,aAAaE,SAGtDizB,IACLv3B,EAAIoE,aAAaC,UAAYjI,EAAQsnB,WAAW5nB,EAAO+c,SAASjB,MAAMtT,YAG9Eg+B,EAAM1lC,UAAUqnC,eAAiB,SAAUjkC,GACvC,GAAIhB,GAASjD,KAAKssC,iBAAiBroC,EACpB,KAAXhB,GAAqC,MAArBkF,KAAKC,IAAInF,GACzBgB,EAAIoE,aAAaE,SAAYtE,EAAIpB,YAAYxC,MAAQ4D,EAAIoE,aAAaC,UAGtErE,EAAIoE,aAAaE,SAAYtE,EAAIpB,YAAYvC,OAAS2D,EAAIoE,aAAaC,WAG/Ei+B,EAAM1lC,UAAUsnC,cAAgB,SAAUsF,EAAMvoC,GAC5C,GAAInF,GAASC,KAAKD,OACd+M,EAAc9I,YAAWjE,EAAOiG,YAAa,GAC7CF,GAAWC,WACfhG,GAAO+C,OAAO,UAAYxB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAASsE,OAAQA,IAC3F,IAAIiH,GAAUjH,EAAgB,OAC9BiH,GAAQ7H,QAAUA,EAClB6H,EAAQ9F,UAAYjD,YAAWjE,EAAOkH,cAAe,GACrD8F,EAAQlH,iBAAmB7B,YAAWjE,EAAO8F,qBAAsB,EACnE,IAAIuZ,IAAoBhW,aAAc,KACtCrJ,GAAO+C,OAAO,iBAAmBxB,KAAM,kBAAmByB,kBAAkB,EACxEvB,OAASyC,IAAKmb,KAClBrS,EAAQ3D,aAAepF,YAAWob,EAA8B,iBAAO,EACvE,IAAI0uB,GAAW/tC,EAAO6C,UAAUyF,aAAagH,KACzC0+B,EAAahuC,EAAO6C,UAAUyF,aAAaiH,MAC/C,QAAQm+B,GACJ,IAAK,UACD1tC,EAAO6C,UAAUyF,aAAagH,MAAO,EACrCtP,EAAO6C,UAAUyF,aAAaiH,QAAS,CACvC,MACJ,KAAK,OACDvP,EAAO6C,UAAUyF,aAAagH,MAAO,EACrCtP,EAAO6C,UAAUyF,aAAaiH,QAAS,CACvC,MACJ,KAAK,SACDvP,EAAO6C,UAAUyF,aAAagH,MAAO,EACrCtP,EAAO6C,UAAUyF,aAAaiH,QAAS,CACvC,MACJ,KAAK,aACDvP,EAAO6C,UAAUyF,aAAagH,MAAO,EACrCtP,EAAO6C,UAAUyF,aAAaiH,QAAS,EAG/CvP,EAAOmF,QAAQe,KAAKlG,EAAO6C,WAC3B7C,EAAO+C,OAAO,aAAexB,KAAM,qBAAsByB,kBAAkB,EACvEvB,OAAS6L,UAAW,wBAAyBC,YAAaP,EAASQ,gBAAiBR,EAAQ7H,QACxFsI,kBAAmBT,EAAQ9F,UAAWwG,qBAAsBV,EAAQ3D,aACpEsE,gBAAiBZ,EAAaa,aAAc,KAC5CC,YAAa,KAAMC,eAAgB,KAAMrI,aAAc,QAC/DzF,EAAOmF,QAAQwB,MACf3G,EAAO6C,UAAUyF,aAAagH,KAAOy+B,EACrC/tC,EAAO6C,UAAUyF,aAAaiH,OAASy+B,GAE3CxH,EAAM1lC,UAAUunC,mBAAqB,WACjC,GAA2C,SAAvCpoC,KAAKD,OAAO+c,SAASjB,MAAMG,QAC3Bhc,KAAKD,OAAOmF,QAAQe,KAAKjG,KAAKD,OAAO6C,eAEpC,CACD,GAAI8B,GAAOV,YAAWhE,KAAKD,OAAO6C,cAAe,EACjD5C,MAAKD,OAAO+C,OAAO,aAAexB,KAAM,2BAA4ByB,kBAAkB,IACtF/C,KAAKD,OAAOmF,QAAQe,KAAKjG,KAAKD,OAAO6C,WACrC5C,KAAKD,OAAO6C,UAAY8B,IAGhC6hC,EAAM1lC,UAAUwnC,YAAc,WACiB,SAAvCroC,KAAKD,OAAO+c,SAASjB,MAAMG,UAC3Bhc,KAAKsoC,mBACLtoC,KAAKuoC,cACLvoC,KAAKsoC,mBACLtoC,KAAKD,OAAO0F,YAAYC,cAAe,IAG/C6gC,EAAM1lC,UAAUynC,iBAAmB,WAC/BtoC,KAAKD,OAAO6C,aACZ5C,KAAKD,OAAO6C,UAAUC,aAAgB1C,OAAQ,EAAGC,OAAQ,EAAG2H,KAAM,EAAGC,KAAM,EAAG3H,MAAO,EAAGC,OAAQ,GAChGN,KAAKD,OAAO6C,UAAUmyB,YACtB/0B,KAAKD,OAAO6C,UAAUoyB,iBACtBh1B,KAAKD,OAAO6C,UAAUmV,eACtB/X,KAAKD,OAAO6C,UAAUmQ,eAAiB/S,KAAK+S,eAC5C/S,KAAKD,OAAO6C,UAAUyF,aAAerI,KAAKqI,aAC1CrI,KAAKD,OAAO6C,UAAUgR,aAAe,GAEzC2yB,EAAM1lC,UAAU0nC,YAAc,SAAUhtB,GACpC,GAAIyyB,IAAW,CACf,QAAoCv6B,KAAhCzT,KAAKD,OAAO6C,UAAUwC,OAAuD,SAAhCpF,KAAKD,OAAO6C,UAAUwC,OAAyD,KAArCpF,KAAKD,OAAO6C,UAAUuQ,WAC7GnT,KAAKsoC,mBACLtoC,KAAKwC,aAAa2B,UAAU,EAAG,EAAGnE,KAAKD,OAAOwC,YAAYlC,MAAOL,KAAKD,OAAOwC,YAAYjC,YAExF,CACD,GAAIoM,OAAa,GACbwR,GAAkB,CAUtB,QAToCzK,KAAhCzT,KAAKD,OAAO6C,UAAUwC,QACtBsH,EAAa1M,KAAKD,OAAO6C,UAAUwC,MAAMuH,MAAM,UAEhC8G,KAAf/G,GAA4B1M,KAAKD,OAAO0F,YAAYC,aACpDwY,GAAkB,MAEEzK,KAAf/G,GAA8C,SAAlBA,EAAW,KAC5CwR,GAAkB,GAElBle,KAAKD,OAAO6C,UAAUwC,QAAU8Y,GAAmD,UAAhCle,KAAKD,OAAO6C,UAAUwC,MAAmB,CAC5F,IAASJ,EAAI,EAAGA,EAAIhF,KAAKD,OAAOmF,QAAQC,OAAQH,IAC5C,GAAI08B,KAAKC,UAAU3hC,KAAKD,OAAO6C,aAAe8+B,KAAKC,UAAU3hC,KAAKD,OAAOmF,QAAQF,IAAK,CAClFgpC,GAAW,CACX,OAGR,IAAKA,EAAU,CACP/rC,oBAAkBjC,KAAKD,OAAO6C,UAAUic,aACxC7e,KAAKD,OAAO6C,UAAUic,UAAY,UAAY7e,KAAKD,OAAOmF,QAAQC,OAAS,IAE/EnF,KAAKonC,sBACL,IAAIvF,GAAe7hC,KAAKD,OAAO6C,UAAUic,UAAUlS,MAAM,KACrD0U,EAAcrhB,KAAKD,OAAOmF,QAAQi9B,OAAO,EAAG1U,SAASoU,EAAa,GAAI,IAAM,EAChFxgB,GAAYpb,KAAKjC,YAAWhE,KAAKD,OAAO6C,cAAe,GACvD,KAAK,GAAIoC,GAAI,EAAGA,EAAIhF,KAAKD,OAAOmF,QAAQC,OAAQH,IAC5Cqc,EAAYpb,KAAKjG,KAAKD,OAAOmF,QAAQF,GAEzChF,MAAKD,OAAOmF,QAAUmc,EACtBA,KACArhB,KAAKsoC,mBACLtoC,KAAKqC,aAAa8B,UAAU,EAAG,EAAGnE,KAAKD,OAAOqC,YAAY/B,MAAOL,KAAKD,OAAOqC,YAAY9B,QACzFN,KAAKD,OAAO+C,OAAO,QAAUxB,KAAM,mBAAoByB,kBAAkB,IACzE/C,KAAKD,OAAO+C,OAAO,QAAUxB,KAAM,mBAAoByB,kBAAkB,EAAOvB,OAAS+D,QAASvF,KAAKqC,gBACvGrC,KAAKD,OAAO+C,OAAO,QAAUxB,KAAM,mBAAoByB,kBAAkB,EAAOvB,OAAS+D,QAASvF,KAAKwC,gBACvGxC,KAAKD,OAAO0F,YAAYL,MAAQ,GAChCpF,KAAKsoC,mBACDtoC,KAAKD,OAAOyF,cACZxF,KAAKD,OAAO+C,OAAO,QAAUxB,KAAM,aAAcyB,kBAAkB,EAC/DvB,OAAS+D,QAASvF,KAAKqC,aAAc+H,OAAQ,KAAMC,OAAQ,QAE9D6B,aAIDlM,KAAKD,OAAO+N,cAAc9N,KAAKD,OAAOgO,QAAS,6BAH/C/N,KAAKD,OAAO+C,OAAO,WAAaxB,KAAM,qBAAsByB,kBAAkB,IAK9Ed,oBAAkBsZ,KAClBvb,KAAKD,OAAO+C,OAAO,aAAexB,KAAM,gBAAiBE,OAASmF,KAAM,QACxE3G,KAAKD,OAAO+C,OAAO,QAAUxB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAAS2Q,WAAY,aAMtHo0B,EAAM1lC,UAAUsoC,wBAA0B,WACtC,GAAIppC,GAASC,KAAKD,OACdkuC,EAAUluC,EAAO+c,SAAStb,KAC9BzB,GAAO+c,SAAStb,MAAQ,EACxB,KAAK,GAAIwD,GAAI,EAAGC,EAAMgpC,EAAQ9oC,OAAQH,EAAIC,EAAKD,IAC3CjF,EAAO+c,SAAStb,OAASysC,EAAQjpC,GACjCjF,EAAO+c,SAASjB,MAAMvb,OAAS,OAC/BP,EAAO+c,SAASjB,MAAMvb,OAASP,EAAO+c,SAAS0mB,aAAe,KAC9DxjC,KAAK4nC,mBAGbrB,EAAM1lC,UAAU0rC,kBAAoB,WAChC,GAAIxsC,GAASC,KAAKD,MAClB,IAA+B,SAA3BA,EAAO6C,UAAUwC,MAAkB,CACnCrF,EAAO+c,SAASjB,MAAMqyB,gBAAkB,KACxC,IAAIxS,GAAgB37B,EAAO6C,UAAUgR,cAAgB,IAAMzL,KAAKyC,IAC5D+P,EAAQ,GACR1X,EAASjD,KAAKssC,iBAAiBvsC,EAAO6C,UAC1C,IAAI7C,EAAO6C,UAAUmV,YAAY5S,OAAS,EAEtC,IAAK,GAAIH,GAAI,EAAGA,EAAIjF,EAAO6C,UAAUmV,YAAY5S,OAAQH,IAEjD2V,GADW,IAAX1X,GAAgBA,EAAS,IAAO,GAAgB,MAAXA,EACsB,eAAlDlD,EAAO6C,UAAUmV,YAAY/S,GAAG4N,cAAiC,eACtE,eAGuD,eAAlD7S,EAAO6C,UAAUmV,YAAY/S,GAAG4N,cAAiC,eACtE,eAER3P,GAAUy4B,EAC4C,eAAlD37B,EAAO6C,UAAUmV,YAAY/S,GAAG4N,cAChC7S,EAAO+c,SAASjB,MAAM7Y,UAAY,UAAYC,EAAS,OAAS0X,EAET,aAAlD5a,EAAO6C,UAAUmV,YAAY/S,GAAG4N,gBACrC7S,EAAO+c,SAASjB,MAAM7Y,UAAY,UAAYC,EAAS,OAAS0X,OAKxE1X,IAAUy4B,EACV37B,EAAO+c,SAASjB,MAAM7Y,UAAY,UAAYC,EAAS,SAInEsjC,EAAM1lC,UAAU8sC,iBAAmB,SAAUF,GACzC,GAAI1tC,GAASC,KAAKD,OACd+tC,EAAW/tC,EAAO6C,UAAUyF,aAAagH,KACzC0+B,EAAahuC,EAAO6C,UAAUyF,aAAaiH,MAC/C,QAAQm+B,GACJ,IAAK,UACD1tC,EAAO6C,UAAUyF,aAAagH,MAAO,EACrCtP,EAAO6C,UAAUyF,aAAaiH,QAAS,CACvC,MACJ,KAAK,OACDvP,EAAO6C,UAAUyF,aAAagH,MAAO,EACrCtP,EAAO6C,UAAUyF,aAAaiH,QAAS,CACvC,MACJ,KAAK,SACDvP,EAAO6C,UAAUyF,aAAagH,MAAO,EACrCtP,EAAO6C,UAAUyF,aAAaiH,QAAS,CACvC,MACJ,KAAK,aACDvP,EAAO6C,UAAUyF,aAAagH,MAAO,EACrCtP,EAAO6C,UAAUyF,aAAaiH,QAAS,EAG/CtP,KAAK+nC,kBACL,IAAI1nC,EAWJ,OATIA,GADkC,SAAlCN,EAAO+c,SAASjB,MAAMG,QACdhc,KAAKwC,aAAayoC,YAAYlrC,EAAO6C,UAAUuQ,YAAY9S,MACtB,GAAzCN,EAAO6C,UAAUyF,aAAaE,SAG1BvI,KAAKwC,aAAayoC,YAAYlrC,EAAO+c,SAAStb,OAAOnB,MAChB,GAAzCN,EAAO6C,UAAUyF,aAAaE,SAEtCxI,EAAO6C,UAAUyF,aAAagH,KAAOy+B,EACrC/tC,EAAO6C,UAAUyF,aAAaiH,OAASy+B,EAChC1tC,GAEXkmC,EAAM1lC,UAAUstC,cAAgB,SAAUlqC,GACtC,GAAIlE,GAASC,KAAKD,OACdquC,IAKJ,QAJAA,EAAapxB,GAAK/Y,EAAI4a,UACtBuvB,EAAaznC,KAAO5G,EAAO+G,aAAa7C,EAAImB,OAC5CgpC,EAAajuC,OAAS8D,EAAIpB,YAAY1C,OACtCiuC,EAAahuC,OAAS6D,EAAIpB,YAAYzC,OAC9B6D,EAAImB,OACR,IAAK,YACDgpC,EAAa/tC,MAAQ4D,EAAIpB,YAAYxC,MACrC+tC,EAAa9tC,OAAS2D,EAAIpB,YAAYvC,OACtC8tC,EAAar/B,YAAc9K,EAAI8O,eAAehE,YAC9Cq/B,EAAap/B,UAAY/K,EAAI8O,eAAe/D,UAC5Co/B,EAAan/B,YAAchL,EAAI8O,eAAe9D,WAC9C,MACJ,KAAK,UACDm/B,EAAa1jC,OAASzG,EAAIpB,YAAYxC,MAAQ,EAC9C+tC,EAAar/B,YAAc9K,EAAI8O,eAAehE,YAC9Cq/B,EAAap/B,UAAY/K,EAAI8O,eAAe/D,UAC5Co/B,EAAan/B,YAAchL,EAAI8O,eAAe9D,WAC9C,MACJ,KAAK,OACL,IAAK,QACDm/B,EAAajpC,OAASlB,EAAIpB,YAAYxC,MACtC+tC,EAAar/B,YAAc9K,EAAI8O,eAAehE,YAC9Cq/B,EAAan/B,YAAchL,EAAI8O,eAAe9D,WAC9C,MACJ,KAAK,OACDm/B,EAAaj/B,KAAOlL,EAAIkP,WACxBi7B,EAAa7lC,SAAWtE,EAAIoE,aAAaE,SACzC6lC,EAAajb,MAAQlvB,EAAI8O,eAAehE,YACxCq/B,EAAarJ,aACT9gC,EAAIoE,aAAagH,MACjB++B,EAAarJ,UAAU9+B,KAAK,QAE5BhC,EAAIoE,aAAaiH,QACjB8+B,EAAarJ,UAAU9+B,KAAK,SAEhC,MACJ,KAAK,OACDmoC,EAAar/B,YAAc9K,EAAI8O,eAAehE,YAC9Cq/B,EAAan/B,YAAchL,EAAI8O,eAAe9D,YAGtD,MAAOm/B,IAEX7H,EAAM1lC,UAAUwtC,uBAAyB,SAAUhb,GAC/C,GAAItzB,GAASC,KAAKD,OACdquC,IAMJ,OALAA,GAAapxB,GAAKjd,EAAOkH,UAAUosB,GAAOrW,GAC1CoxB,EAAaznC,KAAO4sB,YAAUC,aAC9B4a,EAAavlC,OAAS7E,YAAWjE,EAAOkH,UAAUosB,GAAOxqB,QACzDulC,EAAar/B,YAAchP,EAAOkH,UAAUosB,GAAOtkB,YACnDq/B,EAAan/B,YAAclP,EAAOkH,UAAUosB,GAAOpkB,YAC5Cm/B,GAEX7H,EAAM1lC,UAAU2nC,gBAAkB,SAAUxrB,EAAI/Y,GAC5C,GACImqC,GADAruC,EAASC,KAAKD,MAElB,KAAKA,EAAOyL,UAAYzL,EAAO0L,cAE3B,GADAzL,KAAKuoC,cACoB,UAArBvrB,EAAGrQ,MAAM,KAAK,GAAgB,CAE9B,IAAK,GADDqG,GACKhO,EAAI,EAAGC,EAAMlF,EAAOmF,QAAQC,OAAQH,EAAIC,EAAKD,IAClD,GAAIjF,EAAOmF,QAAQF,GAAG6Z,YAAc7B,EAAI,CACpChK,EAAQhP,YAAWjE,EAAOmF,QAAQF,OAAQ,EAC1C,OAGRopC,EAAepuC,KAAKmuC,cAAcn7B,OAER,QAArBgK,EAAGrQ,MAAM,KAAK,KACnByhC,EAAepuC,KAAKquC,uBAAuB5gB,SAASzQ,EAAGrQ,MAAM,KAAK,GAAI,IAAM,GAGpF1I,GAAkB,aAAImqC,GAE1B7H,EAAM1lC,UAAU4nC,iBAAmB,SAAUxkC,GACzC,GAAIlE,GAASC,KAAKD,OACduuC,IACJ,KAAKvuC,EAAOyL,UAAYzL,EAAO0L,cAAe,CAC1CzL,KAAKuoC,aACL,KAAK,GAAIvjC,GAAI,EAAGC,EAAMlF,EAAOmF,QAAQC,OAAQH,EAAIC,EAAKD,IAAK,CACnDopC,EAAepuC,KAAKmuC,cAAcpuC,EAAOmF,QAAQF,GACrDspC,GAAiBroC,KAAKmoC,GAE1B,IAASppC,EAAI,EAAGA,EAAIjF,EAAOiH,gBAAiBhC,IAAK,CAC7C,GAAIopC,GAAepuC,KAAKquC,uBAAuBrpC,EAC/CspC,GAAiBroC,KAAKmoC,IAG9BnqC,EAAsB,iBAAIqqC,GAE9B/H,EAAM1lC,UAAU6nC,gBAAkB,SAAUloC,EAAGC,EAAGwD,GAC9C,GAAIsqC,IAAU,GACTtsC,oBAAkBzB,KAAOyB,oBAAkBxB,IAAMD,GAAKR,KAAKD,OAAOqD,IAAIC,UAAY5C,GAAKT,KAAKD,OAAOqD,IAAIE,SACxG9C,GAAKR,KAAKD,OAAOqD,IAAIC,SAAWrD,KAAKD,OAAOqD,IAAIG,WAAa9C,GAAKT,KAAKD,OAAOqD,IAAIE,QAAUtD,KAAKD,OAAOqD,IAAII,aAC5G+qC,GAAU,GAEdtqC,EAAa,QAAIsqC,GAErBhI,EAAM1lC,UAAU8nC,oBAAsB,SAAUr6B,EAAYC,EAAwBtK,GAShF,MARAqK,GAAatO,KAAKwuC,8BAA8BlgC,GAChDA,EAAatO,KAAKyuC,uBAAuBngC,GAEf,KAD1BA,EAAatO,KAAK0uC,yBAAyBpgC,IAC5BnJ,QAAgBoJ,IAC3BvO,KAAKD,OAAOiD,UAAUC,OAAS,EAC/BjD,KAAKD,OAAOiD,UAAUU,cAAgB,IAE1CO,EAAgB,WAAIqK,EACbA,GAEXi4B,EAAM1lC,UAAU2tC,8BAAgC,SAAUlgC,GAKtD,IAAK,GAJDqgC,GAAc,EACdC,EAAa,EACbC,EAAa,EACbC,EAAW,EACN9pC,EAAI,EAAGA,EAAIsJ,EAAWnJ,OAAQH,IACb,KAAlBsJ,EAAWtJ,IAA+B,gBAAlBsJ,EAAWtJ,IAEnC4pC,EAAa,EACbC,EAAa,EACbC,EAAW,EACS,MAJpBH,IAKIrgC,EAAW5H,MACX4H,EAAW5H,MACX4H,EAAW5H,MACX4H,EAAW5H,SAGS,KAAnB4H,EAAWtJ,IAAgC,eAAlBsJ,EAAWtJ,IAEzC2pC,EAAc,EACdE,EAAa,EACbC,EAAW,EACQ,MAJnBF,IAKItgC,EAAW5H,MACX4H,EAAW5H,MACX4H,EAAW5H,MACX4H,EAAW5H,QAGQ,eAAlB4H,EAAWtJ,IAAyC,eAAlBsJ,EAAWtJ,IAC7B,mBAAlBsJ,EAAWtJ,IAEd4pC,EAAa,EACbD,EAAc,EACdG,EAAW,EACQ,MAJnBD,IAKIvgC,EAAW5H,MACX4H,EAAW5H,QAGQ,aAAlB4H,EAAWtJ,IAAuC,aAAlBsJ,EAAWtJ,IAC3B,iBAAlBsJ,EAAWtJ,KAEd6pC,EAAa,EACbD,EAAa,EACbD,EAAc,EACG,MAJjBG,IAKIxgC,EAAW5H,MACX4H,EAAW5H,OAIvB,OAAO4H,IAEXi4B,EAAM1lC,UAAU4tC,uBAAyB,SAAUngC,GAC/C,IAAK,GAAItJ,GAAI,EAAGA,EAAIsJ,EAAWnJ,OAAQH,IAC9B/C,oBAAkBqM,EAAWtJ,EAAI,MACX,eAAlBsJ,EAAWtJ,IAAyC,eAAlBsJ,EAAWtJ,IACzB,mBAAlBsJ,EAAWtJ,IACY,aAAtBsJ,EAAWtJ,EAAI,IAA2C,aAAtBsJ,EAAWtJ,EAAI,IAC9B,iBAAlBsJ,EAAWtJ,IACK,eAAtBsJ,EAAWtJ,EAAI,IAA6C,eAAtBsJ,EAAWtJ,EAAI,IAC7B,mBAAlBsJ,EAAWtJ,IACK,aAAtBsJ,EAAWtJ,EAAI,IAA2C,aAAtBsJ,EAAWtJ,EAAI,IAC3B,iBAAlBsJ,EAAWtJ,GAMM,aAAlBsJ,EAAWtJ,IAAuC,aAAlBsJ,EAAWtJ,IAC5B,iBAAlBsJ,EAAWtJ,IACY,eAAtBsJ,EAAWtJ,EAAI,IAA6C,eAAtBsJ,EAAWtJ,EAAI,IAC5B,mBAAtBsJ,EAAWtJ,EAAI,IACC,aAAtBsJ,EAAWtJ,EAAI,IAA2C,aAAtBsJ,EAAWtJ,EAAI,IAAuC,iBAAlBsJ,EAAWtJ,IAC7D,eAAtBsJ,EAAWtJ,EAAI,IAA6C,eAAtBsJ,EAAWtJ,EAAI,IAAyC,mBAAlBsJ,EAAWtJ,KACxFsJ,EAAW5H,MACX4H,EAAW5H,MACX4H,EAAW5H,MACX4H,EAAW5H,QAdX4H,EAAW5H,MACX4H,EAAW5H,MACX4H,EAAW5H,MACX4H,EAAW5H,OAevB,OAAO4H,IAEXi4B,EAAM1lC,UAAU6tC,yBAA2B,SAAUpgC,GACjD,IAAK,GAAItJ,GAAI,EAAGA,EAAIsJ,EAAWnJ,OAAQH,IAC9B/C,oBAAkBqM,EAAWtJ,EAAI,MACX,KAAlBsJ,EAAWtJ,IAA+B,gBAAlBsJ,EAAWtJ,KACZ,KAAvBsJ,EAAWtJ,EAAI,IAAgC,eAAlBsJ,EAAWtJ,IAIhB,KAAnBsJ,EAAWtJ,IAAgC,eAAlBsJ,EAAWtJ,IACnB,KAAtBsJ,EAAWtJ,EAAI,IAA+B,gBAAlBsJ,EAAWtJ,KACxCsJ,EAAW5H,MACX4H,EAAW5H,QANX4H,EAAW5H,MACX4H,EAAW5H,OASvB,OAAO4H,IAEXi4B,EAAM1lC,UAAU+nC,YAAc,SAAU5rB,EAAI/Y,GACxC,GAAIlE,GAASC,KAAKD,OACdqzB,GAAa,CACjB,KAAKrzB,EAAOyL,UAAYzL,EAAO0L,cAE3B,GADAzL,KAAKuoC,cACoB,UAArBvrB,EAAGrQ,MAAM,KAAK,GAAgB,CAE9B,IAAK,GADDuG,GACKlO,EAAI,EAAGC,EAAMlF,EAAOmF,QAAQC,OAAQH,EAAIC,EAAKD,IAClD,GAAIjF,EAAOmF,QAAQF,GAAG6Z,YAAc7B,EAAI,CACpC9J,EAAQlP,YAAWjE,EAAOmF,QAAQF,OAAQ,EAC1C,OAGR,GAAI/C,oBAAkBiR,GAClBkgB,GAAa,MAEZ,CACDA,GAAa,EACbrzB,EAAO6C,UAAYsQ,CACfpN,IAAWsX,aAAc,KAC7Brd,GAAO+C,OAAO,WAAaxB,KAAM,kBAAmByB,kBAAkB,EAAOvB,OAASyC,IAAK6B,KAC3F9F,KAAKqC,aAAasC,OAASmB,EAAqB,aAChD/F,EAAO+C,OAAO,aAAexB,KAAM,cAAeyB,kBAAkB,EAChEvB,OAASyC,IAAKlE,EAAO6C,aACpBsJ,cAiBDnM,EAAO+N,cAAc/N,EAAOgO,QAAShO,EAAO6C,UAAUwC,OACvB,SAA3BrF,EAAO6C,UAAUwC,MACjBrF,EAAO+N,cAAc9N,KAAKD,OAAOgO,QAAS,OAAQ,0BAGlDhO,EAAO+N,cAAc/N,EAAOgO,QAAS,qBAAsBhO,EAAO6C,UAAUwC,SArBjD,SAA3BrF,EAAO6C,UAAUwC,MACjBrF,EAAO+C,OAAO,WAAaxB,KAAM,kBAAmByB,kBAAkB,EAAOvB,OAASmF,KAAM,OACpF8C,WAAY,KAAMC,WAAY,KAAMC,UAAW,KAAMC,MAAO,QAEpC,QAA3B7J,EAAO6C,UAAUwC,MACtBrF,EAAO+C,OAAO,WAAaxB,KAAM,kBAAmByB,kBAAkB,EAAOvB,OAASmF,KAAM,MACpF8C,WAAY,KAAMC,WAAY,KAAMC,UAAW,KAAMC,MAAO,QAGpE7J,EAAO+C,OAAO,WAAaxB,KAAM,kBAAmByB,kBAAkB,EAAOvB,OAASmF,KAAM,SACpF8C,WAAY,KAAMC,WAAY,KAAMC,UAAW,KAAMC,MAAO,QAExE7J,EAAO+C,OAAO,WAAaxB,KAAM,uBAAwByB,kBAAkB,IAC3EhD,EAAO+C,OAAO,WAAaxB,KAAM,YAAayB,kBAAkB,EAAOvB,OAASw+B,UAAW,cAalG,IAAyB,QAArBhjB,EAAGrQ,MAAM,KAAK,GAAc,CACjC,GAAI7G,IAAWM,MAAM,EACrBrG,GAAO+C,OAAO,aAAexB,KAAM,yBAA0ByB,kBAAkB,EAAOvB,OAASyC,IAAK6B,KAChGA,EAAa,MACb/F,EAAO8zB,OAEX,IAAIpW,IAAU6W,SAAS,EACvBv0B,GAAO+C,OAAO,iBAAmBxB,KAAM,WAAYE,OAAS6xB,MAAO5F,SAASzQ,EAAGrQ,MAAM,KAAK,GAAI,IAAM,EAAG1I,IAAKwZ,KACxGA,EAAe,SACf2V,GAAa,EACbrzB,EAAO+C,OAAO,iBAAmBxB,KAAM,YAAaE,OAASwb,GAAIA,KAC5D9Q,cAKDnM,EAAO+N,cAAc/N,EAAOgO,QAAS,OACrChO,EAAO+N,cAAc/N,EAAOgO,QAAS,qBAAsB,SAL3DhO,EAAO+C,OAAO,WAAaxB,KAAM,YAAayB,kBAAkB,EAAOvB,OAASw+B,WAAW,KAC3FjgC,EAAO+C,OAAO,WAAaxB,KAAM,uBAAwByB,kBAAkB,MAQ/EqwB,GAAa,EAIzBnvB,EAAgB,WAAImvB,GAExBmT,EAAM1lC,UAAUgoC,YAAc,SAAU7rB,GACpC,GAAIjd,GAASC,KAAKD,MAClB,KAAKA,EAAOyL,UAAYzL,EAAO0L,cAAe,CAE1C,GADAzL,KAAKuoC,cACoB,UAArBvrB,EAAGrQ,MAAM,KAAK,IACd,IAAK,GAAI3H,GAAI,EAAGC,EAAMlF,EAAOmF,QAAQC,OAAQH,EAAIC,EAAKD,IAClD,GAAIjF,EAAOmF,QAAQF,GAAG6Z,YAAc7B,EAAI,CACpCjd,EAAOmF,QAAQi9B,OAAOn9B,EAAG,EACzB,YAIkB,QAArBgY,EAAGrQ,MAAM,KAAK,IACnB5M,EAAO+C,OAAO,iBAAmBxB,KAAM,uBAAwBE,OAASwb,GAAIA,IAEhF,IAAIlX,IAAWsX,aAAc,KAC7Brd,GAAO+C,OAAO,WAAaxB,KAAM,kBAAmByB,kBAAkB,EAAOvB,OAASyC,IAAK6B,KAC3F9F,KAAKqC,aAAasC,OAASmB,EAAqB,aAChD9F,KAAKqC,aAAa8B,UAAU,EAAG,EAAGpE,EAAOqC,YAAY/B,MAAON,EAAOqC,YAAY9B,QAC/EP,EAAO+C,OAAO,QAAUxB,KAAM,mBAAoByB,kBAAkB,IAC/DmJ,aAIDnM,EAAO+N,cAAc/N,EAAOgO,QAAS,eAHrChO,EAAO+C,OAAO,WAAaxB,KAAM,uBAAwByB,kBAAkB,MAOvFwjC,EAAM1lC,UAAUioC,WAAa,SAAU0E,EAAWr+B,EAAMlL,GAChDhC,oBAAkBkN,KAClBA,EAAOq+B,EAAYxtC,KAAKD,OAAO+c,SAAStb,MAAQxB,KAAKD,OAAO6C,UAAUuQ,WAM1E,KAAK,GAJD47B,GACA10B,EAAOlL,EAAKxC,MAAM,MAClBqiC,EAAS30B,EAAK,GAAGlV,OACjB8pC,EAAU50B,EAAK,GACVrV,EAAI,EAAGA,EAAIqV,EAAKlV,OAAQH,KAC7B+pC,EAAO10B,EAAKrV,GAAGG,QACJ6pC,IACPC,EAAU50B,EAAKrV,GACfgqC,EAASD,EAMjB,OAHI9qC,KACAA,EAAa,QAAIgrC,GAEdA,GAEX1I,EAAM1lC,UAAUkoC,cAAgB,SAAUxwB,EAAIC,EAAIC,EAAIC,GAClD,GACI1T,GACA0V,EAFA7R,IAGJ,IAAI0P,IAAOE,EAAI,CACPD,EAAKE,GACL1T,GAAKuT,EAAIC,GACTkC,GAAKjC,EAAIC,KAGTgC,GAAKnC,EAAIC,GACTxT,GAAKyT,EAAIC,GAIb,KAAK,GAFDw2B,GAAIlvC,KAAKmvC,SAASnqC,EAAG0V,GAAG,GACxBX,EAAI/Z,KAAKovC,aAAapqC,EAAGkqC,GACpBzuC,EAAIuE,EAAE,GAAIvE,GAAKia,EAAE,GAAIja,IAAK,CAC3BD,EAAI0uC,EAAIzuC,EAAIsZ,CAChBlR,GAAO5C,MAAOzF,EAAGA,EAAGC,EAAGA,SAG1B,CACG8X,EAAKE,GACLzT,GAAKuT,EAAIC,GACTkC,GAAKjC,EAAIC,KAGTgC,GAAKnC,EAAIC,GACTxT,GAAKyT,EAAIC,GAIb,KAAK,GAFDw2B,GAAIlvC,KAAKmvC,SAASnqC,EAAG0V,GAAG,GACxBX,EAAI/Z,KAAKovC,aAAapqC,EAAGkqC,GACpB1uC,EAAIwE,EAAE,GAAIxE,GAAKka,EAAE,GAAIla,IAAK,CAC3BC,EAAIyuC,EAAI1uC,EAAIuZ,CAChBlR,GAAO5C,MAAOzF,EAAGA,EAAGC,EAAGA,KAG/B,GAAI0H,KAAK2xB,MAAMvhB,KAAQpQ,KAAK2xB,MAAMrhB,IAAQ5P,EAAO1D,OAAS,KAAOuT,EAAKF,EAAK,IAAMA,EAAKE,EAAK,IAAM,CAC7F7P,IAEA,KAAK,GADDwmC,GAAUlnC,KAAK6Y,IAAIxI,EAAIE,GAClB42B,EAAM,EAAGA,EAAMnnC,KAAKC,IAAID,KAAK2xB,MAAMphB,GAAMvQ,KAAK2xB,MAAMthB,IAAM82B,IAC/DzmC,EAAO5C,MAAOzF,EAAG+X,EAAI9X,EAAG4uC,EAAUC,GAEtC,IAAIzmC,EAAO1D,OAAS,EAAG,CACfoqC,MAAO,EAEPA,GADAttC,oBAAkB4G,EAAOA,EAAO1D,OAAS,KAChC3E,EAAG,EAAGC,EAAG,GAGXoI,EAAOA,EAAO1D,OAAS,EAElC,IAAImP,GAAQzL,EAAOA,EAAO1D,OAAS,GAAM,EAAIoqC,EAAK/uC,EAC9C+T,EAAQ1L,EAAOA,EAAO1D,OAAS,GAAM,EAAIoqC,EAAK9uC,CAClDoI,GAAO5C,MAAOzF,EAAGqI,EAAOA,EAAO1D,OAAS,GAAM,EAAKmP,EAAQ,EAAI7T,EAAGoI,EAAOA,EAAO1D,OAAS,GAAM,EAAKoP,EAAQ,SAG/G,IAAIpM,KAAK2xB,MAAMthB,KAAQrQ,KAAK2xB,MAAMphB,IAAQ7P,EAAO1D,OAAS,KAAOsT,EAAKF,EAAK,IAAMA,EAAKE,EAAK,IAAM,CAClG5P,IAEA,KAAK,GADD2mC,GAAUrnC,KAAK6Y,IAAIzI,EAAIE,GAClBg3B,EAAM,EAAGA,EAAMtnC,KAAKC,IAAID,KAAK2xB,MAAMrhB,GAAMtQ,KAAK2xB,MAAMvhB,IAAMk3B,IAC/D5mC,EAAO5C,MAAOzF,EAAGgvC,EAAUC,EAAKhvC,EAAG+X,GAEvC,IAAI3P,EAAO1D,OAAS,EAAG,CACnB,GAAIoqC,OAAO,EAEPA,GADAttC,oBAAkB4G,EAAOA,EAAO1D,OAAS,KAChC3E,EAAG,EAAGC,EAAG,GAGXoI,EAAOA,EAAO1D,OAAS,EAElC,IAAImP,GAAQzL,EAAOA,EAAO1D,OAAS,GAAM,EAAIoqC,EAAK/uC,EAC9C+T,EAAQ1L,EAAOA,EAAO1D,OAAS,GAAM,EAAIoqC,EAAK9uC,CAClDoI,GAAO5C,MAAOzF,EAAGqI,EAAOA,EAAO1D,OAAS,GAAM,EAAKmP,EAAQ,EAAI7T,EAAGoI,EAAOA,EAAO1D,OAAS,GAAM,EAAKoP,EAAQ,KAGpH,MAAO1L,IAEX09B,EAAM1lC,UAAUsuC,SAAW,SAAUt1B,EAAGE,EAAG21B,GACvC,GAAIC,EACJ,IAAID,EAAY,CACZ,GAAI71B,EAAE,KAAOE,EAAE,GACX,MAAO,KAEX41B,IAAS51B,EAAE,GAAKF,EAAE,KAAOE,EAAE,GAAKF,EAAE,QAEjC,CACD,GAAIA,EAAE,KAAOE,EAAE,GACX,MAAO,KAEX41B,IAAS51B,EAAE,GAAKF,EAAE,KAAOE,EAAE,GAAKF,EAAE,IAEtC,MAAO81B,IAEXpJ,EAAM1lC,UAAUuuC,aAAe,SAAUjsC,EAAOgsC,GAC5C,MAAiB,QAAbA,EACOhsC,EAAM,GAEVA,EAAM,GAAKgsC,EAAWhsC,EAAM,IAEvCojC,EAAM1lC,UAAUmoC,6BAA+B,SAAU/kC,GACrD,GAAI48B,IAAWrgC,EAAGyD,EAAIpB,YAAY1C,OAAU8D,EAAIpB,YAAYxC,MAAQ,EAAII,EAAGwD,EAAIpB,YAAYzC,OAClF6D,EAAIpB,YAAYvC,OAAS,GAC9BgwB,GAAO9vB,EAAG2H,KAAKgR,IAAIlV,EAAI2P,eAAiB3P,EAAIpB,YAAY1C,OAAS0gC,EAAOrgC,GAAK2H,KAAKkR,IAAIpV,EAAI2P,eACrF3P,EAAIpB,YAAYzC,OAASygC,EAAOpgC,GAAKogC,EAAOrgC,EACjDC,EAAG0H,KAAKkR,IAAIpV,EAAI2P,eAAiB3P,EAAIpB,YAAY1C,OAAS0gC,EAAOrgC,GAAK2H,KAAKgR,IAAIlV,EAAI2P,eAC9E3P,EAAIpB,YAAYzC,OAASygC,EAAOpgC,GAAKogC,EAAOpgC,GACjD8vB,GAAO/vB,EAAG2H,KAAKgR,IAAIlV,EAAI2P,eAAiB3P,EAAIpB,YAAYkF,KAAO84B,EAAOrgC,GAAK2H,KAAKkR,IAAIpV,EAAI2P,eACnF3P,EAAIpB,YAAYzC,OAASygC,EAAOpgC,GAAKogC,EAAOrgC,EACjDC,EAAG0H,KAAKkR,IAAIpV,EAAI2P,eAAiB3P,EAAIpB,YAAYkF,KAAO84B,EAAOrgC,GAAK2H,KAAKgR,IAAIlV,EAAI2P,eAAiB3P,EAAIpB,YAAYzC,OAC5GygC,EAAOpgC,GAAKogC,EAAOpgC,GACzB+vB,GAAOhwB,EAAG2H,KAAKgR,IAAIlV,EAAI2P,eAAiB3P,EAAIpB,YAAY1C,OAAS0gC,EAAOrgC,GAAK2H,KAAKkR,IAAIpV,EAAI2P,eACrF3P,EAAIpB,YAAYmF,KAAO64B,EAAOpgC,GAAKogC,EAAOrgC,EAC/CC,EAAG0H,KAAKkR,IAAIpV,EAAI2P,eAAiB3P,EAAIpB,YAAY1C,OAAS0gC,EAAOrgC,GAAK2H,KAAKgR,IAAIlV,EAAI2P,eAAiB3P,EAAIpB,YAAYmF,KAC9G64B,EAAOpgC,GAAKogC,EAAOpgC,GACzBmvC,GAAOpvC,EAAG2H,KAAKgR,IAAIlV,EAAI2P,eAAiB3P,EAAIpB,YAAYkF,KAAO84B,EAAOrgC,GAAK2H,KAAKkR,IAAIpV,EAAI2P,eACnF3P,EAAIpB,YAAYmF,KAAO64B,EAAOpgC,GAAKogC,EAAOrgC,EAC/CC,EAAG0H,KAAKkR,IAAIpV,EAAI2P,eAAiB3P,EAAIpB,YAAYkF,KAAO84B,EAAOrgC,GAAK2H,KAAKgR,IAAIlV,EAAI2P,eAAiB3P,EAAIpB,YAAYmF,KAC5G64B,EAAOpgC,GAAKogC,EAAOpgC,EAC7BwD,GAAIs1B,oBAAsBv5B,KAAK+oC,cAAczY,EAAG9vB,EAAG8vB,EAAG7vB,EAAG8vB,EAAG/vB,EAAG+vB,EAAG9vB,GAClEwD,EAAIy1B,uBAAyB15B,KAAK+oC,cAAcvY,EAAGhwB,EAAGgwB,EAAG/vB,EAAGmvC,EAAGpvC,EAAGovC,EAAGnvC,GACrEwD,EAAIu1B,qBAAuBx5B,KAAK+oC,cAAczY,EAAG9vB,EAAG8vB,EAAG7vB,EAAG+vB,EAAGhwB,EAAGgwB,EAAG/vB,GACnEwD,EAAIw1B,sBAAwBz5B,KAAK+oC,cAAcxY,EAAG/vB,EAAG+vB,EAAG9vB,EAAGmvC,EAAGpvC,EAAGovC,EAAGnvC,GACpEwD,EAAIu1B,qBAAqBqW,UACzB5rC,EAAIw1B,sBAAsBoW,SAE1B,KAAS7qC,EAAI,EAAGA,EAAIf,EAAIs1B,oBAAoBp0B,OAAQH,IAChDf,EAAIs1B,oBAAoBv0B,GAAG2D,QAAU1E,EAAIs1B,oBAAoBv0B,GAAGxE,EAC5DR,KAAKD,OAAOqD,IAAIC,UAAYrD,KAAKD,OAAOqD,IAAIG,UAChDU,EAAIs1B,oBAAoBv0B,GAAG4D,QAAU3E,EAAIs1B,oBAAoBv0B,GAAGvE,EAC5DT,KAAKD,OAAOqD,IAAIE,SAAWtD,KAAKD,OAAOqD,IAAII,UAEnD,KAASwB,EAAI,EAAGA,EAAIf,EAAIy1B,uBAAuBv0B,OAAQH,IACnDf,EAAIy1B,uBAAuB10B,GAAG2D,QAAU1E,EAAIy1B,uBAAuB10B,GAAGxE,EAClER,KAAKD,OAAOqD,IAAIC,UAAYrD,KAAKD,OAAOqD,IAAIG,UAChDU,EAAIy1B,uBAAuB10B,GAAG4D,QAAU3E,EAAIy1B,uBAAuB10B,GAAGvE,EAClET,KAAKD,OAAOqD,IAAIE,SAAWtD,KAAKD,OAAOqD,IAAII,UAEnD,KAASwB,EAAI,EAAGA,EAAIf,EAAIu1B,qBAAqBr0B,OAAQH,IACjDf,EAAIu1B,qBAAqBx0B,GAAG2D,QAAU1E,EAAIu1B,qBAAqBx0B,GAAGxE,EAC9DR,KAAKD,OAAOqD,IAAIC,UAAYrD,KAAKD,OAAOqD,IAAIG,UAChDU,EAAIu1B,qBAAqBx0B,GAAG4D,QAAU3E,EAAIu1B,qBAAqBx0B,GAAGvE,EAC9DT,KAAKD,OAAOqD,IAAIE,SAAWtD,KAAKD,OAAOqD,IAAII,UAEnD,KAAK,GAAIwB,GAAI,EAAGA,EAAIf,EAAIw1B,sBAAsBt0B,OAAQH,IAClDf,EAAIw1B,sBAAsBz0B,GAAG2D,QAAU1E,EAAIw1B,sBAAsBz0B,GAAGxE,EAChER,KAAKD,OAAOqD,IAAIC,UAAYrD,KAAKD,OAAOqD,IAAIG,UAChDU,EAAIw1B,sBAAsBz0B,GAAG4D,QAAU3E,EAAIw1B,sBAAsBz0B,GAAGvE,EAChET,KAAKD,OAAOqD,IAAIE,SAAWtD,KAAKD,OAAOqD,IAAII,UAEnD,IAA6C,SAAzCxD,KAAKD,OAAOwC,YAAYsZ,MAAMgC,OAAmB,CACjD,GAAI/X,IAAWwP,oBAAqB,KACpCtV,MAAKD,OAAO+C,OAAO,aAAexB,KAAM,wBAAyBE,OAASyC,IAAKA,EAAK6B,OAAQA,IAC5F,IAAIwP,GAAsBxP,EAA4B,mBAClDwP,KACArR,EAAI01B,yBAA4Bn5B,EAAG2H,KAAKgR,IAAIlV,EAAI2P,eAAiB0B,EAAoB9U,EAAIqgC,EAAOrgC,GACxF2H,KAAKkR,IAAIpV,EAAI2P,eAAiB0B,EAAoB7U,EAAIogC,EAAOpgC,GAAKogC,EAAOrgC,EAC7EC,EAAG0H,KAAKkR,IAAIpV,EAAI2P,eAAiB0B,EAAoB9U,EAAIqgC,EAAOrgC,GAAK2H,KAAKgR,IAAIlV,EAAI2P,eAC3E0B,EAAoB7U,EAAIogC,EAAOpgC,GAAKogC,EAAOpgC,GACtDwD,EAAI01B,wBAAwBhxB,QAAU1E,EAAI01B,wBAAwBn5B,EAAIR,KAAKD,OAAOqD,IAAIC,UAClFrD,KAAKD,OAAOqD,IAAIG,UACpBU,EAAI01B,wBAAwB/wB,QAAU3E,EAAI01B,wBAAwBl5B,EAAIT,KAAKD,OAAOqD,IAAIE,SAClFtD,KAAKD,OAAOqD,IAAII,cAIhC+iC,EAAM1lC,UAAU0oC,8BAAgC,SAAUtlC,EAAK6B,GAC3D,GAAI3C,IAAUhD,OAAQ,EAAGC,OAAQ,EAAG2H,KAAM,EAAGC,KAAM,EAAG3H,MAAO,EAAGC,OAAQ,GACpEugC,GAAWrgC,EAAGyD,EAAIpB,YAAY1C,OAAU8D,EAAIpB,YAAYxC,MAAQ,EAAII,EAAGwD,EAAIpB,YAAYzC,OAClF6D,EAAIpB,YAAYvC,OAAS,GAC9BgwB,GAAO9vB,EAAG2H,KAAKgR,IAAIlV,EAAI2P,eAAiB3P,EAAIpB,YAAY1C,OAAS0gC,EAAOrgC,GAAK2H,KAAKkR,IAAIpV,EAAI2P,eACnF3P,EAAIpB,YAAYzC,OAASygC,EAAOpgC,GAAKogC,EAAOrgC,EACnDC,EAAG0H,KAAKkR,IAAIpV,EAAI2P,eAAiB3P,EAAIpB,YAAY1C,OAAS0gC,EAAOrgC,GAAK2H,KAAKgR,IAAIlV,EAAI2P,eAAiB3P,EAAIpB,YAAYzC,OAC9GygC,EAAOpgC,GAAKogC,EAAOpgC,GACzB8vB,GAAO/vB,EAAG2H,KAAKgR,IAAIlV,EAAI2P,eAAiB3P,EAAIpB,YAAYkF,KAAO84B,EAAOrgC,GAAK2H,KAAKkR,IAAIpV,EAAI2P,eACnF3P,EAAIpB,YAAYzC,OAASygC,EAAOpgC,GAAKogC,EAAOrgC,EACjDC,EAAG0H,KAAKkR,IAAIpV,EAAI2P,eAAiB3P,EAAIpB,YAAYkF,KAAO84B,EAAOrgC,GAAK2H,KAAKgR,IAAIlV,EAAI2P,eAAiB3P,EAAIpB,YAAYzC,OAC5GygC,EAAOpgC,GAAKogC,EAAOpgC,GACzB+vB,GAAOhwB,EAAG2H,KAAKgR,IAAIlV,EAAI2P,eAAiB3P,EAAIpB,YAAY1C,OAAS0gC,EAAOrgC,GAAK2H,KAAKkR,IAAIpV,EAAI2P,eACrF3P,EAAIpB,YAAYmF,KAAO64B,EAAOpgC,GAAKogC,EAAOrgC,EAC/CC,EAAG0H,KAAKkR,IAAIpV,EAAI2P,eAAiB3P,EAAIpB,YAAY1C,OAAS0gC,EAAOrgC,GAAK2H,KAAKgR,IAAIlV,EAAI2P,eAAiB3P,EAAIpB,YAAYmF,KAC9G64B,EAAOpgC,GAAKogC,EAAOpgC,GACzBmvC,GAAOpvC,EAAG2H,KAAKgR,IAAIlV,EAAI2P,eAAiB3P,EAAIpB,YAAYkF,KAAO84B,EAAOrgC,GAAK2H,KAAKkR,IAAIpV,EAAI2P,eACnF3P,EAAIpB,YAAYmF,KAAO64B,EAAOpgC,GAAKogC,EAAOrgC,EAC/CC,EAAG0H,KAAKkR,IAAIpV,EAAI2P,eAAiB3P,EAAIpB,YAAYkF,KAAO84B,EAAOrgC,GAAK2H,KAAKgR,IAAIlV,EAAI2P,eAC5E3P,EAAIpB,YAAYmF,KAAO64B,EAAOpgC,GAAKogC,EAAOpgC,EA8CnD,OA7CA0C,GAAMhD,OAASmwB,EAAG9vB,EAClB2C,EAAM/C,OAASkwB,EAAG7vB,EAClB0C,EAAM4E,KAAOuoB,EAAG9vB,EAChB2C,EAAM6E,KAAOsoB,EAAG7vB,EACZ0C,EAAMhD,OAASowB,EAAG/vB,IAClB2C,EAAMhD,OAASowB,EAAG/vB,GAElB2C,EAAMhD,OAASqwB,EAAGhwB,IAClB2C,EAAMhD,OAASqwB,EAAGhwB,GAElB2C,EAAMhD,OAASyvC,EAAGpvC,IAClB2C,EAAMhD,OAASyvC,EAAGpvC,GAElB2C,EAAM/C,OAASmwB,EAAG9vB,IAClB0C,EAAM/C,OAASmwB,EAAG9vB,GAElB0C,EAAM/C,OAASowB,EAAG/vB,IAClB0C,EAAM/C,OAASowB,EAAG/vB,GAElB0C,EAAM/C,OAASwvC,EAAGnvC,IAClB0C,EAAM/C,OAASwvC,EAAGnvC,GAElB0C,EAAM4E,KAAOwoB,EAAG/vB,IAChB2C,EAAM4E,KAAOwoB,EAAG/vB,GAEhB2C,EAAM4E,KAAOyoB,EAAGhwB,IAChB2C,EAAM4E,KAAOyoB,EAAGhwB,GAEhB2C,EAAM4E,KAAO6nC,EAAGpvC,IAChB2C,EAAM4E,KAAO6nC,EAAGpvC,GAEhB2C,EAAM6E,KAAOuoB,EAAG9vB,IAChB0C,EAAM6E,KAAOuoB,EAAG9vB,GAEhB0C,EAAM6E,KAAOwoB,EAAG/vB,IAChB0C,EAAM6E,KAAOwoB,EAAG/vB,GAEhB0C,EAAM6E,KAAO4nC,EAAGnvC,IAChB0C,EAAM6E,KAAO4nC,EAAGnvC,GAEpB0C,EAAM9C,MAAQ8C,EAAM4E,KAAO5E,EAAMhD,OACjCgD,EAAM7C,OAAS6C,EAAM6E,KAAO7E,EAAM/C,OAC9B0F,IACAA,EAAoB,YAAI3C,GAErBA,GAEJojC,KC1tFPuJ,EAA2B,WAC3B,QAASA,GAAU/vC,GACfC,KAAKoH,eAAgB,EACrBpH,KAAK+vC,YAAa,EAClB/vC,KAAKgwC,iBAAkB,EACvBhwC,KAAKwH,YACLxH,KAAKiwC,cAAgB,EACrBjwC,KAAKkwC,eAAkB7vC,MAAO,EAAGC,OAAQ,GACzCN,KAAKmwC,iBAAkB,EACvBnwC,KAAKD,OAASA,EACdC,KAAKY,mBA+zDT,MA7zDAkvC,GAAUjvC,UAAUC,QAAU,WACtBd,KAAKD,OAAOgB,aAGhBf,KAAKgB,uBAET8uC,EAAUjvC,UAAUD,iBAAmB,WACnCZ,KAAKD,OAAOkB,GAAG,YAAajB,KAAKgD,UAAWhD,MAC5CA,KAAKD,OAAOkB,GAAG,YAAajB,KAAKc,QAASd,OAE9C8vC,EAAUjvC,UAAUG,oBAAsB,WACtChB,KAAKD,OAAOoB,IAAI,YAAanB,KAAKgD,WAClChD,KAAKD,OAAOoB,IAAI,YAAanB,KAAKc,UAEtCgvC,EAAUjvC,UAAUmC,UAAY,SAAU5B,GAEtC,OADApB,KAAKowC,sBACGhvC,EAAKE,MACT,IAAK,cACDtB,KAAKqwC,YAAYjvC,EAAKI,MAAc,OACpC,MACJ,KAAK,YACDxB,KAAKswC,UAAUlvC,EAAKI,MAAiB,UACrC,MACJ,KAAK,4BACDxB,KAAKuwC,2BACL,MACJ,KAAK,aACDvwC,KAAKwwC,WAAWpvC,EAAKI,MAAkB,WAAGJ,EAAKI,MAAiB,UAChE,MACJ,KAAK,oBACDxB,KAAKywC,kBAAkBrvC,EAAKI,MAAiB,UAC7C,MACJ,KAAK,cACDxB,KAAK0wC,aACL,MACJ,KAAK,kBACD1wC,KAAK2wC,gBAAgBvvC,EAAKI,MAAa,MAAGJ,EAAKI,MAAa,MAC5D,MACJ,KAAK,gBACDxB,KAAK4wC,cAAcxvC,EAAKI,MAAa,MACrC,MACJ,KAAK,wBACDxB,KAAK6wC,sBAAsBzvC,EAAKI,MAAY,KAC5C,MACJ,KAAK,kBACDxB,KAAK8wC,gBAAgB1vC,EAAKI,MAAY,KACtC,MACJ,KAAK,YACDxB,KAAK+wC,UAAU3vC,EAAKI,MAAuB,gBAAGJ,EAAKI,MAAqB,cACxE,MACJ,KAAK,mBACDxB,KAAKgxC,iBAAiB5vC,EAAKI,MAAc,OACzC,MACJ,KAAK,WACDxB,KAAKixC,UACL,MACJ,KAAK,sBACDjxC,KAAKkxC,oBAAoB9vC,EAAKI,MAAiB,UAC/C,MACJ,KAAK,YACDxB,KAAKwG,WACL,MACJ,KAAK,MACDxG,KAAK2F,IAAIvE,EAAKI,MAAa,MAC3B,MACJ,KAAK,OACDxB,KAAK6c,KAAKzb,EAAKI,MAAkB,WAAGJ,EAAKI,MAAiB,UAC1D,MACJ,KAAK,mBACDxB,KAAKmxC,iBAAiB/vC,EAAKI,MAAc,OAAGJ,EAAKI,MAAY,KAAGJ,EAAKI,MAAW,IAChF,MACJ,KAAK,SACDxB,KAAK8T,OAAO1S,EAAKI,MAAc,OAAGJ,EAAKI,MAAW,IAClD,MACJ,KAAK,OACDxB,KAAK2oB,KAAKvnB,EAAKI,MAAiB,UAChC,MACJ,KAAK,SACDxB,KAAK0iB,QACL,MACJ,KAAK,mBACD1iB,KAAKoxC,iBAAiBhwC,EAAKI,MAAa,MAAGJ,EAAKI,MAAc,OAAGJ,EAAKI,MAAW,IACjF,MACJ,KAAK,kBACDxB,KAAKqxC,gBAAgBjwC,EAAKI,MAAiB,UAAGJ,EAAKI,MAAW,IAC9D,MACJ,KAAK,aACDJ,EAAKI,MAAW,IAAW,QAAIxB,KAAK0iC,OACpC,MACJ,KAAK,aACD1iC,KAAK0iC,QAAUthC,EAAKI,MAAa,KACjC,MACJ,KAAK,iBACDJ,EAAKI,MAAW,IAAe,YAAIxB,KAAKyiC,WACxC,MACJ,KAAK,iBACDziC,KAAKyiC,YAAcrhC,EAAKI,MAAa,KACrC,MACJ,KAAK,iBACDxB,KAAKoH,cAAgBhG,EAAKI,MAAqB,aAC/C,MACJ,KAAK,gBACDxB,KAAK+vC,WAAa3uC,EAAKI,MAAY,IACnC,MACJ,KAAK,0BACDxB,KAAKsxC,cAAgBlwC,EAAKI,MAAa,MACvCxB,KAAKsxC,cAAcnxC,QAAUH,KAAKD,OAAOiG,QAAQsB,iBAAiB9G,EAClER,KAAKsxC,cAAclxC,QAAUJ,KAAKD,OAAOiG,QAAQsB,iBAAiB7G,CAClE,MACJ,KAAK,mBACDT,KAAKgwC,gBAAkB5uC,EAAKI,MAAY,IACxC,MACJ,KAAK,cACDJ,EAAKI,MAAW,IAAY,SAAIxB,KAAKwH,QACrC,MACJ,KAAK,cACDxH,KAAKwH,SAAWpG,EAAKI,MAAgB,QACrC,MACJ,KAAK,uBACDJ,EAAKI,MAAW,IAAqB,kBAAIxB,KAAKiwC,aAC9C,MACJ,KAAK,uBACDjwC,KAAKiwC,cAAgB7uC,EAAKI,MAAyB,iBACnD,MACJ,KAAK,mBACDJ,EAAKI,MAAW,IAAiB,cAAIxB,KAAKkwC,aAC1C,MACJ,KAAK,mBACDlwC,KAAKkwC,cAAc7vC,MAAQe,EAAKI,MAAa,MAC7CxB,KAAKkwC,cAAc5vC,OAASc,EAAKI,MAAc,MAC/C,MACJ,KAAK,mBACDJ,EAAKI,MAAW,IAAQ,KAAIxB,KAAKmwC,eACjC,MACJ,KAAK,mBACDnwC,KAAKmwC,gBAAkB/uC,EAAKI,MAAY,IACxC,MACJ,KAAK,QACDxB,KAAKkC,UAIjB4tC,EAAUjvC,UAAUsB,cAAgB,WAChC,MAAO,aAEX2tC,EAAUjvC,UAAUuvC,oBAAsB,WAClCpwC,KAAKD,OAAOqC,cACZpC,KAAKqC,aAAerC,KAAKD,OAAOqC,YAAYE,WAAW,OAEvDtC,KAAKD,OAAOwC,cACZvC,KAAKwC,aAAexC,KAAKD,OAAOwC,YAAYD,WAAW,QAG/DwtC,EAAUjvC,UAAUqB,MAAQ,WACxBlC,KAAKuxC,YAAc,KACnBvxC,KAAKyiC,YAAc,KACnBziC,KAAK0iC,QAAU,KACf1iC,KAAK+vC,YAAa,EAClB/vC,KAAKsxC,cAAgB,KACrBtxC,KAAKgwC,iBAAkB,EACvBhwC,KAAKwH,YACLxH,KAAKwxC,aAAe,KACpBxxC,KAAKiwC,cAAgB,EACrBjwC,KAAKmwC,iBAAkB,GAE3BL,EAAUjvC,UAAUwvC,YAAc,SAAUptC,GACxC,GAAIsI,GAAQvL,KACRD,EAASC,KAAKD,OACd8L,GAAmBC,QAAQ,EAAO2lC,eAAgB1xC,EAAOiD,UAAUC,OACnEyuC,cAA8D,MAA/CvpC,KAAKC,IAAIrI,EAAOiD,UAAUC,OAASA,GAAkB,EAAIlD,EAAOiD,UAAUC,OAASA,IACjGjD,KAAKmwC,iBAAmBjkC,cAAcnM,EAAOoM,SAAiD,IAAvCpM,EAAOoM,OAAOwlC,SAASvlC,YAE/ErM,EAAOsM,UAAUC,kBAAkB,mBAAoB,WAAYT,GAAgBU,KAAK,SAAUnL,GAC9FmK,EAAMqmC,YAAYxwC,EAAM6B,MAIvBjD,KAAKmwC,iBACNpwC,EAAO0M,QAAQ,WAAYZ,GAE/B7L,KAAK4xC,YAAY/lC,EAAgB5I,KAGzC6sC,EAAUjvC,UAAU+wC,YAAc,SAAU/lC,EAAgB5I,GACxD,GAAIlD,GAASC,KAAKD,MAClB,KAAK8L,EAAeC,OAAQ,CACxB,GAAIiB,OAAU,EACd,IAAI9K,oBAAkBjC,KAAKwxC,cAAe,CACtC,GAAI1rC,IAAWC,WACfhG,GAAO+C,OAAO,UAAYxB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAASsE,OAAQA,MAC3FiH,EAAUjH,EAAgB,SAClBZ,QAAUlB,YAAWjE,EAAOmF,QAAS,MAAM,GACnD6H,EAAQ9F,UAAYjD,YAAWjE,EAAOkH,UAAW,MAAM,GACvD8F,EAAQlH,iBAAmB7B,YAAWjE,EAAO8F,qBAAsB,EACnE,IAAIuZ,IAAoBhW,aAAc,KACtCrJ,GAAO+C,OAAO,iBAAmBxB,KAAM,kBAAmByB,kBAAkB,EACxEvB,OAASyC,IAAKmb,KAClBrS,EAAQ3D,aAAepF,YAAWob,EAA8B,iBAAO,GAE3Erf,EAAO8F,iBAAiBI,KAAgB,KAAXhD,EAAgB,cAAgB,aAC7D,IAAIyJ,MACAmlC,MAAiB,EACjB9xC,GAAO6C,UAAUC,aAAe9C,EAAO6C,UAAUwC,YAClBqO,KAA3B1T,EAAO6C,UAAUwC,QACjBsH,EAAa3M,EAAO6C,UAAUwC,MAAMuH,MAAM,OAE1C5M,EAAO0F,YAAYC,cAAkC,SAAlBgH,EAAW,MAC9CmlC,EAAiB9xC,EAAO0F,YAAYC,aAAe,SAAWgH,EAAW,GACzE3M,EAAO+C,OAAO,SAAWxB,KAAM,uBAAwByB,kBAAkB,IACzEhD,EAAOmF,QAAQe,KAAKlG,EAAO6C,WAC3B7C,EAAO+C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,MAG7EhD,EAAO+C,OAAO,SAAWxB,KAAM,eAAgByB,kBAAkB,EAC7DvB,OAAShB,EAAG,KAAMC,EAAG,KAAM8a,aAAa,KAC5Cvb,KAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOwC,YAAYlC,MAAON,EAAOwC,YAAYjC,QAC/EN,KAAKgxC,iBAAiB/tC,GACtBlD,EAAO+C,OAAO,QAAUxB,KAAM,iBAAkByB,kBAAkB,IAClEhD,EAAO+C,OAAO,QAAUxB,KAAM,mBAAoByB,kBAAkB,EAAOvB,OAAS+D,QAASvF,KAAKqC,gBAClGtC,EAAO+C,OAAO,QAAUxB,KAAM,mBAAoByB,kBAAkB,EAAOvB,OAAS+D,QAASvF,KAAKwC,gBAC9FzC,EAAOyF,cACPzF,EAAO+C,OAAO,QAAUxB,KAAM,aAAcyB,kBAAkB,EAC1DvB,OAAS+D,QAASvF,KAAKqC,aAAc+H,OAAQ,KAAMC,OAAQ,QAE/DwnC,IACA7xC,KAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOwC,YAAYlC,MAAON,EAAOwC,YAAYjC,QAC/EP,EAAO6C,UAAYoB,YAAWjE,EAAOmF,QAAQnF,EAAOmF,QAAQC,OAAS,OAAQ,GAC7EpF,EAAOmF,QAAQwB,MACf3G,EAAO+C,OAAO,QAAUxB,KAAM,aAAcyB,kBAAkB,EAAOvB,OAAS6D,OAAQ,YAAapB,IAAKlE,EAAO6C,cAEnH7C,EAAOmH,YAAa,CACpB,IAAIjD,IAAQqK,WAAYvO,EAAOuG,eAC/BvG,GAAO+C,OAAO,SAAWxB,KAAM,sBAAuByB,kBAAkB,EACpEvB,OAAS8M,WAAYvO,EAAOuG,eAAgBiI,wBAAwB,EAAMtK,IAAKA,KACnFlE,EAAOuG,eAAiBrC,EAAgB,WACpClE,EAAOiG,QAAQpD,UAAUwC,QAAUpF,KAAKmwC,kBACxCnwC,KAAKmwC,iBAAkB,EACvBpwC,EAAOuR,OAAO,UACdtR,KAAKmwC,iBAAkB,EACvBpwC,EAAOiN,eAAgBC,cAAgBpJ,WAAY,KAAO,GAC1D7D,KAAKiwC,cAAgBlwC,EAAOkN,aAAapJ,cAIrDisC,EAAUjvC,UAAUmwC,iBAAmB,SAAU/tC,GAC7C,GAAIlD,GAASC,KAAKD,MACH,KAAXkD,EACAlD,EAAOiD,UAAUC,OAAS,EAG1BlD,EAAOiD,UAAUC,QAAUA,EAEW,MAAtCkF,KAAKC,IAAIrI,EAAOiD,UAAUC,UAC1BlD,EAAOiD,UAAUC,OAAS,GAE9BlD,EAAO+C,OAAO,QAAUxB,KAAM,gBAAiByB,kBAAkB,GACjE,IAAIse,GAAcrd,YAAWjE,EAAOmF,YAAa,GAC7Coc,EAAgBtd,YAAWjE,EAAO6C,cAAe,EAqBrD,IApBA7C,EAAOmF,WACPnF,EAAO+C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,IAChE/C,KAAKgwC,iBACNjwC,EAAO+C,OAAO,QAAUxB,KAAM,uBAAwByB,kBAAkB,EACpEvB,OAASmF,KAAM,UAAWgB,qBAAsB,KAAMwT,YAAa,QAE3Enb,KAAK8xC,aAAa7uC,GACbjD,KAAKgwC,kBACNjwC,EAAO+C,OAAO,QAAUxB,KAAM,uBAAwByB,kBAAkB,EACpEvB,OAASmF,KAAM,UAAWgB,qBAAsB,KAAMwT,YAAa,QACvEpb,EAAOuG,eAAeL,KAAKhD,IAE/BlD,EAAOmF,QAAUlB,YAAWqd,MAAiB,GAC7CthB,EAAO6C,UAAYoB,YAAWsd,MAAmB,GAC7CvhB,EAAOyF,cACPzF,EAAO+C,OAAO,QAAUxB,KAAM,aAAcyB,kBAAkB,EAC1DvB,OAAS+D,QAASvF,KAAKqC,aAAc+H,OAAQ,KAAMC,OAAQ,QAEnEtK,EAAO+C,OAAO,SAAWxB,KAAM,YAAayB,kBAAkB,EAAOvB,OAASyB,OAAQA,KACtFlD,EAAO+C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,IACjEE,EAAS,EACTlD,EAAO+C,OAAO,iBAAmBxB,KAAM,gBAAiByB,kBAAkB,QAG1E,KAAK,GAAIiC,GAAI,EAAGA,EAAI,EAAGA,IACnBjF,EAAO+C,OAAO,iBAAmBxB,KAAM,gBAAiByB,kBAAkB,GAGlFhD,GAAO+C,OAAO,iBAAmBxB,KAAM,iBAAkByB,kBAAkB,EACvEvB,OAAS+D,QAASvF,KAAKqC,aAAcwG,OAAQ,QACjD7I,KAAK+xC,yBAAyB9uC,IAElC6sC,EAAUjvC,UAAUixC,aAAe,SAAU7uC,GACzC,GAAIlD,GAASC,KAAKD,MAClBC,MAAKqC,aAAagW,OAClBrY,KAAKqC,aAAa8B,UAAU,EAAG,EAAGpE,EAAOqC,YAAY/B,MAAON,EAAOqC,YAAY9B,QAC/EN,KAAKqC,aAAawR,UAAU9T,EAAOqC,YAAY/B,MAAQ,EAAGN,EAAOqC,YAAY9B,OAAS,GACtFN,KAAKqC,aAAayR,OAAO3L,KAAKyC,GAAK,IAAM3H,GACzCjD,KAAKqC,aAAawR,WAAW9T,EAAOqC,YAAY/B,MAAQ,GAAIN,EAAOqC,YAAY9B,OAAS,EACxF,IAAIoE,GAAO1E,KAAKqC,aAAasC,MAC7B3E,MAAKD,OAAO+C,OAAO,UAAYxB,KAAM,qBAAsByB,kBAAkB,IAC7E/C,KAAKqC,aAAauC,UAAU5E,KAAKD,OAAO8E,QAAS7E,KAAKD,OAAOqD,IAAIgB,QAASpE,KAAKD,OAAOqD,IAAIiB,OAAQrE,KAAKD,OAAOqD,IAAIkB,SAAUtE,KAAKD,OAAOqD,IAAImB,UAAWvE,KAAKD,OAAOqD,IAAIC,SAAUrD,KAAKD,OAAOqD,IAAIE,QAAStD,KAAKD,OAAOqD,IAAIG,UAAWvD,KAAKD,OAAOqD,IAAII,YACrPxD,KAAKqC,aAAasC,OAASD,EAC3B1E,KAAKqC,aAAawR,UAAU9T,EAAOqC,YAAY/B,MAAQ,EAAGN,EAAOqC,YAAY9B,OAAS,GACtFN,KAAKqC,aAAayR,OAAO3L,KAAKyC,GAAK,KAAO3H,GAC1CjD,KAAKqC,aAAawR,WAAW9T,EAAOqC,YAAY/B,MAAQ,GAAIN,EAAOqC,YAAY9B,OAAS,GACxFN,KAAKqC,aAAa0I,WAEtB+kC,EAAUjvC,UAAUkxC,yBAA2B,SAAU9uC,GACrD,GAAIlD,GAASC,KAAKD,MAClB,IAAIA,EAAOgE,oBAAsB/D,KAAKsxC,cAAe,CACjD,GAAI1uC,GAAYoB,YAAWjE,EAAO6C,cAAe,GAC7CsC,EAAUlB,YAAWjE,EAAOmF,YAAa,GACzCyc,GAAcxhB,OAAQJ,EAAOqD,IAAIgB,QAAShE,OAAQL,EAAOqD,IAAIiB,OAAQhE,MAAON,EAAOqD,IAAIkB,SACvFhE,OAAQP,EAAOqD,IAAImB,WACnB4E,GAAehJ,OAAQJ,EAAOqD,IAAIC,SAAUjD,OAAQL,EAAOqD,IAAIE,QAASjD,MAAON,EAAOqD,IAAIG,UAC1FjD,OAAQP,EAAOqD,IAAII,WACvBzD,GAAOmF,WACPnF,EAAOmF,QAAQe,KAAKjC,YAAWjE,EAAOgE,uBAAwB,IAC1D9B,oBAAkBlC,EAAOmF,QAAQ,GAAG4C,cACpC/H,EAAO6C,UAAY7C,EAAOmF,QAAQ,GAClCnF,EAAO+C,OAAO,SAAWxB,KAAM,uBAAwByB,kBAAkB,IACzEhD,EAAOmF,QAAQ,GAAKnF,EAAO6C,WAE/B7C,EAAOqD,IAAIgB,QAAU,EACrBrE,EAAOqD,IAAIiB,OAAS,EACpBtE,EAAOqD,IAAIkB,SAAWvE,EAAO8E,QAAQxE,MACrCN,EAAOqD,IAAImB,UAAYxE,EAAO8E,QAAQvE,OACtCP,EAAOqD,IAAIC,SAAWrD,KAAKsxC,cAAcnxC,OACzCJ,EAAOqD,IAAIE,QAAUtD,KAAKsxC,cAAclxC,OACxCL,EAAOqD,IAAIG,UAAYvD,KAAKsxC,cAAcjxC,MAC1CN,EAAOqD,IAAII,WAAaxD,KAAKsxC,cAAchxC,OACnB,qBACpBP,EAAO+C,OAAO,QAAUxB,KAAM,gBAAiByB,kBAAkB,IACjEhD,EAAO+C,OAAO,QAAUxB,KAAM,oBAAqByB,kBAAkB,EACjEvB,OAAS4Z,mBAAoB,SAErCrb,EAAO+C,OAAO,SAAWxB,KAAM,YAAayB,kBAAkB,EAAOvB,OAASyB,OAAQA,KACtFlD,EAAOgE,mBAAqBC,YAAWjE,EAAOmF,QAAQ,OAAQ,GAC9DlF,KAAKsxC,eAAkBnxC,OAAQJ,EAAOqD,IAAIC,SAAUjD,OAAQL,EAAOqD,IAAIE,QAASjD,MAAON,EAAOqD,IAAIG,UAC9FjD,OAAQP,EAAOqD,IAAII,YACvBzD,EAAOmF,QAAUA,EACjBnF,EAAO6C,UAAYA,EACnB7C,EAAOqD,IAAIgB,QAAUud,EAAUxhB,OAC/BJ,EAAOqD,IAAIiB,OAASsd,EAAUvhB,OAC9BL,EAAOqD,IAAIkB,SAAWqd,EAAUthB,MAChCN,EAAOqD,IAAImB,UAAYod,EAAUrhB,OACjCP,EAAOqD,IAAIC,SAAW8F,EAAWhJ,OACjCJ,EAAOqD,IAAIE,QAAU6F,EAAW/I,OAChCL,EAAOqD,IAAIG,UAAY4F,EAAW9I,MAClCN,EAAOqD,IAAII,WAAa2F,EAAW7I,SAG3CwvC,EAAUjvC,UAAUyvC,UAAY,SAAUzpC,GACtC,GAAI0E,GAAQvL,KACRD,EAASC,KAAKD,OACd8L,GAAmBhF,UAAWA,EAAWiF,QAAQ,EACjDkmC,kBAAmBjyC,EAAO+G,aAAa/G,EAAOiD,UAAUU,iBACvD1D,KAAKmwC,iBAAmBjkC,cAAcnM,EAAOoM,SAAiD,IAAvCpM,EAAOoM,OAAO8lC,SAAS7lC,YAE/ErM,EAAOsM,UAAUC,kBAAkB,iBAAkB,SAAUT,GAAgBU,KAAK,SAAUnL,GAC1FmK,EAAM2mC,UAAU9wC,EAAMyF,MAIrB7G,KAAKmwC,iBACNpwC,EAAO0M,QAAQ,WAAYZ,GAE/B7L,KAAKkyC,UAAUrmC,EAAgBhF,KAGvCipC,EAAUjvC,UAAUqxC,UAAY,SAAUrmC,EAAgBhF,GACtD,GAAI9G,GAASC,KAAKD,MAClB,KAAI8L,EAAeC,OAAnB,CAGA,GAAIiB,EACJ,IAAI9K,oBAAkBjC,KAAKwxC,cAAe,CACtC,GAAI1rC,IAAWC,WACfhG,GAAO+C,OAAO,UAAYxB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAASsE,OAAQA,MAC3FiH,EAAUjH,EAAgB,SAClBZ,QAAUlB,YAAWjE,EAAOmF,QAAS,MAAM,GACnD6H,EAAQ9F,UAAYjD,YAAWjE,EAAOkH,UAAW,MAAM,GACvD8F,EAAQlH,iBAAmB7B,YAAWjE,EAAO8F,qBAAsB,EACnE,IAAIuZ,IAAoBhW,aAAc,KACtCrJ,GAAO+C,OAAO,iBAAmBxB,KAAM,kBAAmByB,kBAAkB,EACxEvB,OAASyC,IAAKmb,KAClBrS,EAAQ3D,aAAepF,YAAWob,EAA8B,iBAAO,GAE3Erf,EAAO8F,iBAAiBI,KAAiC,eAA5BY,EAAU+L,cAAiC,iBAAmB,eAC3F,IACIi/B,GADAnlC,IAEA3M,GAAO6C,UAAUC,kBACc4Q,KAA3B1T,EAAO6C,UAAUwC,QACjBsH,EAAa3M,EAAO6C,UAAUwC,MAAMuH,MAAM,OAE1C5M,EAAO0F,YAAYC,cAAkC,SAAlBgH,EAAW,MAC9CmlC,EAAiB9xC,EAAO0F,YAAYC,aAAe,SAAWgH,EAAW,GACzE3M,EAAO+C,OAAO,SAAWxB,KAAM,uBAAwByB,kBAAkB,IACzEhD,EAAOmF,QAAQe,KAAKlG,EAAO6C,WAC3B7C,EAAO+C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,MAG7EhD,EAAO+C,OAAO,SAAWxB,KAAM,eAAgByB,kBAAkB,EAC7DvB,OAAShB,EAAG,KAAMC,EAAG,KAAM8a,aAAa,KAC5Cxb,EAAOiiB,aAAahiB,KAAKqC,cACzBtC,EAAOiiB,aAAahiB,KAAKwC,aACzB,IAAI6e,GAAcrd,YAAWjE,EAAOmF,YAAa,GAC7Coc,EAAgBtd,YAAWjE,EAAO6C,cAAe,EACrD7C,GAAOmF,WACPnF,EAAO+C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,IAChE/C,KAAKoH,eACNrH,EAAO+C,OAAO,QAAUxB,KAAM,uBAAwByB,kBAAkB,EACpEvB,OAASmF,KAAM,UAAWgB,qBAAsB,KAAMwT,YAAa,OAE3E,IAAIg3B,GAAqBtrC,EAAU+L,aACnC5S,MAAKoyC,gBAAgBD,GAEjBpyC,EAAOiD,UAAUU,cADM,eAAvByuC,EACmF,eAAjDpyC,EAAOiD,UAAUU,cAAckP,cAAkC,GAAK,aAGrB,aAAjD7S,EAAOiD,UAAUU,cAAckP,cAAgC,GAAK,UAE1G,IAAIy/B,IAAWjf,WAAY,KAC3BrzB,GAAO+C,OAAO,QAAUxB,KAAM,8BAA+ByB,kBAAkB,EAAOvB,OAAS4E,KAAMisC,KACjGA,EAAmB,aACnBtyC,EAAOqD,IAAIC,UAAYtD,EAAOsH,SAAS4B,yBAAyBzI,EAChET,EAAOqD,IAAIE,SAAWvD,EAAOsH,SAAS4B,yBAAyBxI,EAEnE,IAAIiE,GAAO1E,KAAKqC,aAAasC,MAY7B,IAXA5E,EAAO+C,OAAO,UAAYxB,KAAM,qBAAsByB,kBAAkB,IACxE/C,KAAKqC,aAAauC,UAAU7E,EAAO8E,QAAS9E,EAAOqD,IAAIgB,QAASrE,EAAOqD,IAAIiB,OAAQtE,EAAOqD,IAAIkB,SAAUvE,EAAOqD,IAAImB,UAAWxE,EAAOqD,IAAIC,SAAUtD,EAAOqD,IAAIE,QAASvD,EAAOqD,IAAIG,UAAWxD,EAAOqD,IAAII,YACxMxD,KAAKqC,aAAasC,OAASD,EAC3B3E,EAAO+C,OAAO,QAAUxB,KAAM,iBAAkByB,kBAAkB,IAClE/C,KAAKoyC,gBAAgBvrC,EAAU+L,eAC1B5S,KAAKoH,gBACNrH,EAAO+C,OAAO,QAAUxB,KAAM,uBAAwByB,kBAAkB,EACpEvB,OAASmF,KAAM,UAAWgB,qBAAsB,KAAMwT,YAAa,QACvEnb,KAAKsyC,eAAezrC,EAAU0rC,qBAC9BxyC,EAAOuG,eAAeL,KAAKY,EAAU+L,gBAEJ,IAAjC7S,EAAOuG,eAAenB,OAAc,CACpC,GAAIkJ,IAAW/C,UAAW,GAC1BvL,GAAO+C,OAAO,QAAUxB,KAAM,mBAAoByB,kBAAkB,EAChEvB,OAAS6M,OAAQA,KACO,KAAxBA,EAAkB,UAClBtO,EAAO+C,OAAO,QAAUxB,KAAM,oBAAqByB,kBAAkB,EACjEvB,OAAS4Z,mBAAoB,QAGjCpb,KAAKuwC,4BAGTxwC,EAAOyF,cACPzF,EAAO+C,OAAO,QAAUxB,KAAM,aAAcyB,kBAAkB,EAC1DvB,OAAS+D,QAASvF,KAAKqC,aAAc+H,OAAQ,KAAMC,OAAQ,QAEnEtK,EAAOmF,QAAUlB,YAAWqd,MAAiB,GAC7CthB,EAAO6C,UAAYoB,YAAWsd,MAAmB,EACjD,KAAK,GAAItc,GAAI,EAAGC,EAAMlF,EAAOmF,QAAQC,OAAQH,EAAIC,EAAKD,IAAK,CACvD,GAAI+S,GAAchY,EAAOmF,QAAQF,GAAG+S,WACT,KAAvBA,EAAY5S,OACZ4S,EAAY9R,KAAKY,GAEZkR,EAAYA,EAAY5S,OAAS,KAAO0B,EAC7CkR,EAAYrR,MAGZqR,EAAY9R,KAAKY,GAGzB9G,EAAO+C,OAAO,SAAWxB,KAAM,YAAayB,kBAAkB,EAAOvB,OAASyB,OAAQ4D,EAAU+L,gBAChG,IAAInD,GAAazP,KAAKqC,aAAasC,MACnC3E,MAAKqC,aAAasC,OAAS,uHAE3B5E,EAAO+C,OAAO,SAAWxB,KAAM,iBAAkByB,kBAAkB,IACnC,eAA5B8D,EAAU+L,eAA8D,aAA5B/L,EAAU+L,eACtD7S,EAAO+C,OAAO,iBAAmBxB,KAAM,cAAeyB,kBAAkB,EACpEvB,OAASA,MAAOqF,EAAU+L,iBAC9B7S,EAAO+C,OAAO,iBAAmBxB,KAAM,iBAAkByB,kBAAkB,EACvEvB,OAAS+D,QAASvF,KAAKqC,aAAcwG,OAAQ,SAGjD9I,EAAO+C,OAAO,iBAAmBxB,KAAM,iBAAkByB,kBAAkB,EACvEvB,OAAS+D,QAASvF,KAAKqC,aAAcwG,OAAQ,QAErD7I,KAAKqC,aAAasC,OAAS8K,EAC3B1P,EAAO+C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,IACrE/C,KAAK+xC,yBAAyBlrC,EAAU+L,eACxC7S,EAAOmH,YAAa,EACpBnH,EAAO+C,OAAO,QAAUxB,KAAM,mBAAoByB,kBAAkB,EAAOvB,OAAS+D,QAASvF,KAAKqC,gBAClGtC,EAAO+C,OAAO,QAAUxB,KAAM,mBAAoByB,kBAAkB,EAAOvB,OAAS+D,QAASvF,KAAKwC,gBAC9FzC,EAAOyF,cACPzF,EAAO+C,OAAO,QAAUxB,KAAM,aAAcyB,kBAAkB,EAC1DvB,OAAS+D,QAASvF,KAAKqC,aAAc+H,OAAQ,KAAMC,OAAQ,QAE/DwnC,IACA7xC,KAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOwC,YAAYlC,MAAON,EAAOwC,YAAYjC,QAC/EP,EAAO6C,UAAYoB,YAAWjE,EAAOmF,QAAQnF,EAAOmF,QAAQC,OAAS,OAAQ,GAC7EpF,EAAOmF,QAAQwB,MACf3G,EAAO+C,OAAO,QAAUxB,KAAM,aAAcyB,kBAAkB,EAAOvB,OAAS6D,OAAQ,YAAapB,IAAKlE,EAAO6C,aAEnH,IAAIqB,IAAQqK,WAAYvO,EAAOuG,eAC/BvG,GAAO+C,OAAO,SAAWxB,KAAM,sBAAuByB,kBAAkB,EACpEvB,OAAS8M,WAAYvO,EAAOuG,eAAgBiI,wBAAwB,EAAMtK,IAAKA,KACnFlE,EAAOuG,eAAiBrC,EAAgB,WACpClE,EAAOiG,QAAQpD,UAAUwC,QAAUpF,KAAKmwC,kBACxCnwC,KAAKmwC,iBAAkB,EACvBpwC,EAAOuR,OAAO,UACdtR,KAAKmwC,iBAAkB,EACvBpwC,EAAOiN,eAAgBC,cAAgBpJ,WAAY,KAAO,GAC1D7D,KAAKiwC,cAAgBlwC,EAAOkN,aAAapJ,cAGjDisC,EAAUjvC,UAAUuxC,gBAAkB,SAAUvrC,GAC5C,GAAI5D,GAASjD,KAAKD,OAAOiD,UAAUC,MACjB,gBAAd4D,EACI5D,EAAS,IAAO,GAAKA,EAAS,KAAQ,EACtCjD,KAAKwyC,eAGLxyC,KAAKyyC,iBAGU,aAAd5rC,IACD5D,EAAS,IAAO,GAAKA,EAAS,KAAQ,EACtCjD,KAAKyyC,iBAGLzyC,KAAKwyC,iBAIjB1C,EAAUjvC,UAAU4xC,eAAiB,WACjCzyC,KAAKqC,aAAawR,UAAU7T,KAAKqC,aAAagD,OAAOhF,MAAO,GAC5DL,KAAKqC,aAAasY,OAAO,EAAG,GAC5B3a,KAAKwC,aAAaqR,UAAU7T,KAAKwC,aAAa6C,OAAOhF,MAAO,GAC5DL,KAAKwC,aAAamY,OAAO,EAAG,IAEhCm1B,EAAUjvC,UAAU2xC,aAAe,WAC/BxyC,KAAKqC,aAAawR,UAAU,EAAG7T,KAAKqC,aAAagD,OAAO/E,QACxDN,KAAKqC,aAAasY,MAAM,GAAI,GAC5B3a,KAAKwC,aAAaqR,UAAU,EAAG7T,KAAKwC,aAAa6C,OAAO/E,QACxDN,KAAKwC,aAAamY,MAAM,GAAI,IAEhCm1B,EAAUjvC,UAAUyxC,eAAiB,SAAUzrC,GAC3C,IAAI7G,KAAKmwC,kBAGoB,IAAzBnwC,KAAKwH,SAASrC,QAAgBnF,KAAKwH,SAASxH,KAAKwH,SAASrC,OAAS,KAAO0B,EAC1E7G,KAAKwH,SAASvB,KAAKY,GAGnB7G,KAAKwH,SAASd,MAEd1G,KAAKwH,SAASrC,QAAU,GAAG,CAC3B,GAAIutC,GAAgB1yC,KAAKwH,SAASkd,OAAO,IACf,eAArBguB,EAAc,IAA4C,aAArBA,EAAc,IAC/B,eAArBA,EAAc,IAA4C,aAArBA,EAAc,IAC7B,aAArBA,EAAc,IAA0C,eAArBA,EAAc,IACzB,aAArBA,EAAc,IAA0C,eAArBA,EAAc,KACrD1yC,KAAKwH,SAAS26B,QAAQ,KAIlC2N,EAAUjvC,UAAU0vC,0BAA4B,WAC5C,GAAIxwC,GAASC,KAAKD,OACdsO,GAAW/C,UAAW,GAC1BvL,GAAO+C,OAAO,QAAUxB,KAAM,mBAAoByB,kBAAkB,EAChEvB,OAAS6M,OAAQA,KACO,KAAxBA,EAAkB,YACU,eAAxBA,EAAkB,UAClBtO,EAAOqD,IAAIC,SAAWtD,EAAOqC,YAAYoC,aAAezE,EAAOqD,IAAIG,UAAYxD,EAAOqD,IAAIC,UAE7D,aAAxBgL,EAAkB,UACvBtO,EAAOqD,IAAIE,QAAUvD,EAAOqC,YAAYqC,cAAgB1E,EAAOqD,IAAII,WAAazD,EAAOqD,IAAIE,UAG3FvD,EAAOqD,IAAIC,SAAWtD,EAAOqC,YAAYoC,aAAezE,EAAOqD,IAAIG,UAAYxD,EAAOqD,IAAIC,UAC1FtD,EAAOqD,IAAIE,QAAUvD,EAAOqC,YAAYqC,cAAgB1E,EAAOqD,IAAII,WAAazD,EAAOqD,IAAIE,YAIvGwsC,EAAUjvC,UAAU2vC,WAAa,SAAU3sC,EAAYsD,GACnD,GAAIoE,GAAQvL,KACRD,EAASC,KAAKD,MAClB,KAAKA,EAAOyL,UAAYzL,EAAO0L,cAAe,CAC1C,GAAI1L,EAAOkN,aAAapJ,YAAc9D,EAAOkN,aAAasY,eAAiB1hB,EAAa,GACnF9D,EAAOkN,aAAapJ,WAAa9D,EAAOkN,aAAa0lC,eAAiB9uC,EAAa,GAAK7D,KAAKywC,mBAAkB,IAC/G1wC,EAAOkN,aAAapJ,YAAc9D,EAAOkN,aAAa0lC,eAAiB9uC,EAAa,EAIrF,YAHKqI,cACDnM,EAAO+C,OAAO,WAAaxB,KAAM,kBAAmByB,kBAAkB,IAI9EhD,GAAO+C,OAAO,QAAUxB,KAAM,iBAAkByB,kBAAkB,GAClE,IAAIa,GAAiBC,CACrBA,GAAaD,EAAiB,EAAI,IAAO,EACzC,KAAK,GAAIoB,GAAI,EAAGA,EAAImD,KAAKC,IAAIxE,EAAiB,IAAMoB,IAChD,GAA2B,IAAvBhF,KAAKiwC,cACLjwC,KAAKiwC,eAAiBpsC,EAAa,EAAiB,GAAbA,EAAgC,GAAbA,EAAmB,OAE5E,IAAI7D,KAAKiwC,cAAgB,EAC1BjwC,KAAKiwC,eAA+B,GAAbpsC,MAEtB,IAAI7D,KAAKiwC,cAAgB,EAAG,CAC7BjwC,KAAKiwC,eAA+B,GAAbpsC,EAAmB,EAC1C,IAAI+uC,GAAazqC,KAAKupB,IAAI,GAAI,EAC9B1xB,MAAKiwC,cAAiB9nC,KAAK2jB,MAAM9rB,KAAKiwC,cAAgB2C,GAAcA,EAG5E/uC,EAAaD,EACb7D,EAAOiN,eAAgBC,cAAgBpJ,WAAY7D,KAAKiwC,iBAAmB,EAC3E,IAAIvjC,OAAa,EACjB1M,MAAKshB,cAAgB,KACrBthB,KAAKo/B,SAAU,MACgB3rB,KAA3B1T,EAAO6C,UAAUwC,QACc,UAA3BrF,EAAO6C,UAAUwC,MACjBrF,EAAO+C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,IAGrE2J,EAAa3M,EAAO6C,UAAUwC,MAAMuH,MAAM,UAG/B8G,KAAf/G,GAA8C,SAAlBA,EAAW,IACvC1M,KAAKshB,cAAgBtd,YAAWjE,EAAO6C,cAAe,GACtD7C,EAAOqe,WAAY,GAEdre,EAAO6C,UAAUwC,OAA2B,SAAlBsH,EAAW,KAC1C1M,KAAKo/B,SAAU,EAEnB,IAAIn7B,IAAQ0xB,SAAU,KACtB51B,GAAO+C,OAAO,aAAexB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAASyC,IAAKA,KACrFhC,oBAAkBkF,KAEdA,EADApH,EAAOqe,WAAape,KAAKshB,eACX9gB,EAAGT,EAAO6C,UAAUC,YAAY1C,OAAUJ,EAAO6C,UAAUC,YAAYxC,MAAQ,EACzFI,EAAGV,EAAO6C,UAAUC,YAAYzC,OAAUL,EAAO6C,UAAUC,YAAYvC,OAAS,IAGtEE,EAAGT,EAAOqC,YAAYoC,YAAc,EAAG/D,EAAGV,EAAOqC,YAAYqC,aAAe,GAEtE,eAApBR,EAAc,UAA0C,UAApBA,EAAc,WAClDkD,GAAc3G,EAAGT,EAAOkN,aAAa9F,UAAU3G,EAAGC,EAAGV,EAAOkN,aAAa9F,UAAU1G,IAG3F,IACIoyC,IAAkB1rC,UAAWA,EAAW2E,QAAQ,EAAOgnC,mBADlC/yC,EAAOkN,aAAapJ,WAA2B,GAAbA,EAEvDkvC,kBAAmBhzC,EAAOkN,aAAapJ,WAAYi9B,YAAa78B,EAAc,WAC7ElE,EAAO4L,eAAiBO,cAAcnM,EAAOoM,SAAgD,IAAtCpM,EAAOoM,OAAO6mC,QAAQ5mC,YAE9ErM,EAAOsM,UAAUC,kBAAkB,iBAAkB,SAAUumC,GAAetmC,KAAK,SAAUnL,GACzFmK,EAAM0nC,UAAU7xC,EAAMyC,MAIrB9D,EAAO4L,eACR5L,EAAO0M,QAAQ,UAAWomC,GAE9B7yC,KAAKizC,UAAUJ,EAAehvC,MAI1CisC,EAAUjvC,UAAUoyC,UAAY,SAAUJ,EAAehvC,GACrD,GAAI9D,GAASC,KAAKD,MAClB,KAAI8yC,EAAc/mC,OAAlB,CAGKI,aAGInM,EAAOgO,QAAQoO,cAAc,mCAAqCpc,EAAOgO,QAAQoO,cAAc,iCAAiCc,UAAUC,SAAS,aACxJnd,EAAO+N,cAAc/N,EAAOgO,QAAS,0BAHrChO,EAAO+C,OAAO,WAAaxB,KAAM,2BAA4ByB,kBAAkB,IAKnFhD,EAAO+C,OAAO,SAAWxB,KAAM,eAAgByB,kBAAkB,EAC7DvB,OAAShB,EAAG,KAAMC,EAAG,KAAM8a,aAAa,KAC5Cxb,EAAO+C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,IACrE/C,KAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOqC,YAAY/B,MAAON,EAAOqC,YAAY9B,OAC/E,IAAIwF,IAAWsX,aAAcpd,KAAKD,OAAOqd,aACzCpd,MAAKqC,aAAasC,OAASmB,EAAqB,aAChD/F,EAAOwC,YAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS,SAClD,IAAI3Y,GAAUlB,YAAWjE,EAAOmF,YAAa,EAa7C,IAZKnF,EAAOqe,YACwB,IAA5Bre,EAAOiD,UAAUC,QACjBlD,EAAO+C,OAAO,SAAWxB,KAAM,eAAgByB,kBAAkB,EAC7DvB,OAAShB,EAAG,KAAMC,EAAG,KAAM8a,YAAa,QAC5Cxb,EAAOsH,SAAS4C,oBAAuBzJ,EAAG,EAAGC,EAAG,GAChDT,KAAK+wC,WAAU,GAAM,IAEmB,KAAnChxC,EAAOiD,UAAUU,gBACtB3D,EAAOsH,SAASC,kBAAqB9G,EAAG,EAAGC,EAAG,IAElDV,EAAO+C,OAAO,iBAAmBxB,KAAM,gBAAiByB,kBAAkB,KAE9C,IAA5BhD,EAAOiD,UAAUC,OAAc,CAC/BjD,KAAKkzC,oBAAoBrvC,EAAY7D,KAAKshB,cAC1C,IAAI6xB,IAAa7nC,UAAW,GAG5B,IAFAvL,EAAO+C,OAAO,QAAUxB,KAAM,mBAAoByB,kBAAkB,EAChEvB,OAAS6M,OAAQ8kC,KACS,KAA1BA,EAAoB,UAAU,CAC9BpzC,EAAO+C,OAAO,QAAUxB,KAAM,sBAAuByB,kBAAkB,EAAOvB,OAAS2B,MAAOpD,EAAOsH,SAASC,iBAAkB8rC,OAAO,KACvIluC,EAAUlB,YAAWjE,EAAOmF,YAAa,GACzCnF,EAAOmF,UACP,IAAI7B,GAAWtD,EAAOqD,IAAIC,SACtBC,EAAUvD,EAAOqD,IAAIE,OACzBtD,MAAKuwC,4BACLvwC,KAAK0wC,cACL3wC,EAAOqD,IAAIC,SAAWA,EACtBtD,EAAOqD,IAAIE,QAAUA,EACrBvD,EAAOmF,QAAUA,EACjBnF,EAAO+C,OAAO,SAAWxB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAASuD,eAAgB,QAChGhF,EAAO+C,OAAO,iBAAmBxB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAASuD,eAAgB,QACxGhF,EAAO+C,OAAO,iBAAmBxB,KAAM,gBAAiByB,kBAAkB,IAE1EhD,EAAOkN,aAAapJ,YAAc9D,EAAOkN,aAAa0lC,gBAAkB5yC,EAAOqe,YAC/Ere,EAAOsH,SAASC,kBAAqB9G,EAAG,EAAGC,EAAG,QAGjD,CACDV,EAAO+C,OAAO,iBAAmBxB,KAAM,gBAAiByB,kBAAkB,IAC1EhD,EAAOsH,SAAS0C,wBAA2BvJ,EAAG,EAAGC,EAAG,GACpDV,EAAOsH,SAAS4B,0BAA6BzI,EAAG,EAAGC,EAAG,GACtDT,KAAKqzC,WAAWxvC,EAChB,IAAIyvC,IAAahoC,UAAW,GAG5B,IAFAvL,EAAO+C,OAAO,QAAUxB,KAAM,mBAAoByB,kBAAkB,EAChEvB,OAAS6M,OAAQilC,KACS,KAA1BA,EAAoB,UAAU,CAC1B5uC,EAAO1E,KAAKqC,aAAasC,MAC7B3E,MAAKqC,aAAasC,OAAS,OAC3B5E,EAAO+C,OAAO,SAAWxB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAASuD,eAAgB,QAChGhF,EAAO+C,OAAO,iBAAmBxB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAASuD,eAAgB,QACxG/E,KAAKqC,aAAasC,OAASD,GAGnC,GAAIkuC,GAAazqC,KAAKupB,IAAI,GAAI,IAC1B3xB,EAAOkN,aAAapJ,YAAc9D,EAAOkN,aAAa0lC,eACrDxqC,KAAK2jB,MAAM/rB,EAAOiD,UAAUa,WAAa+uC,GAAcA,GAAgB,KACxEW,cAAcvzC,KAAKuxC,aACnBvxC,KAAKuxC,YAAc,EAEvB,IAAIljC,IAAW/C,UAAW,GAG1B,IAFAvL,EAAO+C,OAAO,QAAUxB,KAAM,mBAAoByB,kBAAkB,EAChEvB,OAAS6M,OAAQA,KACO,KAAxBA,EAAkB,UAAU,CAC5B,GAAI3J,GAAO1E,KAAKqC,aAAasC,MAC7B3E,MAAKqC,aAAasC,OAAS,OAC3B5E,EAAO+C,OAAO,SAAWxB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAASuD,eAAgB,QAChGhF,EAAO+C,OAAO,iBAAmBxB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAASuD,eAAgB,QACxG/E,KAAKqC,aAAasC,OAASD,GAE1B3E,EAAOgE,oBAA0D,gBAApChE,EAAOgE,mBAAmBqB,OAA4BrF,EAAOyF,eAC3FzF,EAAO+C,OAAO,QAAUxB,KAAM,aAAcyB,kBAAkB,EAC1DvB,OAAS+D,QAASvF,KAAKqC,aAAc+H,OAAQ,KAAMC,OAAQ,QAEnEtK,EAAO+C,OAAO,QAAUxB,KAAM,mBAAoByB,kBAAkB,EAAOvB,OAAS+D,QAASvF,KAAKqC,gBAClGtC,EAAO+C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,IACjE/C,KAAKshB,gBACLvhB,EAAO6C,UAAYoB,YAAWhE,KAAKshB,kBAAmB,GACtDvhB,EAAO+C,OAAO,QAAUxB,KAAM,aAAcyB,kBAAkB,EAAOvB,OAAS6D,OAAQ,YAAapB,IAAKlE,EAAO6C,aAC3G7C,EAAOkN,aAAapJ,YAAc9D,EAAOkN,aAAa0lC,gBACtD5yC,EAAOgE,mBAAqB,OAGpChE,EAAOmH,YAAa,CACpB,IAAIssC,EACCtnC,eAYDsnC,EAAUzzC,EAAOgO,QAAQoO,cAAc,cACxBpc,EAAOkN,aAAapJ,YAAc9D,EAAOkN,aAAa0lC,cACjEa,EAAQv2B,UAAUa,IAAI,aAEjB01B,GACLA,EAAQv2B,UAAU+O,OAAO,cAhB7BwnB,EAAUz2B,SAASZ,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,cAC5Cjd,EAAOkN,aAAapJ,YAAc9D,EAAOkN,aAAa0lC,eACjEa,EAAQv2B,UAAUa,IAAI,cACtB01B,EAAQtnB,cAAcjP,UAAUa,IAAI,cAE/B01B,IACLA,EAAQv2B,UAAU+O,OAAO,cACzBwnB,EAAQtnB,cAAcjP,UAAU+O,OAAO,cAY/ChsB,KAAKyzC,gBACDzzC,KAAKshB,gBACLvhB,EAAO6C,UAAYoB,YAAWhE,KAAKshB,kBAAmB,IAE3B,gBAA3BvhB,EAAO6C,UAAUwC,QACjBrF,EAAO0F,YAAYC,cAAe,EAEtC,IAAIguC,GAAS3zC,EAAOgO,QAAQoO,cAAc,oBACtCu3B,IAAU3zC,EAAOie,UACjB01B,EAAOz2B,UAAUa,IAAI,kBAEhB41B,GACLA,EAAOz2B,UAAU+O,OAAO,kBAExBhsB,KAAKo/B,UACLr/B,EAAO6C,UAAYoB,YAAWjE,EAAOmF,QAAQnF,EAAOmF,QAAQC,OAAS,OAAQ,GAC7EpF,EAAOmF,QAAQwB,MACf3G,EAAO+C,OAAO,QAAUxB,KAAM,aAAcyB,kBAAkB,EAAOvB,OAAS6D,OAAQ,YAAapB,IAAKlE,EAAO6C,UAAW2P,YAAa,KAC/H1J,OAAQ,KAAM2J,eAAe,EAAMC,YAAa,KAAMC,mBAAoB,QAC7ExG,eACDnM,EAAO+C,OAAO,WAAaxB,KAAM,uBAAwByB,kBAAkB,IAC3EhD,EAAO+C,OAAO,WAAaxB,KAAM,YAAayB,kBAAkB,EAAOvB,OAASw+B,UAAW,UAG9F9zB,aAIDnM,EAAO+N,cAAc/N,EAAOgO,QAAS,2BAHrChO,EAAO+C,OAAO,WAAaxB,KAAM,sBAAuByB,kBAAkB,IAK9EhD,EAAO+C,OAAO,aAAexB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAASm0B,SAAU,eAElGma,EAAUjvC,UAAU4vC,kBAAoB,SAAUvP,GAC9C,GAEIsS,GAFAzzC,EAASC,KAAKD,OACdke,GAAa,CAEZhc,qBAAkBi/B,KACnBnhC,EAAOiD,UAAUa,YAAc,IAM/B2vC,EAJCtnC,aAISlM,KAAKD,OAAOgO,QAAQoO,cAAc,YAHlCY,SAASZ,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,WAK/D,IAAI3Z,GAAWtD,EAAOqD,IAAIC,SACtBC,EAAUvD,EAAOqD,IAAIE,QACrBC,EAAYxD,EAAOqD,IAAIG,UACvBC,EAAazD,EAAOqD,IAAII,UAuC5B,OAtCIzD,GAAO6C,UAAUwC,OACjBpF,KAAK2zC,kBAAkB,GAAK5zC,EAAO6C,WAC9BX,oBAAkBuxC,KACfzzC,EAAOqD,IAAIC,SAAWtD,EAAO6C,UAAUC,YAAY1C,QAAUJ,EAAOqD,IAAIE,QAAUvD,EAAO6C,UAAUC,YAAYzC,QAC5GL,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,UAAYxD,EAAO6C,UAAUC,YAAYkF,MAAQhI,EAAOqD,IAAIE,QAChGvD,EAAOqD,IAAII,WAAazD,EAAO6C,UAAUC,YAAYmF,MAAQjI,EAAOkN,aAAapJ,aACjF9D,EAAOkN,aAAa0lC,eACfzmC,aAKDsnC,EAAQv2B,UAAUa,IAAI,cAJtB01B,EAAQv2B,UAAUa,IAAI,cACtB01B,EAAQtnB,cAAcjP,UAAUa,IAAI,cAKxCG,GAAa,IAGR/R,aAKDsnC,EAAQv2B,UAAU+O,OAAO,cAJzBwnB,EAAQv2B,UAAU+O,OAAO,cACzBwnB,EAAQtnB,cAAcjP,UAAU+O,OAAO,cAK3C/N,GAAa,KAKrBje,KAAK2zC,kBAAkB,GAAK,MAE3B1xC,oBAAkBi/B,KACnBnhC,EAAOiD,UAAUa,YAAc,IAEnC9D,EAAOqD,IAAIC,SAAWA,EACtBtD,EAAOqD,IAAIE,QAAUA,EACrBvD,EAAOqD,IAAIG,UAAYA,EACvBxD,EAAOqD,IAAII,WAAaA,EACjBya,GAEX6xB,EAAUjvC,UAAUqyC,oBAAsB,SAAU1xC,EAAOoyC,GACvD,GAAI7zC,GAASC,KAAKD,OACd6yC,EAAazqC,KAAKupB,IAAI,GAAI,EACzBvpB,MAAK2jB,MAAM/rB,EAAOiD,UAAUa,WAAa+uC,GAAcA,GAAgB,KAAkB,KAAXpxC,EAC/EzB,EAAOiD,UAAUa,WAAa,EAG9B9D,EAAOiD,UAAUa,YAAcrC,EAEnCzB,EAAOiD,UAAUjD,EAAOqe,UAAY,iBAAmB,qBAAuBre,EAAOiD,UAAUa,UAC/F,IAAIK,IAAiB7D,MAAO,EAAGC,OAAQ,EACnCP,GAAOqe,UACPla,EAAelE,KAAKuJ,SAAS/H,EAAOoyC,KAGpC1vC,EAAelE,KAAKoxC,iBAAiBrxC,EAAOqD,IAAIkB,SAAUvE,EAAOqD,IAAImB,YACxDlE,OAAU6D,EAAa7D,MAAQN,EAAOiD,UAAUa,WAC7DK,EAAa5D,QAAW4D,EAAa5D,OAASP,EAAOiD,UAAUa,WAC/D9D,EAAOqD,IAAIC,UAAYtD,EAAOqC,YAAYoC,YAAcN,EAAa7D,OAAS,EAC9EN,EAAOqD,IAAIE,SAAWvD,EAAOqC,YAAYqC,aAAeP,EAAa5D,QAAU,GAEnFP,EAAO+C,OAAO,QAAUxB,KAAM,uBAAwBE,OAASwM,UAAW9J,KAC1EA,EAAa7D,MAAQL,KAAKkwC,cAAc7vC,MACxC6D,EAAa5D,OAASN,KAAKkwC,cAAc5vC,OACzC4D,EAAa7D,OAAU6D,EAAa7D,MAAQN,EAAOiD,UAAUa,WAC7DK,EAAa5D,QAAW4D,EAAa5D,OAASP,EAAOiD,UAAUa,WAC/D9D,EAAO+C,OAAO,QAAUxB,KAAM,mBAAoBE,OAASnB,MAAO6D,EAAa7D,MAAOC,OAAQ4D,EAAa5D,WAE/GwvC,EAAUjvC,UAAU6vC,YAAc,WAC9B,GAAI3wC,GAASC,KAAKD,MAClBC,MAAKoH,eAAgB,CACrB,IAAIG,GAAoBxH,EAAOiD,UAAUU,cACrC+D,EAAezH,KAAKwH,SACpB6Z,EAAcrd,YAAWjE,EAAOmF,YAAa,GAC7Coc,EAAgBtd,YAAWjE,EAAO6C,cAAe,EACrD5C,MAAKwH,YACLzH,EAAOmF,WACPnF,EAAO+C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,IACrEhD,EAAO+C,OAAO,QAAUxB,KAAM,iBAAkByB,kBAAkB,EAC9DvB,OAASmF,KAAM,UAAWgB,qBAAsB,KAAMpC,QAAS,KAAMqC,oBAAqB,OAC9F,IAAIlD,GAAO1E,KAAKqC,aAAasC,MAC7B5E,GAAO+C,OAAO,UAAYxB,KAAM,qBAAsByB,kBAAkB,IACxE/C,KAAKqC,aAAauC,UAAU7E,EAAO8E,QAAS9E,EAAOqD,IAAIgB,QAASrE,EAAOqD,IAAIiB,OAAQtE,EAAOqD,IAAIkB,SAAUvE,EAAOqD,IAAImB,UAAWxE,EAAOqD,IAAIC,SAAUtD,EAAOqD,IAAIE,QAASvD,EAAOqD,IAAIG,UAAWxD,EAAOqD,IAAII,YACxMxD,KAAKqC,aAAasC,OAASD,EAC3B3E,EAAO+C,OAAO,QAAUxB,KAAM,iBAAkByB,kBAAkB,EAC9DvB,OAASmF,KAAM,UAAWgB,sBAAsB,EAAMpC,QAAS,KAAMqC,oBAAqB,QACpE,KAAtBL,GAA+D,KAAnCxH,EAAOiD,UAAUU,gBAC7C6D,EAAoBxH,EAAOiD,UAAUU,eAEzC3D,EAAOiD,UAAUU,cAAgB6D,EACjCvH,KAAKwH,SAAWC,EAChB1H,EAAOmF,QAAUlB,YAAWqd,MAAiB,GAC7CrhB,KAAKqC,aAAasC,OAAS,OAC3B5E,EAAO+C,OAAO,SAAWxB,KAAM,iBAAkByB,kBAAkB,IACnE/C,KAAKqC,aAAasC,OAASD,EACa,IAApC4c,EAAcze,YAAYxC,QAC1BN,EAAO6C,UAAYoB,YAAWsd,MAAmB,IAErDthB,KAAKoH,eAAgB,GAEzB0oC,EAAUjvC,UAAUwyC,WAAa,SAAU7xC,GACvC,GAAIzB,GAASC,KAAKD,OACd6yC,EAAazqC,KAAKupB,IAAI,GAAI,EACzBvpB,MAAK2jB,MAAM/rB,EAAOiD,UAAUa,WAAa+uC,GAAcA,GAAgB,KAAkB,KAAXpxC,EAC/EzB,EAAOiD,UAAUa,WAAa,EAG9B9D,EAAOiD,UAAUa,YAAcrC,EAE/BzB,EAAOqe,UACPre,EAAOiD,UAAUsc,eAAiBvf,EAAOiD,UAAUa,WAGnD9D,EAAOiD,UAAU4C,kBAAoB7F,EAAOiD,UAAUa,UAE1D,IAAIwd,GAAcrd,YAAWjE,EAAOmF,YAAa,GAC7Coc,EAAgBtd,YAAWjE,EAAO6C,cAAe,EACrD7C,GAAOmF,WACPnF,EAAO+C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,IACrEhD,EAAO+C,OAAO,QAAUxB,KAAM,uBAAwByB,kBAAkB,EACpEvB,OAASmF,KAAM,UAAWgB,qBAAsB,KAAMwT,YAAa,QACvEpb,EAAO+C,OAAO,QAAUxB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAASqG,cAAc,KAC/F9H,EAAO+C,OAAO,QAAUxB,KAAM,gBAAiByB,kBAAkB,GACjE,IAAI2B,GAAO1E,KAAKqC,aAAasC,MAC7B5E,GAAO+C,OAAO,UAAYxB,KAAM,qBAAsByB,kBAAkB,IACxE/C,KAAKqC,aAAauC,UAAU7E,EAAO8E,QAAS9E,EAAOqD,IAAIgB,QAASrE,EAAOqD,IAAIiB,OAAQtE,EAAOqD,IAAIkB,SAAUvE,EAAOqD,IAAImB,UAAWxE,EAAOqD,IAAIC,SAAUtD,EAAOqD,IAAIE,QAASvD,EAAOqD,IAAIG,UAAWxD,EAAOqD,IAAII,YACxMxD,KAAKqC,aAAasC,OAASD,EAC3B3E,EAAO+C,OAAO,QAAUxB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAASqG,cAAc,KAC/F9H,EAAO+C,OAAO,QAAUxB,KAAM,uBAAwByB,kBAAkB,EACpEvB,OAASmF,KAAM,UAAWgB,qBAAsB,KAAMwT,YAAa,QACvEpb,EAAOmF,QAAUmc,EACjBthB,EAAO6C,UAAY0e,CACnB,IAAIpd,IAAiB7D,MAAOL,KAAKkwC,cAAc7vC,MAAOC,OAAQN,KAAKkwC,cAAc5vC,OACjF4D,GAAa7D,OAAU6D,EAAa7D,MAAQN,EAAOiD,UAAUa,WAC7DK,EAAa5D,QAAW4D,EAAa5D,OAASP,EAAOiD,UAAUa,WAC/D9D,EAAO+C,OAAO,QAAUxB,KAAM,mBAAoBE,OAASnB,MAAO6D,EAAa7D,MAAOC,OAAQ4D,EAAa5D,WAE/GwvC,EAAUjvC,UAAU4yC,cAAgB,WAC5BzzC,KAAKD,OAAOiD,UAAUa,YAAc,GACpC7D,KAAKD,OAAOie,WAAY,EACxBhe,KAAKD,OAAO+C,OAAO,aAAexB,KAAM,gBAAiBE,OAAS4E,MAAM,KACxEpG,KAAKD,OAAO4F,KAAI,GAChB3F,KAAK+vC,YAAa,GAGlB/vC,KAAKD,OAAO4F,KAAK3F,KAAK+vC,aAG9BD,EAAUjvC,UAAU0I,SAAW,SAAU/H,EAAOoyC,GAC5C,GAAI7zC,GAASC,KAAKD,OACdsD,EAAWtD,EAAOqD,IAAIC,SACtBC,EAAUvD,EAAOqD,IAAIE,QACrBY,GAAiB7D,MAAO,EAAGC,OAAQ,EAiDvC,OAhD2B,KAAvBP,EAAOqD,IAAIgB,SAAuC,IAAtBrE,EAAOqD,IAAIiB,OAEnCH,EADAjC,oBAAkB2xC,GACH5zC,KAAK2zC,iBAAiBnyC,EAAO,MAG7BxB,KAAK2zC,iBAAiBnyC,EAAOoyC,KAK5C1vC,EADAnE,EAAOiD,UAAUC,OAAS,IAAO,GAAKlD,EAAOiD,UAAUC,OAAS,KAAQ,EACzDjD,KAAKoxC,iBAAiBrxC,EAAOqD,IAAImB,UAAWxE,EAAOqD,IAAIkB,UAGvDtE,KAAKoxC,iBAAiBrxC,EAAOqD,IAAIkB,SAAUvE,EAAOqD,IAAImB,YAE5DlE,OAAU6D,EAAa7D,MAAQN,EAAOiD,UAAUa,WAC7DK,EAAa5D,QAAW4D,EAAa5D,OAASP,EAAOiD,UAAUa,YAEnE9D,EAAOqD,IAAIC,SAAWA,GAAaa,EAAa7D,MAAQN,EAAOqD,IAAIG,WAAa,EAChFxD,EAAOqD,IAAIE,QAAUA,GAAYY,EAAa5D,OAASP,EAAOqD,IAAII,YAAc,EAChFH,EAAWtD,EAAOqD,IAAIC,SACtBC,EAAUvD,EAAOqD,IAAIE,QACjBswC,IACI7zC,EAAOqD,IAAIC,SAAWuwC,EAAa/wC,YAAY1C,SAC/CJ,EAAOqD,IAAIC,SAAWuwC,EAAa/wC,YAAY1C,OACf,IAA5BJ,EAAOiD,UAAUC,SACjBlD,EAAOsH,SAASC,iBAAiB9G,GAAM6C,EAAWtD,EAAOqD,IAAIC,WAGjEtD,EAAOqD,IAAIE,QAAUswC,EAAa/wC,YAAYzC,SAC9CL,EAAOqD,IAAIE,QAAUswC,EAAa/wC,YAAYzC,OACd,IAA5BL,EAAOiD,UAAUC,SACjBlD,EAAOsH,SAASC,iBAAiB7G,GAAM6C,EAAUvD,EAAOqD,IAAIE,UAGhEvD,EAAOqD,IAAIC,SAAWa,EAAa7D,MAAQuzC,EAAa/wC,YAAYkF,OACpEhI,EAAOqD,IAAIC,SAAWuwC,EAAa/wC,YAAYkF,KAAO7D,EAAa7D,MACnC,IAA5BN,EAAOiD,UAAUC,SACjBlD,EAAOsH,SAASC,iBAAiB9G,GAAM6C,EAAWtD,EAAOqD,IAAIC,WAGjEtD,EAAOqD,IAAIE,QAAUY,EAAa5D,OAASszC,EAAa/wC,YAAYmF,OACpEjI,EAAOqD,IAAIE,QAAUswC,EAAa/wC,YAAYmF,KAAO9D,EAAa5D,OAClC,IAA5BP,EAAOiD,UAAUC,SACjBlD,EAAOsH,SAASC,iBAAiB7G,GAAM6C,EAAUvD,EAAOqD,IAAIE,WAIjEY,GAEX4rC,EAAUjvC,UAAU8yC,iBAAmB,SAAUnyC,EAAOoyC,GACpD,GAAI7zC,GAASC,KAAKD,OACdmE,GAAiB7D,MAAO,EAAGC,OAAQ,EAYvC,IAVI4D,EADAnE,EAAOiD,UAAUC,OAAS,IAAO,GAAKlD,EAAOiD,UAAUC,OAAS,KAAQ,EACzDjD,KAAKoxC,iBAAiBrxC,EAAOqD,IAAImB,UAAWxE,EAAOqD,IAAIkB,UAGvDtE,KAAKoxC,iBAAiBrxC,EAAOqD,IAAIkB,SAAUvE,EAAOqD,IAAImB,WAEzEL,EAAa7D,OAAU6D,EAAa7D,MAAQN,EAAOiD,UAAUa,WAC7DK,EAAa5D,QAAW4D,EAAa5D,OAASP,EAAOiD,UAAUa,WAC/D9D,EAAOqD,IAAIC,WAActD,EAAOqD,IAAIG,UAAYW,EAAa7D,OAAS,EACtEN,EAAOqD,IAAIE,UAAavD,EAAOqD,IAAII,WAAaU,EAAa5D,QAAU,EAEnEkB,EAAQ,GAAKoyC,EAAc,CAC3B,GAAIzzC,GAASyzC,EAAa/wC,YAAY1C,OAClCC,EAASwzC,EAAa/wC,YAAYzC,OAClCC,EAAQuzC,EAAa/wC,YAAYxC,MACjCC,EAASszC,EAAa/wC,YAAYvC,OAClCuzC,EAAc9zC,EAAOqD,IAAIC,SAAWa,EAAa7D,MACjDyzC,EAAa/zC,EAAOqD,IAAIE,QAAUY,EAAa5D,MAC/CP,GAAOqD,IAAIC,SAAWlD,IACtBJ,EAAOqD,IAAIC,SAAWlD,GAEtBJ,EAAOqD,IAAIE,QAAUlD,IACrBL,EAAOqD,IAAIE,QAAUlD,GAErByzC,EAAc1zC,EAASE,IACvBN,EAAOqD,IAAIC,SAAWlD,EAASE,EAAQ6D,EAAa7D,OAEpDyzC,EAAa1zC,EAASE,IACtBP,EAAOqD,IAAIE,QAAUlD,EAASE,EAAS4D,EAAa5D,YAGnDkB,GAAQ,GAAKS,oBAAkB2xC,KAChC7zC,EAAOqD,IAAIC,SAAW,IACtBtD,EAAOqD,IAAIC,SAAW,GAEtBtD,EAAOqD,IAAIE,QAAU,IACrBvD,EAAOqD,IAAIE,QAAU,GAErBvD,EAAOqD,IAAIC,SAAWa,EAAa7D,MAAQN,EAAOqC,YAAY/B,QAC9DN,EAAOqD,IAAIC,SAAWtD,EAAOqC,YAAY/B,MAAQN,EAAOqD,IAAIG,WAE5DxD,EAAOqD,IAAIE,QAAUY,EAAa5D,OAASP,EAAOqC,YAAY9B,SAC9DP,EAAOqD,IAAIE,QAAUvD,EAAOqC,YAAY9B,OAASP,EAAOqD,IAAII,YAGpE,OAAOU,IAEX4rC,EAAUjvC,UAAU8vC,gBAAkB,SAAUzmC,EAAOC,GACnD,GAAIoB,GAAQvL,KACRD,EAASC,KAAKD,OACdkE,GAAQ8zB,QAAS,KACrBh4B,GAAO+C,OAAO,aAAexB,KAAM,aAAcyB,kBAAkB,EAAOvB,OAASyC,IAAKA,IACxF,IAAIo9B,IAAiBt1B,WAAY9H,EAAa,QAAG+H,SAAUhM,KAAK0iC,QAAS52B,QAAQ,EAC7EI,eAAcjK,oBAAkBjC,KAAKD,OAAOo8B,YAAcp8B,EAAOoM,SAAmD,IAAzCpM,EAAOoM,OAAO4nC,WAAW3nC,aACpGpM,KAAKD,OAAOo8B,UAAY,MACxBn8B,KAAKD,OAAOshC,aAAeA,EAE3BthC,EAAOsM,UAAUC,kBAAkB,gBAAiB,aAAc+0B,GAAc90B,KAAK,SAAUnL,GAC3FmK,EAAMyoC,SAAS5yC,EAAM8I,EAAOC,OAIhCpK,EAAO0M,QAAQ,UAAW40B,GAC1BrhC,KAAKg0C,SAAS3S,EAAcn3B,EAAOC,KAG3C2lC,EAAUjvC,UAAUmzC,SAAW,SAAU3S,EAAcn3B,EAAOC,GAC1D,IAAIk3B,EAAav1B,OAAjB,CAGA,GAAI/L,GAASC,KAAKD,OACdk0C,GAAe,CAInB,IAHIl0C,EAAO6C,UAAUwC,OAAoC,UAA3BrF,EAAO6C,UAAUwC,OAC3CrF,EAAO+C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,IAErEd,oBAAkBlC,EAAO6C,UAAUwC,OAAQ,CAC3C6uC,GAAe,EACfl0C,EAAO6C,UAAUC,aAAgB1C,OAAQJ,EAAOqD,IAAIC,SAAUjD,OAAQL,EAAOqD,IAAIE,QAC7EyE,KAAMhI,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,UAAWyE,KAAMjI,EAAOqD,IAAIE,QAAUvD,EAAOqD,IAAII,WAC5F,IAAIrD,GAASJ,EAAO6C,UAAUC,YAAY1C,OACtCC,EAASL,EAAO6C,UAAUC,YAAYzC,OACtC2H,EAAOhI,EAAO6C,UAAUC,YAAYkF,KACpCC,EAAOjI,EAAO6C,UAAUC,YAAYmF,IACpC7H,GAAS,IACTJ,EAAO6C,UAAUC,YAAY1C,OAAS,GAEtCC,EAAS,IACTL,EAAO6C,UAAUC,YAAYzC,OAAS,GAEtC2H,EAAOhI,EAAOqC,YAAY/B,QAC1BN,EAAO6C,UAAUC,YAAYkF,KACzBhI,EAAOqC,YAAY/B,OAEvB2H,EAAOjI,EAAOqC,YAAY9B,SAC1BP,EAAO6C,UAAUC,YAAYmF,KACzBjI,EAAOqC,YAAY9B,QAE3BP,EAAO6C,UAAUC,YAAYxC,MAAQN,EAAO6C,UAAUC,YAAYkF,KAAOhI,EAAO6C,UAAUC,YAAY1C,OACtGJ,EAAO6C,UAAUC,YAAYvC,OAASP,EAAO6C,UAAUC,YAAYmF,KAAOjI,EAAO6C,UAAUC,YAAYzC,OACvGL,EAAO6C,UAAUwC,MAAQ,aACzB,IAAInB,IAAQ8O,kBACZhT,GAAO+C,OAAO,SAAWxB,KAAM,oBAAqByB,kBAAkB,EAClEvB,OAASyC,IAAKA,KAClBlE,EAAO6C,UAAUmQ,eAAiB9O,EAAoB,eACtDlE,EAAO+C,OAAO,QAAUxB,KAAM,qBAAsByB,kBAAkB,EAAOvB,OAASmB,SAAU5C,EAAO6C,UAAUC,YAAaoB,IAAKlE,EAAO6C,UAClI4R,YAAa,KAAMhU,EAAG,KAAMC,EAAG,QACvCV,EAAOqe,WAAY,EAEvB,GAAgC,IAA5Bre,EAAOiD,UAAUC,OAAc,CAC/B,GAAIE,OAAQ,EAERA,GADAlB,oBAAkBiI,IAAUjI,oBAAkBkI,GACtCnK,KAAKqxC,gBAAgB,KAGnB7wC,EAAG0J,EAAOzJ,EAAG0J,GAE3BpK,EAAOsH,SAASC,iBAAiB9G,GAAK2C,EAAM3C,EAC5CT,EAAOsH,SAASC,iBAAiB7G,GAAK0C,EAAM1C,CAC5C,IAAI0e,GAAmBnb,YAAWjE,EAAO6C,cAAe,GACpD8B,EAAO1E,KAAKqC,aAAasC,MAC7B3E,MAAK4wC,cAAcztC,GACnBnD,KAAKqC,aAAasC,OAASD,EAC3B1E,KAAKyiC,YAAcz+B,YAAWhE,KAAK0iC,YAAa,GAChD3iC,EAAO6C,UAAYoB,YAAWmb,MAAsB,GACpDnf,KAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOwC,YAAYlC,MAAON,EAAOwC,YAAYjC,QAC3EP,EAAO6C,UAAUwC,OACjBrF,EAAO+C,OAAO,QAAUxB,KAAM,aAAcyB,kBAAkB,EAAOvB,OAAS6D,OAAQ,YAAapB,IAAKlE,EAAO6C,iBAGlH,CACD,GAAIsxC,GAAgBn0C,EAAOiD,UAAUU,aACrC3D,GAAOqe,WAAY,EACfnc,oBAAkBiI,IAAUjI,oBAAkBkI,GAC9CpK,EAAOsH,SAAS4C,mBAAqBjK,KAAKqxC,gBAAgB,IAG1DtxC,EAAOsH,SAAS4C,oBAAuBzJ,EAAG0J,EAAOzJ,EAAG0J,GAExDpK,EAAOiD,UAAUU,cAAgBwwC,EACjCl0C,KAAK+wC,YACLhxC,EAAOqe,WAAY,EACnBpe,KAAKyiC,YAAcz+B,YAAWhE,KAAK0iC,YAAa,GAEhDuR,IACAl0C,EAAO+C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,IACrEhD,EAAOqe,WAAY,EACnBpe,KAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOwC,YAAYlC,MAAON,EAAOwC,YAAYjC,WAGvFwvC,EAAUjvC,UAAU+vC,cAAgB,SAAUztC,GAC1C,GAAIpD,GAASC,KAAKD,OACd4E,EAAS3E,KAAKqC,aAAasC,OAC3BwE,GAAehJ,OAAQJ,EAAOqD,IAAIC,SAAUjD,OAAQL,EAAOqD,IAAIE,QAASjD,MAAON,EAAOqD,IAAIG,UAC1FjD,OAAQP,EAAOqD,IAAII,WACvBxD,MAAKqC,aAAa8B,UAAU,EAAG,EAAGpE,EAAOqC,YAAY/B,MAAON,EAAOqC,YAAY9B,QAC/EP,EAAO+C,OAAO,QAAUxB,KAAM,uBAAwByB,kBAAkB,EACpEvB,OAASmF,KAAM,UAAWgB,qBAAsB,KAAMwT,YAAa,QACvEpb,EAAOqD,IAAIC,SAAW8F,EAAWhJ,OACjCJ,EAAOqD,IAAIE,QAAU6F,EAAW/I,OAChCL,EAAOqD,IAAIG,UAAY4F,EAAW9I,MAClCN,EAAOqD,IAAII,WAAa2F,EAAW7I,OACnCN,KAAKuwC,4BACLxwC,EAAO+C,OAAO,UAAYxB,KAAM,qBAAsByB,kBAAkB,IACxE/C,KAAKqC,aAAauC,UAAU7E,EAAO8E,QAAS9E,EAAOqD,IAAIgB,QAASrE,EAAOqD,IAAIiB,OAAQtE,EAAOqD,IAAIkB,SAAUvE,EAAOqD,IAAImB,UAAWxE,EAAOqD,IAAIC,SAAUtD,EAAOqD,IAAIE,QAASvD,EAAOqD,IAAIG,UAAWxD,EAAOqD,IAAII,aACnMzD,EAAOgE,oBAA0D,gBAApChE,EAAOgE,mBAAmBqB,OAA4BrF,EAAOyF,eAC3FzF,EAAO+C,OAAO,QAAUxB,KAAM,aAAcyB,kBAAkB,EAC1DvB,OAAS+D,QAASvF,KAAKqC,aAAc+H,OAAQ,KAAMC,QAAQ,KAEnErK,KAAKqC,aAAasC,OAASA,EAC3B5E,EAAO+C,OAAO,QAAUxB,KAAM,uBAAwByB,kBAAkB,EACpEvB,OAASmF,KAAM,UAAWgB,qBAAsB,KAAMwT,YAAa,QACvEpb,EAAOqD,IAAIC,SAAW8F,EAAWhJ,OACjCJ,EAAOqD,IAAIE,QAAU6F,EAAW/I,OAChCL,EAAOqD,IAAIG,UAAY4F,EAAW9I,MAClCN,EAAOqD,IAAII,WAAa2F,EAAW7I,MACnC,IAAIoE,GAAO1E,KAAKqC,aAAasC,MAC7B3E,MAAKqC,aAAasC,OAAS,OAC3B5E,EAAO+C,OAAO,SAAWxB,KAAM,aAAcyB,kBAAkB,EAC3DvB,OAAS0I,MAAO/G,EAAM3C,EAAG2J,MAAOhH,EAAM1C,EAAG6K,UAAW,MACxDvL,EAAO+C,OAAO,iBAAmBxB,KAAM,aAAcyB,kBAAkB,EACnEvB,OAAS0I,MAAO/G,EAAM3C,EAAG2J,MAAOhH,EAAM1C,EAAG6K,UAAW,MACxDtL,KAAKqC,aAAasC,OAASD,EAC3B3E,EAAO+C,OAAO,QAAUxB,KAAM,mBAAoByB,kBAAkB,EAAOvB,OAAS+D,QAASvF,KAAKqC,gBAC9FtC,EAAOyF,cACPzF,EAAO+C,OAAO,QAAUxB,KAAM,aAAcyB,kBAAkB,EAC1DvB,OAAS+D,QAASvF,KAAKqC,aAAc+H,OAAQ,KAAMC,QAAQ,MAGvEylC,EAAUjvC,UAAU2F,UAAY,WAC5B,GAAIzG,GAASC,KAAKD,MAClB,IAA2C,IAAvCA,EAAOiD,UAAU4C,kBAAyB,CAC1C,GAAIsB,GAAanH,EAAOmH,WACpBpB,GAAWC,WACfhG,GAAO+C,OAAO,UAAYxB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAASsE,OAAQA,KAC3F9F,KAAKwxC,aAAe1rC,EAAgB,QACpC9F,KAAKwxC,aAAatsC,QAAUlB,YAAWjE,EAAOmF,QAAS,MAAM,GAC7DlF,KAAKwxC,aAAavqC,UAAYjD,YAAWjE,EAAOkH,UAAW,MAAM,GACjEjH,KAAKwxC,aAAa3rC,iBAAmB7B,YAAWjE,EAAO8F,qBAAsB,EAC7E,IAAIuZ,IAAoBhW,aAAc,KACtCrJ,GAAO+C,OAAO,iBAAmBxB,KAAM,kBAAmByB,kBAAkB,EACxEvB,OAASyC,IAAKmb,KAClBpf,KAAKwxC,aAAapoC,aAAepF,YAAWob,EAA8B,iBAAO,GACjFrf,EAAOmH,WAAanH,EAAO4L,eAAgB,EACvC5L,EAAOiD,UAAU4C,kBAAoB,EACrC5F,KAAKwwC,YAAYzwC,EAAOiD,UAAU4C,mBAGlC5F,KAAKwwC,WAAWroC,KAAKC,IAAIrI,EAAOiD,UAAU4C,oBAE9C7F,EAAO4L,eAAgB,EACvB5L,EAAOmH,WAAaA,IAG5B4oC,EAAUjvC,UAAUgwC,sBAAwB,SAAU1hC,GAClD,GAAIpP,GAASC,KAAKD,OACd6D,EAAiB7D,EAAOiD,UAAU4C,kBAClCsB,EAAanH,EAAOmH,WACpB4F,EAAc9I,YAAWjE,EAAOiG,YAAa,EACjDhG,MAAKwG,YACLxG,KAAK8wC,gBAAgB3hC,EACrB,KAAK,GAAInK,GAAI,EAAGC,EAAMlF,EAAOmF,QAAQC,OAAQH,EAAIC,EAAKD,IAClD,GAAIjF,EAAOmF,QAAQF,GAAG+S,YAAY5S,OAAS,EAAG,CAC1C,GAAI4S,IAAgBzJ,WAAYvO,EAAOmF,QAAQF,GAAG+S,YAClDhY,GAAO+C,OAAO,SAAWxB,KAAM,sBAAuByB,kBAAkB,EACpEvB,OAAS8M,WAAYvO,EAAOmF,QAAQF,GAAG+S,YAAaxJ,uBAAwB,KAAMtK,IAAK8T,KAC3FhY,EAAOmF,QAAQF,GAAG+S,YAAcA,EAAwB,WACX,IAAzChY,EAAOmF,QAAQF,GAAG+S,YAAY5S,SAC9BpF,EAAOmF,QAAQF,GAAG+B,UAAY,IAI1C,GAAuB,IAAnBnD,EAAsB,CACtB7D,EAAOmH,YAAa,EACpBlH,KAAKwwC,WAAW5sC,GAChB7D,EAAOmH,WAAaA,CACpB,IAAIkE,GAAQ,EACC,gBAAT+D,GAAkC,gBAATA,EACzB/D,EAAQ,SAEM,mBAAT+D,GAAsC,iBAATA,IAClC/D,EAAQ,QAEZrL,EAAO+C,OAAO,aAAexB,KAAM,qBAAsByB,kBAAkB,EACvEvB,OAAS6L,UAAWjC,EAAOkC,YAAatN,KAAKwxC,aAAcjkC,gBAAiBvN,KAAKwxC,aAAatsC,QAC1FsI,kBAAmBxN,KAAKwxC,aAAavqC,UAAWwG,qBAAsBzN,KAAKwxC,aAAapoC,aACxFsE,gBAAiBZ,EAAaa,aAAc,KAC5CC,YAAa,KAAMC,eAAgB,KAAMrI,aAAc,QAC/DxF,KAAKwxC,aAAe,OAG5B1B,EAAUjvC,UAAUiwC,gBAAkB,SAAU3hC,GAC5C,OAAQA,EAAKyD,eACT,IAAK,aACD5S,KAAKqwC,aAAa,GAClB,MACJ,KAAK,cACDrwC,KAAKqwC,YAAY,GACjB,MACJ,KAAK,iBACDrwC,KAAKswC,UAAU6D,YAAUC,WACzB,MACJ,KAAK,eACDp0C,KAAKswC,UAAU6D,YAAUE,YAIrCvE,EAAUjvC,UAAUkwC,UAAY,SAAU7yB,EAAiB4D,GACvD,GAAI/hB,GAASC,KAAKD,MAClBC,MAAKgwC,iBAAkB,CACvB,IACIsE,GADAC,EAAax0C,EAAOiD,UAAUC,OAE9B6C,GAAWsD,aAAc,KACzBrJ,GAAO6C,UAAUC,aAAe9C,EAAO6C,UAAUwC,QACjDkvC,EAAqBtwC,YAAWjE,EAAO6C,cAAe,GAE1D,IAAIye,GAAcrd,YAAWjE,EAAOmF,YAAa,GAC7CkjB,EAAgBpkB,YAAWjE,EAAOkH,cAAe,EACrDlH,GAAOmF,WACPnF,EAAOkH,aACPlH,EAAOiH,gBAAkB,EACzBjH,EAAO+C,OAAO,iBAAmBxB,KAAM,kBAAmByB,kBAAkB,EACxEvB,OAASyC,IAAK6B,IAClB,IAAIuD,GAAmBvD,EAAqB,YAC5C/F,GAAO+C,OAAO,iBAAmBxB,KAAM,kBAAmByB,kBAAkB,EACxEvB,OAASyC,KAAOmF,oBACpBrJ,EAAO+C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,IACrEhD,EAAO+C,OAAO,QAAUxB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAASqG,cAAc,KAC/F9H,EAAO+C,OAAO,QAAUxB,KAAM,uBAAwByB,kBAAkB,EACpEvB,OAASmF,KAAM,UAAWgB,qBAAsB,KAAMwT,YAAa,OACvE,IAAIq5B,GAAkBz0C,EAAOqD,IAAIC,SAC7BoxC,EAAiB10C,EAAOqD,IAAIE,OAC5BvD,GAAOqe,YACPre,EAAOqD,IAAIC,UAAYtD,EAAOsH,SAAS4B,yBAAyBzI,EAChET,EAAOqD,IAAIE,SAAWvD,EAAOsH,SAAS4B,yBAAyBxI,GAEnEV,EAAO+C,OAAO,QAAUxB,KAAM,kBAAmByB,kBAAkB,IAC/DhD,EAAOqe,YACPre,EAAOsH,SAAS4B,yBAAyBzI,EAAIT,EAAOqD,IAAIC,SAAWmxC,EACnEz0C,EAAOsH,SAAS4B,yBAAyBxI,EAAIV,EAAOqD,IAAIE,QAAUmxC,EAEtE,IAAI/vC,GAAO1E,KAAKqC,aAAasC,MAC7B5E,GAAO+C,OAAO,UAAYxB,KAAM,qBAAsByB,kBAAkB,IACxE/C,KAAKqC,aAAauC,UAAU7E,EAAO8E,QAAS9E,EAAOqD,IAAIgB,QAASrE,EAAOqD,IAAIiB,OAAQtE,EAAOqD,IAAIkB,SAAUvE,EAAOqD,IAAImB,UAAWxE,EAAOqD,IAAIC,SAAUtD,EAAOqD,IAAIE,QAASvD,EAAOqD,IAAIG,UAAWxD,EAAOqD,IAAII,YACxMzD,EAAO+C,OAAO,QAAUxB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAASqG,cAAc,KAC/F9H,EAAO+C,OAAO,QAAUxB,KAAM,uBAAwByB,kBAAkB,EACpEvB,OAASmF,KAAM,UAAWgB,sBAAsB,EAAMwT,aAAa,IACvE,IAAI9X,GAAWtD,EAAOqD,IAAIC,SACtBC,EAAUvD,EAAOqD,IAAIE,OACzBvD,GAAOqD,IAAIC,UAAYtD,EAAOsH,SAAS0C,uBAAuBvJ,EAC9DT,EAAOqD,IAAIE,SAAWvD,EAAOsH,SAAS0C,uBAAuBtJ,EAC7DV,EAAOqD,IAAIC,UAAYtD,EAAOsH,SAAS4C,mBAAmBzJ,EAC1DT,EAAOqD,IAAIE,SAAWvD,EAAOsH,SAAS4C,mBAAmBxJ,EACzDV,EAAOsH,SAAS0C,uBAAuBvJ,EAAIT,EAAOqD,IAAIC,SAAWA,EACjEtD,EAAOsH,SAAS0C,uBAAuBtJ,EACnCV,EAAOqD,IAAIE,QAAUA,EACzBvD,EAAOmF,QAAUmc,EACjBthB,EAAOkH,UAAYmhB,EACnBroB,EAAOiH,gBAAkBjH,EAAOkH,UAAU9B,OAC1CpF,EAAO+C,OAAO,iBAAmBxB,KAAM,kBAAmByB,kBAAkB,EACxEvB,OAASyC,KAAOmF,aAAcC,MAClCtJ,EAAOiD,UAAUC,OAASsxC,EAC1Bv0C,KAAKqC,aAAasC,OAAS,OACvBuZ,IACI4D,GACA/hB,EAAOsH,SAAS0C,uBAAuBvJ,GAAKT,EAAOsH,SAAS0C,uBAAuBvJ,EACnFT,EAAOsH,SAAS0C,uBAAuBtJ,GAAKV,EAAOsH,SAAS0C,uBAAuBtJ,EACnFV,EAAOsH,SAAS4C,mBAAqBjG,YAAWjE,EAAOsH,SAAS0C,2BAA4B,GAC5FhK,EAAOsH,SAAS0C,wBAA2BvJ,EAAG,EAAGC,EAAG,GACpDV,EAAOqD,IAAIC,UAAYtD,EAAOsH,SAAS4C,mBAAmBzJ,EAC1DT,EAAOqD,IAAIE,SAAWvD,EAAOsH,SAAS4C,mBAAmBxJ,GAGzDV,EAAOsH,SAAS4C,mBAAqBjG,YAAWjE,EAAOsH,SAAS0C,2BAA4B,IAGpGhK,EAAO+C,OAAO,SAAWxB,KAAM,aAAcyB,kBAAkB,EAC3DvB,OAAS0I,MAAOnK,EAAOsH,SAAS4C,mBAAmBzJ,EAAG2J,MAAOpK,EAAOsH,SAAS4C,mBAAmBxJ,EAAG6K,UAAW,MAClHvL,EAAO+C,OAAO,iBAAmBxB,KAAM,aAAcyB,kBAAkB,EACnEvB,OAAS0I,MAAOnK,EAAOsH,SAAS4C,mBAAmBzJ,EAAG2J,MAAOpK,EAAOsH,SAAS4C,mBAAmBxJ,EAAG6K,UAAW,MAClHtL,KAAKqC,aAAasC,OAASD,EAC3B3E,EAAO+C,OAAO,QAAUxB,KAAM,mBAAoByB,kBAAkB,EAAOvB,OAAS+D,QAASvF,KAAKqC,gBAClGrC,KAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOwC,YAAYlC,MAAON,EAAOwC,YAAYjC,QAC/EP,EAAO6C,UAAYoB,YAAWswC,MAAwB,GAClDv0C,EAAO6C,UAAUC,aACjB9C,EAAO+C,OAAO,QAAUxB,KAAM,aAAcyB,kBAAkB,EAAOvB,OAAS6D,OAAQ,YAAapB,IAAKlE,EAAO6C,UAAW2P,YAAa,KAC/H1J,OAAQ,KAAM2J,eAAe,EAAMC,YAAa,KAAMC,mBAAoB,QAEtF1S,KAAKgwC,iBAAkB,GAE3BF,EAAUjvC,UAAUowC,SAAW,WAC3B,GAAIlxC,GAASC,KAAKD,MACdA,GAAO6C,UAAUC,cACb9C,EAAOqD,IAAIC,SAAWtD,EAAO6C,UAAUC,YAAY1C,SACnDJ,EAAOqD,IAAIC,SAAWtD,EAAO6C,UAAUC,YAAY1C,QAEnDJ,EAAOqD,IAAIE,QAAUvD,EAAO6C,UAAUC,YAAYzC,SAClDL,EAAOqD,IAAIE,QAAUvD,EAAO6C,UAAUC,YAAYzC,QAElDL,EAAOqD,IAAIC,SAAWtD,EAAOqD,IAAIG,UAAYxD,EAAO6C,UAAUC,YAAYkF,OAC1EhI,EAAOqD,IAAIC,SAAWtD,EAAO6C,UAAUC,YAAYkF,KAAOhI,EAAOqD,IAAIG,WAErExD,EAAOqD,IAAIE,QAAUvD,EAAOqD,IAAII,WAAazD,EAAO6C,UAAUC,YAAYmF,OAC1EjI,EAAOqD,IAAIE,QAAUvD,EAAO6C,UAAUC,YAAYmF,KAAOjI,EAAOqD,IAAII,cAIhFssC,EAAUjvC,UAAUqwC,oBAAsB,SAAU5lC,GAChD,GAAIvL,GAASC,KAAKD,MACA,gBAAduL,GACIvL,EAAO6C,UAAUC,YAAY1C,OAASJ,EAAOqC,YAAY/B,MAAQ,EACjEN,EAAO6C,UAAUC,YAAYkF,KAAQhI,EAAOqC,YAAY/B,MAAQ,GAC3DN,EAAO6C,UAAUC,YAAY1C,OAAUJ,EAAOqC,YAAY/B,MAAQ,GAGvEN,EAAO6C,UAAUC,YAAYkF,KAAQhI,EAAOqC,YAAY/B,MAAQ,GAAON,EAAOqC,YAAY/B,MAAQ,EAC9FN,EAAO6C,UAAUC,YAAY1C,QAErCJ,EAAO6C,UAAUC,YAAY1C,OAASJ,EAAO6C,UAAUC,YAAYkF,KAAOhI,EAAO6C,UAAUC,YAAYxC,OAEpF,aAAdiL,GACDvL,EAAO6C,UAAUC,YAAY1C,OAASJ,EAAOqC,YAAY/B,MAAQ,EACjEN,EAAO6C,UAAUC,YAAYmF,KAAQjI,EAAOqC,YAAY9B,OAAS,GAC5DP,EAAO6C,UAAUC,YAAYzC,OAAUL,EAAOqC,YAAY9B,OAAS,GAGxEP,EAAO6C,UAAUC,YAAYmF,KAAQjI,EAAOqC,YAAY9B,OAAS,GAC3DP,EAAOqC,YAAY9B,OAAS,EAAKP,EAAO6C,UAAUC,YAAYzC,QAExEL,EAAO6C,UAAUC,YAAYzC,OAASL,EAAO6C,UAAUC,YAAYmF,KAAOjI,EAAO6C,UAAUC,YAAYvC,QAEpF,uBAAdgL,GAAoD,uBAAdA,IACvCvL,EAAO6C,UAAUC,YAAY1C,OAASJ,EAAOqC,YAAY/B,MAAQ,GACjEN,EAAO6C,UAAUC,YAAYkF,KAAQhI,EAAOqC,YAAY/B,MAAQ,GAC3DN,EAAO6C,UAAUC,YAAY1C,OAAUJ,EAAOqC,YAAY/B,MAAQ,GACvEN,EAAO6C,UAAUC,YAAYmF,KAAQjI,EAAOqC,YAAY9B,OAAS,GAC5DP,EAAO6C,UAAUC,YAAYzC,OAAUL,EAAOqC,YAAY9B,OAAS,KAGxEP,EAAO6C,UAAUC,YAAYkF,KAAQhI,EAAOqC,YAAY/B,MAAQ,GAAON,EAAOqC,YAAY/B,MAAQ,EAC9FN,EAAO6C,UAAUC,YAAY1C,QACjCJ,EAAO6C,UAAUC,YAAYmF,KAAQjI,EAAOqC,YAAY9B,OAAS,GAC3DP,EAAOqC,YAAY9B,OAAS,EAAKP,EAAO6C,UAAUC,YAAYzC,SAExEL,EAAO6C,UAAUC,YAAY1C,OAASJ,EAAO6C,UAAUC,YAAYkF,KAAOhI,EAAO6C,UAAUC,YAAYxC,MACvGN,EAAO6C,UAAUC,YAAYzC,OAASL,EAAO6C,UAAUC,YAAYmF,KAAOjI,EAAO6C,UAAUC,YAAYvC,QAE3GP,EAAO+C,OAAO,QAAUxB,KAAM,qBAAsByB,kBAAkB,EAAOvB,OAASmB,SAAU5C,EAAO6C,UAAUC,YAAaoB,IAAKlE,EAAO6C,UAClI4R,YAAa,KAAMhU,EAAG,KAAMC,EAAG,SAE3CqvC,EAAUjvC,UAAU8E,IAAM,SAAUnE,GAChC,GAAIzB,GAASC,KAAKD,QACbA,EAAOyL,UAAYzL,EAAO0L,gBACvBjK,GACAzB,EAAOie,WAAY,EACnBje,EAAO+C,OAAO,SAAWxB,KAAM,eAAgByB,kBAAkB,EAC7DvB,OAAShB,EAAG,KAAMC,EAAG,KAAM8a,YAAa,QAC5Cxb,EAAO+C,OAAO,aAAexB,KAAM,gBAAiBE,OAAS4E,MAAM,KACnErG,EAAOqC,YAAYyZ,MAAMgC,OAAS9d,EAAOwC,YAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS,OACpF9d,EAAO+C,OAAO,aAAexB,KAAM,aAAcyB,kBAAkB,EAAOvB,OAASu2B,QAAS,UAG5Fh4B,EAAOie,UAAYje,EAAO0F,YAAYC,cAAe,EACrD3F,EAAO+C,OAAO,aAAexB,KAAM,gBAAiBE,OAAS4E,MAAM,KACnErG,EAAOqC,YAAYyZ,MAAMgC,OAAS9d,EAAOwC,YAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS,aAIhGiyB,EAAUjvC,UAAUgc,KAAO,SAAUhZ,EAAYsD,GAC7C,GAAIpH,GAASC,KAAKD,MAClB,KAAKA,EAAOyL,UAAYzL,EAAO0L,cAAe,CAC1C,GAAIjK,GAAQxB,KAAK00C,qBAAqB7wC,EACtC,IAAI5B,oBAAkBkF,GAClBnH,KAAKwwC,WAAWhvC,EAAO2F,OAIvB,KAAK,GADDR,GAAOnF,EAAQ,EAAI,SAAW,UACzBwD,EAAI,EAAGA,EAAuB,GAAlBmD,KAAKC,IAAI5G,GAAcwD,IACxCjF,EAAO+C,OAAO,QAAUxB,KAAM,mBAAoByB,kBAAkB,EAChEvB,OAAShB,EAAG2G,EAAU3G,EAAGC,EAAG0G,EAAU1G,EAAGkG,KAAMA,OAKnEmpC,EAAUjvC,UAAU6zC,qBAAuB,SAAU7wC,GACjD,MAA2C,IAAnCA,EAAa7D,KAAKiwC,gBAE9BH,EAAUjvC,UAAUswC,iBAAmB,SAAU3iC,EAAQ7H,EAAM1C,GAC3D,GAAIqH,GAAYkD,CACD,MAAXA,EACa,eAAT7H,EACA2E,EAAY,aAEE,aAAT3E,IACL2E,EAAY,YAGA,eAAXkD,EACQ,eAAT7H,EACA2E,EAAY,qBAEE,aAAT3E,EACL2E,EAAY,qBAEE,KAAT3E,EACL2E,EAAY,YAEG,KAAV3E,IACL2E,EAAY,cAGA,aAAXkD,EACQ,eAAT7H,EACA2E,EAAY,qBAEE,aAAT3E,EACL2E,EAAY,qBAEE,KAAT3E,EACL2E,EAAY,cAEG,KAAV3E,IACL2E,EAAY,YAIH,eAAT3E,EACA2E,EAAY,WAEE,aAAT3E,IACL2E,EAAY,cAGpBrH,EAAe,UAAIqH,GAEvBwkC,EAAUjvC,UAAUiT,OAAS,SAAU7Q,EAAQgB,GAC3C,GAAIlE,GAASC,KAAKD,QAEbA,EAAOyL,UAAYzL,EAAO0L,eAAkBxI,EAAS,IAAO,GAC7DjD,KAAKqwC,YAAYptC,GAErBgB,EAAc,UAJC,GAMnB6rC,EAAUjvC,UAAU8nB,KAAO,SAAU9hB,GACjC,GAAI9G,GAASC,KAAKD,QACbA,EAAOyL,UAAYzL,EAAO0L,eAC3BzL,KAAKswC,UAAUzpC,IAGvBipC,EAAUjvC,UAAU6hB,OAAS,WACzB,GAAI3iB,GAASC,KAAKD,OACdsc,EAAgB,EAChBrR,GAAc,EACd2pC,GAAgBvuC,MAAM,EACtBrG,GAAO0L,iBACF1L,EAAOgO,QAAQoO,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,wBACvDjd,EAAOgO,QAAQoO,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,sBAAsBkP,cAAcjP,UAAUC,SAAS,WAC9Gnd,EAAOgO,QAAQoO,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,kBAChDjd,EAAOgO,QAAQoO,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,gBAAgBkP,cAAcjP,UAAUC,SAAS,aAChHnd,EAAOgO,QAAQoO,cAAc,iCAAiCc,UAAUa,IAAI,UAC5E/d,EAAO8zB,QACF3nB,aAKDnM,EAAO+N,cAAc/N,EAAOgO,QAAS,gBAJrChO,EAAO+C,OAAO,WAAaxB,KAAM,uBAAwByB,kBAAkB,IAC3EhD,EAAO+C,OAAO,WAAaxB,KAAM,qBAAsByB,kBAAkB,MAMjFhD,EAAO+C,OAAO,aAAexB,KAAM,yBAA0ByB,kBAAkB,EAAOvB,OAASyC,IAAK0wC,KAChGA,EAAkB,OACbzoC,aAIDnM,EAAO+N,cAAc/N,EAAOgO,QAAS,6BAHrChO,EAAO+C,OAAO,WAAaxB,KAAM,qBAAsByB,kBAAkB,SAMlD0Q,KAA3B1T,EAAO6C,UAAUwC,QACjB4F,GAAc,EACwB,UAAlCjL,EAAO+c,SAASjB,MAAMG,SACtBjc,EAAO+C,OAAO,SAAWxB,KAAM,eAAgByB,kBAAkB,EAC7DvB,OAAShB,EAAG,KAAMC,EAAG,KAAM8a,YAAa,QACvCrP,aAIDnM,EAAO+N,cAAc/N,EAAOgO,QAAS,6BAHrChO,EAAO+C,OAAO,WAAaxB,KAAM,qBAAsByB,kBAAkB,MAO7EhD,EAAO+C,OAAO,SAAWxB,KAAM,uBAAwByB,kBAAkB,IACzEhD,EAAOmF,QAAQe,KAAKlG,EAAO6C,YAE/B7C,EAAO+C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,KAG7E,IAAI0M,GAAazP,KAAKqC,aAAasC,OAC/BiwC,EAAgB73B,SAASZ,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,iBAgCrE,IA/BI43B,IACAA,EAAc/4B,MAAMxb,MAAQN,EAAOgO,QAAQ8mC,YAAc,EAAI,MAEjE90C,EAAOqC,YAAY/B,MAAQN,EAAOwC,YAAYlC,MAAQN,EAAOgO,QAAQ8mC,YAAc,EAC/E90C,EAAOqlB,gBACP/I,EAAgBtc,EAAOgO,QAAQoO,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,gBAAgBvY,aAElF1E,EAAOgO,QAAQoO,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,cAC5DX,EAAgBtc,EAAOgO,QAAQoO,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,YAAYvY,cAEvF1E,EAAO+C,OAAO,WAAaxB,KAAM,mBAAoBE,OAASlB,OAAQ+b,KAClEJ,UAAQC,UACJ04B,IACAA,EAAc/4B,MAAMvb,OAASP,EAAOgO,QAAQqO,aAAgB,EAAIC,EAAiB,EAAI,MAEzFtc,EAAOqC,YAAY9B,OAASP,EAAOwC,YAAYjC,OAASP,EAAOgO,QAAQqO,aAAgB,EAAIC,EAAiB,IAGxGu4B,IACAA,EAAc/4B,MAAMvb,OAASP,EAAOgO,QAAQqO,aAAeC,EAAgB,EAAI,MAEnFtc,EAAOqC,YAAY9B,OAASP,EAAOwC,YAAYjC,OAASP,EAAOgO,QAAQqO,aAAeC,EAAgB,GAE1Grc,KAAKqC,aAAasC,OACd,uHAEJ5E,EAAO+C,OAAO,UAAYxB,KAAM,qBAAsByB,kBAAkB,EAAOvB,OAAS6b,gBAAiBrd,KAAKqC,aAAasC,UAC3H5E,EAAOqd,aAAepd,KAAKqC,aAAasC,OACxC3E,KAAKD,OAAOud,uBAAyBtd,KAAKqC,aAAasC,OACvD5E,EAAOiiB,aAAahiB,KAAKqC,cACzBrC,KAAKD,OAAOiiB,aAAahiB,KAAKwC,cAC1BzC,EAAO0L,cAAe,CAYtB,GAXA1L,EAAO+C,OAAO,SAAWxB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAAS+Z,YAAa,QAC7Fxb,EAAO+C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,IACrE/C,KAAKqC,aAAasC,OAAS8K,EAC3B1P,EAAOud,uBAAyB7N,EAChC1P,EAAOqd,aAAepd,KAAKqC,aAAasC,OACpC5E,EAAO0L,gBACP6W,cAAYviB,EAAOgO,SACnBhO,EAAOgO,QAAQ8N,MAAMC,QAAU,OAEnC9b,KAAKqC,aAAa8B,UAAU,EAAG,EAAGpE,EAAOqC,YAAY/B,MAAON,EAAOqC,YAAY9B,QAC/EN,KAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOwC,YAAYlC,MAAON,EAAOwC,YAAYjC,QAC3Es0C,EAAe,CACfA,EAAc/4B,MAAMxb,MAAQN,EAAOgO,QAAQ8mC,YAAc,EAAI,KAC7DD,EAAc/4B,MAAMvb,OAASP,EAAOgO,QAAQqO,aAAe,IAC3D,IAAIpJ,IAAUqJ,cAAgBnQ,aAAiBnM,EAAOsc,cAAX,EACtCnQ,eACDnM,EAAO+C,OAAO,WAAaxB,KAAM,mBAAoBE,OAASyC,IAAK+O,KAEnEiJ,UAAQC,SACR04B,EAAc/4B,MAAMvb,OAAUqnB,WAAWitB,EAAc/4B,MAAMvb,QAAW,EAAI0S,EAAqB,cAAM,EAAI,KAG3G4hC,EAAc/4B,MAAMvb,OAAUqnB,WAAWitB,EAAc/4B,MAAMvb,QAAU0S,EAAqB,cAAK,EAAI,KAG7G,GAAI/O,IAAQ5D,MAAO,EAAGC,OAAQ,EAC9BP,GAAO+C,OAAO,aAAexB,KAAM,mBAAoByB,kBAAkB,EACrEvB,OAASnB,MAAON,EAAOqD,IAAIkB,SAAUhE,OAAQP,EAAOqD,IAAImB,UAAWN,IAAKA,IAC5E,IAAIC,GAAeD,CAOnB,IANIlE,EAAOiD,UAAU4C,kBAAoB,IACrC1B,EAAa7D,OAAU6D,EAAa7D,MAAQN,EAAOiD,UAAU4C,kBAC7D1B,EAAa5D,QAAW4D,EAAa5D,OAASP,EAAOiD,UAAU4C,mBAEnE7F,EAAOqD,IAAIC,UAAYtD,EAAOqC,YAAYoC,YAAcN,EAAa7D,OAAS,EAC9EN,EAAOqD,IAAIE,SAAWvD,EAAOqC,YAAYqC,aAAeP,EAAa5D,QAAU,EAC/C,IAA5BP,EAAOiD,UAAUC,QAAmD,KAAnClD,EAAOiD,UAAUU,cAC9C3D,EAAOiD,UAAU4C,kBAAoB,IACrC7F,EAAOqD,IAAIC,UAAYtD,EAAOsH,SAASC,iBAAiB9G,EACxDT,EAAOqD,IAAIE,SAAWvD,EAAOsH,SAASC,iBAAiB7G,GAE3DV,EAAO+C,OAAO,QAAUxB,KAAM,uBAAwBE,OAASwM,UAAW9J,SAEzE,CACDnE,EAAO+C,OAAO,QAAUxB,KAAM,uBAAwBE,OAASwM,UAAW9J,KAC1EnE,EAAO+C,OAAO,QAAUxB,KAAM,uBAAwByB,kBAAkB,EACpEvB,OAASmF,KAAM,UAAWgB,qBAAsB,KAAMwT,YAAa,OACvE,IAAIzW,GAAO1E,KAAKqC,aAAasC,MAC7B5E,GAAO+C,OAAO,UAAYxB,KAAM,qBAAsByB,kBAAkB,IACxE/C,KAAKqC,aAAauC,UAAU7E,EAAO8E,QAAS9E,EAAOqD,IAAIgB,QAASrE,EAAOqD,IAAIiB,OAAQtE,EAAOqD,IAAIkB,SAAUvE,EAAOqD,IAAImB,UAAWxE,EAAOqD,IAAIC,SAAUtD,EAAOqD,IAAIE,QAASvD,EAAOqD,IAAIG,UAAWxD,EAAOqD,IAAII,YACxMxD,KAAKqC,aAAasC,OAASD,EAC3B3E,EAAO+C,OAAO,QAAUxB,KAAM,uBAAwByB,kBAAkB,EACpEvB,OAASmF,KAAM,UAAWgB,qBAAsB,KAAMwT,YAAa,QAE3Epb,EAAO+C,OAAO,SAAWxB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAASuD,eAAgB,QAChGhF,EAAO+C,OAAO,iBAAmBxB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAASuD,eAAgB,QACpGhF,EAAOyF,cACPzF,EAAO+C,OAAO,QAAUxB,KAAM,aAAcyB,kBAAkB,EAC1DvB,OAAS+D,QAASvF,KAAKqC,aAAc+H,OAAQ,KAAMC,OAAQ,QAEnEuR,cAAY7b,EAAOgO,SACnBhO,EAAOgO,QAAQ8N,MAAMC,QAAU,GAC/B,IAAIg5B,IAAStyB,gBAAiB,KAsC9B,IArCKtW,eACDnM,EAAO+C,OAAO,WAAaxB,KAAM,qBAAsBE,OAASyC,IAAK6wC,KACjEA,EAAsB,iBAAKA,EAAsB,gBAAE3vC,OAAS,GAAK4X,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,cAE7FkG,eAAanjB,EAAOgO,QAAQiP,GAAK,WAAY,WACnD+3B,kBACNh1C,EAAOgO,QAAQoO,cAAc,kCAC7Bpc,EAAOgO,QAAQoO,cAAc,iCAAiCc,UAAUa,IAAI,YAIxF/d,EAAO+C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,IACrE/C,KAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOwC,YAAYlC,MAAON,EAAOwC,YAAYjC,QAC3E0K,IACAjL,EAAO6C,UAAYoB,YAAWjE,EAAOmF,QAAQnF,EAAOmF,QAAQC,OAAS,GAAI,MAAM,GAC/EpF,EAAOmF,QAAQwB,MAC4B,IAAvC3G,EAAO6C,UAAUC,YAAYxC,OAAuD,IAAxCN,EAAO6C,UAAUC,YAAYvC,SACzEP,EAAO+C,OAAO,QAAUxB,KAAM,aAAcyB,kBAAkB,EAAOvB,OAAS6D,OAAQ,YAAapB,IAAKlE,EAAO6C,aAChF,cAA3B7C,EAAO6C,UAAUwC,OAAoD,YAA3BrF,EAAO6C,UAAUwC,OAAkD,SAA3BrF,EAAO6C,UAAUwC,OACxE,SAA3BrF,EAAO6C,UAAUwC,OAA+C,UAA3BrF,EAAO6C,UAAUwC,OAAgD,SAA3BrF,EAAO6C,UAAUwC,QACvF8G,aAIDnM,EAAO+N,cAAc/N,EAAOgO,QAAS,qBAAsBhO,EAAO6C,UAAUwC,OAH5ErF,EAAO+C,OAAO,WAAaxB,KAAM,YAAayB,kBAAkB,EAAOvB,OAASw+B,UAAW,WAQvG2U,EAAkB,OACbzoC,aAIDnM,EAAO+N,cAAc/N,EAAOgO,QAAS,qBAAsB,OAH3DhO,EAAO+C,OAAO,WAAaxB,KAAM,YAAayB,kBAAkB,EAAOvB,OAASw+B,WAAW,OAMlE,IAA5BjgC,EAAOiD,UAAUC,QAAmD,KAAnClD,EAAOiD,UAAUU,gBAAyB3D,EAAOiD,UAAU4C,kBAAoB,EAAG,CACpH,GAAI0B,GAAmBtD,YAAWjE,EAAOsH,SAASC,iBAAkB,MAAM,GACtE2B,EAA2BjF,YAAWjE,EAAOsH,SAAS4B,yBAA0B,MAAM,GACtFc,EAAyB/F,YAAWjE,EAAOsH,SAAS0C,uBAAwB,MAAM,EACtFhK,GAAO+C,OAAO,aAAexB,KAAM,aAAcyB,kBAAkB,EAC/DvB,OAASqC,WAAY,GAAIsD,UAAW,QACxCpH,EAAO+C,OAAO,aAAexB,KAAM,aAAcyB,kBAAkB,EAC/DvB,OAASqC,YAAa,GAAIsD,UAAW,QACT,IAA5BpH,EAAOiD,UAAUC,QACjBlD,EAAOqD,IAAIC,UAAYiE,EAAiB9G,EACxCT,EAAOqD,IAAIE,SAAWgE,EAAiB7G,EACvCV,EAAOsH,SAASC,iBAAmBA,EACnCvH,EAAO+C,OAAO,QAAUxB,KAAM,gBAAiBE,OAAS2d,iBAAkB,UAG1Epf,EAAOsH,SAAS4B,yBAA2BA,EAC3ClJ,EAAOsH,SAAS0C,uBAAyBA,EACzChK,EAAOsH,SAAS4C,oBAAuBzJ,EAAG,EAAGC,EAAG,GAChDV,EAAOqe,WAAY,EACnBre,EAAO+C,OAAO,aAAexB,KAAM,YAAayB,kBAAkB,EAC9DvB,OAAS0c,gBAAiB,KAAM4D,cAAe,QACnD/hB,EAAOqe,WAAY,OAGU,KAA5Bre,EAAOiD,UAAUC,QAAgBlD,EAAOiD,UAAUsc,eAAiB,IACxEvf,EAAOiD,UAAUa,WAAa,EAC9B9D,EAAOiD,UAAUsc,eAAiB,KAC7BpT,aAIDnM,EAAO+N,cAAc/N,EAAOgO,QAAS,2BAHrChO,EAAO+C,OAAO,WAAaxB,KAAM,sBAAuByB,kBAAkB,OAQ1F+sC,EAAUjvC,UAAUuwC,iBAAmB,SAAU/wC,EAAOC,EAAQ2D,GAC5D,GAAI6B,IAAWuW,cAAe,EACzBnQ,cAIDpG,EAAsB,cAAI9F,KAAKD,OAAOsc,cAHtCrc,KAAKD,OAAO+C,OAAO,WAAaxB,KAAM,mBAAoBE,OAASyC,IAAK6B,IAK5E,IAAIkvC,GAAiBh1C,KAAKD,OAAOgO,QAAQvJ,YACrCywC,EAAkBj1C,KAAKD,OAAOgO,QAAQtJ,aAAeqB,EAAsB,aAC/EmvC,GAAkBh5B,UAAQC,SAAW+4B,EAAkBnvC,EAAsB,cAAImvC,EAC7ED,EAAiB,KACjBA,GAAkB,IAElBC,EAAkB,KAClBA,GAAmB,GAEvB,IAAIC,GAAaF,EAAiB30C,EAC9B80C,EAAcF,EAAkB30C,EAChC80C,EAAcjtC,KAAK6Y,IAAI3gB,EAAO20C,GAC9BK,EAAeltC,KAAK6Y,IAAI1gB,EAAQ20C,EAChCC,GAAa,GAAKA,EAAaC,GAC/BC,EAAc/0C,EAAQ60C,EACtBG,EAAe/0C,EAAS40C,GAEnBC,EAAc,GAAKA,EAAcD,IACtCE,EAAc/0C,EAAQ80C,EACtBE,EAAe/0C,EAAS60C,EAE5B,IAAInvC,IAAYI,KAAM,KAYtB,OAXApG,MAAKD,OAAO+C,OAAO,QAAUxB,KAAM,oBAAqByB,kBAAkB,EACtEvB,OAASyC,IAAK+B,KACdA,EAAc,MAAKhG,KAAKD,OAAOiG,QAAQpD,UAAUC,aACG,IAApD7C,KAAKD,OAAOiG,QAAQpD,UAAUC,YAAYxC,OAAoE,IAArDL,KAAKD,OAAOiG,QAAQpD,UAAUC,YAAYvC,SACnG80C,EAAcp1C,KAAKD,OAAOiG,QAAQpD,UAAUC,YAAYxC,MACxDg1C,EAAer1C,KAAKD,OAAOiG,QAAQpD,UAAUC,YAAYvC,QAEzD2D,IACAA,EAAW,MAAImxC,EACfnxC,EAAY,OAAIoxC,IAEXh1C,MAAO+0C,EAAa90C,OAAQ+0C,IAEzCvF,EAAUjvC,UAAUwwC,gBAAkB,SAAU/lC,EAAWrH,GACvD,GAAIlE,GAASC,KAAKD,OACdu1C,EAAatxC,YAAWjE,EAAO6C,cAAe,GAC9C2yC,EAAex1C,EAAOqD,IAAIC,SAC1BmyC,EAAcz1C,EAAOqD,IAAIE,OACzBrB,qBAAkBjC,KAAKyiC,eACvBziC,KAAKyiC,aAAgBjiC,EAAGR,KAAK0iC,QAAQliC,EAAGC,EAAGT,KAAK0iC,QAAQjiC,GAE5D,IAAIyJ,GAAQlK,KAAK0iC,QAAQliC,EAAIR,KAAKyiC,YAAYjiC,EAC1C2J,EAAQnK,KAAK0iC,QAAQjiC,EAAIT,KAAKyiC,YAAYhiC,CAC9C,QAAQ6K,GACJ,IAAK,GACDvL,EAAOqD,IAAIC,UAAY6G,EACvBnK,EAAOqD,IAAIE,SAAW6G,CACtB,MACJ,KAAK,aACDnK,KAAKkxC,oBAAoB5lC,GACzBpB,EAAQlK,KAAKyiC,YAAYjiC,EAAIR,KAAK0iC,QAAQliC,EAC1CT,EAAOqD,IAAIC,UAAY6G,EACvBnK,EAAOqD,IAAIE,SAAW6G,CACtB,MACJ,KAAK,WACDnK,KAAKkxC,oBAAoB5lC,GACzBnB,EAAQnK,KAAKyiC,YAAYhiC,EAAIT,KAAK0iC,QAAQjiC,EAC1CV,EAAOqD,IAAIC,UAAY6G,EACvBnK,EAAOqD,IAAIE,SAAW6G,CACtB,MACJ,KAAK,qBACDnK,KAAKkxC,oBAAoB5lC,GACzBpB,EAAQlK,KAAKyiC,YAAYjiC,EAAIR,KAAK0iC,QAAQliC,EAC1CT,EAAOqD,IAAIC,UAAY6G,EACvBnK,EAAOqD,IAAIE,SAAW6G,CACtB,MACJ,KAAK,qBACDnK,KAAKkxC,oBAAoB5lC,GACzBnB,EAAQnK,KAAKyiC,YAAYhiC,EAAIT,KAAK0iC,QAAQjiC,EAC1CV,EAAOqD,IAAIC,UAAY6G,EACvBnK,EAAOqD,IAAIE,SAAW6G,EAS9B,MANAnK,MAAKixC,WACLlxC,EAAO6C,UAAY0yC,EACfrxC,IACAA,EAAO,EAAIlE,EAAOqD,IAAIC,SAAWkyC,EACjCtxC,EAAO,EAAIlE,EAAOqD,IAAIE,QAAUkyC,IAE3Bh1C,EAAGT,EAAOqD,IAAIC,SAAWkyC,EAAc90C,EAAGV,EAAOqD,IAAIE,QAAUkyC,IAErE1F,KC30DP2F,EAA0B,WAC1B,QAASA,GAAS11C,GACdC,KAAK01C,aAAe,EACpB11C,KAAK21C,gBACL31C,KAAK8e,uBACL9e,KAAK41C,oBACL51C,KAAK0P,iBAAmB,EACxB1P,KAAKD,OAASA,EACdC,KAAKY,mBAsxBT,MApxBA60C,GAAS50C,UAAUC,QAAU,WACrBd,KAAKD,OAAOgB,aAGhBf,KAAKgB,uBAETy0C,EAAS50C,UAAUD,iBAAmB,WAClCZ,KAAKD,OAAOkB,GAAG,YAAajB,KAAK61C,SAAU71C,MAC3CA,KAAKD,OAAOkB,GAAG,YAAajB,KAAKc,QAASd,OAE9Cy1C,EAAS50C,UAAUG,oBAAsB,WACrChB,KAAKD,OAAOoB,IAAI,YAAanB,KAAK61C,UAClC71C,KAAKD,OAAOoB,IAAI,YAAanB,KAAKc,UAEtC20C,EAAS50C,UAAUi1C,oBAAsB,WACjC91C,KAAKD,OAAOqC,cACZpC,KAAKqC,aAAerC,KAAKD,OAAOqC,YAAYE,WAAW,OAEvDtC,KAAKD,OAAOwC,cACZvC,KAAKwC,aAAexC,KAAKD,OAAOwC,YAAYD,WAAW,QAG/DmzC,EAAS50C,UAAUg1C,SAAW,SAAUz0C,GAEpC,OADApB,KAAK81C,sBACG10C,EAAKE,MACT,IAAK,qBACDtB,KAAK+1C,UAAU30C,EAAKI,MAAiB,UAAGJ,EAAKI,MAAmB,YAAGJ,EAAKI,MAAuB,gBAAGJ,EAAKI,MAAyB,kBAAGJ,EAAKI,MAA4B,qBAAGJ,EAAKI,MAAuB,gBAAGJ,EAAKI,MAAoB,aAAGJ,EAAKI,MAAmB,YAAGJ,EAAKI,MAAsB,eAAGJ,EAAKI,MAAoB,aACpT,MACJ,KAAK,aACDxB,KAAKg2C,WAAW50C,EAAKI,MAAY,KACjC,MACJ,KAAK,gBACDxB,KAAKi2C,cAAc70C,EAAKI,MAAY,KACpC,MACJ,KAAK,YACDxB,KAAKk2C,UACL,MACJ,KAAK,YACDl2C,KAAKm2C,UACL,MACJ,KAAK,OACDn2C,KAAKo2C,MACL,MACJ,KAAK,OACDp2C,KAAKq2C,MACL,MACJ,KAAK,cACDr2C,KAAKs2C,YAAYl1C,EAAKI,MAAe,QACrC,MACJ,KAAK,iBACDxB,KAAKu2C,gBACL,MACJ,KAAK,yBACDn1C,EAAKI,MAAW,IAAuB,oBAAIxB,KAAK8e,mBAChD,MACJ,KAAK,kBACD1d,EAAKI,MAAW,IAAgB,aAAIxB,KAAK01C,YACzC,MACJ,KAAK,kBACD11C,KAAK01C,aAAet0C,EAAKI,MAAY,IACrC,MACJ,KAAK,cACDxB,KAAKw2C,YAAYp1C,EAAKI,MAAW,IACjC,MACJ,KAAK,QACDxB,KAAKkC,UAIjBuzC,EAAS50C,UAAUsB,cAAgB,WAC/B,MAAO,aAEXszC,EAAS50C,UAAUqB,MAAQ,WACvBlC,KAAKy2C,iBAAmB,KACxBz2C,KAAK01C,aAAe,EACpB11C,KAAK21C,gBACL31C,KAAK8e,uBACL9e,KAAKs1C,WAAa,KAClBt1C,KAAK41C,oBACL51C,KAAK0P,iBAAmB,GAE5B+lC,EAAS50C,UAAUm1C,WAAa,SAAUU,GACtC,GAAI32C,GAASC,KAAKD,QAClB22C,EAAiBA,IAAkC,IAE1CxqC,cACDnM,EAAO+C,OAAO,WAAaxB,KAAM,2BAA4BE,OAAS6d,WAAW,KAErFrf,KAAK41C,iBAAmB5xC,YAAWhE,KAAK8e,wBAAyB,GACjE9e,KAAK0P,iBAAmB1P,KAAK01C,cAEvBxpC,cACNnM,EAAO+C,OAAO,WAAaxB,KAAM,2BAA4BE,OAAS6d,WAAW,KAErFrf,KAAK21C,aAAe31C,KAAK21C,aAAajxB,MAAM,EAAG1kB,KAAK01C,cACpD11C,KAAK8e,oBAAsB9e,KAAK8e,oBAAoB4F,MAAM,EAAG1kB,KAAK01C,cAClE31C,EAAOmH,WAAanH,EAAO0F,YAAYmG,cAAe,EACjDM,aAIDnM,EAAO+N,cAAc/N,EAAOgO,QAAS,2BAHrChO,EAAO+C,OAAO,WAAaxB,KAAM,yBAMzCm0C,EAAS50C,UAAUo1C,cAAgB,SAAUtvC,GACzC,GAAI5G,GAASC,KAAKD,MAIlB,IAHKmM,cACDnM,EAAO+C,OAAO,WAAaxB,KAAM,2BAA4BE,OAAS6d,WAAW,KAExE,OAAT1Y,EAAe,CACf5G,EAAO+C,OAAO,QAAUxB,KAAM,qBAAsByB,kBAAkB,EAAOvB,OAAS4E,MAAM,IAC5F,IAAIkI,GAAatO,KAAK41C,iBAAiBzwC,OAAS,EAC5CnB,YAAWhE,KAAK41C,qBAAsB,GACtC5xC,YAAWhE,KAAK21C,iBAAkB,GAClC5oC,EAAU/M,KAAK21C,aAAa31C,KAAK21C,aAAaxwC,OAAS,EAiB3D,IAhBIlD,oBAAkBjC,KAAK8e,oBAAoB9e,KAAK8e,oBAAoB3Z,OAAS,IACzEnF,KAAK21C,aAAa,KAClB5oC,EAAQW,gBAAkBY,EAAW,GAAGZ,gBACxCX,EAAQO,YAAcgB,EAAW,GAAGhB,YACpCP,EAAQQ,gBAAkBe,EAAW,GAAGf,gBACxCR,EAAQS,kBAAoBc,EAAW,GAAGd,kBAC1CT,EAAQY,aAAeW,EAAW,GAAGX,eAIzCZ,EAAQW,gBAAkB1N,KAAK8e,oBAAoB9e,KAAK8e,oBAAoB3Z,OAAS,GAAGwxC,eACxF5pC,EAAQO,YAActN,KAAK8e,oBAAoB9e,KAAK8e,oBAAoB3Z,OAAS,GAAGyxC,WACpF7pC,EAAQQ,gBAAkBvN,KAAK8e,oBAAoB9e,KAAK8e,oBAAoB3Z,OAAS,GAAG4Z,eACxFhS,EAAQS,kBAAoBxN,KAAK8e,oBAAoB9e,KAAK8e,oBAAoB3Z,OAAS,GAAG0xC,iBAC1F9pC,EAAQY,aAAe3N,KAAK8e,oBAAoB9e,KAAK8e,oBAAoB3Z,OAAS,GAAGyI,aAErFb,EAAS,CACT,GAAI9I,GAAMjE,KAAK82C,yBAAyB/pC,EAAQgS,eAAgBhS,EAAQ8pC,iBACxE9pC,GAAQgS,eAAiB9a,EAAS,IAClC8I,EAAQ8pC,iBAAmB5yC,EAAW,MACtCjE,KAAK8e,oBAAoB7Y,KAAK8G,GAElC/M,KAAK41C,oBACL51C,KAAK0P,iBAAmB,MAEnB1P,MAAK41C,iBAAiBzwC,OAAS,IACpCnF,KAAK8e,oBAAsB9a,YAAWhE,KAAK41C,qBAAsB,GACjE51C,KAAK01C,aAAe11C,KAAK0P,iBACzB1P,KAAK41C,oBACL51C,KAAK0P,iBAAmB,EAExB1P,MAAK8e,oBAAoB3Z,OAAS,IAClCnF,KAAK8e,oBAAoBqjB,OAAO,EAAG,GAEvCniC,KAAK21C,gBACL31C,KAAK21C,aAAe3xC,YAAWhE,KAAK8e,wBAAyB,GAChD,OAATnY,IACA3G,KAAK01C,aAAe11C,KAAK21C,aAAaxwC,OACjC+G,aAIDnM,EAAO+N,cAAc/N,EAAOgO,QAAS,2BAHrChO,EAAO+C,OAAO,WAAaxB,KAAM,yBAMrCvB,EAAOiD,UAAUa,WAAa,IAC9B9D,EAAOie,WAAY,EACnBje,EAAO+C,OAAO,aAAexB,KAAM,gBAAiBE,OAAS4E,MAAM,OAG3EqvC,EAAS50C,UAAUqe,oBAAsB,WACrC,GAEIxS,GAFA3M,EAASC,KAAKD,OACdme,GAAkB,CAElBne,GAAO6C,UAAUwC,QACjBsH,EAAa3M,EAAO6C,UAAUwC,MAAMuH,MAAM,OAE1C5M,EAAO0F,YAAYC,cAAiBgH,GAAgC,SAAlBA,EAAW,MAC7DwR,GAAkB,GAElBA,GACAne,EAAO+C,OAAO,QAAUxB,KAAM,gBAAiBE,OAASgI,oBAAqB,QAE5C,IAAjCxJ,KAAK41C,iBAAiBzwC,QAA0C,IAA1BnF,KAAK0P,mBAC3C1P,KAAK8e,oBAAsB9a,YAAWhE,KAAK41C,qBAAsB,GACjE51C,KAAK21C,aAAe3xC,YAAWhE,KAAK41C,qBAAsB,GAC1D51C,KAAK01C,aAAe11C,KAAK0P,iBACzB1P,KAAK41C,oBACL51C,KAAK0P,iBAAmB,EACnBxD,cACDnM,EAAO+C,OAAO,WAAaxB,KAAM,2BAA4BE,OAAS6d,WAAW,OAI7Fo2B,EAAS50C,UAAUk2C,sBAAwB,WACvC,GAAIh3C,GAASC,KAAKD,MACbmM,cAUIjK,oBAAkBlC,EAAO6C,UAAUwC,QACxCrF,EAAO+N,cAAc/N,EAAOgO,QAAS,eAVjChO,EAAO6C,UAAUwC,OACjBrF,EAAO+C,OAAO,WAAaxB,KAAM,kBAAmByB,kBAAkB,EAAOvB,OAASmF,KAAM,SACpF8C,WAAY,KAAMC,WAAY,KAAMC,UAAW,KAAMC,MAAO,QACpE7J,EAAO+C,OAAO,WAAaxB,KAAM,uBAAwByB,kBAAkB,KAG3EhD,EAAO+C,OAAO,WAAaxB,KAAM,uBAAwByB,kBAAkB,KAOvF0yC,EAAS50C,UAAUm2C,oBAAsB,WACrC,GAAIj3C,GAASC,KAAKD,MAClBA,GAAO0F,YAAY0X,YAAa,EACI,IAAhCpd,EAAOiD,UAAUa,aACjB9D,EAAOie,WAAY,EACnBje,EAAO+C,OAAO,aAAexB,KAAM,gBAAiBE,OAAS4E,MAAM,MAEnErG,EAAOgO,QAAQoO,cAAc,mCAAqCjQ,cAClEnM,EAAOgO,QAAQoO,cAAc,iCAAiCc,UAAUa,IAAI,UAE5E/d,EAAOse,YACPte,EAAOse,WAAY,EACnBte,EAAOwC,YAAYsZ,MAAMgC,OAAS9d,EAAO8d,OAAS,UAClD7d,KAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOwC,YAAYlC,MAAON,EAAOwC,YAAYjC,SAE/EN,KAAK8e,oBAAoB3Z,OAAS,IAClCnF,KAAK21C,aAAe3xC,YAAWhE,KAAK8e,wBAAyB,KAGrE22B,EAAS50C,UAAUq1C,SAAW,WAC1Bl2C,KAAKg3C,sBACLh3C,KAAKo2C,QAETX,EAAS50C,UAAUs1C,SAAW,WAC1Bn2C,KAAKg3C,sBACLh3C,KAAKq2C,QAETZ,EAAS50C,UAAUu1C,KAAO,WACtB,GAAIr2C,GAASC,KAAKD,MAElB,IADAC,KAAKkf,uBACAnf,EAAOyL,UAAYzL,EAAO0L,eACvBzL,KAAK01C,aAAe,EAAG,CACvB11C,KAAK+2C,wBACDh3C,EAAO6C,UAAUC,aAAsD,IAAvC9C,EAAO6C,UAAUC,YAAYxC,QAC7DL,KAAKs1C,WAAav1C,EAAO6C,WAE7B7C,EAAO+C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,IACrE/C,KAAK01C,eACAxpC,aAODnM,EAAO+N,cAAc/N,EAAOgO,QAAS,4BANrChO,EAAO+C,OAAO,WAAaxB,KAAM,wBAC7BvB,EAAOgO,QAAQoO,cAAc,kCAC7Bpc,EAAOgO,QAAQoO,cAAc,iCAAiCc,UAAUa,IAAI,WAMpF/d,EAAOmH,YAAa,CACpB,IAAIjD,GAAMjE,KAAK21C,aAAa31C,KAAK01C,aAC7B11C,MAAK21C,aAAaxwC,SAAWnF,KAAK01C,aAClC31C,EAAO0F,YAAYmG,cAAe,EAGlC7L,EAAO0F,YAAYmG,cAAe,EAEhB,0BAAlB3H,EAAIoJ,WAA2E,UAAlCtN,EAAO+c,SAASjB,MAAMG,UACnEjc,EAAO+c,SAASjB,MAAMG,QAAU,QAEpCjc,EAAO+C,OAAO,QAAUxB,KAAM,kBAAmByB,kBAAkB,EAAOvB,OAAS4E,MAAM,IAMzF,QAJArG,EAAOiG,QAAUhC,YAAWC,EAAIyJ,oBAAqB,GACrD3N,EAAO8F,iBAAmB5B,EAAIqJ,YAAYzH,iBAC1C7F,KAAKqC,aAAasC,OAASV,EAAIqJ,YAAY3I,OAC3C5E,EAAOqd,aAAepd,KAAKqC,aAAasC,OAChCV,EAAIoJ,WACR,IAAK,iBACDrN,KAAKi3C,eAAehzC,EAAIsJ,gBACxB,MACJ,KAAK,eACL,IAAK,gBACDvN,KAAKk3C,mBAAmBjzC,EAAIuJ,kBAC5B,MACJ,KAAK,yBACDxN,KAAKm3C,6BAA6BlzC,EAAIuJ,kBACtC,MACJ,KAAK,wBACL,IAAK,YACDxN,KAAKo3C,aAAanzC,EAAIoJ,UAAWpJ,EAAIsJ,gBAAiBtJ,EAAIuJ,kBAC1D,MACJ,KAAK,wBACDxN,KAAKq3C,gCArBG,GAqBoCpzC,EAAIsJ,gBAChD,MACJ,KAAK,OACDvN,KAAKs3C,WAAWrzC,EAAIsJ,iBAAiB,EACrC,MACJ,SACIvN,KAAKw2C,YAAYvyC,GACjBlE,EAAO+C,OAAO,UAAYxB,KAAM,iBAAkBE,OAAS6L,UAAWpJ,EAAIoJ,aAC1EtN,EAAO+C,OAAO,UAAYxB,KAAM,gBAAiBE,OAAS6L,UAAWpJ,EAAIoJ,UAAW1I,OAAQV,EAAIU,UAGlF,SAAlBV,EAAIoJ,YACApJ,EAAIqJ,YAAYvJ,qBAChBhE,EAAOgE,mBAAqBC,YAAWC,EAAIqJ,YAAYvJ,uBAAwB,GAC3EhE,EAAOgE,oBAAsB9B,oBAAkBlC,EAAOgE,mBAAmBqB,SACzErF,EAAOgE,mBAAqB,OAGpChE,EAAOw3C,2BACPx3C,EAAOuR,OAAO,UACVvR,EAAOyF,eACPzF,EAAOyF,cAAe,EACtBxF,KAAKy2C,iBAAmBzyC,YAAWjE,EAAOgE,uBAAwB,GAClEhE,EAAOgE,mBAAqB,MAEhChE,EAAO+C,OAAO,QAAUxB,KAAM,gBAAiBE,OAASgI,oBAAqB,SAE5ExJ,KAAK21C,aAAa31C,KAAK01C,aAAe,IACpC11C,KAAK21C,aAAa31C,KAAK01C,aAAe,GAAGlwC,eAC5CzF,EAAOyF,cAAe,EACtBzF,EAAO+C,OAAO,QAAUxB,KAAM,aAAcyB,kBAAkB,EAC1DvB,OAAS+D,QAASvF,KAAKqC,aAAc+H,OAAQ,KAAMC,OAAQ,SAEnErK,KAAKw3C,YAAYvzC,EAAIoJ,WAAW,KAI5CooC,EAAS50C,UAAUw1C,KAAO,WACtB,GAAIt2C,GAASC,KAAKD,MAElB,IADAC,KAAKkf,uBACAnf,EAAOyL,UAAYzL,EAAO0L,eACvBzL,KAAK01C,aAAe11C,KAAK8e,oBAAoB3Z,OAAQ,CACrDnF,KAAK+2C,wBACL/2C,KAAK01C,eACAxpC,aAIDnM,EAAO+N,cAAc/N,EAAOgO,QAAS,2BAHrChO,EAAO+C,OAAO,WAAaxB,KAAM,wBAKrCvB,EAAOmH,YAAa,CACpB,IAAIjD,GAAMjE,KAAK21C,aAAa31C,KAAK01C,aAAe,EAC5C11C,MAAK21C,aAAaxwC,SAAWnF,KAAK01C,aAClC31C,EAAO0F,YAAYmG,cAAe,EAGlC7L,EAAO0F,YAAYmG,cAAe,EAEhB,0BAAlB3H,EAAIoJ,WAA2E,UAAlCtN,EAAO+c,SAASjB,MAAMG,UACnEjc,EAAO+c,SAASjB,MAAMG,QAAU,QAEpCjc,EAAO+C,OAAO,QAAUxB,KAAM,kBAAmByB,kBAAkB,EAAOvB,OAAS4E,MAAM,KACzFrG,EAAOiG,QAAUhC,YAAWC,EAAI0yC,mBAAoB,GACpD52C,EAAO8F,iBAAmB5B,EAAI2yC,WAAW/wC,iBACzC7F,KAAKqC,aAAasC,OAASV,EAAI2yC,WAAWjyC,QACrCuH,cAAcnM,EAAOgO,QAAQoO,cAAc,kCAC5Cpc,EAAOgO,QAAQoO,cAAc,iCAAiCc,UAAUa,IAAI,UAEhF/d,EAAOqd,aAAepd,KAAKqC,aAAasC,MACxC,IAAI/B,OAAY,EAChB,QAAQqB,EAAIoJ,WACR,IAAK,iBACDrN,KAAKi3C,eAAehzC,EAAI8a,eACxB,MACJ,KAAK,eACL,IAAK,gBACD/e,KAAKk3C,mBAAmBjzC,EAAI4yC,iBAC5B,MACJ,KAAK,yBACD72C,KAAKm3C,6BAA6BlzC,EAAI4yC,iBACtC,MACJ,KAAK,wBACL,IAAK,YACD72C,KAAKo3C,aAAanzC,EAAIoJ,UAAWpJ,EAAI8a,eAAgB9a,EAAI4yC,iBACzD,MACJ,KAAK,wBACD72C,KAAKq3C,4BAA4Bz0C,EAAWqB,EAAI8a,eAChD,MACJ,KAAK,OACD/e,KAAKs3C,WAAWrzC,EAAI8a,gBAAgB,EACpC,MACJ,SACIhf,EAAOmF,WACPnF,EAAOkH,aACPlH,EAAOiH,gBAAkB,EACzBjH,EAAO+C,OAAO,iBAAmBxB,KAAM,kBAAmByB,kBAAkB,EACxEvB,OAASyC,KAAOmF,oBACpBrJ,EAAO+C,OAAO,QAAUxB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAASyC,IAAKA,EAAI2yC,cAC1F72C,EAAOqD,IAAIC,SAAWY,EAAI2yC,WAAWztC,WAAWhJ,OAChDJ,EAAOqD,IAAIE,QAAUW,EAAI2yC,WAAWztC,WAAW/I,OAC/CwC,EAAYoB,YAAWjE,EAAO6C,cAAe,GAC7C7C,EAAOmF,QAAUlB,YAAWC,EAAI8a,mBAAoB,GACpDhf,EAAOkH,UAAYjD,YAAWC,EAAI4yC,qBAAsB,GACxD92C,EAAOiH,gBAAkBjH,EAAOkH,UAAU9B,OAC1CpF,EAAO+C,OAAO,iBAAmBxB,KAAM,kBAAmByB,kBAAkB,EACxEvB,OAASyC,KAAOmF,aAAcpF,YAAWC,EAAIwzC,wBAAyB,OAC1Ez3C,KAAKqC,aAAasC,OAAS,OAC3B5E,EAAO+C,OAAO,SAAWxB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAASuD,eAAgB,QAChGhF,EAAO+C,OAAO,iBAAmBxB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAASuD,eAAgB,QACxG/E,KAAKqC,aAAasC,OAASV,EAAI2yC,WAAWjyC,OAC1C5E,EAAO6C,UAAYA,EACnB5C,KAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOwC,YAAYlC,MAAON,EAAOwC,YAAYjC,QACpC,IAAvCP,EAAO6C,UAAUC,YAAYxC,OAAuD,IAAxCN,EAAO6C,UAAUC,YAAYvC,QACzEP,EAAO+C,OAAO,QAAUxB,KAAM,aAAcyB,kBAAkB,EAAOvB,OAAS6D,OAAQ,eAE1FtF,EAAO+C,OAAO,UAAYxB,KAAM,iBAAkBE,OAAS6L,UAAWpJ,EAAIoJ,aAC1EtN,EAAO+C,OAAO,UAAYxB,KAAM,gBAAiBE,OAAS6L,UAAWpJ,EAAIoJ,aAG3D,SAAlBpJ,EAAIoJ,WAAwBpJ,EAAIuB,eAChCzF,EAAOyF,cAAe,EACtBzF,EAAOgE,mBAAqBC,YAAWhE,KAAKy2C,qBAAsB,GAClEz2C,KAAKy2C,iBAAmB,MAEN,SAAlBxyC,EAAIoJ,WAAyBpJ,EAAIuB,eACjCzF,EAAOyF,cAAe,GAEJ,SAAlBvB,EAAIoJ,WAAwBpJ,EAAI2yC,WAAW7yC,qBAC3ChE,EAAOgE,mBAAqBC,YAAWC,EAAI2yC,WAAW7yC,uBAAwB,IAE9EhE,EAAOgE,oBAAsB9B,oBAAkBlC,EAAOgE,mBAAmBqB,SACzErF,EAAOgE,mBAAqB,MAEhC/D,KAAKw3C,YAAYvzC,EAAIoJ,WAAW,KAI5CooC,EAAS50C,UAAUo2C,eAAiB,SAAU/xC,GAC1C,GAAInF,GAASC,KAAKD,MAClBA,GAAOmF,QAAUlB,YAAWkB,MAAa,GACzCnF,EAAO+C,OAAO,SAAWxB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAASuD,eAAgB,QAChG/E,KAAKqC,aAAa8B,UAAU,EAAG,EAAGpE,EAAOqC,YAAY/B,MAAON,EAAOqC,YAAY9B,QAC/EN,KAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOwC,YAAYlC,MAAON,EAAOwC,YAAYjC,QAC/EP,EAAOmH,YAAa,EACpBnH,EAAO+C,OAAO,QAAUxB,KAAM,mBAAoByB,kBAAkB,IACpEhD,EAAO+C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,KAEzE0yC,EAAS50C,UAAUq2C,mBAAqB,SAAUjwC,GAC9C,GAAIlH,GAASC,KAAKD,MAClBA,GAAOkH,UAAYA,EACnBlH,EAAOiH,gBAAkBjH,EAAOkH,UAAU9B,OAC1CpF,EAAO+C,OAAO,iBAAmBxB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAASuD,eAAgB,QACxG/E,KAAKqC,aAAa8B,UAAU,EAAG,EAAGpE,EAAOqC,YAAY/B,MAAON,EAAOqC,YAAY9B,QAC/EN,KAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOwC,YAAYlC,MAAON,EAAOwC,YAAYjC,QAC/EP,EAAOmH,YAAa,EACpBnH,EAAO+C,OAAO,QAAUxB,KAAM,mBAAoByB,kBAAkB,KAExE0yC,EAAS50C,UAAUs2C,6BAA+B,SAAUlwC,GACxD,GAAIlH,GAASC,KAAKD,MAClBA,GAAOkH,UAAYA,EACnBlH,EAAO+C,OAAO,iBAAmBxB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAASuD,eAAgB,QACxG/E,KAAKqC,aAAa8B,UAAU,EAAG,EAAGpE,EAAOqC,YAAY/B,MAAON,EAAOqC,YAAY9B,QAC/EN,KAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOwC,YAAYlC,MAAON,EAAOwC,YAAYjC,QAC/EP,EAAOmH,YAAa,EACpBnH,EAAO+C,OAAO,QAAUxB,KAAM,mBAAoByB,kBAAkB,KAExE0yC,EAAS50C,UAAUu2C,aAAe,SAAU/pC,EAAWnI,EAAS+B,GAC5D,GAAIlH,GAASC,KAAKD,MACA,2BAAdsN,GACAtN,EAAOkH,UAAYA,EACnBlH,EAAOiH,gBAAkBjH,EAAOkH,UAAU9B,OAC1CpF,EAAO+C,OAAO,iBAAmBxB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAASuD,eAAgB,SAErF,cAAdsI,IACLtN,EAAOmF,QAAUA,EACjBnF,EAAO+C,OAAO,SAAWxB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAASuD,eAAgB,SAEpG/E,KAAKqC,aAAa8B,UAAU,EAAG,EAAGpE,EAAOqC,YAAY/B,MAAON,EAAOqC,YAAY9B,QAC/EN,KAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOwC,YAAYlC,MAAON,EAAOwC,YAAYjC,QAC/EP,EAAOmH,YAAa,EACpBnH,EAAO+C,OAAO,QAAUxB,KAAM,mBAAoByB,kBAAkB,KAExE0yC,EAAS50C,UAAUw2C,4BAA8B,SAAUz0C,EAAWsC,GAClE,GAAInF,GAASC,KAAKD,MAClBA,GAAOmF,QAAUlB,YAAWkB,MAAa,GACzCnF,EAAO+C,OAAO,SAAWxB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAASuD,gBAAgB,KAChG/E,KAAKqC,aAAa8B,UAAU,EAAG,EAAGpE,EAAOqC,YAAY/B,MAAON,EAAOqC,YAAY9B,QAC/EP,EAAOmH,YAAa,EACpBnH,EAAO+C,OAAO,QAAUxB,KAAM,mBAAoByB,kBAAkB,GACpE,KAAK,GAAIiC,GAAI,EAAGC,EAAMC,EAAQC,OAAQH,EAAIC,EAAKD,IAAK,CAChD,IAAIhF,KAAKs1C,WAOJ,CACD1yC,EAAYoB,YAAWkB,EAAQA,EAAQC,OAAS,OAAQ,GACxDpF,EAAOmF,QAAQi9B,OAAOn9B,EAAG,EACzB,OATA,GAAIhF,KAAKs1C,WAAWz2B,YAAc3Z,EAAQF,GAAG6Z,UAAW,CACpDjc,EAAYoB,YAAWkB,EAAQF,OAAQ,GACvCjF,EAAOmF,QAAQi9B,OAAOn9B,EAAG,EACzB,QASRpC,GACA5C,KAAK03C,cAAc90C,GAEe,UAAlC7C,EAAO+c,SAASjB,MAAMG,SACtBjc,EAAO+C,OAAO,SAAWxB,KAAM,eAAgByB,kBAAkB,EAC7DvB,OAAShB,EAAG,KAAMC,EAAG,KAAM8a,YAAa,SAGpDk6B,EAAS50C,UAAUy2C,WAAa,SAAUpyC,EAASyyC,GAC/C,GAAI53C,GAASC,KAAKD,MAIlB,IAHIC,KAAKs1C,aACLv1C,EAAO6C,UAAYoB,YAAWhE,KAAKs1C,eAAgB,IAEhC,IAAnBpwC,EAAQC,QAA0C,IAA1BpF,EAAOmF,QAAQC,OACvCnF,KAAKs1C,WAAatxC,YAAWjE,EAAOmF,QAAQ,OAAQ,OAGpD,KAAK,GAAIF,GAAI,EAAGA,EAAIjF,EAAOmF,QAAQC,OAAQH,IAAK,CAC5C,GAAIjF,EAAOmF,QAAQF,IAAM/C,oBAAkBiD,EAAQF,IAAK,CACpDhF,KAAKs1C,WAAatxC,YAAWjE,EAAOmF,QAAQF,OAAQ,EACpD,OAEJ,GAAIE,EAAQF,GAAG6Z,YAAc9e,EAAOmF,QAAQF,GAAG6Z,UAAW,CACtD7e,KAAKs1C,WAAatxC,YAAWjE,EAAOmF,QAAQF,OAAQ,EACpD,QAIR2yC,IACA53C,EAAO6C,UAAYoB,YAAWhE,KAAKs1C,eAAgB,IAEvDv1C,EAAOmF,QAAUlB,YAAWkB,MAAa,GACzCnF,EAAO+C,OAAO,SAAWxB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAASuD,gBAAgB,KAChG/E,KAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOwC,YAAYlC,MAAON,EAAOwC,YAAYjC,QAC/EN,KAAKqC,aAAa8B,UAAU,EAAG,EAAGpE,EAAOqC,YAAY/B,MAAON,EAAOqC,YAAY9B,QAC/EP,EAAOmH,YAAa,EACpBnH,EAAO+C,OAAO,QAAUxB,KAAM,mBAAoByB,kBAAkB,IACpEhD,EAAO+C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,KAEzE0yC,EAAS50C,UAAU62C,cAAgB,SAAUzzC,GACzC,GAAIlE,GAASC,KAAKD,MAClBC,MAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOqC,YAAY/B,MAAON,EAAOqC,YAAY9B,QAC/EN,KAAKqC,aAAa8B,UAAU,EAAG,EAAGpE,EAAOqC,YAAY/B,MAAON,EAAOqC,YAAY9B,QAC/EP,EAAO+C,OAAO,QAAUxB,KAAM,mBAAoByB,kBAAkB,IAC/DmJ,aAIDnM,EAAO+N,cAAc/N,EAAOgO,QAAS,6BAHrChO,EAAO+C,OAAO,WAAaxB,KAAM,qBAAsByB,kBAAkB,IAK7EhD,EAAO+c,SAASjB,MAAMG,QAAU,QAChCjc,EAAO+c,SAASjB,MAAMzM,WAAanL,EAAIoE,aAAa+G,WACpDrP,EAAO+c,SAASjB,MAAMtT,SAAWtE,EAAIoE,aAAaE,SAAW,KAC7DxI,EAAO+c,SAASjB,MAAMsX,MAAQlvB,EAAI8O,eAAehE,YACjDhP,EAAO+c,SAASjB,MAAMipB,WAAa7gC,EAAIoE,aAAagH,KAAO,OAAS,SACpEtP,EAAO+c,SAASjB,MAAMkpB,UAAY9gC,EAAIoE,aAAaiH,OAAS,SAAW,SACvEvP,EAAO+c,SAASjB,MAAM2wB,OAAS,aAAezsC,EAAO4V,UAAU5V,EAAO6V,OAAqB,aAC3F7V,EAAO+c,SAAStb,MAAQyC,EAAIkP,WAC5BpT,EAAO6C,UAAYoB,YAAWC,MAAS,GACvClE,EAAO+C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,EACjEvB,OAASgsC,UAAW,QACxBztC,EAAO+c,SAASjB,MAAMxb,MAAQN,EAAO6C,UAAUC,YAAYxC,MAAQ,MAEvEo1C,EAAS50C,UAAU21C,YAAc,SAAUvyC,GACvCjE,KAAKqC,aAAasC,OAASV,EAAIqJ,YAAY3I,MAC3C,IAAI5E,GAASC,KAAKD,MAClBA,GAAOmF,WACPnF,EAAOkH,aACPlH,EAAOiH,gBAAkB,EACzBjH,EAAO+C,OAAO,iBAAmBxB,KAAM,kBAAmByB,kBAAkB,EACxEvB,OAASyC,KAAOmF,oBACpBrJ,EAAO+C,OAAO,QAAUxB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAASyC,IAAKA,EAAIqJ,eAC1FtN,KAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOwC,YAAYlC,MAAON,EAAOwC,YAAYjC,QAC/EP,EAAO+C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,IACrEhD,EAAOqD,IAAIC,SAAWY,EAAIqJ,YAAYnE,WAAWhJ,OACjDJ,EAAOqD,IAAIE,QAAUW,EAAIqJ,YAAYnE,WAAW/I,MAChD,IAAIwC,GAAYoB,YAAWjE,EAAO6C,cAAe,EACjD7C,GAAOmF,QAAUlB,YAAWC,EAAIsJ,oBAAqB,GACrDxN,EAAOkH,UAAYjD,YAAWC,EAAIuJ,sBAAuB,GACzDzN,EAAOiH,gBAAkBjH,EAAOkH,UAAU9B,OAC1CpF,EAAO+C,OAAO,iBAAmBxB,KAAM,kBAAmByB,kBAAkB,EACxEvB,OAASyC,KAAOmF,aAAcpF,YAAWC,EAAIwJ,yBAA0B,OAC3EzN,KAAKqC,aAAasC,OAAS,OAC3B5E,EAAO+C,OAAO,SAAWxB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAASuD,eAAgB,QAChGhF,EAAO+C,OAAO,iBAAmBxB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAASuD,eAAgB,QACxG/E,KAAKqC,aAAasC,OAASV,EAAIqJ,YAAY3I,OAC3C5E,EAAO6C,UAAYA,EACnB5C,KAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOwC,YAAYlC,MAAON,EAAOwC,YAAYjC,QACpC,IAAvCP,EAAO6C,UAAUC,YAAYxC,OAAuD,IAAxCN,EAAO6C,UAAUC,YAAYvC,QACzEP,EAAO+C,OAAO,QAAUxB,KAAM,aAAcyB,kBAAkB,EAAOvB,OAAS6D,OAAQ,gBAG9FowC,EAAS50C,UAAU22C,YAAc,SAAUnqC,EAAWuqC,GAClD,GAAI73C,GAASC,KAAKD,MAClBA,GAAO+C,OAAO,QAAUxB,KAAM,mBAAoByB,kBAAkB,EAAOvB,OAAS+D,QAASvF,KAAKqC,gBAC9FtC,EAAOyF,eAAkBoyC,GAAwB,SAAdvqC,IAA0BuqC,IAC7D73C,EAAO+C,OAAO,QAAUxB,KAAM,aAAcyB,kBAAkB,EAC1DvB,OAAS+D,QAASvF,KAAKqC,aAAc+H,OAAQ,KAAMC,OAAQ,QAE/DtK,EAAOiD,UAAUa,WAAa,GAC9B9D,EAAO+C,OAAO,aAAexB,KAAM,gBAAiBE,OAAS4E,MAAM,KAEvErG,EAAO+C,OAAO,QAAUxB,KAAM,kBAAmByB,kBAAkB,EAAOvB,OAAS4E,MAAM,KACpF8F,cAUIjK,oBAAkBlC,EAAO6C,UAAUwC,QAAmD,SAAzCrF,EAAO6C,UAAUwC,MAAMuH,MAAM,KAAK,MACpF5M,EAAO+N,cAAc/N,EAAOgO,QAAS,eACrChO,EAAO+N,cAAc/N,EAAOgO,QAAS,6BAXjChO,EAAO6C,UAAUwC,OAAkD,SAAzCrF,EAAO6C,UAAUwC,MAAMuH,MAAM,KAAK,GAC5D5M,EAAO+C,OAAO,WAAaxB,KAAM,kBAAmByB,kBAAkB,EAAOvB,OAASmF,KAAM,OACpF8C,YAAY,EAAMC,YAAY,EAAMC,UAAW,KAAMC,MAAO,QAGpE7J,EAAO+C,OAAO,WAAaxB,KAAM,uBAAwByB,kBAAkB,IAE/EhD,EAAO+C,OAAO,WAAaxB,KAAM,yBAMjCyb,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,6BAC5CD,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,2BAA2BnB,MAAMG,QAAU,QAEtF9P,aAIDnM,EAAO+N,cAAc/N,EAAOgO,QAAS,2BAHrChO,EAAO+C,OAAO,WAAaxB,KAAM,wBAKL,IAA5BvB,EAAOiD,UAAUC,QACjBlD,EAAO+C,OAAO,aAAexB,KAAM,kBAAmByB,kBAAkB,EACpEvB,OAAS0I,MAAO,EAAGC,MAAO,KAElCpK,EAAO+C,OAAO,UAAYxB,KAAM,qBAAsByB,kBAAkB,EAAOvB,OAAS6b,gBAAiBrd,KAAKqC,aAAasC,UAC3H5E,EAAO0F,YAAYC,cAAe,GAEtC+vC,EAAS50C,UAAUk1C,UAAY,SAAU1oC,EAAWC,EAAaC,EAAiBC,EAAmBC,EAAsBC,EAAiBC,EAAcC,EAAaC,EAAgBrI,GACnL,GAAIzF,GAASC,KAAKD,OACdkE,GAAQ4zC,iBAAiB,EAK7B,IAJI93C,EAAO0F,YAAYmG,cACnB5L,KAAKg2C,YAAW,GAEpBj2C,EAAO+C,OAAO,QAAUxB,KAAM,kBAAmByB,kBAAkB,EAAOvB,OAASsE,OAAQ7B,MACtFA,EAAqB,iBAAKlE,EAAO+iC,cAAe,CACjD,GAAIh9B,IAAWC,WACfhG,GAAO+C,OAAO,UAAYxB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAASsE,OAAQA,IAC3F,IAAI8wC,GAAa9wC,EAAgB,OACjC8wC,GAAW1xC,QAAUlB,YAAWjE,EAAOmF,YAAa,GACpD0xC,EAAW3vC,UAAYjD,YAAWjE,EAAOkH,cAAe,GACxD2vC,EAAW/wC,iBAAmB7B,YAAWjE,EAAO8F,qBAAsB,EACtE,IAAIuZ,IAAoBhW,aAAc,KACtCrJ,GAAO+C,OAAO,iBAAmBxB,KAAM,kBAAmByB,kBAAkB,EACxEvB,OAASyC,IAAKmb,KAClBw3B,EAAWxtC,aAAepF,YAAWob,EAA8B,iBAAO,GACxD,SAAd/R,IACAupC,EAAW7yC,mBAAqBC,YAAWjE,EAAOgE,uBAAwB,IAE9E/D,KAAK21C,aAAa1vC,MAAOoH,UAAWA,EAAWC,YAAaA,EAAaspC,WAAYA,EACjFrpC,gBAAiBA,EAAiBwR,eAAgB63B,EAAW1xC,QAC7DsI,kBAAmBA,EAAmBqpC,iBAAkBD,EAAW3vC,UACnEwG,qBAAsBA,EAAsBgqC,oBAAqBb,EAAWxtC,aAC5EsE,gBAAiBA,EAAiBipC,eAAgB3yC,YAAWjE,EAAOiG,YAAa,GACjF2H,aAAcA,EAAcC,YAAaA,EAAajJ,OAAQkJ,EAAgBrI,aAAcA,IAC3F0G,aAIDnM,EAAO+N,cAAc/N,EAAOgO,QAAS,2BAHrChO,EAAO+C,OAAO,WAAaxB,KAAM,sBAAuByB,kBAAkB,MAOtF0yC,EAAS50C,UAAUy1C,YAAc,SAAUpxC,GACvC,GAAInF,GAASC,KAAKD,MAClB,IAAIA,EAAO+iC,cAAe,CAClB/iC,EAAO0F,YAAYmG,cACnB5L,KAAKg2C,YAAW,GAEpBj2C,EAAOmF,QAAQe,KAAKlG,EAAO6C,UAC3B,IAAIoD,GAAUhC,YAAWjE,EAAOiG,YAAa,GACzCF,GAAWC,WACfhG,GAAO+C,OAAO,UAAYxB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAASsE,OAAQA,IAC3F,IAAI7B,GAAM6B,EAAgB,OAC1B7B,GAAIiB,QAAUlB,YAAWjE,EAAOmF,YAAa,GAC7CjB,EAAIgD,UAAYjD,YAAWjE,EAAOkH,cAAe,GACjDhD,EAAI4B,iBAAmB7B,YAAWjE,EAAO8F,qBAAsB,EAC/D,IAAIuZ,IAAoBhW,aAAc,KACtCrJ,GAAO+C,OAAO,iBAAmBxB,KAAM,kBAAmByB,kBAAkB,EACxEvB,OAASyC,IAAKmb,KAClBnb,EAAImF,aAAepF,YAAWob,EAA8B,iBAAO,GACnEpf,KAAK21C,aAAa1vC,MAAOoH,UAAW,iBAAkBC,YAAarJ,EAAK2yC,WAAY3yC,EAChFsJ,gBAAiBrI,EAAS6Z,eAAgB9a,EAAIiB,QAC9CsI,kBAAmBvJ,EAAIgD,UAAW4vC,iBAAkB5yC,EAAIgD,UACxDwG,qBAAsBxJ,EAAImF,aAAcquC,oBAAqBxzC,EAAImF,aACjEsE,gBAAiB1H,EAAS2wC,eAAgB3wC,IAC9CjG,EAAO+C,OAAO,aAAexB,KAAM,cAAeyB,kBAAkB,EAChEvB,OAASyC,IAAKlE,EAAOmF,QAAQnF,EAAOmF,QAAQC,OAAS,QAGjEswC,EAAS50C,UAAU01C,eAAiB,WAChC,GAAIx2C,GAASC,KAAKD,OACd+M,EAAc9I,YAAWjE,EAAOiG,YAAa,GAC7CF,GAAWC,WACfhG,GAAO+C,OAAO,UAAYxB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAASsE,OAAQA,IAC3F,IAAIiH,GAAUjH,EAAgB,OAC9BiH,GAAQ7H,QAAUlB,YAAWjE,EAAOmF,YAAa,GACjD6H,EAAQ9F,UAAYjD,YAAWjE,EAAOkH,cAAe,GACrD8F,EAAQlH,iBAAmB7B,YAAWjE,EAAO8F,qBAAsB,EACnE,IAAIuZ,IAAoBhW,aAAc,KACtCrJ,GAAO+C,OAAO,iBAAmBxB,KAAM,kBAAmByB,kBAAkB,EACxEvB,OAASyC,IAAKmb,KAClBrS,EAAQ3D,aAAepF,YAAWob,EAA8B,iBAAO,GACvErf,EAAOmF,QAAQe,KAAKlG,EAAO6C,WAC3B5C,KAAK+1C,UAAU,iBAAkBhpC,EAASA,EAAQ7H,QAAS6H,EAAQ9F,UAAW8F,EAAQ3D,aAAc0D,GACpG/M,EAAOmF,QAAQwB,MACf3G,EAAO+C,OAAO,SAAWxB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAAS+Z,YAAa,QAC7Fxb,EAAO+C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,IAChEmJ,aAODnM,EAAO+N,cAAc/N,EAAOgO,QAAS,gBANrChO,EAAO+C,OAAO,WAAaxB,KAAM,kBAAmByB,kBAAkB,EAAOvB,OAASmF,KAAM,SACpF8C,WAAY,KAAMC,WAAY,KAAMC,UAAW,KAAMC,MAAO,QACpE7J,EAAO+C,OAAO,WAAaxB,KAAM,kBAAmByB,kBAAkB,EAAOvB,OAASmF,KAAM,OACpF8C,WAAY,KAAMC,WAAY,KAAMC,UAAW,KAAMC,MAAO,UAM5E6rC,EAAS50C,UAAUi2C,yBAA2B,SAAU7yC,EAAKd,GACzD,GAAIpD,GAASC,KAAKD,OACd+F,GAAWC,WACfhG,GAAO+C,OAAO,UAAYxB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAASsE,OAAQA,IAC3F,IAAI8wC,GAAa9wC,EAAgB,OACjC8wC,GAAW1xC,QAAUlB,YAAWjE,EAAOmF,YAAa,GACpD0xC,EAAW3vC,UAAYjD,YAAWjE,EAAOkH,cAAe,GACxD2vC,EAAW/wC,iBAAmB7B,YAAWjE,EAAO8F,qBAAsB,EACtE,IAAIuZ,IAAoBhW,aAAc,KACtCrJ,GAAO+C,OAAO,iBAAmBxB,KAAM,kBAAmByB,kBAAkB,EACxEvB,OAASyC,IAAKmb,KAClBw3B,EAAWxtC,aAAepF,YAAWob,EAA8B,iBAAO,EAC1E,IAAI04B,IAAqB5H,cAAe,KACxCnwC,GAAO+C,OAAO,aAAexB,KAAM,mBAAoByB,kBAAkB,EAAOvB,OAASyC,IAAK6zC,IAC9F,IAAIC,GAAqB/zC,YAAWjE,EAAOmF,YAAa,GACpD8yC,EAAuBh0C,YAAWjE,EAAOkH,cAAe,GACxDgxC,GAAa9nC,eAAgB,KACjCnQ,MAAKD,OAAO+C,OAAO,QAAUxB,KAAM,oBAAqByB,kBAAkB,EAAOvB,OAASyC,IAAKg0C,IAC/F,IAAIC,GAAel0C,YAAWi0C,EAAyB,mBAAO,EAC9D,IAAIl4C,EAAOiD,UAAUa,WAAa,IAAMI,EAAIkB,OAAS,GAAKhC,EAAMgC,OAAS,GAAI,CACzEpF,EAAOmF,QAAUjB,EACjBlE,EAAOkH,UAAY9D,CACnB,IAAI+D,GAAanH,EAAOmH,UACxB,IAAoC,IAAhCnH,EAAOiD,UAAUa,WAAkB,CACnC9D,EAAOmH,WAAanH,EAAOqe,WAAY,EACvCre,EAAO+C,OAAO,iBAAmBxB,KAAM,gBAAiByB,kBAAkB,GAC1E,IAAIkK,GAAejJ,YAAWjE,EAAOkN,aAAc,MAAM,EACrDlN,GAAOiD,UAAUa,WAAa,EAC9B9D,EAAO+C,OAAO,aAAexB,KAAM,aAAcyB,kBAAkB,EAC/DvB,OAASqC,YAAa9D,EAAOiD,UAAUa,WAAYsD,UAAW,QAGlEpH,EAAO+C,OAAO,aAAexB,KAAM,aAAcyB,kBAAkB,EAC/DvB,OAASqC,WAAYsE,KAAKC,IAAIrI,EAAOiD,UAAUa,YAAasD,UAAW,QAE/EpH,EAAOkN,aAAeA,EACtBlN,EAAOqe,WAAY,EACnBre,EAAOmH,WAAaA,EACpB6wC,EAAqB/zC,YAAWjE,EAAOmF,YAAa,GACpD8yC,EAAuBh0C,YAAWjE,EAAOkH,cAAe,GACxDlH,EAAOmF,WACPnF,EAAOkH,aACPlH,EAAOiH,gBAAkB,EACzBjH,EAAO+C,OAAO,iBAAmBxB,KAAM,kBAAmByB,kBAAkB,EACxEvB,OAASyC,KAAOmF,oBACpBrJ,EAAO+C,OAAO,aAAexB,KAAM,mBAAoByB,kBAAkB,EACrEvB,OAASnB,MAAOy3C,EAAgC,cAAS,MAAGx3C,OAAQw3C,EAAgC,cAAU,SAClH,IAAI5zC,IAAiB7D,MAAOy3C,EAAgC,cAAS,MAAGx3C,OAAQw3C,EAAgC,cAAU,OAC1H5zC,GAAa7D,OAAU6D,EAAa7D,MAAQu2C,EAAWl1B,YACvDxd,EAAa5D,QAAW4D,EAAa5D,OAASs2C,EAAWl1B,YACzD3hB,EAAO+C,OAAO,QAAUxB,KAAM,mBAAoBE,OAASnB,MAAO6D,EAAa7D,MAAOC,OAAQ4D,EAAa5D,UAC3GP,EAAO+C,OAAO,QAAUxB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAASyC,IAAK2yC,KACtF72C,EAAOqD,IAAIC,SAAWuzC,EAAWztC,WAAWhJ,OAC5CJ,EAAOqD,IAAIE,QAAUszC,EAAWztC,WAAW/I,OAC3CL,EAAOsH,SAASC,iBAAmBsvC,EAAWtvC,iBAC9CvH,EAAOsH,SAAS0C,uBAAyB6sC,EAAW7sC,uBACpDhK,EAAOsH,SAAS4B,yBAA2B2tC,EAAW3tC,yBACtDlJ,EAAOmF,QAAUlB,YAAW4yC,EAAW1xC,YAAa,GACpDnF,EAAOkH,UAAYjD,YAAW4yC,EAAW3vC,cAAe,GACxDlH,EAAOiH,gBAAkBjH,EAAOkH,UAAU9B,OAC1CpF,EAAO+C,OAAO,QAAUxB,KAAM,oBAAqByB,kBAAkB,EAAOvB,OAAS2O,eAAgB+nC,KACrGn4C,EAAO+C,OAAO,iBAAmBxB,KAAM,kBAAmByB,kBAAkB,EACxEvB,OAASyC,KAAOmF,aAAcpF,YAAW4yC,EAAWxtC,iBAAkB,OAC1EpJ,KAAKqC,aAAasC,OAAS,OAC3B5E,EAAO+C,OAAO,SAAWxB,KAAM,iBAAkByB,kBAAkB,IACnEhD,EAAO+C,OAAO,iBAAmBxB,KAAM,iBAAkByB,kBAAkB,EACvEvB,OAAS+D,QAASvF,KAAKqC,aAAcwG,OAAQ,QACjD9I,EAAO+C,OAAO,iBAAmBxB,KAAM,kBAAmByB,kBAAkB,IAC5E/C,KAAKqC,aAAasC,OAASiyC,EAAWjyC,OACN,IAA5B5E,EAAOiD,UAAUC,QACjBlD,EAAO+C,OAAO,aAAexB,KAAM,kBAAmByB,kBAAkB,EACpEvB,OAAS0I,MAAO,EAAGC,MAAO,MAI1C,OAASlG,IAAK8zC,EAAoB50C,MAAO60C,IAEtCvC,KC/xBP0C,EAAwC,WACxC,GAAIC,GAAgB,SAAUC,EAAGt+B,GAI7B,OAHAq+B,EAAgBE,OAAOC,iBAChBC,uBAA2BC,QAAS,SAAUJ,EAAGt+B,GAAKs+B,EAAEG,UAAYz+B,IACvE,SAAUs+B,EAAGt+B,GAAK,IAAK,GAAI2+B,KAAK3+B,GAAOA,EAAE4+B,eAAeD,KAAIL,EAAEK,GAAK3+B,EAAE2+B,MACpDL,EAAGt+B,GAE5B,OAAO,UAAUs+B,EAAGt+B,GAEhB,QAAS6+B,KAAO54C,KAAK64C,YAAcR,EADnCD,EAAcC,EAAGt+B,GAEjBs+B,EAAEx3C,UAAkB,OAANkZ,EAAau+B,OAAOQ,OAAO/+B,IAAM6+B,EAAG/3C,UAAYkZ,EAAElZ,UAAW,GAAI+3C,QAGnFG,EAA0C,SAAUC,EAAYv1B,EAAQof,EAAKoW,GAC7E,GAA2HZ,GAAvHr+B,EAAIk/B,UAAU/zC,OAAQ6/B,EAAIhrB,EAAI,EAAIyJ,EAAkB,OAATw1B,EAAgBA,EAAOX,OAAOa,yBAAyB11B,EAAQof,GAAOoW,CACrH,IAAuB,gBAAZG,UAAoD,kBAArBA,SAAQC,SAAyBrU,EAAIoU,QAAQC,SAASL,EAAYv1B,EAAQof,EAAKoW,OACpH,KAAK,GAAIj0C,GAAIg0C,EAAW7zC,OAAS,EAAGH,GAAK,EAAGA,KAASqzC,EAAIW,EAAWh0C,MAAIggC,GAAKhrB,EAAI,EAAIq+B,EAAErT,GAAKhrB,EAAI,EAAIq+B,EAAE50B,EAAQof,EAAKmC,GAAKqT,EAAE50B,EAAQof,KAASmC,EAChJ,OAAOhrB,GAAI,GAAKgrB,GAAKsT,OAAOgB,eAAe71B,EAAQof,EAAKmC,GAAIA,GAW5DuU,EAAkC,SAAUC,GAE5C,QAASD,KACL,MAAkB,QAAXC,GAAmBA,EAAOxS,MAAMhnC,KAAMk5C,YAAcl5C,KAuB/D,MAzBAm4C,GAAUoB,EAAkBC,GAI5BT,GACIU,WAAS,OACVF,EAAiB14C,UAAW,iBAAc,IAC7Ck4C,GACIU,WAAS,OACVF,EAAiB14C,UAAW,eAAY,IAC3Ck4C,GACIU,WAAS,OACVF,EAAiB14C,UAAW,UAAO,IACtCk4C,GACIU,WAAS,OACVF,EAAiB14C,UAAW,iBAAc,IAC7Ck4C,GACIU,WAAS,OACVF,EAAiB14C,UAAW,eAAY,IAC3Ck4C,GACIU,WAAS,OACVF,EAAiB14C,UAAW,cAAW,IAC1Ck4C,GACIU,WAAS,OACVF,EAAiB14C,UAAW,WAAQ,IAChC04C,GACTG,iBAKEC,EAA8B,SAAUH,GAExC,QAASG,KACL,MAAkB,QAAXH,GAAmBA,EAAOxS,MAAMhnC,KAAMk5C,YAAcl5C,KAiB/D,MAnBAm4C,GAAUwB,EAAcH,GAIxBT,GACIU,WAAS,OACVE,EAAa94C,UAAW,kBAAe,IAC1Ck4C,GACIU,WAAS,IACVE,EAAa94C,UAAW,oBAAiB,IAC5Ck4C,GACIU,WAAS,KACVE,EAAa94C,UAAW,oBAAiB,IAC5Ck4C,GACIU,WAAS,IACVE,EAAa94C,UAAW,iBAAc,IACzCk4C,GACIU,WAAS,OACVE,EAAa94C,UAAW,gBAAa,IACjC84C,GACTD,iBAKEE,EAAmC,SAAUJ,GAE7C,QAASI,KACL,MAAkB,QAAXJ,GAAmBA,EAAOxS,MAAMhnC,KAAMk5C,YAAcl5C,KAW/D,MAbAm4C,GAAUyB,EAAmBJ,GAI7BT,GACIU,YAAS,IACVG,EAAkB/4C,UAAW,iBAAc,IAC9Ck4C,GACIU,WAAS,OACVG,EAAkB/4C,UAAW,kBAAe,IAC/Ck4C,GACIU,WAAS,OACVG,EAAkB/4C,UAAW,gBAAa,IACtC+4C,GACTF,iBAWEG,EAA6B,SAAUL,GASvC,QAASK,GAAYC,EAAS/rC,GAC1B,GAAIxC,GAAQiuC,EAAOO,KAAK/5C,KAAM85C,IAAY95C,IA2F1C,OArFAuL,GAAME,eAAgB,EAEtBF,EAAM3I,WAAcC,aAAe1C,OAAQ,EAAGC,OAAQ,EAAG2H,KAAM,EAAGC,KAAM,EAAG3H,MAAO,EAAGC,OAAQ,GACzFyX,eAAiBgd,YAAcC,iBAAmBphB,aAAc,GAGpErI,EAAM9F,aAAgBL,MAAO,GAAI6Z,YAAY,EAAOjU,aAAa,EAAOiI,QAAQ,EAAO+3B,eAAe,EAAOzM,QAAQ,EAAOwD,eAAe,EACvIr8B,cAAc,EAAOugB,UAAU,EAAOlK,YAAY,EAAOnQ,cAAc,EAAOuR,YAAY,EAAO/S,QAAQ,EAAOgvB,UAAU,GAE9H7tB,EAAMrG,WAGNqG,EAAMtE,aAENsE,EAAMvE,gBAAkB,EAExBuE,EAAM1C,UAEN0C,EAAM8S,WAAY,EAElB9S,EAAMyS,WAAY,EAElBzS,EAAMnI,KAAQC,SAAU,EAAGC,QAAS,EAAGC,UAAW,EAAGC,WAAY,EAAGY,QAAS,EAAGC,OAAQ,EAAGC,SAAU,EAAGC,UAAW,GAGnHgH,EAAMjF,kBAGNiF,EAAMvF,SAAYuD,SAAU,EAAGmY,YAAa,EAAGpa,kBAAoB9G,EAAG,EAAGC,EAAG,GAAKsJ,wBAA0BvJ,EAAG,EAAGC,EAAG,GAChHwI,0BAA4BzI,EAAG,EAAGC,EAAG,GAAKF,kBAAoBC,EAAG,EAAGC,EAAG,GAAKmC,aAAe0D,kBAC3FrD,OAAQ,EAAGS,cAAe,GAAIyF,YAAchJ,OAAQ,EAAGC,OAAQ,EAAGC,MAAO,EAAGC,OAAQ,GACpFqhB,WAAaxhB,OAAQ,EAAGC,OAAQ,EAAGC,MAAO,EAAGC,OAAQ,GAAKqE,OAAQ,GAAIid,gBAAgB,EACtF/d,WAAY,EAAGqJ,kBAAmB,GAGtC3B,EAAM1F,oBAEN0F,EAAMvI,WAAcC,OAAQ,EAAGS,cAAe,GAAIG,WAAY,EAAGyb,eAAgB,KAAM1Z,kBAAmB,GAE1G2F,EAAMlE,UAAa4C,oBAAsBzJ,EAAG,EAAGC,EAAG,GAAK6G,kBAAoB9G,EAAG,EAAGC,EAAG,GAAKwI,0BAA4BzI,EAAG,EAAGC,EAAG,GAC1HsJ,wBAA0BvJ,EAAG,EAAGC,EAAG,IAEvC8K,EAAMrE,YAAa,EAEnBqE,EAAM6S,WAAY,EAElB7S,EAAM/F,cAAe,EAErB+F,EAAMyuC,gBAENzuC,EAAM+R,uBAAyB,GAE/B/R,EAAMiS,cAAgB,GAEtBjS,EAAM6R,aAAe,uHAGrB7R,EAAM8Q,cAAgB,EAEtB9Q,EAAMs/B,gBAAiB,EAEvBt/B,EAAMI,eAAgB,EAEtBJ,EAAMsS,OAAS,UACV3R,cAWD,GAAIpM,GAAKyL,GACT,GAAIkD,GAAKlD,GACT,GAAI8d,GAAO9d,GACX,GAAI+gB,GAAgB/gB,GACpB,GAAIgpB,GAAUhpB,GACd,GAAIg7B,GAAMh7B,GACV,GAAIukC,GAAUvkC,GACd,GAAIkqC,GAASlqC,GACb,GAAIqa,GAAOra,KAlBX0uC,EAAcC,OAAOp6C,EAAM2O,EAAM8lB,EAAWub,EAAWlqB,EAAQu0B,GAC/DF,EAAcC,OAAOzE,GACrBwE,EAAcC,OAAO7wB,GACrB4wB,EAAcC,OAAO3T,GACrB0T,EAAcC,OAAO5tB,GACjBve,GACAxC,EAAM6Y,SAASrW,IAchBxC,EApGX4sC,EAAU0B,EAAaL,GAsGvBS,EAAgBJ,EAOhBA,EAAYh5C,UAAUu5C,gBAAkB,WACpC,GAAIC,KAWJ,OAVAA,GAAQp0C,MAAOq0C,OAAQ,OAAQl5C,MAAOpB,QACtCq6C,EAAQp0C,MAAOq0C,OAAQ,OAAQl5C,MAAOpB,QACtCq6C,EAAQp0C,MAAOq0C,OAAQ,YAAal5C,MAAOpB,QAC3Cq6C,EAAQp0C,MAAOq0C,OAAQ,YAAal5C,MAAOpB,QAC3Cq6C,EAAQp0C,MAAOq0C,OAAQ,SAAUl5C,MAAOpB,QACxCq6C,EAAQp0C,MAAOq0C,OAAQ,iBAAkBl5C,MAAOpB,QAChDq6C,EAAQp0C,MAAOq0C,OAAQ,YAAal5C,MAAOpB,QAC3Cq6C,EAAQp0C,MAAOq0C,OAAQ,SAAUl5C,MAAOpB,QACxCq6C,EAAQp0C,MAAOq0C,OAAQ,QAASl5C,MAAOpB,QACvCq6C,EAAQp0C,MAAOq0C,OAAQ,gBAAiBl5C,MAAOpB,QACxCq6C,GAEXR,EAAYh5C,UAAU05C,UAAY,WAE9Bv6C,KAAK+N,QAAQiP,GAAKhd,KAAK+N,QAAQiP,IAAMw9B,cAAY,oBAC7Cv+B,UAAQC,UACRlc,KAAK+N,QAAQkP,UAAUa,IAAI,YAE/B9d,KAAKy6C,uBASTZ,EAAYh5C,UAAU65C,OAAS,WAC3B16C,KAAK26C,cAQTd,EAAYh5C,UAAUsB,cAAgB,WAClC,MAAO,gBASX03C,EAAYh5C,UAAU+5C,eAAiB,WACnC,MAAO56C,MAAK66C,kBAWhBhB,EAAYh5C,UAAUi6C,kBAAoB,SAAUC,EAAeC,GAC/D,IAAK,GAAIrgB,GAAK,EAAGE,EAAKyd,OAAO2C,KAAKF,GAAgBpgB,EAAKE,EAAG11B,OAAQw1B,IAE9D,OADWE,EAAGF,IAEV,IAAK,WACGqgB,EAAcE,UACdC,eAAan7C,KAAK+N,SAAUitC,EAAcE,SAASE,QAAQ,OAAQ,KAAKC,OAAO1uC,MAAM,MAErFouC,EAAcG,UACdI,YAAUt7C,KAAK+N,SAAUgtC,EAAcG,SAASE,QAAQ,OAAQ,KAAKC,OAAO1uC,MAAM,KAEtF,MACJ,KAAK,WACGouC,EAAcvvC,UACdxL,KAAK+N,QAAQkP,UAAUa,IAAI,cAC3B9d,KAAKy4B,gBAGLz4B,KAAK+N,QAAQkP,UAAU+O,OAAO,cAC9BhsB,KAAKu7C,YAET,MACJ,KAAK,SACDv7C,KAAK+N,QAAQ8N,MAAMvb,OAASy6C,EAAcz6C,MAC1C,MACJ,KAAK,QACDN,KAAK+N,QAAQ8N,MAAMxb,MAAQ06C,EAAc16C,KACzC,MACJ,KAAK,QACG06C,EAAcnlC,QACV5V,KAAK4V,OAAwB,KAAf5V,KAAK4V,MACnB5V,KAAK4V,MAAQ5V,KAAK8G,aAAa9G,KAAK4V,OAGpC5V,KAAK4V,MAAQ,aAEjB5V,KAAKwC,aAAakT,YAAc1V,KAAK2V,UAAU3V,KAAK4V,OAAqB,aACzE5V,KAAKwC,aAAa4Q,UAAYpT,KAAK2V,UAAU3V,KAAK4V,OAAuB,eAE7E,MACJ,KAAK,mBACGmlC,EAAcpwB,mBACd3qB,KAAK2qB,iBAAmBowB,EAAcpwB,iBACtC3qB,KAAK8C,OAAO,UAAYxB,KAAM,qBAElC,MACJ,KAAK,SACGy5C,EAAcS,SACdx7C,KAAK8C,OAAO,WAAaxB,KAAM,YAAayB,kBAAkB,EAAOvB,OAASg6C,OAAQT,EAAcS,UACpGx7C,KAAK8C,OAAO,WAAaxB,KAAM,kBAAmByB,kBAAkB,EAAOvB,OAASmF,KAAM,OAClF8C,WAAY,KAAMC,WAAY,KAAMC,UAAW,KAAMC,MAAO,QAExE,MACJ,KAAK,gBACGmxC,EAAcjY,cACd9iC,KAAK8iC,eAAgB,EAGrB9iC,KAAK8iC,eAAgB,EAEzB9iC,KAAK8C,OAAO,WAAaxB,KAAM,kBAAmByB,kBAAkB,EAAOvB,OAASmF,KAAM,OAClF8C,WAAY,KAAMC,WAAY,KAAMC,UAAW,KAAMC,MAAO,OACpE,MACJ,KAAK,yBACGmxC,EAAcU,wBACdz7C,KAAKy7C,wBAAyB,EAC9Bz7C,KAAK8C,OAAO,WAAaxB,KAAM,oBAAqByB,kBAAkB,IACtE/C,KAAK8C,OAAO,WAAaxB,KAAM,YAAayB,kBAAkB,EAAOvB,OAASw+B,UAAW,UAGzFhgC,KAAKy7C,wBAAyB,EAC9Bz7C,KAAK8C,OAAO,WAAaxB,KAAM,qBAAsByB,kBAAkB,IAE3E,MACJ,KAAK,eACGg4C,EAAc9tC,eACdjN,KAAKiN,aAAa6zB,YAAcia,EAAc9tC,aAAa6zB,aAE3D7+B,oBAAkBjC,KAAKiN,aAAa6zB,cACpC9gC,KAAKiN,aAAa6zB,YAAeC,cAAYoC,WAAapC,cAAYC,MAAQD,cAAY2a,QACtF3a,cAAYgC,SAChB/iC,KAAK8C,OAAO,WAAaxB,KAAM,kBAAmByB,kBAAkB,EAAOvB,OAASmF,KAAM,OAClF8C,WAAY,KAAMC,WAAY,KAAMC,UAAW,KAAMC,MAAO,UAE9DmxC,EAAc9tC,aAAa6zB,YAAcC,cAAY2a,WAAa3a,cAAY2a,SACpF17C,KAAK8C,OAAO,WAAaxB,KAAM,kBAAmByB,kBAAkB,EAAOvB,OAASmF,KAAM,OAClF8C,WAAY,KAAMC,WAAY,KAAMC,UAAW,KAAMC,MAAO,OAExE,MACJ,KAAK,oBACGmxC,EAAc9kC,oBACdjW,KAAKiW,kBAAoB8kC,EAAc9kC,kBACnCjW,KAAK4C,UAAUwC,QACfpF,KAAKwC,aAAa2B,UAAU,EAAG,EAAGnE,KAAKuC,YAAYlC,MAAOL,KAAKuC,YAAYjC,QAC3EN,KAAK8C,OAAO,QAAUxB,KAAM,aAAcyB,kBAAkB,EAAOvB,OAAS6D,OAAQ,YAAapB,IAAKjE,KAAK4C,iBAOnIi3C,EAAYh5C,UAAUC,QAAU,WAC5B,GAAImc,KACJjd,MAAK+N,QAAQ4tC,gBAAgB,YACzB37C,KAAKk7C,WACLj+B,EAAYA,EAAU2+B,OAAO57C,KAAKk7C,SAASE,QAAQ,OAAQ,KAAKC,OAAO1uC,MAAM,OAEjFwuC,eAAan7C,KAAK+N,SAAUkP,GACvBjd,KAAK+N,QAAQ8tC,aAAa,UAC3B77C,KAAK+N,QAAQ4tC,gBAAgB,SAE5BzvC,aAMDlM,KAAK+N,QAAQkP,UAAU+O,OAAO,mBAL9BhsB,KAAK8C,OAAO,WAAaxB,KAAM,uBAAwByB,kBAAkB,IACzE/C,KAAK8C,OAAO,YAAa,MACzB02C,EAAO34C,UAAUC,QAAQi5C,KAAK/5C,OAKlCA,KAAKy4B,cACLz4B,KAAK+N,QAAQoZ,UAAY,IAE7B0yB,EAAYh5C,UAAU85C,WAAa,WAY/B,GAXI36C,KAAKolB,iBACLplB,KAAK+N,QAAQmZ,YAAYlnB,KAAK6nB,cAAc,OACxC7K,GAAIhd,KAAK+N,QAAQiP,GAAK,eAAgB8+B,UAAW,oBAErD97C,KAAK+7C,sBAGL/7C,KAAK8C,OAAO,WAAaxB,KAAM,iBAAkByB,kBAAkB,IACnE/C,KAAK8C,OAAO,WAAaxB,KAAM,4BAA6ByB,kBAAkB,KAElF/C,KAAKg8C,eACDh8C,KAAKy7C,uBAAwB,CACT1+B,SAASZ,cAAc,IAAMnc,KAAK+N,QAAQiP,GAAK,kBACrDkK,YAAYlnB,KAAK6nB,cAAc,OACzC7K,GAAIhd,KAAK+N,QAAQiP,GAAK,0BAA2B8+B,UAAW,gCAEhE,IAAIG,GAAqBl/B,SAAS0F,eAAeziB,KAAK+N,QAAQiP,GAAK,0BACnEi/B,GAAmBpgC,MAAMqgC,SAAW,WACpCD,EAAmBpgC,MAAMG,QAAU,OAC/Bhc,KAAK4C,YACLq5C,EAAmBpgC,MAAMZ,KAAOjb,KAAK4C,UAAUC,YAAY1C,OAAS,KACpE87C,EAAmBpgC,MAAM6K,IAAM1mB,KAAK4C,UAAUC,YAAYzC,OAAS,MAEvE67C,EAAmBpgC,MAAMxb,MAAQ,OAEjCL,KAAKm8C,2BACLn8C,KAAKo8C,+BAGLp8C,KAAK8C,OAAO,WAAaxB,KAAM,oBAAqByB,kBAAkB,IAE1E/C,KAAKu7C,YACLv7C,KAAKqC,aAAerC,KAAKoC,YAAYE,WAAW,MAChDtC,KAAKwC,aAAexC,KAAKuC,YAAYD,WAAW,MAChDtC,KAAKoiB,gBAAkBpiB,KAAKqiB,eAAe/f,WAAW,MACtDtC,KAAKqC,aAAasC,OAAS3E,KAAKwhB,mBAChCxhB,KAAK8C,OAAO,UAAYxB,KAAM,qBAAsByB,kBAAkB,EAAOvB,OAAS6b,gBAAiBrd,KAAKqC,aAAasC,UACzH3E,KAAKod,aAAepd,KAAKqC,aAAasC,OACtC3E,KAAK8C,OAAO,WAAaxB,KAAM,4BAA6ByB,kBAAkB,EAAOvB,OAASA,MAAOxB,KAAKqC,aAAasC,UACnH3E,KAAKk7C,UACLI,YAAUt7C,KAAK+N,SAAU/N,KAAKk7C,SAASE,QAAQ,OAAQ,KAAKC,OAAO1uC,MAAM,MAEzE3M,KAAK+N,SACLsuC,iBACI54B,OAAQzjB,KAAK+N,UAGrB/N,KAAKs8C,0BAQTzC,EAAYh5C,UAAU06C,UAAY,WAC9B5rB,eAAa7R,IAAIf,SAAU,UAAW/c,KAAK03B,oBAAqB13B,MAChE2vB,eAAa7R,IAAIf,SAAU,WAAY/c,KAAKu8C,kBAAmBv8C,MAC/D2vB,eAAa7R,IAAI9d,KAAKuC,YAAa,YAAavC,KAAKm3B,sBAAuBn3B,MAC5E2vB,eAAa7R,IAAI9d,KAAKuC,YAAa,YAAavC,KAAKo3B,sBAAuBp3B,MAC5E2vB,eAAa7R,IAAI9d,KAAKuC,YAAa,UAAWvC,KAAKq3B,oBAAqBr3B,MACxE2vB,eAAa7R,IAAIf,SAAU,UAAW/c,KAAKq3B,oBAAqBr3B,MAChE2vB,eAAa7R,IAAI9d,KAAKoC,YAAa,YAAapC,KAAKs3B,uBAAwBt3B,MAC7E2vB,eAAa7R,IAAI9d,KAAKoC,YAAa,YAAapC,KAAKu3B,uBAAwBv3B,MAC7E2vB,eAAa7R,IAAI9d,KAAKoC,YAAa,UAAWpC,KAAKw3B,qBAAsBx3B,MACzE2vB,eAAa7R,IAAIf,SAAU,UAAW/c,KAAKw3B,qBAAsBx3B,MACjE2vB,eAAa7R,IAAI9d,KAAKuC,YAAa,aAAcvC,KAAKy3B,kBAAmBz3B,MACzE2vB,eAAa7R,IAAI9d,KAAKoC,YAAa,aAAcpC,KAAKy3B,kBAAmBz3B,MACzE2vB,eAAa7R,IAAI9d,KAAKoC,YAAa,4BAA6BpC,KAAK23B,aAAc33B,MACnF2vB,eAAa7R,IAAI9d,KAAKuC,YAAa,4BAA6BvC,KAAK23B,aAAc33B,MACnFilB,OAAOrkB,iBAAiB,SAAUZ,KAAKw8C,oBAAoB14B,KAAK9jB,OAC1Dic,UAAQwgC,OAA+B,WAAtBxgC,UAAQygC,KAAK13B,MAChC23B,OAAOC,YAAYh8C,iBAAiB,SAAUZ,KAAK68C,kBAAkB/4B,KAAK9jB,OAE9EA,KAAK8C,OAAO,SAAWxB,KAAM,YAAayB,kBAAkB,KAQhE82C,EAAYh5C,UAAU43B,YAAc,WAChC9I,eAAa3D,OAAOjP,SAAU,UAAW/c,KAAK03B,qBAC9C/H,eAAa3D,OAAOjP,SAAU,WAAY/c,KAAKu8C,mBAC/C5sB,eAAa3D,OAAOhsB,KAAKuC,YAAa,YAAavC,KAAKm3B,uBACxDxH,eAAa3D,OAAOhsB,KAAKuC,YAAa,YAAavC,KAAKo3B,uBACxDzH,eAAa3D,OAAOhsB,KAAKuC,YAAa,UAAWvC,KAAKq3B,qBACtD1H,eAAa3D,OAAOjP,SAAU,UAAW/c,KAAKq3B,qBAC9C1H,eAAa3D,OAAOhsB,KAAKoC,YAAa,YAAapC,KAAKs3B,wBACxD3H,eAAa3D,OAAOhsB,KAAKoC,YAAa,YAAapC,KAAKu3B,wBACxD5H,eAAa3D,OAAOhsB,KAAKoC,YAAa,UAAWpC,KAAKw3B,sBACtD7H,eAAa3D,OAAOjP,SAAU,UAAW/c,KAAKw3B,sBAC9C7H,eAAa3D,OAAOhsB,KAAKuC,YAAa,aAAcvC,KAAKy3B,mBACzD9H,eAAa3D,OAAOhsB,KAAKoC,YAAa,aAAcpC,KAAKy3B,mBACzD9H,eAAa3D,OAAOhsB,KAAKoC,YAAa,4BAA6BpC,KAAK23B,cACxEhI,eAAa3D,OAAOhsB,KAAKuC,YAAa,4BAA6BvC,KAAK23B,cACxE1S,OAAOjkB,oBAAoB,SAAUhB,KAAKw8C,oBAAoB14B,KAAK9jB,OAC7Dic,UAAQwgC,OAA+B,WAAtBxgC,UAAQygC,KAAK13B,MAChC23B,OAAOC,YAAY57C,oBAAoB,SAAUhB,KAAK68C,kBAAkB/4B,KAAK9jB,OAEjFA,KAAK8C,OAAO,SAAWxB,KAAM,cAAeyB,kBAAkB,IAC9D/C,KAAK8C,OAAO,aAAexB,KAAM,cAAeyB,kBAAkB,KAEtE82C,EAAYh5C,UAAUm7C,aAAe,WACjCh8C,KAAK+N,QAAQ8N,MAAMihC,UAAY,YAC/B,IAAI74C,IAAQoY,cAAe,EAC3Brc,MAAK8C,OAAO,WAAaxB,KAAM,mBAAoBE,OAASyC,IAAKA,IACjE,IAAI3D,GAAS2D,EAAmB,aAChCjE,MAAK+N,QAAQ8N,MAAMxb,MAAQL,KAAKK,MAChCL,KAAK+N,QAAQ8N,MAAMvb,OAASN,KAAKM,MACjC,IAAIs0C,GAAgB50C,KAAK+N,QAAQmZ,YAAYlnB,KAAK6nB,cAAc,OAAS7K,GAAIhd,KAAK+N,QAAQiP,GAAK,iBAC3F8+B,UAAW,mBAAoBh0B,OAASjM,MAAO,WAAa7b,KAAK+N,QAAQqO,aAAe9b,EAAS,GAAK,cAC7FN,KAAK+N,QAAQ8mC,YAAc,GAC1B,+DAEd70C,MAAKoC,YAAcwyC,EAAc1tB,YAAYlnB,KAAK6nB,cAAc,UAC5D7K,GAAIhd,KAAK+N,QAAQiP,GAAK,eAAgB8K,OAAS9C,KAAM,kBAEzDhlB,KAAKuC,YAAcqyC,EAAc1tB,YAAYlnB,KAAK6nB,cAAc,UAC5D7K,GAAIhd,KAAK+N,QAAQiP,GAAK,eAAgB8K,OAAS9C,KAAM,kBAEzDhlB,KAAKqiB,eAAiBriB,KAAK6nB,cAAc,UACrC7K,GAAIhd,KAAK+N,QAAQiP,GAAK,kBAAmB8K,OAAS9C,KAAM,iBAE5DhlB,KAAK8c,SAAW83B,EAAc1tB,YAAYlnB,KAAK6nB,cAAc,YACzD7K,GAAIhd,KAAK+N,QAAQiP,GAAK,YAAa8+B,UAAW,aAAch0B,OAAS9C,KAAM,eAElEhlB,KAAK+N,QAAQmZ,YAAYlnB,KAAK6nB,cAAc,OACrD7K,GAAIhd,KAAK+N,QAAQiP,GAAK,UAAW8+B,UAAW,cAEzCjgC,MAAMG,QAAU,OACvBhc,KAAK8c,SAASF,aAAa,aAAc,SACzC5c,KAAK8c,SAASjB,MAAMvB,WAAa,SACjCta,KAAKoC,YAAYyZ,MAAMxb,MAAQL,KAAKuC,YAAYsZ,MAAMxb,MAAQL,KAAKqiB,eAAexG,MAAMxb,MAAQ,OAChGL,KAAKoC,YAAYyZ,MAAMvb,OAASN,KAAKuC,YAAYsZ,MAAMvb,OAASN,KAAKqiB,eAAexG,MAAMvb,OAAS,OACnGN,KAAKuC,YAAYsZ,MAAMqgC,SAAWl8C,KAAKoC,YAAYyZ,MAAMqgC,SAAWl8C,KAAK8c,SAASjB,MAAMqgC,SAAW,WACnGl8C,KAAK8c,SAASjB,MAAMkhC,gBAAkB,cACtC/8C,KAAK8c,SAASjB,MAAMG,QAAU,OAC9Bhc,KAAK8c,SAASjB,MAAMmhC,OAAS,OAC7Bh9C,KAAKqC,aAAerC,KAAKoC,YAAYE,WAAW,MAChDtC,KAAK6E,QAAU7E,KAAK6nB,cAAc,OAC9B7K,GAAIhd,KAAK+N,QAAQiP,GAAK,UAAW8K,OAAS9C,KAAM,QAASi4B,YAAa,eAE1Ej9C,KAAKuC,YAAYsZ,MAAMgC,OAAS7d,KAAK6d,OAAS,UAC9C7d,KAAKuC,YAAYsZ,MAAMG,QAAU,QACjChc,KAAKwC,aAAexC,KAAKuC,YAAYD,WAAW,OAEpDu3C,EAAYh5C,UAAU42B,kBAAoB,SAAUpI,GAChDrvB,KAAK8C,OAAO,aAAexB,KAAM,oBAAqByB,kBAAkB,EAAOvB,OAAS6tB,EAAGA,MAE/FwqB,EAAYh5C,UAAUs2B,sBAAwB,SAAU9H,GACpDrvB,KAAK8C,OAAO,aAAexB,KAAM,wBAAyByB,kBAAkB,EAAOvB,OAAS6tB,EAAGA,MAEnGwqB,EAAYh5C,UAAUu2B,sBAAwB,SAAU/H,GACpDrvB,KAAK8C,OAAO,aAAexB,KAAM,wBAAyByB,kBAAkB,EAAOvB,OAAS6tB,EAAGA,MAEnGwqB,EAAYh5C,UAAUw2B,oBAAsB,SAAUhI,GAClDrvB,KAAK8C,OAAO,aAAexB,KAAM,sBAAuByB,kBAAkB,EAAOvB,OAAS6tB,EAAGA,MAEjGwqB,EAAYh5C,UAAU62B,oBAAsB,SAAUrI,GAClDrvB,KAAK8C,OAAO,aAAexB,KAAM,sBAAuByB,kBAAkB,EAAOvB,OAAS6tB,EAAGA,MAEjGwqB,EAAYh5C,UAAU07C,kBAAoB,SAAUltB,GAEZ,UAAhCrvB,KAAK8c,SAASjB,MAAMG,SAAuBqT,EAAE5L,OAAOzG,KAAOhd,KAAK+N,QAAQiP,GAAK,aAC7Ehd,KAAK8C,OAAO,aAAexB,KAAM,cAAeE,OAAS6tB,EAAGA,MAGpEwqB,EAAYh5C,UAAUy2B,uBAAyB,SAAUjI,GACrDrvB,KAAK8C,OAAO,aAAexB,KAAM,yBAA0ByB,kBAAkB,EAAOvB,OAAS6tB,EAAGA,MAEpGwqB,EAAYh5C,UAAU02B,uBAAyB,SAAUlI,GACrDrvB,KAAK8C,OAAO,aAAexB,KAAM,yBAA0ByB,kBAAkB,EAAOvB,OAAS6tB,EAAGA,MAEpGwqB,EAAYh5C,UAAU22B,qBAAuB,SAAUnI,GACnDrvB,KAAK8C,OAAO,aAAexB,KAAM,uBAAwByB,kBAAkB,EAAOvB,OAAS6tB,EAAGA,MAElGwqB,EAAYh5C,UAAU82B,aAAe,SAAUtI,GAC3CrvB,KAAK8C,OAAO,aAAexB,KAAM,eAAgByB,kBAAkB,EAAOvB,OAAS6tB,EAAGA,MAE1FwqB,EAAYh5C,UAAUq8C,eAAiB,WACnCl9C,KAAK0iB,UAETm3B,EAAYh5C,UAAUg8C,kBAAoB,WAClC5gC,UAAQC,UACR8a,WAAWh3B,KAAKk9C,eAAep5B,KAAK9jB,MAAO,MAGnD65C,EAAYh5C,UAAU27C,oBAAsB,YACnCvgC,UAAQC,UAAYlc,KAAK+N,QAAQkP,UAAUC,SAAS,mBACrDld,KAAKk9C,kBAGbrD,EAAYh5C,UAAUs8C,yBAA2B,WAE7C,IAAK,GADD9C,GAAUr6C,KAAKo6C,kBACVp1C,EAAI,EAAGA,EAAIq1C,EAAQl1C,OAAQH,IAChChF,KAAK8C,OAAOu3C,EAAQr1C,GAAGs1C,QAAUh5C,KAAM,QAASyB,kBAAkB,KAG1E82C,EAAYh5C,UAAUu8C,WAAa,SAAU58C,EAAGC,GAC5CT,KAAK6qC,gBAAiB,CACtB,IAAI5mC,IAAQsqC,SAAS,EAGrB,OAFAvuC,MAAK8C,OAAO,SAAWxB,KAAM,kBAAmByB,kBAAkB,EAC9DvB,OAAShB,EAAGA,EAAGC,EAAGA,EAAGwD,IAAKA,KACvBA,EAAa,SAOxB41C,EAAYh5C,UAAUme,eAAiB,WACnChf,KAAK8C,OAAO,aAAexB,KAAM,iBAAkByB,kBAAkB,KAazE82C,EAAYh5C,UAAUe,KAAO,WACzB,GAAIqC,IAAQ4I,QAAQ,EAEpB,OADA7M,MAAK8C,OAAO,QAAUxB,KAAM,OAAQyB,kBAAkB,EAAOvB,OAASyC,IAAKA,KACpEA,EAAY,QAgBvB41C,EAAYh5C,UAAU8nB,KAAO,SAAU9hB,GACnC7G,KAAK8C,OAAO,aAAexB,KAAM,OAAQE,OAASqF,UAAWA,KAC7D7G,KAAK8C,OAAO,aAAexB,KAAM,gBAAiBE,OAASmF,KAAM,SAWrEkzC,EAAYh5C,UAAUqoB,aAAe,WACjC,GAAIjlB,IAAQoB,OAAQ,KAEpB,OADArF,MAAK8C,OAAO,UAAYxB,KAAM,iBAAkBE,OAASsE,OAAQ7B,KAC1DA,EAAY,OAAE3B,WAAW,MAAM4mB,aAAa,EAAG,EAAGjlB,EAAY,OAAE5D,MAAO4D,EAAY,OAAE3D,SAYhGu5C,EAAYh5C,UAAUgR,KAAO,SAAUyS,GACnCtkB,KAAK8C,OAAO,QAAUxB,KAAM,OAAQE,OAAS8iB,KAAMA,MAUvDu1B,EAAYh5C,UAAUqB,MAAQ,WAC1B,GAAI+B,IAAQ2K,cAAc,EAE1B,IADA5O,KAAK8C,OAAO,QAAUxB,KAAM,gBAAiBE,OAASyC,IAAKA,MACtDjE,KAAKwL,WAAavH,EAAkB,aAAG,CACxCjE,KAAKgiB,aAAahiB,KAAKoiB,iBACvBpiB,KAAKgiB,aAAahiB,KAAKqC,cACvBrC,KAAKgiB,aAAahiB,KAAKwC,cACvBxC,KAAK8C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,IAC9DmJ,eACDlM,KAAK8C,OAAO,WAAaxB,KAAM,kBAAmByB,kBAAkB,EAAOvB,OAASmF,KAAM,OAClF8C,YAAY,EAAOC,YAAY,EAAOC,UAAW,KAAMC,MAAO,QAClEqS,UAAQC,UAAYa,SAAS0F,eAAeziB,KAAK+N,QAAQiP,GAAK,oBAC9DkG,eAAanG,SAAS0F,eAAeziB,KAAK+N,QAAQiP,GAAK,kBAAmB,WAAWlc,UACrFd,KAAK8C,OAAO,WAAaxB,KAAM,wBAAyByB,kBAAkB,MAGlF/C,KAAKyF,YAAYmG,aAAe5L,KAAKkH,WAAalH,KAAKge,UAAYhe,KAAKqe,UAAYre,KAAKyL,eAAgB,EACzGzL,KAAKwF,aAAexF,KAAKoe,WAAY,EACrCpe,KAAKkF,WACLlF,KAAKgD,UAAUC,OAAS,EACxBjD,KAAKuC,YAAYsZ,MAAMG,QAAU,QACjChc,KAAKgD,UAAUU,cAAgB,GAC/B1D,KAAKuC,YAAYsZ,MAAMgC,OAAS7d,KAAK6d,OAAS7d,KAAKoC,YAAYyZ,MAAMgC,OAAS,UAC9E7d,KAAKqC,aAAamT,UAAYxV,KAAKwC,aAAagT,cAAY/B,GAC5DzT,KAAK8c,SAAStb,MAAQxB,KAAK8c,SAASugC,YAAc,GAClDr9C,KAAK8c,SAASjB,MAAMG,QAAU,OAC9Bhc,KAAKqC,aAAasC,OAAS3E,KAAKod,aAAepd,KAAKwhB,mBACpDxhB,KAAKoD,IAAIC,SAAWrD,KAAKoD,IAAIE,QAAUtD,KAAKoD,IAAIgB,QAAUpE,KAAKoD,IAAIiB,OAAS,EAC5ErE,KAAKoD,IAAIG,UAAYvD,KAAKoD,IAAII,WAAaxD,KAAKoD,IAAIkB,SAAWtE,KAAKoD,IAAImB,UAAY,KACpFvE,KAAK+D,mBAAqB,KAC1B/D,KAAKqH,SAAS4C,oBAAuBzJ,EAAG,EAAGC,EAAG,GAC9CT,KAAKsG,kBACLtG,KAAK6I,UACL7I,KAAKiH,aACLjH,KAAKgH,gBAAkB,EACvBhH,KAAK8C,OAAO,QAAUxB,KAAM,mBAC5BtB,KAAKoC,YAAYyZ,MAAMZ,KAAOjb,KAAKuC,YAAYsZ,MAAMZ,KAAO,GAC5Djb,KAAKg6C,gBACLh6C,KAAKoC,YAAYyZ,MAAM6K,IAAM1mB,KAAKuC,YAAYsZ,MAAM6K,IAAM,GAC1D1mB,KAAKoC,YAAYyZ,MAAM8K,SAAW3mB,KAAKuC,YAAYsZ,MAAM8K,SAAW,GACpE3mB,KAAKoC,YAAYyZ,MAAM+K,UAAY5mB,KAAKuC,YAAYsZ,MAAM+K,UAAY,GACtE5mB,KAAKgD,UAAU4C,kBAAoB5F,KAAKgD,UAAUa,WAAa,EAC/D7D,KAAKgD,UAAUsc,eAAiB,KAChCtf,KAAKyF,aAAgBL,MAAO,GAAI6Z,YAAY,EAAOjU,aAAa,EAAOiI,QAAQ,EAAO+3B,eAAe,EAAOzM,QAAQ,EAChHwD,eAAe,EAAOr8B,cAAc,EAAOugB,UAAU,EAAOlK,YAAY,EACxEnQ,cAAc,EAAOuR,YAAY,EAAO/S,QAAQ,EAAOgvB,UAAU,GACrEp5B,KAAKgG,SAAYuD,SAAU,EAAGmY,YAAa,EAAGpa,kBAAoB9G,EAAG,EAAGC,EAAG,GAAKsJ,wBAA0BvJ,EAAG,EAAGC,EAAG,GAC/GwI,0BAA4BzI,EAAG,EAAGC,EAAG,GAAKF,kBAAoBC,EAAG,EAAGC,EAAG,GAAKmC,aAC5E0D,kBAAoBrD,OAAQ,EAAGS,cAAe,GAAIG,WAAY,EAAGqJ,kBAAmB,EACpF/D,YAAchJ,OAAQ,EAAGC,OAAQ,EAAGC,MAAO,EAAGC,OAAQ,GACtDqhB,WAAaxhB,OAAQ,EAAGC,OAAQ,EAAGC,MAAO,EAAGC,OAAQ,GAAKqE,OAAQ,GAAIid,gBAAgB,GAC1F5hB,KAAK6F,oBACL7F,KAAKwd,cAAgB,EACrB,IAAIxK,IAAUsqC,kBAAkB,EAChCt9C,MAAK8C,OAAO,QAAUxB,KAAM,sBAAuByB,kBAAkB,EAAOvB,OAASyC,IAAK+O,KACtFA,EAAwB,kBACxBhT,KAAKgN,eAAgBC,cAAgBpJ,WAAYmP,EAAwB,oBAAO,GAEhF+J,SAAS0F,eAAeziB,KAAK+N,QAAQiP,GAAK,6BAC1CD,SAAS0F,eAAeziB,KAAK+N,QAAQiP,GAAK,2BAA2BnB,MAAMG,QAAU,QAEzFhc,KAAKm9C,2BACLn9C,KAAK8C,OAAO,UAAYxB,KAAM,qBAC9BtB,KAAKyL,eAAgB,EACrBzL,KAAK8C,OAAO,QAAUxB,KAAM,gBAAiByB,kBAAkB,IAC/D/C,KAAKyL,eAAgB,EAChBS,eACGlM,KAAK+N,QAAQoO,cAAc,kCAC3Bnc,KAAK+N,QAAQoO,cAAc,iCAAiCc,UAAUa,IAAI,UAE9E9d,KAAK8C,OAAO,WAAaxB,KAAM,uBAAwBE,OAASyc,YAAY,KAC5Eje,KAAK8C,OAAO,WAAaxB,KAAM,2BAkB3Cu4C,EAAYh5C,UAAUiT,OAAS,SAAU7Q,GACrC,GAAIgB,IAAQ2C,UAAU,EAGtB,OAFA5G,MAAK8C,OAAO,aAAexB,KAAM,SAAUE,OAASyB,OAAQA,EAAQgB,IAAKA,KACzEjE,KAAK8C,OAAO,aAAexB,KAAM,gBAAiBE,OAASmF,KAAM,QAC1D1C,EAAc,UAazB41C,EAAYh5C,UAAUkiB,OAAS,SAAUpc,EAAMgI,GAC3C3O,KAAK8C,OAAO,UAAYxB,KAAM,SAAUyB,kBAAkB,EAAOvB,OAASmF,KAAMA,EAAMgI,SAAUA,MAmBpGkrC,EAAYh5C,UAAUyQ,OAAS,SAAU3K,EAAMxG,EAAQC,EAAQC,EAAOC,GAClEN,KAAK8C,OAAO,QAAUxB,KAAM,SAAUyB,kBAAkB,EACpDvB,OAASmF,KAAMA,EAAMxG,OAAQA,EAAQC,OAAQA,EAAQC,MAAOA,EAAOC,OAAQA,MAUnFu5C,EAAYh5C,UAAU0tB,aAAe,SAAU/sB,GAC3CxB,KAAK8C,OAAO,iBAAmBxB,KAAM,eAAgByB,kBAAkB,EAAOvB,OAASA,MAAOA,MAYlGq4C,EAAYh5C,UAAU08C,aAAe,SAAU/7C,IACtCxB,KAAKwL,UAAYxL,KAAKyL,eACvBzL,KAAKuuB,aAAa/sB,IAa1Bq4C,EAAYh5C,UAAU8E,IAAM,SAAUnE,GAClCxB,KAAK8C,OAAO,aAAexB,KAAM,MAAOyB,kBAAkB,EAAOvB,OAASA,MAAOA,MAcrFq4C,EAAYh5C,UAAUgc,KAAO,SAAUhZ,EAAYsD,GAC/CnH,KAAK8C,OAAO,aAAexB,KAAM,OAAQyB,kBAAkB,EACvDvB,OAASqC,WAAYA,EAAYsD,UAAWA,MAiBpD0yC,EAAYh5C,UAAU4lC,YAAc,SAAUjmC,EAAGC,EAAG+oC,EAASC,EAASx6B,EAAaF,EAAaC,GAC5F,GAAIwuC,IAAY,EACZ9U,EAAkB1oC,KAAKo9C,WAAW58C,EAAGC,EAMzC,QALKT,KAAKwL,UAAYxL,KAAKyL,gBAAkBi9B,GAAoBzmC,oBAAkBzB,IAAMyB,oBAAkBxB,MACvG+8C,GAAY,EACZx9C,KAAK8C,OAAO,SAAWxB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAAShB,EAAGA,EAAGC,EAAGA,EAAG+oC,QAASA,EAASC,QAASA,EAC7Gx6B,YAAaA,EAAaF,YAAaA,EAAaC,UAAWA,MAEpEwuC,GAaX3D,EAAYh5C,UAAU6lC,SAAW,SAAUvmC,EAAQC,EAAQ2H,EAAMC,EAAMiH,EAAaF,GAChF,GAAIwvB,IAAS,EACTmK,EAAkB1oC,KAAKo9C,WAAWj9C,EAAQC,EAM9C,QALKJ,KAAKwL,UAAYxL,KAAKyL,gBAAkBi9B,GAAoBzmC,oBAAkB9B,IAAW8B,oBAAkB7B,MAC5Gm+B,GAAS,EACTv+B,KAAK8C,OAAO,SAAWxB,KAAM,WAAYyB,kBAAkB,EAAOvB,OAASrB,OAAQA,EAAQC,OAAQA,EAAQ2H,KAAMA,EACzGC,KAAMA,EAAMiH,YAAaA,EAAaF,YAAaA,MAExDwvB,GAeXsb,EAAYh5C,UAAU8lC,UAAY,SAAUxmC,EAAQC,EAAQ2H,EAAMC,EAAMiH,EAAaF,EAAa66B,EAAYC,GAC1G,GAAI4T,IAAU,EACV/U,EAAkB1oC,KAAKo9C,WAAWj9C,EAAQC,EAM9C,QALKJ,KAAKwL,UAAYxL,KAAKyL,gBAAkBi9B,GAAoBzmC,oBAAkB9B,IAAW8B,oBAAkB7B,MAC5Gq9C,GAAU,EACVz9C,KAAK8C,OAAO,SAAWxB,KAAM,YAAayB,kBAAkB,EAAOvB,OAASrB,OAAQA,EAAQC,OAAQA,EAAQ2H,KAAMA,EAC1GC,KAAMA,EAAMiH,YAAaA,EAAaF,YAAaA,EAAa66B,WAAYA,EAAYC,SAAUA,MAEvG4T,GAUX5D,EAAYh5C,UAAU+lC,SAAW,SAAU3/B,EAAWgI,EAAaF,GAC/D/O,KAAK6qC,gBAAiB,CACtB,IAAI5mC,IAAQsqC,SAAS,GACjBmP,GAAS,CACb,IAAIz2C,GAAaA,EAAU9B,OAAS,EAChC,IAAK,GAAIH,GAAI,EAAGA,EAAIiC,EAAU9B,SACtBlB,EAAa,QADiBe,IAIlChF,KAAK8C,OAAO,SAAWxB,KAAM,kBAAmByB,kBAAkB,EAC9DvB,OAAShB,EAAGyG,EAAUjC,GAAGxE,EAAGC,EAAGwG,EAAUjC,GAAGvE,EAAGwD,IAAKA,IAQhE,QALKjE,KAAKwL,UAAYxL,KAAKyL,gBAAkBxH,EAAa,SAAKhC,oBAAkBgF,MAC7Ey2C,GAAS,EACT19C,KAAK8C,OAAO,SAAWxB,KAAM,WAAYyB,kBAAkB,EAAOvB,OAASyF,UAAWA,EAC9EgI,YAAaA,EAAaF,YAAaA,MAE5C2uC,GAcX7D,EAAYh5C,UAAUgmC,cAAgB,SAAUrmC,EAAGC,EAAGJ,EAAOC,EAAQ2O,EAAaF,EAAaC,GAC3F,GAAI2uC,IAAc,EACdjV,EAAkB1oC,KAAKo9C,WAAW58C,EAAGC,EAMzC,QALKT,KAAKwL,UAAYxL,KAAKyL,gBAAkBi9B,GAAoBzmC,oBAAkBzB,IAAMyB,oBAAkBxB,MACvGk9C,GAAc,EACd39C,KAAK8C,OAAO,SAAWxB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAAShB,EAAGA,EAAGC,EAAGA,EAAGJ,MAAOA,EAAOC,OAAQA,EAC1G2O,YAAaA,EAAaF,YAAaA,EAAaC,UAAWA,MAEpE2uC,GAkBX9D,EAAYh5C,UAAUimC,SAAW,SAAUtmC,EAAGC,EAAG0O,EAAMC,EAAY7G,EAAU8G,EAAMC,EAAQ6jB,GACvF,GAAIlgB,IAAS,EACTy1B,EAAkB1oC,KAAKo9C,WAAW58C,EAAGC,EAMzC,QALKT,KAAKwL,UAAYxL,KAAKyL,gBAAkBi9B,GAAoBzmC,oBAAkBzB,IAAMyB,oBAAkBxB,MACvGwS,GAAS,EACTjT,KAAK8C,OAAO,SAAWxB,KAAM,WAAYyB,kBAAkB,EAAOvB,OAAShB,EAAGA,EAAGC,EAAGA,EAAG0O,KAAMA,EAAMC,WAAYA,EACvG7G,SAAUA,EAAU8G,KAAMA,EAAMC,OAAQA,EAAQ6jB,MAAOA,MAE5DlgB,GAYX4mC,EAAYh5C,UAAU+nC,YAAc,SAAU5rB,GAC1C,GAAI/Y,IAAQmvB,YAAY,EAExB,OADApzB,MAAK8C,OAAO,SAAWxB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAASwb,GAAIA,EAAI/Y,IAAKA,KACpFA,EAAgB,YAY3B41C,EAAYh5C,UAAUgoC,YAAc,SAAU7rB,GAC1Chd,KAAK8C,OAAO,SAAWxB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAASwb,GAAIA,MAWtF68B,EAAYh5C,UAAU2nC,gBAAkB,SAAUxrB,GAC9C,GAAIoxB,KAGJ,OAFApuC,MAAK8C,OAAO,SAAWxB,KAAM,kBAAmByB,kBAAkB,EAC9DvB,OAASwb,GAAIA,EAAI/Y,IAAKmqC,KACnBA,GAOXyL,EAAYh5C,UAAU4nC,iBAAmB,WACrC,GAAIxkC,IAAQqqC,oBAEZ,OADAtuC,MAAK8C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,EAAOvB,OAASyC,IAAKA,KACjFA,EAAsB,kBAOjC41C,EAAYh5C,UAAU6hB,OAAS,WAC3B1iB,KAAK8C,OAAO,aAAexB,KAAM,YAcrCu4C,EAAYh5C,UAAUkpB,cAAgB,SAAUoC,EAAgB3qB,IACvDxB,KAAKwL,UAAYxL,KAAKyL,eACvBzL,KAAK8C,OAAO,UAAYxB,KAAM,gBAAiBE,OAASA,MAAOA,EAAOo8C,OAAQzxB,MAYtF0tB,EAAYh5C,UAAUg9C,iBAAmB,SAAUC,IAC1C99C,KAAKwL,UAAYxL,KAAKyL,gBACvBzL,KAAK8C,OAAO,UAAYxB,KAAM,mBAAoBE,OAASo8C,OAAQE,EAAaz4B,cAChFrlB,KAAKod,aAAepd,KAAKqC,aAAasC,OACtC3E,KAAK8C,OAAO,aAAexB,KAAM,gBAAiBE,OAASmF,KAAM,UAWzEkzC,EAAYh5C,UAAUu1C,KAAO,WACzBp2C,KAAK8C,OAAO,aAAexB,KAAM,OAAQyB,kBAAkB,KAS/D82C,EAAYh5C,UAAUw1C,KAAO,WACzBr2C,KAAK8C,OAAO,aAAexB,KAAM,OAAQyB,kBAAkB,KAS/D82C,EAAYh5C,UAAUk9C,kBAAoB,WACtC,OAASv9C,EAAGR,KAAKoD,IAAIC,SAAU5C,EAAGT,KAAKoD,IAAIE,QAASjD,MAAOL,KAAKoD,IAAIG,UAAWjD,OAAQN,KAAKoD,IAAII,aAGpGq2C,EAAYh5C,UAAUk7C,kBAAoB,WACtC,GAAIiC,GACAC,EAAaj+C,KAAK+N,QAAQiP,GAAK,WAC/BkhC,EAAcl+C,KAAK+N,QAAQoO,cAAc,IAAMnc,KAAK+N,QAAQiP,GAAK,eACrE,IAAIhd,KAAKolB,gBAAiB,CAGtB,GAFAplB,KAAKm+C,UAAYn+C,KAAKo+C,eAAep+C,KAAKolB,iBAEtCplB,KAAKq+C,QACLL,EAAWh+C,KAAKm+C,WAAYx3C,KAAM,WAAa3G,KAAM,WAAYi+C,GAAY,OAG5E,IAAIj+C,KAAKs+C,UAAW,CACrB,GAAIC,GAAev+C,KAAKm+C,WAAYx3C,KAAM,WAAa3G,KAAM,WAAYi+C,EACzED,GAAyC,IAA7BO,EAAa,GAAGC,SAAkBD,EAAa,GAAKA,EAAa,OAG7EP,GAAWh+C,KAAKm+C,WAAYx3C,KAAM,WAAa3G,KAAM,WAAYi+C,GAAY,EAEjFC,GAAYh3B,YAAY82B,GACxBh+C,KAAKqc,cAAgB6hC,EAAYz5C,aACjCzE,KAAK8C,OAAO,WAAaxB,KAAM,mBAAoBE,OAASlB,OAAQN,KAAKqc,iBACzErc,KAA2B,yBAGnC65C,EAAYh5C,UAAUu7C,6BAA+B,WACjD,GAAI4B,GACAC,EAAaj+C,KAAK+N,QAAQiP,GAAK,sBAC/BkhC,EAAcl+C,KAAK+N,QAAQoO,cAAc,IAAMnc,KAAK+N,QAAQiP,GAAK,0BACrE,IAAIhd,KAAKm8C,2BAA4B,CAGjC,GAFAn8C,KAAKy+C,MAAQz+C,KAAKo+C,eAAep+C,KAAKm8C,4BAElCn8C,KAAKq+C,QACLL,EAAWh+C,KAAKy+C,OAAQ93C,KAAM,WAAa3G,KAAM,WAAYi+C,GAAY,OAGxE,IAAIj+C,KAAKs+C,UAAW,CACrB,GAAIC,GAAev+C,KAAKy+C,OAAQ93C,KAAM,WAAa3G,KAAM,WAAYi+C,EACrED,GAAyC,IAA7BO,EAAa,GAAGC,SAAkBD,EAAa,GAAKA,EAAa,OAG7EP,GAAWh+C,KAAKy+C,OAAQ93C,KAAM,WAAa3G,KAAM,WAAYi+C,GAAY,EAE7EC,GAAYh3B,YAAY82B,GACxBh+C,KAA2B,yBAGnC65C,EAAYh5C,UAAUu9C,eAAiB,SAAUJ,GAC7C,GAAIA,EACA,IACI,MAAwB,kBAAbA,IAA2BjhC,SAAS2hC,iBAAiBV,GAAU74C,OAC/Dw5C,UAAiB5hC,SAASZ,cAAc6hC,GAAU72B,UAAUk0B,QAG5DuD,UAAQZ,GAGvB,MAAOa,GACH,MAAOF,WAAiBX,KAMpCnE,EAAYh5C,UAAUi+C,cAAgB,SAAU9hC,GAG5C,OAFkB+hC,EAAK,OAAQC,EAAK,MAAOC,EAAK,QAASC,EAAK,aAC1DC,EAAK,SAAUC,EAAK,cAAeC,EAAK,SAAUC,EAAK,eAC1C,GAAKtiC,IAE1B68B,EAAYh5C,UAAU0+C,kBAAoB,SAAU54C,GAIhD,OAHqB2iB,WAAck2B,sBAAoBC,WAAYl2B,SAAYi2B,sBAAoBE,SAC/Fl2B,IAAOg2B,sBAAoBG,IAAKl2B,WAAc+1B,sBAAoBI,WAAY9jC,QAAW0jC,sBAAoBK,QAC7Gn2B,KAAQ81B,sBAAoBM,KAAMn2B,SAAY61B,sBAAoBO,UAClD,GAAKp5C,IAE7BkzC,EAAYh5C,UAAUm/C,aAAe,SAAU5+C,GAC3CpB,KAAK8C,OAAO,iBAAmBxB,KAAM,oBAAqByB,kBAAkB,EAAOvB,OAASA,MAAOisB,SAASrsB,EAAM,QAEtHy4C,EAAYh5C,UAAUwkC,8BAAgC,WAClD,GAAIphC,IAAQuhC,8BAA+B,KAC3CxlC,MAAK8C,OAAO,iBAAmBxB,KAAM,mCAAoCE,OAASyC,IAAKA,KACvFjE,KAAK8C,OAAO,iBAAmBxB,KAAM,eAAgBE,OAAS2xB,MAAOlvB,EAAmC,8BAAE8K,gBAE9G8qC,EAAYh5C,UAAUo/C,oBAAsB,WACxCjgD,KAAKkF,QAAQe,KAAKjG,KAAK4C,WACvB5C,KAAK8C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,GACnE,IAAImE,GAAalH,KAAKkH,UACtBlH,MAAKoe,WAAY,EACjBpe,KAAKkH,YAAa,EACdlH,KAAKgD,UAAUsc,gBAAkBtf,KAAKgD,UAAUsc,eAAiB,EACjEtf,KAAK8C,OAAO,aAAexB,KAAM,aAAcyB,kBAAkB,EAC7DvB,OAASqC,YAAa7D,KAAKgD,UAAUsc,eAAgBnY,UAAW,QAGpEnH,KAAK8C,OAAO,aAAexB,KAAM,aAAcyB,kBAAkB,EAC7DvB,OAASqC,WAAYsE,KAAKC,IAAIpI,KAAKgD,UAAUsc,gBAAiBnY,UAAW,QAEjFnH,KAAKkH,WAAaA,EAClBlH,KAAKqH,SAASC,kBAAqB9G,EAAG,EAAGC,EAAG,GAC5CT,KAAKgD,UAAUsc,eAAiB,EAChCtf,KAAK8C,OAAO,iBAAmBxB,KAAM,gBAAiByB,kBAAkB,IACxE/C,KAAK4C,UAAYoB,YAAWhE,KAAKkF,QAAQlF,KAAKkF,QAAQC,OAAS,OAAQ,GACvEnF,KAAKkF,QAAQwB,MACb1G,KAAKoe,WAAY,EACjBpe,KAAK8C,OAAO,QAAUxB,KAAM,aAAcyB,kBAAkB,EAAOvB,OAAS6D,OAAQ,YAAapB,IAAKjE,KAAK4C,cAQ/Gi3C,EAAYh5C,UAAU02C,yBAA2B,WAC7Cv3C,KAAKoN,uBAAyBpJ,YAAWhE,KAAK+D,uBAAwB,EACtE,IAAI+B,IAAWC,WACf/F,MAAK8C,OAAO,UAAYxB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAASsE,OAAQA,IACzF,IAAI8wC,GAAa9wC,EAAgB,OACjC8wC,GAAW1xC,QAAUlB,YAAWhE,KAAKkF,YAAa,GAClD0xC,EAAW3vC,UAAYjD,YAAWhE,KAAKiH,cAAe,GACtD2vC,EAAW/wC,iBAAmB7B,YAAWhE,KAAK6F,qBAAsB,EACpE,IAAIuZ,IAAoBhW,aAAc,KACtCpJ,MAAK8C,OAAO,iBAAmBxB,KAAM,kBAAmByB,kBAAkB,EACtEvB,OAASyC,IAAKmb,KAClBw3B,EAAWxtC,aAAepF,YAAWob,EAA8B,iBAAO,GAC1Epf,KAAKkf,qBAAwB7R,UAAW,gBAAiBC,YAAaspC,EAAYA,WAAYA,EAC1FrpC,gBAAiBqpC,EAAW1xC,QAAS6Z,eAAgB63B,EAAW1xC,QAChEsI,kBAAmBopC,EAAW3vC,UAAW4vC,iBAAkBD,EAAW3vC,UACtEwG,qBAAsBmpC,EAAWxtC,aAAcquC,oBAAqBb,EAAWxtC,aAC/EsE,gBAAiB1J,YAAWhE,KAAKgG,YAAa,GAC9C2wC,eAAgB3yC,YAAWhE,KAAKgG,YAAa,GAC7C2H,aAAc,KAAMC,YAAa,KAAMjJ,OAAQ,KAAMa,aAAcxF,KAAKwF,eAWhFq0C,EAAYh5C,UAAUiG,aAAe,SAAUo5C,EAAKj8C,GAChD,GAAIk8C,KACCl+C,qBAAkBi+C,KACnBC,EAASD,EAAIttC,cAAcjG,MAAM,KAErC,KAAK,GAAI3H,GAAI,EAAGA,EAAIm7C,EAAOh7C,OAAQH,IAC/Bm7C,EAAOn7C,GAAKm7C,EAAOn7C,GAAGo7C,OAAO,GAAGC,cAAgBF,EAAOn7C,GAAG0f,MAAM,EAKpE,OAHIzgB,KACAA,EAAa,QAAIk8C,EAAOv4B,KAAK,KAE1Bu4B,EAAOv4B,KAAK,KASvBiyB,EAAYh5C,UAAUy/C,aAAe,WACjC,GAAIC,KACJvgD,MAAKg6C,eACL,IAAIzxC,EAEAA,GAD0B,IAA1BvI,KAAKgD,UAAUC,QAAgBjD,KAAKgD,UAAUC,OAAS,KAAQ,EACpDjD,KAAKoD,IAAIG,UAAY,GAGrBvD,KAAKoD,IAAII,WAAa,EAErC,KAAK,GAAIwB,GAAI,EAAGA,GAAK,GAAIA,IACrBhF,KAAKg6C,aAAa/zC,MAAOkJ,MAAOnK,EAAKmD,KAAK2jB,MAAMvjB,EAAW,IAAK8c,aAChEk7B,EAAMt6C,MAAOkJ,KAAOnK,EAAEqgB,YAE1B,OAAOk7B,IASX1G,EAAYh5C,UAAUgzB,MAAQ,SAAUtY,GACpC,GACI7O,GADAwR,GAAkB,MAEOzK,KAAzBzT,KAAK4C,UAAUwC,QACfsH,EAAa1M,KAAK4C,UAAUwC,MAAMuH,MAAM,UAEzB8G,KAAf/G,GAA4B1M,KAAKyF,YAAYC,aAC7CwY,GAAkB,MAEEzK,KAAf/G,GAA8C,SAAlBA,EAAW,KAC5CwR,GAAkB,EAEtB,IAAIsiC,GAAUxgD,KAAK+N,QAAQoO,cAAc,4DACrClY,GAAQmC,MAAM,EAKlB,IAJApG,KAAK8C,OAAO,aAAexB,KAAM,yBAA0ByB,kBAAkB,EAAOvB,OAASyC,IAAKA,KAC9Fu8C,IACAxgD,KAAKwd,cAAgBgjC,EAAQC,SAAS,GAAGA,SAAS,GAAGzjC,GAAGo+B,QAAQ,SAAU,KAE1El9B,EACAle,KAAK4B,WAEJ,IAAI5B,KAAKqe,UACVre,KAAKuuB,cAAa,GAClBvuB,KAAK8C,OAAO,aAAexB,KAAM,gBAAiBE,OAASmF,KAAM,YAEhE,IAAoC,UAAhC3G,KAAK8c,SAASjB,MAAMG,QACzBhc,KAAK8C,OAAO,SAAWxB,KAAM,eAAgByB,kBAAkB,EAC3DvB,OAAShB,EAAG,KAAMC,EAAG,KAAM8a,YAAa,QACxCtZ,oBAAkBsZ,IAClBvb,KAAK8C,OAAO,aAAexB,KAAM,gBAAiBE,OAASmF,KAAM,YAGpE,KAAMuF,cAAc6Q,SAASZ,cAAc,IAAMnc,KAAK+N,QAAQiP,GAAK,mBAAuB9Q,eAAelM,KAAK+N,QAAQoO,cAAc,2BAA2Bc,UAAUC,SAAS,aACnLld,KAAKyF,YAAY0X,WAAY,CAC7Bnd,KAAKsd,uBAAyBtd,KAAKod,aAAepd,KAAKqC,aAAasC,OACpE3E,KAAKyF,YAAY0X,YAAa,CAC9B,IAAIjK,IAAU1R,MAAO,KACrBxB,MAAK8C,OAAO,QAAUxB,KAAM,yBAA0BE,OAASyC,IAAKiP,KAChEA,EAAa,QAAMlT,KAAKqC,aAAasC,QACrC3E,KAAK8C,OAAO,aAAexB,KAAM,gBAAiBE,OAASmF,KAAM,YAGhE1C,GAAU,MACfjE,KAAK8C,OAAO,iBAAmBxB,KAAM,WAAYyB,kBAAkB,IACnE/C,KAAK8C,OAAO,aAAexB,KAAM,4BAA6BE,OAASod,0BAA0B,KAC5F1S,aAIDlM,KAAK8N,cAAc9N,KAAK+N,QAAS,6BAHjC/N,KAAK8C,OAAO,WAAaxB,KAAM,uBAKnCtB,KAAK8C,OAAO,aAAexB,KAAM,gBAAiBE,OAASmF,KAAM,UAEtB,IAArC3G,KAAK4C,UAAUC,YAAYxC,OAAqD,IAAtCL,KAAK4C,UAAUC,YAAYvC,QACjD,SAAzBN,KAAK4C,UAAUwC,OAAoBpF,KAAK4C,UAAUqE,UAAU9B,OAAS,IACtEnF,KAAK8C,OAAO,SAAWxB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAAS+Z,YAAaA,IAE1FrP,eAAejI,EAAmB,eACnCjE,KAAK8C,OAAO,WAAaxB,KAAM,kBAAmByB,kBAAkB,EAAOvB,OAASmF,KAAM,OAClF8C,YAAY,EAAOC,WAAY,KAAMC,UAAW,KAAMC,MAAO,QAEzE5J,KAAK8C,OAAO,QAAUxB,KAAM,aAAcE,OAAS4E,MAAM,KACzDpG,KAAKoe,WAAY,EACjBpe,KAAKgD,UAAUa,WAAa7D,KAAKgD,UAAU4C,kBAC3C5F,KAAK8C,OAAO,aAAexB,KAAM,yBAA0ByB,kBAAkB,EAAOvB,OAASA,MAAO,OAQxGq4C,EAAYh5C,UAAU6/C,wBAA0B,WAC5C1gD,KAAKuC,YAAYsZ,MAAMG,QAAU,QACjChc,KAAK2gD,mBACL,IAAI18C,IAAQ0Z,gBAAiB,KAC7B3d,MAAK8C,OAAO,UAAYxB,KAAM,qBAAsByB,kBAAkB,EAClEvB,OAASyC,IAAKA,KAClBjE,KAAKqC,aAAasC,OAAS3E,KAAKsd,uBAChCtd,KAAK8C,OAAO,QAAUxB,KAAM,yBAA0BE,OAASo/C,oBAAqB5gD,KAAKqC,aAAasC,UACtG3E,KAAK8C,OAAO,UAAYxB,KAAM,yBAA0ByB,kBAAkB,EACtEvB,OAASkc,oBAAqB1Z,YAAWC,EAAqB,oBAAO,MACzEjE,KAAK8C,OAAO,QAAUxB,KAAM,gBAAiBE,OAASiO,WAAYzP,KAAKwd,gBACvE,IAAIqjC,IAAgBnL,aAAc,KAClC11C,MAAK8C,OAAO,aAAexB,KAAM,kBAAmBE,OAASyC,IAAK48C,KAClE7gD,KAAK8C,OAAO,QAAUxB,KAAM,sBAAuBE,OAASkO,iBAAkBmxC,EAA0B,iBAQ5GhH,EAAYh5C,UAAU8/C,kBAAoB,WAClC3gD,KAAK4C,UAAUwC,OAAgD,SAAvCpF,KAAK4C,UAAUwC,MAAMuH,MAAM,KAAK,IACxD3M,KAAK6zB,SAUbgmB,EAAYh5C,UAAUigD,qBAAuB,WACzC,GAAIrxC,GAAazP,KAAKqC,aAAasC,MACnC3E,MAAKqC,aAAasC,OAAS3E,KAAKod,aAAe,MAC/C,IAAIlY,GAAUlB,YAAWhE,KAAKkF,QAAS,MAAM,GACzC+B,EAAYjD,YAAWhE,KAAKiH,UAAW,MAAM,EACjDjH,MAAKkF,WACLlF,KAAKiH,aACLjH,KAAKgH,gBAAkB,EACvBhH,KAAK8C,OAAO,QAAUxB,KAAM,eAAgBE,OAAS8Z,cAAc,IACnE,IAAIgJ,GAAOtkB,KAAKkpB,cAahB,OAZKhd,gBACI+P,UAAQC,UACTlc,KAAK8C,OAAO,WAAaxB,KAAM,kBAAmByB,kBAAkB,EAAOvB,OAASmF,KAAM,OAClF8C,YAAY,EAAMC,YAAY,KAE1C1J,KAAK+N,QAAQoO,cAAc,IAAMnc,KAAK+N,QAAQiP,GAAK,0BAA0BC,UAAU+O,OAAO,WAElGhsB,KAAKkF,QAAUA,EACflF,KAAKiH,UAAYA,EACjBjH,KAAKgH,gBAAkBC,EAAU9B,OACjCnF,KAAK8C,OAAO,SAAWxB,KAAM,iBAAkByB,kBAAkB,IACjE/C,KAAKqC,aAAasC,OAAS3E,KAAKod,aAAe3N,EACxC6U,GAUXu1B,EAAYh5C,UAAUkgD,uBAAyB,SAAUp6C,EAAMnF,GAC3D,GAAI+J,GAAQvL,KACRghD,GAA0BC,SAAUjhD,KAAKu/C,kBAAkB54C,GAC3DnF,MAAOA,EAAOsK,QAAQ,EAC1B,IAAII,cAAclM,KAAKmM,SAA4D,IAAlDnM,KAAKmM,OAAO60C,sBAAsB50C,YAE/DpM,KAAKqM,UAAUC,kBAAkB,6BAA8B00C,GAAuBz0C,KAAK,SAAUy0C,GAC7FA,EAAsBl1C,QAG1BP,EAAMzI,OAAO,UAAYxB,KAAM,kBAAmBE,OAASmF,KAAMA,EAAKiM,cAAepR,MAAOA,WAG/F,CAED,GADAxB,KAAKyM,QAAQ,wBAAyBu0C,GAClCA,EAAsBl1C,OACtB,MAEJ9L,MAAK8C,OAAO,UAAYxB,KAAM,kBAAmBE,OAASmF,KAAMA,EAAKiM,cAAepR,MAAOA,OAWnGq4C,EAAYh5C,UAAUqgD,sBAAwB,SAAUj9C,GACpD,GAAId,IAAUhD,OAAQ,EAAGC,OAAQ,EAAG2H,KAAM,EAAGC,KAAM,EAAG3H,MAAO,EAAGC,OAAQ,EACxE,IAAI2D,EAAIgD,UAAU9B,OAAS,EAAG,CAC1BhC,GAAUhD,OAAQ8D,EAAIgD,UAAU,GAAGzG,EAAGJ,OAAQ6D,EAAIgD,UAAU,GAAGxG,EAAGsH,KAAM9D,EAAIgD,UAAU,GAAGzG,EAAGwH,KAAM/D,EAAIgD,UAAU,GAAGxG,EACnH,KAAK,GAAIuE,GAAI,EAAGA,EAAIf,EAAIgD,UAAU9B,OAAQH,IAClCf,EAAIgD,UAAUjC,GAAGxE,EAAI2C,EAAMhD,SAC3BgD,EAAMhD,OAAS8D,EAAIgD,UAAUjC,GAAGxE,GAEhCyD,EAAIgD,UAAUjC,GAAGvE,EAAI0C,EAAM/C,SAC3B+C,EAAM/C,OAAS6D,EAAIgD,UAAUjC,GAAGvE,GAEhCwD,EAAIgD,UAAUjC,GAAGxE,EAAI2C,EAAM4E,OAC3B5E,EAAM4E,KAAO9D,EAAIgD,UAAUjC,GAAGxE,GAE9ByD,EAAIgD,UAAUjC,GAAGvE,EAAI0C,EAAM6E,OAC3B7E,EAAM6E,KAAO/D,EAAIgD,UAAUjC,GAAGvE,EAGtC0C,GAAM9C,MAAQ8C,EAAM4E,KAAO5E,EAAMhD,OACjCgD,EAAM7C,OAAS6C,EAAM6E,KAAO7E,EAAM/C,OAEtC,MAAO+C,IAUX02C,EAAYh5C,UAAU8e,iBAAmB,SAAUhZ,GAG/C,OAF4Bw6C,WAAc,SAAUC,WAAc,SAAUC,WAAc,SACtFC,UAAW,MAAOC,UAAW,MAAOC,UAAW,MAAOC,UAAW,MAAOC,WAAY,QAC7D,GAAK/6C,IAQpCkzC,EAAYh5C,UAAUmhB,aAAe,SAAUtO,GAC3CA,EAAIvP,UAAU,EAAG,EAAGuP,EAAIrO,OAAOhF,MAAOqT,EAAIrO,OAAO/E,QACjDoT,EAAIvP,UAAU,EAAG,EAAGuP,EAAIrO,OAAO/E,OAAQoT,EAAIrO,OAAOhF,QAUtDw5C,EAAYh5C,UAAU8gD,YAAc,SAAUh7C,EAAMqW,GAChDhd,KAAK8C,OAAO,SAAWxB,KAAM,sBAC7B,IAAIwL,GAAc9I,YAAWhE,KAAKgG,YAAa,GAC3CF,GAAWC,WACf/F,MAAK8C,OAAO,UAAYxB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAASsE,OAAQA,IACzF,IAAIiH,GAAUjH,EAAgB,OAC9BiH,GAAQ7H,QAAUlB,YAAWhE,KAAKkF,YAAa,GAC/C6H,EAAQ9F,UAAYjD,YAAWhE,KAAKiH,cAAe,GACnD8F,EAAQlH,iBAAmB7B,YAAWhE,KAAK6F,qBAAsB,GACjE7F,KAAKkF,QAAQwB,MACA,eAATC,EACA3G,KAAK4C,UAAU2T,MAAQvW,KAAK8+C,cAAc9hC,GAE5B,aAATrW,IACL3G,KAAK4C,UAAU4T,IAAMxW,KAAK8+C,cAAc9hC,IAE5Chd,KAAK8C,OAAO,SAAWxB,KAAM,oBAAqBE,OAASuR,eAAgB,KAAMhE,YAAa,KAAMC,UAAW,KACvGC,YAAajP,KAAK4C,UAAUmQ,eAAe9D,eACnDjP,KAAKkF,QAAQe,KAAKjG,KAAK4C,WACvB5C,KAAK8C,OAAO,aAAexB,KAAM,qBAAsByB,kBAAkB,EACrEvB,OAAS6L,UAAW,iBAAkBC,YAAaP,EAASQ,gBAAiBR,EAAQ7H,QACjFsI,kBAAmBT,EAAQ9F,UAAWyG,gBAAiBZ,EAAaa,aAAc,KAClFC,YAAa,KAAMC,eAAgB,KAAMrI,aAAc,QAC/DxF,KAAK8C,OAAO,aAAexB,KAAM,cAAeE,OAASyC,IAAKjE,KAAKkF,QAAQlF,KAAKkF,QAAQC,OAAS,MAC5F+G,eACG+P,UAAQC,SACJa,SAAS0F,eAAeziB,KAAK+N,QAAQiP,GAAK,mBAE1BkG,eAAaljB,KAAK+N,QAAQiP,GAAK,iBAAkB,WACvD+3B,kBAIVh4B,SAAS0F,eAAeziB,KAAK+N,QAAQiP,GAAK,aAE1BkG,eAAaljB,KAAK+N,QAAQiP,GAAK,WAAY,WACjD+3B,oBAY1B8E,EAAYh5C,UAAU+gD,iBAAmB,SAAU5kC,GAC/Chd,KAAK8C,OAAO,aAAexB,KAAM,qBAAsBE,OAAS4E,MAAM,KACtEpG,KAAK8C,OAAO,SAAWxB,KAAM,sBAC7B,IAAI4D,GAAUlB,YAAWhE,KAAKkF,YAAa,GACvC4H,EAAc9I,YAAWhE,KAAKgG,YAAa,GAC3CF,GAAWC,WACf/F,MAAK8C,OAAO,UAAYxB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAASsE,OAAQA,IACzF,IAAIiH,GAAUjH,EAAgB,OAC9BiH,GAAQ7H,QAAUlB,YAAWhE,KAAKkF,YAAa,GAC/C6H,EAAQ9F,UAAYjD,YAAWhE,KAAKiH,cAAe,GACnD8F,EAAQlH,iBAAmB7B,YAAWhE,KAAK6F,qBAAsB,EACjE,IAAIuZ,IAAoBhW,aAAc,KAKtC,IAJApJ,KAAK8C,OAAO,iBAAmBxB,KAAM,kBAAmByB,kBAAkB,EACtEvB,OAASyC,IAAKmb,KAClBrS,EAAQ3D,aAAepF,YAAWob,EAA8B,iBAAO,GACvEpf,KAAKkF,QAAQwB,MACuB,UAAhC1G,KAAK8c,SAASjB,MAAMG,QAAqB,CACzChc,KAAK8C,OAAO,SAAWxB,KAAM,kBAAmByB,kBAAkB,EAC9DvB,OAASyC,IAAKjE,KAAK4C,UAAW44B,YAAY,IAC9C,IAAI92B,GAAO1E,KAAK4C,UAAUyF,aAAa+G,UACvCpP,MAAK4C,UAAUyF,aAAa+G,WAAapP,KAAK8G,aAAakW,GAC3Dhd,KAAK8C,OAAO,SAAWxB,KAAM,gBAC7BtB,KAAKkF,QAAQe,KAAKjG,KAAK4C,WACvB5C,KAAK8C,OAAO,aAAexB,KAAM,qBAAsByB,kBAAkB,EACrEvB,OAAS6L,UAAW,wBAAyBC,YAAaP,EAASQ,gBAAiBR,EAAQ7H,QACxFsI,kBAAmBT,EAAQ9F,UAAWwG,qBAAsBV,EAAQ3D,aACpEsE,gBAAiBZ,EAAaa,aAAc,KAC5CC,YAAa,KAAMC,eAAgB,KAAMrI,aAAc,QAC/DxF,KAAKkF,QAAQwB,MACb1G,KAAKwC,aAAa2B,UAAU,EAAG,EAAGnE,KAAKuC,YAAYlC,MAAOL,KAAKuC,YAAYjC,OAC3E,IAAID,GAAQL,KAAK4C,UAAUC,YAAYxC,MACI,IAAvCL,KAAK4C,UAAUyF,aAAaE,QAChCvI,MAAK8c,SAASjB,MAAMxb,MAAQA,EAAQ,KACpCL,KAAK8c,SAASjB,MAAMzM,WAAapP,KAAK8G,aAAakW,GACnDhd,KAAK4C,UAAUyF,aAAa+G,WAAa1K,EACzC1E,KAAK8C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,EAC/DvB,OAASgsC,UAAW,YAEvB,CACDxtC,KAAK8C,OAAO,SAAWxB,KAAM,kBAAmByB,kBAAkB,EAC9DvB,OAASyC,IAAKjE,KAAK4C,UAAW44B,WAAY,OAC9C,IAAIpsB,GAAapP,KAAK4C,UAAUyF,aAAa+G,WAAapP,KAAK8G,aAAakW,EAC5Ehd,MAAK8C,OAAO,SAAWxB,KAAM,kBAAmByB,kBAAkB,EAC9DvB,OAAS6G,aAAc,KAAM+G,WAAYA,EAAY7G,SAAU,QACnEvI,KAAK8C,OAAO,SAAWxB,KAAM,gBAC7BtB,KAAKkF,QAAQe,KAAKjG,KAAK4C,WACvB5C,KAAK8C,OAAO,aAAexB,KAAM,qBAAsByB,kBAAkB,EACrEvB,OAAS6L,UAAW,iBAAkBC,YAAaP,EAASQ,gBAAiBrI,EACzEsI,kBAAmBxJ,YAAWhE,KAAKiH,cAAe,GAClDwG,qBAAsBV,EAAQ3D,aAAcsE,gBAAiBZ,EAAaa,aAAc,KACxFC,YAAa,KAAMC,eAAgB,KAAMrI,aAAc,QAC/DxF,KAAK8C,OAAO,aAAexB,KAAM,cAAeE,OAASyC,IAAKjE,KAAKkF,QAAQlF,KAAKkF,QAAQC,OAAS,QAUzG00C,EAAYh5C,UAAUqnC,eAAiB,SAAU/4B,GAC7C,GAAI0yC,GAAW1yC,CACfnP,MAAK8C,OAAO,aAAexB,KAAM,qBAAsBE,OAAS4E,MAAM,KACtEpG,KAAK8C,OAAO,SAAWxB,KAAM,sBAC7B,IAAIwL,GAAc9I,YAAWhE,KAAKgG,YAAa,GAC3CF,GAAWC,WACf/F,MAAK8C,OAAO,UAAYxB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAASsE,OAAQA,IACzF,IAAIiH,GAAUjH,EAAgB,OAC9BiH,GAAQ7H,QAAUlB,YAAWhE,KAAKkF,YAAa,GAC/C6H,EAAQ9F,UAAYjD,YAAWhE,KAAKiH,cAAe,GACnD8F,EAAQlH,iBAAmB7B,YAAWhE,KAAK6F,qBAAsB,EACjE,IAAIuZ,IAAoBhW,aAAc,KAKtC,IAJApJ,KAAK8C,OAAO,iBAAmBxB,KAAM,kBAAmByB,kBAAkB,EACtEvB,OAASyC,IAAKmb,KAClBrS,EAAQ3D,aAAepF,YAAWob,EAA8B,iBAAO,GACvEpf,KAAKkF,QAAQwB,MACuB,UAAhC1G,KAAK8c,SAASjB,MAAMG,QAAqB,CACzChc,KAAK8C,OAAO,SAAWxB,KAAM,kBAAmByB,kBAAkB,EAC9DvB,OAASyC,IAAKjE,KAAK4C,UAAW44B,YAAY,IAC9C,IAAI92B,GAAO1E,KAAK4C,UAAUyF,aAAaE,QACvCvI,MAAK4C,UAAUyF,aAAaE,SAAWklB,SAASztB,KAAKg6C,aAAcvsB,SAASo0B,EAAU,IAAM,GAAI1yC,KAAM,IACtGnP,KAAKkF,QAAQe,KAAKjG,KAAK4C,WACvB5C,KAAK8C,OAAO,aAAexB,KAAM,qBAAsByB,kBAAkB,EACrEvB,OAAS6L,UAAW,wBAAyBC,YAAaP,EAASQ,gBAAiBR,EAAQ7H,QACxFsI,kBAAmBT,EAAQ9F,UAAWwG,qBAAsBV,EAAQ3D,aACpEsE,gBAAiBZ,EAAaa,aAAc,KAC5CC,YAAa,KAAMC,eAAgB,KAAMrI,aAAc,QAC/DxF,KAAKkF,QAAQwB,KACb,IAAI8T,GAAY,EACuB,UAAnCxa,KAAK8c,SAASjB,MAAMipB,aACpBtqB,EAAY,SAEsB,WAAlCxa,KAAK8c,SAASjB,MAAMkpB,YACpBvqB,EAAY,WAEuB,SAAnCxa,KAAK8c,SAASjB,MAAMipB,YAA2D,WAAlC9kC,KAAK8c,SAASjB,MAAMkpB,YACjEvqB,EAAY,gBAEhBxa,KAAKwC,aAAaiY,KAAOD,EAAYxa,KAAK4C,UAAUyF,aAAaE,SAAW,MAAavI,KAAK8c,SAASjB,MAAMzM,UAC7G,IAAIiL,GAAOra,KAAK8c,SAAStb,MAAMmL,MAAM,MACjC1I,GAAQgrC,QAAS,GACrBjvC,MAAK8C,OAAO,SAAWxB,KAAM,aAAcyB,kBAAkB,EACzDvB,OAASgsC,WAAW,EAAMr+B,KAAM,KAAMlL,IAAKA,IAC/C,IAAI69C,GAAS79C,EAAa,QACtB5D,EAAQL,KAAKwC,aAAayoC,YAAY6W,GAAQzhD,MACP,GAAvCL,KAAK4C,UAAUyF,aAAaE,QAChCvI,MAAK8c,SAASjB,MAAMxb,MAAQA,EAAQ,KACpCL,KAAK8c,SAASjB,MAAMvb,OAAS+Z,EAAKlV,QAAUnF,KAAK4C,UAAUyF,aAAaE,SAAkD,IAAvCvI,KAAK4C,UAAUyF,aAAaE,UAAmB,KAClIvI,KAAK4C,UAAUyF,aAAaE,SAAW7D,EACvC1E,KAAKwC,aAAaiY,KAAOza,KAAK4C,UAAUyF,aAAaE,SAAW,MAAavI,KAAK4C,UAAUyF,aAAa+G,WACzGpP,KAAK8c,SAASjB,MAAMtT,SAAWklB,SAASztB,KAAKg6C,aAAcvsB,SAASo0B,EAAU,IAAM,GAAI1yC,KAAM,IAAM,KAC7D,YAAnCnP,KAAK8c,SAASjB,MAAMzM,aACpBpP,KAAK8c,SAASjB,MAAMxb,MAAQsnB,WAAW3nB,KAAK8c,SAASjB,MAAMxb,OAASsnB,WAAW3nB,KAAK8c,SAASjB,MAAMtT,UAAY,UAGlH,CACDvI,KAAK8C,OAAO,SAAWxB,KAAM,kBAAmByB,kBAAkB,EAC9DvB,OAASyC,IAAKjE,KAAK4C,UAAW44B,WAAY,OAC9C,IAAIjzB,GAAWvI,KAAK4C,UAAUyF,aAAaE,SAAWklB,SAASztB,KAAKg6C,aAAcvsB,SAASo0B,EAAU,IAAM,GAAI1yC,KAAM,GACrHnP,MAAK8C,OAAO,SAAWxB,KAAM,kBAAmByB,kBAAkB,EAC9DvB,OAAS6G,aAAc,KAAM+G,WAAY,KAAM7G,SAAUA,KAC7DvI,KAAKwC,aAAaiY,KAAOza,KAAK4C,UAAUyF,aAAaE,SAAW,MAAavI,KAAK4C,UAAUyF,aAAa+G,UACzG,IAAIiL,GAAOra,KAAK4C,UAAUuQ,WAAWxG,MAAM,MACvC1I,GAAQgrC,QAAS,GACrBjvC,MAAK8C,OAAO,SAAWxB,KAAM,aAAcyB,kBAAkB,EACzDvB,OAASgsC,UAAW,KAAMr+B,KAAM,KAAMlL,IAAKA,IAC/C,IAAI89C,GAAS99C,EAAa,QACtB5D,EAAQL,KAAKwC,aAAayoC,YAAY8W,GAAQ1hD,MACP,GAAvCL,KAAK4C,UAAUyF,aAAaE,SAC5BjI,EAAS+Z,EAAKlV,QAAUnF,KAAK4C,UAAUyF,aAAaE,SACb,IAAvCvI,KAAK4C,UAAUyF,aAAaE,SAChCvI,MAAK8C,OAAO,aAAexB,KAAM,mBAAoByB,kBAAkB,EACnEvB,OAASnB,MAAOA,EAAOC,OAAQA,KACnCN,KAAK8C,OAAO,QAAUxB,KAAM,qBAAsByB,kBAAkB,EAAOvB,OAASmB,SAAU3C,KAAK4C,UAAUC,YAAaoB,IAAKjE,KAAK4C,UAC5H4R,YAAa,KAAMhU,EAAG,KAAMC,EAAG,QACvCT,KAAK8C,OAAO,SAAWxB,KAAM,gBAC7BtB,KAAKkF,QAAQe,KAAKjG,KAAK4C,WACvB5C,KAAK8C,OAAO,aAAexB,KAAM,qBAAsByB,kBAAkB,EACrEvB,OAAS6L,UAAW,iBAAkBC,YAAaP,EAASQ,gBAAiBR,EAAQ7H,QACjFsI,kBAAmBT,EAAQ9F,UAAWwG,qBAAsBV,EAAQ3D,aACpEsE,gBAAiBZ,EAAaa,aAAc,KAC5CC,YAAa,KAAMC,eAAgB,KAAMrI,aAAc,QAC/DxF,KAAK8C,OAAO,aAAexB,KAAM,cAAeE,OAASyC,IAAKjE,KAAKkF,QAAQlF,KAAKkF,QAAQC,OAAS,QAUzG00C,EAAYh5C,UAAUmhD,gBAAkB,SAAUxgD,GAC9CxB,KAAK8C,OAAO,aAAexB,KAAM,qBAAsBE,OAAS4E,MAAM,KACtEpG,KAAK8C,OAAO,SAAWxB,KAAM,sBAC7B,IAAIwL,GAAc9I,YAAWhE,KAAKgG,YAAa,GAC3CF,GAAWC,WACf/F,MAAK8C,OAAO,UAAYxB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAASsE,OAAQA,IACzF,IAAIiH,GAAUjH,EAAgB,OAC9BiH,GAAQ7H,QAAUlB,YAAWhE,KAAKkF,YAAa,GAC/C6H,EAAQ9F,UAAYjD,YAAWhE,KAAKiH,cAAe,GACnD8F,EAAQlH,iBAAmB7B,YAAWhE,KAAK6F,qBAAsB,EACjE,IAAIuZ,IAAoBhW,aAAc,KAKtC,IAJApJ,KAAK8C,OAAO,iBAAmBxB,KAAM,kBAAmByB,kBAAkB,EACtEvB,OAASyC,IAAKmb,KAClBrS,EAAQ3D,aAAepF,YAAWob,EAA8B,iBAAO,GACvEpf,KAAKkF,QAAQwB,MACuB,SAAhC1G,KAAK8c,SAASjB,MAAMG,QACpBhc,KAAK4C,UAAUmQ,eAAehE,YAAcvN,EAC5CxB,KAAK8C,OAAO,SAAWxB,KAAM,oBAAqBE,OAASuR,eAAgB,KACnEhE,YAAa/O,KAAK4C,UAAUmQ,eAAehE,YAAaC,UAAW,KAAMC,YAAa,QACzFjP,KAAKqe,YACNre,KAAKkF,QAAQe,KAAKjG,KAAK4C,WACvB5C,KAAK8C,OAAO,aAAexB,KAAM,qBAAsByB,kBAAkB,EACrEvB,OAAS6L,UAAW,iBAAkBC,YAAaP,EAASQ,gBAAiBR,EAAQ7H,QACjFsI,kBAAmBT,EAAQ9F,UAAWwG,qBAAsBV,EAAQ3D,aACpEsE,gBAAiBZ,EAAaa,aAAc,KAC5CC,YAAa,KAAMC,eAAgB,KAAMrI,aAAc,QAC/DxF,KAAK8C,OAAO,aAAexB,KAAM,cAAeE,OAASyC,IAAKjE,KAAKkF,QAAQlF,KAAKkF,QAAQC,OAAS,WAGpG,IAAoC,UAAhCnF,KAAK8c,SAASjB,MAAMG,QAAqB,CAC9Chc,KAAK8c,SAASjB,MAAMsX,MAAQ3xB,CAC5B,IAAIkD,GAAO1E,KAAK4C,UAAUmQ,eAAehE,WACzC/O,MAAK4C,UAAUmQ,eAAehE,YAAcvN,EAC5CxB,KAAKkF,QAAQe,KAAKjG,KAAK4C,WACvB5C,KAAK8C,OAAO,aAAexB,KAAM,qBAAsByB,kBAAkB,EACrEvB,OAAS6L,UAAW,wBAAyBC,YAAaP,EAASQ,gBAAiBR,EAAQ7H,QACxFsI,kBAAmBT,EAAQ9F,UAAWwG,qBAAsBV,EAAQ3D,aACpEsE,gBAAiBZ,EAAaa,aAAc,KAC5CC,YAAa,KAAMC,eAAgB,KAAMrI,aAAc,QAC/DxF,KAAKkF,QAAQwB,MACb1G,KAAK4C,UAAUmQ,eAAehE,YAAcrK,MAEtC1E,MAAKqe,YACXre,KAAKkF,QAAQe,KAAKjG,KAAK4C,WACvB5C,KAAK8C,OAAO,aAAexB,KAAM,qBAAsByB,kBAAkB,EACrEvB,OAAS6L,UAAW,iBAAkBC,YAAaP,EAASQ,gBAAiBR,EAAQ7H,QACjFsI,kBAAmBT,EAAQ9F,UAAWwG,qBAAsBV,EAAQ3D,aACpEsE,gBAAiBZ,EAAaa,aAAc,KAC5CC,YAAa,KAAMC,eAAgB,KAAMrI,aAAc,QAC/DxF,KAAK8C,OAAO,aAAexB,KAAM,cAAeE,OAASyC,IAAKjE,KAAKkF,QAAQlF,KAAKkF,QAAQC,OAAS,QAUzG00C,EAAYh5C,UAAUohD,qBAAuB,SAAUjlC,GAEnD,GAAItY,GAAOV,YAAWhE,KAAKiH,cAAe,EAC1CjH,MAAKqlC,+BACL,IAAIv4B,GAAc9I,YAAWhE,KAAKgG,YAAa,GAC3CF,GAAWC,WACf/F,MAAK8C,OAAO,UAAYxB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAASsE,OAAQA,IACzF,IAAIiH,GAAUjH,EAAgB,OAC9BiH,GAAQ7H,QAAUlB,YAAWhE,KAAKkF,YAAa,GAC/C6H,EAAQ9F,UAAYjD,YAAWhE,KAAKiH,cAAe,GACnD8F,EAAQlH,iBAAmB7B,YAAWhE,KAAK6F,qBAAsB,EACjE,IAAIuZ,IAAoBhW,aAAc,KACtCpJ,MAAK8C,OAAO,iBAAmBxB,KAAM,kBAAmByB,kBAAkB,EACtEvB,OAASyC,IAAKmb,KAClBrS,EAAQ3D,aAAepF,YAAWob,EAA8B,iBAAO,GACvEpf,KAAKiH,UAAYvC,EACjB1E,KAAK8C,OAAO,aAAexB,KAAM,4BAA6BE,OAASod,0BAA0B,KACjG5e,KAAKggD,aAAahjC,EAClB,IAAI/Y,IAAQmC,MAAM,EAElB,IADApG,KAAK8C,OAAO,aAAexB,KAAM,yBAA0ByB,kBAAkB,EAAOvB,OAASyC,IAAKA,KAC9FA,EAAU,KAAG,CACb,GAAIwZ,IAAUiR,eAAgB,KAC9B1uB,MAAK8C,OAAO,iBAAmBxB,KAAM,oBAAqByB,kBAAkB,EAAOvB,OAASyC,IAAKwZ,KACjGzd,KAAKwC,aAAa2B,UAAU,EAAG,EAAGnE,KAAKuC,YAAYlC,MAAOL,KAAKuC,YAAYjC,QAC3EN,KAAK8C,OAAO,iBAAmBxB,KAAM,WAAYyB,kBAAkB,EAC/DvB,OAASuN,YAAa,KAAME,YAAawO,EAAsB,iBACnE,IAAIoiB,IAAaC,sBAAuB,KACxC9/B,MAAK8C,OAAO,iBAAmBxB,KAAM,2BAA4ByB,kBAAkB,EAAOvB,OAASyC,IAAK47B,KACxG7/B,KAAKiH,UAAU44B,EAAgC,uBAAG5wB,YAAcwO,EAAsB,eACtFzd,KAAK8C,OAAO,aAAexB,KAAM,qBAAsByB,kBAAkB,EACrEvB,OAAS6L,UAAW,yBAA0BC,YAAaP,EAASQ,gBAAiBR,EAAQ7H,QACzFsI,kBAAmBT,EAAQ9F,UAAWwG,qBAAsBV,EAAQ3D,aACpEsE,gBAAiBZ,EAAaa,aAAc,KAC5CC,YAAa,KAAMC,eAAgB,KAAMrI,aAAc,UAUvEq0C,EAAYh5C,UAAUqhD,qBAAuB,SAAU1gD,GAEnD,GAAIkD,GAAOV,YAAWhE,KAAKiH,cAAe,EAC1CjH,MAAKqlC,+BACL,IAAIv4B,GAAc9I,YAAWhE,KAAKgG,YAAa,GAC3CF,GAAWC,WACf/F,MAAK8C,OAAO,UAAYxB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAASsE,OAAQA,IACzF,IAAIiH,GAAUjH,EAAgB,OAC9BiH,GAAQ7H,QAAUlB,YAAWhE,KAAKkF,YAAa,GAC/C6H,EAAQ9F,UAAYjD,YAAWhE,KAAKiH,cAAe,GACnD8F,EAAQlH,iBAAmB7B,YAAWhE,KAAK6F,qBAAsB,EACjE,IAAIuZ,IAAoBhW,aAAc,KACtCpJ,MAAK8C,OAAO,iBAAmBxB,KAAM,kBAAmByB,kBAAkB,EACtEvB,OAASyC,IAAKmb,KAClBrS,EAAQ3D,aAAepF,YAAWob,EAA8B,iBAAO,GACvEpf,KAAKiH,UAAYvC,EACjB1E,KAAK8C,OAAO,aAAexB,KAAM,4BAA6BE,OAASod,0BAA0B,KACjG5e,KAAK4C,UAAUmQ,eAAehE,YAAcvN,CAC5C,IAAIyC,IAAQmC,MAAM,EAElB,IADApG,KAAK8C,OAAO,aAAexB,KAAM,yBAA0ByB,kBAAkB,EAAOvB,OAASyC,IAAKA,KAC9FA,EAAU,KAAG,CACb,GAAI47B,IAAaC,sBAAuB,KACxC9/B,MAAK8C,OAAO,iBAAmBxB,KAAM,2BAA4ByB,kBAAkB,EAAOvB,OAASyC,IAAK47B,KACxG7/B,KAAKwC,aAAa2B,UAAU,EAAG,EAAGnE,KAAKuC,YAAYlC,MAAOL,KAAKuC,YAAYjC,QAC3EN,KAAKiH,UAAU44B,EAAgC,uBAAG9wB,YAAcvN,EAChExB,KAAK8C,OAAO,iBAAmBxB,KAAM,WAAYyB,kBAAkB,EAC/DvB,OAASuN,YAAavN,KAC1BxB,KAAK8C,OAAO,aAAexB,KAAM,qBAAsByB,kBAAkB,EACrEvB,OAAS6L,UAAW,yBAA0BC,YAAaP,EAASQ,gBAAiBR,EAAQ7H,QACzFsI,kBAAmBT,EAAQ9F,UAAWwG,qBAAsBV,EAAQ3D,aACpEsE,gBAAiBZ,EAAaa,aAAc,KAC5CC,YAAa,KAAMC,eAAgB,KAAMrI,aAAc,YAEzDxF,MAAKqe,WACXre,KAAK8C,OAAO,aAAexB,KAAM,cAAeE,OAASyC,IAAKjE,KAAK4C,cAU3Ei3C,EAAYh5C,UAAUshD,kBAAoB,SAAUnlC,GAChDhd,KAAK8C,OAAO,SAAWxB,KAAM,sBAC7B,IAAIwL,GAAc9I,YAAWhE,KAAKgG,YAAa,GAC3CF,GAAWC,WACf/F,MAAK8C,OAAO,UAAYxB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAASsE,OAAQA,IACzF,IAAIiH,GAAUjH,EAAgB,OAC9BiH,GAAQ7H,QAAUlB,YAAWhE,KAAKkF,YAAa,GAC/C6H,EAAQ9F,UAAYjD,YAAWhE,KAAKiH,cAAe,GACnD8F,EAAQlH,iBAAmB7B,YAAWhE,KAAK6F,qBAAsB,EACjE,IAAIuZ,IAAoBhW,aAAc,KACtCpJ,MAAK8C,OAAO,iBAAmBxB,KAAM,kBAAmByB,kBAAkB,EACtEvB,OAASyC,IAAKmb,KAClBrS,EAAQ3D,aAAepF,YAAWob,EAA8B,iBAAO,GACvEpf,KAAKkF,QAAQwB,MACb1G,KAAK4C,UAAUmQ,eAAe9D,YAAcwe,SAASzQ,EAAI,IACzDhd,KAAK4C,UAAUmQ,eAAe9D,aAAe,EAC7CjP,KAAK8C,OAAO,SAAWxB,KAAM,oBAAqBE,OAASuR,eAAgB,KAAMhE,YAAa,KAAMC,UAAW,KACvGC,YAAajP,KAAK4C,UAAUmQ,eAAe9D,eACnDjP,KAAKkF,QAAQe,KAAKjG,KAAK4C,WACvB5C,KAAK8C,OAAO,aAAexB,KAAM,qBAAsByB,kBAAkB,EACrEvB,OAAS6L,UAAW,iBAAkBC,YAAaP,EAASQ,gBAAiBR,EAAQ7H,QACjFsI,kBAAmBT,EAAQ9F,UAAWwG,qBAAsBV,EAAQ3D,aACpEsE,gBAAiBZ,EAAaa,aAAc,KAC5CC,YAAa,KAAMC,eAAgB,KAAMrI,aAAc,QAC/DxF,KAAK8C,OAAO,aAAexB,KAAM,cAAeE,OAASyC,IAAKjE,KAAKkF,QAAQlF,KAAKkF,QAAQC,OAAS,OASrG00C,EAAYh5C,UAAUuhD,kBAAoB,SAAU5gD,GAChDxB,KAAK8C,OAAO,SAAWxB,KAAM,sBAC7B,IAAIwL,GAAc9I,YAAWhE,KAAKgG,YAAa,GAC3CF,GAAWC,WACf/F,MAAK8C,OAAO,UAAYxB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAASsE,OAAQA,IACzF,IAAIiH,GAAUjH,EAAgB,OAC9BiH,GAAQ7H,QAAUlB,YAAWhE,KAAKkF,YAAa,GAC/C6H,EAAQ9F,UAAYjD,YAAWhE,KAAKiH,cAAe,GACnD8F,EAAQlH,iBAAmB7B,YAAWhE,KAAK6F,qBAAsB,EACjE,IAAIuZ,IAAoBhW,aAAc,KACtCpJ,MAAK8C,OAAO,iBAAmBxB,KAAM,kBAAmByB,kBAAkB,EACtEvB,OAASyC,IAAKmb,KAClBrS,EAAQ3D,aAAepF,YAAWob,EAA8B,iBAAO,GACvEpf,KAAKkF,QAAQwB,MACb1G,KAAK4C,UAAUmQ,eAAehE,YAAcvN,EAC5CxB,KAAK8C,OAAO,SAAWxB,KAAM,oBAAqBE,OAASuR,eAAgB,KAAMhE,YAAa/O,KAAK4C,UAAUmQ,eAAehE,YAAaC,UAAW,KAAMC,YAAa,QAClKjP,KAAKqe,YACNre,KAAKkF,QAAQe,KAAKjG,KAAK4C,WACvB5C,KAAK8C,OAAO,aAAexB,KAAM,qBAAsByB,kBAAkB,EACrEvB,OAAS6L,UAAW,iBAAkBC,YAAaP,EAASQ,gBAAiBR,EAAQ7H,QACjFsI,kBAAmBT,EAAQ9F,UAAWwG,qBAAsBV,EAAQ3D,aACpEsE,gBAAiBZ,EAAaa,aAAc,KAC5CC,YAAa,KAAMC,eAAgB,KAAMrI,aAAc,QAC/DxF,KAAK8C,OAAO,aAAexB,KAAM,cAAeE,OAASyC,IAAKjE,KAAKkF,QAAQlF,KAAKkF,QAAQC,OAAS,QAUzG00C,EAAYh5C,UAAUwhD,gBAAkB,SAAU7gD,GAC9CxB,KAAK8C,OAAO,SAAWxB,KAAM,sBAC7B,IAAIwL,GAAc9I,YAAWhE,KAAKgG,YAAa,GAC3CF,GAAWC,WACf/F,MAAK8C,OAAO,UAAYxB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAASsE,OAAQA,IACzF,IAAIiH,GAAUjH,EAAgB,OAC9BiH,GAAQ7H,QAAUlB,YAAWhE,KAAKkF,YAAa,GAC/C6H,EAAQ9F,UAAYjD,YAAWhE,KAAKiH,cAAe,GACnD8F,EAAQlH,iBAAmB7B,YAAWhE,KAAK6F,qBAAsB,EACjE,IAAIuZ,IAAoBhW,aAAc,KACtCpJ,MAAK8C,OAAO,iBAAmBxB,KAAM,kBAAmByB,kBAAkB,EACtEvB,OAASyC,IAAKmb,KAClBrS,EAAQ3D,aAAepF,YAAWob,EAA8B,iBAAO,GACvEpf,KAAKkF,QAAQwB,MACb1G,KAAK4C,UAAUmQ,eAAe/D,UAAYxN,EAC1CxB,KAAK8C,OAAO,SAAWxB,KAAM,oBACzBE,OAASuR,eAAgB,KAAMhE,YAAa,KAAMC,UAAWhP,KAAK4C,UAAUmQ,eAAe/D,UACvFC,YAAa,QACrBjP,KAAKkF,QAAQe,KAAKjG,KAAK4C,WACvB5C,KAAK8C,OAAO,aAAexB,KAAM,qBAAsByB,kBAAkB,EACrEvB,OAAS6L,UAAW,iBAAkBC,YAAaP,EAASQ,gBAAiBR,EAAQ7H,QACjFsI,kBAAmBT,EAAQ9F,UAAWwG,qBAAsBV,EAAQ3D,aACpEsE,gBAAiBZ,EAAaa,aAAc,KAC5CC,YAAa,KAAMC,eAAgB,KAAMrI,aAAc,QAC/DxF,KAAK8C,OAAO,aAAexB,KAAM,cAAeE,OAASyC,IAAKjE,KAAKkF,QAAQlF,KAAKkF,QAAQC,OAAS,OASrG00C,EAAYh5C,UAAUyhD,mBAAqB,SAAUpC,GAEjD,GAAIqC,IADJrC,EAAMA,EAAIE,OAAO,GAAGC,cAAgBH,EAAIx7B,MAAM,IAC3B89B,MAAM,eACzB,OAAIvgD,qBAAkBsgD,GACXrC,EAGAqC,EAASE,IAAI,SAAUC,GAAQ,MAAOA,GAAKtC,OAAO,GAAGC,cAAgBqC,EAAKh+B,MAAM,KAAOkD,KAAK,MAU3GiyB,EAAYh5C,UAAU8hD,uBAAyB,SAAUh8C,GACrD,GAAI1C,IAAQ0Z,gBAAiB,KAO7B,OANA3d,MAAK8C,OAAO,UAAYxB,KAAM,qBAAsByB,kBAAkB,EAClEvB,OAASyC,IAAKA,MACYqlB,WAAcrlB,EAAqB,gBAAEqlB,WAC/DC,SAAYtlB,EAAqB,gBAAEslB,SAAUC,IAAOvlB,EAAqB,gBAAEulB,IAC3EC,WAAcxlB,EAAqB,gBAAEwlB,WAAY3N,QAAW7X,EAAqB,gBAAE6X,QACnF4N,KAAQzlB,EAAqB,gBAAEylB,KAAMC,SAAY1lB,EAAqB,gBAAE0lB,UAC/C,GAAKhjB,IAStCkzC,EAAYh5C,UAAU+hD,gBAAkB,SAAUj8C,GAC9C3G,KAAK2L,eAAgB,EACrB3L,KAAKigD,qBACL,IAAIr9C,GAAYoB,YAAWhE,KAAK4C,cAAe,EAC/C5C,MAAK2gD,oBACL3gD,KAAK8C,OAAO,QAAUxB,KAAM,+BAC5BtB,KAAK8C,OAAO,aAAexB,KAAM,wBAAyBE,OAAS2N,KAAMxI,KACzE3G,KAAK8C,OAAO,QAAUxB,KAAM,uBAAwBE,OAASmF,KAAMA,EAAM/D,UAAWA,KACpF5C,KAAK2L,eAAgB,GAQzBkuC,EAAYh5C,UAAU2gB,iBAAmB,WACrC,MAAO,wHAaXq4B,EAAYh5C,UAAUgiD,sBAAwB,SAAU90C,EAAS+0C,GAE7D9iD,KAAK+N,QAAUA,CACf,IAAI6mC,GAAgB50C,KAAK+N,QAAQoO,cAAc,oBAC3Cnc,MAAK+N,QAAQoO,cAAc,IAAMnc,KAAK+N,QAAQiP,GAAK,gBACnDhd,KAAKqc,cAAgBrc,KAAK+N,QAAQoO,cAAc,IAAMnc,KAAK+N,QAAQiP,GAAK,gBAAgBvY,aAGxFzE,KAAKqc,cAAgB,EAEzBu4B,EAAc/4B,MAAMvb,OAAUN,KAAK+N,QAAQqO,aAAepc,KAAKqc,cAAgB,EAAK,KACpFu4B,EAAc/4B,MAAMxb,MAASL,KAAK+N,QAAQ8mC,YAAc,EAAK,KAC7D70C,KAAKoC,YAAcpC,KAAK+N,QAAQoO,cAAc,mBAC9Cnc,KAAKuC,YAAcvC,KAAK+N,QAAQoO,cAAc,mBAC9Cnc,KAAKoC,YAAY4a,GAAKhd,KAAK+N,QAAQiP,GAAK,eACxChd,KAAKuC,YAAYya,GAAKhd,KAAK+N,QAAQiP,GAAK,eACxChd,KAAK8c,SAAW9c,KAAK+N,QAAQoO,cAAc,cAC3Cnc,KAAKqiB,eAAiBriB,KAAK6nB,cAAc,UACrC7K,GAAIhd,KAAK+N,QAAQiP,GAAK,kBAAmB8K,OAAS9C,KAAM,iBAE5DhlB,KAAKuC,YAAYlC,MAAQL,KAAKoC,YAAY/B,MAAQL,KAAKqiB,eAAehiB,MAAQL,KAAK+N,QAAQ8mC,YAC3F70C,KAAKuC,YAAYjC,OAASN,KAAKoC,YAAY9B,OAASN,KAAKqiB,eAAe/hB,OAAUN,KAAK+N,QAAQqO,aAAepc,KAAKqc,cACnHrc,KAAKqC,aAAerC,KAAKoC,YAAYE,WAAW,MAChDtC,KAAK6E,QAAU7E,KAAK6nB,cAAc,OAC9B7K,GAAIhd,KAAK+N,QAAQiP,GAAK,UAAW8K,OAAS9C,KAAM,QAASi4B,YAAa,eAE1Ej9C,KAAKwC,aAAexC,KAAKuC,YAAYD,WAAW,MAChDtC,KAAKoiB,gBAAkBpiB,KAAKqiB,eAAe/f,WAAW,MAClDwgD,IACA9iD,KAAKqM,UAAYy2C,GAErB9iD,KAAK+iD,YACL/iD,KAAKu7C,YACLv7C,KAAKqC,aAAasC,OAAS3E,KAAKwhB,mBAChCxhB,KAAK8C,OAAO,UAAYxB,KAAM,qBAAsByB,kBAAkB,EAAOvB,OAAS6b,gBAAiBrd,KAAKqC,aAAasC,UACzH3E,KAAKod,aAAepd,KAAKsd,uBAAyBtd,KAAKqC,aAAasC,OAChE3E,KAAKk7C,UACLI,YAAUt7C,KAAK+N,SAAU/N,KAAKk7C,SAASE,QAAQ,OAAQ,KAAKC,OAAO1uC,MAAM,MAEzE3M,KAAK+N,SACLsuC,iBACI54B,OAAQzjB,KAAK+N,UAGrB/N,KAAKs8C,0BAETzC,EAAYh5C,UAAUkiD,UAAY,WAE9B/iD,KAAK+N,QAAQiP,GAAKhd,KAAK+N,QAAQiP,IAAMw9B,cAAY,oBAC7Cv+B,UAAQC,UACRlc,KAAK+N,QAAQkP,UAAUa,IAAI,YAE/B9d,KAAKy6C,uBAETZ,EAAYh5C,UAAUy7C,uBAAyB,WACvCr6C,oBAAkBjC,KAAKiN,aAAa6zB,eACpC9gC,KAAKiN,aAAa6zB,YAAeC,cAAYoC,WAAapC,cAAYC,MAAQD,cAAY2a,QAAU3a,cAAYgC,UAEhH9gC,oBAAkBjC,KAAKiW,kBAAkBlH,eACzC/O,KAAKiW,kBAAkBlH,YAAc/O,KAAK2V,UAAU3V,KAAK4V,OAAqB,cAE9E3T,oBAAkBjC,KAAKiW,kBAAkBjH,aACzChP,KAAKiW,kBAAkBjH,UAAYhP,KAAK2V,UAAU3V,KAAK4V,OAAuB,iBAGtFikC,EAAYh5C,UAAU45C,oBAAsB,WACxCz6C,KAAK2V,WACDqtC,YAAcC,aAAc,UAAWC,eAAgB,QACvDC,gBAAkBF,aAAc,UAAWC,eAAgB,QAC3DE,UAAYH,aAAc,UAAWC,eAAgB,QACrDG,cAAgBJ,aAAc,UAAWC,eAAgB,QACzDI,QAAUL,aAAc,UAAWC,eAAgB,QACnDK,YAAcN,aAAc,UAAWC,eAAgB,QACvDM,YAAcP,aAAc,UAAWC,eAAgB,QACvDO,WAAaR,aAAc,UAAWC,eAAgB,QACtDQ,eAAiBT,aAAc,UAAWC,eAAgB,QAC1DS,UAAYV,aAAc,UAAWC,eAAgB,QACrDU,cAAgBX,aAAc,UAAWC,eAAgB,QACzDW,QAAUZ,aAAc,UAAWC,eAAgB,QACnDY,YAAcb,aAAc,UAAWC,eAAgB,QACvDa,cAAgBd,aAAc,UAAWC,eAAgB,QACzDc,WAAaf,aAAc,UAAWC,eAAgB,QACtDe,eAAiBhB,aAAc,UAAWC,eAAgB,UAclErJ,EAAYh5C,UAAUiN,cAAgB,SAAUC,EAASpH,EAAMnF,IAE/D,IAAIy4C,EAgHJ,OA/GAlB,IACIU,WAAS,KACVI,EAAYh5C,UAAW,eAAY,IACtCk4C,GACIU,YAAS,IACVI,EAAYh5C,UAAW,eAAY,IACtCk4C,GACIU,WAAS,SACVI,EAAYh5C,UAAW,aAAU,IACpCk4C,GACIU,WAAS,eACVI,EAAYh5C,UAAW,YAAS,IACnCk4C,GACIU,cACDI,EAAYh5C,UAAW,cAAW,IACrCk4C,GACIU,cACDI,EAAYh5C,UAAW,sBAAmB,IAC7Ck4C,GACIU,WAAS,SACVI,EAAYh5C,UAAW,YAAS,IACnCk4C,GACIU,YAAS,IACVI,EAAYh5C,UAAW,oBAAiB,IAC3Ck4C,GACIU,YAAS,IACVI,EAAYh5C,UAAW,6BAA0B,IACpDk4C,GACIU,cACDI,EAAYh5C,UAAW,iCAA8B,IACxDk4C,GACIU,YAAS,IACVI,EAAYh5C,UAAW,iBAAc,IACxCk4C,GACIU,YAAS,IACVI,EAAYh5C,UAAW,gBAAa,IACvCk4C,GACIU,YAAS,IACVI,EAAYh5C,UAAW,wBAAqB,IAC/Ck4C,GACImL,aAAY3K,IACbM,EAAYh5C,UAAW,uBAAoB,IAC9Ck4C,GACImL,aAAYvK,IACbE,EAAYh5C,UAAW,mBAAgB,IAC1Ck4C,GACImL,aAAYtK,IACbC,EAAYh5C,UAAW,wBAAqB,IAC/Ck4C,GACIoL,WACDtK,EAAYh5C,UAAW,iBAAc,IACxCk4C,GACIoL,WACDtK,EAAYh5C,UAAW,cAAW,IACrCk4C,GACIoL,WACDtK,EAAYh5C,UAAW,gBAAa,IACvCk4C,GACIoL,WACDtK,EAAYh5C,UAAW,cAAW,IACrCk4C,GACIoL,WACDtK,EAAYh5C,UAAW,cAAW,IACrCk4C,GACIoL,WACDtK,EAAYh5C,UAAW,eAAY,IACtCk4C,GACIoL,WACDtK,EAAYh5C,UAAW,eAAY,IACtCk4C,GACIoL,WACDtK,EAAYh5C,UAAW,eAAY,IACtCk4C,GACIoL,WACDtK,EAAYh5C,UAAW,oBAAiB,IAC3Ck4C,GACIoL,WACDtK,EAAYh5C,UAAW,wBAAqB,IAC/Ck4C,GACIoL,WACDtK,EAAYh5C,UAAW,iBAAc,IACxCk4C,GACIoL,WACDtK,EAAYh5C,UAAW,YAAS,IACnCk4C,GACIoL,WACDtK,EAAYh5C,UAAW,qBAAkB,IAC5Ck4C,GACIoL,WACDtK,EAAYh5C,UAAW,sBAAmB,IAC7Ck4C,GACIoL,WACDtK,EAAYh5C,UAAW,yBAAsB,IAChDk4C,GACIoL,WACDtK,EAAYh5C,UAAW,qBAAkB,IAC5Ck4C,GACIoL,WACDtK,EAAYh5C,UAAW,4BAAyB,IACnDk4C,GACIoL,WACDtK,EAAYh5C,UAAW,YAAS,IACnCk4C,GACIoL,WACDtK,EAAYh5C,UAAW,6BAA0B,IACpDk4C,GACIoL,WACDtK,EAAYh5C,UAAW,kCAA+B,IACzDg5C,EAAcI,EAAgBlB,GAC1BqL,yBACDvK,IAELwK,cCvtEF,SAAWC,GAEPA,EAAc,IAAI,MAElBA,EAAe,KAAI,OAEnBA,EAAc,IAAI,OACnBA,aAAaA,gBAOhB,SAAWnQ,GAEPA,EAAsB,WAAI,aAE1BA,EAAoB,SAAI,YACzBA,cAAcA,iBAOjB,SAAW5gB,GAEPA,EAAqB,UAAI,YAEzBA,EAAmB,QAAI,UAEvBA,EAAgB,KAAI,OAEpBA,EAAiB,MAAI,QAErBA,EAAgB,KAAI,OAEpBA,EAAgB,KAAI,OAEpBA,EAAwB,aAAI,gBAC7BA,cAAcA,iBAOjB,SAAWwN,GAEPA,EAAYA,EAAwB,WAAI,GAAK,aAE7CA,EAAYA,EAAmB,MAAI,GAAK,QAExCA,EAAYA,EAAsB,SAAI,GAAK,WAE3CA,EAAYA,EAAqB,QAAI,GAAK,WAC3CA,gBAAgBA,mBAKnB,SAAWwjB,GAEPA,EAAkB,WAAI,aAEtBA,EAAsB,eAAI,iBAE1BA,EAAgB,SAAI,WAEpBA,EAAoB,aAAI,eAExBA,EAAc,OAAI,SAElBA,EAAkB,WAAI,aAEtBA,EAAkB,WAAI,aAEtBA,EAAiB,UAAI,YAErBA,EAAqB,cAAI,gBAEzBA,EAAgB,SAAI,WAEpBA,EAAoB,aAAI,eAExBA,EAAc,OAAI,SAElBA,EAAkB,WAAI,aAEtBA,EAAoB,aAAI,gBACzBA,UAAUA,aAKb,SAAWC,GACPA,EAAyB,KAAI,OAC7BA,EAA8B,UAAI,YAClCA,EAA6B,SAAI,WACjCA,EAA2B,OAAI,SAC/BA,EAA4B,QAAI,UAChCA,EAAyB,KAAI,OAC7BA,EAA0B,MAAI,QAC9BA,EAAyB,KAAI,OAC7BA,EAAwB,IAAI,MAC5BA,EAAyB,KAAI,OAC7BA,EAAwB,IAAI,MAC5BA,EAAyB,KAAI,OAC7BA,EAA0B,MAAI,QAC9BA,EAAyB,KAAI,OAC7BA,EAA8B,UAAI,YAClCA,EAA4B,QAAI,UAChCA,EAAyB,KAAI,OAC7BA,EAAoC,gBAAI,kBACxCA,EAAoC,gBAAI,kBACxCA,EAAoC,gBAAI,kBACxCA,EAAmC,eAAI,iBACvCA,EAA+B,WAAI,aACnCA,EAAgC,YAAI,cACpCA,EAAmC,eAAI,iBACvCA,EAAiC,aAAI,gBACtCA,uBAAuBA,0BAQ1B,SAAWC,GAEPA,EAA2B,QAAI,UAE/BA,EAA0B,OAAI,SAE9BA,EAAwB,KAAI,OAE5BA,EAAwB,KAAI,OAE5BA,EAA6B,UAAI,YAEjCA,EAAyB,MAAI,QAE7BA,EAA0B,OAAI,UAC/BA,sBAAsBA,yBAQzB,SAAWjF,GAEPA,EAAgC,WAAI,aAEpCA,EAA8B,SAAI,WAElCA,EAAyB,IAAI,MAE7BA,EAAgC,WAAI,aAEpCA,EAA8B,SAAI,WAElCA,EAA6B,QAAI,UAEjCA,EAA0B,KAAI,QAC/BA,wBAAwBA,2BAM3B,SAAWkF,GAEPA,EAAoB,KAAI,OAExBA,EAAqB,MAAI,QAEzBA,EAA0B,WAAI,aAE9BA,EAAsB,OAAI,SAE1BA,EAA2B,YAAI,cAE/BA,EAAsB,OAAI,SAE1BA,EAA2B,YAAI,cAE/BA,EAAmB,IAAI,OACxBA,kBAAkBA,oBC9LrB,IAAIvK,GAA+B,WAC/B,QAASA,GAAcp6C,GACnBC,KAAKwiB,mBACLxiB,KAAKqc,cAAgB,GACrBrc,KAAK2kD,YAAc,GACnB3kD,KAAK4kD,gBAAiB,EACtB5kD,KAAK6kD,eAAiB,OACtB7kD,KAAK8kD,YAAc,UACnB9kD,KAAK+kD,wBAAyB,EAC9B/kD,KAAKD,OAASA,EACdC,KAAKY,mBACLZ,KAAKglD,aAs7FT,MAp7FA7K,GAAct5C,UAAUC,QAAU,WAC1Bd,KAAKD,OAAOgB,aAGhBf,KAAKgB,uBAETm5C,EAAct5C,UAAUD,iBAAmB,WACvCZ,KAAKD,OAAOkB,GAAG,UAAWjB,KAAKuiB,QAASviB,MACxCA,KAAKD,OAAOkB,GAAG,YAAajB,KAAKc,QAASd,OAE9Cm6C,EAAct5C,UAAUG,oBAAsB,WAC1ChB,KAAKD,OAAOoB,IAAI,UAAWnB,KAAKuiB,SAChCviB,KAAKD,OAAOoB,IAAI,YAAanB,KAAKc,UAEtCq5C,EAAct5C,UAAUmkD,WAAa,WACjChlD,KAAKilD,eACDnlD,KAAM,OACNolD,OAAQ,UACRC,QAAS,WACTC,KAAM,OACNC,KAAM,OACNvV,UAAW,YACXwV,WAAY,aACZC,SAAU,WACV9F,WAAY,aACZC,SAAU,WACVC,IAAK,MACLC,WAAY,aACZC,QAAS,UACTC,KAAM,OACN0F,QAAS,UACTzF,SAAU,WACV12B,OAAQ,SACRo8B,QAAS,UACTC,OAAQ,SACRC,KAAM,OACNC,KAAM,OACNC,UAAW,YACXC,cAAe,kBACfC,MAAO,QACPC,OAAQ,SACRC,KAAM,WACNC,IAAK,MACLC,MAAO,QACPC,KAAM,OACNC,OAAQ,SACRC,WAAY,cACZC,YAAa,eACbC,eAAgB,kBAChBC,aAAc,gBACdC,GAAI,KACJC,OAAQ,SACRC,UAAW,aACXC,YAAa,eACbC,YAAa,eACbC,WAAY,cACZC,UAAW,aACXC,SAAU,YACVC,UAAW,aACXC,IAAK,MACLC,KAAM,OACNC,KAAM,OACNC,OAAQ,SACRhd,OAAQ,SACRF,OAAQ,SACRmd,QAAS,UACTC,UAAW,YACXC,KAAM,OACNvd,MAAO,QACPwd,KAAM,OACNC,KAAM,OACNC,OAAQ,SACRC,WAAY,cACZC,OAAQ,UACRC,MAAO,QACPC,OAAQ,SACRC,MAAO,QACPC,OAAQ,UACRC,IAAK,MACLC,OAAQ,SACRC,UAAW,YACXC,OAAQ,SACRC,SAAU,YACVC,MAAO,QACPC,IAAK,MACLje,IAAK,MACLke,WAAY,cACZC,YAAa,eACbC,YAAa,eACb3e,KAAM,OACN4e,iBAAkB,qBAClBC,cAAe,kBAEnB9oD,KAAK+oD,KAAO,GAAIC,QAAK,eAAgBhpD,KAAKilD,cAAejlD,KAAKD,OAAOy7C,SAEzErB,EAAct5C,UAAU0hB,QAAU,SAAUnhB,GACxC,GAAIrB,GAASC,KAAKD,MAElB,QADAC,KAAK0Q,yBACGtP,EAAKE,MACT,IAAK,iBACDtB,KAAKipD,eACL,MACJ,KAAK,4BACDjpD,KAAKkpD,yBACL,MACJ,KAAK,uBACDlpD,KAAKmpD,oBACL,MACJ,KAAK,kBACDnpD,KAAK02C,eAAet1C,EAAKI,MAAY,KAAGJ,EAAKI,MAAkB,WAAGJ,EAAKI,MAAkB,WAAGJ,EAAKI,MAAiB,UAAGJ,EAAKI,MAAa,MACvI,MACJ,KAAK,YACDxB,KAAKopD,UAAUhoD,EAAKI,MAAiB,UACrC,MACJ,KAAK,sBACDxB,KAAKqpD,qBACL,MACJ,KAAK,oBACDrpD,KAAKspD,gBAAgBloD,EAAKI,MAAkB,WAAGJ,EAAKI,MAAgB,SAAGJ,EAAKI,MAAe,QAC3F,MACJ,KAAK,wBACDxB,KAAKupD,qBACL,MACJ,KAAK,uBACDvpD,KAAKwpD,oBACL,MACJ,KAAK,oBACDxpD,KAAKypD,0BACL,MACJ,KAAK,qBACDzpD,KAAK0pD,2BACL,MACJ,KAAK,kBACD1pD,KAAK2pD,uBACL,MACJ,KAAK,uBACD3pD,KAAK4pD,mBAAmBxoD,EAAKI,MAAkB,WAC/C,MACJ,KAAK,2BACDxB,KAAK6pD,wBACL,MACJ,KAAK,yBACD7pD,KAAK8pD,sBACL,MACJ,KAAK,sBACD9pD,KAAK+pD,mBACL,MACJ,KAAK,uBACD/pD,KAAKgqD,sBACL,MACJ,KAAK,YACDhqD,KAAK+oD,KAAKkB,UAAU7oD,EAAKI,MAAc,OACvC,MACJ,KAAK,oBACDxB,KAAK4kD,eAAiBxjD,EAAKI,MAAiB,SAC5C,MACJ,KAAK,mBACDJ,EAAKI,MAAW,IAAiB,cAAIxB,KAAKqc,aAC1C,MACJ,KAAK,mBACDrc,KAAKqc,cAAgBjb,EAAKI,MAAc,MACxC,MACJ,KAAK,oBACDxB,KAAK6kD,eAAiBzjD,EAAKI,MAAY,IACvC,MACJ,KAAK,2BACDxB,KAAK8kD,YAAc1jD,EAAKI,MAAa,KACrC,MACJ,KAAK,mBACDJ,EAAKI,MAAW,IAAiB,cAAIzB,EAAOyd,aAC5C,MACJ,KAAK,mBACDzd,EAAOyd,cAAgBpc,EAAKI,MAAc,MAC1C,MACJ,KAAK,4BACDzB,EAAOud,uBAAyBlc,EAAKI,MAAa,KAClD,MACJ,KAAK,kBACDJ,EAAKI,MAAW,IAAgB,aAAIzB,EAAOqd,YAC3C,MACJ,KAAK,qBACDhc,EAAKI,MAAW,IAAmB,gBAAIxB,KAAKwiB,eAC5C,MACJ,KAAK,eACDxiB,KAAKkqD,aAAa9oD,EAAKI,MAAa,MACpC,MACJ,KAAK,+BACDxB,KAAKmqD,mBAAmB/oD,EAAKI,MAAY,KAAGJ,EAAKI,MAA2B,oBAAGJ,EAAKI,MAA4B,qBAAGJ,EAAKI,MAAwB,iBAAGJ,EAAKI,MAAwB,iBAChL,MACJ,KAAK,0BACDzB,EAAO2gD,yBACP,MACJ,KAAK,gBACD1gD,KAAKoqD,eACL,MACJ,KAAK,eACDpqD,KAAKqqD,aAAajpD,EAAKI,MAAY,KACnC,MACJ,KAAK,yBACDzB,EAAO4iD,uBAAuBvhD,EAAKI,MAAY,KAC/C,MACJ,KAAK,yBACDzB,EAAOghD,uBAAuB3/C,EAAKI,MAAY,KAAGJ,EAAKI,MAAa,MACpE,MACJ,KAAK,sBACDxB,KAAKsqD,qBACL,MACJ,KAAK,iBACDlpD,EAAKI,MAAW,IAAiB,cAAIzB,EAAO4L,aAC5C,MACJ,KAAK,4BACDvK,EAAKI,MAAW,IAA0B,uBAAIzB,EAAOqN,sBACrD,MACJ,KAAK,4BACDrN,EAAOqN,uBAAyBhM,EAAKI,MAAa,KAClD,MACJ,KAAK,2BACDzB,EAAOw3C,0BACP,MACJ,KAAK,2BACDv3C,KAAK+kD,uBAAyB3jD,EAAKI,MAAiB,SACpD,MACJ,KAAK,QACDxB,KAAKkC,UAIjBi4C,EAAct5C,UAAU6P,uBAAyB,WAC7C,GAAI3Q,GAASC,KAAKD,MAClBC,MAAKqiB,eAAiBtiB,EAAOsiB,eACzBtiB,EAAOqC,cACPpC,KAAKqC,aAAetC,EAAOqC,YAAYE,WAAW,OAElDvC,EAAOwC,cACPvC,KAAKwC,aAAezC,EAAOwC,YAAYD,WAAW,OAElDtC,KAAKqiB,iBACLriB,KAAKoiB,gBAAkBpiB,KAAKqiB,eAAe/f,WAAW,QAG9D63C,EAAct5C,UAAUqB,MAAQ,WAC5B,GAAInC,GAASC,KAAKD,MAClBC,MAAKwiB,mBACLxiB,KAAKqc,cAAgB,GACrBtc,EAAOqN,uBAAyB,KAChCpN,KAAKuxC,YAAc,KACnBvxC,KAAK2kD,YAAc,GACnB3kD,KAAK6kD,eAAiB,OACtB7kD,KAAK8kD,YAAc,UACnB/kD,EAAOyd,cAAgB,GACvBxd,KAAK4kD,eAAiB7kD,EAAO4L,cAAgB3L,KAAK+kD,wBAAyB,EAC3EhlD,EAAOud,uBAAyBvd,EAAOqd,aACnC,wHAGR+8B,EAAct5C,UAAUkpD,kBAAoB,WACxC,GAAIhqD,GAASC,KAAKD,OACdwiB,EAAUxF,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,WACtDhd,MAAKuqD,aAAehoC,GAAWA,EAAQtF,UAAUC,SAAS,cAC1DgG,eAAanG,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,YAAa,WAAWlc,WAGzFq5C,EAAct5C,UAAUipD,qBAAuB,WAC3C,GAAI/pD,GAASC,KAAKD,OACdwiB,EAAUxF,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,iBACtDuF,IAAWA,EAAQtF,UAAUC,SAAS,cACtCgG,eAAanG,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,kBAAmB,WAAWlc,WAG/Fq5C,EAAct5C,UAAU0pD,UAAY,WAChC,GAAIxqD,GAASC,KAAKD,MAClB,OAAQkC,qBAAkBlC,EAAOwiB,UAAaxiB,EAAOwiB,SAAWxiB,EAAOwiB,QAAQpd,OAAS,IAChFlD,oBAAkBlC,EAAOqlB,kBAErC+0B,EAAct5C,UAAUooD,cAAgB,WACpC,GAAI19C,GAAQvL,KACRD,EAASC,KAAKD,MAClB,IAAIkC,oBAAkBlC,EAAOwiB,UAAaxiB,EAAOwiB,SAAWxiB,EAAOwiB,QAAQpd,OAAS,EAAI,CACpFpF,EAAOgO,QAAQmZ,YAAYnnB,EAAO8nB,cAAc,OAC5C7K,GAAIjd,EAAOgO,QAAQiP,GAAK,eAAgB8+B,UAAW,mBAEvD,IAAI0O,IAAiBtP,SAAU,iBAAkBuP,MAAO,OAAQ9jD,KAAM,QAClE+jD,YAAa1qD,KAAK+oD,KAAK4B,YAAY,UAAW3M,SAAU,GAAI4M,aAAWC,kBAAmB,2BAC1F5oD,qBAAkBjC,KAAKwiB,mBACvBxiB,KAAKwiB,oBAETxiB,KAAKwiB,gBAAgBvc,KAAKukD,EAC1B,IAAItM,GAAcnhC,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,gBAC1D8tC,EAAY/qD,EAAO8nB,cAAc,OACjC7K,GAAIjd,EAAOgO,QAAQiP,GAAK,YAE5BkhC,GAAYh3B,YAAY4jC,EACxB,IAAIC,KAEI7P,SAAU,iBACVuP,MAAO,OAAQ9jD,KAAM,QACrB+jD,YAAa1qD,KAAK+oD,KAAK4B,YAAY,UACnC3M,SAAU,GAAI4M,aACVC,kBAAmB,yBACnBG,SAAU,WACDjrD,EAAOyL,WACJyQ,UAAQC,UACJ3Q,EAAMiX,gBAAgBrd,OAAS,GAC/B4X,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,aAC5CkG,eAAanG,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,YAAa,WAAWlc,UAEjFic,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,mBAC5CkG,eAAanG,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,kBAAmB,WAAWlc,UAE3FyK,EAAM+9C,iBAAgB,EAAOrtC,UAAQC,SAAU,MAC/C3Q,EAAMg+C,wBAGFh+C,EAAMiX,gBAAgBrd,OAAS,GAC/B4X,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,aAC5CkG,eAAanG,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,YAAa,WAAWlc,UAErFyK,EAAM+9C,iBAAgB,GAAO,EAAO,YAO3C,IAAI5N,YAAU6E,MAAOwK,EAAa1qD,MAAO,OACtD4qD,QAAS,WACLlrD,EAAO0M,QAAQ,kBAAoBy+C,YAAa,UAEpDjsB,QAASj/B,KAAKmrD,kBAAkBrnC,KAAK9jB,QAC9BokB,SAAS,IAAMrkB,EAAOgO,QAAQiP,GAAK,YAC9Chd,KAAKorD,4BACDruC,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,cAC5Chd,KAAKqc,cAAgBU,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,YAAYvY,kBAIjFzE,MAAKqc,cAAgB,GAG7B89B,EAAct5C,UAAUqoD,wBAA0B,WAC9C,GAAInpD,GAASC,KAAKD,MAClB,IAAIkC,oBAAkBlC,EAAOwiB,UAAaxiB,EAAOwiB,SAAWxiB,EAAOwiB,QAAQpd,OAAS,EAAI,CACpFpF,EAAOgO,QAAQmZ,YAAYnnB,EAAO8nB,cAAc,OAAS7K,GAAIjd,EAAOgO,QAAQiP,GAAK,yBAC7E8+B,UAAW,sCAAuCh0B,OAASjM,MAAO,yBAEtE,IAAIqiC,GAAcnhC,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,0BAC1DquC,EAAYtrD,EAAO8nB,cAAc,OAAS7K,GAAIjd,EAAOgO,QAAQiP,GAAK,sBACtEkhC,GAAYh3B,YAAYmkC,KAGhClR,EAAct5C,UAAU0oD,oBAAsB,WAC1C,GAAIxpD,GAASC,KAAKD,MAClB,IAAIkC,oBAAkBlC,EAAOwiB,UAAaxiB,EAAOwiB,SAAWxiB,EAAOwiB,QAAQpd,OAAS,EAAI,CAIpF,GAHApF,EAAOgO,QAAQmZ,YAAYnnB,EAAO8nB,cAAc,OAC5C7K,GAAIjd,EAAOgO,QAAQiP,GAAK,qBAAsB8+B,UAAW,uBAExD/7C,EAAOqlB,gBAAiB,CACzBrI,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,kBAAkBnB,MAAMvb,OAAUP,EAAOgO,QAAQqO,aAClE,EAArBpc,KAAKqc,cAAqB,EAAI,IACpC,IAAI6hC,GAAcnhC,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,sBAC1DsuC,EAAcvrD,EAAO8nB,cAAc,OACnC7K,GAAIjd,EAAOgO,QAAQiP,GAAK,kBAE5BkhC,GAAYh3B,YAAYokC,GAE5BtrD,KAAKurD,sBAGbpR,EAAct5C,UAAU4oD,yBAA2B,WAC/C,GAAI1pD,GAASC,KAAKD,MAClB,IAAIA,EAAO07C,uBAAwB,CAC/B,GAAI+O,IAAiBtP,SAAU,iBAAkBuP,MAAO,OAAQ9jD,KAAM,QAClE+jD,YAAa1qD,KAAK+oD,KAAK4B,YAAY,UAAW3M,SAAU,GAAI4M,aAAWC,kBAAmB,2BAC1F5oD,qBAAkBjC,KAAKwiB,mBACvBxiB,KAAKwiB,oBAETxiB,KAAKwiB,gBAAgBvc,KAAKukD,EAC1B,IAAItM,GAAcnhC,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,2BAC1DwuC,EAAYzrD,EAAO8nB,cAAc,OACjC7K,GAAIjd,EAAOgO,QAAQiP,GAAK,uBAE5BkhC,GAAYh3B,YAAYskC,GACP,GAAI9P,YAAUzc,QAASj/B,KAAKmrD,kBAAkBrnC,KAAK9jB,QACzDokB,SAAS,IAAMrkB,EAAOgO,QAAQiP,GAAK,yBAGtDm9B,EAAct5C,UAAUyoD,gBAAkB,SAAUmC,EAAevvC,EAAUK,GACzE,GAAIhR,GAAQvL,KACRD,EAASC,KAAKD,MAClB,IAAIC,KAAKuqD,YAAa,CAClB,GAAImB,GAAW1rD,KAAK2rD,mBAAmBpvC,GACnCqvC,EAAY5rD,KAAK6rD,oBAAoBtvC,GACrCuvC,EAAW9rD,KAAK+rD,mBAAmBN,GACnCO,EAAWhsD,KAAKisD,oBAEhBjsD,MAAKwiB,gBADLtG,EACuBwvC,EAAS9P,OAAOgQ,GAGhBF,EAAS9P,OAAOkQ,EAAUF,EAAWI,GAE/C,GAAItQ,YACjBr7C,MAAO,OACPkgD,MAAOvgD,KAAKwiB,gBACZyc,QAASj/B,KAAKmrD,kBAAkBrnC,KAAK9jB,MACrCirD,QAAS,WACA/uC,GACD3Q,EAAM2gD,sBAEV3gD,EAAM4gD,oBACN5gD,EAAM6gD,gBACNrsD,EAAO0M,QAAQ,kBAAoBy+C,YAAa,YAG7C9mC,SAAS,IAAMrkB,EAAOgO,QAAQiP,GAAK,YAC9Chd,KAAKorD,4BACLprD,KAAKqpD,sBACDrpD,KAAKuqD,aAAextC,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,aAEhDkG,eAAanjB,EAAOgO,QAAQiP,GAAK,WAAY,WACnD+3B,oBAItBoF,EAAct5C,UAAU0qD,kBAAoB,WACxC,GAAIhgD,GAAQvL,KACRD,EAASC,KAAKD,MAClB,IAAIkC,oBAAkBlC,EAAOwiB,UAAaxiB,EAAOwiB,SAAWxiB,EAAOwiB,QAAQpd,OAAS,EAAI,CACpF,GAAIo7C,GAAQvgD,KAAK+rD,oBACA,IAAIrQ,YAAU6E,MAAOA,EAAOlgD,MAAO,OAChD4qD,QAAS,WACL1/C,EAAM2gD,sBACN3gD,EAAM8gD,gBACN9gD,EAAM+gD,qBACNvsD,EAAO0M,QAAQ,kBAAoBy+C,YAAa,UAEpDjsB,QAASj/B,KAAKmrD,kBAAkBrnC,KAAK9jB,QAE9BokB,SAAS,IAAMrkB,EAAOgO,QAAQiP,GAAK,kBAC1Chd,KAAKwiB,gBAAgBrd,OAAS,GAAK4X,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,mBAE/DkG,eAAanjB,EAAOgO,QAAQiP,GAAK,iBAAkB,WACzD+3B,oBAItBoF,EAAct5C,UAAU8qD,mBAAqB,SAAUpvC,GACnD,GAAIxc,GAASC,KAAKD,OACdyqD,IACCjuC,KACDiuC,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,UAAWk+B,SAAU,iBAAkBuP,MAAO,OAAQ9jD,KAAM,QAASq3C,SAAU,GAAI4M,aAAWC,kBAAmB,6BAC7JL,EAAavkD,MAAOsmD,SAAS,EAAOrR,SAAU,gCAAiCwP,YAAa1qD,KAAK+oD,KAAK4B,YAAY,UAAWF,MAAO,UAEpI1qD,EAAO+iC,iBACH7gC,oBAAkBlC,EAAOwiB,UAAaxiB,EAAOwiB,SAAWxiB,EAAOwiB,QAAQ/D,QAAQ,SAAW,IAC1FgsC,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,QAASwvC,WAAY,iBAAkBtR,SAAU,kBACzFwP,YAAa1qD,KAAK+oD,KAAK4B,YAAY,QAASF,MAAO,UAEvDxoD,oBAAkBlC,EAAOwiB,UAAaxiB,EAAOwiB,SAAWxiB,EAAOwiB,QAAQ/D,QAAQ,SAAW,IAC1FgsC,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,QAASwvC,WAAY,iBAAkBtR,SAAU,kBACzFwP,YAAa1qD,KAAK+oD,KAAK4B,YAAY,QAASF,MAAO,UAG1DzqD,KAAK4kD,iBAAmB7kD,EAAOkN,aAAa6zB,YAAcC,cAAY2a,WAAa3a,cAAY2a,WAC5Fz5C,oBAAkBlC,EAAOwiB,UAAaxiB,EAAOwiB,SAAWxiB,EAAOwiB,QAAQ/D,QAAQ,YAAc,IAC7FgsC,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,WAAYwvC,WAAY,qBAAsBtR,SAAU,sBAChGwP,YAAa1qD,KAAK+oD,KAAK4B,YAAY,WAAYF,MAAO,UAE1DxoD,oBAAkBlC,EAAOwiB,UAAaxiB,EAAOwiB,SAAWxiB,EAAOwiB,QAAQ/D,QAAQ,WAAa,IAC5FgsC,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,UAAWwvC,WAAY,oBAAqBtR,SAAU,sBAC9FwP,YAAa1qD,KAAK+oD,KAAK4B,YAAY,UAAWF,MAAO,SAIjE,KAAK,GADDgC,GAAmBzsD,KAAK0sD,eAAe,QAClC1nD,EAAI,EAAGC,EAAMwnD,EAAiBtnD,OAAQH,EAAIC,EAAKD,IACpDwlD,EAAavkD,KAAKwmD,EAAiBznD,GAEvC,OAAOwlD,IAEXrQ,EAAct5C,UAAUgrD,oBAAsB,SAAUtvC,GACpD,GAAIxc,GAASC,KAAKD,OACdyqD,IACAjuC,KACAiuC,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,MAAOwvC,WAAY,kBAAmBtR,SAAU,kBACxFwP,YAAa1qD,KAAK+oD,KAAK4B,YAAY,MAAOF,MAAO,UACrDD,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,UAAWwvC,WAAY,kBAAmBtR,SAAU,kBAC5FwP,YAAa1qD,KAAK+oD,KAAK4B,YAAY,UAAWF,MAAO,YAEzDxoD,oBAAkBlC,EAAOwiB,UAAaxiB,EAAOwiB,SAAWxiB,EAAOwiB,QAAQ/D,QAAQ,UAAY,IAC3FgsC,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,SAAUwvC,WAAY,sBAAuBtR,SAAU,uBAC/FwP,YAAa1qD,KAAK+oD,KAAK4B,YAAY,SAAUF,MAAO,UAEvDluC,IACGta,oBAAkBlC,EAAOwiB,UAAaxiB,EAAOwiB,SAAWxiB,EAAOwiB,QAAQ/D,QAAQ,SAAW,IAC1FgsC,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,QAASwvC,WAAY,qBAAsBtR,SAAU,kBAC7FwP,YAAa1qD,KAAK+oD,KAAK4B,YAAY,QAASF,MAAO,QAASzM,SAAU,eAAiBj+C,EAAOgO,QAAQiP,GAAK,uBAIvH,KAAK,GADDyvC,GAAmBzsD,KAAK0sD,eAAe,SAClC1nD,EAAI,EAAGC,EAAMwnD,EAAiBtnD,OAAQH,EAAIC,EAAKD,IACpDwlD,EAAavkD,KAAKwmD,EAAiBznD,GAEvC,OAAOwlD,IAEXrQ,EAAct5C,UAAUkrD,mBAAqB,SAAUN,GACnD,GAAI1rD,GAASC,KAAKD,OACdyqD,MACAvoD,oBAAkBlC,EAAOwiB,UAAaxiB,EAAOwiB,SAAWxiB,EAAOwiB,QAAQ/D,QAAQ,SAAW,IAC1FgsC,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,iBAAkBwvC,WAAY,iBAAkBtR,SAAU,kBAClGwP,YAAa1qD,KAAK+oD,KAAK4B,YAAY,oBAAqBF,MAAO,YAEnExoD,oBAAkBlC,EAAOwiB,UAAaxiB,EAAOwiB,SAAWxiB,EAAOwiB,QAAQ/D,QAAQ,aAAe,IAC9FgsC,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,cAAe0tC,YAAa1qD,KAAK+oD,KAAK4B,YAAY,cAAeF,MAAO,SAChHzM,SAAU,eAAiBj+C,EAAOgO,QAAQiP,GAAK,+BAEnD/a,oBAAkBlC,EAAOwiB,UAAaxiB,EAAOwiB,SAAWxiB,EAAOwiB,QAAQ/D,QAAQ,aAAe,IAC9FgsC,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,cAAewvC,WAAY,uBAAwBtR,SAAU,wBACrGwP,YAAa1qD,KAAK+oD,KAAK4B,YAAY,YAAaF,MAAO,YAE3DxoD,oBAAkBlC,EAAOwiB,UAAaxiB,EAAOwiB,SAAWxiB,EAAOwiB,QAAQ/D,QAAQ,WAAa,IAC5FgsC,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,UAAWwvC,WAAY,oBAAqBtR,SAAU,qBAC9FwP,YAAa1qD,KAAK+oD,KAAK4B,YAAY,UAAWF,MAAO,UAG7D,KAAK,GADDgC,GAAmBzsD,KAAK0sD,eAAe,UAClC1nD,EAAI,EAAGC,EAAMwnD,EAAiBtnD,OAAQH,EAAIC,EAAKD,IACpDwlD,EAAavkD,KAAKwmD,EAAiBznD,GAQvC,OANIymD,KACAjB,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,MAAOwvC,WAAY,kBAAmBtR,SAAU,kBACxFwP,YAAa1qD,KAAK+oD,KAAK4B,YAAY,MAAOF,MAAO,UACrDD,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,UAAWwvC,WAAY,kBAAmBtR,SAAU,kBAC5FwP,YAAa1qD,KAAK+oD,KAAK4B,YAAY,UAAWF,MAAO,WAEtDD,GAEXrQ,EAAct5C,UAAUorD,mBAAqB,WAEzC,UAEJ9R,EAAct5C,UAAU8rD,wBAA0B,SAAUhmD,EAAMiD,GAC9D,GAAI7J,GAASC,KAAKD,OACdm+C,EAAcn+C,EAAOgO,QAAQoO,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,gBACrE4vC,EAAwB7sD,EAAOgO,QAAQoO,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,yBAuBnF,IAtBA4vC,EAAsB3vC,UAAU+O,OAAO,UACvC4gC,EAAsB/wC,MAAMZ,KAAOijC,EAAY5d,WAAa,KAC/C,WAAT35B,GACIoW,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,aAAehd,KAAKwiB,gBAAgBrd,OAAS,GACzF+d,eAAanG,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,YAAa,WAAWlc,UAEjFmb,UAAQC,SACRlc,KAAKspD,iBAAgB,GAAO,GAAM,GAGlCtpD,KAAKspD,iBAAgB,EAAM,KAAM,MAErCtpD,KAAKoqD,gBACLpqD,KAAK6sD,0BAGD9vC,SAASZ,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,sBAAsBC,UAAUC,SAAS,cAC1FgG,eAAanG,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,sBAAuB,WAAWlc,UAE/Fd,KAAKoqD,gBACLpqD,KAAKqqD,aAAazgD,IAElBqS,UAAQC,SAAU,CAClB,GAAI4wC,GAAMF,EAAsBxwC,aAC5B2wC,EAAKhtD,EAAOgO,QAAQoO,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,kBAAkBZ,YAClFwwC,GAAsB/wC,MAAM6K,IAAM1mB,KAAKqc,cAAgB0wC,EAAKD,EAAM,SAGlEF,GAAsB/wC,MAAM6K,IAAM1mB,KAAKqc,cAAgB,MAG/D89B,EAAct5C,UAAU6rD,eAAiB,SAAUxQ,GAC/C,GAAIn8C,GAASC,KAAKD,OACdyqD,IACJ,IAAIzqD,EAAOwiB,QACP,IAAK,GAAIvd,GAAI,EAAGC,EAAMlF,EAAOwiB,QAAQpd,OAAQH,EAAIC,EAAKD,IACf,gBAAvBjF,GAAOwiB,QAAQvd,KACnB/C,oBAAkBlC,EAAOwiB,QAAQvd,GAAGylD,OACnB,SAAbvO,GACAsO,EAAavkD,KAAKlG,EAAOwiB,QAAQvd,IAGhCjF,EAAOwiB,QAAQvd,GAAGylD,MAAM73C,gBAAkBspC,GAC/CsO,EAAavkD,KAAKlG,EAAOwiB,QAAQvd,IAKjD,OAAOwlD,IAEXrQ,EAAct5C,UAAUmsD,kBAAoB,SAAUzM,GAClD,GAAIiK,KACJ,IAAIjK,EACA,IAAK,GAAIv7C,GAAI,EAAGC,EAAMs7C,EAAMp7C,OAAQH,EAAIC,EAAKD,IACf,gBAAdu7C,GAAMv7C,KACdu7C,EAAMv7C,GAAGylD,MAAQ,SACjBD,EAAavkD,KAAKs6C,EAAMv7C,IAIpC,OAAOwlD,IAEXrQ,EAAct5C,UAAUsrD,kBAAoB,WACxC,GAAIc,GAASlwC,SAASZ,cAAc,IAAMnc,KAAKD,OAAOgO,QAAQiP,GAAK,WAC/Dw2B,EAAUz2B,SAASZ,cAAc,IAAMnc,KAAKD,OAAOgO,QAAQiP,GAAK,WAChEiwC,KACAA,EAAOrsD,iBAAiB,YAAaZ,KAAKktD,0BAA0BppC,KAAK9jB,OACzEitD,EAAOrsD,iBAAiB,UAAWZ,KAAK2pD,sBAAsB7lC,KAAK9jB,OACnEitD,EAAOrsD,iBAAiB,QAASZ,KAAKmtD,sBAAsBrpC,KAAK9jB,OACjEitD,EAAOrsD,iBAAiB,aAAcZ,KAAKmtD,sBAAsBrpC,KAAK9jB,QAEtEwzC,IACAA,EAAQ5yC,iBAAiB,YAAaZ,KAAKotD,2BAA2BtpC,KAAK9jB,OAC3EwzC,EAAQ5yC,iBAAiB,UAAWZ,KAAK2pD,sBAAsB7lC,KAAK9jB,OACpEwzC,EAAQ5yC,iBAAiB,QAASZ,KAAKqtD,uBAAuBvpC,KAAK9jB,OACnEitD,EAAOrsD,iBAAiB,aAAcZ,KAAKmtD,sBAAsBrpC,KAAK9jB,SAG9Em6C,EAAct5C,UAAUwoD,oBAAsB,WAC1C,GAAItpD,GAASC,KAAKD,MAClB,KAAKC,KAAK+kD,uBAAwB,CAC9B,GAAIj/C,IAAWgZ,uBACf/e,GAAO+C,OAAO,aAAexB,KAAM,yBAA0BE,OAASyC,IAAK6B,IAC3E,IAAI+6C,IAAgBnL,aAAc,KAClC31C,GAAO+C,OAAO,aAAexB,KAAM,kBAAmBE,OAASyC,IAAK48C,IACpE,IAAIzK,GAAOr5B,SAASZ,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,QACxDo5B,IAAwC,IAAhCyK,EAA0B,cAClCzK,EAAKn5B,UAAUa,IAAI,cACnBs4B,EAAKlqB,cAAcjP,UAAUa,IAAI,cAE5Bs4B,GAAQyK,EAA0B,aAAI,IAC3CzK,EAAKn5B,UAAU+O,OAAO,cACtBoqB,EAAKlqB,cAAcjP,UAAU+O,OAAO,aAExC,IAAIqqB,GAAOt5B,SAASZ,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,QACxDq5B,IAASwK,EAA0B,eAAM/6C,EAA4B,oBAAEX,QACvEkxC,EAAKp5B,UAAUa,IAAI,cACnBu4B,EAAKnqB,cAAcjP,UAAUa,IAAI,cAE5Bu4B,GAAyC,IAAhCwK,EAA0B,cAAW/6C,EAA4B,oBAAEX,OAAS,GAC1FkxC,EAAKp5B,UAAU+O,OAAO,cACtBqqB,EAAKnqB,cAAcjP,UAAU+O,OAAO,cAE/BqqB,GAAQwK,EAA0B,aAAI,IAC3CxK,EAAKp5B,UAAU+O,OAAO,cACtBqqB,EAAKnqB,cAAcjP,UAAU+O,OAAO,cAG5C,GAAIihC,GAASlwC,SAASZ,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,UAC1DiwC,IAAUltD,EAAOkN,aAAapJ,YAAc9D,EAAOkN,aAAasY,eAChE0nC,EAAOhwC,UAAUa,IAAI,cACrBmvC,EAAO/gC,cAAcjP,UAAUa,IAAI,cAE9BmvC,IACLA,EAAOhwC,UAAU+O,OAAO,cACxBihC,EAAO/gC,cAAcjP,UAAU+O,OAAO,aAE1C,IAAIwnB,GAAUz2B,SAASZ,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,WAC3Dw2B,IAAWzzC,EAAOkN,aAAapJ,YAAc9D,EAAOkN,aAAa0lC,eACjEa,EAAQv2B,UAAUa,IAAI,cACtB01B,EAAQtnB,cAAcjP,UAAUa,IAAI,cAE/B01B,IACLA,EAAQv2B,UAAU+O,OAAO,cACzBwnB,EAAQtnB,cAAcjP,UAAU+O,OAAO,aAE3C,IAAIrmB,GAAMoX,SAASZ,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,OACvDrX,IAAO5F,EAAOkN,aAAapJ,YAAc9D,EAAOkN,aAAa0lC,cAC7DhtC,EAAIkW,MAAMG,QAAU,OAEfrW,IACLA,EAAIkW,MAAMG,QAAU,UAG5Bm+B,EAAct5C,UAAUuqD,0BAA4B,WAChD,GAAIrrD,GAASC,KAAKD,MAClB,QAA6B0T,KAAzBzT,KAAKwiB,iBAAiCxiB,KAAKwiB,gBAAgBrd,OAAS,GACnE4X,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,YAAc,CAC3D,GAAIswC,GAAYvwC,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,YACvDb,cAAc,kBACnB,IAAImxC,EAAW,CACX,GAAIC,GAAaD,EAAUE,qBAAqB,SAAS,GACrDC,EAAgBH,EAAUE,qBAAqB,UAAU,EAC7DC,GAAc3R,UAAY,iCAC1B2R,EAActmC,UAAY,GAC1BsmC,EAAcvmC,YAAYnnB,EAAO8nB,cAAc,QAC3Ci0B,UAAW,kDAEfyR,EAAWG,SAAW1tD,KAAK+R,WAAW+R,KAAK9jB,KAAMutD,MAI7DpT,EAAct5C,UAAUkR,WAAa,SAAU4S,EAAcvjB,GACzDpB,KAAKD,OAAO+C,OAAO,QAAUxB,KAAM,aAAcE,OAASmjB,aAAcA,EAAcvjB,KAAMA,MAEhG+4C,EAAct5C,UAAUqrD,oBAAsB,SAAU1iD,GACpD,GAAI+B,GAAQvL,KACRD,EAASC,KAAKD,OACdwgD,MACAt+C,oBAAkBlC,EAAOwiB,UAAaxiB,EAAOwiB,SAAWxiB,EAAOwiB,QAAQ/D,QAAQ,QAAU,IACzF+hC,EAAMt6C,MAAOkJ,KAAMnP,KAAK+oD,KAAK4B,YAAY,OAAQ3tC,GAAI,MAAOkH,QAAS,wBAErEjiB,oBAAkBlC,EAAOwiB,UAAaxiB,EAAOwiB,SAAWxiB,EAAOwiB,QAAQ/D,QAAQ,SAAW,IAC1F+hC,EAAMt6C,MAAOkJ,KAAMnP,KAAK+oD,KAAK4B,YAAY,QAAS3tC,GAAI,OAAQkH,QAAS,oBAEvEjiB,oBAAkBlC,EAAOwiB,UAAaxiB,EAAOwiB,SAAWxiB,EAAOwiB,QAAQ/D,QAAQ,cAAgB,IAC/F+hC,EAAMt6C,MAAOkJ,KAAMnP,KAAK+oD,KAAK4B,YAAY,aAAc3tC,GAAI,YAAakH,QAAS,yBAEjFjiB,oBAAkBlC,EAAOwiB,UAAaxiB,EAAOwiB,SAAWxiB,EAAOwiB,QAAQ/D,QAAQ,YAAc,IAC7F+hC,EAAMt6C,MAAOkJ,KAAMnP,KAAK+oD,KAAK4B,YAAY,WAAY3tC,GAAI,UAAWkH,QAAS,sBAE7EjiB,oBAAkBlC,EAAOwiB,UAAaxiB,EAAOwiB,SAAWxiB,EAAOwiB,QAAQ/D,QAAQ,UAAY,IAC3F+hC,EAAMt6C,MAAOkJ,KAAMnP,KAAK+oD,KAAK4B,YAAY,SAAU3tC,GAAI,QAASkH,QAAS,8BAEzEjiB,oBAAkBlC,EAAOwiB,UAAaxiB,EAAOwiB,SAAWxiB,EAAOwiB,QAAQ/D,QAAQ,SAAW,IAC1F+hC,EAAMt6C,MAAOkJ,KAAMnP,KAAK+oD,KAAK4B,YAAY,QAAS3tC,GAAI,OAAQkH,QAAS,6BAEvEjiB,oBAAkBlC,EAAOwiB,UAAaxiB,EAAOwiB,SAAWxiB,EAAOwiB,QAAQ/D,QAAQ,SAAW,IAC1F+hC,EAAMt6C,MAAOkJ,KAAMnP,KAAK+oD,KAAK4B,YAAY,QAAS3tC,GAAI,OAAQkH,QAAS,sBAE3E,IAAIjgB,IAAQqhC,uBAAwB,KACpCvlC,GAAO+C,OAAO,iBAAmBxB,KAAM,4BAA6ByB,kBAAkB,EAAOvB,OAASyC,IAAKA,IAC3G,IAAI0pD,GAAmB5wC,SAASZ,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,cACpE4wC,EAAgB7wC,SAASZ,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,WACjE6wC,EAAkB9wC,SAASZ,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,YAC3B,KAAvCjd,EAAO6C,UAAUC,YAAYxC,OAAuD,IAAxCN,EAAO6C,UAAUC,YAAYvC,SACzE2B,oBAAkBlC,EAAO6C,UAAUqE,YAAelH,EAAO6C,UAAUqE,WACvB,IAAtClH,EAAO6C,UAAUqE,UAAU9B,SAClClD,oBAAkBgC,EAA4B,yBAC1C0pD,GACAA,EAAiB1wC,UAAUa,IAAI,cAE/B8vC,GACAA,EAAc3wC,UAAUa,IAAI,cAE5B+vC,GACAA,EAAgB5wC,UAAUa,IAAI,gBAI9B6vC,GACAA,EAAiB1wC,UAAU+O,OAAO,cAElC4hC,GACAA,EAAc3wC,UAAU+O,OAAO,cAE/B6hC,GACAA,EAAgB5wC,UAAU+O,OAAO,cAGzC,IAAI9H,GAAU1a,EAAsBxJ,KAAK8tD,oBAAoB/tD,EAAO6C,UAAUwC,OAAS,eACnF2oD,EAAa,GAAIC,mBAAiBzN,MAAOA,EAAOr8B,QAAS,WAAaA,EACtEg3B,SAAU,gBACVrpC,KAAM,SAAUzQ,GACR6a,UAAQC,WACR9a,EAAK2M,QAAQme,cAAcrQ,MAAM6K,IAAMqnC,EAAWhgD,QAAQ8hB,wBAAwBnJ,IAC9EtlB,EAAK2M,QAAQme,cAAc9P,aAAe,MAE9Crc,EAAO6C,UAAUwC,MACjB2X,SAAS0F,eAAe1iB,EAAO6C,UAAUwC,OAAO6X,UAAUa,IAAI,cAEzD/d,EAAOse,WACZtB,SAAS0F,eAAe,OAAOxF,UAAUa,IAAI,eAGrDxM,OAAQ,SAAUlQ,GACdrB,EAAO8zB,OACP,IACInnB,GADAwR,GAAkB,MAESzK,KAA3B1T,EAAO6C,UAAUwC,QACjBsH,EAAa3M,EAAO6C,UAAUwC,MAAMuH,MAAM,UAE3B8G,KAAf/G,GAA4B3M,EAAO0F,YAAYC,aAC/CwY,GAAkB,MAEEzK,KAAf/G,GAA8C,SAAlBA,EAAW,KAC5CwR,GAAkB,GAEtBne,EAAO0F,YAAYC,cAAe,GAC9BwY,GAAmBne,EAAOie,aAC1Bje,EAAO+C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,IACrEwI,EAAM/I,aAAa2B,UAAU,EAAG,EAAGpE,EAAOwC,YAAYlC,MAAON,EAAOwC,YAAYjC,QAChFiL,EAAMmrC,eAAe,QAEzB,IAAIzyC,IAAQgqD,yBAA0B,KAGtC,QAFAluD,EAAO+C,OAAO,iBAAmBxB,KAAM,8BAA+BE,OAASyC,IAAKA,KACpF8pD,EAAW7pC,QAAU,WAAa3Y,EAAMuiD,oBAAoB1sD,EAAKqsC,KAAKzwB,IAC9D5b,EAAKqsC,KAAKzwB,IACd,IAAK,MACDjd,EAAO+C,OAAO,QAAUxB,KAAM,yBAA0BE,OAASmO,oBAAqB5P,EAAOiH,mBAC7FjH,EAAO+C,OAAO,QAAUxB,KAAM,kCAAmCE,OAAS0sD,6BAA8BjqD,EAA8B,4BACtIsH,EAAMs5C,eAAiB,MACvB9kD,EAAOwuB,cAAa,EACpB,MACJ,KAAK,OACDhjB,EAAMs5C,eAAiB,OACvB9kD,EAAO+C,OAAO,SAAWxB,KAAM,mBAM/B,MACJ,SACIiK,EAAMs5C,eAAiB,SAEvBt5C,EAAM4iD,wBAAwB/sD,GAC9BrB,EAAO+C,OAAO,aAAexB,KAAM,WAAYE,OAAS4D,MAAOhE,EAAKqsC,KAAKzwB,MACzEjd,EAAO+C,OAAO,WAAaxB,KAAM,kBAAmByB,kBAAkB,EAAOvB,OAASmF,KAAM,SACpF8C,WAAY,KAAMC,WAAY,KAAMC,UAAW,KAAMC,MAAO,QAG5E2B,EAAM49C,uBAId4E,GAAW3pC,SAAS,IAAMrkB,EAAOgO,QAAQiP,GAAK,mBAElDm9B,EAAct5C,UAAUwrD,cAAgB,WACpC,GAAI9gD,GAAQvL,KACRD,EAASC,KAAKD,OACdwgD,MACAt+C,oBAAkBlC,EAAOwiB,UAAaxiB,EAAOwiB,SAAWxiB,EAAOwiB,QAAQ/D,QAAQ,oBAAsB,IACrG+hC,EAAMt6C,MAAOkJ,KAAMnP,KAAK+oD,KAAK4B,YAAY,UAAW3tC,GAAI,SAAUkH,QAAS,sBAE3EjiB,oBAAkBlC,EAAOwiB,UAAaxiB,EAAOwiB,SAAWxiB,EAAOwiB,QAAQ/D,QAAQ,oBAAsB,IACrG+hC,EAAMt6C,MAAOkJ,KAAMnP,KAAK+oD,KAAK4B,YAAY,UAAW3tC,GAAI,SAAUkH,QAAS,sBAE3EjiB,oBAAkBlC,EAAOwiB,UAAaxiB,EAAOwiB,SAAWxiB,EAAOwiB,QAAQ/D,QAAQ,oBAAsB,IACrG+hC,EAAMt6C,MAAOkJ,KAAMnP,KAAK+oD,KAAK4B,YAAY,UAAW3tC,GAAI,SAAUkH,QAAS,sBAE3EjiB,oBAAkBlC,EAAOwiB,UAAaxiB,EAAOwiB,SAAWxiB,EAAOwiB,QAAQ/D,QAAQ,mBAAqB,KACpG+hC,EAAMt6C,MAAOkJ,KAAM,MAAO6N,GAAI,MAAOkH,QAAS,uBAC9Cq8B,EAAMt6C,MAAOkJ,KAAM,MAAO6N,GAAI,MAAOkH,QAAS,uBAC9Cq8B,EAAMt6C,MAAOkJ,KAAM,MAAO6N,GAAI,MAAOkH,QAAS,uBAC9Cq8B,EAAMt6C,MAAOkJ,KAAM,MAAO6N,GAAI,MAAOkH,QAAS,uBAC9Cq8B,EAAMt6C,MAAOkJ,KAAM,OAAQ6N,GAAI,OAAQkH,QAAS,uBAEpD,IAAIA,GACA9e,CACArF,GAAO6C,UAAUwC,OACjB8e,EAAUlkB,KAAK8tD,oBAAoB/tD,EAAO6C,UAAUwC,OACpDA,EAAQrF,EAAO6C,UAAUwC,OAEpBrF,EAAOgE,oBACZmgB,EAAUlkB,KAAK8tD,oBAAoB/tD,EAAOgE,mBAAmBqB,OAC7DA,EAAQrF,EAAOgE,mBAAmBqB,QAGlC8e,EAAU,WACV9e,EAAQ,SAEZ,IAAI2oD,GAAa,GAAIC,mBACjBn8C,KAAM,SAAUzQ,GACRrB,EAAOie,WACPzS,EAAM6iD,YAENnyC,UAAQC,WACR9a,EAAK2M,QAAQme,cAAcrQ,MAAM6K,IAAMqnC,EAAWhgD,QAAQ8hB,wBAAwBnJ,IAC9EtlB,EAAK2M,QAAQme,cAAc9P,aAAe,MAE9Crc,EAAO6C,UAAUwC,OAASrF,EAAO6C,UAAUwC,MAAMuH,MAAM,KAAKxH,OAAS,GACrE4X,SAAS0F,eAAe1iB,EAAO6C,UAAUwC,MAAMuH,MAAM,KAAK,IAAIsQ,UAAUa,IAAI,cAEhF/d,EAAO+C,OAAO,aAAexB,KAAM,oBAAqBE,OAAS0/B,WAAW,MAEhFqf,MAAOA,EACPjvC,OAAQ,SAAUlQ,GACdmK,EAAM8iD,WAAWjtD,GACjB2sD,EAAW7pC,QAAU,WAAa3Y,EAAMuiD,oBAAoB,QAAU1sD,EAAKqsC,KAAKzwB,IAChF+wC,EAAWvqC,QAAUzjB,EAAO+G,aAAa1F,EAAKqsC,KAAKzwB,KAEvDkH,QAAS,WAAaA,EAASg3B,SAAU,gBACzC13B,QAASzjB,EAAO+G,aAAa1B,EAAMg2C,QAAQ,QAAS,MAExD2S,GAAW3pC,SAAS,IAAMrkB,EAAOgO,QAAQiP,GAAK,aAElDm9B,EAAct5C,UAAUyrD,mBAAqB,WACzC,GAAIvsD,GAASC,KAAKD,OACdwgD,MACAt+C,oBAAkBlC,EAAOwiB,UAAaxiB,EAAOwiB,SAAWxiB,EAAOwiB,QAAQ/D,QAAQ,eAAiB,IAChG+hC,EAAMt6C,MAAOkJ,KAAMnP,KAAK+oD,KAAK4B,YAAY,cAAe3tC,GAAI,aAAckH,QAAS,+BAEnFjiB,oBAAkBlC,EAAOwiB,UAAaxiB,EAAOwiB,SAAWxiB,EAAOwiB,QAAQ/D,QAAQ,gBAAkB,IACjG+hC,EAAMt6C,MAAOkJ,KAAMnP,KAAK+oD,KAAK4B,YAAY,eAAgB3tC,GAAI,cAAekH,QAAS,0BAErFjiB,oBAAkBlC,EAAOwiB,UAAaxiB,EAAOwiB,SAAWxiB,EAAOwiB,QAAQ/D,QAAQ,mBAAqB,IACpG+hC,EAAMt6C,MAAOkJ,KAAMnP,KAAK+oD,KAAK4B,YAAY,kBAAmB3tC,GAAI,iBAAkBkH,QAAS,+BAE3FjiB,oBAAkBlC,EAAOwiB,UAAaxiB,EAAOwiB,SAAWxiB,EAAOwiB,QAAQ/D,QAAQ,iBAAmB,IAClG+hC,EAAMt6C,MAAOkJ,KAAMnP,KAAK+oD,KAAK4B,YAAY,gBAAiB3tC,GAAI,eAAgBkH,QAAS,2BAE3F,IAAI6pC,GAAa,GAAIC,mBACjBn8C,KAAM,SAAUzQ,GACZ,GAAI6a,UAAQC,SAAU,CAClB,GAAI6wC,GAAK3rD,EAAK2M,QAAQme,cAAc9P,YACpChb,GAAK2M,QAAQme,cAAcrQ,MAAMG,QAAU,OAC3C5a,EAAK2M,QAAQme,cAAcrQ,MAAM6K,IAAMqnC,EAAWhgD,QAAQ8hB,wBAAwBnJ,IAC9EqmC,EAAK,KACT3rD,EAAK2M,QAAQme,cAAcrQ,MAAMG,QAAU,UAGnDukC,MAAOA,EAAOjvC,OAAQvR,EAAO6iD,gBAAgB9+B,KAAK9jB,MAClDkkB,QAAS,sBAAuBg3B,SAAU,iBAE9C6S,GAAW3pC,SAAS,IAAMrkB,EAAOgO,QAAQiP,GAAK,kBAElDm9B,EAAct5C,UAAUurD,cAAgB,WACpC,GAAIrsD,GAASC,KAAKD,OACduuD,IACEn/C,KAAM,OAAQ6N,GAAI,SAClB7N,KAAM,MAAO6N,GAAI,QACjB7N,KAAM,MAAO6N,GAAI,OAETD,UAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,aAGjC,GAAIgxC,mBAAiBzN,MAAO+N,EAAWpT,SAAU,6BAA8Bh3B,QAAS,iBACzG5S,OAAQ,SAAUlQ,GACdrB,EAAOgjB,OAAO3hB,EAAKqsC,KAAKt+B,SAGjBiV,SAAS,IAAMrkB,EAAOgO,QAAQiP,GAAK,aAG1Dm9B,EAAct5C,UAAU0tD,4BAA8B,WAClD,GAAIxuD,GAASC,KAAKD,OACdyqD,IAoBJ,OAnBAA,GAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,QAAS0tC,YAAa1qD,KAAK+oD,KAAK4B,YAAY,iBAAkBF,MAAO,SAC7GzM,SAAU,eAAiBj+C,EAAOgO,QAAQiP,GAAK,wBAEnDwtC,EAAavkD,MAAOwkD,MAAO,SAAU9jD,KAAM,cAC3C6jD,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,cAAewvC,WAAY,4BACnE9B,YAAa1qD,KAAK+oD,KAAK4B,YAAY,cAAeF,MAAO,WAC7DD,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,eAAgBwvC,WAAY,uBACpE9B,YAAa1qD,KAAK+oD,KAAK4B,YAAY,eAAgBF,MAAO,WAC9DD,EAAavkD,MAAOwkD,MAAO,SAAU9jD,KAAM,cAC3C6jD,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,kBAAmBwvC,WAAY,4BACvE9B,YAAa1qD,KAAK+oD,KAAK4B,YAAY,kBAAmBF,MAAO,WACjED,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,gBAAiBwvC,WAAY,0BACrE9B,YAAa1qD,KAAK+oD,KAAK4B,YAAY,gBAAiBF,MAAO,WAC1DxuC,UAAQC,WACTsuC,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,MAAOwvC,WAAY,kBAAmBtR,SAAU,kBACxFwP,YAAa1qD,KAAK+oD,KAAK4B,YAAY,MAAOF,MAAO,UACrDD,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,UAAWwvC,WAAY,kBAAmBtR,SAAU,kBAC5FwP,YAAa1qD,KAAK+oD,KAAK4B,YAAY,UAAWF,MAAO,WAEtDD,GAEXrQ,EAAct5C,UAAU2tD,qBAAuB,SAAUjO,GACrD,GAAIxgD,GAASC,KAAKD,OACdyqD,MACAvoD,oBAAkBlC,EAAOwiB,UAAaxiB,EAAe,UACrDyqD,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,cAAe0tC,YAAa1qD,KAAK+oD,KAAK4B,YAAY,cAAeF,MAAO,SAChHzM,SAAU,eAAiBj+C,EAAOgO,QAAQiP,GAAK,8BAEnDujC,EAAM/hC,QAAQ,cAAgB,GAC9BgsC,EAAavkD,MAAOumD,WAAY,iBAAkBxvC,GAAIjd,EAAOgO,QAAQiP,GAAK,aACtEk+B,SAAU,kBAAmBwP,YAAa1qD,KAAK+oD,KAAK4B,YAAY,aAAcF,MAAO,SAAU9jD,KAAM,QACrGq3C,SAAU,eAAiBj+C,EAAOgO,QAAQiP,GAAK,6BAEnDujC,EAAM/hC,QAAQ,gBAAkB,GAChCgsC,EAAavkD,MAAOumD,WAAY,iBAAkBxvC,GAAIjd,EAAOgO,QAAQiP,GAAK,eACtEk+B,SAAU,oBAAqBwP,YAAa1qD,KAAK+oD,KAAK4B,YAAY,eAAgBF,MAAO,SAAU9jD,KAAM,QACzGq3C,SAAU,eAAiBj+C,EAAOgO,QAAQiP,GAAK,+BAEnDujC,EAAM/hC,QAAQ,gBAAkB,GAChCgsC,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,eAAgBk+B,SAAU,kBAAmBwP,YAAa,eAAgBD,MAAO,SACzH9jD,KAAM,QAASq3C,SAAU,eAAiBj+C,EAAOgO,QAAQiP,GAAK,+BAElEujC,EAAM/hC,QAAQ,UAAY,GAC1BgsC,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,SAAUk+B,SAAU,kBAAmBwP,YAAa,QAASD,MAAO,SAC5G9jD,KAAM,QAASq3C,SAAU,eAAiBj+C,EAAOgO,QAAQiP,GAAK,yBAElEujC,EAAM/hC,QAAQ,QAAU,GACxBgsC,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,OAAQk+B,SAAU,kBAAmBwP,YAAa,MAAOD,MAAO,SACxG9jD,KAAM,QAASq3C,SAAU,eAAiBj+C,EAAOgO,QAAQiP,GAAK,uBAEtEwtC,EAAavkD,MAAOwkD,MAAO,SAAU9jD,KAAM,cACvC45C,EAAM/hC,QAAQ,cAAgB,GAC9BgsC,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,aAAcwvC,WAAY,kBAAmBtR,SAAU,mBAC/FwP,YAAa1qD,KAAK+oD,KAAK4B,YAAY,aAAcF,MAAO,WAE5DlK,EAAM/hC,QAAQ,WAAa,GAC3BgsC,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,UAAWwvC,WAAY,kBAAmBtR,SAAU,mBAC5FwP,YAAa1qD,KAAK+oD,KAAK4B,YAAY,UAAWF,MAAO,WAEzDlK,EAAM/hC,QAAQ,SAAW,GACzBgsC,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,YAAawvC,WAAY,4BAA6BtR,SAAU,6BACxGwP,YAAa1qD,KAAK+oD,KAAK4B,YAAY,YAAaF,MAAO,UAG/D,KAAK,GADDgC,GAAmBzsD,KAAKgtD,kBAAkBzM,GACrCv7C,EAAI,EAAGC,EAAMwnD,EAAiBtnD,OAAQH,EAAIC,EAAKD,IACpDwlD,EAAavkD,KAAKwmD,EAAiBznD,GAEvC,KAAKiX,UAAQC,SAAU,CACnB,GAAIjY,IAAQmB,MAAO,KACnBrF,GAAO+C,OAAO,aAAexB,KAAM,yBAA0BE,OAASyC,IAAKA,KACtD,SAAjBA,EAAW,QACXumD,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,MAAOwvC,WAAY,kBAAmBtR,SAAU,kBACxFwP,YAAa1qD,KAAK+oD,KAAK4B,YAAY,MAAOF,MAAO,UACrDD,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,UAAWwvC,WAAY,kBAAmBtR,SAAU,kBAC5FwP,YAAa1qD,KAAK+oD,KAAK4B,YAAY,UAAWF,MAAO,WAGjE,MAAOD,IAEXrQ,EAAct5C,UAAU4tD,yBAA2B,WAC/C,GAAIljD,GAAQvL,KACRD,EAASC,KAAKD,OACd2rD,EAAW1rD,KAAK2rD,qBAChBC,EAAY5rD,KAAK6rD,sBACjBC,EAAW9rD,KAAKuuD,8BAChBvC,EAAWhsD,KAAKisD,oBAChBhwC,WAAQC,SACRlc,KAAKwiB,gBAAkBspC,EAGvB9rD,KAAKwiB,gBAAkBkpC,EAAS9P,OAAOoQ,EAAUF,EAAUF,EAE/D,IAAIrpC,GAAU,GAAIm5B,YACdr7C,MAAO,OACPkgD,MAAOvgD,KAAKwiB,gBACZyc,QAASj/B,KAAKmrD,kBAAkBrnC,KAAK9jB,MACrCirD,QAAS,WACL1/C,EAAM8gD,gBACN9gD,EAAM4gD,oBACDlwC,UAAQC,UACT3Q,EAAM6gD,gBAEVrsD,EAAO0M,QAAQ,kBAAoBy+C,YAAa,WAC5CjvC,UAAQC,SACJ3Q,EAAMiX,gBAAgBrd,OAAS,GAAK4X,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,oBAEhFuF,EAAQwyB,kBACRxyB,EAAQwyB,kBACRxyB,EAAQwyB,oBAIZxpC,EAAM6/C,4BACF7/C,EAAMiX,gBAAgBrd,OAAS,GAAK4X,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,aAEhFuF,EAAQwyB,mBAGhBh1C,EAAOuR,OAAO,YAGlB2K,WAAQC,SACRqG,EAAQ6B,SAAS,IAAMrkB,EAAOgO,QAAQiP,GAAK,kBAG3CuF,EAAQ6B,SAAS,IAAMrkB,EAAOgO,QAAQiP,GAAK,YAE/Chd,KAAKqpD,sBACLtpD,EAAO+C,OAAO,aAAexB,KAAM,oBAAqBE,OAAS0/B,WAAW,MAEhFiZ,EAAct5C,UAAUitD,oBAAsB,SAAU1oD,GACpD,GAAIspD,GAAO,EACX,QAAQtpD,GACJ,IAAK,YACDspD,EAAO,aACP,MACJ,KAAK,UACDA,EAAO,UACP,MACJ,KAAK,OACDA,EAAO,QACP,MACJ,KAAK,QACDA,EAAO,kBACP,MACJ,KAAK,OACDA,EAAO,iBACP,MACJ,KAAK,OACDA,EAAO,YACP,MACJ,KAAK,MACDA,EAAO,YACP,MACJ,KAAK,cACDA,EAAO,UACP,MACJ,KAAK,cACDA,EAAO,UACP,MACJ,KAAK,cACDA,EAAO,UACP,MACJ,KAAK,WACDA,EAAO,YACP,MACJ,KAAK,WACDA,EAAO,YACP,MACJ,KAAK,WACDA,EAAO,YACP,MACJ,KAAK,WACDA,EAAO,YACP,MACJ,KAAK,YACDA,EAAO,YACP,MACJ,SACIA,EAAO,aAGf,MAAOA,IAEXvU,EAAct5C,UAAU8tD,sBAAwB,SAAUpO,GACtD,GAAIh1C,GAAQvL,KACRD,EAASC,KAAKD,OACd2rD,EAAW1rD,KAAK2rD,qBAChBC,EAAY5rD,KAAK6rD,sBACjBC,EAAW9rD,KAAKwuD,qBAAqBjO,GACrCyL,EAAWhsD,KAAKisD,oBAChBhwC,WAAQC,SACRlc,KAAKwiB,gBAAkBspC,EAGvB9rD,KAAKwiB,gBAAkBkpC,EAAS9P,OAAOoQ,EAAUF,EAAUF,EAE/D,IAAIrpC,GAAU,GAAIm5B,YACdr7C,MAAO,OACPkgD,MAAOvgD,KAAKwiB,gBACZyc,QAASj/B,KAAKmrD,kBAAkBrnC,KAAK9jB,MACrCirD,QAAS,WACL1/C,EAAM2gD,qBAAoB,GAC1B3gD,EAAMqjD,iBAAiBrO,GACvBh1C,EAAMsjD,eAAetO,GACU,UAA3BxgD,EAAO6C,UAAUwC,QACjBmG,EAAMujD,iBACNvjD,EAAMwjD,gBAEVxjD,EAAM4gD,oBACDlwC,UAAQC,UACT3Q,EAAM6gD,gBAEVrsD,EAAO0M,QAAQ,kBAAoBy+C,YAAa,WAC5CjvC,UAAQC,SACJ3Q,EAAMiX,gBAAgBrd,OAAS,GAAK4X,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,oBAEhFuF,EAAQwyB,kBACRxyB,EAAQwyB,kBACRxyB,EAAQwyB,oBAIZxpC,EAAM6/C,4BACF7/C,EAAMiX,gBAAgBrd,OAAS,GAAK4X,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,aAEhFuF,EAAQwyB,qBAKpB94B,WAAQC,SACRqG,EAAQ6B,SAAS,IAAMrkB,EAAOgO,QAAQiP,GAAK,kBAG3CuF,EAAQ6B,SAAS,IAAMrkB,EAAOgO,QAAQiP,GAAK,YAE/Chd,KAAKqpD,uBAETlP,EAAct5C,UAAU+tD,iBAAmB,SAAUrO,GACjD,GAAIxgD,GAASC,KAAKD,MAClB,IAAIwgD,EAAM/hC,QAAQ,cAAgB,EAAG,CACjCze,EAAOgO,QAAQoO,cAAc,sBAAsB+K,YAAYnnB,EAAO8nB,cAAc,SAChF7K,GAAIjd,EAAOgO,QAAQiP,GAAK,gBAE5B,IAAIhO,GAAY,GAAIggD,gBAChBC,cAAc,EAAOC,SAAS,EAAM1tD,MAAO,GAC3C2tD,aAAa,EAAOC,KAAM,UAAWlU,SAAU,qBAC/CmU,OAAQ,SAAUjuD,GACdrB,EAAOsiD,gBAAgBjhD,EAAKkuD,aAAalqB,KACV,KAA3BhkC,EAAKkuD,aAAaC,KAClBC,EAAUzhD,QAAQ0yC,SAAS,GAAGxjC,UAAUa,IAAI,mBAG5C0xC,EAAUzhD,QAAQ0yC,SAAS,GAAGxjC,UAAU+O,OAAO,kBAC/CwjC,EAAUzhD,QAAQ0yC,SAAS,GAAG5kC,MAAMkhC,gBAAkB37C,EAAKkuD,aAAaC,MAE5EC,EAAUC,WAEf,IAAM1vD,EAAOgO,QAAQiP,GAAK,eACzBwyC,EAAY,GAAIxB,mBAChBn8C,KAAM,SAAUzQ,GACR6a,UAAQC,WACR9a,EAAK2M,QAAQme,cAAcrQ,MAAM6K,IAAM8oC,EAAUzhD,QAAQ8hB,wBAAwBnJ,IAC7EtlB,EAAK2M,QAAQme,cAAc9P,aAAe,KAC9Chb,EAAK2M,QAAQme,cAAcrQ,MAAMZ,KAAOlb,EAAOgO,QAAQuyB,WAAa,OAG5E7c,OAAQ,sBACRS,QAAS,yBACV,IAAMnkB,EAAOgO,QAAQiP,GAAK,gBAC7BhO,GAAU0gD,QAAS,EACnB3vD,EAAOgO,QAAQoO,cAAc,6CAA6Cc,UAAUa,IAAI,kBAE5F,GAAIyiC,EAAM/hC,QAAQ,gBAAkB,EAAG,CACnCze,EAAOgO,QAAQoO,cAAc,wBAAwB+K,YAAYnnB,EAAO8nB,cAAc,SAClF7K,GAAIjd,EAAOgO,QAAQiP,GAAK,kBAE5B,IAAIjO,GAAc,GAAIigD,gBAClBC,cAAc,EAAOC,SAAS,EAAO1tD,MAAO,OAC5C2tD,aAAa,EAAOC,KAAM,UAAWlU,SAAU,uBAC/CmU,OAAQ,SAAUjuD,GACdrB,EAAOqiD,kBAAkBhhD,EAAKkuD,aAAalqB,KAC3CuqB,EAAY5hD,QAAQ0yC,SAAS,GAAG5kC,MAAMkhC,gBAAkB37C,EAAKkuD,aAAaC,KAC1EI,EAAYF,WAEjB,IAAM1vD,EAAOgO,QAAQiP,GAAK,iBACzB2yC,EAAc,GAAI3B,mBAClBn8C,KAAM,SAAUzQ,GACR6a,UAAQC,WACR9a,EAAK2M,QAAQme,cAAcrQ,MAAM6K,IAAMipC,EAAY5hD,QAAQ8hB,wBAAwBnJ,IAC/EtlB,EAAK2M,QAAQme,cAAc9P,aAAe,KAC9Chb,EAAK2M,QAAQme,cAAcrQ,MAAMZ,KAAOlb,EAAOgO,QAAQuyB,WAAa,OAG5E7c,OAAQ,wBACRS,QAAS,yBACV,IAAMnkB,EAAOgO,QAAQiP,GAAK,kBAC7BjO,GAAY2gD,QAAS,EACrB3vD,EAAOgO,QAAQoO,cAAc,+CAA+CN,MAAM+zC,WAAa,SAGvGzV,EAAct5C,UAAUguD,eAAiB,SAAUtO,GAC/C,GAAIxgD,GAASC,KAAKD,OACd8vD,IACE7yC,GAAI,IAAK7N,KAAMnP,KAAK+oD,KAAK4B,YAAY,YACrC3tC,GAAI,IAAK7N,KAAMnP,KAAK+oD,KAAK4B,YAAY,WACrC3tC,GAAI,IAAK7N,KAAMnP,KAAK+oD,KAAK4B,YAAY,YACrC3tC,GAAI,IAAK7N,KAAMnP,KAAK+oD,KAAK4B,YAAY,WACrC3tC,GAAI,IAAK7N,KAAMnP,KAAK+oD,KAAK4B,YAAY,WAE3C,IAAIpK,EAAM/hC,QAAQ,gBAAkB,EAAG,CACnC,GAAIsxC,GAAiB/yC,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,mBAC7D+yC,EAAahzC,SAAS8K,cAAc,OACxCkoC,GAAW5oC,UAAYnnB,KAAK+oD,KAAK4B,YAAY,UAC7CoF,EAAWjU,UAAY,uBACvBgU,EAAe5oC,YAAY6oC,EAE3B,IAAIC,GAAe,GAAIhC,mBAAiBzN,MAAOsP,EAC3Ch+C,KAAM,SAAUzQ,GACR6a,UAAQC,WACR9a,EAAK2M,QAAQme,cAAcrQ,MAAM6K,IAAMspC,EAAajiD,QAAQ8hB,wBAAwBnJ,IAChFtlB,EAAK2M,QAAQme,cAAc9P,aAAe,KAElD,IAAI6zC,GAAYF,EAAW5oC,SACT,MAAd8oC,GACA7uD,EAAK2M,QAAQoO,cAAc,kBAAyB8zC,EAAY,MAAWhzC,UAAUa,IAAI,mBAGjGxM,OAAQ,SAAUlQ,GACd2uD,EAAW1S,YAAcj8C,EAAKqsC,KAAKt+B,KACnCpP,EAAOoiD,kBAAkB/gD,EAAKqsC,KAAKzwB,IAC/Bf,UAAQC,SACJa,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,mBAE5BkG,eAAanjB,EAAOgO,QAAQiP,GAAK,iBAAkB,WACzD+3B,kBAIVh4B,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,aAE5BkG,eAAanjB,EAAOgO,QAAQiP,GAAK,WAAY,WACnD+3B,oBAM1Bib,GAAa5rC,SAAS,IAAMrkB,EAAOgO,QAAQiP,GAAK,qBAGxDm9B,EAAct5C,UAAUiuD,eAAiB,WACrC,GAAI/uD,GAASC,KAAKD,OACd8vD,IACE7yC,GAAI,IAAK7N,KAAMnP,KAAK+oD,KAAK4B,YAAY,UACrC3tC,GAAI,IAAK7N,KAAMnP,KAAK+oD,KAAK4B,YAAY,SACrC3tC,GAAI,IAAK7N,KAAMnP,KAAK+oD,KAAK4B,YAAY,WACrC3tC,GAAI,IAAK7N,KAAMnP,KAAK+oD,KAAK4B,YAAY,gBACrC3tC,GAAI,IAAK7N,KAAMnP,KAAK+oD,KAAK4B,YAAY,YACrC3tC,GAAI,IAAK7N,KAAMnP,KAAK+oD,KAAK4B,YAAY,iBACrC3tC,GAAI,IAAK7N,KAAMnP,KAAK+oD,KAAK4B,YAAY,YACrC3tC,GAAI,IAAK7N,KAAMnP,KAAK+oD,KAAK4B,YAAY,iBAEvCmF,EAAiB/yC,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,aAC7DkzC,EAAWnzC,SAAS8K,cAAc,OAClC5lB,qBAAkBlC,EAAO6C,UAAU2T,SACnCxW,EAAO6C,UAAU2T,MAAQ,QAE7B25C,EAAS/oC,UAAYpnB,EAAOuiD,mBAAmBviD,EAAO6C,UAAU2T,OAChE25C,EAASpU,UAAY,gBACrBgU,EAAe5oC,YAAYgpC,EAE3B,IAAInC,GAAa,GAAIC,mBAAiBzN,MAAOsP,EACzCh+C,KAAM,SAAUzQ,GACR6a,UAAQC,WACR9a,EAAK2M,QAAQme,cAAcrQ,MAAM6K,IAAMqnC,EAAWhgD,QAAQ8hB,wBAAwBnJ,IAC9EtlB,EAAK2M,QAAQme,cAAc9P,aAAe,KAElD,IAAI6zC,GAAYC,EAAS/oC,SACP,MAAd8oC,GACA7uD,EAAK2M,QAAQoO,cAAc,kBAAyB8zC,EAAY,MAAWhzC,UAAUa,IAAI,mBAGjGxM,OAAQ,SAAUlQ,GACd8uD,EAAS7S,YAAcj8C,EAAKqsC,KAAKt+B,KACjCpP,EAAO4hD,YAAY,aAAcvgD,EAAKqsC,KAAKzwB,MAInD+wC,GAAW3pC,SAAS,IAAMrkB,EAAOgO,QAAQiP,GAAK,cAElDm9B,EAAct5C,UAAUkuD,aAAe,WACnC,GAAIhvD,GAASC,KAAKD,OACd8vD,IACE7yC,GAAI,IAAK7N,KAAMnP,KAAK+oD,KAAK4B,YAAY,UACrC3tC,GAAI,IAAK7N,KAAMnP,KAAK+oD,KAAK4B,YAAY,SACrC3tC,GAAI,IAAK7N,KAAMnP,KAAK+oD,KAAK4B,YAAY,WACrC3tC,GAAI,IAAK7N,KAAMnP,KAAK+oD,KAAK4B,YAAY,gBACrC3tC,GAAI,IAAK7N,KAAMnP,KAAK+oD,KAAK4B,YAAY,YACrC3tC,GAAI,IAAK7N,KAAMnP,KAAK+oD,KAAK4B,YAAY,iBACrC3tC,GAAI,IAAK7N,KAAMnP,KAAK+oD,KAAK4B,YAAY,YACrC3tC,GAAI,IAAK7N,KAAMnP,KAAK+oD,KAAK4B,YAAY,iBAEvCwF,EAAepzC,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,WAC3DkzC,EAAWnzC,SAAS8K,cAAc,OAClC5lB,qBAAkBlC,EAAO6C,UAAU4T,OACnCzW,EAAO6C,UAAU4T,IAAM,cAE3B05C,EAAS/oC,UAAYpnB,EAAOuiD,mBAAmBviD,EAAO6C,UAAU4T,KAChE05C,EAASpU,UAAY,cACrBqU,EAAajpC,YAAYgpC,EAEzB,IAAInC,GAAa,GAAIC,mBAAiBzN,MAAOsP,EACzCh+C,KAAM,SAAUzQ,GACR6a,UAAQC,WACR9a,EAAK2M,QAAQme,cAAcrQ,MAAM6K,IAAMqnC,EAAWhgD,QAAQ8hB,wBAAwBnJ,IAC9EtlB,EAAK2M,QAAQme,cAAc9P,aAAe,KAElD,IAAI6zC,GAAYC,EAAS/oC,SACP,MAAd8oC,GACA7uD,EAAK2M,QAAQoO,cAAc,kBAAyB8zC,EAAY,MAAWhzC,UAAUa,IAAI,mBAGjGxM,OAAQ,SAAUlQ,GACd8uD,EAAS7S,YAAcj8C,EAAKqsC,KAAKt+B,KACjCpP,EAAO4hD,YAAY,WAAYvgD,EAAKqsC,KAAKzwB,MAIjD+wC,GAAW3pC,SAAS,IAAMrkB,EAAOgO,QAAQiP,GAAK,YAElDm9B,EAAct5C,UAAUuvD,mBAAqB,SAAU7P,GACnD,GAAIxgD,GAASC,KAAKD,OACdyqD,MACAvoD,oBAAkBlC,EAAOwiB,UAAaxiB,EAAe,UACrDyqD,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,cAAe0tC,YAAa1qD,KAAK+oD,KAAK4B,YAAY,cAAeF,MAAO,SAChHzM,SAAU,eAAiBj+C,EAAOgO,QAAQiP,GAAK,8BAEnDujC,EAAM/hC,QAAQ,eAAiB,GAC/BgsC,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,cAAek+B,SAAU,6BACjEwP,YAAa1qD,KAAK+oD,KAAK4B,YAAY,cAAeF,MAAO,SACzDzM,SAAU,eAAiBj+C,EAAOgO,QAAQiP,GAAK,8BAEnDujC,EAAM/hC,QAAQ,aAAe,GAC7BgsC,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,YAAak+B,SAAU,2BAC/DwP,YAAa1qD,KAAK+oD,KAAK4B,YAAY,YAAaF,MAAO,SACvDzM,SAAU,eAAiBj+C,EAAOgO,QAAQiP,GAAK,4BAEnDujC,EAAM/hC,QAAQ,cAAgB,GAC9BgsC,EAAavkD,MAAOi1C,SAAU,6BAA8Bl+B,GAAIjd,EAAOgO,QAAQiP,GAAK,oBAChF0tC,YAAa1qD,KAAK+oD,KAAK4B,YAAY,aAAcF,MAAO,SACxD9jD,KAAM,QAASq3C,SAAU,eAAiBj+C,EAAOgO,QAAQiP,GAAK,6BAElEujC,EAAM/hC,QAAQ,SAAW,GACzBgsC,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,QAASwvC,WAAY,iBAAkBtR,SAAU,kBACzFwP,YAAa1qD,KAAK+oD,KAAK4B,YAAY,QAASF,MAAO,WAEvDlK,EAAM/hC,QAAQ,WAAa,GAC3BgsC,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,UAAWwvC,WAAY,mBAAoBtR,SAAU,oBAC7FwP,YAAa1qD,KAAK+oD,KAAK4B,YAAY,UAAWF,MAAO,WAE7DD,EAAavkD,MAAOwkD,MAAO,SAAU9jD,KAAM,cACvC45C,EAAM/hC,QAAQ,cAAgB,GAC9BgsC,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,aAAcwvC,WAAY,kBAAmBtR,SAAU,mBAC/FwP,YAAa1qD,KAAK+oD,KAAK4B,YAAY,aAAcF,MAAO,WAE5DlK,EAAM/hC,QAAQ,WAAa,GAC3BgsC,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,UAAWwvC,WAAY,kBAAmBtR,SAAU,mBAC5FwP,YAAa1qD,KAAK+oD,KAAK4B,YAAY,UAAWF,MAAO,WAEzDlK,EAAM/hC,QAAQ,SAAW,GACzBgsC,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,YAAawvC,WAAY,4BAA6BtR,SAAU,6BACxGwP,YAAa1qD,KAAK+oD,KAAK4B,YAAY,YAAaF,MAAO,UAG/D,KAAK,GADDgC,GAAmBzsD,KAAKgtD,kBAAkBzM,GACrCv7C,EAAI,EAAGC,EAAMwnD,EAAiBtnD,OAAQH,EAAIC,EAAKD,IACpDwlD,EAAavkD,KAAKwmD,EAAiBznD,GAQvC,OANKiX,WAAQC,WACTsuC,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,MAAOwvC,WAAY,kBAAmBtR,SAAU,kBACxFwP,YAAa1qD,KAAK+oD,KAAK4B,YAAY,MAAOF,MAAO,UACrDD,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,UAAWwvC,WAAY,kBAAmBtR,SAAU,kBAC5FwP,YAAa1qD,KAAK+oD,KAAK4B,YAAY,UAAWF,MAAO,WAEtDD,GAEXrQ,EAAct5C,UAAUwvD,mBAAqB,WACzC,MAAIp0C,WAAQC,WACEc,GAAI,QAAS7N,KAAM,QAAW6N,GAAI,UAAW7N,KAAM,QAAW6N,GAAI,UAAW7N,KAAM,QACvF6N,GAAI,SAAU7N,KAAM,QAAW6N,GAAI,SAAU7N,KAAM,UAEnD6N,GAAI,QAAS7N,KAAM,UAAa6N,GAAI,UAAW7N,KAAM,YAAe6N,GAAI,UAAW7N,KAAM,YAC7F6N,GAAI,SAAU7N,KAAM,WAAc6N,GAAI,SAAU7N,KAAM,YAEhEgrC,EAAct5C,UAAUyvD,oBAAsB,SAAU/P,GACpD,GAAIh1C,GAAQvL,KACRD,EAASC,KAAKD,OACd2rD,EAAW1rD,KAAK2rD,qBAChBC,EAAY5rD,KAAK6rD,sBACjBC,EAAW9rD,KAAKowD,mBAAmB7P,GACnCyL,EAAWhsD,KAAKisD,oBAChBhwC,WAAQC,SACRlc,KAAKwiB,gBAAkBspC,EAGvB9rD,KAAKwiB,gBAAkBkpC,EAAS9P,OAAOoQ,EAAUF,EAAUF,EAE/D,IAAIrpC,GAAU,GAAIm5B,YACdr7C,MAAO,OACPkgD,MAAOvgD,KAAKwiB,gBACZyc,QAASj/B,KAAKmrD,kBAAkBrnC,KAAK9jB,MACrCirD,QAAS,WACL1/C,EAAM2gD,qBAAoB,GAC1B3gD,EAAMglD,gBAAgBhQ,GACtBh1C,EAAMilD,cAAcjQ,GACpBh1C,EAAM4gD,oBACDlwC,UAAQC,UACT3Q,EAAM6gD,gBAEVrsD,EAAO0M,QAAQ,kBAAoBy+C,YAAa,SAC5CjvC,UAAQC,SACJ3Q,EAAMiX,gBAAgBrd,OAAS,GAAK4X,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,oBAEhFuF,EAAQwyB,kBACRxyB,EAAQwyB,kBACRxyB,EAAQwyB,oBAIZxpC,EAAM6/C,4BACF7/C,EAAMiX,gBAAgBrd,OAAS,GAAK4X,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,aAEhFuF,EAAQwyB,qBAKpB94B,WAAQC,SACRqG,EAAQ6B,SAAS,IAAMrkB,EAAOgO,QAAQiP,GAAK,kBAG3CuF,EAAQ6B,SAAS,IAAMrkB,EAAOgO,QAAQiP,GAAK,YAE/Chd,KAAKqpD,uBAETlP,EAAct5C,UAAU0vD,gBAAkB,SAAUhQ,GAChD,GAAIxgD,GAASC,KAAKD,MAClB,IAAIwgD,EAAM/hC,QAAQ,cAAgB,GAAKze,EAAOgO,QAAQoO,cAAc,iCAAkC,CAClGpc,EAAOgO,QAAQoO,cAAc,iCAAiC+K,YAAYnnB,EAAO8nB,cAAc,SAC3F7K,GAAIjd,EAAOgO,QAAQiP,GAAK,eAE5B,IAAIyzC,GAAY,GAAIzB,gBAChBC,cAAc,EAAOztD,MAAO,OAC5B2tD,aAAa,EAAOC,KAAM,UAAWlU,SAAU,qBAC/CmU,OAAQ,SAAUjuD,GACdrB,EAAOiiD,gBAAgB5gD,EAAKkuD,aAAalqB,KACzCsrB,EAAY3iD,QAAQ0yC,SAAS,GAAG5kC,MAAMkhC,gBAAkB37C,EAAKkuD,aAAaC,KAC1EmB,EAAYjB,WAEjB,IAAM1vD,EAAOgO,QAAQiP,GAAK,cACzB0zC,EAAc,GAAI1C,mBAClBn8C,KAAM,SAAUzQ,GACR6a,UAAQC,WACR9a,EAAK2M,QAAQme,cAAcrQ,MAAM6K,IAAMgqC,EAAY3iD,QAAQ8hB,wBAAwBnJ,IAC/EtlB,EAAK2M,QAAQme,cAAc9P,aAAe,KAC9Chb,EAAK2M,QAAQme,cAAcrQ,MAAMZ,KAAOlb,EAAOgO,QAAQuyB,WAAa,OAG5E7c,OAAQ,sBACRS,QAAS,yBACV,IAAMnkB,EAAOgO,QAAQiP,GAAK,gBAC7ByzC,GAAUf,QAAS,EACnB3vD,EAAOgO,QAAQoO,cAAc,wDAAwDN,MAAM+zC,WACrF,SAGdzV,EAAct5C,UAAU2vD,cAAgB,SAAUjQ,GAC9C,GAAIxgD,GAASC,KAAKD,MAClB,IAAIwgD,EAAM/hC,QAAQ,eAAiB,EAAG,CAClC,GAAImyC,GAAc5zC,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,kBAC1D4zC,EAAa7zC,SAAS8K,cAAc,OACpC5L,WAAQC,UACR00C,EAAWzpC,UAAY,MACvBypC,EAAWh0C,aAAa,QAAS,uBAGjCg0C,EAAWzpC,UAAY,QAE3BypC,EAAW9U,UAAY,qBACnB6U,GACAA,EAAYzpC,YAAY0pC,EAE5B,IAAIC,GAAkB,GAAI7C,mBAAiBzN,MAAOvgD,KAAKqwD,qBACnDnV,SAAU,gBACV4V,oBAAoB,EACpBC,iBAAkB,SAAU3vD,GACxBA,EAAK2M,QAAQ6O,aAAa,QAAS,eAAiBxb,EAAK2M,QAAQiP,KAErEnL,KAAM,SAAUzQ,GACR6a,UAAQC,WACR9a,EAAK2M,QAAQme,cAAcrQ,MAAM6K,IAAMmqC,EAAgB9iD,QAAQ8hB,wBAAwBnJ,IACnFtlB,EAAK2M,QAAQme,cAAc9P,aAAe,KAElD,IAAIhN,EAEAA,GADkC,UAAlCrP,EAAO+c,SAASjB,MAAMG,QACTjc,EAAO+c,SAASjB,MAAMzM,WAGtBrP,EAAO6C,UAAUyF,aAAa+G,WAE/ChO,EAAK2M,QAAQoO,cAAc,WAAkB/M,EAAWwD,cAClD,MAAWqK,UAAUa,IAAI,mBAEnCxM,OAAQ,SAAUlQ,GACdwvD,EAAWvT,YAAcj8C,EAAKqsC,KAAKt+B,KAC/B8M,UAAQC,UACR00C,EAAWh0C,aAAa,QAAS,eAAiBxb,EAAKqsC,KAAKzwB,IAEhEjd,EAAO6hD,iBAAiBxgD,EAAKqsC,KAAKzwB,MAG1C6zC,GAAgBzsC,SAAS,IAAMrkB,EAAOgO,QAAQiP,GAAK,kBAEvD,GAAIujC,EAAM/hC,QAAQ,aAAe,EAAG,CAChC,GAAIwyC,GAAkBj0C,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,gBAC9Di0C,EAAqBl0C,SAAS8K,cAAc,QAC5CqpC,EAAYnxD,EAAOugD,cACvB2Q,GAAmB9pC,UAAY+pC,EAAU,GAAG/hD,KAC5C8hD,EAAmBnV,UAAY,mBAC/BkV,EAAgB9pC,YAAY+pC,EAC5B,IAAIE,GAAgB,GAAInD,mBACpB9S,SAAU,cACVqF,MAAO2Q,EACPr/C,KAAM,SAAUzQ,GACR6a,UAAQC,WACR9a,EAAK2M,QAAQme,cAAcrQ,MAAM6K,IAAMyqC,EAAcpjD,QAAQ8hB,wBAAwBnJ,IACjFtlB,EAAK2M,QAAQme,cAAc9P,aAAe,KAElD,IAAI6zC,GAAYgB,EAAmB9pC,SACnC/lB,GAAK2M,QAAQoO,cAAc,mBAA0B8zC,EAAY,MAAWhzC,UAAUa,IAAI,mBAE9FxM,OAAQ,SAAUlQ,GACd6vD,EAAmB5T,YAAcj8C,EAAKqsC,KAAKt+B,KAC3CpP,EAAOmoC,eAAe9mC,EAAKqsC,KAAKt+B,QAGxCgiD,GAAc/sC,SAAS,IAAMrkB,EAAOgO,QAAQiP,GAAK,kBAGzDm9B,EAAct5C,UAAU61C,eAAiB,SAAU/vC,EAAM8C,EAAYC,EAAYC,EAAWC,GACxF,GAAI7J,GAASC,KAAKD,MAClB,IAAKA,EAAO0L,gBAAiB1L,EAAO4L,cAApC,CAGA,GACIvK,IAAS8pD,YADO,WAATvkD,GAAqB5G,EAAO6C,UAAUwC,MAAQrF,EAAO6C,UAAUwC,MAAQuB,EAgBlF,QAda,WAATA,GAA8B,UAATA,IACjBoW,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,aAAehd,KAAKwiB,gBAAgBrd,OAAS,IACzF+d,eAAanG,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,YAAa,WAAWlc,UACjFic,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,YAAYmK,UAAY,IAEpEpK,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,mBAAqBhd,KAAKwiB,gBAAgBrd,OAAS,GAC3F4X,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,kBAAkB8+B,UAAUt9B,QAAQ,cAAgB,IAChG0E,eAAanG,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,kBAAmB,WAAWlc,UACvFic,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,kBAAkBmK,UAAY,KAItFnnB,KAAKoqD,gBACLrqD,EAAOqe,WAAY,EACXzX,GACJ,IAAK,OACGsV,UAAQC,SACJxS,EACA1J,KAAKspD,iBAAgB,GAAO,GAAM,GAGlCtpD,KAAKspD,iBAAgB,GAAO,EAAM,MAGhCrtC,UAAQC,WAAYvS,GAEtB3J,KAAKspD,gBAAgB7/C,EAAYwS,UAAQC,SAAU,MAMvDD,UAAQC,UACRlc,KAAKurD,mBAET,MACJ,KAAK,SACGtvC,UAAQC,UACRlc,KAAKspD,iBAAgB,GAAO,GAAM,GAEP,SAA3BvpD,EAAO6C,UAAUwC,OAA+C,SAA3BrF,EAAO6C,UAAUwC,MACtDhE,EAAKopD,cAAgB,cAAe,cAAe,YAAa,UAEhC,UAA3BzqD,EAAO6C,UAAUwC,MACtBhE,EAAKopD,cAAgB,cAAe,cAAe,QAAS,MAAO,YAAa,UAGhFppD,EAAKopD,cAAgB,YAAa,cAAe,cAAe,YAAa,UAEjFzqD,EAAO0M,QAAQ,kBAAmBrL,GAClCpB,KAAK2uD,sBAAsBvtD,EAAKopD,aAChC,MACJ,KAAK,OACGvuC,UAAQC,UACRlc,KAAKspD,iBAAgB,GAAO,GAAM,GAEtCloD,EAAKopD,cAAgB,aAAc,WAAY,YAAa,OAAQ,SAAU,YAAa,SAAU,QACrGzqD,EAAO0M,QAAQ,kBAAmBrL,GAClCpB,KAAKswD,oBAAoBlvD,EAAKopD,aAC9B,MACJ,KAAK,MACGvuC,UAAQC,UACRlc,KAAKspD,iBAAgB,GAAO,GAAM,GAEtCloD,EAAKopD,cAAgB,cAAe,cAAe,UACnDzqD,EAAO0M,QAAQ,kBAAmBrL,GAClCpB,KAAKoxD,mBAAmBhwD,EAAKopD,aAC7B,MACJ,KAAK,aACGvuC,UAAQC,UACRlc,KAAKspD,iBAAgB,GAAO,GAAM,GAEtCtpD,KAAKqxD,2BACL,MACJ,KAAK,SACDrxD,KAAK2sD,wBAAwBhmD,EAC7B,MACJ,KAAK,QACD3G,KAAK2sD,wBAAwBhmD,EAAMiD,EACnC,MACJ,KAAK,gBACD7J,EAAOqe,WAAY,EACfnC,UAAQC,UACRlc,KAAKspD,iBAAgB,GAAO,GAAM,GAEtCvpD,EAAOw3C,2BACPv3C,KAAKyuD,2BAGbzuD,KAAK2kD,YAAch+C,EACnB3G,KAAK4pD,mBAAmBlgD,KAE5BywC,EAAct5C,UAAUywD,yBAA2B,WAC/C,GAAI9G,MACAzqD,EAASC,KAAKD,QACdkC,oBAAkBlC,EAAOwiB,UAAaxiB,EAAOwiB,SAAWxiB,EAAOwiB,QAAQ/D,QAAQ,eAAiB,IAChGgsC,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,cAAewvC,WAAY,uBAAwBtR,SAAU,wBACrGwP,YAAa1qD,KAAK+oD,KAAK4B,YAAY,cAAeF,MAAO,YAE7DxoD,oBAAkBlC,EAAOwiB,UAAaxiB,EAAOwiB,SAAWxiB,EAAOwiB,QAAQ/D,QAAQ,aAAe,IAC9FgsC,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,YAAawvC,WAAY,qBAAsBtR,SAAU,sBACjGwP,YAAa1qD,KAAK+oD,KAAK4B,YAAY,YAAaF,MAAO,YAE3DxoD,oBAAkBlC,EAAOwiB,UAAaxiB,EAAOwiB,SAAWxiB,EAAOwiB,QAAQ/D,QAAQ,QAAU,IACzFgsC,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,OAAQwvC,WAAY,iBAAkBtR,SAAU,kBACxFwP,YAAa1qD,KAAK+oD,KAAK4B,YAAY,OAAQF,MAAO,YAEtDxoD,oBAAkBlC,EAAOwiB,UAAaxiB,EAAOwiB,SAAWxiB,EAAOwiB,QAAQ/D,QAAQ,eAAiB,IAChGgsC,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,cAAewvC,WAAY,uBAAwBtR,SAAU,wBACrGwP,YAAa1qD,KAAK+oD,KAAK4B,YAAY,cAAeF,MAAO,YAE7DxoD,oBAAkBlC,EAAOwiB,UAAaxiB,EAAOwiB,SAAWxiB,EAAOwiB,QAAQ/D,QAAQ,aAAe,IAC9FgsC,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,YAAawvC,WAAY,kBAAmBtR,SAAU,mBAC9FwP,YAAa1qD,KAAK+oD,KAAK4B,YAAY,YAAaF,MAAO,YAE3DxoD,oBAAkBlC,EAAOwiB,UAAaxiB,EAAOwiB,SAAWxiB,EAAOwiB,QAAQ/D,QAAQ,YAAc,IAC7FgsC,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,WAAYwvC,WAAY,oBAAqBtR,SAAU,qBAC/FwP,YAAa1qD,KAAK+oD,KAAK4B,YAAY,WAAYF,MAAO,YAE1DxoD,oBAAkBlC,EAAOwiB,UAAaxiB,EAAOwiB,SAAWxiB,EAAOwiB,QAAQ/D,QAAQ,SAAW,IAC1FgsC,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,QAASwvC,WAAY,iBAAkBtR,SAAU,kBACzFwP,YAAa1qD,KAAK+oD,KAAK4B,YAAY,QAASF,MAAO,UAG3D,KAAK,GADDgC,GAAmBzsD,KAAK0sD,eAAe,UAClC1nD,EAAI,EAAGC,EAAMwnD,EAAiBtnD,OAAQH,EAAIC,EAAKD,IACpDwlD,EAAavkD,KAAKwmD,EAAiBznD,GAQvC,OANKiX,WAAQC,WACTsuC,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,MAAOwvC,WAAY,kBAAmBtR,SAAU,kBACxFwP,YAAa1qD,KAAK+oD,KAAK4B,YAAY,MAAOF,MAAO,UACrDD,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,UAAWwvC,WAAY,kBAAmBtR,SAAU,kBAC5FwP,YAAa1qD,KAAK+oD,KAAK4B,YAAY,UAAWF,MAAO,WAEtDD,GAEXrQ,EAAct5C,UAAU0wD,qBAAuB,WAC3C,GAAI/G,MACAzqD,EAASC,KAAKD,QACdkC,oBAAkBlC,EAAOwiB,UAAaxiB,EAAOwiB,SAAWxiB,EAAOwiB,QAAQ/D,QAAQ,YAAc,IAC7FgsC,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,WAAYwvC,WAAY,iBAAkBtR,SAAU,kBAC5FwP,YAAa1qD,KAAK+oD,KAAK4B,YAAY,WAAYF,MAAO,SACtDzM,SAAU,2EAA6Ej+C,EAAOgO,QAAQiP,GAAK,iEAAwEhd,KAAK+oD,KAAK4B,YAAY,WAAa,yBAE1N1oD,oBAAkBlC,EAAOwiB,UAAaxiB,EAAOwiB,SAAWxiB,EAAOwiB,QAAQ/D,QAAQ,WAAa,IAC5FgsC,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,UAAWwvC,WAAY,iBAAkBtR,SAAU,kBAC3FwP,YAAa1qD,KAAK+oD,KAAK4B,YAAY,UAAWF,MAAO,SACrDzM,SAAU,2EAA6Ej+C,EAAOgO,QAAQiP,GAAK,gEAAuEhd,KAAK+oD,KAAK4B,YAAY,UAAY,yBAExN1oD,oBAAkBlC,EAAOwiB,UAAaxiB,EAAOwiB,SAAWxiB,EAAOwiB,QAAQ/D,QAAQ,SAAW,IAC1FgsC,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,QAASwvC,WAAY,iBAAkBtR,SAAU,kBACzFwP,YAAa1qD,KAAK+oD,KAAK4B,YAAY,QAASF,MAAO,SACnDzM,SAAU,2EAA6Ej+C,EAAOgO,QAAQiP,GAAK,8DAAqEhd,KAAK+oD,KAAK4B,YAAY,QAAU,yBAEpN1oD,oBAAkBlC,EAAOwiB,UAAaxiB,EAAOwiB,SAAWxiB,EAAOwiB,QAAQ/D,QAAQ,SAAW,IAC1FgsC,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,QAASwvC,WAAY,iBAAkBtR,SAAU,kBACzFwP,YAAa1qD,KAAK+oD,KAAK4B,YAAY,QAASF,MAAO,SACnDzM,SAAU,2EAA6Ej+C,EAAOgO,QAAQiP,GAAK,8DAAqEhd,KAAK+oD,KAAK4B,YAAY,QAAU,yBAEpN1oD,oBAAkBlC,EAAOwiB,UAAaxiB,EAAOwiB,SAAWxiB,EAAOwiB,QAAQ/D,QAAQ,cAAgB,IAC/FgsC,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,aAAcwvC,WAAY,iBAAkBtR,SAAU,kBAC9FwP,YAAa1qD,KAAK+oD,KAAK4B,YAAY,aAAcF,MAAO,SACxDzM,SAAU,2EAA6Ej+C,EAAOgO,QAAQiP,GAAK,mEAA0Ehd,KAAK+oD,KAAK4B,YAAY,aAAe,yBAE9N1oD,oBAAkBlC,EAAOwiB,UAAaxiB,EAAOwiB,SAAWxiB,EAAOwiB,QAAQ/D,QAAQ,UAAY,IAC3FgsC,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,SAAUwvC,WAAY,iBAAkBtR,SAAU,kBAC1FwP,YAAa1qD,KAAK+oD,KAAK4B,YAAY,SAAUF,MAAO,SACpDzM,SAAU,2EAA6Ej+C,EAAOgO,QAAQiP,GAAK,+DAAsEhd,KAAK+oD,KAAK4B,YAAY,SAAW,yBAEtN1oD,oBAAkBlC,EAAOwiB,UAAaxiB,EAAOwiB,SAAWxiB,EAAOwiB,QAAQ/D,QAAQ,WAAa,IAC5FgsC,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,UAAWwvC,WAAY,iBAAkBtR,SAAU,kBAC3FwP,YAAa1qD,KAAK+oD,KAAK4B,YAAY,UAAWF,MAAO,SACrDzM,SAAU,2EAA6Ej+C,EAAOgO,QAAQiP,GAAK,gEAAuEhd,KAAK+oD,KAAK4B,YAAY,UAAY,uBAG5N,KAAK,GADD8B,GAAmBzsD,KAAK0sD,eAAe,UAClC1nD,EAAI,EAAGC,EAAMwnD,EAAiBtnD,OAAQH,EAAIC,EAAKD,IACpDwlD,EAAavkD,KAAKwmD,EAAiBznD,GAEvC,OAAOwlD,IAEXrQ,EAAct5C,UAAU2wD,kBAAoB,SAAUjR,GAClD,GAAIxgD,GAASC,KAAKD,OACdyqD,MACAvoD,oBAAkBlC,EAAOwiB,UAAYxiB,EAAOwiB,UAC5CioC,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,cAAe0tC,YAAa1qD,KAAK+oD,KAAK4B,YAAY,cAAeF,MAAO,SAChHzM,SAAU,eAAiBj+C,EAAOgO,QAAQiP,GAAK,8BAEnDujC,EAAM/hC,QAAQ,gBAAkB,GAChCgsC,EAAavkD,MAAOumD,WAAY,iBAAkBxvC,GAAIjd,EAAOgO,QAAQiP,GAAK,mBACtEk+B,SAAU,8BACVwP,YAAa1qD,KAAK+oD,KAAK4B,YAAY,eAAgBF,MAAO,SAAU9jD,KAAM,QAC1Eq3C,SAAU,eAAiBj+C,EAAOgO,QAAQiP,GAAK,4BAEnDujC,EAAM/hC,QAAQ,gBAAkB,GAChCgsC,EAAavkD,MAAOumD,WAAY,iBAAkBtR,SAAU,kBACxDwP,YAAa1qD,KAAK+oD,KAAK4B,YAAY,eACnCF,MAAO,SAAU9jD,KAAM,QAASq3C,SAAU,eAAiBj+C,EAAOgO,QAAQiP,GAAK,+BAEvFwtC,EAAavkD,MAAOwkD,MAAO,SAAU9jD,KAAM,cACvC45C,EAAM/hC,QAAQ,WAAa,GAC3BgsC,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,UAAWwvC,WAAY,kBAAmBtR,SAAU,mBAC5FwP,YAAa1qD,KAAK+oD,KAAK4B,YAAY,UAAWF,MAAO,UAG7D,KAAK,GADDgC,GAAmBzsD,KAAKgtD,kBAAkBzM,GACrCv7C,EAAI,EAAGC,EAAMwnD,EAAiBtnD,OAAQH,EAAIC,EAAKD,IACpDwlD,EAAavkD,KAAKwmD,EAAiBznD,GAQvC,OANKiX,WAAQC,WACTsuC,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,MAAOwvC,WAAY,kBAAmBtR,SAAU,kBACxFwP,YAAa1qD,KAAK+oD,KAAK4B,YAAY,MAAOF,MAAO,UACrDD,EAAavkD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,UAAWwvC,WAAY,kBAAmBtR,SAAU,kBAC5FwP,YAAa1qD,KAAK+oD,KAAK4B,YAAY,UAAWF,MAAO,WAEtDD,GAEXrQ,EAAct5C,UAAUuwD,mBAAqB,SAAU7Q,GACnD,GAAIh1C,GAAQvL,KACRD,EAASC,KAAKD,OACd2rD,EAAW1rD,KAAK2rD,qBAChBC,EAAY5rD,KAAK6rD,sBACjBC,EAAW9rD,KAAKwxD,kBAAkBjR,GAClCyL,EAAWhsD,KAAKisD,oBAChBhwC,WAAQC,SACRlc,KAAKwiB,gBAAkBspC,EAGvB9rD,KAAKwiB,gBAAkBkpC,EAAS9P,OAAOoQ,EAAUF,EAAUF,EAE/D,IAAIrpC,GAAU,GAAIm5B,YACdr7C,MAAO,OACPkgD,MAAOvgD,KAAKwiB,gBACZyc,QAASj/B,KAAKmrD,kBAAkBrnC,KAAK9jB,MACrCirD,QAAS,WACL1/C,EAAM2gD,qBAAoB,GAC1B3gD,EAAMkmD,eAAelR,GACrBh1C,EAAMmmD,aAAanR,GACnBh1C,EAAM4gD,oBACDlwC,UAAQC,UACT3Q,EAAM6gD,gBAEVrsD,EAAO0M,QAAQ,kBAAoBy+C,YAAa,QAC5CjvC,UAAQC,SACJ3Q,EAAMiX,gBAAgBrd,OAAS,GAAK4X,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,cAEhFuF,EAAQwyB,kBACRxyB,EAAQwyB,oBAIZxpC,EAAM6/C,4BACF7/C,EAAMiX,gBAAgBrd,OAAS,GAAK4X,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,aAEhFuF,EAAQwyB,qBAKpB94B,WAAQC,SACRqG,EAAQ6B,SAAS,IAAMrkB,EAAOgO,QAAQiP,GAAK,kBAG3CuF,EAAQ6B,SAAS,IAAMrkB,EAAOgO,QAAQiP,GAAK,YAE/Chd,KAAKqpD,uBAETlP,EAAct5C,UAAU4wD,eAAiB,SAAUlR,GAC/C,GAAIh1C,GAAQvL,KACRD,EAASC,KAAKD,MAClB,IAAIwgD,EAAM/hC,QAAQ,gBAAkB,EAAG,CACnCze,EAAOgO,QAAQoO,cAAc,kCAAkC+K,YAAYnnB,EAAO8nB,cAAc,SAC5F7K,GAAIjd,EAAOgO,QAAQiP,GAAK,gBAE5B,IAAI20C,GAAW,GAAI3C,gBACfC,cAAc,EAAOztD,MAAO,OAC5B2tD,aAAa,EAAOC,KAAM,UAAWlU,SAAU,cAC/CmU,OAAQ,SAAUjuD,GACdrB,EAAOmiD,qBAAqB9gD,EAAKkuD,aAAalqB,KAC9C75B,EAAMu5C,YAAc1jD,EAAKkuD,aAAalqB,IACtCwsB,EAAY7jD,QAAQ0yC,SAAS,GAAG5kC,MAAMkhC,gBAAkB37C,EAAKkuD,aAAaC,KAC1EqC,EAAYnC,WAEjB,IAAM1vD,EAAOgO,QAAQiP,GAAK,eACzB40C,EAAc,GAAI5D,mBAClBn8C,KAAM,SAAUzQ,GACR6a,UAAQC,WACR9a,EAAK2M,QAAQme,cAAcrQ,MAAM6K,IAAMkrC,EAAY7jD,QAAQ8hB,wBAAwBnJ,IAC/EtlB,EAAK2M,QAAQme,cAAc9P,aAAe,KAC9Chb,EAAK2M,QAAQme,cAAcrQ,MAAMZ,KAAOlb,EAAOgO,QAAQuyB,WAAa,OAG5E7c,OAAQ,eACRS,QAAS,yBACV,IAAMnkB,EAAOgO,QAAQiP,GAAK,eAC7B20C,GAASjC,QAAS,CAClB,IAAIzrD,IAAQuhC,8BAA+B,KAC3CzlC,GAAO+C,OAAO,iBAAmBxB,KAAM,mCAAoCE,OAASyC,IAAKA,IACzF,IAAI47B,IAAaC,sBAAuB,KACxC//B,GAAO+C,OAAO,iBAAmBxB,KAAM,2BAA4ByB,kBAAkB,EAAOvB,OAASyC,IAAK47B,MACrG59B,oBAAkB49B,EAAgC,wBAAMA,EAAgC,uBAAK,EAC9F9/B,EAAOgO,QAAQoO,cAAc,yDAAyDN,MAAM+zC,WACjE,YAArB5vD,KAAK8kD,YAA4B7gD,EAAmC,8BAAE8K,YACpEhP,EAAOkH,UAAU44B,EAAgC,uBAAG9wB,YAG5DhP,EAAOgO,QAAQoO,cAAc,yDAAyDN,MAAM+zC,WACtF,SAIlBzV,EAAct5C,UAAU6wD,aAAe,SAAUnR,GAC7C,GAAIxgD,GAASC,KAAKD,OACd8vD,IACE7yC,GAAI,IAAK7N,KAAMnP,KAAK+oD,KAAK4B,YAAY,YACrC3tC,GAAI,IAAK7N,KAAMnP,KAAK+oD,KAAK4B,YAAY,WACrC3tC,GAAI,IAAK7N,KAAMnP,KAAK+oD,KAAK4B,YAAY,YACrC3tC,GAAI,IAAK7N,KAAMnP,KAAK+oD,KAAK4B,YAAY,WACrC3tC,GAAI,IAAK7N,KAAMnP,KAAK+oD,KAAK4B,YAAY,WAE3C,IAAIpK,EAAM/hC,QAAQ,gBAAkB,EAAG,CACnC,GAAIsxC,GAAiB/yC,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,mBAC7D60C,EAAa90C,SAAS8K,cAAc,QACpCgY,GAAaC,sBAAuB,KACxC//B,GAAO+C,OAAO,iBAAmBxB,KAAM,2BAA4ByB,kBAAkB,EAAOvB,OAASyC,IAAK47B,MACrG59B,oBAAkB49B,EAAgC,wBAAMA,EAAgC,uBAAK,EAC9FgyB,EAAW1qC,UAAYnnB,KAAKkqD,aAAanqD,EAAOkH,UAAU44B,EAAgC,uBAAG5wB,aAG7F4iD,EAAW1qC,UAAYnnB,KAAK+oD,KAAK4B,YAAY,SAEjDkH,EAAW/V,UAAY,qBACvBgU,EAAe5oC,YAAY2qC,EAC3B,IAAIC,GAAe,GAAI9D,mBAAiBzN,MAAOsP,EAC3Ch+C,KAAM,SAAUzQ,GACR6a,UAAQC,WACR9a,EAAK2M,QAAQme,cAAcrQ,MAAM6K,IAAMorC,EAAa/jD,QAAQ8hB,wBAAwBnJ,IAChFtlB,EAAK2M,QAAQme,cAAc9P,aAAe,KAElD,IAAI6zC,GAAY4B,EAAW1qC,SAC3B/lB,GAAK2M,QAAQoO,cAAc,kBAAyB8zC,EAAY,MAAWhzC,UAAUa,IAAI,mBAE7FxM,OAAQ,SAAUlQ,GACdywD,EAAWxU,YAAcj8C,EAAKqsC,KAAKt+B,KACnCpP,EAAOkiD,qBAAqB7gD,EAAKqsC,KAAKzwB,IAClCf,UAAQC,SACJa,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,mBAE5BkG,eAAanjB,EAAOgO,QAAQiP,GAAK,iBAAkB,WACzD+3B,kBAIVh4B,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,aAE5BkG,eAAanjB,EAAOgO,QAAQiP,GAAK,WAAY,WACnD+3B,oBAM1B+c,GAAa1tC,SAAS,IAAMrkB,EAAOgO,QAAQiP,GAAK,qBAGxDm9B,EAAct5C,UAAUqpD,aAAe,SAAU1oD,GAC7C,GAAI67C,GAAc,GACd0U,GACAhT,EAAG/+C,KAAK+oD,KAAK4B,YAAY,UACzB3L,EAAGh/C,KAAK+oD,KAAK4B,YAAY,SACzB1L,EAAGj/C,KAAK+oD,KAAK4B,YAAY,UACzBzL,EAAGl/C,KAAK+oD,KAAK4B,YAAY,SACzBxL,EAAGn/C,KAAK+oD,KAAK4B,YAAY,UAK7B,OAHInpD,IAAS,GAAKA,GAAS,IACvB67C,EAAc0U,EAAmBvwD,IAE9B67C,GAEXlD,EAAct5C,UAAUwwD,0BAA4B,WAChD,GAAI9lD,GAAQvL,KACRD,EAASC,KAAKD,OACd2rD,EAAW1rD,KAAK2rD,mBAAmB,MACnCC,EAAY5rD,KAAK6rD,sBACjBC,EAAW9rD,KAAKsxD,2BAChBtF,EAAWhsD,KAAKisD,oBAChBhwC,WAAQC,SACRlc,KAAKwiB,gBAAkBspC,EAGvB9rD,KAAKwiB,gBAAkBkpC,EAAS9P,OAAOoQ,EAAUF,EAAUF,EAE/D,IAAIrpC,GAAU,GAAIm5B,YACdr7C,MAAO,OACPkgD,MAAOvgD,KAAKwiB,gBACZyc,QAASj/B,KAAKmrD,kBAAkBrnC,KAAK9jB,MACrCirD,QAAS,WACL1/C,EAAM4gD,oBACDlwC,UAAQC,UACT3Q,EAAM6gD,gBAENnwC,UAAQC,SACJ3Q,EAAMiX,gBAAgBrd,OAAS,GAAK4X,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,aAEhFuF,EAAQwyB,mBAIZxpC,EAAM6/C,4BACF7/C,EAAMiX,gBAAgBrd,OAAS,GAAK4X,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,aAEhFuF,EAAQwyB,qBAKpB94B,WAAQC,SACRqG,EAAQ6B,SAAS,IAAMrkB,EAAOgO,QAAQiP,GAAK,kBAG3CuF,EAAQ6B,SAAS,IAAMrkB,EAAOgO,QAAQiP,GAAK,YAE/Chd,KAAKqpD,uBAETlP,EAAct5C,UAAUgsD,sBAAwB,WAC5C,GAAIthD,GAAQvL,KACRD,EAASC,KAAKD,OACd+rD,EAAW9rD,KAAKuxD,sBAChBx0C,UAASZ,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,sBAAsBC,UAAUC,SAAS,cAC1FgG,eAAanG,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,sBAAuB,WAAWlc,SAE/F,IAAIyhB,GAAU,GAAIm5B,YACdr7C,MAAO,OACPkgD,MAAOuL,EACP7sB,QAASj/B,KAAKgyD,yBAAyBluC,KAAK9jB,MAC5CirD,QAAS,WACL1/C,EAAMmF,yBACNnF,EAAM0mD,qBACuB,KAAzBlyD,EAAOyd,gBACPzd,EAAOyd,cAAgBzd,EAAOgO,QAAQiP,GAAK,WAE/C,IAAIk1C,GAAan1C,SAASZ,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,eAC9Dk1C,KACAA,EAAWr2C,MAAMG,QAAU,QAE/Be,SAAS0F,eAAe1iB,EAAOyd,cAAgB,UAAU0O,cAAcA,cAAcjP,UAAUa,IAAI,cACnGvS,EAAM89C,sBACN9mC,EAAQwyB,oBAGhBxyB,GAAQ6B,SAAS,IAAMrkB,EAAOgO,QAAQiP,GAAK,uBAE/Cm9B,EAAct5C,UAAUoxD,mBAAqB,WACzC,GAAIlyD,GAASC,KAAKD,MAClBuiB,eAAYviB,EAAOgO,SACnBhO,EAAOgO,QAAQ8N,MAAMC,QAAU,KAC/B,IAAImN,GAAYlpB,EAAO+gD,sBACvB9gD,MAAKqiB,eAAehiB,MAAQ4oB,EAAU5oB,MACtCL,KAAKqiB,eAAe/hB,OAAS2oB,EAAU3oB,OACvCN,KAAKoiB,gBAAgBS,aAAaoG,EAAW,EAAG,GAChDjpB,KAAKmyD,mBAAmB,iBAAkB,WAC1CnyD,KAAKmyD,mBAAmB,gBAAiB,UACzCnyD,KAAKmyD,mBAAmB,cAAe,QACvCnyD,KAAKmyD,mBAAmB,cAAe,QACvCnyD,KAAKmyD,mBAAmB,mBAAoB,aAC5CnyD,KAAKmyD,mBAAmB,eAAgB,SACxCnyD,KAAKmyD,mBAAmB,gBAAiB,UACzCv2C,cAAY7b,EAAOgO,SACnBhO,EAAOgO,QAAQ8N,MAAMC,QAAU,IAC/B/b,EAAOud,uBAAyBtd,KAAKqC,aAAasC,QAEtDw1C,EAAct5C,UAAUsxD,mBAAqB,SAAUC,EAAUzrD,GAC7D,GAAI5G,GAASC,KAAKD,OACd4E,EAAS5E,EAAOgO,QAAQoO,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAKo1C,EACpE,IAAIztD,EAAQ,CACR,GAAI+O,GAAM/O,EAAOrC,WAAW,KAC5BoR,GAAM/O,EAAOrC,WAAW,MACxBqC,EAAOkX,MAAMxb,MAAQ,QACrBsE,EAAOkX,MAAMvb,OAAS,QACtBP,EAAO+C,OAAO,UAAYxB,KAAM,YAAaE,OAASmF,KAAMA,EAAMnF,MAAO,KAAMspB,WAAW,EAAMpX,IAAKA,KACrGA,EAAI9O,UAAU5E,KAAKqiB,eAAgB,EAAG,EAAG,IAAK,OAGtD83B,EAAct5C,UAAUwxD,0BAA4B,SAAUryB,GAC1D,GAAIjgC,GAASC,KAAKD,OACdqB,GAAS0K,QAAQ,EAAO0+C,iBACxBA,IACAvoD,qBAAkB+9B,IAClBwqB,EAAavkD,KAAK,SAClBukD,EAAavkD,KAAK,UACa,SAA3BlG,EAAO6C,UAAUwC,OACjBolD,EAAavkD,KAAK,YAEtB7E,EAAKgE,MAAQrF,EAAO+G,aAAa/G,EAAO6C,UAAUwC,QAE7C46B,IACLwqB,EAAavkD,KAAK,UAClB7E,EAAKgE,MAAQ,iBAEjBhE,EAAKopD,aAAexmD,YAAWwmD,EAAc,MAAM,GACnDzqD,EAAO0M,QAAQ,yBAA0BrL,EACzC,IAAIkxD,KACJ,IAAIlxD,EAAK0K,OACLwmD,SAGA,KAAK,GAAIttD,GAAI,EAAGA,EAAI5D,EAAKopD,aAAarlD,OAAQH,IAC1C,OAAQ5D,EAAKopD,aAAaxlD,IACtB,IAAK,QACDstD,EAAgBrsD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,aAAcwvC,WAAY,kBAAmBtR,SAAU,mBAClGwP,YAAa1qD,KAAK+oD,KAAK4B,YAAY,aAAcF,MAAO,QAC5D,MACJ,KAAK,SACD6H,EAAgBrsD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,UAAWwvC,WAAY,kBAAmBtR,SAAU,mBAC/FwP,YAAa1qD,KAAK+oD,KAAK4B,YAAY,UAAWF,MAAO,QACzD,MACJ,KAAK,WACD6H,EAAgBrsD,MAAO+W,GAAIjd,EAAOgO,QAAQiP,GAAK,YAAawvC,WAAY,4BAA6BtR,SAAU,6BAC3GwP,YAAa1qD,KAAK+oD,KAAK4B,YAAY,YAAaF,MAAO,QAC3D,MACJ,SACI6H,EAAgBrsD,KAAK7E,EAAKopD,aAAaxlD,IAKvD,MAAOstD,IAEXnY,EAAct5C,UAAUuoD,UAAY,SAAUppB,GAC1C,GAAIjgC,GAASC,KAAKD,MAClB,IAAIA,EAAO6C,WAAa7C,EAAO07C,uBAAwB,CACnD,GAAI8W,GAASx1C,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,0BACrDu1C,KACAvyD,KAAK0pD,4BACL6I,EAAO12C,MAAMG,QAAU,QAE3B,IAAIukC,GAAQvgD,KAAKqyD,0BAA0BryB,EAC3C,IAAqB,IAAjBugB,EAAMp7C,OACN,MASJ,IAPIlD,oBAAkBlC,EAAOo8C,6BACR,GAAIT,YACjB6E,MAAOA,EACPthB,QAASj/B,KAAKwyD,0BAA0B1uC,KAAK9jB,QAEtCokB,SAAS,IAAMrkB,EAAOgO,QAAQiP,GAAK,uBAE9C/a,oBAAkB+9B,GAAY,CAC9BuyB,EAAO12C,MAAMxb,MAAQ,OACrBN,EAAO6C,UAAUC,YAAYxC,MAAQ8H,KAAKC,IAAIrI,EAAO6C,UAAUC,YAAYxC,OAC3EN,EAAO6C,UAAUC,YAAYvC,OAAS6H,KAAKC,IAAIrI,EAAO6C,UAAUC,YAAYvC,OAC5E,IAAIE,GAAIT,EAAO6C,UAAUC,YAAY1C,OAASJ,EAAO6C,UAAUC,YAAYkF,KACvEhI,EAAO6C,UAAUC,YAAY1C,OAASJ,EAAO6C,UAAUC,YAAYkF,KACnEtH,EAAIV,EAAO6C,UAAUC,YAAYzC,OAASL,EAAO6C,UAAUC,YAAYmF,KACvEjI,EAAO6C,UAAUC,YAAYzC,OAASL,EAAO6C,UAAUC,YAAYmF,KACnE3H,EAAQN,EAAO6C,UAAUC,YAAYxC,KACzC,IAAsC,IAAlCN,EAAO6C,UAAUgR,cAAiD,UAA3B7T,EAAO6C,UAAUwC,MAAmB,CAC3E,GAAIU,IAAWjD,YAAa,KAC5B9C,GAAO+C,OAAO,SAAWxB,KAAM,gCAAiCyB,kBAAkB,EAC9EvB,OAASyC,IAAKlE,EAAO6C,UAAWkD,OAAQA,KAE5CtF,GADI2C,EAAQ2C,EAAoB,aACtB3F,OACVM,EAAI0C,EAAM/C,OACVC,EAAQ8C,EAAM9C,UAEb,IAA+B,SAA3BN,EAAO6C,UAAUwC,MAAkB,CACxC,GAAIqtD,GAAO1yD,EAAOmhD,sBAAsBnhD,EAAO6C,UAC/CpC,GAAIiyD,EAAKtyD,OACTM,EAAIgyD,EAAKryD,OACTC,EAAQoyD,EAAKpyD,MAEjBkyD,EAAO12C,MAAMZ,KAAQza,EAAKH,EAAQ,EAAsB,GAAfkgD,EAAMp7C,OAAe,KAC1D1E,EAAI,GAAKV,EAAOqD,IAAIE,QACpBivD,EAAO12C,MAAM6K,IAAM3mB,EAAOqD,IAAIE,QAAU,KAGxCivD,EAAO12C,MAAM6K,IAAMjmB,EAAI,GAAK,SAG/B,IAAIu/B,EAAW,CAChB,GAAI/7B,IAAQpB,YAAa,MACrBg9B,GAAaC,sBAAuB,KACxC//B,GAAO+C,OAAO,iBAAmBxB,KAAM,2BAA4ByB,kBAAkB,EAAOvB,OAASyC,IAAK47B,KAC1G9/B,EAAO+C,OAAO,iBAAmBxB,KAAM,YACnCE,OAASstB,IAAK+Q,EAAgC,sBAAG57B,IAAKA,IAC1D,IAAId,GAAQc,EAAiB,WAC7BsuD,GAAO12C,MAAMxb,MAAQ,OACrBkyD,EAAO12C,MAAMZ,KAAQ9X,EAAMhD,OAAUgD,EAAM9C,MAAQ,EAAsB,GAAfkgD,EAAMp7C,OAAe,KAC3EhC,EAAM/C,OAAS,GAAKL,EAAOqD,IAAIE,QAC/BivD,EAAO12C,MAAM6K,IAAM3mB,EAAOqD,IAAIE,QAAU,KAGxCivD,EAAO12C,MAAM6K,IAAMvjB,EAAM/C,OAAS,GAAK,QAKvD+5C,EAAct5C,UAAU+oD,mBAAqB,SAAU3rC,GACnD,IAAIhc,oBAAkBgc,GAAtB,CAGA,GAAIle,GAASC,KAAKD,OACd2yD,EAAa31C,SAASZ,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,iBAC9D01C,KACIz0C,GACAy0C,EAAWz1C,UAAUa,IAAI,cACzB40C,EAAWxmC,cAAcjP,UAAUa,IAAI,eAGvC40C,EAAWz1C,UAAU+O,OAAO,cAC5B0mC,EAAWxmC,cAAcjP,UAAU+O,OAAO,cAE9C9I,eAAawvC,EAAY,gBAAgBlnD,SAAWyS,EAExD,IAAIjb,GAAY+Z,SAASZ,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,gBAC7Dha,KACIib,GACAjb,EAAUia,UAAUa,IAAI,cACxB9a,EAAUkpB,cAAcjP,UAAUa,IAAI,eAGtC9a,EAAUia,UAAU+O,OAAO,cAC3BhpB,EAAUkpB,cAAcjP,UAAU+O,OAAO,cAE7C9I,eAAalgB,EAAW,gBAAgBwI,SAAWyS,EAEvD,IAAI00C,GAAa51C,SAASZ,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,cAC9D21C,KACI10C,GACA00C,EAAW11C,UAAUa,IAAI,cACzB60C,EAAWzmC,cAAcjP,UAAUa,IAAI,eAGvC60C,EAAW11C,UAAU+O,OAAO,cAC5B2mC,EAAWzmC,cAAcjP,UAAU+O,OAAO,cAE9C9I,eAAayvC,EAAY,OAAOnnD,SAAWyS,EAE/C,IAAItZ,GAASoY,SAASZ,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,UAC1DrY,KACIsZ,GACAtZ,EAAOsY,UAAUa,IAAI,cACrBnZ,EAAOunB,cAAcjP,UAAUa,IAAI,eAGnCnZ,EAAOsY,UAAU+O,OAAO,cACxBrnB,EAAOunB,cAAcjP,UAAU+O,OAAO,cAE1C9I,eAAave,EAAQ,OAAO6G,SAAWyS,KAG/Ck8B,EAAct5C,UAAUwtD,WAAa,SAAUjtD,GAC3C,GAAIrB,GAASC,KAAKD,MAClBA,GAAOqe,WAAY,EACfnc,oBAAkBlC,EAAOiD,UAAUsc,kBACnCvf,EAAOiD,UAAUsc,eAAiBvf,EAAOiD,UAAUa,WACnD9D,EAAO+C,OAAO,QAAUxB,KAAM,oBAAqByB,kBAAkB,EAAOvB,OAASoC,eAAgB7D,EAAOiD,UAAUa,eAE1H9D,EAAOiD,UAAUa,WAAa9D,EAAOiD,UAAUsc,cAC/C,IAAInQ,GAAO/N,EAAKqsC,KAAKzwB,EACrBhd,MAAK6kD,eAAiB,OACtB9kD,EAAOgE,mBAAqB,KAC5BhE,EAAOuR,OAAOnC,GACdnP,KAAKqpD,sBACLtpD,EAAO+C,OAAO,aAAexB,KAAM,oBAAqBE,OAAS0/B,WAAW,MAEhFiZ,EAAct5C,UAAU2xD,0BAA4B,SAAUpxD,EAAMoI,GAChE,GAAIzJ,GAASC,KAAKD,OACd8I,GAAWrI,EAAGT,EAAO6C,UAAUC,YAAY1C,OAAQM,EAAGV,EAAO6C,UAAUC,YAAYzC,OACvF,IAAIgB,EAAKqsC,KAAM,CACX,GAAImlB,OAAe,GACf1tD,MAAU,GACV2tD,EAAoB,KACpB5uD,GAAQkO,WAAY,MACpBrM,GAAW2P,QAAS,KACxB1V,GAAO+C,OAAO,QAAUxB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAASyC,IAAKA,KACtFlE,EAAO+C,OAAO,aAAexB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAASyC,IAAK6B,KAC3FA,EAAgB,QAAe,YAAU,OAAIqC,KAAKC,IAAItC,EAAgB,QAAe,YAAU,OAC/F,IAAIgtD,IAAe5iD,UAAW,KAE9B,QADAnQ,EAAO+C,OAAO,QAAUxB,KAAM,aAAcE,OAASyC,IAAK6uD,KAClD1xD,EAAKqsC,KAAKzwB,GAAGo+B,QAAQr7C,EAAOgO,QAAQiP,GAAK,IAAK,IAAIpK,eACtD,IAAK,YACD,IAAK7S,EAAOgO,QAAQoO,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,cAAcC,UAAUC,SAAS,cAAe,CAwBxG,GAvBK41C,EAAsB,WAAKpxB,KAAKC,UAAU77B,EAAgB,WAAO47B,KAAKC,UAAU5hC,EAAO6C,aACxFiwD,GAAoB,GAExBD,EAAe5uD,YAAWjE,EAAO6C,cAAe,GAC5CX,oBAAkBlC,EAAO6C,UAAUic,WACnC9e,EAAO+C,OAAO,SAAWxB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAAS+Z,YAAas3C,KAExF5uD,EAAgB,YACrBlE,EAAO6C,UAAUic,UAAY,KAC7B+zC,EAAa/zC,UAAY,KACzB9e,EAAO+C,OAAO,SAAWxB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAAS+Z,YAAas3C,MAG7F9yD,EAAO+C,OAAO,SAAWxB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAAS+Z,aAAa,KAE7Fu3C,EAAsB,WACtB/yD,EAAO+C,OAAO,aAAexB,KAAM,gBAAiBE,OAASmF,KAAM,QAEvEzB,EAAUlB,YAAWjE,EAAOmF,YAAa,GACzC0tD,EAAa/vD,YAAY1C,QAAU,GACnCyyD,EAAa/vD,YAAYzC,QAAU,GACnCwyD,EAAa/vD,YAAYkF,MAAQ,GACjC6qD,EAAa/vD,YAAYmF,MAAQ,GACN,SAAvB4qD,EAAaxtD,MACb,IAAK,GAAIJ,GAAI,EAAGA,EAAI4tD,EAAa3rD,UAAU9B,OAAQH,IAC/C4tD,EAAa3rD,UAAUjC,GAAGxE,GAAK,GAC/BoyD,EAAa3rD,UAAUjC,GAAGvE,GAAK,EAGvCV,GAAO6C,UAAYgwD,EACY,SAA3B7yD,EAAO6C,UAAUwC,OAA+C,UAA3BrF,EAAO6C,UAAUwC,OACtDrF,EAAO+C,OAAO,SAAWxB,KAAM,2BAA4ByB,kBAAkB,EACzEvB,OAASyC,IAAKlE,EAAO6C,aAG7B7C,EAAO+C,OAAO,QAAUxB,KAAM,aAAcyB,kBAAkB,EAAOvB,OAAS6D,OAAQ,YAAapB,IAAKlE,EAAO6C,aAC/G7C,EAAO+C,OAAO,aAAexB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAAS0D,QAASA,KAC7FlF,KAAKopD,YAET,KACJ,KAAK,SACIrpD,EAAOgO,QAAQoO,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,WAAWC,UAAUC,SAAS,eACtFnd,EAAO+C,OAAO,aAAexB,KAAM,aAAcyB,kBAAkB,GAEvE,MACJ,KAAK,WACIhD,EAAOgO,QAAQoO,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,aAAaC,UAAUC,SAAS,gBACxFld,KAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOwC,YAAYlC,MAAON,EAAOwC,YAAYjC,QAC/EP,EAAO+C,OAAO,aAAexB,KAAM,gBAAiByB,kBAAkB,EAClEvB,OAASyC,IAAKD,YAAWjE,EAAO6C,cAAe,MACnD7C,EAAO+C,OAAO,aAAexB,KAAM,qBAAsByB,kBAAkB,EACvEvB,OAAS4E,MAAM,KACnBrG,EAAO+C,OAAO,QAAUxB,KAAM,gBAAiByB,kBAAkB,EAC7DvB,OAAS2Q,WAAYnO,YAAWjE,EAAO6C,cAAe,MACpB,IAAlC7C,EAAO6C,UAAUgR,eACjB/K,EAAOrI,EAAIT,EAAO6C,UAAU22B,oBAAoB,GAAG/4B,EACnDqI,EAAOpI,EAAIV,EAAO6C,UAAU22B,oBAAoB,GAAG94B,GAEvDV,EAAO+C,OAAO,SAAWxB,KAAM,iBAAkByB,kBAAkB,EAC/DvB,OAAShB,EAAGqI,EAAOrI,EAAGC,EAAGoI,EAAOpI,EAAG6I,OAAQvJ,EAAO6C,aAClDX,oBAAkBlC,EAAO6C,UAAUic,WACnC9e,EAAO+C,OAAO,QAAUxB,KAAM,qBAAsByB,kBAAkB,EAAOvB,OAAS4E,MAAM,KAEvFnC,EAAgB,YACrBlE,EAAO+C,OAAO,QAAUxB,KAAM,qBAAsByB,kBAAkB,EAAOvB,OAAS4E,MAAM,KAE5F2W,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,6BAC5CD,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,2BAA2BnB,MAAMG,QAAU,UAMvG/Z,oBAAkBuH,IAClBzJ,EAAO0M,QAAQ,8BAA+BrL,IAGtD+4C,EAAct5C,UAAUsqD,kBAAoB,SAAU/pD,GAClD,GAAIrB,GAASC,KAAKD,OACdyJ,GAAsB,EACtBupD,GAAmB,CAOvB,IANIhzD,EAAOgO,QAAQoO,cAAc,mCACxBpc,EAAOgO,QAAQoO,cAAc,iCAAiCc,UAAUC,SAAS,YAClF1T,EAAsBupD,GAAmB,GAE7ChzD,EAAOgO,QAAQoO,cAAc,iCAAiCc,UAAUa,IAAI,WAE5E1c,EAAKqsC,KAAM,CACX,GAAI9mC,GAAOvF,EAAKqsC,KAAKzwB,GAAGo+B,QAAQr7C,EAAOgO,QAAQiP,GAAK,IAAK,IAAIpK,aAC7D,IAAa,cAATjM,GAAiC,WAATA,GAA8B,aAATA,EAC7C3G,KAAKwyD,0BAA0BpxD,GAAM,GACrCrB,EAAO0M,QAAQ,qBAAsBrL,OAEpC,CACD,GAAI4xD,IAAmB,EACnBC,GAAuB,EACvBN,EAAa51C,SAASZ,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,cAC9D21C,IAAcA,EAAW11C,UAAUC,SAAS,gBAC5C+1C,GAAuB,EAE3B,IAAItuD,GAASoY,SAASZ,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,UAC1DrY,IAAUA,EAAOsY,UAAUC,SAAS,gBACpC81C,GAAmB,GAEvBhzD,KAAKqpD,sBACLrpD,KAAKmqD,mBAAmBxjD,EAAM6C,EAAqBypD,EAAsBD,EAAkBD,GAC3FhzD,EAAO0M,QAAQ,qBAAsBrL,MAIjD+4C,EAAct5C,UAAUspD,mBAAqB,SAAUxjD,EAAM6C,EAAqBypD,EAAsBD,EAAkBD,GACtH,GAGIrf,GACAhnC,EAJA3M,EAASC,KAAKD,OACdktD,EAASltD,EAAOgO,QAAQoO,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,WAChEkB,GAAkB,CAYtB,QAT+BzK,KAA3B1T,EAAO6C,UAAUwC,QACjBsH,EAAa3M,EAAO6C,UAAUwC,MAAMuH,MAAM,UAE3B8G,KAAf/G,GAA4B3M,EAAO0F,YAAYC,aAC/CwY,GAAkB,MAEEzK,KAAf/G,GAA8C,SAAlBA,EAAW,KAC5CwR,GAAkB,IAEjBne,EAAOyL,SACR,OAAQ7E,GACJ,IAAK,MACD5G,EAAO0F,YAAYC,aAAe3F,EAAO0F,YAAY0X,YAAa,EAC9Dpd,EAAO0F,YAAYmG,cACnB7L,EAAO+C,OAAO,aAAexB,KAAM,aAAcE,OAAS4E,KAAM,QAEhE8X,IACAne,EAAO0F,YAAYC,cAAe,EAClC3F,EAAO+C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,IACrE/C,KAAKwC,aAAa2B,UAAU,EAAG,EAAGpE,EAAOwC,YAAYlC,MAAON,EAAOwC,YAAYjC,QAC/EN,KAAK02C,eAAe,SAEpB32C,EAAOie,WACPhe,KAAKouD,YACLruD,EAAO+C,OAAO,aAAexB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAAS4E,MAAM,KAChE,QAAxBpG,KAAK6kD,gBACL9kD,EAAOw9C,cAAa,MAIxB7J,EAAS3zC,EAAOgO,QAAQoO,cAAc,uBAElCu3B,EAAOz2B,UAAUa,IAAI,kBAEzB/d,EAAO4F,KAAI,GACX5F,EAAO+C,OAAO,aAAexB,KAAM,gBAAiByB,kBAAkB,EAAOvB,OAAS4E,MAAM,MAE5F6mD,GAAUltD,EAAOkN,aAAapJ,YAAc9D,EAAOkN,aAAasY,eAChE0nC,EAAOhwC,UAAUa,IAAI,cACrBmvC,EAAO/gC,cAAcjP,UAAUa,IAAI,cAE9BmvC,IACLA,EAAOhwC,UAAU+O,OAAO,cACxBihC,EAAO/gC,cAAcjP,UAAU+O,OAAO,cAE1ChsB,KAAK02C,eAAe,OACpB,MACJ,KAAK,SACD32C,EAAO+C,OAAO,QAAUxB,KAAM,gBAAiBE,OAASgI,oBAAqBA,IAC7E,MACJ,KAAK,KACDzJ,EAAO8zB,QACP7zB,KAAK4pD,oBAAmB,GACxB5pD,KAAK6kD,eAAiB,MACtB,MACJ,KAAK,OACD9kD,EAAO+C,OAAO,aAAexB,KAAM,oBAAqBE,OAAS0/B,WAAW,IAC5E,MACJ,KAAK,QACDnhC,EAAOmC,QACPlC,KAAK6kD,eAAiB,MACtB,MACJ,KAAK,OACD9kD,EAAO+C,OAAO,aAAexB,KAAM,aACnC,MACJ,KAAK,OACDvB,EAAO+C,OAAO,aAAexB,KAAM,aACnC,MACJ,KAAK,aACI2xD,IACGlzD,EAAO0F,YAAY0X,YACnBpd,EAAO8zB,QAEX7zB,KAAK02C,eAAe,cACpB32C,EAAO2gD,0BACP1gD,KAAKkzD,WAAW,cAEpB,MACJ,KAAK,aACL,IAAK,WACL,IAAK,MACL,IAAK,aACL,IAAK,UACL,IAAK,OACL,IAAK,WACDlzD,KAAKkzD,WAAWvsD,EAChB,MACJ,KAAK,SACIqsD,IACD1wC,cAAYviB,EAAOgO,SACnB/N,KAAK02C,eAAe,UACpB32C,EAAO2gD,0BACP9kC,cAAY7b,EAAOgO,SAEvB,MACJ,KAAK,UACL,IAAK,SACL,IAAK,OACL,IAAK,OACL,IAAK,YACL,IAAK,gBACL,IAAK,QACL,IAAK,SACL,IAAK,UACDhO,EAAO0F,YAAY0X,YAAa,EAChCpd,EAAO+C,OAAO,UAAYxB,KAAM,mBAAoBE,OAASo8C,OAAQj3C,IACrE,MACJ,KAAK,SACGosD,GACAhzD,EAAOgO,QAAQoO,cAAc,iCAAiCc,UAAU+O,OAAO,SAEnF,MACJ,KAAK,OACDjsB,EAAO+C,OAAO,aAAexB,KAAM,qBAAsBE,OAAS4E,MAAM,KACpErG,EAAO6C,UAAUyF,aAAagH,MAAQtP,EAAO6C,UAAUyF,aAAaiH,OACpEvP,EAAO+C,OAAO,SAAWxB,KAAM,iBAAkByB,kBAAkB,EAC/DvB,OAASisC,KAAM,YAEd1tC,EAAO6C,UAAUyF,aAAagH,OAAStP,EAAO6C,UAAUyF,aAAaiH,OAC1EvP,EAAO+C,OAAO,SAAWxB,KAAM,iBAAkByB,kBAAkB,EAC/DvB,OAASisC,KAAM,cAEb1tC,EAAO6C,UAAUyF,aAAagH,MAAQtP,EAAO6C,UAAUyF,aAAaiH,OAC1EvP,EAAO+C,OAAO,SAAWxB,KAAM,iBAAkByB,kBAAkB,EAC/DvB,OAASisC,KAAM,gBAEb1tC,EAAO6C,UAAUyF,aAAagH,MAAStP,EAAO6C,UAAUyF,aAAaiH,QAC3EvP,EAAO+C,OAAO,SAAWxB,KAAM,iBAAkByB,kBAAkB,EAC/DvB,OAASisC,KAAM,UAEnB1tC,EAAOgO,QAAQoO,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,SAASC,UAAUC,SAAS,kBACnFnd,EAAOgO,QAAQoO,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,SAASC,UAAU+O,OAAO,kBAGjFjsB,EAAOgO,QAAQoO,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,SAASC,UAAUa,IAAI,iBAElF,MACJ,KAAK,SACD/d,EAAO+C,OAAO,aAAexB,KAAM,qBAAsBE,OAAS4E,MAAM,KACpErG,EAAO6C,UAAUyF,aAAagH,MAAQtP,EAAO6C,UAAUyF,aAAaiH,OACpEvP,EAAO+C,OAAO,SAAWxB,KAAM,iBAAkByB,kBAAkB,EAC/DvB,OAASisC,KAAM,UAEd1tC,EAAO6C,UAAUyF,aAAagH,OAAStP,EAAO6C,UAAUyF,aAAaiH,OAC1EvP,EAAO+C,OAAO,SAAWxB,KAAM,iBAAkByB,kBAAkB,EAC/DvB,OAASisC,KAAM,iBAEb1tC,EAAO6C,UAAUyF,aAAagH,MAAQtP,EAAO6C,UAAUyF,aAAaiH,OAC1EvP,EAAO+C,OAAO,SAAWxB,KAAM,iBAAkByB,kBAAkB,EAC/DvB,OAASisC,KAAM,aAEb1tC,EAAO6C,UAAUyF,aAAagH,MAAStP,EAAO6C,UAAUyF,aAAaiH,QAC3EvP,EAAO+C,OAAO,SAAWxB,KAAM,iBAAkByB,kBAAkB,EAC/DvB,OAASisC,KAAM,YAEnB1tC,EAAOgO,QAAQoO,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,WAAWC,UAAUC,SAAS,kBACrFnd,EAAOgO,QAAQoO,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,WAAWC,UAAU+O,OAAO,kBAGnFjsB,EAAOgO,QAAQoO,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,WAAWC,UAAUa,IAAI,iBAEpF,MACJ,KAAK,gBACD9d,KAAK02C,eAAe,gBACpB,MACJ,KAAK,aACL,IAAK,cACL,IAAK,iBACL,IAAK,eACD32C,EAAO6iD,gBAAgBj8C,GACvB5G,EAAO+C,OAAO,aAAexB,KAAM,oBAAqBE,OAAS0/B,WAAW,IAC5E,MACJ,KAAK,OACD,GAAInhC,EAAOgO,QAAQoO,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,YAAYC,UAAUC,SAAS,UAAW,CACjGnd,EAAOgO,QAAQoO,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,YAAYC,UAAU+O,OAAO,SACpF,OAGAjsB,EAAO8zB,QAEX9zB,EAAOgO,QAAQoO,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,YAAYC,UAAUa,IAAI,UACjF/d,EAAOgO,QAAQoO,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,YAAYgH,UAKnFm2B,EAAct5C,UAAUmxD,yBAA2B,SAAU5wD,GACzD,GAAIrB,GAASC,KAAKD,OACdgsB,EAAShsB,EAAOgO,QAAQoO,cAAc,2DACtC4P,IACAA,EAAO9O,UAAU+O,OAAO,aAE5B,IAAIrlB,GAAOvF,EAAKqsC,KAAKzwB,GAAGo+B,QAAQr7C,EAAOgO,QAAQiP,GAAI,IAAIrQ,MAAM,KAAK,GAC9DwmD,GAAmBxuD,OAAQ5E,EAAO+G,aAAaH,GAAOmF,QAAQ,EAClE/L,GAAO0M,QAAQ,iBAAkB0mD,GAC7BA,EAAernD,SAGnBiR,SAAS0F,eAAerhB,EAAKqsC,KAAKzwB,GAAK,UAAUkP,cAAcA,cAAcjP,UAAUa,IAAI,cAC3F/d,EAAO0F,YAAY0X,YAAa,EAChCpd,EAAO+C,OAAO,UAAYxB,KAAM,mBAAoBE,OAASo8C,OAAQj3C,EAAKiM,iBAC1E7S,EAAOyd,cAAgBpc,EAAKqsC,KAAKzwB,GACjChd,KAAKqpD,wBAETlP,EAAct5C,UAAUypD,oBAAsB,WAC1C,GAAIvqD,GAASC,KAAKD,OACd+F,GAAWV,MAAO,GACtBrF,GAAO+C,OAAO,aAAexB,KAAM,yBAA0ByB,kBAAkB,EAAOvB,OAASyC,IAAK6B,KAC5E,KAApBA,EAAc,QACd/F,EAAO+C,OAAO,aAAexB,KAAM,yBAA0ByB,kBAAkB,EAAOvB,OAASA,MAAO,MACtGzB,EAAO+C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,IACrE/C,KAAK02C,eAAe,QAAQ,KAGpCyD,EAAct5C,UAAUssD,sBAAwB,SAAU99B,GACtD,GAAItvB,GAASC,KAAKD,MAClB,KAAKA,EAAOkN,aAAa6zB,YAAcC,cAAY2a,WAAa3a,cAAY2a,QAAS,CAEjF,GADA17C,KAAKsqD,sBACDruC,UAAQC,UAAuB,eAAXmT,EAAE1oB,KAAuB,CAC7C,IAAK0oB,EAAE+jC,YACH,MAEJ/jC,GAAE6Q,iBAEN,GAAI+sB,GAASlwC,SAASZ,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,UAC9D2S,gBAAaljB,QAAQwgD,EAAQ,QAC7B,IAAIhpD,IAAQmC,MAAM,EAClBrG,GAAO+C,OAAO,aAAexB,KAAM,yBAA0ByB,kBAAkB,EAAOvB,OAASyC,IAAKA,KAChGA,EAAU,OACVlE,EAAO+C,OAAO,iBAAmBxB,KAAM,WAAYyB,kBAAkB,IACrE/C,KAAK0pD,6BAET1pD,KAAKqzD,qBACLtzD,EAAO0F,YAAY0X,YAAa,EAC5Bpd,EAAOse,YACPte,EAAO0F,YAAYwgB,UAAW,EAC9BlmB,EAAOwuB,cAAa,GACpBxuB,EAAO+C,OAAO,aAAexB,KAAM,gBAAiBE,OAASmF,KAAM,SAEvE5G,EAAO+C,OAAO,QAAUxB,KAAM,+BAC9BvB,EAAO+C,OAAO,aAAexB,KAAM,aAAcyB,kBAAkB,EAC/DvB,OAASqC,WAAY,GAAIsD,UAAW,UAGhDgzC,EAAct5C,UAAUwsD,uBAAyB,SAAUh+B,GACvD,GAAItvB,GAASC,KAAKD,MAClB,KAAKA,EAAOkN,aAAa6zB,YAAcC,cAAY2a,WAAa3a,cAAY2a,QAAS,CAEjF,GADA17C,KAAKsqD,sBACDruC,UAAQC,UAAuB,eAAXmT,EAAE1oB,KAAuB,CAC7C,IAAK0oB,EAAE+jC,YACH,MAEJ/jC,GAAE6Q,iBAEN,GAAIsT,GAAUz2B,SAASZ,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,WAC/D2S,gBAAaljB,QAAQ+mC,EAAS,QAC9B,IAAIvvC,IAAQmC,MAAM,EAClBrG,GAAO+C,OAAO,aAAexB,KAAM,yBAA0ByB,kBAAkB,EAAOvB,OAASyC,IAAKA,KAChGA,EAAU,OACVlE,EAAO+C,OAAO,iBAAmBxB,KAAM,WAAYyB,kBAAkB,IACrE/C,KAAK0pD,6BAET1pD,KAAKqzD,qBACLtzD,EAAO0F,YAAY0X,YAAa,EAC5Bpd,EAAOse,YACPte,EAAO0F,YAAYwgB,UAAW,EAC9BlmB,EAAOwuB,cAAa,GACpBxuB,EAAO+C,OAAO,aAAexB,KAAM,gBAAiBE,OAASmF,KAAM,SAEvE5G,EAAO+C,OAAO,QAAUxB,KAAM,+BAC9BvB,EAAO+C,OAAO,aAAexB,KAAM,aAAcyB,kBAAkB,EAC/DvB,OAASqC,YAAa,GAAIsD,UAAW,UAGjDgzC,EAAct5C,UAAUqsD,0BAA4B,SAAU79B,GAC1DA,EAAE6Q,iBACFlgC,KAAKuxC,YAAc+hB,YAAYtzD,KAAKmtD,sBAAsBrpC,KAAK9jB,MAAO,MAE1Em6C,EAAct5C,UAAUusD,2BAA6B,SAAU/9B,GAC3DA,EAAE6Q,iBACFlgC,KAAKuxC,YAAc+hB,YAAYtzD,KAAKqtD,uBAAuBvpC,KAAK9jB,MAAO,MAE3Em6C,EAAct5C,UAAU8oD,sBAAwB,WAC5CpW,cAAcvzC,KAAKuxC,aACnBvxC,KAAKuxC,YAAc,GAEvB4I,EAAct5C,UAAUgpD,uBAAyB,WAC7C,GAAI9pD,GAASC,KAAKD,OACdyJ,GAAsB,CAU1B,QATKzJ,EAAOgO,QAAQoO,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,wBACvDjd,EAAOgO,QAAQoO,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,sBAAsBkP,cAAcjP,UAAUC,SAAS,WAC9Gnd,EAAOgO,QAAQoO,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,kBAChDjd,EAAOgO,QAAQoO,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,gBAAgBkP,cAAcjP,UAAUC,SAAS,aAChHnd,EAAOgO,QAAQoO,cAAc,iCAAiCc,UAAUa,IAAI,UAC5E/d,EAAO8zB,QACP7zB,KAAKwpD,qBACLhgD,GAAsB,GAEnBA,GAEX2wC,EAAct5C,UAAU6oD,0BAA4B,WAChD,GAAI3pD,GAASC,KAAKD,OACdwzD,EAAex2C,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,sBAC3Du2C,IAAgBA,EAAat2C,UAAUC,SAAS,cAChDgG,eAAaqwC,EAAc,WAAWzyD,SAE1C,IAAI0yD,GAAUz2C,SAAS0F,eAAe1iB,EAAOgO,QAAQiP,GAAK,0BACtDw2C,KACAA,EAAQ33C,MAAMG,QAAU,SAGhCm+B,EAAct5C,UAAUwpD,aAAe,SAAU1jD,GAC7C,GAAI5G,GAASC,KAAKD,OACd60C,EAAgB73B,SAASZ,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,0BACjEk1C,EAAan1C,SAASZ,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,gBAC9Dy2C,EAAe12C,SAASZ,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,gBAC/Dk1C,GAYDA,EAAWr2C,MAAMG,QAAU,QAP3By3C,GAJAvB,EAAatd,EAAc1tB,YAAYnnB,EAAO8nB,cAAc,OACxD7K,GAAIjd,EAAOgO,QAAQiP,GAAK,eACxB02C,OAAQ,yBAEcxsC,YAAYnnB,EAAO8nB,cAAc,SACvD7K,GAAIjd,EAAOgO,QAAQiP,GAAK,gBACxB02C,OAAQz3C,UAAQC,SAAW,wHACrB,2HAMdu3C,EAAapW,YAAcr9C,KAAK+oD,KAAK4B,YAAY5qD,EAAO+G,aAAaH,GACrE,IAKIqa,GACAD,EACA4yC,EAPAC,EAAgB1B,EAAWhrC,YAAYnnB,EAAO8nB,cAAc,OAC5D7K,GAAIjd,EAAOgO,QAAQiP,GAAK,iBACxB02C,OAAQ,wBAERlyD,EAAQzB,EAAO4iD,uBAAuBh8C,EAI7B,gBAATA,GAAkC,aAATA,GAAgC,eAATA,GAAkC,aAATA,GACrE5G,EAAO4qB,iBACM,eAAThkB,GAAyB5G,EAAO4qB,iBAAiBrB,YACjDtI,EAAMjhB,EAAO4qB,iBAAiBrB,WAAWtI,IACzCD,EAAMhhB,EAAO4qB,iBAAiBrB,WAAWvI,KAE3B,aAATpa,GAAuB5G,EAAO4qB,iBAAiBpB,UACpDvI,EAAMjhB,EAAO4qB,iBAAiBpB,SAASvI,IACvCD,EAAMhhB,EAAO4qB,iBAAiBpB,SAASxI,KAEzB,eAATpa,GAAyB5G,EAAO4qB,iBAAiBlB,YACtDzI,EAAMjhB,EAAO4qB,iBAAiBlB,WAAWzI,IACzCD,EAAMhhB,EAAO4qB,iBAAiBlB,WAAW1I,KAE3B,aAATpa,GAAuB5G,EAAO4qB,iBAAiBhB,UACpD3I,EAAMjhB,EAAO4qB,iBAAiBhB,SAAS3I,IACvCD,EAAMhhB,EAAO4qB,iBAAiBhB,SAAS5I,MAGvCC,GAAO,IACPD,EAAM,MAIVC,GAAO,IACPD,EAAM,KAEV4yC,EAAS3zD,KAAK6zD,aAAa7yC,EAAKD,EAAKvf,EAAOmF,IAE9B,QAATA,GAA2B,SAATA,GAA4B,YAATA,IACtC5G,EAAO4qB,iBACM,QAAThkB,GAAkB5G,EAAO4qB,iBAAiBnB,KAC1CxI,EAAMjhB,EAAO4qB,iBAAiBnB,IAAIxI,IAClCD,EAAMhhB,EAAO4qB,iBAAiBnB,IAAIzI,KAEpB,SAATpa,GAAmB5G,EAAO4qB,iBAAiBjB,MAChD1I,EAAMjhB,EAAO4qB,iBAAiBjB,KAAK1I,IACnCD,EAAMhhB,EAAO4qB,iBAAiBjB,KAAK3I,KAErB,YAATpa,GAAsB5G,EAAO4qB,iBAAiB7O,SACnDkF,EAAMjhB,EAAO4qB,iBAAiB7O,QAAQkF,IACtCD,EAAMhhB,EAAO4qB,iBAAiB7O,QAAQiF,MAGtCC,EAAM,EACND,EAAM,MAIVC,EAAM,EACND,EAAM,KAEV4yC,EAAS3zD,KAAK6zD,aAAa7yC,EAAKD,EAAKvf,EAAOmF,IAEhDgtD,EAAOvvC,SAAS,IAAMrkB,EAAOgO,QAAQiP,GAAK,kBAC1C42C,EAAc/3C,MAAMZ,MAAQ0M,WAAWitB,EAAc/4B,MAAMxb,OAASsnB,WAAWgsC,EAAOtzD,QAAU,EAAI,MAExG85C,EAAct5C,UAAUgzD,aAAe,SAAU7yC,EAAKD,EAAKvf,EAAOmF,GAC9D,GAAI4E,GAAQvL,KACRD,EAASC,KAAKD,MAClB,OAAO,IAAI+zD,WACPtyD,MAAOA,EACPuyD,SAAWC,WAAW,EAAMC,UAAW,SAAUC,OAAQ,UACzDvtD,KAAM,WACNqa,IAAKA,EACLD,IAAKA,EACLnD,KAAM,GACNvd,MAAO4b,UAAQC,SAAW,QAAU,QACpCg/B,SAAU,WACVmU,OAAQ,SAAUjuD,GACdrB,EAAOghD,uBAAuBp6C,EAAMvF,EAAKI,OACzC+J,EAAM89C,0BAIlBlP,EAAct5C,UAAUwyD,mBAAqB,WACzC,GAAItzD,GAASC,KAAKD,QACdgd,SAASZ,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,mBACjDjd,EAAO0F,YAAY0X,cACnBpd,EAAOud,uBAAyBtd,KAAKqC,aAAasC,OAClD5E,EAAOqd,aAAepd,KAAKqC,aAAasC,OACxC5E,EAAO0F,YAAY0X,YAAa,IAGxCg9B,EAAct5C,UAAUszD,YAAc,WAWlC,IAAK,GAVDp0D,GAASC,KAAKD,OAUT46B,EAAK,EAAGy5B,GARb,IAAMr0D,EAAOgO,QAAQiP,GAAK,cAC1B,IAAMjd,EAAOgO,QAAQiP,GAAK,YAC1B,IAAMjd,EAAOgO,QAAQiP,GAAK,OAC1B,IAAMjd,EAAOgO,QAAQiP,GAAK,cAC1B,IAAMjd,EAAOgO,QAAQiP,GAAK,WAC1B,IAAMjd,EAAOgO,QAAQiP,GAAK,QAC1B,IAAMjd,EAAOgO,QAAQiP,GAAK,aAEY2d,EAAKy5B,EAAYjvD,OAAQw1B,IAAM,CACrE,GAAIy3B,GAAWgC,EAAYz5B,GACvB5sB,EAAUgP,SAASZ,cAAci2C,EACrC,IAAIrkD,EAAQkP,UAAUC,SAAS,kBAAmB,CAC9CnP,EAAQkP,UAAU+O,OAAO,iBACzB,UAIZmuB,EAAct5C,UAAUqyD,WAAa,SAAUvsD,GAC3C3G,KAAKm0D,cACLn0D,KAAKD,OAAO0F,YAAY0X,YAAa,EACrCnd,KAAK02C,eAAe,QAAS,KAAM,KAAM,KAAM/vC,GAC/CoW,SAAS0F,eAAeziB,KAAKD,OAAOgO,QAAQiP,GAAK,IAAMrW,GAAMsW,UAAUa,IAAI,mBAE/Eq8B,EAAct5C,UAAUupD,cAAgB,WACpC,GAAIwJ,GAAgB72C,SAASZ,cAAc,IAAMnc,KAAKD,OAAOgO,QAAQiP,GAAK,kBAEtE22C,EAAS52C,SAASZ,cAAc,aAChC+1C,EAAan1C,SAASZ,cAAc,IAAMnc,KAAKD,OAAOgO,QAAQiP,GAAK,eACnEk1C,KACAA,EAAWr2C,MAAMG,QAAU,QAE3B43C,GAAiBD,IACjBA,EAAOU,cAAc,GAAGvzD,UACxB8yD,EAAc5nC,WAGtBmuB,EAAct5C,UAAUsoD,mBAAqB,WACzC,GAAIppD,GAASC,KAAKD,MAClB,IAAKA,EAAO0L,cAAZ,CAGA,GAAI6oD,GAAcv0D,EAAOgO,QAAQoO,cAAc,6CAC3Co4C,EAAgBx0D,EAAOgO,QAAQoO,cAAc,+CAC7Cq4C,EAAoBz0D,EAAOgO,QAAQoO,cAAc,wDACjDs4C,EAAmB10D,EAAOgO,QAAQoO,cAAc,yDAChDu4C,EAAkB30D,EAAOgO,QAAQoO,cAAc,yBAC/Cw4C,EAAiB50D,EAAOgO,QAAQoO,cAAc,uBAC9Cy4C,EAAe70D,EAAOgO,QAAQoO,cAAc,qBAC5C04C,EAAU90D,EAAOgO,QAAQoO,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,SACjE83C,EAAY/0D,EAAOgO,QAAQoO,cAAc,IAAMpc,EAAOgO,QAAQiP,GAAK,UAsCvE,IArCI/a,oBAAkBlC,EAAO6C,UAAUmQ,eAAe9D,eAClDlP,EAAO6C,UAAUmQ,eAAe9D,YAAc,GAE9CqlD,IACkD,KAA9Cv0D,EAAO6C,UAAUmQ,eAAe/D,UAChCslD,EAAYr3C,UAAUa,IAAI,mBAG1Bw2C,EAAYr3C,UAAU+O,OAAO,kBAC7BsoC,EAAYz4C,MAAM+zC,WAAa7vD,EAAO6C,UAAUmQ,eAAe/D,WAEnEkU,eAAanjB,EAAOgO,QAAQiP,GAAK,cAAe,eAAexb,MACzDzB,EAAO6C,UAAUmQ,eAAe/D,UAAY,MAElDulD,IACAA,EAAc14C,MAAM+zC,WAAa7vD,EAAO6C,UAAUmQ,eAAehE,YACjEmU,eAAanjB,EAAOgO,QAAQiP,GAAK,gBAAiB,eAAexb,MAC3DzB,EAAO6C,UAAUmQ,eAAehE,YAAc,MAEpDylD,IACAA,EAAkB34C,MAAM+zC,WAAa7vD,EAAO6C,UAAUmQ,eAAehE,YACrEmU,eAAanjB,EAAOgO,QAAQiP,GAAK,aAAc,eAAexb,MACxDzB,EAAO6C,UAAUmQ,eAAehE,YAAc,MAEpD0lD,IACAA,EAAiB54C,MAAM+zC,WAAa7vD,EAAO6C,UAAUmQ,eAAehE,YACpEmU,eAAanjB,EAAOgO,QAAQiP,GAAK,cAAe,eAAexb,MACzDzB,EAAO6C,UAAUmQ,eAAehE,YAAc,MAEpD4lD,IACI14C,UAAQC,SACRy4C,EAAe/3C,aAAa,QAAS,eAAiB7c,EAAO6C,UAAUyF,aAAa+G,WAAWwD,eAG/F+hD,EAAetX,YAAct9C,EAAO6C,UAAUyF,aAAa+G,YAG/DwlD,EACA,IAAK,GAAI5vD,GAAI,EAAGA,EAAIjF,EAAOi6C,aAAa70C,OAAQH,IAC5C,GAAIyoB,SAAS1tB,EAAOi6C,aAAah1C,GAAGmK,KAAM,KAAOhH,KAAK2jB,MAAM/rB,EAAO6C,UAAUyF,aAAaE,UAAW,CACjGqsD,EAAavX,aAAer4C,EAAI,GAAGqgB,UACnC,OAoBZ,GAhBIwvC,IACI90D,EAAO6C,UAAUyF,aAAagH,KAC9BwlD,EAAQ53C,UAAUa,IAAI,kBAGtB+2C,EAAQ53C,UAAU+O,OAAO,mBAG7B8oC,IACI/0D,EAAO6C,UAAUyF,aAAaiH,OAC9BwlD,EAAU73C,UAAUa,IAAI,kBAGxBg3C,EAAU73C,UAAU+O,OAAO,mBAG/B0oC,EAAiB,CACjB,GAAIzlD,GAAc9G,KAAK2jB,MAAO/rB,EAAO6C,UAAUmQ,4BAA6BsS,UAC5EqvC,GAAgBrX,YAAcr9C,KAAK+0D,eAAe9lD,MAG1DkrC,EAAct5C,UAAUk0D,eAAiB,SAAU5lD,GAC/C,GAAIF,EAEJ,QADmBwe,SAASte,EAAM,IAAM,GAEpC,IAAK,GACDF,EAAcjP,KAAK+oD,KAAK4B,YAAY,SACpC,MACJ,KAAK,GACD17C,EAAcjP,KAAK+oD,KAAK4B,YAAY,QACpC,MACJ,KAAK,GACD17C,EAAcjP,KAAK+oD,KAAK4B,YAAY,SACpC,MACJ,KAAK,GACD17C,EAAcjP,KAAK+oD,KAAK4B,YAAY,QACpC,MACJ,KAAK,GACD17C,EAAcjP,KAAK+oD,KAAK4B,YAAY,UAG5C,MAAO17C,IAEXkrC,EAAct5C,UAAUutD,UAAY,WAChC,GAAIruD,GAASC,KAAKD,MAClBA,GAAO+C,OAAO,SAAWxB,KAAM,cAAeyB,kBAAkB,EAAOvB,OAAS+Z,aAAa,IAC7F,IAAIm4B,GAAS3zC,EAAOgO,QAAQoO,cAAc,oBACtCu3B,IACAA,EAAOz2B,UAAU+O,OAAO,kBAE5BjsB,EAAO4F,KAAI,IAEfw0C,EAAct5C,UAAU2oD,mBAAqB,WAChB,SAArBxpD,KAAK2kD,aACL3kD,KAAK02C,eAAe,SAG5ByD,EAAct5C,UAAUmpD,qBAAuB,WAI3C,IAAK,GAHDjqD,GAASC,KAAKD,OACd4kB,EAAe5kB,EAAOgO,QAAQ2wC,iBAAiB,mBAC/CsW,EAAaj1D,EAAOgO,QAAQ2wC,iBAAiB,oBACxC15C,EAAI,EAAGC,EAAM0f,EAAaxf,OAAQH,EAAIC,EAAKD,IAC5C2f,EAAa3f,GAAGiY,UAAUC,SAAS,oBACnCgG,eAAayB,EAAa3f,GAAI,gBAAgBlE,UAC9Cm0D,SAAO3jD,SAAO,SAAWqT,EAAa3f,GAAGgY,GAAIjd,EAAOgO,UAG5D,KAAK,GAAI/I,GAAI,EAAGC,EAAM+vD,EAAW7vD,OAAQH,EAAIC,EAAKD,IAC1CgwD,EAAWhwD,GAAGiY,UAAUC,SAAS,mBACjCgG,eAAa8xC,EAAWhwD,GAAI,gBAAgBlE,UAC5Cm0D,SAAO3jD,SAAO,UAAY0jD,EAAWhwD,GAAGgY,GAAIjd,EAAOgO,WAE9CinD,EAAWhwD,GAAGiY,UAAUC,SAAS,WACtCgG,eAAa8xC,EAAWhwD,GAAI,OAAOlE,UACnCm0D,SAAO3jD,SAAO,UAAY0jD,EAAWhwD,GAAGgY,GAAIjd,EAAOgO,YAI/DosC,EAAct5C,UAAUstD,wBAA0B,SAAU/sD,GACxD,GAAIrB,GAASC,KAAKD,MAClBA,GAAO+C,OAAO,SAAWxB,KAAM,mBAAoByB,kBAAkB,IACrEhD,EAAO0F,YAAYL,MAAQhE,EAAKqsC,KAAKzwB,GACrCjd,EAAO6C,UAAUwC,MAAQrF,EAAO0F,YAAYL,MAAMwN,cAClD7S,EAAO0F,YAAYwZ,WAAalf,EAAO0F,YAAYC,cAAe,EAClE3F,EAAO6C,UAAUsF,YAAcnI,EAAOiD,UAAUC,OAChDlD,EAAO6C,UAAUmE,UAAYhH,EAAOiD,UAAUU,cAC9C3D,EAAO6C,UAAUkoC,SAAW/qC,EAAOiD,UAAUU,cAC7C3D,EAAO6C,UAAUmV,gBAErBoiC,EAAct5C,UAAUsB,cAAgB,WACpC,MAAO,kBAEJg4C"}