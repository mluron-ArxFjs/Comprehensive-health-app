/*!
*  filename: ej2-ribbon.umd.min.js
*  version : 22.2.5
*  Copyright Syncfusion Inc. 2001 - 2020. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@syncfusion/ej2-base"),require("@syncfusion/ej2-navigations"),require("@syncfusion/ej2-dropdowns"),require("@syncfusion/ej2-splitbuttons"),require("@syncfusion/ej2-buttons"),require("@syncfusion/ej2-inputs"),require("@syncfusion/ej2-popups")):"function"==typeof define&&define.amd?define(["exports","@syncfusion/ej2-base","@syncfusion/ej2-navigations","@syncfusion/ej2-dropdowns","@syncfusion/ej2-splitbuttons","@syncfusion/ej2-buttons","@syncfusion/ej2-inputs","@syncfusion/ej2-popups"],t):t(e.ej={},e.ej2Base,e.ej2Navigations,e.ej2Dropdowns,e.ej2Splitbuttons,e.ej2Buttons,e.ej2Inputs,e.ej2Popups)}(this,function(e,t,o,i,r,n,s,l){"use strict";function a(e,t){for(var o=0;o<e.length;o++)if(t(e[parseInt(o.toString(),10)],o))return o;return-1}function c(e){if("string"==typeof e){var o="";try{var i=t.select(e);o=i?"SCRIPT"===i.tagName?i.innerHTML:i.outerHTML:e}catch(t){o=e}return t.compile(o)}return t.compile(e)}function p(e,t){for(var o=0;o<e.length;o++)for(var i=e[parseInt(o.toString(),10)],r=0;r<i.groups.length;r++)for(var n=i.groups[parseInt(r.toString(),10)],s=0;s<n.collections.length;s++)for(var l=n.collections[parseInt(s.toString(),10)],a=0;a<l.items.length;a++){var c=l.items[parseInt(a.toString(),10)];if(c.id===t)return{item:c,collection:l,group:n,tabIndex:o,groupIndex:r,collectionIndex:s,itemIndex:a}}return null}function u(e,t){for(var o=0;o<e.length;o++)for(var i=e[parseInt(o.toString(),10)],r=0;r<i.groups.length;r++)for(var n=i.groups[parseInt(r.toString(),10)],s=0;s<n.collections.length;s++){var l=n.collections[parseInt(s.toString(),10)];if(l.id===t)return{collection:l,group:n,tabIndex:o,groupIndex:r,collectionIndex:s}}return null}function d(e,t){for(var o=0;o<e.length;o++)for(var i=e[parseInt(o.toString(),10)],r=0;r<i.groups.length;r++){var n=i.groups[parseInt(r.toString(),10)];if(n.id===t)return{group:n,tabIndex:o,groupIndex:r}}return null}function b(e,o){t.getComponent(e,o).destroy()}function h(e,o,i){t.getComponent(e,o).setProperties(i)}function f(e,o,i){t.getComponent(e,o).setProperties("combobox"===o?{enabled:!i}:{disabled:i})}function m(o,i,n){if(!n&&!(n=p(o.tabs,i)))return null;var s=o.tabObj.items[n.tabIndex].content;if(""===s.innerHTML)return null;if(o.activeLayout===e.RibbonLayout.Classic)return n.item.displayOptions&e.DisplayMode.Classic?(s=n.group.isCollapsed?o.ribbonDropDownModule.getOverflowDropDownPopup(n,s):s).querySelector("#"+i):null;var l=n.item.displayOptions&e.DisplayMode.Simplified?s.querySelector("#"+n.item.id):null;if(!l){l=(n.group.enableGroupOverflow?t.getComponent(s.querySelector("#"+n.group.id+nt),r.DropDownButton):o.overflowDDB).target.querySelector("#"+n.item.id)}return l}function v(e){return!!(e.content||e.iconCss||e.title||e.id||e.cssClass)}function y(e,t,o){var i=e.target.getAttribute("id"),r=o.filter(function(e){return e.id===i})[0].data,n=t.createElement("div",{id:r.id?et+"_"+r.id:et});if(t.element.append(n),r.title){var s=t.createElement("div",{innerHTML:r.title,className:Je});n.appendChild(s)}var l=t.createElement("div",{className:tt});if(n.appendChild(l),r.iconCss){var a=t.createElement("div",{className:r.iconCss+" "+$e});l.appendChild(a)}if(r.content){var c=t.createElement("div",{innerHTML:r.content,className:Qe});l.appendChild(c)}t.setProperties({content:n,cssClass:r.cssClass?r.cssClass+" "+Ze:Ze})}function g(e,t){var o=new l.Tooltip({target:"."+Ye,beforeRender:function(e){y(e,o,t.tooltipData)}.bind(this),windowCollision:!0});o.appendTo(e)}function S(e){t.getComponent(e,l.Tooltip).destroy()}function I(e,o){t.getComponent(e,l.Tooltip).setProperties(o)}!function(e){e.Classic="Classic",e.Simplified="Simplified"}(e.RibbonLayout||(e.RibbonLayout={})),function(e){e.Row="Row",e.Column="Column"}(e.ItemOrientation||(e.ItemOrientation={})),function(e){e[e.Large=4]="Large",e[e.Medium=2]="Medium",e[e.Small=1]="Small"}(e.RibbonItemSize||(e.RibbonItemSize={})),function(e){e[e.Classic=4]="Classic",e[e.Simplified=2]="Simplified",e[e.Overflow=1]="Overflow",e[e.Auto=7]="Auto"}(e.DisplayMode||(e.DisplayMode={})),function(e){e.Button="Button",e.CheckBox="CheckBox",e.ColorPicker="ColorPicker",e.ComboBox="ComboBox",e.DropDown="DropDown",e.SplitButton="SplitButton",e.Template="Template"}(e.RibbonItemType||(e.RibbonItemType={}));var C=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function i(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),O=function(e,t,o,i){var r,n=arguments.length,s=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(n<3?r(s):n>3?r(t,o,s):r(t,o))||s);return n>3&&s&&Object.defineProperty(t,o,s),s},w=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return C(o,e),o.prototype.setProperties=function(t,o){e.prototype.setProperties.call(this,t,o)},O([t.Property("")],o.prototype,"content",void 0),O([t.Property("")],o.prototype,"cssClass",void 0),O([t.Property("")],o.prototype,"iconCss",void 0),O([t.Property(!1)],o.prototype,"isToggle",void 0),O([t.Property(!1)],o.prototype,"isPrimary",void 0),O([t.Event()],o.prototype,"created",void 0),O([t.Event()],o.prototype,"clicked",void 0),o}(t.ChildProperty),D=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function i(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),P=function(e,t,o,i){var r,n=arguments.length,s=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(n<3?r(s):n>3?r(t,o,s):r(t,o))||s);return n>3&&s&&Object.defineProperty(t,o,s),s},B=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return D(o,e),o.prototype.setProperties=function(t,o){e.prototype.setProperties.call(this,t,o)},P([t.Property(!1)],o.prototype,"checked",void 0),P([t.Property("")],o.prototype,"cssClass",void 0),P([t.Property("")],o.prototype,"label",void 0),P([t.Property("After")],o.prototype,"labelPosition",void 0),P([t.Event()],o.prototype,"created",void 0),P([t.Event()],o.prototype,"change",void 0),o}(t.ChildProperty),L=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function i(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),R=function(e,t,o,i){var r,n=arguments.length,s=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(n<3?r(s):n>3?r(t,o,s):r(t,o))||s);return n>3&&s&&Object.defineProperty(t,o,s),s},T=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return L(o,e),o.prototype.setProperties=function(t,o){e.prototype.setProperties.call(this,t,o)},R([t.Property(10)],o.prototype,"columns",void 0),R([t.Property("")],o.prototype,"cssClass",void 0),R([t.Property(!0)],o.prototype,"enableOpacity",void 0),R([t.Property("Picker")],o.prototype,"mode",void 0),R([t.Property(!0)],o.prototype,"modeSwitcher",void 0),R([t.Property(!1)],o.prototype,"noColor",void 0),R([t.Property(null)],o.prototype,"presetColors",void 0),R([t.Property(!0)],o.prototype,"showButtons",void 0),R([t.Property("#008000ff")],o.prototype,"value",void 0),R([t.Event()],o.prototype,"beforeClose",void 0),R([t.Event()],o.prototype,"beforeOpen",void 0),R([t.Event()],o.prototype,"beforeTileRender",void 0),R([t.Event()],o.prototype,"created",void 0),R([t.Event()],o.prototype,"change",void 0),R([t.Event()],o.prototype,"open",void 0),R([t.Event()],o.prototype,"select",void 0),o}(t.ChildProperty),x=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function i(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),E=function(e,t,o,i){var r,n=arguments.length,s=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(n<3?r(s):n>3?r(t,o,s):r(t,o))||s);return n>3&&s&&Object.defineProperty(t,o,s),s},k=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return x(o,e),o.prototype.setProperties=function(t,o){e.prototype.setProperties.call(this,t,o)},E([t.Property(!1)],o.prototype,"allowFiltering",void 0),E([t.Property(!0)],o.prototype,"autofill",void 0),E([t.Property("")],o.prototype,"cssClass",void 0),E([t.Property([])],o.prototype,"dataSource",void 0),E([t.Complex({text:null,value:null,iconCss:null,groupBy:null},i.FieldSettings)],o.prototype,"fields",void 0),E([t.Property("Contains")],o.prototype,"filterType",void 0),E([t.Property(null)],o.prototype,"footerTemplate",void 0),E([t.Property(null)],o.prototype,"groupTemplate",void 0),E([t.Property(null)],o.prototype,"headerTemplate",void 0),E([t.Property(null)],o.prototype,"index",void 0),E([t.Property(null)],o.prototype,"itemTemplate",void 0),E([t.Property("No records found")],o.prototype,"noRecordsTemplate",void 0),E([t.Property(null)],o.prototype,"placeholder",void 0),E([t.Property("300px")],o.prototype,"popupHeight",void 0),E([t.Property("100%")],o.prototype,"popupWidth",void 0),E([t.Property(!0)],o.prototype,"showClearButton",void 0),E([t.Property("None")],o.prototype,"sortOrder",void 0),E([t.Property(null)],o.prototype,"text",void 0),E([t.Property(null)],o.prototype,"value",void 0),E([t.Property("150px")],o.prototype,"width",void 0),E([t.Event()],o.prototype,"beforeOpen",void 0),E([t.Event()],o.prototype,"change",void 0),E([t.Event()],o.prototype,"close",void 0),E([t.Event()],o.prototype,"created",void 0),E([t.Event()],o.prototype,"filtering",void 0),E([t.Event()],o.prototype,"open",void 0),E([t.Event()],o.prototype,"select",void 0),o}(t.ChildProperty),M=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function i(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),_=function(e,t,o,i){var r,n=arguments.length,s=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(n<3?r(s):n>3?r(t,o,s):r(t,o))||s);return n>3&&s&&Object.defineProperty(t,o,s),s},z=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return M(o,e),o.prototype.setProperties=function(t,o){e.prototype.setProperties.call(this,t,o)},_([t.Property("")],o.prototype,"closeActionEvents",void 0),_([t.Property("")],o.prototype,"content",void 0),_([t.Property("")],o.prototype,"cssClass",void 0),_([t.Property("")],o.prototype,"iconCss",void 0),_([t.Collection([],r.Item)],o.prototype,"items",void 0),_([t.Property("")],o.prototype,"target",void 0),_([t.Event()],o.prototype,"beforeClose",void 0),_([t.Event()],o.prototype,"beforeItemRender",void 0),_([t.Event()],o.prototype,"beforeOpen",void 0),_([t.Event()],o.prototype,"close",void 0),_([t.Event()],o.prototype,"created",void 0),_([t.Event()],o.prototype,"open",void 0),_([t.Event()],o.prototype,"select",void 0),o}(t.ChildProperty),q=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function i(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),j=function(e,t,o,i){var r,n=arguments.length,s=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(n<3?r(s):n>3?r(t,o,s):r(t,o))||s);return n>3&&s&&Object.defineProperty(t,o,s),s},A=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return q(o,e),o.prototype.setProperties=function(t,o){e.prototype.setProperties.call(this,t,o)},j([t.Property("")],o.prototype,"closeActionEvents",void 0),j([t.Property("")],o.prototype,"content",void 0),j([t.Property("")],o.prototype,"cssClass",void 0),j([t.Property("")],o.prototype,"iconCss",void 0),j([t.Collection([],r.Item)],o.prototype,"items",void 0),j([t.Property("")],o.prototype,"target",void 0),j([t.Event()],o.prototype,"beforeClose",void 0),j([t.Event()],o.prototype,"beforeItemRender",void 0),j([t.Event()],o.prototype,"beforeOpen",void 0),j([t.Event()],o.prototype,"close",void 0),j([t.Event()],o.prototype,"click",void 0),j([t.Event()],o.prototype,"created",void 0),j([t.Event()],o.prototype,"open",void 0),j([t.Event()],o.prototype,"select",void 0),o}(t.ChildProperty),N=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function i(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),W=function(e,t,o,i){var r,n=arguments.length,s=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(n<3?r(s):n>3?r(t,o,s):r(t,o))||s);return n>3&&s&&Object.defineProperty(t,o,s),s},F=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return N(o,e),W([t.Property("")],o.prototype,"cssClass",void 0),W([t.Property("")],o.prototype,"id",void 0),W([t.Property("")],o.prototype,"title",void 0),W([t.Property("")],o.prototype,"content",void 0),W([t.Property("")],o.prototype,"iconCss",void 0),o}(t.ChildProperty),H=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function i(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),G=function(e,t,o,i){var r,n=arguments.length,s=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(n<3?r(s):n>3?r(t,o,s):r(t,o))||s);return n>3&&s&&Object.defineProperty(t,o,s),s},U=function(o){function i(){return null!==o&&o.apply(this,arguments)||this}return H(i,o),i.prototype.setProperties=function(e,t){o.prototype.setProperties.call(this,e,t)},G([t.Property(e.RibbonItemSize.Medium)],i.prototype,"activeSize",void 0),G([t.Property(e.RibbonItemSize.Small|e.RibbonItemSize.Medium|e.RibbonItemSize.Large)],i.prototype,"allowedSizes",void 0),G([t.Property("")],i.prototype,"id",void 0),G([t.Property("")],i.prototype,"cssClass",void 0),G([t.Property(!1)],i.prototype,"disabled",void 0),G([t.Property("")],i.prototype,"itemTemplate",void 0),G([t.Property("Button")],i.prototype,"type",void 0),G([t.Property(e.DisplayMode.Auto)],i.prototype,"displayOptions",void 0),G([t.Complex({},F)],i.prototype,"ribbonTooltipSettings",void 0),G([t.Complex({},w)],i.prototype,"buttonSettings",void 0),G([t.Complex({},z)],i.prototype,"dropDownSettings",void 0),G([t.Complex({},B)],i.prototype,"checkBoxSettings",void 0),G([t.Complex({},T)],i.prototype,"colorPickerSettings",void 0),G([t.Complex({},k)],i.prototype,"comboBoxSettings",void 0),G([t.Complex({},A)],i.prototype,"splitButtonSettings",void 0),i}(t.ChildProperty),V=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function i(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),K=function(e,t,o,i){var r,n=arguments.length,s=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(n<3?r(s):n>3?r(t,o,s):r(t,o))||s);return n>3&&s&&Object.defineProperty(t,o,s),s},X=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return V(o,e),o.prototype.setProperties=function(t,o){e.prototype.setProperties.call(this,t,o)},K([t.Property("")],o.prototype,"id",void 0),K([t.Property("")],o.prototype,"cssClass",void 0),K([t.Collection([],U)],o.prototype,"items",void 0),o}(t.ChildProperty),Z=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function i(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),Y=function(e,t,o,i){var r,n=arguments.length,s=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(n<3?r(s):n>3?r(t,o,s):r(t,o))||s);return n>3&&s&&Object.defineProperty(t,o,s),s},J=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return Z(o,e),o.prototype.setProperties=function(t,o){e.prototype.setProperties.call(this,t,o)},Y([t.Collection([],X)],o.prototype,"collections",void 0),Y([t.Property("")],o.prototype,"cssClass",void 0),Y([t.Property("")],o.prototype,"id",void 0),Y([t.Property(!1)],o.prototype,"isCollapsed",void 0),Y([t.Property(!0)],o.prototype,"isCollapsible",void 0),Y([t.Property(!1)],o.prototype,"enableGroupOverflow",void 0),Y([t.Property("")],o.prototype,"groupIconCss",void 0),Y([t.Property("")],o.prototype,"header",void 0),Y([t.Property("Column")],o.prototype,"orientation",void 0),Y([t.Property(0)],o.prototype,"priority",void 0),Y([t.Property(!1)],o.prototype,"showLauncherIcon",void 0),o}(t.ChildProperty),Q=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function i(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),$=function(e,t,o,i){var r,n=arguments.length,s=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(n<3?r(s):n>3?r(t,o,s):r(t,o))||s);return n>3&&s&&Object.defineProperty(t,o,s),s},ee=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return Q(o,e),o.prototype.setProperties=function(t,o){e.prototype.setProperties.call(this,t,o)},$([t.Property("")],o.prototype,"id",void 0),$([t.Property("")],o.prototype,"cssClass",void 0),$([t.Collection([],J)],o.prototype,"groups",void 0),$([t.Property("")],o.prototype,"header",void 0),o}(t.ChildProperty),te=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function i(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),oe=function(e,t,o,i){var r,n=arguments.length,s=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(n<3?r(s):n>3?r(t,o,s):r(t,o))||s);return n>3&&s&&Object.defineProperty(t,o,s),s},ie=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return te(i,e),i.prototype.setProperties=function(t,o){e.prototype.setProperties.call(this,t,o)},oe([t.Property("File")],i.prototype,"text",void 0),oe([t.Property(!1)],i.prototype,"visible",void 0),oe([t.Collection([],o.MenuItem)],i.prototype,"menuItems",void 0),oe([t.Property(!1)],i.prototype,"showItemOnClick",void 0),oe([t.Complex({},o.MenuAnimationSettings)],i.prototype,"animationSettings",void 0),oe([t.Property("")],i.prototype,"itemTemplate",void 0),oe([t.Property("")],i.prototype,"popupTemplate",void 0),oe([t.Complex({},F)],i.prototype,"ribbonTooltipSettings",void 0),oe([t.Event()],i.prototype,"beforeClose",void 0),oe([t.Event()],i.prototype,"beforeOpen",void 0),oe([t.Event()],i.prototype,"beforeItemRender",void 0),oe([t.Event()],i.prototype,"close",void 0),oe([t.Event()],i.prototype,"open",void 0),oe([t.Event()],i.prototype,"select",void 0),i}(t.ChildProperty),re="e-ribbon-vertical-center",ne="e-icons e-drop-icon",se="e-icons e-more-horizontal-1",le="e-vertical",ae="e-disabled",ce="e-rtl",pe="e-ribbon-hover",ue="e-ribbon-control",de="e-ribbon-popup-control",be="e-ribbon-open",he="e-hscroll-bar",fe="e-ribbon-hide",me="e-ribbon-active",ve="e-ribbon-tab-item",ye="e-ribbon-collapse-btn",ge="e-ribbon-expand-btn",Se="e-ribbon-collapsible",Ie="e-ribbon-overall-of-btn",Ce="e-ribbon-group-of-btn",Oe="e-ribbon-overflow-target",we="e-ribbon-overflow",De="e-content",Pe="e-ribbon-minimize",Be="e-ribbon-group",Le="e-ribbon-group-container",Re="e-ribbon-of-tab",Te="e-ribbon-of-group-container",xe="e-ribbon-group-content",Ee="e-ribbon-group-header",ke="e-ribbon-overflow-header",Me="e-ribbon-group-overflow",_e="e-ribbon-group-overflow-ddb",ze="e-ribbon-launcher",qe="e-ribbon-launcher-icon",je="e-icons e-launcher",Ae="e-ribbon-collection",Ne="e-ribbon-item",We="e-ribbon-row",Fe="e-ribbon-column",He="e-ribbon-large-item",Ge="e-ribbon-medium-item",Ue="e-ribbon-small-item",Ve="e-ribbon-content-height",Ke="e-ribbon-template",Xe="e-ribbon-help-template",Ze="e-ribbon-tooltip",Ye="e-ribbon-tooltip-target",Je="e-ribbon-tooltip-title",Qe="e-ribbon-tooltip-content",$e="e-ribbon-tooltip-icon",et="e-ribbon-tooltip-container",tt="e-ribbon-text-container",ot="e-ribbon-simplified-mode",it="_collapsebutton",rt="_sim_ovrl_overflow",nt="_sim_grp_overflow",st="_header",lt="_launcher",at="_content",ct="_container",pt="_overflow",ut="_dropdown",dt="_filemenulist",bt="_helppanetemplate",ht="--fileMenuWidth",ft="--helpTemplateWidth",mt=function(){function o(e){this.parent=e}return o.prototype.getModuleName=function(){return"ribbonButton"},o.prototype.destroy=function(){this.parent=null},o.prototype.createButton=function(t,o){var i=this,r=this.parent.createElement("button",{id:t.id});o.appendChild(r);var s=t.buttonSettings;new n.Button({locale:this.parent.locale,enableRtl:this.parent.enableRtl,enablePersistence:this.parent.enablePersistence,iconPosition:t.activeSize===e.RibbonItemSize.Large?"Top":"Left",iconCss:s.iconCss,disabled:t.disabled,cssClass:(re+" "+ue+" "+(s.cssClass?s.cssClass:"")).trim(),content:t.activeSize===e.RibbonItemSize.Small?"":s.content,isPrimary:s.isPrimary,isToggle:s.isToggle,created:s.created},r),r.onclick=function(e){s.clicked&&s.clicked.call(i,e)},r.setAttribute("aria-label",s.content)},o.prototype.addOverFlowEvents=function(e,o,i){var r=this,s=o.querySelector("#"+e.id);s.setAttribute("data-control",e.type.toString());var l=t.getComponent(s,n.Button);l.setProperties({cssClass:l.cssClass+" "+de}),s.onclick=function(t){e.buttonSettings.clicked&&e.buttonSettings.clicked.call(r,t),i.toggle()}},o.prototype.removeOverFlowEvents=function(e,o){var i=this,r=o.querySelector("#"+e.id),s=t.getComponent(r,n.Button),l=s.cssClass.split(" ");l=l.filter(function(e){return e!==de}),s.setProperties({cssClass:l.join(" ")}),r.onclick=function(t){e.buttonSettings.clicked&&e.buttonSettings.clicked.call(i,t)}},o.prototype.click=function(e){var o=m(this.parent,e);if(o){t.getComponent(o,n.Button).click()}},o.prototype.updateButton=function(o,i){var r=p(this.parent.tabs,i);if(r){t.merge(r.item.buttonSettings,o);var s=m(this.parent,i,r);if(s){var l=t.getComponent(s,n.Button);o.cssClass&&(o.cssClass=(re+" "+ue+" "+o.cssClass).trim()),o.content&&(o.content=r.item.activeSize===e.RibbonItemSize.Small?"":o.content,s.setAttribute("aria-label",o.content)),delete o.clicked,l.setProperties(o)}}},o.prototype.updateButtonSize=function(o,i){t.getComponent(o,n.Button).setProperties({iconPosition:i.activeSize===e.RibbonItemSize.Large?"Top":"Left",content:i.activeSize===e.RibbonItemSize.Small?"":i.buttonSettings.content})},o}(),vt=function(){function e(e){this.parent=e}return e.prototype.getModuleName=function(){return"ribbonCheckBox"},e.prototype.destroy=function(){this.parent=null},e.prototype.createCheckBox=function(e,t){var o=this,i=this.parent.createElement("input",{id:e.id});t.appendChild(i);var r=e.checkBoxSettings;new n.CheckBox({locale:this.parent.locale,enableRtl:this.parent.enableRtl,enablePersistence:this.parent.enablePersistence,checked:r.checked,cssClass:(ue+" "+(r.cssClass?r.cssClass:"")).trim(),label:r.label,labelPosition:r.labelPosition,disabled:e.disabled,created:r.created,change:function(e){r.change&&r.change.call(o,e)}},i)},e.prototype.addOverFlowEvents=function(e,o,i){var r=this,s=o.querySelector("#"+e.id);s.setAttribute("data-control",e.type.toString());var l=t.getComponent(s,n.CheckBox);l.cssClass=l.cssClass+" "+de,l.dataBind(),l.change=function(t){e.checkBoxSettings.change&&e.checkBoxSettings.change.call(r,t),i.toggle()}},e.prototype.removeOverFlowEvents=function(e,o){var i=this,r=o.querySelector("#"+e.id),s=t.getComponent(r,n.CheckBox),l=s.cssClass.split(" ");l=l.filter(function(e){return e!==de}),s.cssClass=l.join(" "),s.dataBind(),s.change=function(t){e.checkBoxSettings.change&&e.checkBoxSettings.change.call(i,t)}},e.prototype.click=function(e){var o=m(this.parent,e);if(o){t.getComponent(o,n.CheckBox).click()}},e.prototype.updateCheckBox=function(e,o){var i=p(this.parent.tabs,o);if(i){t.merge(i.item.checkBoxSettings,e);var r=m(this.parent,o,i);if(r){e.cssClass&&(e.cssClass=(ue+" "+e.cssClass).trim()),delete e.change;t.getComponent(r,n.CheckBox).setProperties(e)}}},e}(),yt=function(){function e(e){this.parent=e}return e.prototype.getModuleName=function(){return"ribbonColorPicker"},e.prototype.destroy=function(){this.parent=null},e.prototype.createColorPicker=function(e,o){var i=this,r=this.parent.createElement("input",{id:e.id});o.appendChild(r);var n=e.colorPickerSettings,l=new s.ColorPicker({locale:this.parent.locale,enableRtl:this.parent.enableRtl,enablePersistence:this.parent.enablePersistence,columns:n.columns,cssClass:(ue+" "+(n.cssClass?n.cssClass:"")).trim(),disabled:e.disabled,enableOpacity:n.enableOpacity,mode:n.mode,modeSwitcher:n.modeSwitcher,noColor:n.noColor,presetColors:n.presetColors,showButtons:n.showButtons,value:n.value,beforeClose:function(){l.element.parentElement.classList.remove(be),n.beforeClose&&n.beforeClose.call(i)},beforeOpen:n.beforeOpen,beforeTileRender:n.beforeTileRender,created:n.created,change:n.change,open:function(){l.element.parentElement.classList.add(be),n.open&&n.open.call(i)},select:n.select},r),a=l.element.parentElement;t.EventHandler.add(a,"mouseenter",this.toggleWrapperHover.bind(this,a,!0),this),t.EventHandler.add(a,"mouseleave",this.toggleWrapperHover.bind(this,a,!1),this)},e.prototype.toggleWrapperHover=function(e,t){t?e.classList.add(pe):e.classList.remove(pe)},e.prototype.addOverFlowEvents=function(e,o,i){var r=this,n=o.querySelector("#"+e.id);n.setAttribute("data-control",e.type.toString());var l=t.getComponent(n,s.ColorPicker);l.setProperties({cssClass:l.cssClass+" "+de});var a,c=l.splitBtn;l.beforeClose=function(t){a=t.event?t.event.target:null,l.element.parentElement.classList.remove(be),e.colorPickerSettings.beforeClose&&e.colorPickerSettings.beforeClose.call(r)},c.close=function(){a&&!a.closest(".e-ribbon-group-overflow-ddb")&&i.toggle()}},e.prototype.removeOverFlowEvents=function(e,o){var i=this,r=o.querySelector("#"+e.id),n=t.getComponent(r,s.ColorPicker),l=n.cssClass.split(" ");l=l.filter(function(e){return e!==de}),n.setProperties({cssClass:l.join(" ")});n.splitBtn.close=null,n.beforeClose=function(t){n.element.parentElement.classList.remove(be),e.colorPickerSettings.beforeClose&&e.colorPickerSettings.beforeClose.call(i)}},e.prototype.getColorPickerObj=function(e){var o=m(this.parent,e);return o?t.getComponent(o,s.ColorPicker):null},e.prototype.getValue=function(e,t,o){var i=this.getColorPickerObj(e);return i?i.getValue(t,o):""},e.prototype.toggle=function(e){var t=this.getColorPickerObj(e);t&&t.toggle()},e.prototype.updateColorPicker=function(e,o){var i=p(this.parent.tabs,o);if(i){t.merge(i.item.checkBoxSettings,e);var r=m(this.parent,o,i);if(r){e.cssClass&&(e.cssClass=(ue+" "+e.cssClass).trim()),delete e.beforeClose,delete e.open;t.getComponent(r,s.ColorPicker).setProperties(e)}}},e.prototype.unwireColorPickerEvents=function(e){var o=t.getComponent(e,s.ColorPicker).element.parentElement;t.EventHandler.remove(o,"mouseenter",this.toggleWrapperHover),t.EventHandler.remove(o,"mouseleave",this.toggleWrapperHover)},e}(),gt=function(){function e(e){this.parent=e}return e.prototype.getModuleName=function(){return"ribbonComboBox"},e.prototype.destroy=function(){this.parent=null},e.prototype.createComboBox=function(e,t){var o=this,r=this.parent.createElement("input",{id:e.id});t.appendChild(r);var n=e.comboBoxSettings;new i.ComboBox({locale:this.parent.locale,enableRtl:this.parent.enableRtl,enablePersistence:this.parent.enablePersistence,allowCustom:!1,floatLabelType:"Never",ignoreAccent:!0,ignoreCase:!0,allowFiltering:n.allowFiltering,autofill:n.autofill,cssClass:(ue+" "+(n.cssClass?n.cssClass:"")).trim(),dataSource:n.dataSource,enabled:!e.disabled,fields:n.fields,filterType:n.filterType,footerTemplate:n.footerTemplate,groupTemplate:n.groupTemplate,headerTemplate:n.headerTemplate,index:n.index,itemTemplate:n.itemTemplate,noRecordsTemplate:n.noRecordsTemplate,placeholder:n.placeholder,popupHeight:n.popupHeight,popupWidth:n.popupWidth,showClearButton:n.showClearButton,sortOrder:n.sortOrder,text:n.text,value:n.value,width:n.width,beforeOpen:n.beforeOpen,open:n.open,close:function(e){n.close&&n.close.call(o,e)},filtering:n.filtering,change:n.change,select:n.select,created:n.created},r)},e.prototype.addOverFlowEvents=function(e,o,r){var n=this,s=o.querySelector("#"+e.id);s.setAttribute("data-control",e.type.toString());var l=t.getComponent(s,i.ComboBox);l.setProperties({cssClass:l.cssClass+" "+de}),l.close=function(t){var o=t.event?t.event.target:null;e.comboBoxSettings.close&&e.comboBoxSettings.close.call(n,t),o&&!o.closest(".e-ribbon-group-overflow-ddb")&&r.toggle()}},e.prototype.removeOverFlowEvents=function(e,o){var r=this,n=o.querySelector("#"+e.id),s=t.getComponent(n,i.ComboBox),l=s.cssClass.split(" ");l=l.filter(function(e){return e!==de}),s.setProperties({cssClass:l.join(" ")}),s.close=function(t){e.comboBoxSettings.close&&e.comboBoxSettings.close.call(r,t)}},e.prototype.getComboBoxObj=function(e){var o=m(this.parent,e);return o?t.getComponent(o,i.ComboBox):null},e.prototype.filter=function(e,t,o,i){this.getComboBoxObj(e).filter(t,o,i)},e.prototype.hidePopup=function(e){var t=this.getComboBoxObj(e);t&&t.hidePopup()},e.prototype.showPopup=function(e){var t=this.getComboBoxObj(e);t&&t.showPopup()},e.prototype.updateComboBox=function(e,o){var r=p(this.parent.tabs,o);if(r){t.merge(r.item.comboBoxSettings,e);var n=m(this.parent,o,r);if(n){e.cssClass&&(e.cssClass=(ue+" "+e.cssClass).trim()),delete e.close;t.getComponent(n,i.ComboBox).setProperties(e)}}},e}(),St=function(){function o(e){this.parent=e}return o.prototype.getModuleName=function(){return"ribbonDropDown"},o.prototype.destroy=function(){this.parent=null},o.prototype.createDropDown=function(t,o){var i=this,n=this.parent.createElement("button",{id:t.id});o.appendChild(n);var s=t.dropDownSettings,l=(re+" "+ue+" "+(s.cssClass?s.cssClass:"")).trim();new r.DropDownButton({locale:this.parent.locale,enableRtl:this.parent.enableRtl,enablePersistence:this.parent.enablePersistence,iconPosition:t.activeSize===e.RibbonItemSize.Large?"Top":"Left",closeActionEvents:s.closeActionEvents,content:t.activeSize===e.RibbonItemSize.Small?"":s.content,cssClass:l+(t.activeSize===e.RibbonItemSize.Large?" "+le:""),disabled:t.disabled,iconCss:s.iconCss,items:s.items,target:s.target,beforeClose:function(e){s.beforeClose&&s.beforeClose.call(i,e)},beforeItemRender:s.beforeItemRender,beforeOpen:s.beforeOpen,close:function(e){s.close&&s.close.call(i,e)},created:s.created,open:s.open,select:s.select},n)},o.prototype.addOverFlowEvents=function(e,o,i){var n=this,s=o.querySelector("#"+e.id);s.setAttribute("data-control",e.type.toString());var l=t.getComponent(s,r.DropDownButton);l.cssClass=l.cssClass+" "+de,l.dataBind();var a;l.beforeClose=function(t){e.dropDownSettings.beforeClose&&e.dropDownSettings.beforeClose.call(n,t),a=t.event?t.event.target:null},l.close=function(t){e.dropDownSettings.close&&e.dropDownSettings.close.call(n,t),a&&!a.closest(".e-ribbon-group-overflow-ddb")&&i.toggle()}},o.prototype.removeOverFlowEvents=function(e,o){var i=this,n=o.querySelector("#"+e.id),s=t.getComponent(n,r.DropDownButton),l=s.cssClass.split(" ");l=l.filter(function(e){return e!==de}),s.cssClass=l.join(" "),s.dataBind(),s.close=function(t){e.dropDownSettings.close&&e.dropDownSettings.close.call(i,t)},s.beforeClose=function(t){e.dropDownSettings.beforeClose&&e.dropDownSettings.beforeClose.call(i,t)}},o.prototype.createOverFlowDropDown=function(e,o,i,n,s,l){var a=this;this.enableRtl=l;var c=this.parent.createElement("button",{id:e+pt+ut});n.setAttribute("tabindex","0"),s.appendChild(c);var p=new r.DropDownButton({iconCss:i,target:n,locale:this.parent.locale,enableRtl:this.parent.enableRtl,enablePersistence:this.parent.enablePersistence,cssClass:le+" "+_e,iconPosition:"Top",content:o,beforeClose:function(e){e.cancel=!t.isNullOrUndefined(e.event&&t.closest(e.event.target,"."+de))}},c);return g(n,this.parent),c.onclick=c.onkeydown=function(){a.itemIndex=0},n.onkeydown=function(e){a.keyActionHandler(e,n)},p},o.prototype.keyActionHandler=function(e,t){var o,i=t.querySelectorAll(".e-control"),r=t.querySelectorAll(".e-combobox");if(r)for(var n=0;n<r.length;n++)r[parseInt(n.toString(),10)].closest(".e-input-focus")&&(o=r[parseInt(n.toString(),10)]);if(o)for(n=0;n<i.length;n++)i[parseInt(n.toString(),10)].classList.contains("e-combobox")&&i[parseInt(n.toString(),10)].closest(".e-input-focus")&&(this.itemIndex=n);(e.target.classList.contains("e-control")||e.target.classList.contains("e-ribbon-launcher-icon")||e.target.classList.contains("e-ribbon-last-item")||e.target.classList.contains("e-ribbon-first-item"))&&(("ArrowRight"===e.key||!e.shiftKey&&"Tab"===e.key)&&this.handleNavigation(e,!this.enableRtl,i),("ArrowLeft"===e.key||e.shiftKey&&"Tab"===e.key)&&this.handleNavigation(e,this.enableRtl,i))},o.prototype.handleNavigation=function(e,t,o){if(o[0].classList.contains("e-ribbon-first-item")||o[0].classList.add("e-ribbon-first-item"),o[o.length-1].classList.contains("e-ribbon-last-item")||o[o.length-1].classList.add("e-ribbon-last-item"),t){if(0===this.itemIndex&&o[parseInt(this.itemIndex.toString(),10)].classList.contains("e-ribbon-first-item")&&this.updateItemIndex(e,o,!0),e.target.classList.contains("e-combobox")||e.target.classList.contains("e-ribbon-last-item")||e.target.classList.contains("e-ribbon-group-container")||!e.target.classList.contains("e-ribbon-first-item")&&0===this.itemIndex||!e.target.classList.contains("e-control")||(this.itemIndex++,this.updateItemIndex(e,o,!0)),e.target.classList.contains("e-ribbon-last-item")){this.focusLauncherIcon(e,o)||(this.itemIndex=0,this.updateItemIndex(e,o,!0))}e.target.classList.contains("e-ribbon-launcher-icon")&&(this.itemIndex=0,this.updateItemIndex(e,o,!0))}else{if(e.target.classList.contains("e-combobox")||0===this.itemIndex||(this.itemIndex--,this.updateItemIndex(e,o,!1)),e.target.classList.contains("e-ribbon-first-item")){this.focusLauncherIcon(e,o)||(this.itemIndex=o.length-1,this.updateItemIndex(e,o,!1))}e.target.classList.contains("e-ribbon-launcher-icon")&&(this.itemIndex=o.length-1,this.updateItemIndex(e,o,!1))}e.target.classList.contains("e-combobox")&&"Tab"===e.key&&(t?this.itemIndex<o.length-1&&this.itemIndex++:this.itemIndex>0&&this.itemIndex--)},o.prototype.focusLauncherIcon=function(e,t){var o,i=t[parseInt(this.itemIndex.toString(),10)].closest(".e-ribbon-group-container");return i&&(o=i.querySelector(".e-ribbon-launcher-icon")),!!o&&("Tab"===e.key&&e.preventDefault(),i.querySelector(".e-ribbon-launcher-icon").focus(),!0)},o.prototype.updateItemIndex=function(e,t,o){for(var i=t[this.itemIndex].closest(".e-ribbon-item");i&&i.classList.contains("e-disabled");){if(o)if(this.itemIndex<t.length-1)this.itemIndex++;else{if(this.focusLauncherIcon(e,t))break;this.itemIndex=0}else if(this.itemIndex>0)this.itemIndex--;else{if(this.focusLauncherIcon(e,t))break;this.itemIndex=t.length-1}i=t[this.itemIndex].closest(".e-ribbon-item")}"Tab"===e.key&&e.preventDefault(),t[parseInt(this.itemIndex.toString(),10)].focus()},o.prototype.removeOverFlowDropDown=function(e){var o=t.getComponent(e,r.DropDownButton);t.getComponent(o.target,l.Tooltip).destroy(),e.parentElement.parentElement.insertBefore(o.target,e.parentElement),o.destroy(),t.remove(e)},o.prototype.getDDBItemElement=function(e,o){return t.getComponent(e,r.DropDownButton).dropDown.element.querySelector("#"+o)},o.prototype.getOverflowDropDownPopup=function(e,o){var i=o.querySelector("#"+this.parent.tabs[e.tabIndex].groups[e.groupIndex].id+pt+ut);return t.getComponent(i,r.DropDownButton).dropDown.element},o.prototype.getDropDownObj=function(e){var o=m(this.parent,e);return o?t.getComponent(o,r.DropDownButton):null},o.prototype.addItems=function(e,t,o){this.getDropDownObj(e).addItems(t,o)},o.prototype.removeItems=function(e,t,o){this.getDropDownObj(e).removeItems(t,o)},o.prototype.toggle=function(e){this.getDropDownObj(e).toggle()},o.prototype.updateDropDown=function(o,i){var n=p(this.parent.tabs,i);if(n){t.merge(n.item.dropDownSettings,o);var s=m(this.parent,i,n);if(s){var l=t.getComponent(s,r.DropDownButton);o.cssClass&&(o.cssClass=(ue+" "+re+" "+o.cssClass).trim(),o.cssClass=n.item.activeSize===e.RibbonItemSize.Large?(le+" "+o.cssClass).trim():o.cssClass,l.cssClass=o.cssClass),delete o.close,delete o.beforeClose,o.content&&(o.content=n.item.activeSize===e.RibbonItemSize.Small?"":o.content),l.setProperties(o)}}},o.prototype.updateDropDownSize=function(o,i){var n=t.getComponent(o,r.DropDownButton),s=n.cssClass.split(" ");i.activeSize===e.RibbonItemSize.Large?s.push(le):s=s.filter(function(e){return e!==le}),n.cssClass=s.join(" "),n.setProperties({iconPosition:i.activeSize===e.RibbonItemSize.Large?"Top":"Left"}),n.setProperties({content:i.activeSize===e.RibbonItemSize.Small?"":i.dropDownSettings.content})},o}(),It=function(){function o(e){this.parent=e}return o.prototype.getModuleName=function(){return"ribbonSplitButton"},o.prototype.destroy=function(){this.parent=null},o.prototype.createSplitButton=function(o,i){var n=this,s=this.parent.createElement("button",{id:o.id});i.appendChild(s);var l=o.splitButtonSettings,a=(re+" "+ue+" "+(l.cssClass?l.cssClass:"")).trim(),c=new r.SplitButton({locale:this.parent.locale,enableRtl:this.parent.enableRtl,enablePersistence:this.parent.enablePersistence,iconPosition:o.activeSize===e.RibbonItemSize.Large?"Top":"Left",closeActionEvents:l.closeActionEvents,cssClass:a+(o.activeSize===e.RibbonItemSize.Large?" "+le:""),disabled:o.disabled,iconCss:l.iconCss,items:l.items,target:l.target,beforeClose:function(e){l.beforeClose&&l.beforeClose.call(n,e)},beforeItemRender:l.beforeItemRender,beforeOpen:l.beforeOpen,close:function(){c.wrapper.classList.remove(be),l.close&&l.close.call(n)},created:l.created,open:function(){c.wrapper.classList.add(be),l.open&&l.open.call(n)},select:l.select,click:function(e){l.click&&l.click.call(n,e)}},s),p=s.parentElement.querySelector(".e-dropdown-btn");p.onkeydown=function(e){"Enter"===e.key&&(e.stopImmediatePropagation(),p.click())},this.setContent(o,c);var u=c.wrapper;t.EventHandler.add(u,"mouseenter",function(){u.classList.add(pe)},this),t.EventHandler.add(u,"mouseleave",function(){u.classList.remove(pe)},this)},o.prototype.addOverFlowEvents=function(e,o,i){var n=this,s=o.querySelector("#"+e.id);s.setAttribute("data-control",e.type.toString());var l=t.getComponent(s,r.SplitButton);l.cssClass=l.cssClass+" "+de,l.dataBind();var a=s.parentElement.querySelector(".e-dropdown-btn"),c=a.getAttribute("id"),p=document.querySelector("#"+c+"-popup");a.onkeydown=function(e){"Enter"===e.key&&(e.stopImmediatePropagation(),a.click())},p.onkeydown=function(e){"Enter"===e.key&&(e.preventDefault(),l.wrapper.classList.remove("e-ribbon-open"),p.querySelector(".e-focused").click())};var u;l.beforeClose=function(t){e.splitButtonSettings.beforeClose&&e.splitButtonSettings.beforeClose.call(n,t),u=t.event?t.event.target:null},l.click=function(t){e.splitButtonSettings.click&&e.splitButtonSettings.click.call(n,t),i.toggle()},l.close=function(t){e.splitButtonSettings.close&&e.splitButtonSettings.close.call(n,t),l.wrapper.classList.remove(be),u&&!u.closest(".e-ribbon-group-overflow-ddb")&&i.toggle()}},o.prototype.removeOverFlowEvents=function(e,o){var i=this,n=o.querySelector("#"+e.id),s=t.getComponent(n,r.SplitButton),l=s.cssClass.split(" ");l=l.filter(function(e){return e!==de}),s.cssClass=l.join(" "),s.dataBind(),s.beforeClose=function(t){e.splitButtonSettings.beforeClose&&e.splitButtonSettings.beforeClose.call(i,t)},s.click=function(t){e.splitButtonSettings.click&&e.splitButtonSettings.click.call(i,t)},s.close=function(t){e.splitButtonSettings.close&&e.splitButtonSettings.close.call(i,t),s.wrapper.classList.remove(be)}},o.prototype.setContent=function(t,o){o.primaryBtnObj.setProperties({content:t.activeSize===e.RibbonItemSize.Medium?t.splitButtonSettings.content:""}),o.secondaryBtnObj.setProperties({content:t.activeSize===e.RibbonItemSize.Large?t.splitButtonSettings.content:""})},o.prototype.getSplitButtonObj=function(e){var o=m(this.parent,e);return t.getComponent(o,r.SplitButton)},o.prototype.addItems=function(e,t,o){this.getSplitButtonObj(e).addItems(t,o)},o.prototype.removeItems=function(e,t,o){this.getSplitButtonObj(e).removeItems(t,o)},o.prototype.toggle=function(e){this.getSplitButtonObj(e).toggle()},o.prototype.updateSplitButton=function(o,i){var n=p(this.parent.tabs,i);if(n){t.merge(n.item.splitButtonSettings,o);var s=m(this.parent,i,n);if(s){var l=t.getComponent(s,r.SplitButton);o.cssClass&&(o.cssClass=(ue+" "+re+" "+o.cssClass).trim(),o.cssClass=n.item.activeSize===e.RibbonItemSize.Large?(le+" "+o.cssClass).trim():o.cssClass,l.cssClass=o.cssClass),delete o.open,delete o.click,delete o.close,delete o.beforeClose,l.setProperties(o),o.content&&this.setContent(n.item,l)}}},o.prototype.updateSplitButtonSize=function(o,i){var n=t.getComponent(o,r.SplitButton),s=n.cssClass.split(" ");i.activeSize===e.RibbonItemSize.Large?s.push(le):s=s.filter(function(e){return e!==le}),n.cssClass=s.join(" "),n.setProperties({iconPosition:i.activeSize===e.RibbonItemSize.Large?"Top":"Left"}),this.setContent(i,n)},o}(),Ct=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function i(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),Ot=function(e,t,o,i){var r,n=arguments.length,s=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,i);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(s=(n<3?r(s):n>3?r(t,o,s):r(t,o))||s);return n>3&&s&&Object.defineProperty(t,o,s),s},wt=function(i){function s(e,t){return l.Inject(mt,vt,St,It,gt),i.call(this,e,t)||this}Ct(s,i),l=s,s.prototype.render=function(){this.initialize()},s.prototype.preRender=function(){this.idIndex=0,this.tooltipData=[],this.isAddRemove=!1,this.keyConfigs={leftarrow:"leftarrow",rightarrow:"rightarrow",tab:"tab",shiftTab:"shift+tab"}},s.prototype.getPersistData=function(){return this.addOnPersist(["activeLayout"])},s.prototype.getModuleName=function(){return"ribbon"},s.prototype.requiredModules=function(){var e=[];return e.push({member:"ribbonButton",args:[this]},{member:"ribbonDropDown",args:[this]},{member:"ribbonSplitButton",args:[this]},{member:"ribbonCheckBox",args:[this]},{member:"ribbonColorPicker",args:[this]},{member:"ribbonComboBox",args:[this]},{member:"ribbonFileMenu",args:[this]}),e},s.prototype.initialize=function(){this.element.id=this.element.id||t.getUniqueID("e-"+this.getModuleName()),t.addClass([this.element],["e-rbn"].concat(this.cssClass?this.cssClass.split(" "):[])),this.enableRtl&&this.element.classList.add(ce),this.element.style.width=t.formatUnit(this.width),this.renderTabs(),this.ribbonFileMenuModule&&this.ribbonFileMenuModule.createFileMenu(this.fileMenu),this.createHelpPaneTemplate();this.tabObj.tbObj.refreshOverflow(),g(this.element,this),this.wireEvents(),this.wireKeyboardEvent(),this.currentControlIndex=0},s.prototype.wireEvents=function(){t.EventHandler.add(window,"resize",this.resizeHandler,this)},s.prototype.wireKeyboardEvent=function(){this.keyboardModuleRibbon=new t.KeyboardEvents(this.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"})},s.prototype.keyActionHandler=function(e){"Tab"!==e.key||e.target.classList.contains("e-tab-wrap")||e.target.classList.contains("e-combobox")||e.preventDefault();var t,o=this.tabObj.element.querySelector("#"+this.tabs[this.selectedTab].id+at),i=o.querySelectorAll(".e-control"),r=o.querySelectorAll(".e-combobox");if(r)for(var n=0;n<r.length;n++)r[parseInt(n.toString(),10)].closest(".e-input-focus")&&(t=r[parseInt(n.toString(),10)]);if(t)for(n=0;n<i.length;n++)i[parseInt(n.toString(),10)].classList.contains("e-combobox")&&i[parseInt(n.toString(),10)].closest(".e-input-focus")&&(this.currentControlIndex=n);if(0===this.currentControlIndex)for(var s=i[this.currentControlIndex].closest(".e-ribbon-item");s&&s.classList.contains("e-disabled");)this.currentControlIndex++,s=i[this.currentControlIndex].closest(".e-ribbon-item");if(e.target.classList.contains("e-control")||e.target.classList.contains("e-ribbon-launcher-icon")||e.target.classList.contains("e-ribbon-collapse-btn")||e.target.classList.contains("e-ribbon-last-item")||e.target.classList.contains("e-ribbon-first-item")||e.target.classList.contains("e-ribbon-group-of-btn")||e.target.classList.contains("e-ribbon-overall-of-btn"))switch(e.action){case"rightarrow":this.handleNavigation(e,!this.enableRtl,i);break;case"leftarrow":this.handleNavigation(e,this.enableRtl,i);break;case"tab":e.target.classList.contains("e-combobox")&&this.currentControlIndex<i.length-1&&this.currentControlIndex++;break;case"shiftTab":e.target.classList.contains("e-combobox")?this.currentControlIndex>0&&this.currentControlIndex--:(this.tabObj.element.querySelector(".e-toolbar-item.e-active").querySelector(".e-tab-wrap").focus(),this.currentControlIndex=0)}},s.prototype.handleNavigation=function(e,t,o){var i,r;if(t?this.currentControlIndex<o.length-1&&o[this.currentControlIndex+1].classList.contains("e-colorpicker")&&this.currentControlIndex++:this.currentControlIndex>0&&o[this.currentControlIndex-1].classList.contains("e-colorpicker")&&this.currentControlIndex--,!t&&this.currentControlIndex>0||t&&this.currentControlIndex<o.length-1){if(!e.target.classList.contains("e-combobox")&&e.target.classList.contains("e-control")&&!e.target.classList.contains("e-ribbon-last-item")){if(t)this.currentControlIndex++;else{var n=o[parseInt(this.currentControlIndex.toString(),10)].closest("."+Le);n&&(r=n.getAttribute("id")),this.currentControlIndex--}for(var s=o[this.currentControlIndex].closest(".e-ribbon-item");s&&s.classList.contains("e-disabled");){if((t&&this.currentControlIndex===o.length-1||!t&&0===this.currentControlIndex)&&o[this.currentControlIndex].closest(".e-ribbon-item").classList.contains("e-disabled")){this.tabObj.element.querySelector(".e-ribbon-collapse-btn").focus();break}t?this.currentControlIndex++:this.currentControlIndex--,s=o[this.currentControlIndex].closest(".e-ribbon-item")}if(o[parseInt(this.currentControlIndex.toString(),10)].focus(),"Classic"===this.activeLayout){if(i=o[parseInt(this.currentControlIndex.toString(),10)].closest("."+Le),t){var l=void 0;if(i&&(l=i.querySelector(".e-ribbon-launcher-icon")),l){var a=i.querySelectorAll(".e-ribbon-item");a[a.length-1].querySelector(".e-control").classList.add("e-ribbon-last-item")}}else if(i){if(r!==i.getAttribute("id")){(l=i.querySelector(".e-ribbon-launcher-icon"))&&o[parseInt((this.currentControlIndex+1).toString(),10)].classList.add("e-ribbon-first-item")}}}else o[parseInt(this.currentControlIndex.toString(),10)].classList.contains("e-ribbon-first-item")?o[parseInt(this.currentControlIndex.toString(),10)].classList.remove("e-ribbon-first-item"):o[parseInt(this.currentControlIndex.toString(),10)].classList.contains("e-ribbon-last-item")&&o[parseInt(this.currentControlIndex.toString(),10)].classList.remove("e-ribbon-last-item")}}else if("Classic"===this.activeLayout&&this.tabObj.element.querySelector(".e-ribbon-collapse-btn").focus(),"Simplified"===this.activeLayout){var c=this.tabObj.element.querySelector(".e-ribbon-overall-of-btn");t&&c&&!c.classList.contains("e-ribbon-hide")?c.focus():this.tabObj.element.querySelector(".e-ribbon-collapse-btn").focus()}if(e.target.classList.contains("e-ribbon-last-item")&&(t?(i=o[parseInt(this.currentControlIndex.toString(),10)].closest("."+Le)).querySelector(".e-ribbon-launcher-icon").focus():(this.currentControlIndex--,o[parseInt(this.currentControlIndex.toString(),10)].focus())),!t&&e.target.classList.contains("e-ribbon-first-item")){(l=(i=o[parseInt((this.currentControlIndex-1).toString(),10)].closest("."+Le)).querySelector(".e-ribbon-launcher-icon"))&&i.querySelector(".e-ribbon-launcher-icon").focus()}if(e.target.classList.contains("e-ribbon-launcher-icon")&&(t?(this.currentControlIndex++,o[parseInt(this.currentControlIndex.toString(),10)].focus(),o[parseInt((this.currentControlIndex-1).toString(),10)].classList.contains("e-ribbon-last-item")&&o[parseInt((this.currentControlIndex-1).toString(),10)].classList.remove("e-ribbon-last-item")):(this.currentControlIndex,o[parseInt(this.currentControlIndex.toString(),10)].focus())),e.target.classList.contains("e-ribbon-collapse-btn"))if(t){this.currentControlIndex=0;for(var p=o[this.currentControlIndex].closest(".e-ribbon-item");p&&p.classList.contains("e-disabled");)this.currentControlIndex++,p=o[this.currentControlIndex].closest(".e-ribbon-item");o[parseInt(this.currentControlIndex.toString(),10)].focus()}else{if((c=this.tabObj.element.querySelector(".e-ribbon-overall-of-btn"))&&!c.classList.contains("e-ribbon-hide"))c.focus();else{this.currentControlIndex=o.length-1;for(p=o[this.currentControlIndex].closest(".e-ribbon-item");p&&p.classList.contains("e-disabled");)this.currentControlIndex--,p=o[this.currentControlIndex].closest(".e-ribbon-item");o[parseInt(this.currentControlIndex.toString(),10)].focus()}}"Simplified"===this.activeLayout&&e.target.classList.contains("e-ribbon-overall-of-btn")&&(t?this.tabObj.element.querySelector(".e-ribbon-collapse-btn").focus():(this.currentControlIndex=o.length-1,o[parseInt(this.currentControlIndex.toString(),10)].focus()))},s.prototype.resizeHandler=function(){var e=this.tabObj.element.querySelector("#"+this.tabs[this.selectedTab].id+at);if(this.checkOverflow(this.selectedTab,e),this.scrollModule){var t=this.tabObj.element.querySelector("."+he);this.scrollModule.scrollStep=t.offsetWidth}},s.prototype.renderTabs=function(){this.tabsInternal=this.tabs.slice(),this.tabsInternal=this.checkID(this.tabsInternal,"tab",this.element.id),this.setProperties({tabs:this.tabsInternal},!0);var e=this.createElement("div",{id:this.element.id+"_tab"});this.element.appendChild(e),this.validateItemSize();var i=this.createTabItems(this.tabs);this.tabObj=new o.Tab({cssClass:"e-ribbon-tab",selectedItem:this.selectedTab,overflowMode:"Popup",width:this.width,items:i,enableRtl:this.enableRtl,created:this.tabCreated.bind(this),selected:this.ribbonTabSelected.bind(this),selecting:this.ribbonTabSelecting.bind(this)}),this.tabObj.appendTo(e),this.element.style.setProperty(ht,"0px"),this.element.style.setProperty(ft,"0px");var r=e.querySelector(".e-toolbar");t.getComponent(r,o.Toolbar).setProperties({width:"calc(100% - var(--fileMenuWidth) - var(--helpTemplateWidth))"}),this.element.classList[this.isMinimized?"add":"remove"](Pe)},s.prototype.minimize=function(e){var t=this;if(e!==this.isMinimized){this.trigger(e?"ribbonCollapsing":"ribbonExpanding",{cancel:!1},function(o){o.cancel||(t.setProperties({isMinimized:e},!0),t.element.classList.toggle(Pe,t.isMinimized),t.tabObj.element.querySelector(".e-content").style.display=e?"none":"block",e||t.refreshLayout())})}},s.prototype.toggleLayout=function(){this.setProperties({activeLayout:"Simplified"===this.activeLayout?"Classic":"Simplified"},!0),this.switchLayout()},s.prototype.tabCreated=function(){this.addExpandCollapse(),this.renderInitialTab(this.selectedTab)},s.prototype.ribbonTabSelected=function(e){this.isAddRemove=!1;var t=e.selectedItem.getAttribute("data-id"),o=a(this.tabs,function(e){return e.id===t});o=-1===o?this.selectedTab:o;var i={previousIndex:this.selectedTab,selectedIndex:o};if(this.setProperties({selectedTab:o},!0),this.checkOverflow(o,e.selectedContent.firstChild),"Simplified"===this.activeLayout&&this.overflowDDB){var r=this.overflowDDB.target,n=r.querySelector("."+me);n&&n.classList.remove(me);var s=r.querySelector("#"+t+pt);s?(s.classList.add(me),this.overflowDDB.element.classList.remove(fe)):this.overflowDDB.element.classList.add(fe)}this.trigger("tabSelected",i)},s.prototype.checkOverflow=function(e,t){var i=t.closest("."+De),r=i.offsetWidth<t.offsetWidth;if(r&&!this.scrollModule){if("Classic"===this.activeLayout){var n=!1;!(n=this.checkGroupShrinking(e,i,t,!0))&&i.offsetWidth<t.offsetWidth&&(n=this.checkGroupShrinking(e,i,t,!1)),i.offsetWidth<t.offsetWidth&&this.createOverflowDropdown(e,i,t)}else this.checkSimplifiedItemShrinking(e,i,t),i.offsetWidth<t.offsetWidth&&this.createSimplfiedOverflow(i,t,e);i.offsetWidth<t.offsetWidth&&!this.scrollModule&&(this.scrollModule=new o.HScroll({enableRtl:this.enableRtl},this.tabObj.element.querySelector("."+De)))}else if(!r)if(this.destroyScroll(),"Classic"===this.activeLayout){n=!1;!(n=this.removeOverflowDropdown(i,t,!1,e))&&i.offsetWidth>t.offsetWidth&&(n=this.checkGroupExpanding(e,i,t,!0)),!n&&i.offsetWidth>t.offsetWidth&&(n=this.checkGroupExpanding(e,i,t,!1))}else this.removeSimplfiedOverflow(i,t,e),i.offsetWidth>t.offsetWidth&&this.checkSimplifiedItemExpanding(e,i,t)},s.prototype.checkSimplifiedItemShrinking=function(t,o,i){for(var r=this.tabs[parseInt(t.toString(),10)],n=r.groups.length-1;n>=0;n--)for(var s=r.groups[parseInt(n.toString(),10)],l=o.querySelector("#"+s.id+ct),a=0;a<s.collections.length&&o.offsetWidth<i.offsetWidth;a++)for(var c=s.collections[parseInt(a.toString(),10)],p=c.items.length;p>=1&&o.offsetWidth<i.offsetWidth;p--){var u=c.items[p-1];if(u.allowedSizes&e.RibbonItemSize.Small&&u.allowedSizes&e.RibbonItemSize.Medium&&u.activeSize===e.RibbonItemSize.Medium&&u.displayOptions&e.DisplayMode.Simplified){var d=l.querySelector("#"+u.id+ct);if(d){var b=d.querySelector("#"+u.id);d.setAttribute("data-medium-width",i.offsetWidth.toString()),u.setProperties({activeSize:e.RibbonItemSize.Small},!0),this.setItemSize(b,u)}}}},s.prototype.checkSimplifiedItemExpanding=function(t,o,i){for(var r=this.tabs[parseInt(t.toString(),10)],n=r.groups.length-1;n>=0;n--)for(var s=r.groups[parseInt(n.toString(),10)],l=o.querySelector("#"+s.id+ct),a=0;a<s.collections.length&&o.offsetWidth>i.offsetWidth;a++)for(var c=s.collections[parseInt(a.toString(),10)],p=c.items.length;p>=1&&o.offsetWidth>i.offsetWidth;p--){var u=c.items[p-1];if(u.allowedSizes&e.RibbonItemSize.Small&&u.allowedSizes&e.RibbonItemSize.Medium&&u.activeSize===e.RibbonItemSize.Small&&u.displayOptions&e.DisplayMode.Simplified){var d=l.querySelector("#"+u.id+ct);if(d){var b=d.getAttribute("data-medium-width"),h=b?parseInt(b,10):null;if(h&&o.offsetWidth>h){d.removeAttribute("data-medium-width");var f=d.querySelector("#"+u.id);u.setProperties({activeSize:e.RibbonItemSize.Medium},!0),this.setItemSize(f,u)}}}}},s.prototype.createSimplfiedOverflow=function(o,i,r){for(var n=this.getGroupResizeOrder(!0,r),s=0;s<n.length&&o.offsetWidth<i.offsetWidth;s++){for(var l=n[parseInt(s.toString(),10)],a=o.querySelector("#"+l.id),c=a.querySelector("#"+l.id+ct),p=l.collections.length;p>=1&&o.offsetWidth<i.offsetWidth;p--)for(var u=l.collections[parseInt((p-1).toString(),10)],d=a.querySelector("#"+u.id),b=u.items.length;b>=1&&o.offsetWidth<i.offsetWidth;b--){var h=u.items[b-1],f=d.querySelector("#"+h.id+ct);if((h.displayOptions===e.DisplayMode.Auto||h.displayOptions===(e.DisplayMode.Simplified|e.DisplayMode.Overflow))&&!t.isNullOrUndefined(f)){if(f.setAttribute("data-simplified-width",i.offsetWidth.toString()),this.createOverflowPopup(h,r,l.enableGroupOverflow,l.id,l.header,f,c),h.activeSize===e.RibbonItemSize.Small){var m=f.querySelector("#"+h.id);h.setProperties({activeSize:e.RibbonItemSize.Medium},!0),this.setItemSize(m,h)}h.type!==e.RibbonItemType.DropDown&&h.type!==e.RibbonItemType.SplitButton||this.updatePopupItems(h,f,l.enableGroupOverflow,!0)}}l.enableGroupOverflow||a.querySelector("."+Ne)||a.classList.add("e-ribbon-emptyCollection")}},s.prototype.updatePopupItems=function(o,i,n,s){var l=t.getComponent(i.querySelector("#"+o.id),o.type===e.RibbonItemType.DropDown?r.DropDownButton:r.SplitButton),a=l.dropDown,c=(n&&s)===this.enableRtl;a.setProperties({position:{X:c?"left":"right",Y:s?"top":"bottom"}},!0),s?l.beforeOpen=function(){c&&(a.element.style.setProperty("visibility","hidden"),a.element.style.setProperty("display","block"),a.setProperties({offsetX:-1*a.element.offsetWidth}),a.element.style.removeProperty("display"),a.element.style.removeProperty("visibility"))}:(a.setProperties({offsetX:0},!0),l.beforeOpen=null)},s.prototype.removeSimplfiedOverflow=function(o,i,n,s){void 0===s&&(s=!1);for(var l=this.getGroupResizeOrder(!1,n),a=!0,c=0;c<l.length&&a;c++){var p=l[parseInt(c.toString(),10)],u=void 0,d=void 0;if(p.enableGroupOverflow){var b=o.querySelector("#"+p.id+nt);b&&(d=(u=t.getInstance(b,r.DropDownButton)).target)}else u=this.overflowDDB,d=this.overflowDDB?this.overflowDDB.target:null;for(var h=0;h<p.collections.length&&a;h++)for(var f=p.collections[parseInt(h.toString(),10)],m=0;m<f.items.length&&a&&!s&&o.offsetWidth>i.offsetWidth;m++){var v=f.items[parseInt(m.toString(),10)],y=void 0;if(d&&(y=d.querySelector("#"+v.id+ct)),(v.displayOptions===e.DisplayMode.Auto||v.displayOptions===(e.DisplayMode.Simplified|e.DisplayMode.Overflow))&&!t.isNullOrUndefined(y)){var g=parseInt(y.getAttribute("data-simplified-width"),10);if(!s&&o.offsetWidth<g){a=!1;break}var S=o.querySelector("#"+f.id);v.type!==e.RibbonItemType.DropDown&&v.type!==e.RibbonItemType.SplitButton||this.updatePopupItems(v,y,p.enableGroupOverflow,!1),S.append(y),this.removeOverflowEvent(v,y),v.allowedSizes&e.RibbonItemSize.Small&&(v.setProperties({activeSize:e.RibbonItemSize.Small},!0),this.setItemSize(y.querySelector("#"+v.id),v))}}var I=o.querySelector("#"+p.id),C=I.querySelector("."+Ne);if(I.classList.contains("e-ribbon-emptyCollection")&&null!==C&&I.classList.remove("e-ribbon-emptyCollection"),u)if(p.enableGroupOverflow)0===d.childElementCount&&this.removeOverflowButton(u);else{var O=d.querySelector("#"+p.id+ct);O&&1===O.childElementCount&&O.remove();var w=d.querySelector("#"+this.tabs[parseInt(n.toString(),10)].id+pt);w&&0===w.childElementCount&&(w.remove(),this.overflowDDB.element.classList.add(fe))}}if(this.overflowDDB){0===this.overflowDDB.target.childElementCount&&(this.removeOverflowButton(this.overflowDDB),this.overflowDDB=null)}},s.prototype.createOverflowPopup=function(e,o,i,n,s,l,a){var c;if(i){var p=a.querySelector("#"+n+nt);p?c=t.getInstance(p,r.DropDownButton):((c=this.addOverflowButton(n+nt)).element.classList.add(Ce),a.appendChild(c.element)),c.target.append(l)}else{if(this.overflowDDB){this.overflowDDB.element.classList.remove(fe);var u=this.overflowDDB.target,d=u.querySelector("#"+this.tabs[parseInt(o.toString(),10)].id+pt);if(d){var b=u.querySelector("#"+n+ct);b||(b=this.createGroupContainer(n,s),d.append(b)),b.append(l)}else this.createOfTabContainer(n,s,l,o)}else this.overflowDDB=this.addOverflowButton(this.tabObj.element.id+rt),this.tabObj.element.insertBefore(this.overflowDDB.element,this.collapseButton),this.overflowDDB.element.classList.add(Ie),this.createOfTabContainer(n,s,l,o);c=this.overflowDDB}null!==l&&this.addOverflowEvents(e,l,c)},s.prototype.addOverflowEvents=function(e,t,o){switch(e.type){case"Button":this.ribbonButtonModule.addOverFlowEvents(e,t,o);break;case"DropDown":this.ribbonDropDownModule.addOverFlowEvents(e,t,o);break;case"SplitButton":this.ribbonSplitButtonModule.addOverFlowEvents(e,t,o);break;case"CheckBox":this.ribbonCheckBoxModule.addOverFlowEvents(e,t,o);break;case"ColorPicker":this.ribbonColorPickerModule.addOverFlowEvents(e,t,o);break;case"ComboBox":this.ribbonComboBoxModule.addOverFlowEvents(e,t,o)}},s.prototype.createOfTabContainer=function(e,t,o,i){var r=this.createElement("div",{id:this.tabs[parseInt(i.toString(),10)].id+pt,className:Re});this.overflowDDB.target.append(r);var n=this.createGroupContainer(e,t);n.append(o),r.append(n),i===this.selectedTab&&r.classList.add(me)},s.prototype.checkGroupShrinking=function(e,t,o,i){for(var r=!0,n=!1,s=this.tabs[parseInt(e.toString(),10)],l=s.groups.length-1;r&&l>=0;l--)r=!(n=i?this.checkLargeToMedium(e,s,l,t,o):this.checkMediumToSmall(e,s,l,t,o))&&t.offsetWidth<o.offsetWidth;return n},s.prototype.checkValidCollectionLength=function(t){for(var o=0,i=0;i<t.length;i++){for(var r=t[parseInt(i.toString(),10)].items,n=0;n<r.length;n++)if(r[parseInt(n.toString(),10)].displayOptions&e.DisplayMode.Classic){o++;break}if(o>1)return!1}return 1===o},s.prototype.checkClassicCollection=function(t,o,i){for(var r=t[parseInt(o.toString(),10)].items,n=0;n<r.length;n++)if(r[parseInt(n.toString(),10)].displayOptions&e.DisplayMode.Classic)return o;return o=i?o+1:o-1,i?o===t.length?o:this.checkClassicCollection(t,o,i):o<0?o:this.checkClassicCollection(t,o,i)},s.prototype.checkClassicItem=function(t,o,i){return t[parseInt(o.toString(),10)].displayOptions&e.DisplayMode.Classic?o:(o=i?o+1:o-1,i?o===t.length?o:this.checkClassicItem(t,o,i):o<0?o:this.checkClassicItem(t,o,i))},s.prototype.checkLargeToMedium=function(t,o,i,r,n,s){var l=this;void 0===s&&(s=!1);var a=o.groups[parseInt(i.toString(),10)];if(a.isCollapsed&&!s)return!1;var c=function(e){return 1===e.items.length&&p(e.items[0])},p=function(t){return t.allowedSizes&e.RibbonItemSize.Medium&&t.activeSize===e.RibbonItemSize.Large},u=function(e,t,o,i){var r=l.createElement("div",{className:"e-ribbon-shrink "+We,id:e+"_shrink_container"+o,attrs:{"data-start":o.toString(),"data-end":i.toString()}});return t.parentElement.insertBefore(r,t),s||r.setAttribute("data-large-width",n.offsetWidth.toString()),r},d=function(o,r){for(var a=l.tabs[parseInt(t.toString(),10)].groups[parseInt(i.toString(),10)].collections[0],c=n.querySelector("#"+a.items[parseInt(o.toString(),10)].id+ct),p=s?n.querySelector("#"+a.id+"_shrink_container"+o):u(a.id,c,o,r),d=o;d<=r;d++){var b=a.items[parseInt(d.toString(),10)];if(b.displayOptions&e.DisplayMode.Classic){var h=n.querySelector("#"+b.id+ct);p.appendChild(h),b.setProperties({activeSize:e.RibbonItemSize.Medium},!0),l.setItemSize(h.querySelector("#"+b.id),b)}}},b=function(o,r){for(var a=l.tabs[parseInt(t.toString(),10)].groups[parseInt(i.toString(),10)],c=n.querySelector("#"+a.collections[parseInt(o.toString(),10)].id),p=s?n.querySelector("#"+a.id+"_shrink_container"+o):u(a.id,c,o,r),d=o;d<=r;d++){var b=a.collections[parseInt(d.toString(),10)],h=n.querySelector("#"+b.id);p.appendChild(h),b.items[0].setProperties({activeSize:e.RibbonItemSize.Medium},!0),l.setItemSize(h.querySelector("#"+b.items[0].id),b.items[0])}};if(a.orientation===e.ItemOrientation.Column)for(var h=a.collections.length-1;h>0;h--){if((m=(h=this.checkClassicCollection(a.collections,h,!1))-1)>=0&&c(a.collections[parseInt(h.toString(),10)]))if((m=this.checkClassicCollection(a.collections,m,!1))>=0&&c(a.collections[parseInt(m.toString(),10)])){if((v=m-1)>=0&&(v=this.checkClassicCollection(a.collections,v,!1)),v>=0&&c(a.collections[parseInt(v.toString(),10)])?b(v,h):b(m,h),h=v,!s&&r.offsetWidth>n.offsetWidth)return!0}else h=m}else if(this.checkValidCollectionLength(a.collections)){var f=a.collections[0];for(h=f.items.length-1;h>0;h--){var m;if((m=(h=this.checkClassicItem(f.items,h,!1))-1)>=0&&p(f.items[parseInt(h.toString(),10)]))if((m=this.checkClassicItem(f.items,m,!1))>=0&&p(f.items[parseInt(m.toString(),10)])){var v;if((v=m-1)>=0&&(v=this.checkClassicItem(f.items,v,!1)),v>=0&&p(f.items[parseInt(v.toString(),10)])?d(v,h):d(m,h),h=v,!s&&r.offsetWidth>n.offsetWidth)return!0}else h=m}}return!1},s.prototype.checkMediumToSmall=function(t,o,i,r,n,s){var l=this;void 0===s&&(s=!1);var a=o.groups[parseInt(i.toString(),10)];if(a.isCollapsed&&!s)return!1;var c=a.orientation,p=n.querySelector("#"+a.id).querySelectorAll(".e-ribbon-shrink"),u=function(t){return t.allowedSizes&e.RibbonItemSize.Small&&t.activeSize===e.RibbonItemSize.Medium},d=function(o,r,s,a){void 0===a&&(a=null);var c=l.tabs[parseInt(t.toString(),10)].groups[parseInt(i.toString(),10)].collections[parseInt(o.toString(),10)],p=function(t){var o=c.items[parseInt(t.toString(),10)];if(o.displayOptions&e.DisplayMode.Classic){var i=n.querySelector("#"+o.id);o.setProperties({activeSize:e.RibbonItemSize.Small},!0),l.setItemSize(i,o)}};p(r),a&&p(a),p(s)},b=function(o,r,a,c){void 0===c&&(c=null);var u=l.tabs[parseInt(t.toString(),10)].groups[parseInt(i.toString(),10)];s||p[parseInt(o.toString(),10)].setAttribute("data-medium-width",n.offsetWidth.toString());var d=function(t){var o=u.collections[parseInt(t.toString(),10)];if(o.items[0].displayOptions&e.DisplayMode.Classic){var i=n.querySelector("#"+o.items[0].id);o.items[0].setProperties({activeSize:e.RibbonItemSize.Small},!0),l.setItemSize(i,o.items[0])}};d(r),c&&d(c),d(a)},h=function(e){if(!s){n.querySelector("#"+e).setAttribute("data-medium-width",n.offsetWidth.toString())}};if(c===e.ItemOrientation.Column){if(p.length>0)for(var f=p.length-1;f>=0;f--){var m=parseInt(p[parseInt(f.toString(),10)].getAttribute("data-start"),10),v=parseInt(p[parseInt(f.toString(),10)].getAttribute("data-end"),10),y=this.checkClassicCollection(a.collections,m+1,!1);if(u(a.collections[parseInt(m.toString(),10)].items[0])&&u(a.collections[parseInt(y.toString(),10)].items[0])&&(v===y?b(f,m,v):u(a.collections[parseInt(v.toString(),10)].items[0])&&b(f,m,v,y),!s&&r.offsetWidth>n.offsetWidth))return!0}for(f=a.collections.length-1;f>=0;f--){for(var g=a.collections[parseInt(f.toString(),10)],S=[],I=0;I<g.items.length;I++)g.items[parseInt(I.toString(),10)].displayOptions&e.DisplayMode.Classic&&S.push(I);if(S.length>1&&u(g.items[S[0]])&&u(g.items[S[1]])&&(2===S.length?(h(g.id),d(f,S[0],S[1])):u(g.items[S[2]])&&(h(g.id),d(f,S[0],S[2],S[1])),!s&&r.offsetWidth>n.offsetWidth))return!0}}else if(this.checkValidCollectionLength(a.collections)){if(p.length>0)for(f=p.length-1;f>=0;f--){var C=p[parseInt(f.toString(),10)];m=parseInt(C.getAttribute("data-start"),10),v=parseInt(C.getAttribute("data-end"),10),g=a.collections[0],y=this.checkClassicItem(g.items,m+1,!1);if(u(a.collections[0].items[parseInt(m.toString(),10)])&&u(a.collections[0].items[parseInt(y.toString(),10)])&&(v===y?(h(C.id),d(0,m,v)):u(a.collections[0].items[parseInt(v.toString(),10)])&&(h(C.id),d(0,m,v,y)),!s&&r.offsetWidth>n.offsetWidth))return!0}}else for(f=a.collections.length-1;f>=0;f--)for(y=(g=a.collections[parseInt(f.toString(),10)]).items.length-1;y>=0;y--)if(!((y=this.checkClassicItem(g.items,y,!1))<0)){var O=g.items[parseInt(y.toString(),10)];if(u(O)&&(h(O.id),d(f,y,y),!s&&r.offsetWidth>n.offsetWidth))return!0}return!1},s.prototype.checkGroupExpanding=function(e,t,o,i){for(var r=!1,n=this.tabs[parseInt(e.toString(),10)],s=0;!r&&s<n.groups.length;s++)r=i?this.checkSmallToMedium(e,n,s,t,o,!1,!0):this.checkMediumToLarge(e,n,s,t,o,!1,!0);return r},s.prototype.checkSmallToMedium=function(t,o,i,r,n,s,l){var a=this,c=o.groups[parseInt(i.toString(),10)],p=c.orientation,u=n.querySelector("#"+c.id).querySelectorAll(".e-ribbon-shrink"),d=function(t){return t.allowedSizes&e.RibbonItemSize.Medium&&t.activeSize===e.RibbonItemSize.Small},b=function(o,r,n){var s=a.tabs[parseInt(t.toString(),10)].groups[parseInt(i.toString(),10)].collections[parseInt(o.toString(),10)].items[parseInt(r.toString(),10)];if(s.displayOptions&e.DisplayMode.Classic){var l=n.id===s.id?n:n.querySelector("#"+s.id);s.setProperties({activeSize:e.RibbonItemSize.Medium},!0),a.setItemSize(l,s)}},h=function(o){var r=a.tabs[parseInt(t.toString(),10)].groups[parseInt(i.toString(),10)].collections;if(r[parseInt(o.toString(),10)].items[0].displayOptions&e.DisplayMode.Classic){var s=n.querySelector("#"+r[parseInt(o.toString(),10)].items[0].id);r[parseInt(o.toString(),10)].items[0].setProperties({activeSize:e.RibbonItemSize.Medium},!0),a.setItemSize(s,r[parseInt(o.toString(),10)].items[0])}};if(p===e.ItemOrientation.Row){if(!this.checkValidCollectionLength(c.collections))for(var f=0;f<c.collections.length;f++)for(var m=c.collections[parseInt(f.toString(),10)],v=0;v<m.items.length;v++)if((v=this.checkClassicItem(m.items,v,!0))!==m.items.length){var y=m.items[parseInt(v.toString(),10)];if(d(y)){if((S=(O=(g=n.querySelector("#"+y.id)).getAttribute("data-medium-width"))?parseInt(O,10):null)&&(s||r.offsetWidth>S))b(f,v,g),s&&!l||g.removeAttribute("data-medium-width");else if(S)return!0}}}else for(f=0;f<c.collections.length;f++)if(c.collections[parseInt(f.toString(),10)].items.length>1){m=c.collections[parseInt(f.toString(),10)];for(var g,S=(O=(g=n.querySelector("#"+m.id)).getAttribute("data-medium-width"))?parseInt(O,10):null,I=[],C=0;C<m.items.length;C++)m.items[parseInt(C.toString(),10)].displayOptions&e.DisplayMode.Classic&&I.push(C);if(I.length>1&&S&&(s||r.offsetWidth>S))b(f,I[0],g),b(f,I[1],g),3===I.length&&b(f,I[2],g),s&&!l||g.removeAttribute("data-medium-width");else if(S)return!0}if(u.length>0)for(f=0;f<u.length;f++){var O,w=u[parseInt(f.toString(),10)];if((S=(O=w.getAttribute("data-medium-width"))?parseInt(O,10):null)&&(s||r.offsetWidth>S)){var D=parseInt(w.getAttribute("data-start"),10),P=parseInt(w.getAttribute("data-end"),10);if(p===e.ItemOrientation.Row){m=c.collections[0],v=this.checkClassicItem(m.items,D+1,!0);b(0,D,w),b(0,v,w),v!==P&&b(0,P,w)}else{var B=this.checkClassicCollection(c.collections,D+1,!0);h(D),h(B),B!==P&&h(P)}s&&!l||w.removeAttribute("data-medium-width")}else if(S)return!0}return!1},s.prototype.checkMediumToLarge=function(o,i,r,n,s,l,a){var c=this,p=i.groups[parseInt(r.toString(),10)],u=p.orientation,d=s.querySelector("#"+p.id).querySelectorAll(".e-ribbon-shrink");if(0===d.length)return!1;for(var b=function(i,n,s,p){var u=c.tabs[parseInt(o.toString(),10)].groups[parseInt(r.toString(),10)].collections[0].items,d=function(t){var o=u[parseInt(t.toString(),10)];if(o.displayOptions&e.DisplayMode.Classic){var i=s.querySelector("#"+o.id+ct),r=i.querySelector("#"+o.id);o.setProperties({activeSize:e.RibbonItemSize.Large},!0),c.setItemSize(r,o),s.insertAdjacentElement("afterend",i)}};d(i),p&&d(p),d(n),l&&!a||t.remove(s)},h=function(i,n,s,p){var u=c.tabs[parseInt(o.toString(),10)].groups[parseInt(r.toString(),10)].collections,d=function(t){var o=u[parseInt(t.toString(),10)];if(o.items[0].displayOptions&e.DisplayMode.Classic){var i=s.querySelector("#"+o.id),r=i.querySelector("#"+o.items[0].id);o.items[0].setProperties({activeSize:e.RibbonItemSize.Large},!0),c.setItemSize(r,o.items[0]),s.insertAdjacentElement("afterend",i)}};d(i),p&&d(p),d(n),l&&!a||t.remove(s)},f=0;f<d.length;f++){var m=d[parseInt(f.toString(),10)],v=m.getAttribute("data-large-width"),y=v?parseInt(v,10):null;if(y&&(l||n.offsetWidth>y)){var g=parseInt(m.getAttribute("data-start"),10),S=parseInt(m.getAttribute("data-end"),10);if(u===e.ItemOrientation.Row){var I=p.collections[0],C=this.checkClassicItem(I.items,g+1,!0);C===S?b(g,S,m):b(g,S,m,C)}else{var O=this.checkClassicCollection(p.collections,g+1,!0);O===S?h(g,S,m):h(g,S,m,O)}l&&!a||m.removeAttribute("data-large-width")}else if(y)return!0}return!1},s.prototype.setItemSize=function(o,i){var r=o.closest("."+Ne);i.type===e.RibbonItemType.Button?this.ribbonButtonModule.updateButtonSize(o,i):i.type===e.RibbonItemType.DropDown?this.ribbonDropDownModule.updateDropDownSize(o,i):i.type===e.RibbonItemType.SplitButton?this.ribbonSplitButtonModule.updateSplitButtonSize(o,i):i.type===e.RibbonItemType.Template&&(t.remove(o),this.createTemplateContent(i,r)),r.classList.remove(Ve,He,Ge,Ue),i.activeSize===e.RibbonItemSize.Large?r.classList.add(He,Ve):r.classList.add(i.activeSize===e.RibbonItemSize.Medium?Ge:Ue)},s.prototype.createOverflowDropdown=function(e,t,o){var i=this.getGroupResizeOrder(!0,e);if(0!==i.length)for(var r=function(r){var s=i[parseInt(r.toString(),10)],l=n.tabObj.element.querySelector("#"+s.id);l.setAttribute("data-expanded-width",o.offsetWidth.toString());var c=l.querySelector("#"+s.id+ct),p=n.createElement("div",{className:Me+" "+He,id:s.id+pt+ct});l.insertBefore(p,c);var u=a(n.tabs[parseInt(e.toString(),10)].groups,function(e){return e.id===s.id}),d=n.tabs[parseInt(e.toString(),10)];n.checkSmallToMedium(e,d,u,t,o,!0,!1),n.checkMediumToLarge(e,d,u,t,o,!0,!1);var b=n.ribbonDropDownModule.createOverFlowDropDown(s.id,s.header,s.groupIconCss,c,p,n.enableRtl);n.tabs[parseInt(e.toString(),10)].groups[parseInt(u.toString(),10)].setProperties({isCollapsed:!0},!0);for(var h=0;h<s.collections.length;h++)for(var f=s.collections[parseInt(h.toString(),10)],m=c.querySelector("#"+f.id),v=0;v<f.items.length;v++){var y=f.items[parseInt(v.toString(),10)],g=m.querySelector("#"+y.id+ct);null!==g&&n.addOverflowEvents(y,g,b)}},n=this,s=0;s<i.length&&t.offsetWidth<o.offsetWidth;s++)r(s)},s.prototype.removeOverflowDropdown=function(e,t,o,i){void 0===o&&(o=!1);var r=this.getGroupResizeOrder(!1,i);if(0===r.length)return!1;for(var n=function(n){var l=r[parseInt(n.toString(),10)],c=s.tabObj.element.querySelector("#"+l.id);if(!c)return"break";var p=parseInt(c.getAttribute("data-expanded-width"),10);if(!o&&e.offsetWidth<p)return{value:!0};s.removeDropdown(l.id);var u=a(s.tabs[parseInt(i.toString(),10)].groups,function(e){return e.id===l.id});s.tabs[parseInt(i.toString(),10)].groups[parseInt(u.toString(),10)].setProperties({isCollapsed:!1},!0);var d=s.tabs[parseInt(i.toString(),10)];s.checkLargeToMedium(i,d,u,e,t,!0),s.checkMediumToSmall(i,d,u,e,t,!0);for(var b=0;b<l.collections.length;b++)for(var h=l.collections[parseInt(b.toString(),10)],f=c.querySelector("#"+h.id),m=0;m<h.items.length;m++){var v=h.items[parseInt(m.toString(),10)],y=f.querySelector("#"+v.id+ct);null!==y&&s.removeOverflowEvent(v,y)}},s=this,l=0;l<r.length;l++){var c=n(l);if("object"==typeof c)return c.value;if("break"===c)break}return!1},s.prototype.removeDropdown=function(e){var o=this.tabObj.element.querySelector("#"+e+pt+ut);if(o){var i=o.parentElement;this.ribbonDropDownModule.removeOverFlowDropDown(o),t.remove(i)}},s.prototype.getGroupResizeOrder=function(e,o){var i=this,r=this.tabs[parseInt(o.toString(),10)].groups;return(r=r.filter(function(o){return"Classic"!==i.activeLayout||(t.isUndefined(o.isCollapsible)||o.isCollapsible)&&(e&&t.isUndefined(o.isCollapsed)||!t.isUndefined(o.isCollapsed)&&e!==o.isCollapsed)})).sort(function(e,t){return e.priority-t.priority}),e?r.reverse():r},s.prototype.destroyScroll=function(){this.scrollModule&&(this.scrollModule.destroy(),this.scrollModule=null)},s.prototype.clearOverflowDropDown=function(e){var t=this.tabObj.element.querySelector("#"+this.tabs[parseInt(e.toString(),10)].id+at);if(t){var o=t.closest("."+De);"Simplified"===this.activeLayout?this.removeSimplfiedOverflow(t,o,e,!0):this.removeOverflowDropdown(t,o,!0,e)}},s.prototype.ribbonTabSelecting=function(e){var o=this;this.currentControlIndex=0;var i=e.selectingItem.getAttribute("data-id"),r=e.previousItem.getAttribute("data-id"),n=a(this.tabs,function(e){return e.id===i}),s=a(this.tabs,function(e){return e.id===r});n=-1===n?this.selectedTab:n;var l={cancel:e.cancel,isInteracted:e.isInteracted,previousIndex:s,selectedIndex:n};this.trigger("tabSelecting",l,function(e){if(!e.cancel){o.destroyScroll(),o.isAddRemove||-1===s||o.clearOverflowDropDown(s);var i=o.tabObj.items[parseInt(n.toString(),10)].content;if(!i.querySelector("."+Be)&&0!==o.tabs[parseInt(n.toString(),10)].groups.length){var r=o.createGroups(o.tabs[parseInt(n.toString(),10)].groups,n);t.append(r,i)}}})},s.prototype.createTabItems=function(e){for(var t=this,o=[],i=0;i<e.length;i++){var r=e[parseInt(i.toString(),10)],n=this.createElement("span",{innerHTML:r.header,id:r.id+st});n.onclick=function(){t.minimize(!1)},n.ondblclick=function(){t.minimize(!0)};var s={header:{text:n},id:r.id,cssClass:r.cssClass},l=this.createElement("div",{className:s.cssClass,id:r.id+at});l.classList.add(ve),s.content=l,o.push(s)}return o},s.prototype.renderInitialTab=function(e){var o=this.createGroups(this.tabs[parseInt(e.toString(),10)].groups,e),i=this.tabObj.items[parseInt(e.toString(),10)].content;t.append(o,i),"Simplified"===this.activeLayout&&this.element.classList.add(ot);var r=this.tabObj.element.querySelector("#"+this.tabs[this.selectedTab].id+at);this.checkOverflow(this.selectedTab,r)},s.prototype.addOverflowButton=function(e){var o=this,i=this.createElement("button",{id:e}),n=this.createElement("div",{className:Oe,attrs:{tabindex:"0"}}),s=new r.DropDownButton({iconCss:se,cssClass:"e-caret-hide "+_e,target:n,locale:this.locale,enableRtl:this.enableRtl,enablePersistence:this.enablePersistence,beforeClose:function(e){(e.event?t.closest(e.event.target,"."+de):null)&&(e.cancel=!0)}},i);this.element.classList.add(we),g(n,this);var l;return i.onkeydown=i.onclick=function(){o.itemIndex=-1,l=!i.classList.contains("e-ribbon-overall-of-btn")},n.onkeydown=function(e){return o.upDownKeyHandler(e,n,l),o},s},s.prototype.upDownKeyHandler=function(e,o,i){var r;if(i)r=o.getElementsByClassName("e-ribbon-item");else{r=o.querySelector(".e-ribbon-of-tab.e-ribbon-active").getElementsByClassName("e-ribbon-item")}var s,l=r[!this.itemIndex||this.itemIndex<0?0:this.itemIndex].querySelector(".e-control").classList.contains("e-combobox")?r[!this.itemIndex||this.itemIndex<0?0:this.itemIndex].querySelector(".e-combobox"):null;(null===l||"Tab"===e.key||this.itemIndex<0)&&("ArrowDown"===e.key||!e.shiftKey&&"Tab"===e.key?!this.itemIndex&&0!==this.itemIndex||this.itemIndex<0||this.itemIndex===r.length-1?(this.itemIndex=0,s=r[this.itemIndex].closest(".e-ribbon-item"),this.findDisabledItem(s,r,!0),l&&"Tab"===e.key&&(e.preventDefault(),r[this.itemIndex].querySelector(".e-control").focus())):this.itemIndex<r.length-1&&this.itemIndex>=0&&(this.itemIndex++,s=r[this.itemIndex].closest(".e-ribbon-item"),this.findDisabledItem(s,r,!0)):("ArrowUp"===e.key||e.shiftKey&&"Tab"===e.key)&&(null!==l&&"Tab"!==e.key||(this.itemIndex&&-1!==this.itemIndex?this.itemIndex<=r.length-1&&this.itemIndex>0&&(this.itemIndex--,s=r[this.itemIndex].closest(".e-ribbon-item"),this.findDisabledItem(s,r,!1)):(this.itemIndex=r.length-1,s=r[this.itemIndex].closest(".e-ribbon-item"),this.findDisabledItem(s,r,!1),l&&e.shiftKey&&"Tab"===e.key&&(e.preventDefault(),r[this.itemIndex].querySelector(".e-control").focus())))),o.setAttribute("index",this.itemIndex.toString()));var a=parseInt(o.getAttribute("index"),10),c=r[parseInt(a.toString(),10)]?r[parseInt(a.toString(),10)].querySelector(".e-control").getAttribute("data-control"):null;if(("ArrowDown"===e.key||"ArrowUp"===e.key||" "===e.key||"Tab"===e.key)&&("ColorPicker"===c?("Tab"===e.key&&e.preventDefault(),r[parseInt(a.toString(),10)].querySelector(".e-split-colorpicker").focus()):("Tab"===e.key&&e.preventDefault(),r[parseInt(a.toString(),10)].querySelector(".e-control").focus())," "===e.key&&"CheckBox"===c)){var p=r[parseInt(a.toString(),10)].querySelector(".e-control"),u=t.getComponent(p,n.CheckBox);this.itemIndex=-1,u.click()}"SplitButton"!==c||"ArrowRight"!==e.key&&"ArrowLeft"!==e.key||("ArrowRight"===e.key&&(this.enableRtl?r[parseInt(a.toString(),10)].querySelector(".e-control").focus():r[parseInt(a.toString(),10)].querySelector(".e-dropdown-btn").focus()),"ArrowLeft"===e.key&&(this.enableRtl?r[parseInt(a.toString(),10)].querySelector(".e-dropdown-btn").focus():r[parseInt(a.toString(),10)].querySelector(".e-control").focus())),"Enter"===e.key&&(this.itemIndex=-1)},s.prototype.findDisabledItem=function(e,t,o){for(;e&&e.classList.contains("e-disabled");)o?this.itemIndex===t.length-1&&t[this.itemIndex].closest(".e-ribbon-item").classList.contains("e-disabled")&&(this.itemIndex=-1):0===this.itemIndex&&t[this.itemIndex].closest(".e-ribbon-item").classList.contains("e-disabled")&&(this.itemIndex=t.length),o?this.itemIndex++:this.itemIndex--,e=t[this.itemIndex].closest(".e-ribbon-item")},s.prototype.removeOverflowButton=function(e){if(e){var t=e.element;S(e.target),e.destroy(),t.remove()}},s.prototype.removeOverflowEvent=function(e,t){switch(e.type){case"Button":this.ribbonButtonModule.removeOverFlowEvents(e,t);break;case"DropDown":this.ribbonDropDownModule.removeOverFlowEvents(e,t);break;case"SplitButton":this.ribbonSplitButtonModule.removeOverFlowEvents(e,t);break;case"CheckBox":this.ribbonCheckBoxModule.removeOverFlowEvents(e,t);break;case"ColorPicker":this.ribbonColorPickerModule.removeOverFlowEvents(e,t);break;case"ComboBox":this.ribbonComboBoxModule.removeOverFlowEvents(e,t)}},s.prototype.createGroupContainer=function(e,t){var o=this.createElement("div",{className:Te,id:e+ct}),i=this.createElement("div",{className:ke,id:e+st,innerHTML:t});return o.append(i),o},s.prototype.addExpandCollapse=function(){var e=this;this.collapseButton=this.createElement("span",{className:ye+" "+ne,id:this.tabObj.element.id+it,attrs:{tabindex:"0",type:"button","aria-label":"Layout Switcher",role:"button"}}),this.collapseButton.onclick=function(){e.toggleLayout()},this.collapseButton.onkeydown=function(t){"Enter"===t.key&&e.toggleLayout()},this.element.classList.add(Se),"Simplified"===this.activeLayout&&this.collapseButton.classList.add(ge),this.tabObj.element.appendChild(this.collapseButton)},s.prototype.removeExpandCollapse=function(){var e=this,o=a(this.tooltipData,function(t){return t.id===e.collapseButton.id});-1!==o&&this.tooltipData.splice(o,1),this.element.classList.remove(Se),t.remove(this.tabObj.element.querySelector("."+ye)),this.collapseButton=null},s.prototype.reRenderTabs=function(){this.destroyScroll(),this.destroyTabItems(this.tabsInternal),this.checkID(this.tabs,"tab",this.element.id),this.tabsInternal=this.tabs.slice(),this.validateItemSize();var e=this.createTabItems(this.tabs);this.selectedTab>=this.tabs.length&&(this.selectedTab=this.tabs.length-1),this.tabObj.setProperties({items:e,selectedItem:this.selectedTab});""===this.tabObj.items[this.selectedTab].content.innerHTML&&this.renderInitialTab(this.selectedTab)},s.prototype.switchLayout=function(){this.currentControlIndex=0,this.destroyScroll(),this.collapseButton.classList.toggle(ge,"Simplified"===this.activeLayout),this.element.classList.toggle(ot,"Simplified"===this.activeLayout);for(var o=0;o<=this.tabs.length-1;o++){var i=o;if(""!==this.tabObj.items[parseInt(i.toString(),10)].content.innerHTML){var n=this.tabs[parseInt(i.toString(),10)],s=this.tabs[parseInt(i.toString(),10)].groups,l=this.tabObj.element.querySelector("#"+this.tabs[parseInt(i.toString(),10)].id+at),a=l.closest("."+De);if("Simplified"===this.activeLayout)for(var c=0;c<s.length;c++){var p=s[parseInt(c.toString(),10)],u=s[parseInt(c.toString(),10)].orientation;p.isCollapsed?(p.setProperties({isCollapsed:!1},!0),this.removeDropdown(p.id)):(this.checkSmallToMedium(i,n,c,a,l,!0,!1),this.checkMediumToLarge(i,n,c,a,l,!0,!1));for(var d=a.querySelector("#"+p.id),b=(P=d.querySelector("#"+p.id+ct)).querySelectorAll(".e-ribbon-shrink"),h=0;h<b.length;h++)b[parseInt(h.toString(),10)].remove();(L=P.querySelector("#"+p.id+st)).remove();(B=P.querySelector("#"+p.id+at)).classList.replace(We,Fe),B.classList.remove(Ve);for(var f=0;f<p.collections.length;f++){var m=p.collections[parseInt(f.toString(),10)];(E=P.querySelector("#"+m.id)).classList.replace(We,Fe);for(var v=0;v<m.items.length;v++){for(var y=m.items,g=m.items[parseInt(v.toString(),10)],S=!0;S&&g.displayOptions===e.DisplayMode.Classic;){v++;var I=P.querySelector("#"+g.id+ct),C=I.querySelector("#"+g.id);this.destroyFunction(g,C),I.remove(),v<y.length?g=y[parseInt(v.toString(),10)]:S=!1}if(!S)break;var O=g.allowedSizes===e.RibbonItemSize.Large||g.allowedSizes&e.RibbonItemSize.Medium?e.RibbonItemSize.Medium:e.RibbonItemSize.Small;O=!(g.displayOptions&e.DisplayMode.Simplified)&&g.displayOptions&e.DisplayMode.Overflow?e.RibbonItemSize.Medium:O;var w=void 0;if(g.displayOptions&e.DisplayMode.Classic){w=P.querySelector("#"+g.id+ct),g.displayOptions===(e.DisplayMode.Classic|e.DisplayMode.Overflow)&&(this.createOverflowPopup(g,i,p.enableGroupOverflow,p.id,p.header,w,P),g.type!==e.RibbonItemType.DropDown&&g.type!==e.RibbonItemType.SplitButton||this.updatePopupItems(g,w,p.enableGroupOverflow,!0)),g.setProperties({activeSize:O},!0);C=w.querySelector("#"+g.id);this.setItemSize(C,g)}else w=this.createItems([g],u,p.id,p.header,p.enableGroupOverflow,i,P)[0],g.displayOptions&e.DisplayMode.Simplified&&E.append(w)}}p.enableGroupOverflow||d.querySelector("."+Ne)||d.classList.add("e-ribbon-emptyCollection")}else{this.element.classList.remove(we);for(var D=0;D<s.length;D++){p=s[parseInt(D.toString(),10)],u=s[parseInt(D.toString(),10)].orientation;var P,B=(P=a.querySelector("#"+p.id+ct)).querySelector("#"+p.id+at),L=this.createElement("div",{className:Ee,id:p.id+st,innerHTML:p.header});P.appendChild(L),"Row"===u&&B.classList.replace(Fe,We),B.classList.add(Ve);for(f=0;f<p.collections.length;f++){var R=void 0,T=void 0;if(p.enableGroupOverflow){var x=P.querySelector("#"+p.id+nt);x&&(T=(R=t.getInstance(x,r.DropDownButton)).target)}else(R=this.overflowDDB)&&(T=this.overflowDDB.target);m=p.collections[parseInt(f.toString(),10)];var E=P.querySelector("#"+m.id);"Column"===u&&E.classList.replace(Fe,We);for(v=0;v<m.items.length;v++){for(y=m.items,g=m.items[parseInt(v.toString(),10)],S=!0;S&&!(g.displayOptions&e.DisplayMode.Classic);){v++;w=void 0;if((g.displayOptions&e.DisplayMode.Simplified||g.displayOptions&e.DisplayMode.Overflow)&&null!==(w=g.displayOptions&e.DisplayMode.Simplified?P.querySelector("#"+g.id+ct):T.querySelector("#"+g.id+ct))){var k=w.querySelector("#"+g.id);this.destroyFunction(g,k),w.remove()}v<y.length?g=y[parseInt(v.toString(),10)]:S=!1}if(!S)break;if(g.displayOptions&(e.DisplayMode.Simplified|e.DisplayMode.Overflow)){(w=P.querySelector("#"+g.id+ct))||(w=T.querySelector("#"+g.id+ct),g.type!==e.RibbonItemType.DropDown&&g.type!==e.RibbonItemType.SplitButton||this.updatePopupItems(g,w,p.enableGroupOverflow,!1),this.removeOverflowEvent(g,w)),E.append(w)}else{var w=this.createItems([g],u,p.id,p.header,p.enableGroupOverflow,i)[0];E.append(w)}C=P.querySelector("#"+g.id);var M=g.allowedSizes&e.RibbonItemSize.Large?e.RibbonItemSize.Large:g.allowedSizes&e.RibbonItemSize.Medium?e.RibbonItemSize.Medium:e.RibbonItemSize.Small;g.setProperties({activeSize:M},!0),this.setItemSize(C,g)}p.enableGroupOverflow&&R&&0===T.childElementCount&&this.removeOverflowButton(R)}}}this.selectedTab===i&&this.checkOverflow(i,l)}}"Classic"===this.activeLayout&&(this.removeOverflowButton(this.overflowDDB),this.overflowDDB=null)},s.prototype.createLauncherIcon=function(e,o){var i=this,r=this.createElement("div",{className:qe+" "+(this.launcherIconCss?this.launcherIconCss:je),id:e+lt,attrs:{tabindex:"0",type:"button","aria-label":"Launcher Icon",role:"button"}});o.appendChild(r),o.classList.add(ze),t.EventHandler.add(r,"click",this.launcherIconClicked.bind(this,e),this),t.EventHandler.add(r,"keydown",function(t){"Enter"===t.key&&i.launcherIconClicked(e)},this)},s.prototype.launcherIconClicked=function(e){var t={groupId:e};this.trigger("launcherIconClick",t)},s.prototype.createGroups=function(e,o){for(var i=[],r=0;r<e.length;r++){var n=e[parseInt(r.toString(),10)],s=n.orientation,l=this.createElement("div",{className:n.cssClass,id:n.id});l.classList.add(Be),i.push(l);var a=this.createElement("div",{className:n.cssClass,id:n.id+ct});a.classList.add(Le),l.appendChild(a);var c=this.createElement("div",{className:"Simplified"===this.activeLayout?xe:xe+" "+Ve,id:n.id+at});if(c.classList.add("Column"===s||"Simplified"===this.activeLayout?Fe:We),a.appendChild(c),"Classic"===this.activeLayout){var p=this.createElement("div",{className:Ee,id:n.id+st,innerHTML:n.header});a.appendChild(p)}n.showLauncherIcon&&this.createLauncherIcon(n.id,a);var u=this.createCollection(n.collections,n.orientation,n.id,n.header,n.enableGroupOverflow,o,a);t.append(u,c),"Simplified"!==this.activeLayout||n.enableGroupOverflow||l.querySelector("."+Ne)||l.classList.add("e-ribbon-emptyCollection")}return i},s.prototype.validateItemSize=function(){for(var t=0;t<this.tabs.length;t++)for(var o=this.tabs[parseInt(t.toString(),10)].groups,i=0;i<o.length;i++)for(var r=o[parseInt(i.toString(),10)].collections,n=o[parseInt(i.toString(),10)].orientation,s=0;s<r.length;s++)for(var l=r[parseInt(s.toString(),10)].items,a=0;a<l.length;a++){var c=l[parseInt(a.toString(),10)];if(c.allowedSizes&&0!==c.allowedSizes||c.setProperties({allowedSizes:e.RibbonItemSize.Small|e.RibbonItemSize.Medium|e.RibbonItemSize.Large},!0),"ColorPicker"===c.type&&c.allowedSizes!==e.RibbonItemSize.Small)c.setProperties({allowedSizes:e.RibbonItemSize.Small},!0);else if("ComboBox"!==c.type&&"CheckBox"!==c.type||c.allowedSizes===e.RibbonItemSize.Medium){if(("Column"===n&&l.length>1||"Row"===n&&r.length>1)&&c.allowedSizes&e.RibbonItemSize.Large){var p=c.allowedSizes&(e.RibbonItemSize.Small|e.RibbonItemSize.Medium);p=p||e.RibbonItemSize.Medium,c.setProperties({allowedSizes:p},!0)}}else c.setProperties({allowedSizes:e.RibbonItemSize.Medium},!0);var u=c.allowedSizes&e.RibbonItemSize.Large?e.RibbonItemSize.Large:c.allowedSizes&e.RibbonItemSize.Medium?e.RibbonItemSize.Medium:e.RibbonItemSize.Small;c.setProperties({activeSize:u},!0)}},s.prototype.createCollection=function(e,o,i,r,n,s,l){for(var a=[],c=0;c<e.length;c++){var p=e[parseInt(c.toString(),10)],u=this.createElement("div",{className:p.cssClass,id:p.id});u.classList.add(Ae),u.classList.add("Column"!==o||"Simplified"===this.activeLayout?Fe:We),a.push(u);var d=this.createItems(p.items,o,i,r,n,s,l);if(t.append(d,u),"Row"===o&&2===c)break}return a},s.prototype.createRibbonItem=function(e,t){switch(e.type){case"Button":this.ribbonButtonModule.createButton(e,t);break;case"DropDown":this.ribbonDropDownModule.createDropDown(e,t);break;case"SplitButton":this.ribbonSplitButtonModule.createSplitButton(e,t);break;case"CheckBox":this.ribbonCheckBoxModule.createCheckBox(e,t);break;case"ColorPicker":this.ribbonColorPickerModule.createColorPicker(e,t);break;case"ComboBox":this.ribbonComboBoxModule.createComboBox(e,t);break;case"Template":this.createTemplateContent(e,t)}},s.prototype.createItems=function(t,o,i,r,n,s,l){for(var a,c=[],p=0;p<t.length;p++){for(var u=t[parseInt(p.toString(),10)],d=!0;d&&("Simplified"===this.activeLayout&&!(u.displayOptions&(e.DisplayMode.Simplified|e.DisplayMode.Overflow))||"Classic"===this.activeLayout&&!(u.displayOptions&e.DisplayMode.Classic));)++p<t.length?u=t[parseInt(p.toString(),10)]:d=!1;if(!d)break;var b=this.createElement("div",{className:u.cssClass,id:u.id+ct});(a=b.classList).add.apply(a,[Ne].concat(u.disabled?[ae]:[])),u.ribbonTooltipSettings&&v(u.ribbonTooltipSettings)&&(b.classList.add(Ye),this.tooltipData.push({id:b.id,data:u.ribbonTooltipSettings}));var h=u.activeSize;if("Simplified"===this.activeLayout&&(h=u.allowedSizes===e.RibbonItemSize.Large||u.allowedSizes&e.RibbonItemSize.Medium||u.displayOptions===e.DisplayMode.Overflow?e.RibbonItemSize.Medium:e.RibbonItemSize.Small,u.setProperties({activeSize:h},!0)),h&e.RibbonItemSize.Large?b.classList.add(He,Ve):b.classList.add(h&e.RibbonItemSize.Medium?Ge:Ue),this.createRibbonItem(u,b),"Simplified"!==this.activeLayout||u.displayOptions!==e.DisplayMode.Overflow&&u.displayOptions!==(e.DisplayMode.Classic|e.DisplayMode.Overflow)?c.push(b):(this.createOverflowPopup(u,s,n,i,r,b,l),u.type!==e.RibbonItemType.DropDown&&u.type!==e.RibbonItemType.SplitButton||this.updatePopupItems(u,b,n,!0)),"Column"===o&&2===p)break}return c},s.prototype.createHelpPaneTemplate=function(){if(this.helpPaneTemplate){var e="helpPaneTemplate";this.clearTemplate([e]),this.ribbonTempEle=this.createElement("div",{className:Xe,id:this.element.id+bt});var o=c(this.helpPaneTemplate);t.append(o({},this,e,"helpPaneTemplate",this.isStringTemplate),this.ribbonTempEle);var i=this.tabObj.element;i.querySelector(".e-toolbar").after(this.ribbonTempEle),i.style.setProperty(ft,this.ribbonTempEle.offsetWidth+"px"),this.renderReactTemplates()}},s.prototype.createTemplateContent=function(e,t){var o=this.createElement("div",{className:e.cssClass?Ke+" "+e.cssClass:Ke,id:e.id});e.disabled&&(o.classList.add(ae),o.setAttribute("disabled","")),t.appendChild(o),this.renderItemTemplate(e,o)},s.prototype.renderItemTemplate=function(o,i){var r="ribbon"+o.id+"itemTemplate";this.clearTemplate([r]);var n=c(o.itemTemplate);t.append(n({activeSize:e.RibbonItemSize[o.activeSize]},this,r,o.id+"itemTemplate",this.isStringTemplate),i),this.renderReactTemplates()},s.prototype.checkID=function(e,t,o){for(var i="tab"===t?"_tab":"group"===t?"_group":"collection"===t?"_collection":"_item",r=0;r<e.length;r++){var n=e[parseInt(r.toString(),10)];switch(n.id||n.setProperties({id:o+i+this.idIndex++},!0),t){case"tab":n.setProperties({groups:this.checkID(n.groups,"group",n.id)},!0);break;case"group":n.setProperties({collections:this.checkID(n.collections,"collection",n.id)},!0);break;case"collection":n.setProperties({items:this.checkID(n.items,"item",n.id)},!0)}}return e},s.prototype.updateCommonProperty=function(o){this.tabObj.setProperties(o),this.ribbonFileMenuModule&&this.ribbonFileMenuModule.setCommonProperties(o);for(var i=0;i<this.tabs.length;i++)for(var n=this.tabs[parseInt(i.toString(),10)],s=this.tabObj.items[parseInt(i.toString(),10)].content,l=0,a=n.groups;l<a.length;l++){var c=a[l],p=void 0,u=void 0;this.activeLayout===e.RibbonLayout.Classic?p=c.isCollapsed?s.querySelector("#"+c.id+pt+ut):null:(u=(p=c.enableGroupOverflow?s.querySelector("#"+c.id+nt):null)?t.getComponent(p,r.DropDownButton):this.overflowDDB)&&(I(u.target,o),u.setProperties(o));for(var d=0,b=c.collections;d<b.length;d++)for(var f=0,m=b[d].items;f<m.length;f++){var v=m[f],y=null;if(this.activeLayout===e.RibbonLayout.Classic?v.displayOptions&e.DisplayMode.Classic&&(y=p?this.ribbonDropDownModule.getDDBItemElement(p,v.id):s.querySelector("#"+v.id)):(y=v.displayOptions&e.DisplayMode.Simplified?s.querySelector("#"+v.id):null)||(y=u.target.querySelector("#"+v.id),"DropDown"===v.type&&this.updatePopupItems(v,u.target,c.enableGroupOverflow,!0)),y){var g=this.getItemModuleName(v);"template"!==g?h(y,g,o):t.isNullOrUndefined(o.enableRtl)||y.classList.toggle(ce,o.enableRtl)}}}},s.prototype.removeLauncherIcon=function(e,o,i){var r=e+ct,n=o?this.ribbonDropDownModule.getDDBItemElement(o,r):i.querySelector("#"+r);if(n){n.classList.remove(ze);var s=n.querySelector("#"+e+lt);t.remove(s)}},s.prototype.destroyTabItems=function(o){for(var i=0;i<o.length;i++)for(var n=o[parseInt(i.toString(),10)],s=this.tabObj.items[parseInt(i.toString(),10)].content,l=0,a=n.groups;l<a.length;l++){var c=a[l],p=void 0,u=void 0;this.activeLayout===e.RibbonLayout.Classic?(p=c.isCollapsed?s.querySelector("#"+c.id+pt+ut):null,c.showLauncherIcon&&this.removeLauncherIcon(c.id,p,s)):u=(p=c.enableGroupOverflow?s.querySelector("#"+c.id+nt):null)?t.getComponent(p,r.DropDownButton):this.overflowDDB;for(var d=0,b=c.collections;d<b.length;d++)for(var h=0,f=b[d].items;h<f.length;h++){var m=f[h],v=void 0;this.activeLayout===e.RibbonLayout.Classic?m.displayOptions&e.DisplayMode.Classic&&(v=p?this.ribbonDropDownModule.getDDBItemElement(p,m.id):s.querySelector("#"+m.id)):(v=m.displayOptions&e.DisplayMode.Simplified?s.querySelector("#"+m.id):null)||(v=u?u.target.querySelector("#"+m.id):null),v&&this.destroyFunction(m,v)}this.activeLayout===e.RibbonLayout.Classic&&p?this.ribbonDropDownModule.removeOverFlowDropDown(p):this.activeLayout===e.RibbonLayout.Simplified&&c.enableGroupOverflow&&p&&this.removeOverflowButton(u)}this.overflowDDB&&(this.removeOverflowButton(this.overflowDDB),this.overflowDDB=null)},s.prototype.destroyFunction=function(e,t){var o=this.getItemModuleName(e);if("colorpicker"===o?this.ribbonColorPickerModule.unwireColorPickerEvents(t):"template"!==o&&b(t,o),e.ribbonTooltipSettings){var i=a(this.tooltipData,function(t){return t.id===e.id+ct});-1!==i&&this.tooltipData.splice(i,1)}},s.prototype.getItemModuleName=function(e){switch(e.type){case"Button":return"btn";case"DropDown":return"dropdown-btn";case"SplitButton":return"split-btn";case"CheckBox":return"checkbox";case"ColorPicker":return"colorpicker";case"ComboBox":return"combobox";default:return"template"}},s.prototype.clearOverflowResize=function(){this.destroyScroll(),this.clearOverflowDropDown(this.selectedTab);for(var e=this.tabs[this.selectedTab],t=this.tabObj.element.querySelector("#"+this.tabs[this.selectedTab].id+at),o=t.closest("."+De),i=0;i<e.groups.length;i++)this.checkSmallToMedium(this.selectedTab,e,i,o,t,!0,!0),this.checkMediumToLarge(this.selectedTab,e,i,o,t,!0,!0)},s.prototype.refreshLayout=function(){this.resizeHandler()},s.prototype.selectTab=function(e){var t=a(this.tabs,function(t){return t.id===e});this.setProperties({selectedTab:t})},s.prototype.addTab=function(e,t,o){var i=t?a(this.tabs,function(e){return e.id===t}):-1;i=-1===i?this.tabs.length:i+(o?1:0),this.tabsInternal=this.tabs.slice(),this.tabsInternal.splice(i,0,e),this.setProperties({tabs:this.tabsInternal},!0),this.checkID([this.tabs[parseInt(i.toString(),10)]],"tab",this.element.id),this.tabsInternal=this.tabs.slice(),this.validateItemSize();var r=this.createTabItems([e]);this.tabObj.addTab(r,i)},s.prototype.removeTab=function(e){var t=a(this.tabs,function(t){return t.id===e});if(-1!==t){var o=this.tabObj.items[parseInt(t.toString(),10)].content,i=this.tabs[parseInt(t.toString(),10)].groups;if(i&&""!==o.innerHTML)for(var r=0,n=i;r<n.length;r++){for(var s=n[r],l=s.isCollapsed?o.querySelector("#"+s.id+pt+ut):null,c=0,p=s.collections;c<p.length;c++)for(var u=0,d=p[c].items;u<d.length;u++){var b=d[u],h=l?this.ribbonDropDownModule.getDDBItemElement(l,b.id):o.querySelector("#"+b.id);h&&this.destroyFunction(b,h)}l&&this.ribbonDropDownModule.removeOverFlowDropDown(l)}t===this.selectedTab&&(this.isAddRemove=!0),this.tabsInternal=this.tabs.slice(),this.tabsInternal.splice(t,1),this.setProperties({tabs:this.tabsInternal},!0),this.tabObj.removeTab(t)}},s.prototype.addGroup=function(e,t,o,i){var r=a(this.tabs,function(t){return t.id===e});if(-1!==r){this.selectedTab===r&&this.clearOverflowResize();var n=this.tabs[parseInt(r.toString(),10)],s=n.groups.slice(),l=o?a(s,function(e){return e.id===o}):-1;l=-1===l?s.length:l+(i?1:0),s.splice(l,0,t),n.setProperties({groups:s},!0),this.checkID([n.groups[parseInt(l.toString(),10)]],"group",e),this.validateItemSize();var c=this.tabObj.items[parseInt(r.toString(),10)].content;if(""!==c.innerHTML){var p=this.createGroups([n.groups[parseInt(l.toString(),10)]],r)[0],u=o?c.querySelector("#"+o):null;u?u.insertAdjacentElement(i?"afterend":"beforebegin",p):c.append(p)}this.selectedTab===r&&this.refreshLayout()}},s.prototype.removeGroup=function(o){var i=d(this.tabs,o);if(i){this.selectedTab===i.tabIndex&&this.clearOverflowResize();var n=this.tabObj.items[i.tabIndex].content;if(""!==n.innerHTML){var s=void 0,l=void 0;i.group.showLauncherIcon&&this.removeLauncherIcon(i.group.id,null,n),this.activeLayout===e.RibbonLayout.Simplified&&(l=(s=i.group.enableGroupOverflow?n.querySelector("#"+i.group.id+nt):null)?t.getComponent(s,r.DropDownButton):this.overflowDDB);for(var a=0,c=i.group.collections;a<c.length;a++)for(var p=0,u=c[a].items;p<u.length;p++){var b=u[p];this.removeItemElement(n,b,l)}if(this.activeLayout===e.RibbonLayout.Simplified)if(i.group.enableGroupOverflow)0===l.target.childElementCount&&this.removeOverflowButton(l);else{var h=l.target.querySelector("#"+i.group.id+ct);h&&1===h.childElementCount&&h.remove();var f=l.target.querySelector("#"+this.tabs[parseInt(i.tabIndex.toString(),10)].id+pt);f&&0===f.childElementCount&&f.remove()}var m=n.querySelector("#"+o);m&&m.remove()}var v=this.tabs[i.tabIndex].groups.slice();v.splice(i.groupIndex,1),this.tabs[i.tabIndex].setProperties({groups:v},!0),this.selectedTab===i.tabIndex&&this.refreshLayout()}},s.prototype.addCollection=function(e,t,o,i){var r=d(this.tabs,e);if(r&&("Row"!==r.group.orientation||3!==r.group.collections.length)){this.selectedTab===r.tabIndex&&this.clearOverflowResize();var n=r.group.collections.slice(),s=o?a(n,function(e){return e.id===o}):-1;s=-1===s?n.length:s+(i?1:0),n.splice(s,0,t),r.group.setProperties({collections:n},!0),this.checkID([r.group.collections[parseInt(s.toString(),10)]],"collection",e),this.validateItemSize();var l=this.tabObj.items[r.tabIndex].content;if(""!==l.innerHTML){var c=r.group.collections[parseInt(s.toString(),10)],p=this.createCollection([c],r.group.orientation,r.group.id,r.group.header,r.group.enableGroupOverflow,r.tabIndex)[0];r.group.isCollapsed&&(l=this.ribbonDropDownModule.getOverflowDropDownPopup(r,l));var u=o?l.querySelector("#"+o):null;u?u.insertAdjacentElement(i?"afterend":"beforebegin",p):l.querySelector("#"+e+at).append(p)}this.selectedTab===r.tabIndex&&this.refreshLayout()}},s.prototype.removeCollection=function(o){var i=u(this.tabs,o);if(i){this.selectedTab===i.tabIndex&&this.clearOverflowResize();var n=this.tabObj.items[i.tabIndex].content;if(""!==n.innerHTML){var s=void 0,l=void 0;this.activeLayout===e.RibbonLayout.Simplified&&(l=(s=i.group.enableGroupOverflow?n.querySelector("#"+i.group.id+nt):null)?t.getComponent(s,r.DropDownButton):this.overflowDDB);for(var a=0,c=i.collection.items;a<c.length;a++){var p=c[a];this.removeItemElement(n,p,l)}var d=n.querySelector("#"+o);d&&d.remove()}var b=i.group,h=b.collections.slice();h.splice(i.collectionIndex,1),b.setProperties({collections:h},!0),this.selectedTab===i.tabIndex&&this.refreshLayout()}},s.prototype.addItem=function(e,t,o,i){var r=u(this.tabs,e);if(r&&("Column"!==r.group.orientation||3!==r.collection.items.length)){this.selectedTab===r.tabIndex&&this.clearOverflowResize();var n=r.collection.items.slice(),s=o?a(n,function(e){return e.id===o}):-1;s=-1===s?n.length:s+(i?1:0),n.splice(s,0,t),r.collection.setProperties({items:n},!0),this.checkID([r.collection.items[parseInt(s.toString(),10)]],"item",e),this.validateItemSize();var l=this.tabObj.items[r.tabIndex].content,c=l.querySelector("#"+r.group.id+ct);if(""!==l.innerHTML){var p=r.collection.items[parseInt(s.toString(),10)],d=this.createItems([p],r.group.orientation,r.group.id,r.group.header,r.group.enableGroupOverflow,r.tabIndex,c)[0];r.group.isCollapsed&&(l=this.ribbonDropDownModule.getOverflowDropDownPopup(r,l));var b=o?l.querySelector("#"+o):null;b?b.closest("."+Ne).insertAdjacentElement(i?"afterend":"beforebegin",d):d&&l.querySelector("#"+e).append(d)}this.selectedTab===r.tabIndex&&this.refreshLayout()}},s.prototype.removeItem=function(o){var i=p(this.tabs,o);if(i){this.selectedTab===i.tabIndex&&this.clearOverflowResize();var n=this.tabObj.items[i.tabIndex].content;if(""!==n.innerHTML){var s=void 0,l=void 0;this.activeLayout===e.RibbonLayout.Simplified&&(l=(s=i.group.enableGroupOverflow?n.querySelector("#"+i.group.id+nt):null)?t.getComponent(s,r.DropDownButton):this.overflowDDB);var a=i.item;this.removeItemElement(n,a,l)}var c=i.collection,u=c.items;u.splice(i.itemIndex,1),c.setProperties({items:u},!0),this.selectedTab===i.tabIndex&&this.refreshLayout()}},s.prototype.updateTab=function(e){var o=e.id,i=a(this.tabs,function(e){return e.id===o});if(-1!==i){var r=this.tabObj.items[parseInt(i.toString(),10)].content,n=this.tabs[parseInt(i.toString(),10)].groups,s=this.tabObj.element;if(n&&""!==r.innerHTML&&(e.cssClass&&this.tabs[parseInt(i.toString(),10)].cssClass&&(r.classList.remove(this.tabs[parseInt(i.toString(),10)].cssClass),s.querySelector(".e-active").classList.remove(this.tabs[parseInt(i.toString(),10)].cssClass)),e.groups)){for(var l=0,c=n;l<c.length;l++){for(var p=c[l],u=p.isCollapsed?r.querySelector("#"+p.id+pt+ut):null,d=0,b=p.collections;d<b.length;d++)for(var h=0,f=b[d].items;h<f.length;h++){var m=f[h],v=u?this.ribbonDropDownModule.getDDBItemElement(u,m.id):r.querySelector("#"+m.id);v&&this.destroyFunction(m,v)}u&&this.ribbonDropDownModule.removeOverFlowDropDown(u)}r.querySelectorAll(".e-ribbon-group").forEach(function(e){e.remove()})}i===this.selectedTab&&(this.isAddRemove=!0);var y=this.tabs[parseInt(i.toString(),10)];if(y.setProperties(e,!0),this.setProperties({groups:this.checkID(y.groups,"group",y.id)},!0),this.validateItemSize(),""===r.innerHTML){if(e.groups){var g=this.createGroups(y.groups,i);t.append(g,r)}this.selectedTab===i&&this.refreshLayout(),e.cssClass&&(r.classList.add(y.cssClass),s.querySelector(".e-active").classList.add(y.cssClass)),e.header&&(s.querySelector("#"+o+st).innerText=y.header)}}},s.prototype.updateGroup=function(o){var i=o.id,n=d(this.tabs,i);if(n){this.selectedTab===n.tabIndex&&this.clearOverflowResize();var s,l,a=this.tabObj.items[n.tabIndex].content,c=a.querySelector("#"+i),p=c.querySelector("#"+o.id+ct);if(""!==a.innerHTML){if(n.group.showLauncherIcon&&this.removeLauncherIcon(n.group.id,null,a),this.activeLayout===e.RibbonLayout.Simplified&&(l=(s=n.group.enableGroupOverflow?a.querySelector("#"+n.group.id+nt):null)?t.getComponent(s,r.DropDownButton):this.overflowDDB),o.cssClass&&n.group.cssClass&&(c.classList.remove(n.group.cssClass),p&&p.classList.remove(n.group.cssClass)),(o.collections||o.orientation)&&(n.group.collections||n.group.orientation)){for(var u=0,b=n.group.collections;u<b.length;u++)for(var h=0,f=b[u].items;h<f.length;h++){var m=f[h];this.removeItemElement(a,m,l)}if(c.querySelectorAll(".e-ribbon-collection").forEach(function(e){e.remove()}),o.orientation){var v=(I=p.querySelector(".e-ribbon-group-content")).classList.value.match(/(e-ribbon-[column|row]+)/g);v&&t.removeClass([I],v)}}if(this.activeLayout===e.RibbonLayout.Simplified)if(n.group.enableGroupOverflow)0===l.target.childElementCount&&this.removeOverflowButton(l);else{var y=l.target.querySelector("#"+n.group.id+ct);y&&1===y.childElementCount&&y.remove();var g=l.target.querySelector("#"+this.tabs[parseInt(n.tabIndex.toString(),10)].id+pt);g&&0===g.childElementCount&&g.remove()}}var S=n.group;if(S.setProperties(o,!0),S.setProperties({collections:this.checkID(S.collections,"collection",S.id)},!0),this.validateItemSize(),""!==a.innerHTML){if(o.showLauncherIcon&&this.createLauncherIcon(S.id,p),o.collections||o.orientation){var I;(I=p.querySelector(".e-ribbon-group-content")).classList.add("Column"===S.orientation||"Simplified"===this.activeLayout?Fe:We);var C=this.createCollection(S.collections,S.orientation,S.id,S.header,S.enableGroupOverflow,n.tabIndex,p);t.append(C,I)}if(this.selectedTab===n.tabIndex&&this.refreshLayout(),o.cssClass&&(c.classList.add(S.cssClass),p&&p.classList.add(S.cssClass)),o.header)if(this.activeLayout!==e.RibbonLayout.Simplified||o.enableGroupOverflow)if(this.activeLayout!==e.RibbonLayout.Classic||S.isCollapsed){if(this.activeLayout===e.RibbonLayout.Classic&&S.isCollapsed){var O=c.querySelector("#"+S.id+pt+ut);(w=t.getInstance(O,r.DropDownButton).target.querySelector("#"+o.id+st))&&(w.innerText=S.header)}}else c.querySelector(".e-ribbon-group-header").innerText=S.header;else{var w;(w=l.target.querySelector("#"+o.id+st))&&(w.innerText=S.header)}}}},s.prototype.updateCollection=function(o){var i=o.id,n=u(this.tabs,i);if(n){this.selectedTab===n.tabIndex&&this.clearOverflowResize();var s=this.tabObj.items[n.tabIndex].content,l=s.querySelector("#"+i);if(""!==s.innerHTML){var a=void 0,c=void 0;if(this.activeLayout===e.RibbonLayout.Simplified&&(c=(a=n.group.enableGroupOverflow?s.querySelector("#"+n.group.id+nt):null)?t.getComponent(a,r.DropDownButton):this.overflowDDB),o.cssClass&&n.collection.cssClass&&l.classList.remove(n.collection.cssClass),o.items&&n.collection.items)for(var p=0,d=n.collection.items;p<d.length;p++){var b=d[p];this.removeItemElement(s,b,c)}}var h=n.collection;if(h.setProperties(o,!0),h.setProperties({items:this.checkID(h.items,"item",h.id)},!0),this.validateItemSize(),""!==s.innerHTML&&o.items){var f=s.querySelector("#"+n.group.id+ct),m=this.createItems(h.items,n.group.orientation,n.group.id,n.group.header,n.group.enableGroupOverflow,n.tabIndex,f);t.append(m,l)}this.selectedTab===n.tabIndex&&this.refreshLayout(),o.cssClass&&l.classList.add(h.cssClass)}},s.prototype.updateItem=function(o){var i=o.id,n=p(this.tabs,i);if(n){this.selectedTab===n.tabIndex&&this.clearOverflowResize();var s,l,a=this.tabObj.items[n.tabIndex].content,c=a.querySelector("#"+n.group.id).querySelector("#"+n.group.id+ct),u=null,d=null;if(""!==a.innerHTML){if(this.activeLayout===e.RibbonLayout.Simplified&&(l=(s=n.group.enableGroupOverflow?a.querySelector("#"+n.group.id+nt):null)?t.getComponent(s,r.DropDownButton):this.overflowDDB),this.activeLayout===e.RibbonLayout.Simplified&&n.item.displayOptions===e.DisplayMode.Overflow){if(u=l.target.querySelector("#"+i+ct),d=l.target.querySelector("#"+i),o.displayOptions&&o.displayOptions!==e.DisplayMode.Overflow){var b=c.querySelector("#"+n.collection.id);b&&b.appendChild(u)}}else u=c.querySelector("#"+i+ct),d=a.querySelector("#"+i),this.activeLayout===e.RibbonLayout.Simplified&&o.displayOptions===e.DisplayMode.Overflow&&(this.createOverflowPopup(n.item,n.tabIndex,n.group.enableGroupOverflow,n.group.id,n.group.header,u,c),n.item.type!==e.RibbonItemType.DropDown&&n.item.type!==e.RibbonItemType.SplitButton||this.updatePopupItems(n.item,u,n.group.enableGroupOverflow,!0));o.cssClass&&n.item.cssClass&&u.classList.remove(n.item.cssClass),this.destroyFunction(n.item,d),d.remove();var h=u.classList.value.match(/(e-ribbon-[large|medium|small]+-item)/g);h&&t.removeClass([u],h)}var f=n.item;if(f.setProperties(o,!0),this.validateItemSize(),""!==a.innerHTML){u=this.activeLayout!==e.RibbonLayout.Simplified||f.displayOptions!==e.DisplayMode.Overflow?c.querySelector("#"+i+ct):l.target.querySelector("#"+i+ct),f.ribbonTooltipSettings&&v(f.ribbonTooltipSettings)&&(u.classList.add(Ye),this.tooltipData.push({id:u.id,data:f.ribbonTooltipSettings}));var m=f.activeSize;"Simplified"===this.activeLayout&&(m=f.allowedSizes===e.RibbonItemSize.Large||f.allowedSizes&e.RibbonItemSize.Medium||f.displayOptions===e.DisplayMode.Overflow?e.RibbonItemSize.Medium:e.RibbonItemSize.Small,f.setProperties({activeSize:m},!0)),m&e.RibbonItemSize.Large?u.classList.add(He,Ve):u.classList.add(m&e.RibbonItemSize.Medium?Ge:Ue),this.createRibbonItem(f,u),"Simplified"===this.activeLayout&&n.group.enableGroupOverflow&&0===l.target.childElementCount&&this.removeOverflowButton(l),this.selectedTab===n.tabIndex&&this.refreshLayout(),o.cssClass&&u.classList.add(f.cssClass),this.enableDisableItem(f.id,f.disabled)}}},s.prototype.removeItemElement=function(t,o,i){var r=null;this.activeLayout===e.RibbonLayout.Classic?r=o.displayOptions&e.DisplayMode.Classic?t.querySelector("#"+o.id):null:(r=o.displayOptions&e.DisplayMode.Simplified?t.querySelector("#"+o.id):null)||(r=i.target.querySelector("#"+o.id)),r&&(this.destroyFunction(o,r),r.closest("#"+o.id+ct).remove())},s.prototype.enableItem=function(e){this.enableDisableItem(e,!1)},s.prototype.disableItem=function(e){this.enableDisableItem(e,!0)},s.prototype.enableDisableItem=function(e,o){var i=p(this.tabs,e);if(i){i.item.setProperties({disabled:o},!0);var r=m(this,e,i);if(r){t.closest(r,".e-ribbon-item").classList.toggle(ae,i.item.disabled);var n=this.getItemModuleName(i.item);"template"!==n?f(r,n,o):(r.classList.toggle(ae,o),r.toggleAttribute("disabled",o))}}},s.prototype.unwireEvents=function(){t.EventHandler.remove(window,"resize",this.resizeHandler)},s.prototype.destroy=function(){this.keyboardModuleRibbon.destroy(),this.keyboardModuleRibbon=null,S(this.element),this.destroyTabItems(this.tabs),this.removeExpandCollapse(),this.collapseButton=void 0,this.scrollModule&&this.scrollModule.destroy(),this.ribbonTempEle&&(t.remove(this.ribbonTempEle),this.ribbonTempEle=null),i.prototype.destroy.call(this),this.tabObj.destroy(),this.tabObj=void 0,t.remove(this.element.querySelector("#"+this.element.id+"_tab")),this.element.style.removeProperty(ht),this.element.style.removeProperty(ft),this.element.style.removeProperty("width"),this.cssClass&&t.removeClass([this.element],this.cssClass.split(" ")),this.element.classList.remove(ce,ot,we,Se,Pe,"e-rbn"),this.unwireEvents()},s.prototype.onPropertyChanged=function(e,o){for(var i,n,s=0,l=Object.keys(e);s<l.length;s++){switch(l[s]){case"activeLayout":this.switchLayout();break;case"cssClass":o.cssClass&&(i=this.element.classList).remove.apply(i,o.cssClass.split(" ")),e.cssClass&&(n=this.element.classList).add.apply(n,e.cssClass.split(" "));break;case"isMinimized":this.element.classList.toggle(Pe,this.isMinimized),this.tabObj.element.querySelector(".e-content").style.display=this.isMinimized?"none":"block",this.isMinimized||this.refreshLayout();break;case"locale":this.updateCommonProperty({locale:this.locale});break;case"enablePersistence":this.updateCommonProperty({enablePersistence:this.enablePersistence});break;case"enableRtl":this.element.classList.toggle(ce,this.enableRtl),this.updateCommonProperty({enableRtl:e.enableRtl}),this.scrollModule&&this.scrollModule.setProperties({enableRtl:e.enableRtl});break;case"launcherIconCss":for(var a=0;a<this.tabs.length;a++){var c=this.tabObj.items[parseInt(a.toString(),10)].content,p=this.tabs[parseInt(a.toString(),10)];if(c.querySelector("."+Be))for(var u=0,d=p.groups;u<d.length;u++){var b=d[u];if(b.showLauncherIcon){var h=qe+" "+(this.launcherIconCss||je);if(b.isCollapsed){var f=c.querySelector("#"+b.id+pt+ut);t.getComponent(f,r.DropDownButton).target.querySelector("#"+b.id+lt).className=h}else{(f=c.querySelector("#"+b.id+lt)).className=h}}}}break;case"selectedTab":this.tabObj.setProperties({selectedItem:e.selectedTab});break;case"tabAnimation":this.tabObj.setProperties({animation:e.tabAnimation});break;case"tabs":this.reRenderTabs();break;case"width":this.element.style.width=t.formatUnit(e.width),this.refreshLayout();break;case"fileMenu":this.ribbonFileMenuModule&&this.ribbonFileMenuModule.updateFileMenu(this.fileMenu);this.tabObj.tbObj.refreshOverflow();break;case"helpPaneTemplate":this.ribbonTempEle&&(t.remove(this.ribbonTempEle),this.ribbonTempEle=null,this.tabObj.element.style.setProperty(ft,"0px")),this.helpPaneTemplate&&this.createHelpPaneTemplate();this.tabObj.tbObj.refreshOverflow()}}};var l;return Ot([t.Property("Classic")],s.prototype,"activeLayout",void 0),Ot([t.Property("")],s.prototype,"cssClass",void 0),Ot([t.Complex({},ie)],s.prototype,"fileMenu",void 0),Ot([t.Property("")],s.prototype,"launcherIconCss",void 0),Ot([t.Property(!1)],s.prototype,"isMinimized",void 0),Ot([t.Property("en-us")],s.prototype,"locale",void 0),Ot([t.Property(0)],s.prototype,"selectedTab",void 0),Ot([t.Complex({},o.TabAnimationSettings)],s.prototype,"tabAnimation",void 0),Ot([t.Collection([],ee)],s.prototype,"tabs",void 0),Ot([t.Property("100%")],s.prototype,"width",void 0),Ot([t.Property("")],s.prototype,"helpPaneTemplate",void 0),Ot([t.Event()],s.prototype,"tabSelecting",void 0),Ot([t.Event()],s.prototype,"tabSelected",void 0),Ot([t.Event()],s.prototype,"ribbonExpanding",void 0),Ot([t.Event()],s.prototype,"ribbonCollapsing",void 0),Ot([t.Event()],s.prototype,"launcherIconClick",void 0),s=l=Ot([t.NotifyPropertyChanges],s)}(t.Component),Dt=function(){function e(e){this.parent=e}return e.prototype.getModuleName=function(){return"ribbonFileMenu"},e.prototype.destroy=function(){this.fileMenuDDB&&this.destroyDDB(),this.parent=null},e.prototype.createFileMenu=function(e){var t=this;if(e.visible){this.ddbElement=this.parent.createElement("button",{id:this.parent.element.id+"_filemenu"});var o=this.parent.tabObj.element,i=o.querySelector(".e-toolbar");o.insertBefore(this.ddbElement,i),this.fileMenuDDB=new r.DropDownButton({content:e.text,enableRtl:this.parent.enableRtl,cssClass:"e-ribbon-file-menu e-caret-hide",created:function(){o.style.setProperty(ht,t.ddbElement.offsetWidth+"px")},beforeClose:this.ddbBeforeEvent.bind(this,!1),beforeOpen:this.ddbBeforeEvent.bind(this,!0),close:this.ddbAfterEvent.bind(this,!1),open:this.ddbAfterEvent.bind(this,!0)},this.ddbElement),this.parent.fileMenu.popupTemplate?this.fileMenuDDB.setProperties({target:this.parent.fileMenu.popupTemplate}):this.createRibbonMenu(e),this.parent.tabObj.refreshActiveTabBorder(),this.addFileMenuTooltip(e)}},e.prototype.addFileMenuTooltip=function(e){v(e.ribbonTooltipSettings)&&(this.ddbElement.classList.add(Ye),this.parent.tooltipData.push({id:this.ddbElement.id,data:e.ribbonTooltipSettings}))},e.prototype.ddbBeforeEvent=function(e,t){!e&&t.event&&t.event.target.closest(".e-ribbon-menu")&&(t.cancel=!0);var o=e?this.parent.fileMenu.beforeOpen:this.parent.fileMenu.beforeClose;if(o){var i={cancel:t.cancel,element:t.element,event:t.event};o.call(this,i),t.cancel=i.cancel}},e.prototype.ddbAfterEvent=function(e,t){(e?this.fileMenuDDB.target:this.fileMenuDDB.element).focus();var o=e?this.parent.fileMenu.open:this.parent.fileMenu.close;if(o){var i={element:t.element};o.call(this,i)}},e.prototype.cloneMenuItem=function(e){for(var t=[],o=0;o<e.length;o++){var i=e[parseInt(o.toString(),10)];t.push({iconCss:i.iconCss,id:i.id,separator:i.separator,text:i.text,url:i.url,items:this.cloneMenuItem(i.items)})}return t},e.prototype.createRibbonMenu=function(e){var i=this,r=this.parent.createElement("ul",{id:this.parent.element.id+dt});this.fileMenuDDB.setProperties({target:r}),this.menuctrl=new o.Menu({orientation:"Vertical",enableRtl:this.parent.enableRtl,cssClass:"e-ribbon-menu",animationSettings:e.animationSettings,items:this.cloneMenuItem(e.menuItems),showItemOnClick:e.showItemOnClick,template:e.itemTemplate,beforeClose:this.menuBeforeEvent.bind(this,!1),beforeOpen:this.menuBeforeEvent.bind(this,!0),beforeItemRender:this.beforeItemRender.bind(this),onClose:this.menuAfterEvent.bind(this,!1),onOpen:this.menuAfterEvent.bind(this,!0),select:this.menuSelect.bind(this)},r),t.EventHandler.add(r,"keydown",function(e){"Tab"===e.key&&i.fileMenuDDB.toggle()},this)},e.prototype.menuBeforeEvent=function(e,t){var o=e?this.parent.fileMenu.beforeOpen:this.parent.fileMenu.beforeClose;if(o){var i={cancel:t.cancel,element:t.element,event:t.event,items:t.items,parentItem:t.parentItem};o.call(this,i),t.cancel=i.cancel}},e.prototype.menuAfterEvent=function(e,t){var o=e?this.parent.fileMenu.open:this.parent.fileMenu.close;if(o){var i={element:t.element,items:t.items,parentItem:t.parentItem};o.call(this,i)}},e.prototype.beforeItemRender=function(e){var t=this.parent.fileMenu.beforeItemRender;if(t){var o={element:e.element,item:e.item};t.call(this,o)}},e.prototype.menuSelect=function(e){var t=this.parent.fileMenu.select;if(t){var o={element:e.element,item:e.item,event:e.event};t.call(this,o),e.element.classList.contains("e-menu-caret-icon")||this.fileMenuDDB.toggle()}},e.prototype.setCommonProperties=function(e){this.fileMenuDDB&&(this.fileMenuDDB.setProperties(e),this.menuctrl&&this.menuctrl.setProperties(e))},e.prototype.updateFileMenu=function(e){e.visible?this.fileMenuDDB?(e.text&&(this.fileMenuDDB.setProperties({content:e.text}),this.parent.tabObj.element.style.setProperty(ht,this.ddbElement.offsetWidth+"px")),e.popupTemplate?(this.menuctrl&&this.destroyMenu(),this.fileMenuDDB.setProperties({target:e.popupTemplate})):this.menuctrl?this.menuctrl.setProperties({animationSettings:e.animationSettings,items:this.cloneMenuItem(e.menuItems),showItemOnClick:e.showItemOnClick,template:e.itemTemplate}):this.createRibbonMenu(e),this.removeFileMenuTooltip(),this.addFileMenuTooltip(e)):this.createFileMenu(e):this.fileMenuDDB&&this.destroyDDB(),this.parent.tabObj.refreshActiveTabBorder()},e.prototype.destroyMenu=function(){this.menuctrl&&(this.menuctrl.destroy(),this.menuctrl=null)},e.prototype.destroyDDB=function(){this.removeFileMenuTooltip();this.parent.tabObj.element.style.removeProperty(ht),this.destroyMenu(),this.fileMenuDDB.destroy(),this.fileMenuDDB=null,t.remove(this.ddbElement),this.ddbElement=null},e.prototype.removeFileMenuTooltip=function(){var e=this,t=a(this.parent.tooltipData,function(t){return t.id===e.ddbElement.id});-1!==t&&(this.ddbElement.classList.remove(Ye),this.parent.tooltipData.splice(t,1))},e.prototype.addItems=function(e,t,o,i){o?this.menuctrl.insertAfter(e,t,i):this.menuctrl.insertBefore(e,t,i),this.parent.fileMenu.setProperties({menuItems:this.menuctrl.items},!0)},e.prototype.removeItems=function(e,t){this.menuctrl.removeItems(e,t),this.parent.fileMenu.setProperties({menuItems:this.menuctrl.items},!0)},e.prototype.enableItems=function(e,t){this.menuctrl.enableItems(e,!0,t),this.parent.fileMenu.setProperties({menuItems:this.menuctrl.items},!0)},e.prototype.disableItems=function(e,t){this.menuctrl.enableItems(e,!1,t),this.parent.fileMenu.setProperties({menuItems:this.menuctrl.items},!0)},e.prototype.setItem=function(e,t,o){this.menuctrl.setItem(e,t,o),this.menuctrl.refresh(),this.parent.fileMenu.setProperties({menuItems:this.menuctrl.items},!0)},e}();e.Ribbon=wt,e.ITEM_VERTICAL_CENTER=re,e.EXPAND_COLLAPSE_ICON=ne,e.OVERFLOW_ICON=se,e.VERTICAL_DDB=le,e.DISABLED_CSS=ae,e.RTL_CSS=ce,e.RIBBON_HOVER=pe,e.RIBBON_CONTROL=ue,e.RIBBON_POPUP_CONTROL=de,e.RIBBON_POPUP_OPEN=be,e.SPACE=" ",e.HORIZONTAL_SCROLLBAR=he,e.HIDE_CSS=fe,e.RIBBON_TAB="e-ribbon-tab",e.RIBBON_TAB_ACTIVE=me,e.RIBBON_TAB_ITEM=ve,e.RIBBON_COLLAPSE_BUTTON=ye,e.RIBBON_EXPAND_BUTTON=ge,e.RIBBON_COLLAPSIBLE=Se,e.RIBBON_OVERALL_OF_BUTTON=Ie,e.RIBBON_GROUP_OF_BUTTON=Ce,e.RIBBON_OVERFLOW_TARGET=Oe,e.RIBBON_OVERFLOW=we,e.TAB_CONTENT=De,e.RIBBON_MINIMIZE=Pe,e.RIBBON_GROUP=Be,e.RIBBON_GROUP_CONTAINER=Le,e.RIBBON_OF_TAB_CONTAINER=Re,e.RIBBON_OF_GROUP_CONTAINER=Te,e.RIBBON_GROUP_CONTENT=xe,e.RIBBON_GROUP_HEADER=Ee,e.RIBBON_OVERFLOW_HEADER=ke,e.RIBBON_GROUP_OVERFLOW=Me,e.RIBBON_GROUP_OVERFLOW_DDB=_e,e.RIBBON_LAUNCHER=ze,e.RIBBON_LAUNCHER_ICON_ELE=qe,e.RIBBON_LAUNCHER_ICON=je,e.RIBBON_COLLECTION=Ae,e.RIBBON_ITEM=Ne,e.RIBBON_ROW=We,e.RIBBON_COLUMN=Fe,e.RIBBON_LARGE_ITEM=He,e.RIBBON_MEDIUM_ITEM=Ge,e.RIBBON_SMALL_ITEM=Ue,e.RIBBON_CONTENT_HEIGHT=Ve,e.DROPDOWNBUTTON="e-dropdown-btn",e.DROPDOWNBUTTON_HIDE="e-caret-hide",e.RIBBON_TEMPLATE=Ke,e.RIBBON_HELP_TEMPLATE=Xe,e.RIBBON_TOOLTIP=Ze,e.RIBBON_TOOLTIP_TARGET=Ye,e.RIBBON_TOOLTIP_TITLE=Je,e.RIBBON_TOOLTIP_CONTENT=Qe,e.RIBBON_TOOLTIP_ICON=$e,e.RIBBON_TOOLTIP_CONTAINER=et,e.RIBBON_TEXT_CONTAINER=tt,e.RIBBON_SIMPLIFIED_MODE=ot,e.TAB_ID="_tab",e.GROUP_ID="_group",e.COLLECTION_ID="_collection",e.ITEM_ID="_item",e.COLLAPSE_BUTTON_ID=it,e.OVRLOF_BUTTON_ID=rt,e.GROUPOF_BUTTON_ID=nt,e.HEADER_ID=st,e.LAUNCHER_ID=lt,e.CONTENT_ID=at,e.CONTAINER_ID=ct,e.OVERFLOW_ID=pt,e.DROPDOWN_ID=ut,e.RIBBON_FILE_MENU_ID="_filemenu",e.RIBBON_FILE_MENU_LIST=dt,e.RIBBON_HELP_PANE_TEMPLATE_ID=bt,e.RIBBON_FILE_MENU_WIDTH=ht,e.RIBBON_HELP_PANE_TEMPLATE_WIDTH=ft,e.getIndex=a,e.getTemplateFunction=c,e.getItem=p,e.getCollection=u,e.getGroup=d,e.destroyControl=b,e.updateCommonProperty=h,e.updateControlDisabled=f,e.getItemElement=m,e.isTooltipPresent=v,e.setToolTipContent=y,e.createTooltip=g,e.destroyTooltip=S,e.updateTooltipProp=I,e.RibbonTab=ee,e.RibbonGroup=J,e.RibbonCollection=X,e.RibbonItem=U,e.RibbonButtonSettings=w,e.RibbonCheckBoxSettings=B,e.RibbonColorPickerSettings=T,e.RibbonComboBoxSettings=k,e.RibbonDropDownSettings=z,e.RibbonSplitButtonSettings=A,e.FileMenuSettings=ie,e.RibbonTooltip=F,e.RibbonButton=mt,e.RibbonCheckBox=vt,e.RibbonColorPicker=yt,e.RibbonComboBox=gt,e.RibbonDropDown=St,e.RibbonSplitButton=It,e.RibbonFileMenu=Dt,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=ej2-ribbon.umd.min.js.map
